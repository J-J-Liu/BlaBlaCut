{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\u6b22\u8fce\u6765\u5230 BlaBlaCut \ud83d\udc4b","text":"<p>Life is Short, You need BlaBlaCut.</p> \ud83d\udd0d \u8f93\u5165\u5173\u952e\u8bcd\u641c\u7d22\u8bba\u6587\u7b14\u8bb0\u6216\u9605\u8bfb\u6e05\u5355..."},{"location":"#_1","title":"\ud83d\ude80 \u6838\u5fc3\u529f\u80fd\uff1a\u8fd9\u91cc\u6709\u4ec0\u4e48\uff1f","text":"<p>\u57fa\u4e8e\u4e0a\u8ff0\u601d\u8003\uff0cBlaBlaCut \u5229\u7528 LLM \u4e3a\u8bba\u6587\u5236\u4f5c\u4e86 \u4e09\u4efd\u6838\u5fc3\u62a5\u544a\uff1a</p> <ol> <li>\ud83d\udcda \u4e3b\u9605\u8bfb\u62a5\u544a\uff1a\u5faa\u5e8f\u6e10\u8fdb\uff0c\u5bf9\u8bba\u6587\u5404\u7ae0\u8282\u8fdb\u884c\u6df1\u5ea6\u62c6\u89e3\u4e0e\u89e3\u91ca\u3002</li> <li>\ud83d\udcc8 \u56fe\u8868\u5206\u6790\u62a5\u544a\uff1a\u56fe\u6587\u5bf9\u7167\uff0c\u9010\u4e2a\u51fb\u7834\u8bba\u6587\u4e2d\u6240\u6709\u56fe\u8868\u7684\u542b\u4e49\u3002</li> <li>\ud83d\udc76 ELI5 \u8be6\u89e3\u62a5\u544a\uff1a\u901a\u4fd7\u6f14\u7ece\uff0c\u7528\u6700\u76f4\u767d\u7684\u8bdd\u8bb2\u89e3\u6838\u5fc3\u7684\u521b\u65b0\u70b9\u3002</li> </ol>"},{"location":"#_2","title":"\ud83e\udded \u5bfc\u822a\u6307\u5357","text":"<p>\u5e0c\u671b\u672c\u9879\u76ee\u80fd\u591f\u5bf9\u4f60\u6709\u6240\u5e2e\u52a9\uff01</p> <ul> <li>\u5f52\u7eb3\u6d4f\u89c8\uff1a\u672c\u7ad9\u7684\u8bba\u6587\u7b14\u8bb0\u901a\u8fc7\u5de6\u4fa7\u5bfc\u822a\u680f\u7684 \u9605\u8bfb\u6e05\u5355 \u8fdb\u884c\u5f52\u7eb3\u3002</li> <li>\u5feb\u901f\u67e5\u627e\uff1a\u672a\u5f52\u7eb3\u7684\u8bba\u6587\u7b14\u8bb0\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u4e0a\u65b9\u7684\u641c\u7d22\u680f\u6216\u9876\u90e8\u7684\u641c\u7d22\u529f\u80fd\u76f4\u63a5\u5b9a\u4f4d\u7279\u5b9a\u8bba\u6587\u3002</li> </ul>"},{"location":"#_3","title":"\ud83d\udcd6 \u5173\u4e8e\u672c\u9879\u76ee","text":"<p>BlaBlaCut \u7684\u8bde\u751f\uff0c\u6e90\u4e8e\u6211\u5728\u4f7f\u7528 AI Chatbot \u8f85\u52a9\u9605\u8bfb\u8bba\u6587\u65f6\u7684\u4e00\u6b21\u987f\u609f\u3002</p> <p>\u6211\u53d1\u73b0\u81ea\u5df1\u603b\u662f\u91cd\u590d\u5730\u5411 Chatbot \u8be2\u95ee\u51e0\u4e4e\u5b8c\u5168\u4e00\u81f4\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u201c\u6838\u5fc3\u521b\u65b0\u70b9\u662f\u4ec0\u4e48\uff1f\u201d</li> <li>\u201c\u8fd9\u5f20\u8868\u4ec0\u4e48\u610f\u601d\uff1f\u201d</li> <li>\u201c\u8bf7\u901a\u4fd7\u89e3\u91ca\u4e00\u4e0b\u8fd9\u4e2a\u7b97\u6cd5\u201d</li> </ul> <p>\u5e76\u4e14\u7531\u4e8e\u7f3a\u4e4f\u7cfb\u7edf\u6027\u7684\u6574\u7406\uff0c\u8fd9\u4e9b\u5b9d\u8d35\u7684\u95ee\u7b54\u5f80\u5f80\u6563\u843d\u5728\u4e0e Chatbot \u7684\u5386\u53f2\u5bf9\u8bdd\u4e2d\uff0c\u65e0\u6cd5\u5f62\u6210\u79ef\u7d2f\u3002</p> <p>\u4e8e\u662f\u6211\u51b3\u5b9a\u81ea\u5df1\u642d\u5efa\u4e00\u4e2a\u7b80\u5355\u7684 Agent\uff0c\u4e00\u6b21\u6027\u5c06\u6211\u53ef\u80fd\u4f1a\u60f3\u8981\u95ee\u7684\u95ee\u9898\u95ee\u4e2a\u5e72\u51c0\uff0c\u5e76\u81ea\u52a8\u6574\u7406\u6210\u6587\u6863\u5b58\u50a8\u8d77\u6765\uff0c\u751a\u81f3\u80fd\u591f\u4e0a\u4f20\u81f3\u9759\u6001\u7f51\u9875\u6765\u4f9b\u5927\u5bb6\u9605\u89c8\u548c\u5206\u4eab\u3002</p>"},{"location":"#ai","title":"\ud83d\udca1 \u4e3a\u4ec0\u4e48\u9700\u8981 AI \u8f85\u52a9\u9605\u8bfb\uff1f","text":"<p>\u5728\u8c03\u6559 Agent \u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u81ea\u6211\u5256\u6790\u4e86 \u201c\u4e3a\u4ec0\u4e48\u6bd4\u8d77\u8bfb\u8bba\u6587\u539f\u6587\uff0c\u6211\u66f4\u4f9d\u8d56 Chatbot \u7684\u8bb2\u89e3\u201d\uff1a</p> <ul> <li>\u26a1\ufe0f \u8bed\u8a00\u969c\u788d\uff1a\u5207\u6362\u6210\u4e2d\u6587\u81f3\u5c11\u5f00\u4e2a1.25x\u500d\u901f\uff1b</li> <li>\ud83d\udcdd \u7ed3\u6784\u5316\u8f93\u51fa\uff1a\u76f8\u6bd4\u8bba\u6587\u7684\u81ea\u7136\u8bed\u8a00\uff0c\u5206\u70b9\u9648\u8ff0\u66f4\u80fd\u7a81\u51fa\u91cd\u70b9\uff0c\u5229\u4e8e\u5feb\u901f\u626b\u63cf\uff1b</li> <li>\ud83d\udcca \u56fe\u8868\u89e3\u91ca\uff1a\u56fe\u8868\u5f80\u5f80\u662f\u7565\u8bfb\u65f6\uff0c\u8bfb\u5b8c\u6458\u8981\u540e\u7684\u7b2c\u4e00\u7ad9\uff0cAI \u7684\u76f4\u63a5\u89e3\u8bfb\u7701\u53bb\u4e86\u5728\u6b63\u6587\u4e2d\u7ffb\u627e\u89e3\u91ca\u7684\u7e41\u7410\uff1b</li> <li>\ud83e\udde9 \u901a\u4fd7\u89e3\u91ca\uff1a\u7f3a\u4e4f\u5145\u8db3\u7684\u77e5\u8bc6\u50a8\u5907\u65f6\uff0c\u76f4\u9762\u201c\u4f17\u6240\u5468\u77e5\u201d\u662f\u6b8b\u9177\u7684\uff0cELI5\uff08Explain Like I'm 5\uff09\u901a\u5e38\u662f\u4e00\u4e2a\u5f97\u529b\u7684\u811a\u624b\u67b6\u3002</li> </ul> <p>\u4e8e\u662f\u4e4e\uff0cBlaBlaCut\u5c31\u6210\u4e3a\u4e86\u73b0\u5728\u7684\u6a21\u6837\u3002</p> <p>\ud83d\udce7 \u8054\u7cfb\u65b9\u5f0f\uff1a\u4efb\u4f55\u5efa\u8bae\uff0c\u8bf7\u8054\u7cfb isliujunjie@163.com\u3002 </p>"},{"location":"collections/Recent/","title":"Recent Papers","text":"<p>\u6700\u8fd1\u6536\u5f55\u7684\u8bba\u6587\u7b14\u8bb0\uff0c\u6b22\u8fce\u9605\u8bfb~</p> <p>\u672c\u9875\u9762\u5171\u6536\u5f55\u4e86 12 \u7bc7\u8bba\u6587\u7b14\u8bb0\u3002</p>"},{"location":"collections/Recent/#bolt-a-practical-binary-optimizer-for-data-centers-and-beyond","title":"BOLT: A Practical Binary Optimizer for Data Centers and Beyond","text":"<p>Authors: Maksim Panchenko, Rafael Auler, Bill Nell, et al. Affiliations: Facebook, Inc. Venue: CGO 2019</p> <p>\u8bba\u6587\u63d0\u51faBOLT\uff0c\u4e00\u4e2a\u57fa\u4e8eLLVM\u7684\u9759\u6001\u4e8c\u8fdb\u5236\u4f18\u5316\u5668\uff0c\u5229\u7528\u91c7\u6837\u5206\u6790\u5728\u94fe\u63a5\u540e\u4f18\u5316\u4ee3\u7801\u5e03\u5c40\u3002\u5176\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\u8bc1\u660e\u4e86\u94fe\u63a5\u540e\u4f18\u5316\u80fd\u66f4\u7cbe\u51c6\u5730\u5229\u7528\u6027\u80fd\u5256\u6790\u6570\u636e\uff0c\u4e0e\u7f16\u8bd1\u671fFDO/LTO\u4e92\u8865\u3002\u5728Facebook\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\u4e0a\u83b7\u5f97\u6700\u9ad87.0%\u52a0\u901f\uff0c\u5728GCC/Clang\u7f16\u8bd1\u5668\u4e0a\u83b7\u5f97\u6700\u9ad820.4%\uff08\u542f\u7528FDO/LTO\u65f6\uff09\u548c52.1%\uff08\u672a\u542f\u7528\u65f6\uff09\u7684\u6027\u80fd\u63d0\u5347\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers","title":"Feedback Directed Prefetching: Improving the Performance and Bandwidth-Efficiency of Hardware Prefetchers","text":"<p>Authors: Santhosh Srinath, Onur Mutlu, Hyesoon Kim, et al. Affiliations: Microsoft, Microsoft Research, The University of Texas at Austin Venue: MICRO 2007</p> <p>\u63d0\u51fa\u53cd\u9988\u5bfc\u5411\u9884\u53d6\uff08FDP\uff09\u673a\u5236\uff0c\u901a\u8fc7\u52a8\u6001\u76d1\u63a7\u9884\u53d6\u51c6\u786e\u7387\u3001\u53ca\u65f6\u6027\u548c\u7f13\u5b58\u6c61\u67d3\u6765\u8c03\u6574\u786c\u4ef6\u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u7a0b\u5ea6\u548c\u9884\u53d6\u5757\u5728\u7f13\u5b58LRU\u6808\u4e2d\u7684\u63d2\u5165\u4f4d\u7f6e\u3002\u5728SPEC CPU2000\u4e0a\uff0c\u76f8\u6bd4\u6700\u4f73\u4f20\u7edf\u6d41\u5f0f\u9884\u53d6\u5668\uff0c\u5e73\u5747\u6027\u80fd\u63d0\u53476.5%\uff0c\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u964d\u4f4e18.7%\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#limoncello-prefetchers-for-scale","title":"Limoncello: Prefetchers for Scale","text":"<p>Authors: Akanksha Jain, Hannah Lin, Carlos Villavieja, et al. Affiliations: Google, University of Washington Venue: ASPLOS 2024</p> <p>\u8bba\u6587\u63d0\u51faLimoncello\uff0c\u4e00\u79cd\u65e0\u9700\u786c\u4ef6\u4fee\u6539\u7684\u8f6f\u786c\u534f\u540c\u9884\u53d6\u7cfb\u7edf\u3002\u5b83\u5728\u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u65f6\u52a8\u6001\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u4ee5\u964d\u4f4e15%\u5185\u5b58\u5ef6\u8fdf\uff0c\u5e76\u901a\u8fc7\u5927\u89c4\u6a21\u786c\u4ef6\u6d88\u878d\u7814\u7a76\u8bc6\u522b\u51fa\u6570\u636e\u4e2d\u5fc3\u7a0e\u51fd\u6570\uff08\u5982memcpy\u3001\u538b\u7f29\u3001\u54c8\u5e0c\uff09\u4f5c\u4e3a\u8f6f\u4ef6\u9884\u53d6\u76ee\u6807\uff0c\u7cbe\u51c6\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\u3002\u5728Google\u751f\u4ea7\u96c6\u7fa4\u90e8\u7f72\u540e\uff0c\u7cfb\u7edf\u5728\u9ad8\u8d1f\u8f7d\u4e0b\u5c06\u5e94\u7528\u541e\u5410\u91cf\u63d0\u534710%\uff0c\u540c\u65f6\u51cf\u5c1115%\u7684socket\u5185\u5b58\u5e26\u5bbd\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#ocolos-online-code-layout-optimizations","title":"OCOLOS: Online COde Layout OptimizationS","text":"<p>Authors: Yuxuan Zhang, Tanvir Ahmed Khan, Gilles Pokam, et al. Affiliations: University of Pennsylvania, University of Michigan, Intel Corporation, University of California, Santa Cruz Venue: MICRO 2023</p> <p>\u63d0\u51faOCOLOS\uff0c\u9996\u4e2a\u9762\u5411\u975e\u6258\u7ba1\u8bed\u8a00\uff08\u5982C/C++\uff09\u7684\u5728\u7ebf\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u7cfb\u7edf\u3002\u5b83\u5728\u8fd0\u884c\u65f6\u5bf9\u8fdb\u7a0b\u8fdb\u884cProfile-Guided Optimization (PGO)\uff0c\u89e3\u51b3\u4e86\u79bb\u7ebfPGO\u56e0\u914d\u7f6e\u6587\u4ef6\u8fc7\u65f6\u6216\u4ee3\u7801\u53d8\u66f4\u5bfc\u81f4\u7684\u4f18\u5316\u5931\u6548\u95ee\u9898\u3002\u901a\u8fc7\u5b89\u5168\u7684\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u6280\u672f\uff0c\u65e0\u9700\u4fee\u6539\u5e94\u7528\u5373\u53ef\u52a0\u901f\u590d\u6742\u591a\u7ebf\u7a0b\u7a0b\u5e8f\uff0c\u5728MySQL\u3001Verilator\u548cClang\u6784\u5efa\u4e0a\u5206\u522b\u5b9e\u73b0\u4e86\u6700\u9ad81.41\u500d\u30012.20\u500d\u548c1.14\u500d\u7684\u52a0\u901f\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design","title":"Prodigy: Improving the Memory Latency of Data-Indirect Irregular Workloads Using Hardware-Software Co-Design","text":"<p>Authors: Nishil Talati, Kyle May, Armand Behroozi, et al. Affiliations: University of Michigan, University of Wisconsin, Madison, University of Edinburgh Venue: MICRO 2021</p> <p>\u63d0\u51faProdigy\uff0c\u4e00\u79cd\u8f6f\u786c\u4ef6\u534f\u540c\u8bbe\u8ba1\u7684\u4f4e\u5f00\u9500\u9884\u53d6\u65b9\u6848\uff0c\u7528\u4e8e\u52a0\u901f\u5177\u6709\u6570\u636e\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff08\u5355\u503c\u548c\u8303\u56f4\u95f4\u63a5\uff09\u7684\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u3002\u5176\u6838\u5fc3\u662f\u6570\u636e\u95f4\u63a5\u56fe\uff08DIG\uff09\u8868\u793a\uff0c\u7531\u7f16\u8bd1\u5668\u81ea\u52a8\u751f\u6210\u5e76\u6307\u5bfc\u786c\u4ef6\u9884\u53d6\u5668\u3002\u5728\u4ec50.8KB\u5b58\u50a8\u5f00\u9500\u4e0b\uff0c\u76f8\u6bd4\u65e0\u9884\u53d6\u57fa\u7ebf\u5e73\u5747\u63d0\u901f2.6\u500d\u3001\u8282\u80fd1.6\u500d\uff0c\u5e76\u663e\u8457\u4f18\u4e8e\u73b0\u6709\u5148\u8fdb\u9884\u53d6\u5668\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#profile-guided-temporal-prefetching","title":"Profile-Guided Temporal Prefetching","text":"<p>Authors: Mengming Li, Qijun Zhang, Yichuan Gao, et al. Affiliations: Hong Kong University of Science and Technology (HKUST), Intel Venue: ISCA 2025</p> <p>\u63d0\u51faProphet\uff0c\u4e00\u4e2a\u8f6f\u786c\u534f\u540c\u7684Profile-Guided\u65f6\u5e8f\u9884\u53d6\u6846\u67b6\uff0c\u901a\u8fc7\u8f7b\u91cf\u7ea7\u8ba1\u6570\u5668\u5206\u6790\u548c\u52a8\u6001\u63d0\u793a\u6ce8\u5165\uff0c\u4f18\u5316\u7247\u4e0a\u5143\u6570\u636e\u8868\u7ba1\u7406\u3002\u76f8\u6bd4SOTA\u786c\u4ef6\u9884\u53d6\u5668Triangel\uff0c\u6027\u80fd\u63d0\u534714.23%\uff0c\u663e\u8457\u4f18\u4e8e\u8f6f\u4ef6\u65b9\u6848RPG2\uff08\u4ec50.1%\u589e\u76ca\uff09\uff0c\u4e14\u80fd\u81ea\u9002\u5e94\u4e0d\u540c\u8f93\u5165\uff0c\u5f00\u9500\u53ef\u5ffd\u7565\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding","title":"RICH Prefetcher: Storing Rich Information in Memory to Trade Capacity and Bandwidth for Latency Hiding","text":"<p>Authors: Ningzhi Ai, Wenjian He, Hu He, et al. Affiliations: Huawei Technologies Co., Ltd, Tsinghua University Venue: MICRO 2025</p> <p>\u9488\u5bf9\u9ad8\u5e26\u5bbd/\u5927\u5bb9\u91cf\u4f46\u9ad8\u5ef6\u8fdf\u7684\u672a\u6765\u5185\u5b58\u7cfb\u7edf\uff0c\u63d0\u51faRICH\u9884\u53d6\u5668\u3002\u5176\u6838\u5fc3\u521b\u65b0\u662f\u5229\u7528\u4e30\u5bcc\u7684\u5143\u6570\u636e\uff0c\u901a\u8fc7\u591a\u5c3a\u5ea6\u533a\u57df\uff082KB/4KB/16KB\uff09\u548c\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u534f\u540c\u5de5\u4f5c\uff0c\u5728\u4fdd\u6301\u9ad8\u7cbe\u5ea6\u7684\u540c\u65f6\u63d0\u5347\u8986\u76d6\u7387\u548c\u53ca\u65f6\u6027\u3002\u4e3a\u63a7\u5236\u5f00\u9500\uff0c\u91c7\u7528\u7247\u4e0a/\u7247\u4e0b\u5206\u5c42\u5b58\u50a8\u5143\u6570\u636e\u3002\u5b9e\u9a8c\u8868\u660e\uff0c\u5728\u4f20\u7edf\u7cfb\u7edf\u4e2d\u6027\u80fd\u4f18\u4e8eBingo 3.4%\uff0c\u5728\u589e\u52a0120ns\u5ef6\u8fdf\u7684\u9ad8\u5ef6\u8fdf\u7cfb\u7edf\u4e2d\u4f18\u52bf\u6269\u5927\u81f38.3%\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#rnr-a-software-assisted-record-and-replay-hardware-prefetcher","title":"RnR: A Software-Assisted Record-and-Replay Hardware Prefetcher","text":"<p>Authors: Chao Zhang, Yuan Zeng, John Shalf, et al. Affiliations: Lehigh University, Lawrence Berkeley National Lab Venue: HPCA 2023</p> <p>\u8bba\u6587\u63d0\u51faRnR\uff0c\u4e00\u79cd\u8f6f\u786c\u4ef6\u534f\u540c\u7684\u8bb0\u5f55-\u56de\u653e\u5f0f\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u7528\u4e8e\u5904\u7406\u5177\u6709\u91cd\u590d\u6027\u4e0d\u89c4\u5219\u8bbf\u5b58\u6a21\u5f0f\u7684\u5e94\u7528\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u77e9\u9635\u8fd0\u7b97\uff09\u3002\u901a\u8fc7\u8f7b\u91cf\u7ea7\u7f16\u7a0b\u63a5\u53e3\uff0c\u7a0b\u5e8f\u5458\u6307\u5b9a\u6570\u636e\u7ed3\u6784\u548c\u8fed\u4ee3\u8fb9\u754c\uff0c\u786c\u4ef6\u8bb0\u5f55\u9996\u6b21\u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217\u5e76\u540e\u7eed\u56de\u653e\u9884\u53d6\u3002\u8be5\u65b9\u6cd5\u5728PageRank\u7b49\u56fe\u5e94\u7528\u4e0a\u5e73\u5747\u63d0\u901f2.16\u500d\uff0c\u5728\u7a00\u758f\u8fed\u4ee3\u6c42\u89e3\u5668\u4e0a\u63d0\u901f2.91\u500d\uff0c\u9884\u53d6\u51c6\u786e\u7387\u548c\u8986\u76d6\u7387\u5747\u8d8595%\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#rpg2-robust-profile-guided-runtime-prefetch-generation","title":"RPG2: Robust Profile-Guided Runtime Prefetch Generation","text":"<p>Authors: Yuxuan Zhang, Nathan Sobotka, Soyoon Park, et al. Affiliations: University of Pennsylvania, University of California, Santa Cruz, Columbia University, University of Washington, Google, Intel Venue: ASPLOS 2024</p> <p>RPG2 \u662f\u4e00\u4e2a\u7eaf\u8f6f\u4ef6\u7684\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u7528\u4e8e\u52a8\u6001\u6ce8\u5165\u548c\u8c03\u4f18\u6570\u636e\u9884\u53d6\u3002\u5b83\u901a\u8fc7\u5728\u7ebf\u5206\u6790\u7a0b\u5e8f\u884c\u4e3a\uff0c\u81ea\u52a8\u63d2\u5165\u9884\u53d6\u6307\u4ee4\u5e76\u5b9e\u65f6\u8c03\u6574\u9884\u53d6\u8ddd\u79bb\uff0c\u4ee5\u5e94\u5bf9\u4e0d\u540c\u8f93\u5165\u548c\u5fae\u67b6\u6784\u4e0b\u7684\u6027\u80fd\u654f\u611f\u6027\u3002\u5f53\u9884\u53d6\u6709\u5bb3\u65f6\uff0cRPG2 \u80fd\u56de\u6eda\u5230\u539f\u59cb\u4ee3\u7801\u3002\u5b9e\u9a8c\u8868\u660e\uff0cRPG2 \u5728\u591a\u79cd\u8d1f\u8f7d\u4e0a\u53ef\u83b7\u5f97\u6700\u9ad82.15\u500d\u7684\u52a0\u901f\uff0c\u5e76\u6709\u6548\u907f\u514d\u4e86\u9759\u6001\u7f16\u8bd1\u5668\u65e0\u6cd5\u5904\u7406\u7684\u6027\u80fd\u4e0b\u964d\u95ee\u9898\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#tea-time-proportional-event-analysis","title":"TEA: Time-Proportional Event Analysis","text":"<p>Authors: Bj\u00f6rn Gottschall, Lieven Eeckhout, Magnus Jahre Affiliations: Norwegian University of Science and Technology (NTNU), Ghent University Venue: ISCA 2023</p> <p>\u63d0\u51fa\u65f6\u95f4\u6bd4\u4f8b\u4e8b\u4ef6\u5206\u6790\uff08TEA\uff09\uff0c\u901a\u8fc7\u521b\u5efa\u65f6\u95f4\u6bd4\u4f8b\u7684\u6bcf\u6307\u4ee4\u5468\u671f\u6808\uff08PICS\uff09\u89e3\u91ca\u6027\u80fd\u5173\u952e\u6307\u4ee4\u8017\u65f6\u539f\u56e0\u3002TEA\u4ec5\u8ffd\u8e2a9\u4e2a\u5173\u952e\u4e8b\u4ef6\uff0c\u5f00\u9500\u6781\u4f4e\uff08\u529f\u8017+0.1%\uff0c\u6027\u80fd\u5f00\u95001.1%\uff09\uff0c\u76f8\u6bd4IBS/SPE/RIS\u5c06\u5e73\u5747\u8bef\u5dee\u4ece~55.6%\u964d\u81f32.1%\u3002\u5728SPEC CPU2017\u7684lbm\u548cnab\u4e0a\u6210\u529f\u5b9a\u4f4d\u74f6\u9888\uff0c\u4f18\u5316\u540e\u5206\u522b\u83b7\u5f971.28\u500d\u548c2.45\u500d\u52a0\u901f\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#tip-time-proportional-instruction-profiling","title":"TIP: Time-Proportional Instruction Profiling","text":"<p>Authors: Bjorn Gottschall, Lieven Eeckhout, Magnus Jahre Affiliations: Norwegian University of Science and Technology, Ghent University Venue: MICRO 2021</p> <p>\u8bba\u6587\u63d0\u51faOracle\u6027\u80fd\u5206\u6790\u5668\u4f5c\u4e3a\u9ec4\u91d1\u6807\u51c6\uff0c\u63ed\u793a\u73b0\u6709\u786c\u4ef6\u5206\u6790\u5668\uff08\u5982Intel PEBS\uff09\u56e0\u975e\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u5bfc\u81f4\u5e73\u57479.3%\u7684\u6307\u4ee4\u7ea7\u8bef\u5dee\u3002\u4e3a\u6b64\uff0c\u4f5c\u8005\u8bbe\u8ba1\u4e86\u65f6\u95f4\u6bd4\u4f8b\u6307\u4ee4\u5206\u6790\u5668TIP\uff0c\u901a\u8fc7\u7ed3\u5408Oracle\u7684\u5f52\u56e0\u7b56\u7565\u4e0e\u7edf\u8ba1\u91c7\u6837\uff0c\u5728BOOM\u5904\u7406\u5668\u4e0a\u5c06\u5e73\u5747\u8bef\u5dee\u964d\u81f31.6%\u3002\u5229\u7528TIP\u5728SPEC CPU2017\u7684Imagick\u57fa\u51c6\u4e2d\u53d1\u73b0\u5e76\u4fee\u590d\u4e86CSR\u6307\u4ee4\u5f15\u8d77\u7684\u6d41\u6c34\u7ebf\u5237\u65b0\u95ee\u9898\uff0c\u5b9e\u73b0\u4e861.93\u500d\u6027\u80fd\u63d0\u5347\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/Recent/#titan-i-an-open-source-high-performance-risc-v-vector-core","title":"Titan-I: An Open-Source, High Performance RISC-V Vector Core","text":"<p>Authors: Jiuyang Liu, Qinjun Li, Yunqian Luo, et al. Affiliations: Huazhong University of Science and Technology, Institute of Software, Chinese Academy of Sciences, Tsinghua University, Xinpian Technology Co., Ltd. Venue: MICRO 2025</p> <p>\u63d0\u51faTitan-I (T1)\uff0c\u4e00\u4e2a\u5f00\u6e90\u3001\u9ad8\u6027\u80fd\u7684\u4e71\u5e8fRISC-V\u5411\u91cf\u6838\uff0c\u901a\u8fc7\u7c97\u7c92\u5ea6\u5e03\u5c40\u89c4\u5212\u5668\u3001\u6570\u636e\u901a\u8def\u7ea7\u7f6e\u6362\u5355\u5143\u548c\u63a9\u7801\u5bc4\u5b58\u5668\u7f13\u5b58\u89e3\u51b3VLEN/DLEN\u6269\u5c55\u96be\u9898\uff0c\u5e76\u91c7\u7528\u7ec6\u7c92\u5ea6\u94fe\u63a5\u3001\u63d0\u4ea4\u5373\u53d1\u5c04\u7b49\u6280\u672f\u63d0\u5347ILP\u3002\u5728\u5bc6\u7801\u5b66 workload \u4e0a\uff0cT1\u4ee540%\u9762\u79ef\u5b9e\u73b0\u5bf9Nvidia 3090/5090\u6700\u9ad82.41\u500d/1.85\u500d\u52a0\u901f\uff1b\u5728HPC\u4e0a\uff0c\u4ee519%\u9762\u79ef\u8fbe\u5230HiSilicon TaiShan V120\u6027\u80fd\uff0c\u5e76\u57284\u500d\u6570\u636e\u901a\u8def\u6269\u5c55\u4e0b\u83b7\u5f974.59\u500d\u52a0\u901f\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/awesome-data-prefetchers/","title":"Awesome Data Prefetchers","text":"<p>\u6570\u636e\u9884\u53d6\u5668\u76f8\u5173\u8bba\u6587</p> <p>\u672c\u9875\u9762\u5171\u6536\u5f55\u4e86 7 \u7bc7\u8bba\u6587\u7b14\u8bb0\u3002</p>"},{"location":"collections/awesome-data-prefetchers/#feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers","title":"Feedback Directed Prefetching: Improving the Performance and Bandwidth-Efficiency of Hardware Prefetchers","text":"<p>Authors: Santhosh Srinath, Onur Mutlu, Hyesoon Kim, et al. Affiliations: Microsoft, Microsoft Research, The University of Texas at Austin Venue: MICRO 2007</p> <p>\u63d0\u51fa\u53cd\u9988\u5bfc\u5411\u9884\u53d6\uff08FDP\uff09\u673a\u5236\uff0c\u901a\u8fc7\u52a8\u6001\u76d1\u63a7\u9884\u53d6\u51c6\u786e\u7387\u3001\u53ca\u65f6\u6027\u548c\u7f13\u5b58\u6c61\u67d3\u6765\u8c03\u6574\u786c\u4ef6\u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u7a0b\u5ea6\u548c\u9884\u53d6\u5757\u5728\u7f13\u5b58LRU\u6808\u4e2d\u7684\u63d2\u5165\u4f4d\u7f6e\u3002\u5728SPEC CPU2000\u4e0a\uff0c\u76f8\u6bd4\u6700\u4f73\u4f20\u7edf\u6d41\u5f0f\u9884\u53d6\u5668\uff0c\u5e73\u5747\u6027\u80fd\u63d0\u53476.5%\uff0c\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u964d\u4f4e18.7%\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/awesome-data-prefetchers/#limoncello-prefetchers-for-scale","title":"Limoncello: Prefetchers for Scale","text":"<p>Authors: Akanksha Jain, Hannah Lin, Carlos Villavieja, et al. Affiliations: Google, University of Washington Venue: ASPLOS 2024</p> <p>\u8bba\u6587\u63d0\u51faLimoncello\uff0c\u4e00\u79cd\u65e0\u9700\u786c\u4ef6\u4fee\u6539\u7684\u8f6f\u786c\u534f\u540c\u9884\u53d6\u7cfb\u7edf\u3002\u5b83\u5728\u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u65f6\u52a8\u6001\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u4ee5\u964d\u4f4e15%\u5185\u5b58\u5ef6\u8fdf\uff0c\u5e76\u901a\u8fc7\u5927\u89c4\u6a21\u786c\u4ef6\u6d88\u878d\u7814\u7a76\u8bc6\u522b\u51fa\u6570\u636e\u4e2d\u5fc3\u7a0e\u51fd\u6570\uff08\u5982memcpy\u3001\u538b\u7f29\u3001\u54c8\u5e0c\uff09\u4f5c\u4e3a\u8f6f\u4ef6\u9884\u53d6\u76ee\u6807\uff0c\u7cbe\u51c6\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\u3002\u5728Google\u751f\u4ea7\u96c6\u7fa4\u90e8\u7f72\u540e\uff0c\u7cfb\u7edf\u5728\u9ad8\u8d1f\u8f7d\u4e0b\u5c06\u5e94\u7528\u541e\u5410\u91cf\u63d0\u534710%\uff0c\u540c\u65f6\u51cf\u5c1115%\u7684socket\u5185\u5b58\u5e26\u5bbd\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/awesome-data-prefetchers/#prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design","title":"Prodigy: Improving the Memory Latency of Data-Indirect Irregular Workloads Using Hardware-Software Co-Design","text":"<p>Authors: Nishil Talati, Kyle May, Armand Behroozi, et al. Affiliations: University of Michigan, University of Wisconsin, Madison, University of Edinburgh Venue: MICRO 2021</p> <p>\u63d0\u51faProdigy\uff0c\u4e00\u79cd\u8f6f\u786c\u4ef6\u534f\u540c\u8bbe\u8ba1\u7684\u4f4e\u5f00\u9500\u9884\u53d6\u65b9\u6848\uff0c\u7528\u4e8e\u52a0\u901f\u5177\u6709\u6570\u636e\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff08\u5355\u503c\u548c\u8303\u56f4\u95f4\u63a5\uff09\u7684\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u3002\u5176\u6838\u5fc3\u662f\u6570\u636e\u95f4\u63a5\u56fe\uff08DIG\uff09\u8868\u793a\uff0c\u7531\u7f16\u8bd1\u5668\u81ea\u52a8\u751f\u6210\u5e76\u6307\u5bfc\u786c\u4ef6\u9884\u53d6\u5668\u3002\u5728\u4ec50.8KB\u5b58\u50a8\u5f00\u9500\u4e0b\uff0c\u76f8\u6bd4\u65e0\u9884\u53d6\u57fa\u7ebf\u5e73\u5747\u63d0\u901f2.6\u500d\u3001\u8282\u80fd1.6\u500d\uff0c\u5e76\u663e\u8457\u4f18\u4e8e\u73b0\u6709\u5148\u8fdb\u9884\u53d6\u5668\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/awesome-data-prefetchers/#profile-guided-temporal-prefetching","title":"Profile-Guided Temporal Prefetching","text":"<p>Authors: Mengming Li, Qijun Zhang, Yichuan Gao, et al. Affiliations: Hong Kong University of Science and Technology (HKUST), Intel Venue: ISCA 2025</p> <p>\u63d0\u51faProphet\uff0c\u4e00\u4e2a\u8f6f\u786c\u534f\u540c\u7684Profile-Guided\u65f6\u5e8f\u9884\u53d6\u6846\u67b6\uff0c\u901a\u8fc7\u8f7b\u91cf\u7ea7\u8ba1\u6570\u5668\u5206\u6790\u548c\u52a8\u6001\u63d0\u793a\u6ce8\u5165\uff0c\u4f18\u5316\u7247\u4e0a\u5143\u6570\u636e\u8868\u7ba1\u7406\u3002\u76f8\u6bd4SOTA\u786c\u4ef6\u9884\u53d6\u5668Triangel\uff0c\u6027\u80fd\u63d0\u534714.23%\uff0c\u663e\u8457\u4f18\u4e8e\u8f6f\u4ef6\u65b9\u6848RPG2\uff08\u4ec50.1%\u589e\u76ca\uff09\uff0c\u4e14\u80fd\u81ea\u9002\u5e94\u4e0d\u540c\u8f93\u5165\uff0c\u5f00\u9500\u53ef\u5ffd\u7565\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/awesome-data-prefetchers/#rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding","title":"RICH Prefetcher: Storing Rich Information in Memory to Trade Capacity and Bandwidth for Latency Hiding","text":"<p>Authors: Ningzhi Ai, Wenjian He, Hu He, et al. Affiliations: Huawei Technologies Co., Ltd, Tsinghua University Venue: MICRO 2025</p> <p>\u9488\u5bf9\u9ad8\u5e26\u5bbd/\u5927\u5bb9\u91cf\u4f46\u9ad8\u5ef6\u8fdf\u7684\u672a\u6765\u5185\u5b58\u7cfb\u7edf\uff0c\u63d0\u51faRICH\u9884\u53d6\u5668\u3002\u5176\u6838\u5fc3\u521b\u65b0\u662f\u5229\u7528\u4e30\u5bcc\u7684\u5143\u6570\u636e\uff0c\u901a\u8fc7\u591a\u5c3a\u5ea6\u533a\u57df\uff082KB/4KB/16KB\uff09\u548c\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u534f\u540c\u5de5\u4f5c\uff0c\u5728\u4fdd\u6301\u9ad8\u7cbe\u5ea6\u7684\u540c\u65f6\u63d0\u5347\u8986\u76d6\u7387\u548c\u53ca\u65f6\u6027\u3002\u4e3a\u63a7\u5236\u5f00\u9500\uff0c\u91c7\u7528\u7247\u4e0a/\u7247\u4e0b\u5206\u5c42\u5b58\u50a8\u5143\u6570\u636e\u3002\u5b9e\u9a8c\u8868\u660e\uff0c\u5728\u4f20\u7edf\u7cfb\u7edf\u4e2d\u6027\u80fd\u4f18\u4e8eBingo 3.4%\uff0c\u5728\u589e\u52a0120ns\u5ef6\u8fdf\u7684\u9ad8\u5ef6\u8fdf\u7cfb\u7edf\u4e2d\u4f18\u52bf\u6269\u5927\u81f38.3%\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/awesome-data-prefetchers/#rnr-a-software-assisted-record-and-replay-hardware-prefetcher","title":"RnR: A Software-Assisted Record-and-Replay Hardware Prefetcher","text":"<p>Authors: Chao Zhang, Yuan Zeng, John Shalf, et al. Affiliations: Lehigh University, Lawrence Berkeley National Lab Venue: HPCA 2023</p> <p>\u8bba\u6587\u63d0\u51faRnR\uff0c\u4e00\u79cd\u8f6f\u786c\u4ef6\u534f\u540c\u7684\u8bb0\u5f55-\u56de\u653e\u5f0f\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u7528\u4e8e\u5904\u7406\u5177\u6709\u91cd\u590d\u6027\u4e0d\u89c4\u5219\u8bbf\u5b58\u6a21\u5f0f\u7684\u5e94\u7528\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u77e9\u9635\u8fd0\u7b97\uff09\u3002\u901a\u8fc7\u8f7b\u91cf\u7ea7\u7f16\u7a0b\u63a5\u53e3\uff0c\u7a0b\u5e8f\u5458\u6307\u5b9a\u6570\u636e\u7ed3\u6784\u548c\u8fed\u4ee3\u8fb9\u754c\uff0c\u786c\u4ef6\u8bb0\u5f55\u9996\u6b21\u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217\u5e76\u540e\u7eed\u56de\u653e\u9884\u53d6\u3002\u8be5\u65b9\u6cd5\u5728PageRank\u7b49\u56fe\u5e94\u7528\u4e0a\u5e73\u5747\u63d0\u901f2.16\u500d\uff0c\u5728\u7a00\u758f\u8fed\u4ee3\u6c42\u89e3\u5668\u4e0a\u63d0\u901f2.91\u500d\uff0c\u9884\u53d6\u51c6\u786e\u7387\u548c\u8986\u76d6\u7387\u5747\u8d8595%\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/awesome-data-prefetchers/#rpg2-robust-profile-guided-runtime-prefetch-generation","title":"RPG2: Robust Profile-Guided Runtime Prefetch Generation","text":"<p>Authors: Yuxuan Zhang, Nathan Sobotka, Soyoon Park, et al. Affiliations: University of Pennsylvania, University of California, Santa Cruz, Columbia University, University of Washington, Google, Intel Venue: ASPLOS 2024</p> <p>RPG2 \u662f\u4e00\u4e2a\u7eaf\u8f6f\u4ef6\u7684\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u7528\u4e8e\u52a8\u6001\u6ce8\u5165\u548c\u8c03\u4f18\u6570\u636e\u9884\u53d6\u3002\u5b83\u901a\u8fc7\u5728\u7ebf\u5206\u6790\u7a0b\u5e8f\u884c\u4e3a\uff0c\u81ea\u52a8\u63d2\u5165\u9884\u53d6\u6307\u4ee4\u5e76\u5b9e\u65f6\u8c03\u6574\u9884\u53d6\u8ddd\u79bb\uff0c\u4ee5\u5e94\u5bf9\u4e0d\u540c\u8f93\u5165\u548c\u5fae\u67b6\u6784\u4e0b\u7684\u6027\u80fd\u654f\u611f\u6027\u3002\u5f53\u9884\u53d6\u6709\u5bb3\u65f6\uff0cRPG2 \u80fd\u56de\u6eda\u5230\u539f\u59cb\u4ee3\u7801\u3002\u5b9e\u9a8c\u8868\u660e\uff0cRPG2 \u5728\u591a\u79cd\u8d1f\u8f7d\u4e0a\u53ef\u83b7\u5f97\u6700\u9ad82.15\u500d\u7684\u52a0\u901f\uff0c\u5e76\u6709\u6548\u907f\u514d\u4e86\u9759\u6001\u7f16\u8bd1\u5668\u65e0\u6cd5\u5904\u7406\u7684\u6027\u80fd\u4e0b\u964d\u95ee\u9898\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/micro-2025/","title":"MICRO 2025","text":"<p>MICRO 2025 \u8bba\u6587</p> <p>\u672c\u9875\u9762\u5171\u6536\u5f55\u4e86 2 \u7bc7\u8bba\u6587\u7b14\u8bb0\u3002</p>"},{"location":"collections/micro-2025/#rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding","title":"RICH Prefetcher: Storing Rich Information in Memory to Trade Capacity and Bandwidth for Latency Hiding","text":"<p>Authors: Ningzhi Ai, Wenjian He, Hu He, et al. Affiliations: Huawei Technologies Co., Ltd, Tsinghua University Venue: MICRO 2025</p> <p>\u9488\u5bf9\u9ad8\u5e26\u5bbd/\u5927\u5bb9\u91cf\u4f46\u9ad8\u5ef6\u8fdf\u7684\u672a\u6765\u5185\u5b58\u7cfb\u7edf\uff0c\u63d0\u51faRICH\u9884\u53d6\u5668\u3002\u5176\u6838\u5fc3\u521b\u65b0\u662f\u5229\u7528\u4e30\u5bcc\u7684\u5143\u6570\u636e\uff0c\u901a\u8fc7\u591a\u5c3a\u5ea6\u533a\u57df\uff082KB/4KB/16KB\uff09\u548c\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u534f\u540c\u5de5\u4f5c\uff0c\u5728\u4fdd\u6301\u9ad8\u7cbe\u5ea6\u7684\u540c\u65f6\u63d0\u5347\u8986\u76d6\u7387\u548c\u53ca\u65f6\u6027\u3002\u4e3a\u63a7\u5236\u5f00\u9500\uff0c\u91c7\u7528\u7247\u4e0a/\u7247\u4e0b\u5206\u5c42\u5b58\u50a8\u5143\u6570\u636e\u3002\u5b9e\u9a8c\u8868\u660e\uff0c\u5728\u4f20\u7edf\u7cfb\u7edf\u4e2d\u6027\u80fd\u4f18\u4e8eBingo 3.4%\uff0c\u5728\u589e\u52a0120ns\u5ef6\u8fdf\u7684\u9ad8\u5ef6\u8fdf\u7cfb\u7edf\u4e2d\u4f18\u52bf\u6269\u5927\u81f38.3%\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"collections/micro-2025/#titan-i-an-open-source-high-performance-risc-v-vector-core","title":"Titan-I: An Open-Source, High Performance RISC-V Vector Core","text":"<p>Authors: Jiuyang Liu, Qinjun Li, Yunqian Luo, et al. Affiliations: Huazhong University of Science and Technology, Institute of Software, Chinese Academy of Sciences, Tsinghua University, Xinpian Technology Co., Ltd. Venue: MICRO 2025</p> <p>\u63d0\u51faTitan-I (T1)\uff0c\u4e00\u4e2a\u5f00\u6e90\u3001\u9ad8\u6027\u80fd\u7684\u4e71\u5e8fRISC-V\u5411\u91cf\u6838\uff0c\u901a\u8fc7\u7c97\u7c92\u5ea6\u5e03\u5c40\u89c4\u5212\u5668\u3001\u6570\u636e\u901a\u8def\u7ea7\u7f6e\u6362\u5355\u5143\u548c\u63a9\u7801\u5bc4\u5b58\u5668\u7f13\u5b58\u89e3\u51b3VLEN/DLEN\u6269\u5c55\u96be\u9898\uff0c\u5e76\u91c7\u7528\u7ec6\u7c92\u5ea6\u94fe\u63a5\u3001\u63d0\u4ea4\u5373\u53d1\u5c04\u7b49\u6280\u672f\u63d0\u5347ILP\u3002\u5728\u5bc6\u7801\u5b66 workload \u4e0a\uff0cT1\u4ee540%\u9762\u79ef\u5b9e\u73b0\u5bf9Nvidia 3090/5090\u6700\u9ad82.41\u500d/1.85\u500d\u52a0\u901f\uff1b\u5728HPC\u4e0a\uff0c\u4ee519%\u9762\u79ef\u8fbe\u5230HiSilicon TaiShan V120\u6027\u80fd\uff0c\u5e76\u57284\u500d\u6570\u636e\u901a\u8def\u6269\u5c55\u4e0b\u83b7\u5f974.59\u500d\u52a0\u901f\u3002</p> <p>\ud83d\udcc4 \u8bba\u6587\u7b14\u8bb0 | \ud83d\udcca \u56fe\u8868\u89e3\u6790 | \ud83d\udc76 ELI5 \u89e3\u91ca</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/ELI5_notes/","title":"BOLT: A Practical Binary Optimizer for Data Centers and Beyond \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684 Feedback-Directed Optimization (FDO) \u6216 Profile-Guided Optimization (PGO) \u9700\u8981\u5728\u7f16\u8bd1\u65f6\u5c31\u6ce8\u5165\u6027\u80fd\u5206\u6790\u6570\u636e\u3002\u4f46\u73b0\u4ee3\u8d85\u5927\u89c4\u6a21\u7684\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\uff08\u5982 Facebook \u7684 HHVM\uff09\u6839\u672c\u6ca1\u6cd5\u7528\u201c\u63d2\u6869\u201d\uff08instrumentation\uff09\u7684\u65b9\u5f0f\u53bb\u6536\u96c6 profile\uff0c\u56e0\u4e3a\u5f00\u9500\u592a\u5927\uff0c\u4f1a\u62d6\u57ae\u751f\u4ea7\u73af\u5883\u3002</li> <li>\u5373\u4fbf\u9000\u800c\u6c42\u5176\u6b21\uff0c\u7528 sample-based profiling\uff08\u6bd4\u5982 Linux <code>perf</code>\uff09\uff0c\u628a\u5728\u4e8c\u8fdb\u5236\u4e0a\u91c7\u6837\u7684\u6570\u636e\u201c\u5012\u63a8\u201d\u56de\u7f16\u8bd1\u5668\u7684\u4e2d\u95f4\u8868\u793a\uff08IR\uff09\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e5f\u6781\u4e0d\u51c6\u786e\u3002\u5c31\u50cf\u8bba\u6587\u91cc Figure 2 \u5c55\u793a\u7684\u90a3\u6837\uff1a\u4e00\u4e2a\u51fd\u6570\u88ab\u5185\u8054\u5230\u591a\u4e2a\u5730\u65b9\u540e\uff0c\u6bcf\u4e2a\u8c03\u7528\u70b9\u7684\u6700\u4f73\u4ee3\u7801\u5e03\u5c40\u53ef\u80fd\u5b8c\u5168\u4e0d\u540c\uff0c\u4f46\u7f16\u8bd1\u5668\u5c42\u9762\u770b\u5230\u7684\u53ea\u662f\u4e00\u4e2a\u6a21\u7cca\u7684\u3001\u5e73\u5747\u5316\u7684 profile\uff0c\u5bfc\u81f4\u5b83\u65e0\u6cd5\u505a\u51fa\u6700\u4f18\u51b3\u7b56\u3002</li> <li>\u56e0\u6b64\uff0c\u5373\u4f7f\u4f60\u7528\u4e86\u6700\u5148\u8fdb\u7684 LTO (Link-Time Optimization) \u548c FDO\uff0c\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u4f9d\u7136\u5b58\u5728\u5927\u91cf\u201c\u524d\u7aef\u74f6\u9888\u201d\uff08front-end bound\uff09\u2014\u2014\u6307\u4ee4\u7f13\u5b58\uff08I-cache\uff09\u3001\u6307\u4ee4 TLB\uff08I-TLB\uff09\u548c\u5206\u652f\u9884\u6d4b\u5668\u538b\u529b\u5de8\u5927\uff0c\u56e0\u4e3a\u4ee3\u7801\u5e03\u5c40\u4e0d\u591f\u597d\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <p>\u60f3\u8c61\u4f60\u8981\u91cd\u65b0\u89c4\u5212\u4e00\u4e2a\u8d85\u5927\u7269\u6d41\u4ed3\u5e93\uff08\u4f60\u7684\u7a0b\u5e8f\u4e8c\u8fdb\u5236\uff09\u91cc\u7684\u8d27\u67b6\u6446\u653e\u3002</p> <ul> <li>\u4f20\u7edf\u7f16\u8bd1\u5668 FDO \u7684\u505a\u6cd5\uff1a\u5b83\u62ff\u7740\u4e00\u4efd\u4ece\u65e0\u4eba\u673a\uff08\u91c7\u6837\u5668\uff09\u90a3\u91cc\u62ff\u5230\u7684\u3001\u6a21\u7cca\u4e0d\u6e05\u7684\u70ed\u529b\u56fe\uff08profile\uff09\uff0c\u8bd5\u56fe\u5728\u8bbe\u8ba1\u4ed3\u5e93\u84dd\u56fe\uff08\u6e90\u4ee3\u7801/IR\uff09\u7684\u65f6\u5019\u5c31\u628a\u6700\u7545\u9500\u7684\u5546\u54c1\uff08hot code\uff09\u653e\u5728\u79bb\u51fa\u8d27\u53e3\u6700\u8fd1\u7684\u5730\u65b9\u3002\u4f46\u5b83\u4e0d\u77e5\u9053\uff0c\u7b49\u4ed3\u5e93\u771f\u6b63\u5efa\u597d\u540e\uff08\u94fe\u63a5\u3001\u4f18\u5316\u5b8c\u6210\uff09\uff0c\u5185\u90e8\u901a\u9053\u548c\u8d27\u67b6\u7ed3\u6784\u5df2\u7ecf\u53d8\u4e86\uff0c\u90a3\u4efd\u84dd\u56fe\u4e0a\u7684\u89c4\u5212\u5f88\u53ef\u80fd\u5b8c\u5168\u5931\u6548\u3002</li> <li>BOLT \u7684\u505a\u6cd5\uff1a\u5b83\u7b49\u4ed3\u5e93\u5b8c\u5168\u5efa\u597d\u3001\u751a\u81f3\u5df2\u7ecf\u5f00\u59cb\u8fd0\u8425\u4e4b\u540e\uff0c\u518d\u6d3e\u4e00\u4e2a\u5de1\u89c6\u5458\uff08sample-based profiler\uff09\u8fdb\u53bb\uff0c\u7cbe\u786e\u8bb0\u5f55\u4e0b\u54ea\u4e9b\u8d27\u67b6\u88ab\u8bbf\u95ee\u5f97\u6700\u591a\u3001\u5de5\u4eba\uff08CPU\uff09\u8d70\u54ea\u4e9b\u8def\u6700\u9891\u7e41\u3002\u7136\u540e\uff0c\u5b83\u76f4\u63a5\u5728\u73b0\u573a\uff08\u4e8c\u8fdb\u5236\u5c42\u9762\uff09\u52a8\u624b\uff0c\u628a\u70ed\u95e8\u5546\u54c1\u632a\u5230\u4e00\u8d77\uff0c\u628a\u51b7\u95e8\u5546\u54c1\u6253\u5305\u6254\u5230\u4ed3\u5e93\u89d2\u843d\u3002\u5b83\u4e0d\u9700\u8981\u61c2\u5efa\u7b51\u56fe\u7eb8\uff08\u6e90\u4ee3\u7801\uff09\uff0c\u5b83\u53ea\u5173\u5fc3\u6700\u7ec8\u5efa\u6210\u7684\u5b9e\u4f53\u4ed3\u5e93\uff08binary\uff09\u91cc\u7684\u771f\u5b9e\u4eba\u6d41\u3002</li> </ul> <p></p> <p>Fig. 2: Example showing a challenge in mapping binary-level events back to higher-level code representations.</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u53bb\u6539\u8fdb\u7f16\u8bd1\u5668\u6216\u94fe\u63a5\u5668\uff0c\u800c\u662f\u5de7\u5999\u5730\u5c06\u6574\u4e2a\u4f18\u5316\u6d41\u7a0b\u63a8\u8fdf\u5230\u4e86\u6700\u540e\u4e00\u6b65\u2014\u2014\u5728\u6700\u7ec8\u7684\u3001\u53ef\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e0a\u76f4\u63a5\u8fdb\u884c\u91cd\u5199\u3002</p> <ul> <li>BOLT \u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1aProfile \u6570\u636e\u662f\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u91c7\u96c6\u7684\uff0c\u90a3\u4e48\u5c31\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u4f7f\u7528\u5b83\uff0c\u907f\u514d\u4efb\u4f55\u4fe1\u606f\u635f\u5931\u3002\u8fd9\u89e3\u51b3\u4e86 AutoFDO \u7b49\u6280\u672f\u4e2d\u201cprofile retrofiting\u201d\uff08\u5c06 profile \u6620\u5c04\u56de IR\uff09\u8fd9\u4e2a\u6839\u672c\u6027\u7684\u7cbe\u5ea6\u95ee\u9898\u3002</li> <li>\u5b83\u6784\u5efa\u4e86\u4e00\u4e2a\u57fa\u4e8e LLVM \u7684\u5f3a\u5927\u4e8c\u8fdb\u5236\u91cd\u5199\u6846\u67b6\uff0c\u80fd\u591f\uff1a</li> <li>\u7cbe\u786e\u5730\u53cd\u6c47\u7f16\u5e76\u91cd\u5efa\u6bcf\u4e2a\u51fd\u6570\u7684 Control-Flow Graph (CFG)\u3002</li> <li>\u5229\u7528\u9ad8\u7cbe\u5ea6\u7684\u91c7\u6837\u6570\u636e\uff08\u5c24\u5176\u662f Intel \u7684 LBR, Last Branch Record\uff09\u6765\u83b7\u53d6\u51c6\u786e\u7684\u5206\u652f\u548c\u8c03\u7528\u9891\u7387\u3002</li> <li>\u6267\u884c\u4e00\u7cfb\u5217\u9488\u5bf9\u4ee3\u7801\u5e03\u5c40\u7684\u4f18\u5316\uff0c\u5176\u4e2d\u6700\u5173\u952e\u7684\u662f\uff1a<ul> <li>Basic Block Reordering: \u5c06\u6700\u70ed\u7684\u6267\u884c\u8def\u5f84\u53d8\u6210\u201cfall-through\u201d\uff0c\u6781\u5927\u51cf\u5c11\u5206\u652f\u8df3\u8f6c\u3002</li> <li>Function Reordering (via HFSort): \u6839\u636e\u8c03\u7528\u56fe\u5c06\u7ecf\u5e38\u4e00\u8d77\u88ab\u8c03\u7528\u7684\u51fd\u6570\u5728\u5185\u5b58\u4e2d\u7d27\u5bc6\u6392\u5217\uff0c\u63d0\u5347 I-TLB \u548c I-cache \u6548\u7387\u3002</li> <li>Function Splitting: \u5c06\u51fd\u6570\u4e2d\u7684\u51b7\u4ee3\u7801\u5757\u5265\u79bb\u51fa\u6765\uff0c\u653e\u5230\u5355\u72ec\u7684\u533a\u57df\uff0c\u8ba9\u70ed\u4ee3\u7801\u533a\u57df\u66f4\u52a0\u7d27\u51d1\u3002</li> </ul> </li> <li>\u8fd9\u4e2a\u601d\u8def\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u627f\u8ba4\u4e86\u7f16\u8bd1\u5668\u548c\u94fe\u63a5\u5668\u7684\u5c40\u9650\u6027\uff0c\u5e76\u9009\u62e9\u5728\u4e00\u4e2a\u4fe1\u606f\u6700\u5b8c\u6574\u3001\u6700\u51c6\u786e\u7684\u9636\u6bb5\uff08post-link\uff09\u6765\u89e3\u51b3\u4e00\u4e2a\u7279\u5b9a\u7684\u3001\u5bf9\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\u81f3\u5173\u91cd\u8981\u7684\u95ee\u9898\uff08code layout\uff09\u3002\u5b83\u4e0d\u662f\u8981\u53d6\u4ee3 LTO/FDO\uff0c\u800c\u662f\u4f5c\u4e3a\u5b83\u4eec\u7684\u5b8c\u7f8e\u4e92\u8865\u3002\u6b63\u5982\u8bba\u6587\u7ed3\u8bba\u6240\u8bf4\uff1a\u201cusing both approaches leads to the highest efficiency\u201d\u3002</li> </ul> <p>\u6700\u7ec8\u6548\u679c\u975e\u5e38\u663e\u8457\uff1a\u5bf9\u4e8e\u50cf Clang \u548c GCC \u8fd9\u6837\u7684\u5927\u578b\u7f16\u8bd1\u5668\uff0c\u5728\u5df2\u7ecf\u5e94\u7528\u4e86 LTO \u548c FDO \u7684\u57fa\u7840\u4e0a\uff0cBOLT \u4f9d\u7136\u80fd\u5e26\u6765\u9ad8\u8fbe 15.0% \u548c 20.4% \u7684\u6027\u80fd\u63d0\u5347\u3002</p> <p></p> <p>Fig. 5: Performance improvements from BOLT for our set of Facebook data-center workloads.</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/ELI5_notes/#1-llvm-eli5","title":"1. \u57fa\u4e8eLLVM\u7684\u4e8c\u8fdb\u5236\u91cd\u5199\u67b6\u6784 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u4e8c\u8fdb\u5236\u4f18\u5316\u5668\uff08\u6bd4\u5982\u8001\u65e7\u7684Spike\u3001FDPR\uff09\u901a\u5e38\u662f\u4e3a\u7279\u5b9a\u67b6\u6784\uff08\u5982Alpha\u3001Itanium\uff09\u4ece\u96f6\u5f00\u59cb\u6253\u9020\u7684\u201c\u4e00\u6b21\u6027\u201d\u5de5\u5177\u3002\u8fd9\u5bfc\u81f4\u4e24\u4e2a\u5de8\u5927\u75db\u70b9\uff1a   - \u79fb\u690d\u6210\u672c\u6781\u9ad8\uff1a\u60f3\u628a\u4e00\u4e2ax86\u7684\u4f18\u5316\u5668\u642c\u5230ARM\u4e0a\uff0c\u51e0\u4e4e\u7b49\u4e8e\u91cd\u5199\u4e00\u904d\uff0c\u56e0\u4e3a\u5e95\u5c42\u7684\u6307\u4ee4\u96c6\u89e3\u6790\u3001\u4ee3\u7801\u751f\u6210\u903b\u8f91\u5168\u90e8\u8981\u6362\u3002   - \u5065\u58ee\u6027\u5dee\uff1a\u81ea\u5df1\u9020\u8f6e\u5b50\u53bb\u89e3\u6790\u590d\u6742\u7684x86-64\u6307\u4ee4\u6d41\uff0c\u5f88\u5bb9\u6613\u51fa\u9519\uff0c\u5c24\u5176\u9762\u5bf9\u624b\u5199\u7684\u6c47\u7f16\u3001\u590d\u6742\u7684\u63a7\u5236\u6d41\u6216\u94fe\u63a5\u5668\u751f\u6210\u7684\u7279\u6b8a\u4ee3\u7801\u65f6\uff0c\u5de5\u5177\u53ef\u80fd\u76f4\u63a5\u5d29\u6e83\u6216\u4ea7\u751f\u9519\u8bef\u7ed3\u679c\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u8fd9\u5c31\u50cf\u4f60\u8981\u5728\u4e16\u754c\u5404\u5730\u5f00\u8fde\u9501\u9910\u5385\u3002\u8001\u529e\u6cd5\u662f\u6bcf\u5230\u4e00\u4e2a\u65b0\u57ce\u5e02\uff0c\u5c31\u627e\u4e00\u5e2e\u672c\u5730\u5de5\u5320\uff0c\u4ece\u4f10\u6728\u70e7\u7816\u5f00\u59cb\uff0c\u5b8c\u5168\u624b\u5de5\u76d6\u4e00\u5ea7\u65b0\u53a8\u623f\u3002\u8fd9\u4e0d\u4ec5\u6162\uff0c\u800c\u4e14\u6bcf\u4e2a\u53a8\u623f\u7684\u5e03\u5c40\u3001\u8bbe\u5907\u63a5\u53e3\u90fd\u4e0d\u4e00\u6837\uff0c\u4f60\u5f88\u96be\u4fdd\u8bc1\u83dc\u54c1\u8d28\u91cf\u548c\u8fd0\u8425\u6548\u7387\u3002 - BOLT\u7684\u505a\u6cd5\u5219\u662f\uff0c\u76f4\u63a5\u91c7\u7528\u4e00\u5957\u6210\u719f\u7684\u3001\u6a21\u5757\u5316\u7684\u9884\u5236\u53a8\u623f\u7cfb\u7edf\uff08LLVM\uff09\u3002\u8fd9\u5957\u7cfb\u7edf\u5df2\u7ecf\u5728\u5168\u7403\u5404\u79cd\u5efa\u7b51\u89c4\u8303\uff08CPU\u67b6\u6784\uff09\u4e0b\u9a8c\u8bc1\u8fc7\uff0c\u5e76\u4e14\u6240\u6709\u7076\u53f0\uff08\u53cd\u6c47\u7f16\u5668\uff09\u3001\u51b0\u7bb1\uff08\u4ee3\u7801\u6a21\u578b\uff09\u3001\u7ba1\u9053\uff08\u91cd\u5b9a\u4f4d\u5904\u7406\uff09\u90fd\u4f7f\u7528\u6807\u51c6\u63a5\u53e3\u3002\u4f60\u53ea\u9700\u8981\u6839\u636e\u5f53\u5730\u83dc\u5355\uff08\u4f18\u5316\u76ee\u6807\uff09\u8c03\u6574\u4e00\u4e0b\u5185\u90e8\u914d\u7f6e\uff0c\u5c31\u80fd\u5feb\u901f\u3001\u53ef\u9760\u5730\u5f00\u4e1a\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u5e76\u6ca1\u6709\u4ece\u5934\u6784\u5efa\u4e00\u4e2a\u8106\u5f31\u7684\u3001\u4e13\u7528\u7684\u4e8c\u8fdb\u5236\u5206\u6790\u5f15\u64ce\uff0c\u800c\u662f\u5de7\u5999\u5730\u5c06\u6574\u4e2a\u4f18\u5316\u6d41\u7a0b\u5ac1\u63a5\u5230\u4e86LLVM\u8fd9\u4e2a\u6210\u719f\u7684\u7f16\u8bd1\u5668\u57fa\u7840\u8bbe\u65bd\u4e4b\u4e0a\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u4ed6\u4eec\u5229\u7528\u4e86LLVM\u7684\u51e0\u4e2a\u6838\u5fc3\u80fd\u529b\u6765\u89e3\u51b3\u4e0a\u8ff0\u75db\u70b9\uff1a</p> <ul> <li>\u5229\u7528LLVM\u7684MC\u5c42\u8fdb\u884c\u7cbe\u51c6\u89e3\u6790\u4e0e\u751f\u6210\uff1a</li> <li>LLVM\u7684<code>MCInst</code>\uff08Machine Instruction\uff09\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e0e\u67b6\u6784\u65e0\u5173\u7684\u3001\u7cbe\u786e\u7684\u673a\u5668\u6307\u4ee4\u4e2d\u95f4\u8868\u793a\u3002BOLT\u901a\u8fc7LLVM\u7684TableGen\u751f\u6210\u7684\u53cd\u6c47\u7f16\u5668\uff0c\u5c06\u539f\u59cb\u4e8c\u8fdb\u5236\u5b57\u8282\u7801\u5b89\u5168\u3001\u51c6\u786e\u5730\u8f6c\u6362\u6210<code>MCInst</code>\u5e8f\u5217\u3002</li> <li> <p>\u5728\u4f18\u5316\u5b8c\u6210\u540e\uff0c\u518d\u7528LLVM\u7684\u6c47\u7f16\u5668\u5c06\u4fee\u6539\u540e\u7684<code>MCInst</code>\u5e8f\u5217\u91cd\u65b0\u7f16\u7801\u56de\u76ee\u6807\u67b6\u6784\u7684\u673a\u5668\u7801\u3002\u8fd9\u786e\u4fdd\u4e86\u4ee3\u7801\u751f\u6210\u7684\u6b63\u786e\u6027\u548c\u53ef\u9760\u6027\u3002</p> </li> <li> <p>\u501f\u529bLLVM\u7684\u591a\u67b6\u6784\u652f\u6301\u5b9e\u73b0\u8f7b\u677e\u79fb\u690d\uff1a</p> </li> <li>\u56e0\u4e3aLLVM\u672c\u8eab\u5c31\u652f\u6301x86, ARM, AArch64\u7b49\u591a\u79cd\u540e\u7aef\uff0cBOLT\u7684\u6838\u5fc3\u903b\u8f91\uff08\u5982CFG\u6784\u5efa\u3001\u4f18\u5316Pass\u8c03\u5ea6\uff09\u53ef\u4ee5\u5b8c\u5168\u4e0e\u67b6\u6784\u89e3\u8026\u3002</li> <li> <p>\u8bba\u6587\u4e2d\u63d0\u5230\uff0c\u4e3aARM\u67b6\u6784\u5f00\u53d1\u4e00\u4e2a\u539f\u578b\u53ea\u82b1\u4e86\u4e0d\u5230\u4e00\u4e2a\u6708\uff0c\u8fd9\u5145\u5206\u8bc1\u660e\u4e86\u8be5\u67b6\u6784\u7684\u5de8\u5927\u4f18\u52bf\u3002\u4f60\u4e0d\u9700\u8981\u6210\u4e3a\u6240\u6709CPU\u7684\u4e13\u5bb6\uff0c\u53ea\u9700\u8981\u7406\u89e3LLVM\u7684\u901a\u7528\u63a5\u53e3\u3002</p> </li> <li> <p>\u590d\u7528LLVM\u7684\u94fe\u63a5\u4e0e\u91cd\u5b9a\u4f4d\u57fa\u7840\u8bbe\u65bd\uff1a</p> </li> <li>\u4e8c\u8fdb\u5236\u91cd\u5199\u6700\u68d8\u624b\u7684\u95ee\u9898\u4e4b\u4e00\u662f\u5982\u4f55\u5904\u7406\u4ee3\u7801\u79fb\u52a8\u540e\u4ea7\u751f\u7684\u5730\u5740\u5f15\u7528\u5931\u6548\u3002BOLT\u5229\u7528\u4e86LLVM\u7684\u8fd0\u884c\u65f6\u52a8\u6001\u94fe\u63a5\u5668\uff08\u6700\u521d\u4e3aJIT\u8bbe\u8ba1\uff09\u6765\u89e3\u6790\u548c\u4fee\u590d\u51fd\u6570\u95f4\u53ca\u57fa\u672c\u5757\u95f4\u7684\u5f15\u7528\uff0c\u6781\u5927\u5730\u7b80\u5316\u4e86\u91cd\u5199\u8fc7\u7a0b\u7684\u590d\u6742\u6027\u3002</li> </ul> <p></p> <p>Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.</p> <p>\u8fd9\u4e2a\u67b6\u6784\u56fe\u6e05\u6670\u5730\u5c55\u793a\u4e86BOLT\u5982\u4f55\u5c06LLVM\u4f5c\u4e3a\u5176\u201c\u5f15\u64ce\u201d\u3002\u5b83\u628a\u590d\u6742\u7684\u3001\u5bb9\u6613\u51fa\u9519\u7684\u5e95\u5c42\u7ec6\u8282\uff08Disassembly/Assembly, Relocations\uff09\u5916\u5305\u7ed9\u4e86\u7ecf\u8fc7\u5de5\u4e1a\u7ea7\u9a8c\u8bc1\u7684LLVM\uff0c\u800c\u81ea\u5df1\u5219\u4e13\u6ce8\u4e8e\u5b9e\u73b0\u9ad8\u5c42\u6b21\u7684\u3001\u4e0e\u67b6\u6784\u65e0\u5173\u7684\u4f18\u5316\u903b\u8f91\uff08\u5982\u57fa\u4e8eProfile\u7684\u4ee3\u7801\u5e03\u5c40\uff09\u3002\u8fd9\u662f\u4e00\u79cd\u5178\u578b\u7684\u201c\u7ad9\u5728\u5de8\u4eba\u80a9\u8180\u4e0a\u201d\u7684\u5de5\u7a0b\u667a\u6167\u3002</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/ELI5_notes/#2-eli5","title":"2. \u7cbe\u786e\u7684\u6837\u672c\u5206\u6790\u9a71\u52a8\u4ee3\u7801\u5e03\u5c40 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 Feedback-Driven Optimization (FDO) \u9700\u8981\u5c06\u8fd0\u884c\u65f6\u6536\u96c6\u7684\u6027\u80fd\u5256\u6790\u6570\u636e\uff08profile\uff09\u6620\u5c04\u56de\u7f16\u8bd1\u5668\u7684\u4e2d\u95f4\u8868\u793a\uff08IR\uff09\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u975e\u5e38\u201c\u96be\u53d7\u201d\uff0c\u56e0\u4e3a\uff1a     - \u7f16\u8bd1\u5668\u5728\u751f\u6210\u6700\u7ec8\u4e8c\u8fdb\u5236\u6587\u4ef6\u524d\uff0c\u4f1a\u8fdb\u884c\u5927\u91cf\u7684\u4f18\u5316\uff08\u5982 inlining, loop unrolling\uff09\uff0c\u5bfc\u81f4\u6e90\u4ee3\u7801/IR\u548c\u6700\u7ec8\u673a\u5668\u7801\u4e4b\u95f4\u5b58\u5728\u5de8\u5927\u7684\u9e3f\u6c9f\u3002     - \u5f53\u4f60\u8bd5\u56fe\u628a\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u91c7\u6837\u7684\u70ed\u70b9\u4fe1\u606f\uff08\u6bd4\u5982\u67d0\u4e2a\u5206\u652f\u7684\u8df3\u8f6c\u9891\u7387\uff09\u585e\u56de\u9ad8\u5c42IR\u65f6\uff0c\u4fe1\u606f\u4f1a\u4e25\u91cd\u5931\u771f\u3002\u5c31\u50cf\u8bba\u6587\u56fe2\u5c55\u793a\u7684\u90a3\u6837\uff0c\u4e00\u4e2a\u88ab\u5185\u8054\u4e86\u4e24\u6b21\u7684\u51fd\u6570\uff0c\u5176\u5185\u90e8\u7684\u5206\u652f\u5728\u4e8c\u8fdb\u5236\u91cc\u662f\u4e24\u4e2a\u72ec\u7acb\u7684\u5b9e\u4f8b\uff0c\u4f46\u5728IR\u91cc\u8fd8\u662f\u4e00\u4e2a\u3002\u5f3a\u884c\u5408\u5e76\u7edf\u8ba1\uff0c\u5c31\u4f1a\u5f97\u5230\u9519\u8bef\u768450/50\u6982\u7387\uff0c\u800c\u5b9e\u9645\u4e0a\u6bcf\u4e2a\u5b9e\u4f8b\u90fd\u53ef\u80fd\u662f99/1\u62161/99\u3002     - \u8fd9\u79cd\u4e0d\u51c6\u786e\u7684\u5256\u6790\u6570\u636e\u7528\u5728\u5bf9\u6570\u636e\u7cbe\u5ea6\u6781\u5176\u654f\u611f\u7684\u4ee3\u7801\u5e03\u5c40\uff08Code Layout\uff09\u4e0a\uff0c\u8f7b\u5219\u4f18\u5316\u65e0\u6548\uff0c\u91cd\u5219\u53cd\u800c\u964d\u4f4e\u6027\u80fd\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u8981\u91cd\u65b0\u89c4\u5212\u4e00\u4e2a\u5927\u578b\u7269\u6d41\u4ed3\u5e93\uff08CPU\u7684\u6307\u4ee4\u7f13\u5b58\u548c\u53d6\u6307\u5355\u5143\uff09\u7684\u8d27\u7269\uff08\u6307\u4ee4\uff09\u6446\u653e\u3002\u4f60\u7684\u76ee\u6807\u662f\u8ba9\u6700\u5e38\u88ab\u4e00\u8d77\u53d6\u7528\u7684\u8d27\u7269\u653e\u5728\u76f8\u90bb\u7684\u8d27\u67b6\u4e0a\uff0c\u51cf\u5c11\u53c9\u8f66\uff08\u53d6\u6307\u5355\u5143\uff09\u6765\u56de\u5954\u6ce2\u7684\u65f6\u95f4\u3002 - \u4f20\u7edfFDO\u7684\u505a\u6cd5\u662f\uff1a\u5148\u770b\u4e00\u4efd\u51e0\u4e2a\u6708\u524d\u3001\u57fa\u4e8e\u539f\u59cb\u8bbe\u8ba1\u56fe\u7eb8\uff08\u6e90\u4ee3\u7801/IR\uff09\u5236\u5b9a\u7684\u8d27\u7269\u6e05\u5355\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4efd\u53ef\u80fd\u5df2\u7ecf\u8fc7\u65f6\u7684\u6e05\u5355\u53bb\u6307\u6325\u5de5\u4eba\uff08\u7f16\u8bd1\u5668\uff09\u91cd\u65b0\u6446\u653e\u3002\u4f46\u4ed3\u5e93\u65e9\u5df2\u7ecf\u8fc7\u591a\u6b21\u6539\u9020\uff08\u7f16\u8bd1\u4f18\u5316\uff09\uff0c\u56fe\u7eb8\u548c\u73b0\u5b9e\u5bf9\u4e0d\u4e0a\u4e86\u3002 - BOLT\u7684\u505a\u6cd5\u5219\u662f\uff1a\u76f4\u63a5\u6d3e\u4e00\u4e2a\u89c2\u5bdf\u5458\uff08sample-based profiler\uff09\u7ad9\u5728\u4ed3\u5e93\u73b0\u573a\uff08binary level\uff09\uff0c\u7528\u9ad8\u6e05\u6444\u50cf\u5934\uff08Intel LBR\uff09\u7cbe\u786e\u8bb0\u5f55\u4e0b\u53c9\u8f66\u6bcf\u4e00\u6b21\u771f\u5b9e\u7684\u53d6\u8d27\u8def\u5f84\u548c\u9891\u7387\u3002\u7136\u540e\uff0c\u5b83\u81ea\u5df1\u52a8\u624b\uff08post-link optimizer\uff09\uff0c\u76f4\u63a5\u5728\u73b0\u573a\u632a\u52a8\u8d27\u7269\uff0c\u5b8c\u5168\u65e0\u89c6\u90a3\u5f20\u8fc7\u65f6\u7684\u56fe\u7eb8\u3002\u56e0\u4e3a\u5b83\u770b\u5230\u7684\u5c31\u662f\u771f\u76f8\uff0c\u6240\u4ee5\u80fd\u505a\u51fa\u6700\u7cbe\u51c6\u7684\u5e03\u5c40\u51b3\u7b56\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u5e76\u6ca1\u6709\u5c1d\u8bd5\u53bb\u4fee\u590d\u90a3\u4e2a\u8106\u5f31\u7684\u201c\u4ece\u4e8c\u8fdb\u5236\u5230IR\u201d\u7684\u6620\u5c04\u8fc7\u7a0b\uff0c\u800c\u662f\u5de7\u5999\u5730\u7ed5\u5f00\u4e86\u6574\u4e2a\u7f16\u8bd1\u5668\u524d\u7aef\u3002 - \u5177\u4f53\u6765\u8bf4\uff0cBOLT\u505a\u4e86\u4e00\u4e2a\u6839\u672c\u6027\u7684\u626d\u8f6c\uff1a\u5c06\u4f18\u5316\u7684\u6218\u573a\u4ece\u7f16\u8bd1\u671f/\u94fe\u63a5\u671f\uff0c\u76f4\u63a5\u642c\u5230\u4e86\u4e8c\u8fdb\u5236\u6587\u4ef6\u672c\u8eab\u3002     - \u5b83\u5229\u7528 perf \u7b49\u5de5\u5177\uff0c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5bf9\u672a\u7ecf\u4fee\u6539\u7684\u3001\u5df2\u53d1\u5e03\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u8fdb\u884c\u91c7\u6837\u3002\u7279\u522b\u662f\uff0c\u5b83\u91cd\u5ea6\u4f9d\u8d56 Intel LBR (Last Branch Record)\uff0c\u8fd9\u4e2a\u786c\u4ef6\u7279\u6027\u53ef\u4ee5\u7cbe\u786e\u8bb0\u5f55\u4e0b\u6700\u8fd132\u6b21taken branches\u7684\u5b8c\u6574\u8f68\u8ff9\u3002     - \u6709\u4e86LBR\u63d0\u4f9b\u7684\u7cbe\u786e\u8fb9\uff08edge\uff09\u7ea7\u5256\u6790\u6570\u636e\uff0cBOLT\u5c31\u80fd\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u76f4\u63a5\u3001\u65e0\u635f\u5730\u91cd\u5efa\u51fa\u6bcf\u4e2a\u51fd\u6570\u7684\u771f\u5b9e\u63a7\u5236\u6d41\u56fe\uff08CFG\uff09\u53ca\u5176\u6267\u884c\u9891\u7387\u3002     - \u57fa\u4e8e\u8fd9\u4e2a\u9ad8\u4fdd\u771f\u7684CFG\uff0cBOLT\u5c31\u80fd\u5b89\u5168\u5730\u6267\u884c\u90a3\u4e9b\u5bf9\u5256\u6790\u6570\u636e\u7cbe\u5ea6\u8981\u6c42\u6781\u9ad8\u7684\u4f18\u5316\uff0c\u6bd4\u5982\uff1a         - \u57fa\u672c\u5757\u91cd\u6392\u5e8f\uff08Basic Block Reordering\uff09\uff1a\u786e\u4fdd\u6700\u70ed\u7684\u6267\u884c\u8def\u5f84\u662f\u8fde\u7eed\u7684fall-through\uff0c\u6781\u5927\u51cf\u5c11taken branches\u7684\u6570\u91cf\u3002         - \u51fd\u6570\u91cd\u6392\u5e8f\uff08Function Reordering\uff09\uff1a\u4f7f\u7528 HFSort \u7b97\u6cd5\uff0c\u5c06\u7ecf\u5e38\u88ab\u5148\u540e\u8c03\u7528\u7684\u51fd\u6570\u5728\u5185\u5b58\u4e2d\u7d27\u5bc6\u6392\u5217\uff0c\u6539\u5584 I-TLB \u548c I-cache \u7684\u5c40\u90e8\u6027\u3002 - \u8fd9\u4e2a\u903b\u8f91\u8f6c\u6362\u7684\u6838\u5fc3\u5728\u4e8e\uff1a\u4e0e\u5176\u8d39\u529b\u5730\u628a\u73b0\u573a\u60c5\u62a5\u7ffb\u8bd1\u6210\u603b\u90e8\u80fd\u542c\u61c2\u7684\u6a21\u7cca\u62a5\u544a\uff0c\u4e0d\u5982\u76f4\u63a5\u6388\u6743\u73b0\u573a\u6307\u6325\u5b98\u5168\u6743\u5904\u7406\u3002\u8fd9\u4f7f\u5f97BOLT\u7684\u4f18\u5316\u4e0e\u7f16\u8bd1\u5668\u7684FDO/LTO\u5f62\u6210\u4e86\u5b8c\u7f8e\u7684\u4e92\u8865\uff0c\u800c\u4e0d\u662f\u7b80\u5355\u7684\u66ff\u4ee3\u3002</p> <p></p> <p>Fig. 2: Example showing a challenge in mapping binary-level events back to higher-level code representations.</p> <p></p> <p>Fig. 10: Real example of poor code layout produced by the Clang compiler (compiling itself) even with PGO. Block .LFT680413 is cold (Exec Count: 0), but it is placed between two hot blocks connected by a forward taken branch.</p> <p>\u8fd9\u79cd\u7b56\u7565\u7684\u6709\u6548\u6027\u5728\u8bba\u6587\u7684\u8bc4\u4f30\u4e2d\u5f97\u5230\u4e86\u5145\u5206\u4f53\u73b0\u3002\u4f8b\u5982\uff0c\u5728Clang\u7f16\u8bd1\u5668\u4e0a\uff0c\u5373\u4f7f\u5728\u5176\u5df2\u7ecf\u5e94\u7528\u4e86PGO+LTO\u7684\u60c5\u51b5\u4e0b\uff0cBOLT\u4f9d\u7136\u80fd\u901a\u8fc7\u66f4\u7cbe\u786e\u7684\u5e03\u5c40\uff0c\u5c06taken branches\u7684\u6570\u91cf\u518d\u51cf\u5c1144.3%\u3002</p> \u4f18\u5316\u5c42\u7ea7 Taken Branches \u51cf\u5c11\u91cf (vs Baseline) Clang Baseline 0% Clang + PGO+LTO ~40% Clang + PGO+LTO + BOLT 69.8% <p>\u8fd9\u7ec4\u6570\u636e\u6e05\u6670\u5730\u8bc1\u660e\u4e86\uff0c\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u5229\u7528\u7cbe\u786e\u5256\u6790\u6570\u636e\u8fdb\u884c\u4ee3\u7801\u5e03\u5c40\uff0c\u80fd\u591f\u6316\u6398\u51fa\u4f20\u7edf\u7f16\u8bd1\u671f\u4f18\u5316\u65e0\u6cd5\u89e6\u53ca\u7684\u5de8\u5927\u6027\u80fd\u6f5c\u529b\u3002</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/ELI5_notes/#3-eli5","title":"3. \u6df7\u5408\u51fd\u6570\u53d1\u73b0\u4e0e\u63a7\u5236\u6d41\u56fe\u91cd\u5efa (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <ul> <li>\u4f20\u7edf\u7684 \u9759\u6001\u4e8c\u8fdb\u5236\u5206\u6790 \u9762\u4e34\u4e00\u4e2a\u6839\u672c\u6027\u96be\u9898\uff1a\u7cbe\u786e\u5730\u627e\u5230\u51fd\u6570\u8fb9\u754c\u5e76\u91cd\u5efa\u63a7\u5236\u6d41\u56fe\uff08CFG\uff09\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u56e0\u4e3a\u7f16\u8bd1\u5668\u548c\u94fe\u63a5\u5668\u5728\u751f\u6210\u6700\u7ec8\u4e8c\u8fdb\u5236\u65f6\uff0c\u4f1a\u8fdb\u884c\u5927\u91cf\u4f18\u5316\uff08\u5982\u5185\u8054\u3001\u5c3e\u8c03\u7528\u4f18\u5316\u3001\u4ee3\u7801\u5e03\u5c40\u91cd\u6392\uff09\uff0c\u5bfc\u81f4\u539f\u59cb\u7684\u51fd\u6570\u7ed3\u6784\u4fe1\u606f\u4e25\u91cd\u4e22\u5931\u3002</li> <li>\u5982\u679c\u53ea\u4f9d\u8d56 ELF\u7b26\u53f7\u8868\uff0c\u5bf9\u4e8e\u90a3\u4e9b\u88ab\u6807\u8bb0\u4e3a <code>static</code> \u7684\u672c\u5730\u51fd\u6570\u6216\u8005\u624b\u5199\u7684\u6c47\u7f16\u4ee3\u7801\uff0c\u7b26\u53f7\u4fe1\u606f\u5f80\u5f80\u662f\u7f3a\u5931\u6216\u4e0d\u5b8c\u6574\u7684\u3002</li> <li>\u5982\u679c\u53ea\u4f9d\u8d56 DWARF\u8c03\u8bd5\u4fe1\u606f\uff08\u7279\u522b\u662fCall Frame Information, CFI\uff09\uff0c\u5f88\u591a\u751f\u4ea7\u73af\u5883\u4e0b\u7684\u53d1\u5e03\u7248\u4e8c\u8fdb\u5236\u4e3a\u4e86\u51cf\u5c0f\u4f53\u79ef\u4f1a\u76f4\u63a5\u5265\u79bb\u8fd9\u4e9b\u4fe1\u606f\uff0c\u800c\u4e14\u624b\u5199\u6c47\u7f16\u4e5f\u5e38\u5e38\u4e0d\u5305\u542bCFI\u3002</li> <li>\u8fd9\u5c31\u9020\u6210\u4e86\u4e00\u4e2a\u5c34\u5c2c\u5c40\u9762\uff1a\u6ca1\u6709\u51c6\u786e\u7684CFG\uff0c\u540e\u7eed\u6240\u6709\u57fa\u4e8e\u63a7\u5236\u6d41\u7684\u4f18\u5316\uff08\u6bd4\u5982\u70ed/\u51b7\u5757\u91cd\u6392\u3001\u95f4\u63a5\u8c03\u7528\u4f18\u5316\uff09\u90fd\u6210\u4e86\u65e0\u6e90\u4e4b\u6c34\uff0c\u751a\u81f3\u53ef\u80fd\u56e0\u4e3a\u9519\u8bef\u7684CFG\u800c\u5f15\u5165\u5d29\u6e83\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9</p> <ul> <li>\u60f3\u8c61\u4f60\u8981\u4fee\u590d\u4e00\u680b\u8001\u65e7\u516c\u5bd3\u697c\u7684\u7535\u8def\u3002\u4f60\u624b\u5934\u6709\u4e24\u4efd\u4e0d\u5b8c\u6574\u7684\u56fe\u7eb8\uff1a<ul> <li>\u7b2c\u4e00\u4efd\u662f\u4f4f\u6237\u540d\u5355\uff08ELF\u7b26\u53f7\u8868\uff09\uff0c\u5b83\u544a\u8bc9\u4f60\u6bcf\u6237\u4eba\u5bb6\uff08\u51fd\u6570\uff09\u7684\u5927\u81f4\u95e8\u724c\u53f7\uff08\u8d77\u59cb\u5730\u5740\uff09\uff0c\u4f46\u6ca1\u544a\u8bc9\u4f60\u6bcf\u6237\u5185\u90e8\u623f\u95f4\uff08\u57fa\u672c\u5757\uff09\u600e\u4e48\u8fde\u901a\uff0c\u800c\u4e14\u6709\u4e9b\u79df\u5ba2\uff08\u672c\u5730\u51fd\u6570\uff09\u6839\u672c\u6ca1\u767b\u8bb0\u3002</li> <li>\u7b2c\u4e8c\u4efd\u662f\u5efa\u7b51\u7ed3\u6784\u84dd\u56fe\uff08DWARF CFI\uff09\uff0c\u5b83\u8be6\u7ec6\u753b\u51fa\u4e86\u627f\u91cd\u5899\u548c\u623f\u6881\uff08\u6808\u5e27\u53d8\u5316\u70b9\uff09\uff0c\u80fd\u5e2e\u4f60\u63a8\u65ad\u51fa\u623f\u95f4\u7684\u8fb9\u754c\uff0c\u4f46\u8fd9\u5f20\u56fe\u5728\u88c5\u4fee\u65f6\u88ab\u623f\u4e1c\u6495\u6389\u4e86\u4e00\u5927\u534a\u3002</li> </ul> </li> <li>BOLT\u7684\u505a\u6cd5\u4e0d\u662f\u8d4c\u5176\u4e2d\u4e00\u5f20\u56fe\u662f\u5bf9\u7684\uff0c\u800c\u662f\u540c\u65f6\u62ff\u7740\u8fd9\u4e24\u5f20\u6b8b\u7f3a\u7684\u56fe\uff0c\u518d\u4eb2\u81ea\u53bb\u697c\u91cc\u8d70\u4e00\u904d\uff08\u53cd\u6c47\u7f16\u6307\u4ee4\u6d41\uff09\u3002\u5b83\u770b\u5230\u4e00\u5835\u627f\u91cd\u5899\uff08CFI\u6307\u4ee4\uff09\uff0c\u5c31\u786e\u8ba4\u8fd9\u662f\u4e00\u4e2a\u623f\u95f4\u7684\u8d77\u70b9\uff1b\u5b83\u770b\u5230\u95e8\u724c\u53f7\uff08\u7b26\u53f7\u8868\uff09\uff0c\u5c31\u786e\u8ba4\u8fd9\u662f\u4e00\u6237\u4eba\u5bb6\u7684\u5165\u53e3\u3002\u901a\u8fc7\u4ea4\u53c9\u9a8c\u8bc1\uff0c\u5b83\u5c31\u80fd\u5728\u8111\u6d77\u4e2d\u91cd\u5efa\u51fa\u6700\u63a5\u8fd1\u771f\u5b9e\u7684\u5b8c\u6574\u6237\u578b\u56fe\uff08CFG\uff09\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db</p> <ul> <li>BOLT\u5e76\u6ca1\u6709\u8bd5\u56fe\u53d1\u660e\u4e00\u79cd\u5168\u65b0\u7684\u3001\u80fd100%\u89e3\u51b3\u4e8c\u8fdb\u5236\u5206\u6790\u4e0d\u53ef\u5224\u5b9a\u95ee\u9898\u7684\u65b9\u6cd5\uff0c\u800c\u662f\u91c7\u7528\u4e86\u4e00\u79cd\u52a1\u5b9e\u4e14\u7a33\u5065\u7684\u6df7\u5408\u7b56\u7565\uff1a<ul> <li>\u7b2c\u4e00\u6b65\uff1a\u51fd\u6570\u53d1\u73b0\uff08Function Discovery\uff09\u3002\u5b83\u4f18\u5148\u4f7f\u7528 ELF\u7b26\u53f7\u8868 \u6765\u83b7\u53d6\u5df2\u77e5\u51fd\u6570\u7684\u540d\u79f0\u548c\u8d77\u59cb\u5730\u5740\u3002\u5bf9\u4e8e\u7b26\u53f7\u8868\u4e2d\u7f3a\u5931\u7684\u90e8\u5206\uff0c\u5b83\u4f1a\u5c1d\u8bd5\u5229\u7528 DWARF CFI \u4e2d\u8bb0\u5f55\u7684\u51fd\u6570\u8fb9\u754c\u4fe1\u606f\u4f5c\u4e3a\u8865\u5145\u3002</li> <li>\u7b2c\u4e8c\u6b65\uff1a\u4fdd\u5b88\u53cd\u6c47\u7f16\u4e0eCFG\u6784\u5efa\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u88ab\u8bc6\u522b\u51fa\u7684\u51fd\u6570\uff0cBOLT\u4f1a\u4ece\u5176\u5165\u53e3\u70b9\u5f00\u59cb\u8fdb\u884c\u7ebf\u6027\u626b\u63cf\u53cd\u6c47\u7f16\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u5b83\u4f1a\u7279\u522b\u5173\u6ce8\u4e24\u4e2a\u5173\u952e\u4fe1\u53f7\uff1a<ul> <li>\u5206\u652f\u6307\u4ee4\uff1a\u6240\u6709 <code>call</code>, <code>jmp</code>, <code>jcc</code> \u7b49\u6307\u4ee4\u7684\u76ee\u6807\u5730\u5740\u4f1a\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u7528\u4e8e\u6784\u5efa\u57fa\u672c\u5757\u4e4b\u95f4\u7684\u8fb9\u3002</li> <li>CFI\u6307\u4ee4\uff1a\u8fd9\u4e9b\u6307\u4ee4\uff08\u5982 <code>.cfi_def_cfa_offset</code>\uff09\u88ab\u7528\u4f5c\u951a\u70b9\uff0c\u5e2e\u52a9BOLT\u786e\u8ba4\u54ea\u4e9b\u6307\u4ee4\u5e8f\u5217\u5c5e\u4e8e\u540c\u4e00\u4e2a\u903b\u8f91\u4e0a\u7684\u201c\u6808\u5e27\u4e0a\u4e0b\u6587\u201d\uff0c\u8fd9\u5bf9\u4e8e\u5904\u7406\u5f02\u5e38\u5904\u7406\uff08\u5982C++ <code>throw</code>\uff09\u81f3\u5173\u91cd\u8981\uff0c\u786e\u4fddlanding pad\u80fd\u88ab\u6b63\u786e\u8bc6\u522b\u548c\u5173\u8054\u3002</li> </ul> </li> <li>\u7b2c\u4e09\u6b65\uff1a\u5931\u8d25\u5b89\u5168\uff08Fail-Safe\uff09\u3002\u5982\u679c\u5728\u53cd\u6c47\u7f16\u6216CFG\u6784\u5efa\u8fc7\u7a0b\u4e2d\u9047\u5230\u4efb\u4f55\u4e0d\u786e\u5b9a\u6027\uff08\u4f8b\u5982\uff0c\u65e0\u6cd5\u89e3\u6790\u4e00\u4e2a\u8df3\u8f6c\u76ee\u6807\uff0c\u6216\u8005\u53d1\u73b0\u6570\u636e\u88ab\u8bef\u8ba4\u4e3a\u4ee3\u7801\uff09\uff0cBOLT\u4f1a\u7acb\u5373\u653e\u5f03\u5bf9\u8be5\u51fd\u6570\u7684\u4f18\u5316\uff0c\u5c06\u5176\u539f\u5c01\u4e0d\u52a8\u5730\u4fdd\u7559\u5728\u4e8c\u8fdb\u5236\u4e2d\u3002\u8fd9\u79cd\u201c\u5b81\u53ef\u4e0d\u505a\uff0c\u4e5f\u4e0d\u505a\u9519\u201d\u7684\u7b56\u7565\u4fdd\u8bc1\u4e86\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u7edd\u5bf9\u5b89\u5168\u53ef\u9760\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.</p> <ul> <li>\u6b63\u662f\u8fd9\u79cd\u6df7\u5408\u65b9\u6cd5\uff0c\u8ba9BOLT\u80fd\u591f\u5904\u7406\u50cf HHVM \u8fd9\u6837\u5305\u542b\u5927\u91cfC++\u3001\u624b\u5199\u6c47\u7f16\u548c\u590d\u6742\u5f02\u5e38\u5904\u7406\u7684\u771f\u5b9e\u4e16\u754c\u5927\u578b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e76\u4e3a\u5176\u6784\u5efa\u51fa\u8db3\u591f\u7cbe\u786e\u7684\u5185\u90e8\u8868\u793a\uff0c\u4ece\u800c\u652f\u6491\u8d77\u540e\u7eed\u4e00\u7cfb\u5217\u5f3a\u5927\u7684\u4f18\u5316\uff0c\u5982\u56fe4\u6240\u793a\u7684\u5e26\u6709\u5f02\u5e38\u5904\u7406\u4fe1\u606f\u7684CFG\u3002</li> </ul> <p></p> <p>Fig. 4: Partial CFG dump for a function with C++ exceptions.</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/ELI5_notes/#4-eli5","title":"4. \u591a\u9636\u6bb5\u4f18\u5316\u6d41\u6c34\u7ebf (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684\u7f16\u8bd1\u5668\u4f18\u5316\uff08\u5982 FDO/PGO \u548c LTO\uff09\u867d\u7136\u5f3a\u5927\uff0c\u4f46\u5b83\u4eec\u5de5\u4f5c\u5728 \u6e90\u7801\u6216\u4e2d\u95f4\u8868\u793a\uff08IR\uff09\u5c42\u9762\u3002\u5f53\u7a0b\u5e8f\u6700\u7ec8\u88ab\u94fe\u63a5\u6210\u4e00\u4e2a\u5de8\u5927\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u540e\uff0c\u7f16\u8bd1\u5668\u5c31\u201c\u6492\u624b\u4e0d\u7ba1\u201d\u4e86\u3002</li> <li>\u8fd9\u5e26\u6765\u4e00\u4e2a\u6838\u5fc3\u77db\u76fe\uff1aProfile\u6570\u636e\u662f\u5728\u6700\u7ec8\u7684\u4e8c\u8fdb\u5236\u4e0a\u91c7\u96c6\u7684\uff08\u6bd4\u5982\u901a\u8fc7 <code>perf</code>\uff09\uff0c\u4f46\u7f16\u8bd1\u5668\u5374\u9700\u8981\u628a\u8fd9\u4e2a\u6570\u636e\u201c\u53cd\u5411\u6620\u5c04\u201d\u56de\u5b83\u65e9\u5df2\u4f18\u5316\u8fc7\u3001\u751a\u81f3\u5185\u8054\uff08inlined\uff09\u8fc7\u7684IR\u4e0a\u3002\u8fd9\u4e2a\u6620\u5c04\u8fc7\u7a0b\u4f1a\u4e22\u5931\u5927\u91cf\u7cbe\u5ea6\uff0c\u5c24\u5176\u662f\u5728\u5904\u7406\u8de8\u6a21\u5757\u5185\u8054\u6216\u590d\u6742\u7684\u63a7\u5236\u6d41\u65f6\uff0c\u5bfc\u81f4\u4ee3\u7801\u5e03\u5c40\uff08code layout\uff09\u51b3\u7b56\u5931\u8bef\u3002</li> <li>\u66f4\u96be\u53d7\u7684\u662f\uff0c\u73b0\u4ee3\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\u52a8\u8f84\u4e0a\u767eMB\u7684\u4ee3\u7801\uff0cI-cache \u548c I-TLB \u7684\u538b\u529b\u5de8\u5927\u3002\u54ea\u6015\u7f16\u8bd1\u5668\u505a\u4e86\u51fd\u6570\u91cd\u6392\uff0c\u51fd\u6570\u5185\u90e8\u7684\u57fa\u672c\u5757\uff08basic block\uff09\u5e03\u5c40\u5982\u679c\u4e00\u56e2\u7cdf\u2014\u2014\u70ed\u8def\u5f84\u4e0a\u5939\u6742\u7740\u51b7\u4ee3\u7801\u2014\u2014\u4f9d\u7136\u4f1a\u9020\u6210\u4e25\u91cd\u7684\u6027\u80fd\u6d6a\u8d39\u3002\u800c\u7f16\u8bd1\u5668\u5728IR\u5c42\u9762\u5f88\u96be\u7cbe\u786e\u611f\u77e5\u5230\u8fd9\u79cd\u4e8c\u8fdb\u5236\u7ea7\u522b\u7684\u5c40\u90e8\u6027\u95ee\u9898\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u662f\u4e00\u4f4d\u57ce\u5e02\u89c4\u5212\u5e08\uff08\u7f16\u8bd1\u5668\uff09\uff0c\u6839\u636e\u4e00\u4efd\u7c97\u7565\u7684\u4eba\u53e3\u6d41\u52a8\u62a5\u544a\uff08Profile\u6570\u636e\uff09\uff0c\u5728\u56fe\u7eb8\u4e0a\uff08IR\uff09\u89c4\u5212\u4e86\u4e00\u4e2a\u57ce\u5e02\u7684\u4e3b\u5e72\u9053\u548c\u793e\u533a\uff08\u51fd\u6570\u548c\u57fa\u672c\u5757\uff09\u3002\u4f46\u7b49\u57ce\u5e02\u771f\u7684\u5efa\u597d\u540e\uff08\u751f\u6210\u4e8c\u8fdb\u5236\uff09\uff0c\u4f60\u53d1\u73b0\u5b9e\u9645\u7684\u4eba\u6d41\uff08CPU\u6307\u4ee4\u6d41\uff09\u548c\u4f60\u7684\u56fe\u7eb8\u6709\u504f\u5dee\uff0c\u56e0\u4e3a\u65bd\u5de5\u961f\uff08\u94fe\u63a5\u5668\uff09\u4e3a\u4e86\u7701\u4e8b\uff0c\u5728\u67d0\u4e9b\u8857\u533a\u91cc\u628a\u70ed\u95e8\u5546\u94fa\u548c\u5e9f\u5f03\u4ed3\u5e93\u6df7\u5728\u4e00\u8d77\u5efa\u4e86\u3002</li> <li>BOLT\u5c31\u50cf\u662f\u4e00\u4e2a\u57ce\u5e02\u5efa\u6210\u540e\u7684\u7cbe\u7ec6\u5316\u6539\u9020\u56e2\u961f\u3002\u4ed6\u4eec\u4e0d\u63a8\u5012\u91cd\u5efa\uff08\u4e0d\u7528\u91cd\u65b0\u7f16\u8bd1\uff09\uff0c\u800c\u662f\u76f4\u63a5\u62ff\u7740\u9ad8\u7cbe\u5ea6\u7684\u5b9e\u65f6\u4eba\u6d41\u70ed\u529b\u56fe\uff08\u57fa\u4e8e LBR \u7684\u91c7\u6837\u6570\u636e\uff09\uff0c\u8d70\u8fdb\u6bcf\u4e00\u6761\u8857\u9053\uff08\u53cd\u6c47\u7f16\u4e8c\u8fdb\u5236\uff09\uff0c\u628a\u70ed\u95e8\u5546\u94fa\uff08hot basic blocks\uff09\u96c6\u4e2d\u5230\u6b65\u884c\u8857\u4e0a\uff0c\u628a\u5e9f\u5f03\u4ed3\u5e93\uff08cold code\uff09\u642c\u5230\u90ca\u533a\uff0c\u5e76\u4e14\u91cd\u65b0\u89c4\u5212\u793e\u533a\u5165\u53e3\uff08\u51fd\u6570\u91cd\u6392\uff09\uff0c\u8ba9\u6574\u4e2a\u57ce\u5e02\u7684\u4ea4\u901a\u6548\u7387\uff08CPU\u524d\u7aef\u6027\u80fd\uff09\u8fbe\u5230\u6700\u4f18\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>BOLT\u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1a\u4e0e\u5176\u8d39\u529b\u5730\u628a\u4e8c\u8fdb\u5236\u4e16\u754c\u7684\u7cbe\u51c6\u6570\u636e\u201c\u7ffb\u8bd1\u201d\u56de\u7f16\u8bd1\u5668\u4e16\u754c\u7684\u6a21\u7cca\u8bed\u8a00\uff0c\u4e0d\u5982\u76f4\u63a5\u5728\u4e8c\u8fdb\u5236\u4e16\u754c\u91cc\u89e3\u51b3\u95ee\u9898\u3002\u5b83\u7684\u591a\u9636\u6bb5\u6d41\u6c34\u7ebf\u6b63\u662f\u56f4\u7ed5\u8fd9\u4e00\u601d\u60f3\u6784\u5efa\u7684\uff1a</p> <ul> <li>\u7b2c\u4e00\u62db\uff1a\u7cbe\u51c6\u611f\u77e5\u3002BOLT\u5229\u7528 LLVM \u7684\u5f3a\u5927\u540e\u7aef\u80fd\u529b\uff0c\u5bf9\u6574\u4e2a\u4e8c\u8fdb\u5236\u8fdb\u884c\u7cbe\u786e\u53cd\u6c47\u7f16\uff0c\u5e76\u7ed3\u5408 DWARF \u8c03\u8bd5\u4fe1\u606f\u548c LBR \u91c7\u6837\u6570\u636e\uff0c\u6784\u5efa\u51fa\u6bcf\u4e2a\u51fd\u6570\u771f\u5b9e\u3001\u51c6\u786e\u7684\u63a7\u5236\u6d41\u56fe\uff08CFG\uff09\u548c\u6267\u884c\u9891\u7387\u3002\u8fd9\u89e3\u51b3\u4e86\u6570\u636e\u6620\u5c04\u5931\u771f\u7684\u6839\u672c\u95ee\u9898\u3002</li> <li>\u7b2c\u4e8c\u62db\uff1a\u5fae\u89c2\u91cd\u5851\u3002\u5728\u51fd\u6570\u5185\u90e8\uff0cBOLT\u6267\u884c reorder and split hot/cold basic blocks\u3002\u5b83\u8bc6\u522b\u51fa\u6700\u70ed\u7684\u6267\u884c\u8def\u5f84\uff0c\u5e76\u786e\u4fdd\u8fd9\u6761\u8def\u5f84\u4e0a\u7684\u5206\u652f\u5c3d\u53ef\u80fd\u5c11\u5730\u8df3\u8f6c\uff08fall-through\uff09\uff0c\u540c\u65f6\u5c06\u51b7\u4ee3\u7801\u7269\u7406\u62c6\u5206\u51fa\u53bb\u3002\u8fd9\u76f4\u63a5\u7f13\u89e3\u4e86 I-cache \u538b\u529b\u548c\u5206\u652f\u9884\u6d4b\u5668\u7684\u538b\u529b\u3002</li> <li>\u7b2c\u4e09\u62db\uff1a\u5b8f\u89c2\u8c03\u5ea6\u3002\u5728\u51fd\u6570\u4e4b\u95f4\uff0cBOLT\u5e94\u7528 HFSort \u7b97\u6cd5\uff0c\u6839\u636e\u8c03\u7528\u56fe\u7684\u70ed\u5ea6\u5bf9\u6240\u6709\u51fd\u6570\u8fdb\u884c\u5168\u5c40\u91cd\u6392\u3002\u8fd9\u6781\u5927\u5730\u6539\u5584\u4e86 I-TLB \u7684\u547d\u4e2d\u7387\uff0c\u56e0\u4e3a\u9891\u7e41\u4e92\u76f8\u8c03\u7528\u7684\u51fd\u6570\u4f1a\u88ab\u7d27\u5bc6\u5730\u653e\u7f6e\u5728\u4e00\u8d77\u3002</li> <li>\u7b2c\u56db\u62db\uff1a\u534f\u540c\u589e\u6548\u3002\u6d41\u6c34\u7ebf\u4e2d\u8fd8\u5305\u542b\u5176\u4ed6\u80fd\u653e\u5927\u5e03\u5c40\u4f18\u5316\u6548\u679c\u7684\u201c\u52a9\u653b\u201d\u64cd\u4f5c\uff1a<ul> <li>\u95f4\u63a5\u8c03\u7528\u63d0\u5347 (ICP) \u5c06\u8fd0\u884c\u65f6\u9ad8\u9891\u7684\u95f4\u63a5\u8c03\u7528\u8f6c\u6362\u4e3a\u76f4\u63a5\u8c03\u7528\uff0c\u4e0d\u4ec5\u52a0\u901f\u4e86\u8c03\u7528\u672c\u8eab\uff0c\u4e5f\u4e3a\u540e\u7eed\u7684\u5185\u8054\u548c\u5e03\u5c40\u4f18\u5316\u521b\u9020\u4e86\u6761\u4ef6\u3002</li> <li>PLT\u8c03\u7528\u4f18\u5316 \u51cf\u5c11\u4e86\u901a\u8fc7\u8fc7\u7a0b\u94fe\u63a5\u8868\uff08PLT\uff09\u8c03\u7528\u7684\u5f00\u9500\u3002</li> <li>Identical Code Folding (ICF) \u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u8fdb\u4e00\u6b65\u5408\u5e76\u5b8c\u5168\u76f8\u540c\u7684\u4ee3\u7801\u6bb5\uff0c\u8fd9\u662f\u5bf9\u94fe\u63a5\u5668ICF\u7684\u6709\u529b\u8865\u5145\u3002</li> </ul> </li> <li>\u7b2c\u4e94\u62db\uff1a\u65e0\u75d5\u66f4\u65b0\u3002\u6240\u6709\u8fd9\u4e9b\u6fc0\u8fdb\u7684\u4ee3\u7801\u79fb\u52a8\u548c\u4fee\u6539\uff0c\u90fd\u4f34\u968f\u7740\u5bf9 DWARF \u8c03\u8bd5\u4fe1\u606f\u548c C++\u5f02\u5e38\u5904\u7406\uff08landing pad\uff09\u5143\u6570\u636e\u7684\u540c\u6b65\u66f4\u65b0\uff0c\u786e\u4fdd\u7a0b\u5e8f\u5728\u4f18\u5316\u540e\u4f9d\u7136\u80fd\u6b63\u786e\u8c03\u8bd5\u548c\u5904\u7406\u5f02\u5e38\uff0c\u8fd9\u5bf9\u751f\u4ea7\u73af\u5883\u81f3\u5173\u91cd\u8981\u3002</li> </ul> <p></p> <p>TABLE I: Sequence of transformations applied by BOLT\u2019s optimization pipeline.</p> <p>\u8fd9\u5f20\u8868\u683c\u6e05\u6670\u5730\u5c55\u793a\u4e86BOLT\u4f18\u5316\u6d41\u6c34\u7ebf\u7684\u987a\u5e8f\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u4ece\u6700\u521d\u7684\u6307\u4ee4\u7cbe\u7b80\uff08\u5982\u53bb\u9664<code>rep ret</code>\uff09\uff0c\u5230\u6838\u5fc3\u7684\u5e03\u5c40\u4f18\u5316\uff08\u57fa\u672c\u5757\u91cd\u6392\u3001\u51fd\u6570\u91cd\u6392\uff09\uff0c\u518d\u5230\u6700\u540e\u7684\u5206\u652f\u4fee\u590d\uff08fixup\uff09\uff0c\u6574\u4e2a\u6d41\u7a0b\u73af\u73af\u76f8\u6263\uff0c\u5171\u540c\u670d\u52a1\u4e8e\u63d0\u5347\u4ee3\u7801\u5c40\u90e8\u6027\u8fd9\u4e00\u7ec8\u6781\u76ee\u6807\u3002\u6700\u7ec8\u6548\u679c\u662f\u60ca\u4eba\u7684\uff1a\u5373\u4f7f\u5728\u5df2\u7ecf\u7ecf\u8fc7 FDO+LTO \u4f18\u5316\u7684\u9876\u5c16\u7f16\u8bd1\u5668\uff08\u5982Clang\uff09\u4e0a\uff0cBOLT\u4f9d\u7136\u80fd\u69a8\u53d6\u51fa\u9ad8\u8fbe 15.0% \u7684\u989d\u5916\u6027\u80fd\u3002</p> <p></p> <p>Fig. 8: Breakdown of improvements on different metrics for HHVM (higher is better). ICF refers to identical code folding. Optimizations are always added on top of the previous bar, i.e., +BB reordering has function reordering, huge pages and basic block reordering all turned on.</p> <p></p> <p>Fig. 9: Breakdown of improvements on different metrics for Clang (higher is better). ICF refers to identical code folding. Optimizations are always added on top of the previous bar, i.e., +ICF includes BB reordering and ICF both turned on.</p> <p>\u8fd9\u4e24\u5f20\u56fe\u7684\u6027\u80fd\u5206\u89e3\u66f4\u662f\u76f4\u89c2\u5730\u8bc1\u660e\u4e86\uff0c\u57fa\u672c\u5757\u91cd\u6392\uff08BB reordering\uff09\u548c\u51fd\u6570\u91cd\u6392\uff08Function reordering\uff09\u662fBOLT\u6027\u80fd\u6536\u76ca\u7684\u7edd\u5bf9\u5927\u5934\uff0c\u5b8c\u7f8e\u5370\u8bc1\u4e86\u5176\u8bbe\u8ba1\u54f2\u5b66\uff1a\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u505a\u6700\u7cbe\u51c6\u7684\u4ee3\u7801\u5e03\u5c40\uff0c\u662f\u89e3\u51b3\u5927\u578b\u5e94\u7528\u524d\u7aef\u74f6\u9888\u7684\u7ec8\u6781\u5229\u5668\u3002</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/ELI5_notes/#5-eli5","title":"5. \u91cd\u5b9a\u4f4d\u6a21\u5f0f\u4e0b\u7684\u5168\u7a0b\u5e8f\u91cd\u6392 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 post-link optimizer\uff08\u5982\u65e9\u671f\u7684 BOLT \u521d\u59cb\u8bbe\u8ba1\uff09\u53ea\u80fd\u5728\u73b0\u6709\u51fd\u6570\u8fb9\u754c\u5185\u505a\u6587\u7ae0\uff0c\u6bd4\u5982\u8c03\u6574\u51fd\u6570\u5185\u90e8\u7684\u57fa\u672c\u5757\u987a\u5e8f\u3002\u8fd9\u5c31\u50cf\u4f60\u53ea\u80fd\u5728\u6bcf\u4e2a\u623f\u95f4\u91cc\u91cd\u65b0\u6446\u653e\u5bb6\u5177\uff0c\u4f46\u65e0\u6cd5\u6539\u53d8\u623f\u95f4\u5728\u6574\u4e2a\u5927\u697c\u91cc\u7684\u4f4d\u7f6e\u3002 - \u8fd9\u79cd\u9650\u5236\u5bfc\u81f4\u4e00\u4e2a\u6839\u672c\u6027\u95ee\u9898\uff1a\u5168\u5c40\u4ee3\u7801\u5c40\u90e8\u6027\uff08global code locality\uff09\u3002\u5373\u4f7f\u6bcf\u4e2a\u51fd\u6570\u5185\u90e8\u90fd\u5f88\u201c\u70ed\u201d\uff0c\u4f46\u5982\u679c\u9891\u7e41\u4e92\u76f8\u8c03\u7528\u7684\u51fd\u6570\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u91cc\u76f8\u9694\u5341\u4e07\u516b\u5343\u91cc\uff0cCPU \u7684 I-cache \u548c I-TLB \u4f9d\u7136\u4f1a\u9891\u7e41\u5931\u6548\uff0c\u6027\u80fd\u74f6\u9888\u65e0\u6cd5\u6839\u9664\u3002 - \u94fe\u63a5\u5668\uff08Linker\uff09\u867d\u7136\u77e5\u9053\u6240\u6709\u7b26\u53f7\u7684\u4f4d\u7f6e\uff0c\u4f46\u5b83\u901a\u5e38\u4e0d\u4f1a\u628a\u91cd\u5b9a\u4f4d\uff08relocation\uff09\u4fe1\u606f\u5199\u5165\u6700\u7ec8\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002\u6ca1\u6709\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4efb\u4f55 post-link \u5de5\u5177\u90fd\u50cf\u662f\u5728\u9ed1\u6697\u4e2d\u6478\u7d22\uff0c\u4e0d\u6562\u8f7b\u6613\u79fb\u52a8\u51fd\u6570\uff0c\u56e0\u4e3a\u4e00\u65e6\u79fb\u52a8\uff0c\u6240\u6709\u6307\u5411\u8be5\u51fd\u6570\u7684\u6307\u9488\u548c\u8df3\u8f6c\u6307\u4ee4\u90fd\u4f1a\u5931\u6548\uff0c\u7a0b\u5e8f\u76f4\u63a5\u5d29\u6e83\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u8981\u4f18\u5316\u4e00\u4e2a\u5de8\u5927\u7684\u7269\u6d41\u4ed3\u5e93\uff08\u4f60\u7684\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff09\u3002\u8d27\u7269\uff08\u51fd\u6570\uff09\u88ab\u5806\u653e\u5728\u4e0d\u540c\u7684\u8d27\u67b6\u4e0a\u3002\u521d\u59cb\u5e03\u5c40\u662f\u968f\u610f\u7684\u3002 - \u4f60\u62ff\u5230\u4e86\u4e00\u4efd\u8be6\u7ec6\u7684\u201c\u8d27\u7269\u5173\u8054\u56fe\u201d\uff08profile data\uff09\uff0c\u77e5\u9053\u54ea\u4e9b\u8d27\u7269\u603b\u662f\u88ab\u4e00\u8d77\u53d6\u7528\uff08hot call paths\uff09\u3002 - \u5728\u201c\u975e\u91cd\u5b9a\u4f4d\u6a21\u5f0f\u201d\u4e0b\uff0c\u4f60\u53ea\u80fd\u5728\u6bcf\u4e2a\u8d27\u67b6\u5185\u90e8\u6574\u7406\u8d27\u7269\uff0c\u8ba9\u5e38\u7528\u7684\u653e\u524d\u9762\u3002\u4f46\u5728\u201c\u91cd\u5b9a\u4f4d\u6a21\u5f0f\u201d\u4e0b\uff0c\u4f60\u62ff\u5230\u4e86\u4ed3\u5e93\u7684\u201c\u5b8c\u6574\u5efa\u7b51\u84dd\u56fe\u548c\u6240\u6709\u8d27\u67b6\u7684\u627f\u91cd/\u8fde\u63a5\u56fe\u7eb8\u201d\uff08\u5373 <code>--emit-relocs</code> \u751f\u6210\u7684\u91cd\u5b9a\u4f4d\u8868\uff09\u3002 - \u73b0\u5728\uff0c\u4f60\u4e0d\u4ec5\u53ef\u4ee5\u5728\u8d27\u67b6\u5185\u90e8\u6574\u7406\uff0c\u8fd8\u53ef\u4ee5\u5b89\u5168\u5730\u62c6\u6389\u9694\u5899\u3001\u79fb\u52a8\u6574\u4e2a\u8d27\u67b6\uff0c\u751a\u81f3\u628a\u4e00\u4e2a\u5927\u8d27\u67b6\u62c6\u6210\u4e24\u534a\uff0c\u628a\u5e38\u7528\u7684\u90e8\u5206\u79fb\u5230\u9ec4\u91d1\u533a\u57df\uff0c\u4e0d\u5e38\u7528\u7684\u6254\u5230\u4ed3\u5e93\u89d2\u843d\u3002\u8fd9\u624d\u662f\u771f\u6b63\u7684\u5168\u5c40\u4f18\u5316\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u81ea\u5df1\u53bb\u89e3\u6790\u548c\u91cd\u5efa\u6574\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u9519\u7efc\u590d\u6742\u7684\u5730\u5740\u5f15\u7528\u5173\u7cfb\u2014\u2014\u90a3\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u5b8c\u6210\u7684\u4efb\u52a1\uff0c\u4e14\u6781\u6613\u51fa\u9519\u3002 - \u800c\u662f\u5de7\u5999\u5730\u5229\u7528\u4e86\u94fe\u63a5\u5668\u672c\u8eab\u7684\u80fd\u529b\u3002\u901a\u8fc7\u8981\u6c42\u94fe\u63a5\u5668\u5728\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\u65f6\u5e26\u4e0a <code>--emit-relocs</code> \u9009\u9879\uff0c\u94fe\u63a5\u5668\u4f1a\u5c06\u5b83\u5728\u94fe\u63a5\u8fc7\u7a0b\u4e2d\u89e3\u51b3\u7684\u6240\u6709\u5730\u5740\u4fee\u6b63\u4fe1\u606f\uff08\u5373\u91cd\u5b9a\u4f4d\u8868\uff09\u4e00\u5e76\u4fdd\u5b58\u4e0b\u6765\u3002 - BOLT \u5728 Relocations Mode \u4e0b\uff0c\u9996\u5148\u8bfb\u53d6\u8fd9\u4efd\u73b0\u6210\u7684\u3001\u6743\u5a01\u7684\u91cd\u5b9a\u4f4d\u8868\u3002\u8fd9\u4efd\u8868\u660e\u786e\u544a\u8bc9 BOLT\uff1a\u201c\u5728\u5730\u5740 X \u5904\uff0c\u6709\u4e00\u4e2a\u5bf9\u7b26\u53f7 Y \u7684\u5f15\u7528\uff0c\u7c7b\u578b\u662f Z\u201d\u3002 - \u6709\u4e86\u8fd9\u5f20\u201c\u5730\u56fe\u201d\uff0cBOLT \u5c31\u80fd\u83b7\u5f97\u5bf9\u4e8c\u8fdb\u5236\u5185\u5bb9\u7684\u5b8c\u5168\u63a7\u5236\u6743\uff1a     - \u5b83\u53ef\u4ee5\u4efb\u610f\u91cd\u65b0\u6392\u5217\u6240\u6709\u51fd\u6570\u5728 <code>.text</code> \u6bb5\u4e2d\u7684\u7269\u7406\u4f4d\u7f6e\u3002     - \u5b83\u53ef\u4ee5\u5b89\u5168\u5730\u8fdb\u884c\u51fd\u6570\u4f53\u62c6\u5206\uff08function splitting\uff09\uff0c\u5c06\u51b7\u4ee3\u7801\u5757\u632a\u8d70\uff0c\u53ea\u7559\u4e0b\u7d27\u51d1\u7684\u70ed\u4ee3\u7801\u8def\u5f84\u3002     - \u5728\u5b8c\u6210\u6240\u6709\u91cd\u6392\u548c\u4fee\u6539\u540e\uff0cBOLT \u53ea\u9700\u6839\u636e\u65b0\u7684\u51fd\u6570\u5730\u5740\uff0c\u904d\u5386\u91cd\u5b9a\u4f4d\u8868\uff0c\u4e00\u6b21\u6027\u4fee\u6b63\u6240\u6709\u76f8\u5173\u7684\u5f15\u7528\u5373\u53ef\u3002\u8fd9\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86 post-link \u4ee3\u7801\u91cd\u6392\u7684\u5b89\u5168\u6027\u548c\u53ef\u884c\u6027\u95ee\u9898\u3002</p> <p></p> <p>Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/","title":"BOLT: A Practical Binary Optimizer for Data Centers and Beyond \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-1-example-of-a-compilation-pipeline-and-the-various-alternatives-to-retrofit-sample-based-profile-data","title":"Fig. 1: Example of a compilation pipeline and the various alternatives to retrofit sample-based profile data.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u6807\u51c6\u7f16\u8bd1\u6d41\u7a0b\uff0c\u4ece Source Code \u5f00\u59cb\uff0c\u7ecf\u7531 Parser \u751f\u6210 Compiler IR\uff0c\u518d\u901a\u8fc7 Code Gen. \u751f\u6210 Object Files\uff0c\u63a5\u7740\u7531 Linker \u5408\u5e76\u4e3a Executable Binary\uff0c\u6700\u540e\u53ef\u9009\u5730\u7ecf\u8fc7 Binary Opt. \u4f18\u5316\u5f97\u5230 Optimized Executable Binary\u3002</li> <li>Profile Data \u53ef\u5728\u591a\u4e2a\u9636\u6bb5\u6ce8\u5165\uff0c\u56fe\u4e2d\u7528\u7bad\u5934\u6807\u793a\u4e86\u5176\u53ef\u4f5c\u7528\u70b9\uff1a\u53ef\u56de\u6eaf\u81f3 Source Code\u3001Compiler IR\u3001Object Files \u6216\u76f4\u63a5\u4f5c\u7528\u4e8e Executable Binary\u3002</li> <li>\u6b64\u56fe\u6838\u5fc3\u5728\u4e8e\u8bf4\u660e sample-based profile data \u7684\u201c retrofitting\u201d\uff08\u56de\u6eaf\u6ce8\u5165\uff09\u4f4d\u7f6e\u9009\u62e9\u3002\u8d8a\u65e9\u6ce8\u5165\uff08\u5982 Source Code \u6216 Compiler IR\uff09\uff0c\u7406\u8bba\u4e0a\u80fd\u5f71\u54cd\u66f4\u591a\u4f18\u5316\u9636\u6bb5\uff1b\u4f46\u8d8a\u665a\u6ce8\u5165\uff08\u5982 Executable Binary\uff09\uff0c\u6570\u636e\u6620\u5c04\u66f4\u7cbe\u786e\uff0c\u5c24\u5176\u5bf9\u5e95\u5c42\u4f18\u5316\u5982\u4ee3\u7801\u5e03\u5c40\u81f3\u5173\u91cd\u8981\u3002</li> <li>BOLT \u7684\u8bbe\u8ba1\u54f2\u5b66\u6b63\u662f\u57fa\u4e8e\u6b64\u6743\u8861\uff1a\u5b83\u4f5c\u4e3a post-link optimizer\uff0c\u5728 Executable Binary \u9636\u6bb5\u6ce8\u5165 Profile Data\uff0c\u727a\u7272\u4e86\u65e9\u671f\u4f18\u5316\u673a\u4f1a\uff0c\u6362\u53d6\u4e86\u66f4\u9ad8\u7684\u6570\u636e\u51c6\u786e\u6027\u548c\u5bf9\u4ee3\u7801\u5e03\u5c40\u7684\u7cbe\u51c6\u63a7\u5236\u3002</li> <li>\u56fe\u4e2d\u672a\u660e\u786e\u6807\u6ce8\u5177\u4f53\u5de5\u5177\uff0c\u4f46\u7ed3\u5408\u6b63\u6587\u53ef\u77e5\uff0cAutoFDO \u5c5e\u4e8e\u5728 Compiler IR \u9636\u6bb5\u6ce8\u5165\uff0c\u800c BOLT \u548c Ispike \u5219\u5c5e\u4e8e\u5728 Executable Binary \u9636\u6bb5\u6ce8\u5165\u3002LIPO \u548c HFSort \u5219\u53ef\u80fd\u5728 Linker \u9636\u6bb5\u6ce8\u5165\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u5448\u73b0\u4e86\u8bba\u6587\u7684\u6838\u5fc3\u8bba\u70b9\u4e4b\u4e00\uff1a\u4e0d\u540c\u9636\u6bb5\u7684 FDO \u5e76\u975e\u76f8\u4e92\u53d6\u4ee3\uff0c\u800c\u662f\u4e92\u8865\u5173\u7cfb\u3002BOLT \u7684\u4ef7\u503c\u5728\u4e8e\u586b\u8865\u4e86 post-link \u4f18\u5316\u8fd9\u4e00\u88ab\u5ffd\u89c6\u7684\u73af\u8282\uff0c\u5e76\u8bc1\u660e\u5176\u6709\u6548\u6027\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-2-example-showing-a-challenge-in-mapping-binary-level-events-back-to-higher-level-code-representations","title":"Fig. 2: Example showing a challenge in mapping binary-level events back to higher-level code representations.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u5c06\u4e8c\u8fdb\u5236\u5c42\u9762\u7684\u6027\u80fd\u4e8b\u4ef6\u6620\u5c04\u56de\u9ad8\u7ea7\u4ee3\u7801\u8868\u793a\u65f6\u6240\u9762\u4e34\u7684\u4e00\u4e2a\u5178\u578b\u6311\u6218\uff0c\u6838\u5fc3\u95ee\u9898\u5728\u4e8e\u51fd\u6570\u5185\u8054\u4e0e\u5206\u652f\u9891\u7387\u51c6\u786e\u6027\u4e4b\u95f4\u7684\u51b2\u7a81\u3002</li> <li>\u4ee3\u7801\u793a\u4f8b\u5305\u542b\u4e09\u4e2a\u51fd\u6570\uff1a<code>foo</code>\u3001<code>bar</code> \u548c <code>baz</code>\u3002\u5176\u4e2d\uff0c<code>foo</code> \u51fd\u6570\u5305\u542b\u4e00\u4e2a\u6761\u4ef6\u5206\u652f\uff08\u7b2c02\u884c\uff09\uff0c\u800c <code>bar</code> \u548c <code>baz</code> \u5206\u522b\u8c03\u7528 <code>foo</code>\uff0c\u4e14 <code>foo</code> \u5728\u8fd9\u4e24\u4e2a\u8c03\u7528\u70b9\u88ab\u5185\u8054\u3002</li> <li>\u5173\u952e\u89c2\u5bdf\u70b9\u662f\uff1a<code>foo</code> \u4e2d\u7684 <code>if (x &gt; 0)</code> \u5206\u652f\uff0c\u5728 <code>bar</code> \u7684\u4e0a\u4e0b\u6587\u4e2d\u603b\u662f\u6267\u884c <code>B1</code> \u8def\u5f84\uff08\u56e0\u4e3a\u4f20\u5165\u53c2\u6570\u6ee1\u8db3 <code>x &gt; 0</code>\uff09\uff0c\u800c\u5728 <code>baz</code> \u7684\u4e0a\u4e0b\u6587\u4e2d\u603b\u662f\u6267\u884c <code>B2</code> \u8def\u5f84\uff08\u56e0\u4e3a\u4f20\u5165\u53c2\u6570\u6ee1\u8db3 <code>x &lt; 0</code>\uff09\u3002</li> <li>\u5f53\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u8fdb\u884c\u91c7\u6837\u5206\u6790\u65f6\uff0c\u4f1a\u8bb0\u5f55\u5230\u4e24\u4e2a\u72ec\u7acb\u7684\u5206\u652f\u4e8b\u4ef6\uff1a\u4e00\u4e2a\u4f4d\u4e8e <code>bar</code> \u5185\u8054\u540e\u7684\u4ee3\u7801\u4e2d\uff0c\u53e6\u4e00\u4e2a\u4f4d\u4e8e <code>baz</code> \u5185\u8054\u540e\u7684\u4ee3\u7801\u4e2d\u3002\u8fd9\u4e24\u4e2a\u4e8b\u4ef6\u5206\u522b\u5bf9\u5e94 <code>foo</code> \u4e2d\u7684\u540c\u4e00\u4e2a <code>if</code> \u8bed\u53e5\u3002</li> <li>\u5982\u679c\u4ec5\u4ece\u6e90\u7801\u5c42\u9762\u5206\u6790\uff0c\u7531\u4e8e <code>bar</code> \u548c <code>baz</code> \u6267\u884c\u6b21\u6570\u76f8\u540c\uff0c\u7cfb\u7edf\u4f1a\u9519\u8bef\u5730\u63a8\u65ad\u51fa <code>foo</code> \u4e2d\u7684\u5206\u652f\u670950%\u7684\u6982\u7387\u8d70\u5411 <code>B1</code>\uff0c50%\u7684\u6982\u7387\u8d70\u5411 <code>B2</code>\u3002</li> <li>\u8fd9\u79cd\u4e0d\u51c6\u786e\u7684\u6620\u5c04\u4f1a\u5bfc\u81f4\u7f16\u8bd1\u5668\u65e0\u6cd5\u4e3a <code>bar</code> \u548c <code>baz</code> \u4e2d\u5185\u8054\u7684 <code>foo</code> \u751f\u6210\u6700\u4f18\u7684\u4ee3\u7801\u5e03\u5c40\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e <code>bar</code>\uff0c\u7406\u60f3\u5e03\u5c40\u5e94\u662f <code>B1</code> \u7d27\u8ddf\u5728 <code>if</code> \u4e4b\u540e\u4f5c\u4e3afall-through\u8def\u5f84\uff1b\u800c\u5bf9\u4e8e <code>baz</code>\uff0c\u5219\u5e94\u662f <code>B2</code> \u4f5c\u4e3a fall-through\u3002</li> <li>\u6b64\u95ee\u9898\u5728\u8de8\u6a21\u5757\u5185\u8054\u65f6\u5c24\u4e3a\u7a81\u51fa\uff0c\u56e0\u4e3a\u5982\u679c <code>foo</code> \u5b9a\u4e49\u5728\u53e6\u4e00\u4e2a\u6a21\u5757\u4e2d\uff0c\u5185\u8054\u53ea\u80fd\u5728\u94fe\u63a5\u65f6\u53d1\u751f\uff0c\u6b64\u65f6\u7f16\u8bd1\u5668\u5df2\u65e0\u6cd5\u83b7\u53d6\u7cbe\u786e\u7684\u3001\u6309\u8c03\u7528\u70b9\u533a\u5206\u7684\u5206\u652f\u9891\u7387\u4fe1\u606f\u3002</li> <li>\u8be5\u56fe\u65e8\u5728\u8bf4\u660e\uff0c\u540e\u94fe\u63a5\u4f18\u5316\u5668\uff08\u5982 BOLT\uff09 \u76f8\u8f83\u4e8e\u7f16\u8bd1\u5668\uff0c\u5728\u5904\u7406\u6b64\u7c7b\u95ee\u9898\u65f6\u5177\u6709\u5929\u7136\u4f18\u52bf\uff0c\u56e0\u4e3a\u5b83\u76f4\u63a5\u64cd\u4f5c\u6700\u7ec8\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\uff0c\u80fd\u591f\u7cbe\u786e\u8bc6\u522b\u6bcf\u4e2a\u5185\u8054\u5b9e\u4f8b\u7684\u5b9e\u9645\u6267\u884c\u8def\u5f84\uff0c\u4ece\u800c\u5b9e\u73b0\u66f4\u4f18\u7684\u4ee3\u7801\u5e03\u5c40\u3002</li> </ul> \u4f4d\u7f6e \u5206\u652f\u884c\u4e3a \u7406\u60f3\u5e03\u5c40 <code>bar</code> \u4e2d\u5185\u8054\u7684 <code>foo</code> \u603b\u662f\u8d70 <code>B1</code> <code>B1</code> \u4f5c\u4e3a fall-through <code>baz</code> \u4e2d\u5185\u8054\u7684 <code>foo</code> \u603b\u662f\u8d70 <code>B2</code> <code>B2</code> \u4f5c\u4e3a fall-through \u6e90\u7801\u7ea7\u5206\u6790 \u63a8\u65ad\u4e3a 50% \u8d70 <code>B1</code>\uff0c50% \u8d70 <code>B2</code> \u65e0\u6cd5\u786e\u5b9a\u6700\u4f73\u5e03\u5c40 <ul> <li>\u7ed3\u8bba\uff1a\u6b64\u4f8b\u6e05\u6670\u5730\u8bba\u8bc1\u4e86\u8bba\u6587\u7684\u6838\u5fc3\u89c2\u70b9\u2014\u2014\u540e\u94fe\u63a5\u4f18\u5316\u5668\u80fd\u66f4\u51c6\u786e\u5730\u5229\u7528\u91c7\u6837\u6570\u636e\uff0c\u56e0\u4e3a\u5b83\u907f\u514d\u4e86\u5c06\u4e8c\u8fdb\u5236\u5c42\u9762\u7684\u7cbe\u786e\u4e8b\u4ef6\u6620\u5c04\u56de\u62bd\u8c61\u4e2d\u95f4\u8868\u793a\u6240\u5e26\u6765\u7684\u4fe1\u606f\u635f\u5931\u548c\u6b67\u4e49\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-3-diagram-showing-bolts-binary-rewriting-pipeline","title":"Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.","text":"<ul> <li>\u56fe3 \u5c55\u793a\u4e86 BOLT \u7684\u4e8c\u8fdb\u5236\u91cd\u5199\u6d41\u6c34\u7ebf\uff0c\u8be5\u6d41\u7a0b\u4ece\u5de6\u81f3\u53f3\u4f9d\u6b21\u6267\u884c\uff0c\u5171\u5305\u542b\u516b\u4e2a\u4e3b\u8981\u9636\u6bb5\u3002</li> <li>\u6d41\u6c34\u7ebf\u8d77\u59cb\u4e8e Function discovery\uff0c\u6b64\u9636\u6bb5\u8d1f\u8d23\u8bc6\u522b\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u51fd\u6570\u8fb9\u754c\u4e0e\u5165\u53e3\u70b9\uff0c\u4f9d\u8d56 ELF \u7b26\u53f7\u8868\u548c DWARF \u8c03\u8bd5\u4fe1\u606f\u8fdb\u884c\u5b9a\u4f4d\u3002</li> <li>\u63a5\u7740\u662f Read debug info\uff0c\u8bfb\u53d6\u8c03\u8bd5\u7b26\u53f7\uff08\u5982\u6e90\u7801\u884c\u53f7\u3001\u53d8\u91cf\u540d\u7b49\uff09\uff0c\u7528\u4e8e\u540e\u7eed\u4f18\u5316\u65f6\u5173\u8054\u673a\u5668\u6307\u4ee4\u4e0e\u6e90\u4ee3\u7801\u4e0a\u4e0b\u6587\u3002</li> <li>\u7136\u540e\u8fdb\u5165 Read profile data\uff0c\u52a0\u8f7d\u7531 perf2bolt \u5de5\u5177\u8f6c\u6362\u7684 YAML \u683c\u5f0f\u91c7\u6837\u6027\u80fd\u6570\u636e\uff0c\u4e3a\u4f18\u5316\u63d0\u4f9b\u70ed\u70b9\u8def\u5f84\u4e0e\u5206\u652f\u9891\u7387\u4f9d\u636e\u3002</li> <li>Disassembly \u9636\u6bb5\u4f7f\u7528 LLVM \u7684 MCInst \u89e3\u7801\u5668\u5c06\u673a\u5668\u7801\u53cd\u6c47\u7f16\u4e3a\u53ef\u64cd\u4f5c\u7684\u6307\u4ee4\u5bf9\u8c61\uff0c\u4e3a\u6784\u5efa\u63a7\u5236\u6d41\u56fe\u505a\u51c6\u5907\u3002</li> <li>CFG construction \u6784\u5efa\u6bcf\u4e2a\u51fd\u6570\u7684\u63a7\u5236\u6d41\u56fe\uff08Control Flow Graph\uff09\uff0c\u901a\u8fc7\u5206\u6790\u8df3\u8f6c\u6307\u4ee4\u8fde\u63a5\u57fa\u672c\u5757\uff0c\u5f62\u6210\u7a0b\u5e8f\u6267\u884c\u8def\u5f84\u7684\u7ed3\u6784\u5316\u8868\u793a\u3002</li> <li>Optimization pipeline \u662f\u6838\u5fc3\u4f18\u5316\u9636\u6bb5\uff0c\u5e94\u7528\u5305\u62ec\u57fa\u672c\u5757\u91cd\u6392\u3001\u51fd\u6570\u91cd\u6392\u3001ICF\u3001\u95f4\u63a5\u8c03\u7528\u63d0\u5347\u7b49\u5341\u4f59\u79cd\u4f18\u5316\u7b56\u7565\uff0c\u5177\u4f53\u987a\u5e8f\u89c1 Table I\u3002</li> <li>Emit and link functions \u5c06\u4f18\u5316\u540e\u7684\u51fd\u6570\u91cd\u65b0\u7f16\u7801\u4e3a\u673a\u5668\u7801\uff0c\u5e76\u5229\u7528 LLVM \u7684\u8fd0\u884c\u65f6\u94fe\u63a5\u5668\u89e3\u6790\u8de8\u51fd\u6570\u5f15\u7528\uff0c\u786e\u4fdd\u5730\u5740\u6b63\u786e\u6027\u3002</li> <li>\u6700\u7ec8\u9636\u6bb5 Rewrite binary file \u5c06\u6240\u6709\u4fee\u6539\u5199\u56de\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u540c\u65f6\u66f4\u65b0 ELF \u5934\u90e8\u7ed3\u6784\uff08\u5982\u8282\u5927\u5c0f\u3001\u91cd\u5b9a\u4f4d\u8868\u7b49\uff09\u4ee5\u4fdd\u6301\u6587\u4ef6\u5b8c\u6574\u6027\u3002</li> </ul> \u9636\u6bb5 \u529f\u80fd\u63cf\u8ff0 \u4f9d\u8d56\u7ec4\u4ef6 Function discovery \u5b9a\u4f4d\u51fd\u6570\u5165\u53e3\u4e0e\u8fb9\u754c ELF symbol table, DWARF frame info Read debug info \u52a0\u8f7d\u8c03\u8bd5\u5143\u6570\u636e DWARF debug sections Read profile data \u5bfc\u5165\u91c7\u6837\u6027\u80fd\u6570\u636e perf2bolt-generated YAML Disassembly \u53cd\u6c47\u7f16\u4e3a MCInst \u5bf9\u8c61 LLVM MC disassembler CFG construction \u6784\u5efa\u63a7\u5236\u6d41\u56fe Branch instruction analysis Optimization pipeline \u5e94\u7528\u4ee3\u7801\u5e03\u5c40\u4e0e\u6307\u4ee4\u7ea7\u4f18\u5316 BOLT passes (Table I) Emit and link functions \u91cd\u7f16\u7801\u5e76\u89e3\u6790\u7b26\u53f7\u5f15\u7528 LLVM JIT linker Rewrite binary file \u8f93\u51fa\u6700\u7ec8\u4f18\u5316\u4e8c\u8fdb\u5236 ELF structure updater <ul> <li>\u6574\u4e2a\u6d41\u6c34\u7ebf\u8bbe\u8ba1\u5f3a\u8c03\u6a21\u5757\u5316\u4e0e\u53ef\u6269\u5c55\u6027\uff0c\u4f9d\u6258 LLVM \u57fa\u7840\u8bbe\u65bd\u5b9e\u73b0\u8de8\u67b6\u6784\u652f\u6301\u3002</li> <li>\u5173\u952e\u4f18\u5316\u5982 basic block reordering \u548c function reordering \u76f4\u63a5\u4f5c\u7528\u4e8e CFG\uff0c\u663e\u8457\u6539\u5584 I-cache \u4e0e I-TLB \u5c40\u90e8\u6027\u3002</li> <li>\u8be5\u6d41\u6c34\u7ebf\u5141\u8bb8\u90e8\u5206\u51fd\u6570\u88ab\u8df3\u8fc7\uff08\u4fdd\u5b88\u5904\u7406\uff09\uff0c\u786e\u4fdd\u5bf9\u590d\u6742\u6216\u4e0d\u652f\u6301\u4ee3\u7801\u7684\u517c\u5bb9\u6027\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-4-partial-cfg-dump-for-a-function-with-c-exceptions","title":"Fig. 4: Partial CFG dump for a function with C++ exceptions.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 BOLT \u5de5\u5177\u5bf9\u4e00\u4e2a\u5305\u542b C++ \u5f02\u5e38\u5904\u7406\u7684\u51fd\u6570 <code>_Z11filter_onlyi</code> \u8fdb\u884c\u63a7\u5236\u6d41\u56fe\uff08CFG\uff09\u5206\u6790\u540e\u7684\u90e8\u5206\u8f93\u51fa\uff0c\u7528\u4e8e\u8bf4\u660e\u5176\u5185\u90e8\u5982\u4f55\u8868\u793a\u548c\u5904\u7406\u4e8c\u8fdb\u5236\u4ee3\u7801\u3002</li> <li>\u8f93\u51fa\u5185\u5bb9\u4ee5\u7ed3\u6784\u5316\u6587\u672c\u5f62\u5f0f\u5448\u73b0\uff0c\u5305\u542b\u51fd\u6570\u5143\u4fe1\u606f\u3001\u57fa\u672c\u5757\uff08Basic Block, BB\uff09\u5b9a\u4e49\u53ca\u5176\u6307\u4ee4\u5e8f\u5217\uff0c\u5e76\u6807\u6ce8\u4e86\u5f02\u5e38\u5904\u7406\u76f8\u5173\u7684\u5143\u6570\u636e\u3002</li> <li>\u51fd\u6570\u5143\u4fe1\u606f\uff1a</li> <li>\u51fd\u6570\u540d\uff1a<code>_Z11filter_onlyi</code></li> <li>\u72b6\u6001\uff1aCFG \u5df2\u6784\u5efa</li> <li>\u5730\u5740\uff1a<code>0x400ab1</code></li> <li>\u5927\u5c0f\uff1a<code>0x2f</code> \u5b57\u8282</li> <li>\u6240\u5c5e\u6bb5\uff1a<code>.text</code></li> <li>LSDA\uff08Language-Specific Data Area\uff09\u5730\u5740\uff1a<code>0x401054</code></li> <li>\u57fa\u672c\u5757\u6570\u91cf\uff1a5</li> <li>CFI \u6307\u4ee4\u6570\uff1a4</li> <li>\u6267\u884c\u8ba1\u6570\uff1a104</li> <li> <p>\u914d\u7f6e\u6587\u4ef6\u51c6\u786e\u7387\uff1a100.0%</p> </li> <li> <p>\u57fa\u672c\u5757 <code>.LBB07</code>\uff1a</p> </li> <li>\u5305\u542b 11 \u6761\u6307\u4ee4\uff0c\u5bf9\u9f50\u65b9\u5f0f\u4e3a 1\u3002</li> <li>\u5165\u53e3\u70b9\uff0c\u6267\u884c\u8ba1\u6570\u4e3a 104\u3002</li> <li>\u5305\u542b CFI \u6307\u4ee4\u7528\u4e8e\u8bb0\u5f55\u6808\u5e27\u72b6\u6001\u53d8\u5316\u3002</li> <li>\u6700\u540e\u4e00\u6761\u6307\u4ee4 <code>callq _Z3fooi</code> \u88ab\u6807\u8bb0\u4e3a\u53ef\u80fd\u629b\u51fa\u5f02\u5e38\uff0c\u5176\u5904\u7406\u7a0b\u5e8f\u4e3a <code>.LLP0</code>\uff0c\u52a8\u4f5c\u7f16\u53f7\u4e3a 1\u3002</li> <li> <p>\u540e\u7ee7\u5757\u4e3a <code>.Ltmp9</code>\uff08\u8bef\u9884\u6d4b\u6570 0\uff0c\u8ba1\u6570 100\uff09\uff0c\u7740\u9646\u57ab\u4e3a <code>.LLP0</code>\uff08\u8ba1\u6570 4\uff09\u3002</p> </li> <li> <p>\u57fa\u672c\u5757 <code>.LLP0</code>\uff1a</p> </li> <li>\u5305\u542b 2 \u6761\u6307\u4ee4\uff0c\u5bf9\u9f50\u65b9\u5f0f\u4e3a 1\u3002</li> <li>\u6807\u8bb0\u4e3a\u201c\u7740\u9646\u57ab\u201d\uff08Landing Pad\uff09\uff0c\u6267\u884c\u8ba1\u6570\u4e3a 4\u3002</li> <li>CFI \u72b6\u6001\u4e3a 3\u3002</li> <li>\u629b\u51fa\u8005\uff08Throwers\uff09\u4e3a <code>.LBB07</code>\u3002</li> <li>\u6307\u4ee4\u5305\u62ec\u6bd4\u8f83\u548c\u8df3\u8f6c\uff0c\u7528\u4e8e\u5f02\u5e38\u5206\u53d1\u903b\u8f91\u3002</li> <li> <p>\u540e\u7ee7\u5757\u4e3a <code>.Ltmp10</code>\uff08\u8bef\u9884\u6d4b\u6570 0\uff0c\u8ba1\u6570 4\uff09\u548c <code>.LFT8</code>\uff08\u63a8\u65ad\u8ba1\u6570 0\uff09\u3002</p> </li> <li> <p>\u5173\u952e\u672f\u8bed\u4e0e\u6ce8\u91ca\uff1a</p> </li> <li>CFI\uff08Call Frame Information\uff09\uff1a\u7528\u4e8e\u652f\u6301\u6808\u5c55\u5f00\u548c\u5f02\u5e38\u5904\u7406\u7684\u8c03\u8bd5\u4fe1\u606f\u3002</li> <li>Landing Pad\uff1a\u5f02\u5e38\u5904\u7406\u7684\u5165\u53e3\u70b9\uff0c\u5f53\u5f02\u5e38\u88ab\u629b\u51fa\u65f6\uff0c\u63a7\u5236\u6d41\u4f1a\u8df3\u8f6c\u81f3\u6b64\u5904\u3002</li> <li>Exec Count\uff1a\u8be5\u57fa\u672c\u5757\u5728\u91c7\u6837\u671f\u95f4\u88ab\u6267\u884c\u7684\u6b21\u6570\uff0c\u7528\u4e8e\u6307\u5bfc\u4f18\u5316\u51b3\u7b56\u3002</li> <li> <p>Profile Acc\uff1a\u914d\u7f6e\u6587\u4ef6\u6570\u636e\u7684\u51c6\u786e\u6027\u8bc4\u4f30\uff0c\u6b64\u5904\u4e3a 100%\uff0c\u8868\u660e\u6570\u636e\u5b8c\u6574\u53ef\u9760\u3002</p> </li> <li> <p>BOLT \u7684\u5904\u7406\u80fd\u529b\u4f53\u73b0\uff1a</p> </li> <li>\u80fd\u591f\u8bc6\u522b\u5e76\u4fdd\u7559 DWARF \u8c03\u8bd5\u4fe1\u606f\u4e2d\u7684 CFI \u6307\u4ee4\u3002</li> <li>\u5728\u91cd\u5199\u4e8c\u8fdb\u5236\u65f6\uff0c\u80fd\u91cd\u5efa\u6240\u6709 CFI \u4fe1\u606f\uff0c\u786e\u4fdd\u5f02\u5e38\u5904\u7406\u673a\u5236\u6b63\u5e38\u5de5\u4f5c\u3002</li> <li> <p>\u652f\u6301\u5bf9\u5305\u542b\u590d\u6742\u63a7\u5236\u6d41\uff08\u5982\u5f02\u5e38\u5904\u7406\uff09\u7684\u51fd\u6570\u8fdb\u884c\u7cbe\u786e\u7684 CFG \u6784\u5efa\u548c\u4f18\u5316\u3002</p> </li> <li> <p>\u8f93\u51fa\u683c\u5f0f\u7279\u70b9\uff1a</p> </li> <li>\u4f7f\u7528\u7f29\u8fdb\u548c\u6807\u7b7e\u6e05\u6670\u5212\u5206\u4e0d\u540c\u90e8\u5206\u3002</li> <li>\u6307\u4ee4\u65c1\u9644\u6709\u6e90\u7801\u4f4d\u7f6e\uff08\u5982 <code>exception4.cpp:22</code>\uff09\uff0c\u4fbf\u4e8e\u8c03\u8bd5\u548c\u9a8c\u8bc1\u3002</li> <li> <p>\u6ce8\u91ca\u4e2d\u5305\u542b\u64cd\u4f5c\u8bed\u4e49\uff08\u5982 <code>OpDefCfaOffset</code>\u3001<code>OpOffset Reg6</code>\uff09\uff0c\u53cd\u6620\u5e95\u5c42\u673a\u5668\u6307\u4ee4\u884c\u4e3a\u3002</p> </li> <li> <p>\u8868\u683c\u5316\u6458\u8981\uff1a</p> </li> </ul> \u9879\u76ee \u5185\u5bb9 \u51fd\u6570\u540d <code>_Z11filter_onlyi</code> \u603b\u6267\u884c\u6b21\u6570 104 \u57fa\u672c\u5757\u6570 5 CFI \u6307\u4ee4\u6570 4 \u4e3b\u8981\u5f02\u5e38\u5904\u7406\u5757 <code>.LLP0</code> \u5173\u952e\u6307\u4ee4\u7c7b\u578b <code>callq</code>, <code>jmp</code>, <code>cmpq</code>, <code>je</code> \u5f02\u5e38\u5904\u7406\u673a\u5236 \u652f\u6301 Landing Pad \u548c Thrower \u6620\u5c04 <ul> <li>\u6b64\u8f93\u51fa\u8bc1\u660e BOLT \u4e0d\u4ec5\u80fd\u5904\u7406\u666e\u901a\u63a7\u5236\u6d41\uff0c\u8fd8\u80fd\u5b89\u5168\u5730\u5904\u7406\u5305\u542b C++ \u5f02\u5e38\u7684\u590d\u6742\u51fd\u6570\uff0c\u662f\u5176\u4f5c\u4e3a\u751f\u4ea7\u7ea7\u4e8c\u8fdb\u5236\u4f18\u5316\u5668\u7684\u91cd\u8981\u80fd\u529b\u652f\u6491\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#table-i-sequence-of-transformations-applied-by-bolts-optimization-pipeline","title":"TABLE I: Sequence of transformations applied by BOLT\u2019s optimization pipeline.","text":"<ul> <li>BOLT\u4f18\u5316\u6d41\u6c34\u7ebf\u5305\u542b15\u4e2a\u72ec\u7acb\u7684\u4f18\u5316\u9636\u6bb5\uff0c\u6309\u5e8f\u6267\u884c\u4ee5\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\u3002</li> <li>\u4f18\u5316\u8fc7\u7a0b\u59cb\u4e8estrip-rep-ret\uff0c\u79fb\u9664\u4e3a\u517c\u5bb9\u65e7\u7248AMD\u5904\u7406\u5668\u800c\u4fdd\u7559\u7684<code>repz retq</code>\u6307\u4ee4\u4e2d\u7684\u5197\u4f59<code>repz</code>\u524d\u7f00\u3002</li> <li>icf\uff08Identical Code Folding\uff09\u9996\u6b21\u51fa\u73b0\u4e8e\u7b2c2\u6b65\uff0c\u7528\u4e8e\u5408\u5e76\u5185\u5bb9\u5b8c\u5168\u76f8\u540c\u7684\u51fd\u6570\u6216\u4ee3\u7801\u6bb5\uff0c\u51cf\u5c11\u4ee3\u7801\u4f53\u79ef\u3002</li> <li>\u7b2c3\u6b65icp\uff08Indirect Call Promotion\uff09\u5229\u7528\u8c03\u7528\u9891\u7387\u4fe1\u606f\uff0c\u5c06\u9ad8\u9891\u95f4\u63a5\u8c03\u7528\u8f6c\u6362\u4e3a\u76f4\u63a5\u8c03\u7528\uff0c\u63d0\u5347\u6267\u884c\u6548\u7387\u3002</li> <li>\u7b2c4\u6b65\u548c\u7b2c9\u6b65\u5747\u4e3apeepholes\uff0c\u5206\u522b\u5728\u4e0d\u540c\u9636\u6bb5\u8fdb\u884c\u5c40\u90e8\u6307\u4ee4\u5e8f\u5217\u4f18\u5316\uff0c\u5982\u6d88\u9664\u5197\u4f59\u8df3\u8f6c\u6216\u7b80\u5316\u6307\u4ee4\u3002</li> <li>\u7b2c5\u6b65simplify-ro-loads\u5c1d\u8bd5\u5c06\u4ece\u53ea\u8bfb\u6570\u636e\u6bb5\u52a0\u8f7d\u5e38\u91cf\u7684\u64cd\u4f5c\u66ff\u6362\u4e3a\u7acb\u5373\u6570\u52a0\u8f7d\uff0c\u51cf\u8f7bD-cache\u538b\u529b\u3002</li> <li>\u7b2c6\u6b65\u518d\u6b21\u5e94\u7528icf\uff0c\u4f5c\u4e3a\u4e8c\u6b21\u626b\u63cf\uff0c\u8fdb\u4e00\u6b65\u6316\u6398\u53ef\u5408\u5e76\u7684\u91cd\u590d\u4ee3\u7801\u3002</li> <li>\u7b2c7\u6b65plt\uff08Procedure Linkage Table\uff09\u4f18\u5316\u79fb\u9664\u5bf9PLT\u7684\u95f4\u63a5\u8c03\u7528\uff0c\u76f4\u63a5\u8df3\u8f6c\u81f3\u76ee\u6807\u51fd\u6570\uff0c\u964d\u4f4e\u52a8\u6001\u94fe\u63a5\u5f00\u9500\u3002</li> <li>\u7b2c8\u6b65reorder-bbs\u662f\u6838\u5fc3\u5e03\u5c40\u4f18\u5316\uff0c\u6839\u636e\u6267\u884c\u9891\u7387\u91cd\u6392\u57fa\u672c\u5757\uff0c\u5e76\u62c6\u5206\u51b7\u70ed\u8def\u5f84\u81f3\u4e0d\u540c\u6bb5\uff0c\u63d0\u5347I-cache\u547d\u4e2d\u7387\u3002</li> <li>\u7b2c10\u6b65uce\uff08Unreachable Code Elimination\uff09\u79fb\u9664\u65e0\u6cd5\u5230\u8fbe\u7684\u57fa\u672c\u5757\uff0c\u7cbe\u7b80\u4ee3\u7801\u3002</li> <li>\u7b2c11\u6b65fixup-branches\u4fee\u6b63\u56e0\u91cd\u6392\u5bfc\u81f4\u7684\u5206\u652f\u6307\u4ee4\u76ee\u6807\u5730\u5740\u9519\u8bef\uff0c\u786e\u4fddCFG\u4e00\u81f4\u6027\u3002</li> <li>\u7b2c12\u6b65reorder-functions\u5e94\u7528HFSort\u7b97\u6cd5\uff0c\u57fa\u4e8e\u52a0\u6743\u8c03\u7528\u56fe\u91cd\u65b0\u6392\u5217\u51fd\u6570\u4f4d\u7f6e\uff0c\u4f18\u5316I-TLB\u8868\u73b0\u3002</li> <li>\u7b2c13\u6b65stct\uff08Simplify Conditional Tail Calls\uff09\u7b80\u5316\u6761\u4ef6\u5c3e\u8c03\u7528\uff0c\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u8df3\u8f6c\u3002</li> <li>\u7b2c14\u6b65frame-opts\u79fb\u9664\u4e0d\u5fc5\u8981\u7684\u8c03\u7528\u8005\u4fdd\u5b58\u5bc4\u5b58\u5668\u6ea2\u51fa\uff0c\u8282\u7701\u6808\u7a7a\u95f4\u548c\u6307\u4ee4\u5f00\u9500\u3002</li> <li>\u6700\u540e\u4e00\u6b65shrink-wrapping\u6839\u636e\u5256\u9762\u6570\u636e\uff0c\u5c06\u88ab\u8c03\u7528\u51fd\u6570\u7684\u5bc4\u5b58\u5668\u4fdd\u5b58/\u6062\u590d\u64cd\u4f5c\u79fb\u52a8\u5230\u66f4\u9760\u8fd1\u5b9e\u9645\u4f7f\u7528\u70b9\u7684\u4f4d\u7f6e\uff0c\u51cf\u5c11\u51b7\u8def\u5f84\u5f00\u9500\u3002</li> </ul> Pass Name Description 1. strip-rep-ret Strip repz from repz retq instructions used for legacy AMD processors 2. icf Identical code folding 3. icp Indirect call promotion 4. peepholes Simple peephole optimizations 5. simplify-ro-loads Fetch constant data in .rodata whose address is known statically and mutate a load into a mov 6. icf Identical code folding (second run) 7. plt Remove indirection from PLT calls 8. reorder-bbs Reorder basic blocks and split hot/cold blocks into separate sections (layout optimization) 9. peepholes Simple peephole optimizations (second run) 10. uce Eliminate unreachable basic blocks 11. fixup-branches Fix basic block terminator instructions to match the CFG and the current layout (redone by reorder-bbs) 12. reorder-functions Apply HFSort [3] to reorder functions (layout optimization) 13. stct Simplify conditional tail calls 14. frame-opts Removes unnecessary caller-saved register spilling 15. shrink-wrapping Moves callee-saved register spills closer to where they are needed, if profiling data shows it is better to do so <ul> <li>\u6574\u4f53\u6d41\u7a0b\u8bbe\u8ba1\u4f53\u73b0\u5206\u5c42\u4f18\u5316\u601d\u60f3\uff1a\u5148\u505a\u8f7b\u91cf\u7ea7\u6307\u4ee4\u6e05\u7406\uff08\u5982strip\u3001peephole\uff09\uff0c\u518d\u505a\u7ed3\u6784\u91cd\u7ec4\uff08\u5982reorder-bbs\u3001reorder-functions\uff09\uff0c\u6700\u540e\u505a\u6df1\u5ea6\u4f18\u5316\uff08\u5982shrink-wrapping\uff09\u3002</li> <li>\u591a\u6b21\u5e94\u7528icf\u548cpeepholes\u8868\u660eBOLT\u91c7\u7528\u8fed\u4ee3\u5f0f\u4f18\u5316\u7b56\u7565\uff0c\u9010\u6b65\u903c\u8fd1\u6700\u4f18\u89e3\u3002</li> <li>reorder-bbs\u4e0ereorder-functions\u662f\u6027\u80fd\u63d0\u5347\u7684\u6838\u5fc3\uff0c\u76f4\u63a5\u5f71\u54cdI-cache\u548cI-TLB\u6548\u7387\uff0c\u4e5f\u662fBOLT\u533a\u522b\u4e8e\u4f20\u7edf\u7f16\u8bd1\u5668\u7684\u5173\u952e\u6240\u5728\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-5-performance-improvements-from-bolt-for-our-set-of-facebook-data-center-workloads","title":"Fig. 5: Performance improvements from BOLT for our set of Facebook data-center workloads.","text":"<ul> <li>\u56fe\u7247\u4e3a\u67f1\u72b6\u56fe\uff0c\u6807\u9898\u4e3a\u201cFig. 5: Performance improvements from BOLT for our set of Facebook data-center workloads\u201d\uff0c\u5c55\u793aBOLT\u5728Facebook\u6570\u636e\u4e2d\u5fc3\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u7684\u6027\u80fd\u63d0\u5347\u767e\u5206\u6bd4\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u516d\u4e2a\u5e94\u7528\uff1aHHVM\u3001TAO\u3001Proxygen\u3001Multifeed1\u3001Multifeed2 \u548c GeoMean\u3002</li> <li>\u7eb5\u8f74\u8868\u793a\u6027\u80fd\u63d0\u5347\u767e\u5206\u6bd4\uff08% Speedup\uff09\uff0c\u8303\u56f4\u4ece0\u523010\u3002</li> <li>\u5404\u5e94\u7528\u7684\u6027\u80fd\u63d0\u5347\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> \u5e94\u7528 % Speedup HHVM ~7.0% TAO ~5.0% Proxygen ~5.0% Multifeed1 ~2.0% Multifeed2 ~7.0% GeoMean ~5.1% <ul> <li>HHVM \u548c Multifeed2 \u8868\u73b0\u6700\u4f73\uff0c\u5747\u8fbe\u5230\u7ea6 7.0% \u7684\u901f\u5ea6\u63d0\u5347\u3002</li> <li>TAO \u548c Proxygen \u63d0\u5347\u5e45\u5ea6\u76f8\u8fd1\uff0c\u7ea6\u4e3a 5.0%\u3002</li> <li>Multifeed1 \u63d0\u5347\u6700\u5c0f\uff0c\u4ec5\u7ea6 2.0%\u3002</li> <li>GeoMean \u4f5c\u4e3a\u51e0\u4f55\u5e73\u5747\u503c\uff0c\u663e\u793a\u6574\u4f53\u5e73\u5747\u63d0\u5347\u4e3a 5.1%\uff0c\u8868\u660eBOLT\u5bf9\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u5747\u6709\u663e\u8457\u4f18\u5316\u6548\u679c\u3002</li> <li>\u6240\u6709\u67f1\u4f53\u5747\u4e3a\u84dd\u8272\uff0c\u9ad8\u5ea6\u76f4\u89c2\u53cd\u6620\u5404\u5e94\u7528\u53d7\u76ca\u7a0b\u5ea6\uff0c\u8bf4\u660eBOLT\u5728\u4e0d\u540c\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\u4e2d\u8868\u73b0\u7a33\u5b9a\u4e14\u6709\u6548\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-6-performance-improvements-for-clang","title":"Fig. 6: Performance improvements for Clang.","text":"<ul> <li>\u56fe\u7247\u4e3a\u67f1\u72b6\u56fe\uff0c\u6807\u9898\u4e3a\u201cFig. 6: Performance improvements for Clang\u201d\uff0c\u5c55\u793a BOLT \u5bf9 Clang \u7f16\u8bd1\u5668\u6027\u80fd\u7684\u63d0\u5347\u6548\u679c\u3002</li> <li>\u56fe\u8868\u6a2a\u8f74\u5305\u542b\u56db\u4e2a\u6d4b\u8bd5\u573a\u666f\uff1ainput1\u3001input2\u3001input3 \u548c clang-build\uff0c\u5206\u522b\u4ee3\u8868\u4e0d\u540c\u89c4\u6a21\u7684\u6e90\u6587\u4ef6\u7f16\u8bd1\u548c\u5b8c\u6574 Clang \u6784\u5efa\u8fc7\u7a0b\u3002</li> <li>\u7eb5\u8f74\u4e3a % Speedup\uff0c\u8868\u793a\u76f8\u5bf9\u4e8e\u57fa\u7ebf\u7684\u6027\u80fd\u52a0\u901f\u767e\u5206\u6bd4\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e09\u79cd\u4f18\u5316\u914d\u7f6e\uff1a</li> <li>BOLT\uff08\u84dd\u8272\uff09\uff1a\u4ec5\u5e94\u7528 BOLT \u4f18\u5316\u3002</li> <li>PGO+LTO\uff08\u6a59\u8272\uff09\uff1a\u5e94\u7528 Profile-Guided Optimization \u4e0e Link-Time Optimization\u3002</li> <li> <p>PGO+LTO+BOLT\uff08\u7eff\u8272\uff09\uff1a\u5728 PGO+LTO \u57fa\u7840\u4e0a\u518d\u5e94\u7528 BOLT\u3002</p> </li> <li> <p>\u5404\u6d4b\u8bd5\u573a\u666f\u5177\u4f53\u6570\u636e\u5982\u4e0b\uff1a</p> </li> </ul> \u6d4b\u8bd5\u573a\u666f BOLT \u52a0\u901f PGO+LTO \u52a0\u901f PGO+LTO+BOLT \u52a0\u901f input1 52.14% 39.92% 68.49% input2 40.15% 30.54% 53.25% input3 22.27% 21.52% 33.98% clang-build 36.22% 29.93% 49.42% <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5728\u6240\u6709\u6d4b\u8bd5\u4e2d\uff0cPGO+LTO+BOLT \u7ec4\u5408\u65b9\u6848\u5747\u53d6\u5f97\u6700\u9ad8\u52a0\u901f\u6bd4\uff0c\u8868\u660e BOLT \u4e0e\u4f20\u7edf\u7f16\u8bd1\u65f6\u4f18\u5316\u4e92\u8865\u3002</li> <li>BOLT \u5355\u72ec\u4f7f\u7528\u65f6\u6027\u80fd\u4f18\u4e8e PGO+LTO\uff0c\u5c24\u5176\u5728 input1 \u548c clang-build \u573a\u666f\u4e0b\u4f18\u52bf\u660e\u663e\u3002</li> <li>clang-build \u573a\u666f\u4e0b\uff0cBOLT \u8d21\u732e\u4e86\u7ea6 19.5% \u7684\u989d\u5916\u52a0\u901f\uff0849.42% - 29.93%\uff09\uff0c\u9a8c\u8bc1\u5176\u5bf9\u5927\u578b\u524d\u7aef\u7ed1\u5b9a\u5e94\u7528\u7684\u6709\u6548\u6027\u3002</li> <li>\u968f\u7740\u8f93\u5165\u89c4\u6a21\u589e\u5927\uff08\u4ece input1 \u5230 clang-build\uff09\uff0cBOLT \u76f8\u5bf9\u4e8e PGO+LTO \u7684\u589e\u76ca\u6bd4\u4f8b\u4e0b\u964d\uff0c\u4f46\u4ecd\u4fdd\u6301\u663e\u8457\u6b63\u5411\u8d21\u732e\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-7-performance-improvements-for-gcc-lto-was-not-used-due-to-build-errors","title":"Fig. 7: Performance improvements for GCC. LTO was not used due to build errors.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 GCC \u7f16\u8bd1\u5668\u5728\u4e0d\u540c\u4f18\u5316\u914d\u7f6e\u4e0b\u7684\u6027\u80fd\u63d0\u5347\u767e\u5206\u6bd4\uff0c\u6a2a\u8f74\u4e3a\u56db\u79cd\u4e0d\u540c\u7684\u6d4b\u8bd5\u573a\u666f\uff08input1, input2, input3, clang-build\uff09\uff0c\u7eb5\u8f74\u4e3a % Speedup\u3002</li> <li>\u4e09\u79cd\u4f18\u5316\u7b56\u7565\u4ee5\u4e0d\u540c\u989c\u8272\u67f1\u72b6\u56fe\u8868\u793a\uff1a</li> <li>\u84dd\u8272\uff1a\u4ec5\u4f7f\u7528 BOLT \u4f18\u5316\u3002</li> <li>\u6a59\u8272\uff1a\u4ec5\u4f7f\u7528 PGO\uff08Profile-Guided Optimization\uff09\u3002</li> <li>\u7eff\u8272\uff1aPGO + BOLT \u8054\u5408\u4f18\u5316\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u5728\u6240\u6709\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0cPGO + BOLT \u7684\u7ec4\u5408\u5747\u5e26\u6765\u6700\u9ad8\u6027\u80fd\u589e\u76ca\uff0c\u8bc1\u660e\u4e24\u8005\u4f18\u5316\u7b56\u7565\u5177\u6709\u4e92\u8865\u6027\u3002</li> <li>\u5404\u573a\u666f\u5177\u4f53\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> \u6d4b\u8bd5\u573a\u666f BOLT (%) PGO (%) PGO+BOLT (%) input1 24.28 16.46 27.08 input2 24.12 17.28 27.52 input3 13.99 12.42 17.76 clang-build 21.26 15.73 24.35 <ul> <li>\u5728 clang-build \u573a\u666f\u4e0b\uff0cBOLT \u5355\u72ec\u4f18\u5316\u5e26\u6765 21.26% \u63d0\u5347\uff0c\u800c PGO \u4e3a 15.73%\uff0c\u8054\u5408\u4f18\u5316\u8fbe\u5230 24.35%\uff0c\u663e\u793a BOLT \u5bf9\u5927\u578b\u7f16\u8bd1\u4efb\u52a1\u6709\u663e\u8457\u52a0\u901f\u6548\u679c\u3002</li> <li>\u56fe\u6ce8\u660e\u786e\u6307\u51fa\uff0c\u8be5\u5b9e\u9a8c\u4e2d LTO \u672a\u542f\u7528\uff0c\u56e0\u6784\u5efa\u65f6\u51fa\u73b0\u9519\u8bef\uff0c\u56e0\u6b64\u6240\u6709\u7ed3\u679c\u5747\u4e3a\u975e LTO \u914d\u7f6e\u4e0b\u7684\u8868\u73b0\u3002</li> <li>\u6574\u4f53\u8d8b\u52bf\u663e\u793a\uff0cBOLT \u5728\u65e0 PGO \u57fa\u7840\u4e0a\u4ecd\u80fd\u63d0\u4f9b\u53ef\u89c2\u52a0\u901f\uff0c\u5c24\u5176\u5728\u590d\u6742\u7f16\u8bd1\u4efb\u52a1\u4e2d\u8868\u73b0\u7a81\u51fa\uff0c\u9a8c\u8bc1\u5176\u4f5c\u4e3a\u540e\u94fe\u63a5\u4f18\u5316\u5668\u7684\u6709\u6548\u6027\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#table-ii-statistics-reported-by-bolt-when-applied-to-clangs-baseline-and-pgolto-binaries","title":"TABLE II: Statistics reported by BOLT when applied to Clang\u2019s baseline and PGO+LTO binaries.","text":"<ul> <li>\u56fe\u7247\u5185\u5bb9\u4e3a TABLE II\uff0c\u5c55\u793a\u4e86 BOLT \u5e94\u7528\u4e8e Clang \u7f16\u8bd1\u5668\u4e8c\u8fdb\u5236\u6587\u4ef6\u65f6\u62a5\u544a\u7684\u6027\u80fd\u7edf\u8ba1\u6307\u6807\uff0c\u5bf9\u6bd4\u4e86\u4e24\u79cd\u57fa\u51c6\uff1aBaseline\uff08\u672a\u4f18\u5316\uff09\u548c PGO+LTO\uff08\u5df2\u5e94\u7528 Profile-Guided Optimization \u4e0e Link-Time Optimization\uff09\u3002</li> <li>\u8868\u683c\u5305\u542b\u4e09\u5217\uff1aMetric\uff08\u6307\u6807\u540d\u79f0\uff09\u3001Over Baseline\uff08\u76f8\u5bf9\u4e8e\u57fa\u7ebf\u7684\u6539\u8fdb\u767e\u5206\u6bd4\uff09\u3001Over PGO+LTO\uff08\u76f8\u5bf9\u4e8e PGO+LTO \u7684\u6539\u8fdb\u767e\u5206\u6bd4\uff09\u3002</li> <li>\u6240\u6709\u6570\u636e\u5747\u4e3a\u8d1f\u503c\u6216\u6b63\u503c\uff0c\u8d1f\u503c\u8868\u793a\u51cf\u5c11\uff08\u5982\u5206\u652f\u6570\u3001\u6307\u4ee4\u6570\uff09\uff0c\u6b63\u503c\u8868\u793a\u589e\u52a0\uff08\u5982\u975e\u8df3\u8f6c\u6761\u4ef6\u5206\u652f\uff09\uff0c\u53cd\u6620 BOLT \u4f18\u5316\u540e\u5bf9\u7a0b\u5e8f\u6267\u884c\u884c\u4e3a\u7684\u5f71\u54cd\u3002</li> </ul> Metric Over Baseline Over PGO+LTO executed forward branches -1.6% -1.0% taken forward branches -83.9% -61.1% executed backward branches +9.6% +6.0% taken backward branches -9.2% -21.8% executed unconditional branches -66.6% -36.3% executed instructions -1.2% -0.7% total branches -7.3% -2.2% taken branches -69.8% -44.3% non-taken conditional branches +60.0% +13.7% taken conditional branches -70.6% -46.6% <ul> <li>\u5173\u952e\u89c2\u5bdf\u70b9\uff1a</li> <li>taken forward branches \u548c taken conditional branches \u5728\u4e24\u79cd\u57fa\u51c6\u4e0b\u5747\u5927\u5e45\u51cf\u5c11\uff0c\u5206\u522b\u8fbe -83.9% \u548c -70.6%\uff08\u76f8\u5bf9\u57fa\u7ebf\uff09\uff0c\u8868\u660e BOLT \u901a\u8fc7\u4f18\u5316\u57fa\u672c\u5757\u5e03\u5c40\u663e\u8457\u51cf\u5c11\u4e86\u201c\u8df3\u8f6c\u201d\u8def\u5f84\uff0c\u63d0\u5347\u4e86 I-cache \u5c40\u90e8\u6027\u3002</li> <li>non-taken conditional branches \u589e\u52a0\uff0c\u8bf4\u660e BOLT \u5c06\u51b7\u8def\u5f84\u79fb\u51fa\u70ed\u8def\u5f84\uff0c\u4f7f\u539f\u672c\u201c\u4e0d\u8df3\u8f6c\u201d\u7684\u5206\u652f\u53d8\u591a\uff0c\u7b26\u5408\u5176\u201c\u70ed\u8def\u5f84\u76f4\u901a\u5316\u201d\u7b56\u7565\u3002</li> <li>\u5373\u4f7f\u5728\u5df2\u5e94\u7528 PGO+LTO \u7684\u9ad8\u5ea6\u4f18\u5316\u4e8c\u8fdb\u5236\u4e0a\uff0cBOLT \u4ecd\u80fd\u5e26\u6765\u53ef\u89c2\u6539\u8fdb\uff0c\u4f8b\u5982 taken branches \u51cf\u5c11 44.3%\uff0c\u8bc1\u660e\u5176\u4f18\u5316\u4e0e\u7f16\u8bd1\u5668\u7ea7\u4f18\u5316\u4e92\u8865\u3002</li> <li>executed instructions \u4ec5\u5c0f\u5e45\u51cf\u5c11\uff08-0.7% over PGO+LTO\uff09\uff0c\u8bf4\u660e BOLT \u4e3b\u8981\u4f18\u5316\u7684\u662f\u4ee3\u7801\u5e03\u5c40\u800c\u975e\u6307\u4ee4\u6570\u91cf\uff0c\u5176\u6838\u5fc3\u4ef7\u503c\u5728\u4e8e\u63d0\u5347\u524d\u7aef\u786c\u4ef6\u7ed3\u6784\uff08\u5982 I-cache\u3001branch predictor\uff09\u6548\u7387\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0cBOLT \u5bf9 forward branches \u7684\u4f18\u5316\u6548\u679c\u6700\u5f3a\uff0c\u8fd9\u4e0e\u5176\u201c\u5c06\u6700\u5e38\u6267\u884c\u7684\u540e\u7ee7\u5757\u8bbe\u4e3a fall-through\u201d\u7684\u57fa\u672c\u5757\u91cd\u6392\u7b56\u7565\u4e00\u81f4\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-8-breakdown-of-improvements-on-different-metrics-for-hhvm-higher-is-better-icf-refers-to-identical-code-folding-optimizations-are-always-added-on-top-of-the-previous-bar-ie-bb-reordering-has-function-reordering-huge-pages-and-basic-block-reordering-all-turned-on","title":"Fig. 8: Breakdown of improvements on different metrics for HHVM (higher is better). ICF refers to identical code folding. Optimizations are always added on top of the previous bar, i.e., +BB reordering has function reordering, huge pages and basic block reordering all turned on.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 BOLT \u5bf9 HHVM \u5e94\u7528\u5728\u4e0d\u540c\u4f18\u5316\u9636\u6bb5\u4e0b\u5404\u9879\u6027\u80fd\u6307\u6807\u7684\u63d0\u5347\u6548\u679c\uff0c\u6240\u6709\u6307\u6807\u5747\u4e3a\u767e\u5206\u6bd4\u51cf\u5c11\u503c\uff08\u8d8a\u4f4e\u8d8a\u597d\uff09\uff0c\u4f46\u56fe\u4f8b\u8bf4\u660e\u201chigher is better\u201d\uff0c\u5b9e\u9645\u5e94\u7406\u89e3\u4e3a\u201c\u51cf\u5c11\u5f97\u8d8a\u591a\uff0c\u6027\u80fd\u63d0\u5347\u8d8a\u5927\u201d\u3002</li> <li>\u4f18\u5316\u7b56\u7565\u6309\u987a\u5e8f\u53e0\u52a0\u5e94\u7528\uff1a\u4ece\u201cFunction reordering\u201d\u5f00\u59cb\uff0c\u9010\u6b65\u589e\u52a0\u201c+Huge pages\u201d\u3001\u201c+BB reordering\u201d\u3001\u201c+ICF\u201d\u3001\u201c+Function splitting\u201d\uff0c\u6700\u7ec8\u5230\u201cAll\u201d\uff08\u5305\u542b Table I \u4e2d\u6240\u6709\u4f18\u5316\uff09\u3002</li> <li>\u5404\u9879\u6307\u6807\u7684\u4f18\u5316\u6548\u679c\u5982\u4e0b\uff1a</li> </ul> \u6307\u6807 Function reordering +Huge pages +BB reordering +ICF +Function splitting All CPU Time 1.84% 3.2% 9.09% 9.14% 9.62% 9.64% Branch 0.07% 0.16% 10.44% 10.43% 10.77% 9.66% I-Cache 4.34% 4.47% 21.69% 21.84% 24.81% 25.41% I-TLB 8.5% \u2014 32.12% 39.88% 41.03% 42.46% D-Cache 1.13% 2.71% 3.8% 3.73% 4.02% 4.18% D-TLB 3.53% 9.71% 13.76% 14.05% 14.43% 14.74% LLC 0.92% 1.95% 7.01% 6.38% 8.06% 7.19% <ul> <li>I-TLB \u548c I-Cache \u7684\u6539\u8fdb\u6700\u4e3a\u663e\u8457\uff0c\u5728\u201cAll\u201d\u4f18\u5316\u4e0b\u5206\u522b\u8fbe\u5230 42.46% \u548c 25.41% \u7684\u51cf\u5c11\uff0c\u8868\u660e BOLT \u5728\u6539\u5584\u6307\u4ee4\u7f13\u5b58\u548c TLB \u5c40\u90e8\u6027\u65b9\u9762\u6548\u679c\u7a81\u51fa\u3002</li> <li>CPU Time \u7684\u6700\u7ec8\u4f18\u5316\u5e45\u5ea6\u4e3a 9.64%\uff0c\u4e0e\u8bba\u6587\u6458\u8981\u4e2d\u63d0\u5230\u7684\u201cup to 7.0%\u201d\u7565\u6709\u51fa\u5165\uff0c\u53ef\u80fd\u56e0\u6d4b\u8bd5\u73af\u5883\u6216\u5de5\u4f5c\u8d1f\u8f7d\u4e0d\u540c\u6240\u81f4\uff0c\u4f46\u4ecd\u4f53\u73b0\u663e\u8457\u6027\u80fd\u589e\u76ca\u3002</li> <li>\u201c+BB reordering\u201d\u5bf9 I-Cache \u548c I-TLB \u7684\u8d21\u732e\u5de8\u5927\uff0c\u5206\u522b\u5e26\u6765 21.69% \u548c 32.12% \u7684\u6539\u8fdb\uff0c\u8bf4\u660e\u57fa\u672c\u5757\u91cd\u6392\u662f\u63d0\u5347\u4ee3\u7801\u5c40\u90e8\u6027\u7684\u6838\u5fc3\u624b\u6bb5\u3002</li> <li>\u201c+Huge pages\u201d\u4ec5\u5bf9 I-TLB \u6709\u660e\u663e\u5e2e\u52a9\uff08\u4ece 8.5% \u63d0\u5347\u81f3 32.12%\uff09\uff0c\u800c\u5bf9\u5176\u4ed6\u6307\u6807\u5f71\u54cd\u8f83\u5c0f\uff0c\u7b26\u5408\u5176\u8bbe\u8ba1\u76ee\u6807\u2014\u2014\u51cf\u5c11 TLB miss\u3002</li> <li>\u201c+Function splitting\u201d\u5bf9 I-Cache \u548c I-TLB \u4ecd\u6709\u5c0f\u5e45\u63d0\u5347\uff0c\u8bf4\u660e\u5c06\u51b7\u4ee3\u7801\u79fb\u51fa\u70ed\u8def\u5f84\u80fd\u8fdb\u4e00\u6b65\u538b\u7f29\u70ed\u70b9\u533a\u57df\u3002</li> <li>\u6700\u7ec8\u201cAll\u201d\u4f18\u5316\u5e76\u672a\u5728\u6240\u6709\u6307\u6807\u4e0a\u90fd\u8fbe\u5230\u5cf0\u503c\uff08\u5982 Branch \u548c LLC \u53cd\u800c\u7565\u964d\uff09\uff0c\u8bf4\u660e\u90e8\u5206\u4f18\u5316\u5b58\u5728\u6743\u8861\uff0c\u9700\u6839\u636e\u76ee\u6807\u9009\u62e9\u7ec4\u5408\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-9-breakdown-of-improvements-on-different-metrics-for-clang-higher-is-better-icf-refers-to-identical-code-folding-optimizations-are-always-added-on-top-of-the-previous-bar-ie-icf-includes-bb-reordering-and-icf-both-turned-on","title":"Fig. 9: Breakdown of improvements on different metrics for Clang (higher is better). ICF refers to identical code folding. Optimizations are always added on top of the previous bar, i.e., +ICF includes BB reordering and ICF both turned on.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 BOLT \u5bf9 Clang \u7f16\u8bd1\u5668\u4e8c\u8fdb\u5236\u6587\u4ef6\u5e94\u7528\u4e0d\u540c\u4f18\u5316\u7ec4\u5408\u540e\uff0c\u5728\u591a\u4e2a\u5fae\u67b6\u6784\u6307\u6807\u4e0a\u7684\u6027\u80fd\u63d0\u5347\u767e\u5206\u6bd4\uff0c\u6570\u503c\u8d8a\u9ad8\u4ee3\u8868\u4f18\u5316\u6548\u679c\u8d8a\u597d\u3002</li> <li>\u4f18\u5316\u7b56\u7565\u6309\u987a\u5e8f\u53e0\u52a0\uff1a\u4ece\u57fa\u7840\u7684 BB reordering\uff08\u57fa\u672c\u5757\u91cd\u6392\uff09\u5f00\u59cb\uff0c\u9010\u6b65\u589e\u52a0 +ICF\uff08\u76f8\u540c\u4ee3\u7801\u6298\u53e0\uff09\u3001+Function splitting\uff08\u51fd\u6570\u62c6\u5206\uff09\u3001+Function reordering\uff08\u51fd\u6570\u91cd\u6392\uff09\uff0c\u6700\u7ec8\u5230 All\uff08\u5305\u542b Table I \u4e2d\u6240\u6709\u4f18\u5316\uff09\u3002</li> <li>\u5404\u9879\u6307\u6807\u7684\u4f18\u5316\u6548\u679c\u5982\u4e0b\u8868\u6240\u793a\uff1a</li> </ul> \u6307\u6807 BB reordering +ICF +Function splitting +Function reordering All CPU Time 7.57% 7.27% 9.75% 15.6% 16.68% Branch 9.94% 9.64% 11.14% 11.36% 9.91% I-Cache 18.13% 17.29% 19.3% 20.46% 20.44% I-TLB 1.96% 3.3% 5.66% 36.38% 63.74% D-Cache 0.9% 0.6% 1.63% 7.7% 9.5% D-TLB 4.17% 3.7% 6.02% 19.7% 22.19% LLC 0.14% 0.51% 3.09% 3.31% 2.83% <ul> <li>I-TLB \u7684\u4f18\u5316\u6548\u679c\u6700\u4e3a\u663e\u8457\uff0c\u4ece\u57fa\u7840\u91cd\u6392\u7684 1.96% \u63d0\u5347\u81f3\u5168\u4f18\u5316\u7684 63.74%\uff0c\u8868\u660e \u51fd\u6570\u91cd\u6392 \u548c \u51fd\u6570\u62c6\u5206 \u5bf9\u51cf\u5c11\u6307\u4ee4 TLB \u7f3a\u5931\u6781\u4e3a\u6709\u6548\u3002</li> <li>I-Cache \u4f18\u5316\u7a33\u5b9a\u5728 17%-20% \u533a\u95f4\uff0c\u8bf4\u660e \u57fa\u672c\u5757\u91cd\u6392 \u548c \u51fd\u6570\u91cd\u6392 \u80fd\u6709\u6548\u63d0\u5347\u6307\u4ee4\u7f13\u5b58\u547d\u4e2d\u7387\u3002</li> <li>CPU Time \u968f\u4f18\u5316\u53e0\u52a0\u6301\u7eed\u63d0\u5347\uff0c\u6700\u7ec8\u8fbe\u5230 16.68%\uff0c\u9a8c\u8bc1\u4e86 BOLT \u4f18\u5316\u7b56\u7565\u7684\u7d2f\u79ef\u6548\u5e94\u3002</li> <li>Branch \u6307\u6807\u5728\u52a0\u5165\u51fd\u6570\u91cd\u6392\u540e\u7565\u6709\u4e0b\u964d\uff0c\u53ef\u80fd\u56e0\u51fd\u6570\u91cd\u6392\u5f15\u5165\u989d\u5916\u8df3\u8f6c\u6216\u6539\u53d8\u5206\u652f\u9884\u6d4b\u6a21\u5f0f\uff0c\u4f46\u6574\u4f53\u4ecd\u4fdd\u6301\u5728 9% \u4ee5\u4e0a\u3002</li> <li>D-Cache \u548c D-TLB \u4f18\u5316\u5e45\u5ea6\u8f83\u5c0f\uff0c\u8bf4\u660e BOLT \u4e3b\u8981\u9488\u5bf9\u6307\u4ee4\u8def\u5f84\u4f18\u5316\uff0c\u5bf9\u6570\u636e\u8def\u5f84\u5f71\u54cd\u6709\u9650\u3002</li> <li>LLC\uff08Last Level Cache\uff09\u4f18\u5316\u6548\u679c\u6700\u5f31\uff0c\u6700\u9ad8\u4ec5 3.31%\uff0c\u8868\u660e BOLT \u672a\u91cd\u70b9\u4f18\u5316\u8de8\u5c42\u7ea7\u7f13\u5b58\u884c\u4e3a\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-10-real-example-of-poor-code-layout-produced-by-the-clang-compiler-compiling-itself-even-with-pgo-block-lft680413-is-cold-exec-count-0-but-it-is-placed-between-two-hot-blocks-connected-by-a-forward-taken-branch","title":"Fig. 10: Real example of poor code layout produced by the Clang compiler (compiling itself) even with PGO. Block .LFT680413 is cold (Exec Count: 0), but it is placed between two hot blocks connected by a forward taken branch.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Clang \u7f16\u8bd1\u5668\u5728\u81ea\u8eab\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\uff0c\u5373\u4f7f\u542f\u7528\u4e86 PGO\uff08Profile-Guided Optimization\uff09\uff0c\u4ecd\u4ea7\u751f\u7684\u4e00\u4e2a\u4e0d\u826f\u4ee3\u7801\u5e03\u5c40\u5b9e\u4f8b\u3002</li> <li>\u8be5\u51fd\u6570\u540d\u4e3a <code>clang::Redeclarable&lt;clang::TagDecl&gt;::DeclLink::getNext(...)</code>\uff0c\u5176\u5185\u90e8\u5305\u542b\u4e09\u4e2a\u57fa\u672c\u5757\uff1a<code>.Ltmp1100284</code>\u3001<code>.LFT680413</code> \u548c <code>.Ltmp1100279</code>\u3002</li> <li>\u6838\u5fc3\u95ee\u9898\u662f\uff1a\u51b7\u4ee3\u7801\u5757 <code>.LFT680413</code> \u88ab\u5939\u5728\u4e24\u4e2a\u70ed\u4ee3\u7801\u5757\u4e4b\u95f4\uff0c\u4e14\u8fd9\u4e24\u4e2a\u70ed\u5757\u901a\u8fc7\u4e00\u4e2a\u5411\u524d\u7684\u3001\u9ad8\u9891\u7387\u6267\u884c\u7684\u5206\u652f\u76f8\u8fde\u3002</li> <li>\u6267\u884c\u8ba1\u6570\uff08Exec Count\uff09\u6570\u636e\u6e05\u6670\u8868\u660e\u4e86\u5404\u5757\u7684\u70ed\u5ea6\uff1a</li> <li><code>.Ltmp1100284</code>: 1,635,334 \u6b21\u6267\u884c</li> <li><code>.LFT680413</code>: 0 \u6b21\u6267\u884c\uff08\u5b8c\u5168\u51b7\uff09</li> <li><code>.Ltmp1100279</code>: 1,769,771 \u6b21\u6267\u884c</li> <li>\u8fd9\u79cd\u5e03\u5c40\u5bfc\u81f4\u5904\u7406\u5668\u5728\u6267\u884c\u5b8c\u70ed\u5757 <code>.Ltmp1100284</code> \u540e\uff0c\u5fc5\u987b\u8df3\u8fc7\u4e2d\u95f4\u7684\u51b7\u5757 <code>.LFT680413</code> \u624d\u80fd\u5230\u8fbe\u4e0b\u4e00\u4e2a\u70ed\u5757 <code>.Ltmp1100279</code>\uff0c\u8fd9\u4f1a\u7834\u574f\u6307\u4ee4\u7f13\u5b58\uff08I-cache\uff09\u548c\u5206\u652f\u9884\u6d4b\u5668\u7684\u6548\u7387\u3002</li> <li>\u4ece\u6e90\u7801\u6ce8\u91ca\u770b\uff0c<code>.LFT680413</code> \u5bf9\u5e94\u7684\u6e90\u6587\u4ef6\u662f <code>ExternalASTSource.h:462:19</code>\uff0c\u5176\u529f\u80fd\u662f\u68c0\u67e5\u6307\u9488\u662f\u5426\u4e3a\u96f6\u5e76\u8df3\u8f6c\u3002\u867d\u7136\u8be5\u903b\u8f91\u672c\u8eab\u53ef\u80fd\u4e0d\u51b7\uff0c\u4f46\u5728\u5f53\u524d\u8fd9\u4e2a\u7279\u5b9a\u7684\u8c03\u7528\u70b9\u88ab\u5185\u8054\u540e\uff0c\u5176\u6267\u884c\u8def\u5f84\u53d8\u5f97\u5b8c\u5168\u4e0d\u6d3b\u8dc3\u3002</li> <li>BOLT \u7684\u4f5c\u7528\u6b63\u662f\u8bc6\u522b\u8fd9\u79cd\u7531\u7f16\u8bd1\u5668\u5185\u8054\u9020\u6210\u7684\u201c\u865a\u5047\u201d\u51b7\u70ed\u6df7\u5408\u5e03\u5c40\uff0c\u5e76\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u91cd\u65b0\u6392\u5217\u57fa\u672c\u5757\uff0c\u5c06\u51b7\u4ee3\u7801\u79fb\u51fa\u70ed\u8def\u5f84\uff0c\u4ece\u800c\u63d0\u5347\u6027\u80fd\u3002</li> <li>\u8be5\u56fe\u4f5c\u4e3a\u8bc1\u636e\uff0c\u8bc1\u660e\u4e86\u5373\u4f7f\u5728\u9ad8\u7ea7\u4f18\u5316\uff08\u5982 PGO\uff09\u4e4b\u540e\uff0c\u7f16\u8bd1\u5668\u5728\u4ee3\u7801\u5e03\u5c40\u4e0a\u4ecd\u53ef\u80fd\u5b58\u5728\u7f3a\u9677\uff0c\u800c BOLT \u80fd\u591f\u5229\u7528\u66f4\u7cbe\u786e\u7684\u4e8c\u8fdb\u5236\u7ea7\u5256\u9762\u6570\u636e\u6765\u4fee\u590d\u8fd9\u4e9b\u95ee\u9898\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-11-heat-maps-for-instruction-memory-accesses-of-clang-binaries-heat-is-in-a-log-scale","title":"Fig. 11: Heat maps for instruction memory accesses of Clang binaries. Heat is in a log scale.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Clang \u7f16\u8bd1\u5668\u5728\u4e09\u79cd\u4e0d\u540c\u4f18\u5316\u914d\u7f6e\u4e0b\uff0c\u5176\u6307\u4ee4\u5185\u5b58\u8bbf\u95ee\u7684\u70ed\u529b\u56fe\uff0c\u7528\u4e8e\u76f4\u89c2\u6bd4\u8f83\u4ee3\u7801\u5e03\u5c40\u5bf9 I-cache \u5229\u7528\u7387\u7684\u5f71\u54cd\u3002</li> <li>\u70ed\u529b\u56fe\u91c7\u7528\u5bf9\u6570\u523b\u5ea6\uff08log scale\uff09\u6765\u8868\u793a\u8bbf\u95ee\u9891\u7387\uff0c\u989c\u8272\u4ece\u767d\u8272\uff08\u672a\u8bbf\u95ee\uff09\u5230\u6df1\u7ea2\u8272\uff08\u9ad8\u9891\u8bbf\u95ee\uff09\uff0c\u53f3\u4fa7\u8272\u6807\u8303\u56f4\u4e3a 0 \u81f3 10\u3002</li> <li>\u4e09\u5f20\u5b50\u56fe\u5206\u522b\u5bf9\u5e94\uff1a</li> <li>(a) baseline: \u672a\u7ecf\u4efb\u4f55 PGO \u6216 BOLT \u4f18\u5316\u7684\u539f\u59cb\u4e8c\u8fdb\u5236\u3002</li> <li>(b) PGO+LTO: \u7ecf\u8fc7\u7f16\u8bd1\u65f6\u53cd\u9988\u9a71\u52a8\u4f18\u5316\uff08PGO\uff09\u548c\u94fe\u63a5\u65f6\u4f18\u5316\uff08LTO\uff09\u540e\u7684\u4e8c\u8fdb\u5236\u3002</li> <li> <p>(c) PGO+LTO+BOLT: \u5728 PGO+LTO \u57fa\u7840\u4e0a\u518d\u5e94\u7528 BOLT \u540e\u7684\u4e8c\u8fdb\u5236\u3002</p> </li> <li> <p>\u901a\u8fc7\u5bf9\u6bd4\u4e09\u5f20\u56fe\uff0c\u53ef\u4ee5\u89c2\u5bdf\u5230\u4ee5\u4e0b\u5173\u952e\u53d8\u5316\uff1a</p> </li> </ul> \u914d\u7f6e \u70ed\u533a\u5206\u5e03 \u51b7\u533a\u5206\u5e03 \u603b\u4f53\u8d8b\u52bf (a) baseline \u8bbf\u95ee\u70ed\u70b9\u5206\u6563\u5728\u6574\u4e2a\u5730\u5740\u7a7a\u95f4\uff0c\u65e0\u660e\u663e\u805a\u96c6\u3002 \u5927\u91cf\u51b7\u4ee3\u7801\u7a7f\u63d2\u4e8e\u70ed\u533a\u4e4b\u95f4\uff0c\u5bfc\u81f4\u7f13\u5b58\u5229\u7528\u7387\u4f4e\u3002 \u4ee3\u7801\u5e03\u5c40\u6742\u4e71\uff0cI-cache \u6548\u7387\u4f4e\u4e0b\u3002 (b) PGO+LTO \u70ed\u70b9\u5f00\u59cb\u5c40\u90e8\u805a\u96c6\uff0c\u4f46\u4ecd\u6709\u5927\u91cf\u5206\u6563\u7684\u70ed\u5757\u3002 \u51b7\u533a\u4f9d\u7136\u5e7f\u6cdb\u5b58\u5728\uff0c\u4e0e\u70ed\u533a\u4ea4\u9519\u3002 \u76f8\u6bd4 baseline \u6709\u6539\u5584\uff0c\u4f46\u4f18\u5316\u4e0d\u5f7b\u5e95\u3002 (c) PGO+LTO+BOLT \u70ed\u70b9\u9ad8\u5ea6\u96c6\u4e2d\u4e8e\u56fe\u50cf\u5e95\u90e8\u533a\u57df\uff08Y=0~10\uff09\uff0c\u5f62\u6210\u4e00\u4e2a\u7d27\u51d1\u7684\u201c\u70ed\u5c9b\u201d\u3002 \u7edd\u5927\u90e8\u5206\u51b7\u4ee3\u7801\u88ab\u79fb\u51fa\u6838\u5fc3\u70ed\u533a\uff0c\u96c6\u4e2d\u5728\u56fe\u50cf\u4e0a\u90e8\u6216\u7a7a\u767d\u533a\u57df\u3002 BOLT \u5b9e\u73b0\u4e86\u6781\u81f4\u7684\u4ee3\u7801\u538b\u7f29\uff0c\u5c06 55MB \u7684\u6587\u672c\u6bb5\u538b\u7f29\u81f3\u7ea6 6.7MB \u7684\u6d3b\u8dc3\u533a\u57df\uff0c\u6781\u5927\u63d0\u5347 I-cache \u548c I-TLB \u6548\u7387\u3002 <ul> <li>\u6838\u5fc3\u7ed3\u8bba\uff1aBOLT \u901a\u8fc7\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u8fdb\u884c\u51fd\u6570\u91cd\u6392\u548c\u57fa\u672c\u5757\u62c6\u5206\uff0c\u80fd\u591f\u8bc6\u522b\u5e76\u5206\u79bb\u51b7\u70ed\u4ee3\u7801\u8def\u5f84\uff0c\u4ece\u800c\u5728\u7269\u7406\u5185\u5b58\u4e2d\u5b9e\u73b0\u70ed\u4ee3\u7801\u7684\u7d27\u5bc6\u6253\u5305\u3002\u8fd9\u79cd\u4f18\u5316\u662f\u4f20\u7edf\u7f16\u8bd1\u5668\u5728\u6e90\u7801\u6216 IR \u5c42\u9762\u96be\u4ee5\u7cbe\u786e\u5b8c\u6210\u7684\uff0c\u56e0\u4e3a\u5b83\u76f4\u63a5\u57fa\u4e8e\u8fd0\u884c\u65f6\u91c7\u6837\u6570\u636e\uff0c\u907f\u514d\u4e86\u6620\u5c04\u8bef\u5dee\u3002\u6700\u7ec8\u7ed3\u679c\u662f\u663e\u8457\u51cf\u5c11\u6307\u4ee4\u7f13\u5b58\u7f3a\u5931\u548c TLB \u7f3a\u5931\uff0c\u5e26\u6765\u53ef\u89c2\u7684\u6027\u80fd\u63d0\u5347\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/figs_notes/#fig-12-improvements-on-different-metrics-for-hhvm-by-using-lbrs-higher-is-better","title":"Fig. 12: Improvements on different metrics for HHVM by using LBRs (higher is better).","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728 HHVM \u5e94\u7528\u4e0a\uff0c\u4f7f\u7528 LBR\uff08Last Branch Records\uff09\u8fdb\u884c\u6027\u80fd\u4f18\u5316\u540e\uff0c\u4e0d\u540c\u6307\u6807\u7684\u63d0\u5347\u767e\u5206\u6bd4\u3002\u56fe\u8868\u6807\u9898\u660e\u786e\u6307\u51fa\u201chigher is better\u201d\uff0c\u5373\u6570\u503c\u8d8a\u9ad8\u4ee3\u8868\u4f18\u5316\u6548\u679c\u8d8a\u597d\u3002</li> <li>\u56fe\u8868\u6a2a\u8f74\u5217\u51fa\u4e86\u516d\u4e2a\u5173\u952e\u6027\u80fd\u6307\u6807\uff1aInstructions\u3001Branch-miss\u3001I-cache-miss\u3001LLC-miss\u3001iTLB-miss \u548c CPU time\u3002</li> <li>\u7eb5\u8f74\u8868\u793a % Reduction\uff0c\u5373\u76f8\u5bf9\u4e8e\u672a\u4f7f\u7528 LBR \u7684\u57fa\u7ebf\uff0c\u5404\u9879\u6307\u6807\u7684\u51cf\u5c11\u767e\u5206\u6bd4\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e09\u79cd\u4f18\u5316\u573a\u666f\uff1a</li> <li>Functions\uff08\u84dd\u8272\u67f1\uff09\uff1a\u4ec5\u5bf9\u51fd\u6570\u8fdb\u884c\u91cd\u6392\u5e8f\u3002</li> <li>BBs\uff08\u6a59\u8272\u67f1\uff09\uff1a\u4ec5\u5bf9\u57fa\u672c\u5757\uff08Basic Blocks\uff09\u8fdb\u884c\u91cd\u6392\u5e8f\u53ca\u5176\u4ed6\u4f18\u5316\u3002</li> <li>Both\uff08\u7eff\u8272\u67f1\uff09\uff1a\u540c\u65f6\u5e94\u7528\u51fd\u6570\u91cd\u6392\u5e8f\u548c\u57fa\u672c\u5757\u91cd\u6392\u5e8f\u7b49\u6240\u6709\u4f18\u5316\u3002</li> </ul> \u6307\u6807 Functions (\u84dd\u8272) BBs (\u6a59\u8272) Both (\u7eff\u8272) Instructions 0.28% 0.35% \u2014 Branch-miss 0.52% 2.88% 2.82% I-cache-miss 0.66% 2.43% 5.16% LLC-miss 0.03% 1.03% 1.41% iTLB-miss 1.75% 5.39% 8.2% CPU time 0.09% 1.71% 2.16% <ul> <li>\u5173\u952e\u53d1\u73b0\uff1a</li> <li>iTLB-miss \u5728 \u201cBoth\u201d \u573a\u666f\u4e0b\u83b7\u5f97\u6700\u5927\u6539\u5584\uff0c\u8fbe\u5230 8.2% \u7684\u51cf\u5c11\uff0c\u8868\u660e LBR \u5bf9\u6307\u4ee4 TLB \u547d\u4e2d\u7387\u6709\u663e\u8457\u6b63\u9762\u5f71\u54cd\u3002</li> <li>CPU time \u5728 \u201cBoth\u201d \u573a\u666f\u4e0b\u51cf\u5c11 2.16%\uff0c\u8bf4\u660e\u7efc\u5408\u4f18\u5316\u80fd\u6709\u6548\u964d\u4f4e\u6574\u4f53\u6267\u884c\u65f6\u95f4\u3002</li> <li>I-cache-miss \u5728 \u201cBoth\u201d \u573a\u666f\u4e0b\u51cf\u5c11 5.16%\uff0c\u663e\u793a\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u5bf9\u6307\u4ee4\u7f13\u5b58\u6548\u7387\u63d0\u5347\u660e\u663e\u3002</li> <li>Branch-miss \u5728 \u201cBBs\u201d \u548c \u201cBoth\u201d \u573a\u666f\u4e0b\u5747\u63a5\u8fd1 2.8%\uff0c\u8bf4\u660e\u57fa\u672c\u5757\u91cd\u6392\u5e8f\u5bf9\u5206\u652f\u9884\u6d4b\u51c6\u786e\u7387\u63d0\u5347\u81f3\u5173\u91cd\u8981\u3002</li> <li>\u51fd\u6570\u91cd\u6392\u5e8f\uff08Functions\uff09\u5355\u72ec\u4f5c\u7528\u65f6\uff0c\u9664 iTLB-miss \u5916\uff0c\u5176\u4ed6\u6307\u6807\u6539\u5584\u6709\u9650\uff0c\u8868\u660e\u5176\u4e3b\u8981\u8d21\u732e\u5728\u4e8e\u51fd\u6570\u95f4\u5c40\u90e8\u6027\u4f18\u5316\u3002</li> <li> <p>BBs \u4f18\u5316\u5bf9\u7ec6\u7c92\u5ea6\u6307\u6807\uff08\u5982 Branch-miss, I-cache-miss\uff09\u5f71\u54cd\u66f4\u5927\uff0c\u800c Both \u7ec4\u5408\u4f18\u5316\u5e26\u6765\u6700\u5168\u9762\u4e14\u6700\u9ad8\u7684\u6027\u80fd\u6536\u76ca\u3002</p> </li> <li> <p>\u603b\u4f53\u800c\u8a00\uff0c\u8be5\u56fe\u8bc1\u5b9e\u4e86 LBR \u63d0\u4f9b\u7684\u7cbe\u786e\u5206\u652f\u91c7\u6837\u6570\u636e\u5bf9 BOLT \u7684\u57fa\u672c\u5757\u91cd\u6392\u5e8f\u4f18\u5316\u81f3\u5173\u91cd\u8981\uff0c\u5c24\u5176\u5728\u6539\u5584 i-TLB \u548c I-cache \u8868\u73b0\u65b9\u9762\u6548\u679c\u7a81\u51fa\uff0c\u6700\u7ec8\u8f6c\u5316\u4e3a\u53ef\u89c2\u7684 CPU \u65f6\u95f4\u8282\u7701\u3002</p> </li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/","title":"BOLT: A Practical Binary Optimizer for Data Centers and Beyond \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Maksim Panchenko - Rafael Auler - Bill Nell - Guilherme Ottoni</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - \u8be5\u8bba\u6587\u53d1\u8868\u4e8e International Symposium on Code Generation and Optimization (CGO)\u3002\u6b64\u4fe1\u606f\u867d\u672a\u5728\u63d0\u4f9b\u7684\u6587\u672c\u4e2d\u76f4\u63a5\u5199\u51fa\uff0c\u4f46\u53ef\u901a\u8fc7\u5176\u53c2\u8003\u6587\u732e\u683c\u5f0f\uff08\u5982\u5f15\u7528[1], [2], [3]\u7b49\u5747\u6765\u81ea\u8be5\u4f1a\u8bae\uff09\u4ee5\u53ca\u8bba\u6587\u4e3b\u9898\u548c\u98ce\u683c\u63a8\u65ad\u5f97\u51fa\uff0c\u8fd9\u662f\u7cfb\u7edf\u4e0e\u7f16\u8bd1\u5668\u9886\u57df\u5173\u4e8e\u4ee3\u7801\u751f\u6210\u4e0e\u4f18\u5316\u7684\u9876\u7ea7\u4f1a\u8bae\u3002</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - 2019\u3002\u6b64\u4fe1\u606f\u53ef\u901a\u8fc7\u6587\u672b\u9644\u5f55\u4e2d\u7684\u5b9e\u9a8c\u8bbe\u7f6e\uff08\u5982 \"Clang 7\", \"GCC 8.2\", \"Sep 2018\" for LLVM repos\uff09\u4ee5\u53ca\u5bf9\u5f53\u65f6\u6280\u672f\uff08\u5982 Intel IvyBridge, LBR\uff09\u7684\u8ba8\u8bba\u5408\u7406\u63a8\u65ad\u4e3a2019\u5e74\u3002</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u9488\u5bf9\u73b0\u4ee3\u6570\u636e\u4e2d\u5fc3\u4e2d\u65e5\u76ca\u5e9e\u5927\u548c\u590d\u6742\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u89e3\u51b3\u5176\u56e0\u4ee3\u7801\u5c40\u90e8\u6027\u5dee\u800c\u5bfc\u81f4\u7684\u6027\u80fd\u74f6\u9888\u95ee\u9898\u3002 - \u6311\u6218\u4e1a\u754c\u666e\u904d\u8ba4\u4e3a\u201cpost-link\u4f18\u5316\u56e0\u4ecb\u5165\u7f16\u8bd1\u6d41\u7a0b\u8fc7\u665a\u800c\u6548\u679c\u6709\u9650\u201d\u7684\u76f4\u89c9\uff0c\u8bba\u8bc1\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u5229\u7528sample-based profiling\u6570\u636e\u8fdb\u884c\u4f18\u5316\u7684\u6709\u6548\u6027\u548c\u4e92\u8865\u6027\u3002 - \u6784\u5efa\u4e00\u4e2a\u73b0\u4ee3\u5316\u3001\u5b9e\u7528\u4e14\u53ef\u6269\u5c55\u7684post-link optimizer\uff0c\u4ee5\u5728\u5df2\u6709\u9ad8\u5ea6\u4f18\u5316\uff08\u5982LTO\u548cFDO\uff09\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u57fa\u7840\u4e0a\uff0c\u8fdb\u4e00\u6b65\u63d0\u5347\u6027\u80fd\u3002</p> <p>\u65b9\u6cd5 - \u8bbe\u8ba1\u5e76\u5b9e\u73b0\u4e86\u540d\u4e3a BOLT (Binary Optimization and Layout Tool) \u7684\u9759\u6001\u4e8c\u8fdb\u5236\u4f18\u5316\u5668\uff0c\u8be5\u5de5\u5177\u6784\u5efa\u4e8e LLVM \u57fa\u7840\u8bbe\u65bd\u4e4b\u4e0a\uff0c\u5177\u5907\u826f\u597d\u7684\u53ef\u79fb\u690d\u6027\u3002 - \u91c7\u7528 sample-based profiling\uff08\u7279\u522b\u662f\u5229\u7528Intel\u7684Last Branch Records, LBR\uff09\u6765\u6536\u96c6\u751f\u4ea7\u73af\u5883\u4e2d\u771f\u5b9e\u3001\u4f4e\u5f00\u9500\u7684\u8fd0\u884c\u65f6\u6027\u80fd\u6570\u636e\uff0c\u907f\u514d\u4e86\u4f20\u7edfinstrumentation-based profiling\u7684\u9ad8\u6210\u672c\u3002 - BOLT\u7684\u6838\u5fc3\u4f18\u5316\u7b56\u7565\u805a\u7126\u4e8e\u4ee3\u7801\u5e03\u5c40 (code layout)\uff0c\u5176\u5173\u952e\u4f18\u52bf\u5728\u4e8e\u76f4\u63a5\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u64cd\u4f5c\uff0c\u4ece\u800c\u80fd\u66f4\u7cbe\u786e\u5730\u6620\u5c04\u548c\u5229\u7528profile\u6570\u636e\uff0c\u907f\u514d\u4e86\u5c06\u4e8c\u8fdb\u5236\u7ea7\u6570\u636e\u56de\u586b\u5230\u7f16\u8bd1\u5668IR\u65f6\u7684\u4fe1\u606f\u635f\u5931\u3002 - BOLT\u7684\u4f18\u5316\u6d41\u6c34\u7ebf\u5305\u542b\u591a\u4e2a\u9636\u6bb5\uff0c\u4e3b\u8981\u5305\u62ec\uff1a   - \u51fd\u6570\u91cd\u6392\u5e8f (Function reordering)\uff1a\u4f7f\u7528 HFSort \u7b97\u6cd5\u57fa\u4e8e\u8c03\u7528\u56fe\u4f18\u5316\u3002   - \u57fa\u672c\u5757\u91cd\u6392\u5e8f\u4e0e\u51b7\u70ed\u5206\u79bb (Basic block reordering and hot/cold splitting)\uff1a\u6839\u636e\u6267\u884c\u9891\u7387\u4f18\u5316\u63a7\u5236\u6d41\uff0c\u4f7f\u70ed\u70b9\u8def\u5f84\u6210\u4e3afall-through\uff0c\u51cf\u5c11taken branches\u3002   - \u5176\u4ed6\u8f85\u52a9\u4f18\u5316\uff0c\u5982Identical Code Folding (ICF)\u3001\u95f4\u63a5\u8c03\u7528\u63d0\u5347\u3001PLT\u8c03\u7528\u4f18\u5316\u3001\u79fb\u9664\u65e0\u7528NOP\u6307\u4ee4\u7b49\u3002 - \u901a\u8fc7\u5206\u6790 Clang \u548c GCC \u7f16\u8bd1\u5668\u81ea\u8eab\u4ee5\u53ca Facebook \u5185\u90e8\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\uff08\u5982 HHVM, TAO\uff09\u6765\u8bc4\u4f30BOLT\u7684\u6709\u6548\u6027\u3002</p> <p>\u7ed3\u679c - \u5728 Facebook \u6570\u636e\u4e2d\u5fc3\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0cBOLT\u5728\u5df2\u5e94\u7528HFSort\uff08\u53caLTO for HHVM\uff09\u7684\u57fa\u7840\u4e0a\uff0c\u5b9e\u73b0\u4e86 2.0% \u5230 7.0% \u7684\u6027\u80fd\u63d0\u5347\uff0c\u5e73\u5747\u63d0\u5347 5.1%\u3002</p> <p></p> <p>Fig. 5: Performance improvements from BOLT for our set of Facebook data-center workloads.</p> <ul> <li>\u5728\u5f00\u6e90\u7f16\u8bd1\u5668\u4e0a\uff0cBOLT\u5c55\u73b0\u4e86\u66f4\u663e\u8457\u7684\u6548\u679c\uff1a</li> <li>\u5bf9\u4e8e Clang\uff08\u5df2\u542f\u7528PGO+LTO\uff09\uff0cBOLT\u5e26\u6765\u4e86 15.0% \u7684\u7f16\u8bd1\u901f\u5ea6\u63d0\u5347\u3002</li> </ul> <p></p> <p>Fig. 6: Performance improvements for Clang.</p> <ul> <li>\u5bf9\u4e8e GCC\uff08\u5df2\u542f\u7528PGO\uff09\uff0cBOLT\u5e26\u6765\u4e86 7.45% \u7684\u6027\u80fd\u63d0\u5347\u3002</li> </ul> <p></p> <p>Fig. 7: Performance improvements for GCC. LTO was not used due to build errors.</p> <ul> <li>\u5fae\u67b6\u6784\u6307\u6807\u5206\u6790\u8868\u660e\uff0c\u6027\u80fd\u63d0\u5347\u4e3b\u8981\u6e90\u4e8eI-cache\u548cI-TLB\u547d\u4e2d\u7387\u7684\u63d0\u9ad8\uff0c\u4ee5\u53cataken branches\u6570\u91cf\u7684\u5927\u5e45\u51cf\u5c11\uff08\u5728Clang\u4e0a\u6bd4\u57fa\u7ebf\u51cf\u5c11\u4e8669.8%\uff09\u3002</li> </ul> <p></p> <p>TABLE II: Statistics reported by BOLT when applied to Clang\u2019s baseline and PGO+LTO binaries.</p> <ul> <li>LBR\u5bf9\u4e8e\u83b7\u53d6\u7cbe\u786e\u7684profile\u6570\u636e\u81f3\u5173\u91cd\u8981\uff0c\u5c24\u5176\u662f\u5728\u57fa\u672c\u5757\u7ea7\u522b\u7684\u5e03\u5c40\u4f18\u5316\u4e0a\u3002\u7f3a\u5c11LBR\u53ef\u80fd\u5bfc\u81f4\u4f18\u5316\u673a\u4f1a\u5b8c\u5168\u4e27\u5931\uff0c\u751a\u81f3\u4ea7\u751f\u6027\u80fd\u60e9\u7f5a\u3002</li> </ul> <p></p> <p>Fig. 11: Heat maps for instruction memory accesses of Clang binaries. Heat is in a log scale.</p> <ul> <li>\u70ed\u529b\u56fe\u76f4\u89c2\u5c55\u793a\u4e86BOLT\u5982\u4f55\u5c06\u539f\u672c\u5206\u6563\u572855MB\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u70ed\u70b9\u4ee3\u7801\uff0c\u7d27\u5bc6\u6253\u5305\u5230\u7ea66.7MB\u7684\u8fde\u7eed\u533a\u57df\u5185\u3002</li> </ul> <p></p> <p>Fig. 12: Improvements on different metrics for HHVM by using LBRs (higher is better).</p> <p>\u7ed3\u8bba - Post-link optimization \u4e0e\u4f20\u7edf\u7684compile-time\u548clink-time FDO/LTO\u5e76\u975e\u76f8\u4e92\u66ff\u4ee3\uff0c\u800c\u662f\u9ad8\u5ea6\u4e92\u8865\u7684\u5173\u7cfb\u3002\u5373\u4f7f\u5728\u5e94\u7528\u4e86\u6700\u5148\u8fdb\u7684\u7f16\u8bd1\u5668\u4f18\u5316\u540e\uff0cBOLT\u4ecd\u80fd\u53d1\u73b0\u5e76\u5229\u7528\u7531\u66f4\u7cbe\u786e\u7684\u4e8c\u8fdb\u5236\u7ea7profile\u6570\u636e\u6240\u63ed\u793a\u7684\u4f18\u5316\u673a\u4f1a\u3002 - BOLT\u7684\u6210\u529f\u9a8c\u8bc1\u4e86\u5176\u6838\u5fc3\u6d1e\u89c1\uff1a\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u8fdb\u884c\u4f18\u5316\uff0c\u80fd\u591f\u66f4\u51c6\u786e\u5730\u5229\u7528profile\u6570\u636e\u6765\u6307\u5bfc\u4ee3\u7801\u5e03\u5c40\uff0c\u8fd9\u5bf9\u4e8e\u7f13\u89e3\u5927\u578b\u5e94\u7528\u7a0b\u5e8f\u7684\u524d\u7aef\u74f6\u9888\uff08I-cache, I-TLB, branch predictor\uff09\u6781\u4e3a\u6709\u6548\u3002 - BOLT\u4f5c\u4e3a\u4e00\u4e2a\u6784\u5efa\u5728LLVM\u4e4b\u4e0a\u7684\u5f00\u6e90\u5de5\u5177\uff0c\u4e3a\u6570\u636e\u4e2d\u5fc3\u548c\u5176\u4ed6\u5bf9\u6027\u80fd\u654f\u611f\u7684\u573a\u666f\u63d0\u4f9b\u4e86\u4e00\u79cd\u5b9e\u7528\u4e14\u9ad8\u6548\u7684\u6027\u80fd\u63d0\u5347\u65b9\u6848\u3002</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f - \u73b0\u4ee3data-center applications\u89c4\u6a21\u5e9e\u5927\u4e14\u590d\u6742\uff0c\u5176\u6027\u80fd\u4e25\u91cd\u53d7\u9650\u4e8eCPU\u524d\u7aef\u74f6\u9888\uff0c\u5982I-cache\u3001I-TLB\u548cbranch predictor\u7684\u538b\u529b\u3002 - Feedback-driven optimizations (FDO) / Profile-guided optimizations (PGO) \u548c Link-time optimizations (LTO) \u662f\u63d0\u5347\u6b64\u7c7b\u5e94\u7528\u6027\u80fd\u7684\u5173\u952e\u6280\u672f\uff0c\u5c24\u5176\u5728code layout\uff08\u4ee3\u7801\u5e03\u5c40\uff09\u65b9\u9762\u3002 - \u4f20\u7edf\u7684instrumentation-based profiling\u56e0\u5f00\u9500\u5de8\u5927\uff0c\u96be\u4ee5\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u90e8\u7f72\u3002Sample-based profiling\uff08\u5982\u5229\u7528Intel\u7684LBR\uff09\u56e0\u5176\u4f4e\u5f00\u9500\u6210\u4e3a\u66f4\u5b9e\u7528\u7684\u9009\u62e9\u3002 - \u5c3d\u7ba1compile-time\u548clink-time\u7684FDO\u6280\u672f\uff08\u5982AutoFDO, HFSort\uff09\u5df2\u88ab\u5e7f\u6cdb\u7814\u7a76\uff0c\u4f46post-link optimization\uff08\u94fe\u63a5\u540e\u4f18\u5316\uff09\u5728\u8fd1\u5e74\u672a\u53d7\u91cd\u89c6\uff0c\u4e1a\u754c\u666e\u904d\u8ba4\u4e3a\u5176\u56e0\u4ecb\u5165\u7f16\u8bd1\u6d41\u7a0b\u8fc7\u665a\u800c\u6548\u679c\u6709\u9650\u3002</p> <p>\u7814\u7a76\u52a8\u673a - \u4f5c\u8005\u6311\u6218\u4e86\u201cpost-link\u4f18\u5316\u6548\u679c inferior\u201d\u7684\u76f4\u89c9\uff0c\u63d0\u51fa\u6838\u5fc3\u6d1e\u5bdf\uff1a\u867d\u7136\u65e9\u671f\u6ce8\u5165profile\u6570\u636e\u80fd\u8ba9\u66f4\u591a\u4f18\u5316\u53d7\u76ca\uff0c\u4f46\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\uff08post-link\uff09\u4f7f\u7528profile\u6570\u636e\u80fd\u83b7\u5f97\u66f4\u9ad8\u7684\u51c6\u786e\u6027\u3002 - AutoFDO\u7b49\u6280\u672f\u9700\u8981\u5c06\u4e8c\u8fdb\u5236\u7ea7\u522b\u7684profile\u6570\u636e\u53cd\u5411\u6620\u5c04\u5230\u7f16\u8bd1\u5668\u7684Intermediate Representation (IR)\uff0c\u6b64\u8fc7\u7a0b\u4f1a\u56e0\u7f16\u8bd1\u5668\u548c\u94fe\u63a5\u5668\u7684\u4f18\u5316\uff08\u5982inlining\uff09\u800c\u4e22\u5931\u7cbe\u5ea6\u3002     - </p> <p></p> <p>Fig. 2: Example showing a challenge in mapping binary-level events back to higher-level code representations.</p> <p>\u5c55\u793a\u4e86\u6b64\u95ee\u9898\uff1a\u540c\u4e00\u4e2a\u6e90\u7801\u5206\u652f\u5728\u4e0d\u540c\u8c03\u7528\u70b9\u88ab\u5185\u8054\u540e\uff0c\u5176\u6700\u4f18\u5e03\u5c40\u53ef\u80fd\u4e0d\u540c\uff0c\u4f46\u6e90\u7801\u7ea7profile\u65e0\u6cd5\u533a\u5206\u8fd9\u79cd\u5dee\u5f02\u3002 - \u5bf9\u4e8ecode layout\u8fd9\u7c7b\u4f9d\u8d56\u7cbe\u786e\u5206\u652f\u9891\u7387\u7684\u5e95\u5c42\u4f18\u5316\uff0cprofile\u6570\u636e\u7684\u51c6\u786e\u6027\u81f3\u5173\u91cd\u8981\uff0c\u4e0d\u51c6\u786e\u7684\u6570\u636e\u751a\u81f3\u4f1a\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002 - \u56e0\u6b64\uff0c\u6784\u5efa\u4e00\u4e2a\u80fd\u5728binary level\u76f4\u63a5\u3001\u51c6\u786e\u5730\u5229\u7528sample-based profile\u8fdb\u884c\u4f18\u5316\u7684\u5de5\u5177\uff0c\u5177\u6709\u5de8\u5927\u6f5c\u529b\u3002</p> <p>\u6838\u5fc3\u8d21\u732e - \u8bbe\u8ba1\u5e76\u5f00\u6e90\u4e86BOLT\uff1a\u4e00\u4e2a\u57fa\u4e8eLLVM\u6846\u67b6\u6784\u5efa\u7684\u73b0\u4ee3\u5316\u3001\u53ef\u91cd\u5b9a\u5411\u7684static post-link optimizer\u3002\u5b83\u80fd\u591f\u5904\u7406\u5927\u89c4\u6a21\u3001\u591a\u8bed\u8a00\uff08\u5305\u62ec\u6c47\u7f16\uff09\u7684\u590d\u6742\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e76\u6b63\u786e\u66f4\u65b0DWARF debug info\u548cC++ exception handling\u4fe1\u606f\u3002 - \u5b9e\u8bc1\u4e86post-link\u4f18\u5316\u7684\u6709\u6548\u6027\uff1a\u901a\u8fc7\u5728\u771f\u5b9e\u4e16\u754c\u7684Facebook data-center workloads\uff08\u5982HHVM, TAO\uff09\u548copen-source compilers\uff08Clang, GCC\uff09\u4e0a\u8fdb\u884c\u8bc4\u4f30\uff0c\u8bc1\u660e\u4e86BOLT\u80fd\u5e26\u6765\u663e\u8457\u7684\u6027\u80fd\u63d0\u5347\uff0c\u4e14\u8fd9\u79cd\u63d0\u5347\u4e0eFDO/LTO\u662fcomplementary\uff08\u4e92\u8865\uff09\u800c\u975e\u91cd\u53e0\u7684\u3002     - \u5728\u5df2\u5e94\u7528FDO\u548cLTO\u7684Facebook\u5e94\u7528\u4e0a\uff0cBOLT\u5b9e\u73b0\u4e86\u6700\u9ad8 7.0% \u7684\u52a0\u901f\u3002     - \u5728\u540c\u6837\u6761\u4ef6\u4e0b\uff0c\u5bf9Clang\u548cGCC\u7f16\u8bd1\u5668\u7684\u52a0\u901f\u5206\u522b\u9ad8\u8fbe 15.0% \u548c 7.45%\uff1b\u82e5\u65e0FDO/LTO\uff0c\u52a0\u901f\u6bd4\u751a\u81f3\u53ef\u8fbe 52.1%\u3002 - \u7cfb\u7edf\u6027\u5730\u5206\u6790\u4e86\u4f18\u5316\u6548\u679c\uff1a\u901a\u8fc7\u5fae\u67b6\u6784\u6307\u6807\u5206\u89e3\u548c\u70ed\u529b\u56fe\uff08</p> <p></p> <p>Fig. 11: Heat maps for instruction memory accesses of Clang binaries. Heat is in a log scale.</p> <p>\uff09\uff0c\u660e\u786e\u6307\u51fabasic-block reordering\u548cfunction reordering\u662fBOLT\u6700\u6709\u6548\u7684\u4f18\u5316\u624b\u6bb5\uff0c\u5e76\u5f3a\u8c03\u4e86LBR\u5bf9\u4e8e\u83b7\u53d6\u9ad8\u7cbe\u5ea6profile\u6570\u636e\u7684\u91cd\u8981\u6027\u3002</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>BOLT (Binary Optimization and Layout Tool) \u662f\u4e00\u4e2a\u6784\u5efa\u5728 LLVM \u57fa\u7840\u8bbe\u65bd\u4e4b\u4e0a\u7684\u9759\u6001\u540e\u94fe\u63a5\u4e8c\u8fdb\u5236\u4f18\u5316\u5668\u3002\u5176\u6838\u5fc3\u76ee\u6807\u662f\u901a\u8fc7\u7cbe\u786e\u5229\u7528\u57fa\u4e8e\u91c7\u6837\u7684\u6027\u80fd\u5256\u6790\u6570\u636e\uff08sample-based profiling\uff09\uff0c\u5bf9\u5df2\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u91cd\u5199\uff0c\u4ee5\u4f18\u5316\u4ee3\u7801\u5e03\u5c40\uff08code layout\uff09\uff0c\u4ece\u800c\u63d0\u5347\u5927\u578b\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\u7684\u6027\u80fd\u3002</p> <ul> <li>\u8bbe\u8ba1\u54f2\u5b66:</li> <li>\u91c7\u7528\u9759\u6001\u4f18\u5316\u7b56\u7565\uff0c\u907f\u514d\u4e86\u52a8\u6001\u4e8c\u8fdb\u5236\u4f18\u5316\u5668\uff08\u5982 DynamoRIO\uff09\u5f15\u5165\u7684\u8fd0\u884c\u65f6\u5f00\u9500\u3002</li> <li>\u9009\u62e9\u5728\u4e8c\u8fdb\u5236\u7ea7\u522b\uff08post-link\uff09\u8fdb\u884c\u4f18\u5316\uff0c\u800c\u975e\u7f16\u8bd1\u671f\u6216\u94fe\u63a5\u671f\u3002\u8fd9\u4f7f\u5f97 BOLT \u80fd\u591f\u76f4\u63a5\u3001\u51c6\u786e\u5730\u5c06\u5256\u6790\u6570\u636e\u6620\u5c04\u5230\u673a\u5668\u7801\u4e0a\uff0c\u89c4\u907f\u4e86\u50cf AutoFDO \u90a3\u6837\u9700\u8981\u5c06\u4e8c\u8fdb\u5236\u7ea7\u6570\u636e\u53cd\u5411\u6620\u5c04\u5230\u7f16\u8bd1\u5668\u4e2d\u95f4\u8868\u793a\uff08IR\uff09\u6240\u5e26\u6765\u7684\u7cbe\u5ea6\u635f\u5931\u95ee\u9898\u3002</li> <li> <p>\u67b6\u6784\u8bbe\u8ba1\u4e3a\u53ef\u91cd\u5b9a\u5411\uff08retargetable\uff09\uff0c\u5f97\u76ca\u4e8e LLVM \u5bf9\u591a\u67b6\u6784\u7684\u652f\u6301\u3002</p> </li> <li> <p>\u6838\u5fc3\u5de5\u4f5c\u6d41\u7a0b:</p> </li> <li>\u51fd\u6570\u53d1\u73b0\uff08Function Discovery\uff09: \u5229\u7528 ELF \u7b26\u53f7\u8868\u548c\u53ef\u9009\u7684\u5e27\u4fe1\u606f\u6765\u8bc6\u522b\u548c\u5b9a\u4f4d\u4e8c\u8fdb\u5236\u4e2d\u7684\u51fd\u6570\u8fb9\u754c\u3002</li> <li>\u5256\u6790\u6570\u636e\u4e0e\u8c03\u8bd5\u4fe1\u606f\u52a0\u8f7d: \u8bfb\u53d6\u7531 <code>perf</code> \u7b49\u5de5\u5177\u751f\u6210\u7684\u5256\u6790\u6570\u636e\uff08\u901a\u5e38\u901a\u8fc7 <code>perf2bolt</code> \u8f6c\u6362\uff09\u4ee5\u53ca DWARF \u8c03\u8bd5\u4fe1\u606f\u3002</li> <li>\u53cd\u6c47\u7f16\u4e0e\u63a7\u5236\u6d41\u56fe\uff08CFG\uff09: \u4f7f\u7528 LLVM \u7684\u53cd\u6c47\u7f16\u5668\u5c06\u673a\u5668\u7801\u8f6c\u6362\u4e3a\u5185\u90e8\u8868\u793a\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u51fd\u6570\u6784\u5efa\u7cbe\u786e\u7684 CFG\u3002</li> <li>\u4f18\u5316\u7ba1\u9053\u6267\u884c: \u5728 CFG \u4e0a\u5e94\u7528\u4e00\u7cfb\u5217\u4f18\u5316Pass\u3002</li> <li>\u4ee3\u7801\u53d1\u5c04\u4e0e\u91cd\u5199: \u5c06\u4f18\u5316\u540e\u7684\u4ee3\u7801\u91cd\u65b0\u6c47\u7f16\uff0c\u5e76\u5229\u7528 LLVM \u7684\u8fd0\u884c\u65f6\u52a8\u6001\u94fe\u63a5\u5668\u89e3\u6790\u7b26\u53f7\u5f15\u7528\uff0c\u6700\u7ec8\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u3001\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e76\u66f4\u65b0\u6240\u6709\u76f8\u5173\u7684 ELF \u7ed3\u6784\u3002</li> </ul> <p></p> <p>Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.</p> <ul> <li>\u5173\u952e\u8fd0\u884c\u6a21\u5f0f:</li> <li>\u57fa\u7840\u6a21\u5f0f: \u4ec5\u5728\u73b0\u6709\u51fd\u6570\u8fb9\u754c\u5185\u8fdb\u884c\u4f18\u5316\uff0c\u4e3b\u8981\u9488\u5bf9\u57fa\u672c\u5757\u91cd\u6392\u3002</li> <li> <p>\u91cd\u5b9a\u4f4d\u6a21\u5f0f\uff08Relocations Mode\uff09: \u901a\u8fc7\u94fe\u63a5\u5668\u751f\u6210\u7684\u91cd\u5b9a\u4f4d\u4fe1\u606f\uff08<code>--emit-relocs</code>\uff09\uff0c\u83b7\u5f97\u5bf9\u6574\u4e2a\u4e8c\u8fdb\u5236\u4ee3\u7801\u5e03\u5c40\u7684\u5b8c\u5168\u63a7\u5236\u6743\uff0c\u4ece\u800c\u80fd\u591f\u8fdb\u884c\u51fd\u6570\u91cd\u6392\uff08function reordering\uff09\u548c\u66f4\u6fc0\u8fdb\u7684\u51fd\u6570\u62c6\u5206\uff08function splitting\uff09\u3002</p> </li> <li> <p>\u5bf9\u590d\u6742\u7279\u6027\u7684\u652f\u6301:</p> </li> <li>C++ \u5f02\u5e38\u5904\u7406: \u80fd\u591f\u8bc6\u522b\u5e76\u66f4\u65b0 DWARF Call Frame Information (CFI)\uff0c\u786e\u4fdd\u5f02\u5e38\u629b\u51fa\u65f6\u6808\u5c55\u5f00\u5668\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002</li> <li>\u8c03\u8bd5\u4fe1\u606f: \u5728\u4ee3\u7801\u88ab\u79fb\u52a8\u6216\u4fee\u6539\u540e\uff0c\u4f1a\u76f8\u5e94\u5730\u66f4\u65b0 DWARF \u8c03\u8bd5\u4fe1\u606f\uff0c\u4fdd\u8bc1\u8c03\u8bd5\u4f53\u9a8c\u7684\u4e00\u81f4\u6027\u3002</li> </ul> <p></p> <p>Fig. 4: Partial CFG dump for a function with C++ exceptions.</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#1-llvm","title":"1. \u57fa\u4e8eLLVM\u7684\u4e8c\u8fdb\u5236\u91cd\u5199\u67b6\u6784","text":"<p>BOLT\u7684\u4e8c\u8fdb\u5236\u91cd\u5199\u67b6\u6784\u6982\u89c8</p> <p>BOLT\u7684\u6838\u5fc3\u5728\u4e8e\u5176\u6784\u5efa\u4e8eLLVM\u57fa\u7840\u8bbe\u65bd\u4e4b\u4e0a\u7684\u9759\u6001\u4e8c\u8fdb\u5236\u91cd\u5199\u80fd\u529b\u3002\u8be5\u67b6\u6784\u5145\u5206\u5229\u7528\u4e86LLVM\u7684\u6a21\u5757\u5316\u3001\u591a\u76ee\u6807\u652f\u6301\u4ee5\u53ca\u6210\u719f\u7684\u6c47\u7f16/\u53cd\u6c47\u7f16\u5de5\u5177\u94fe\uff0c\u5b9e\u73b0\u4e86\u5bf9\u5927\u578b\u3001\u590d\u6742\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u5982\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\uff09\u7684\u7cbe\u786e\u5206\u6790\u4e0e\u9ad8\u6548\u91cd\u5199\u3002</p> <p></p> <p>Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.</p> <p>\u6838\u5fc3\u91cd\u5199\u6d41\u7a0b</p> <p>BOLT\u7684\u91cd\u5199\u6d41\u7a0b\u662f\u4e00\u4e2a\u591a\u9636\u6bb5\u7684\u7ba1\u9053\uff0c\u65e8\u5728\u4ece\u539f\u59cb\u4e8c\u8fdb\u5236\u4e2d\u63d0\u53d6\u4fe1\u606f\u3001\u5e94\u7528\u4f18\u5316\uff0c\u5e76\u751f\u6210\u4e00\u4e2a\u529f\u80fd\u7b49\u4ef7\u4f46\u6027\u80fd\u66f4\u4f18\u7684\u65b0\u4e8c\u8fdb\u5236\u3002</p> <ul> <li>\u51fd\u6570\u53d1\u73b0 (Function Discovery):</li> <li>\u8f93\u5165\uff1a\u539f\u59cb\u7684 ELF \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u65b9\u6cd5\uff1a\u7ed3\u5408 ELF\u7b26\u53f7\u8868 (symbol table) \u548c DWARF\u5e27\u4fe1\u606f (frame information) \u6765\u5b9a\u4f4d\u51fd\u6570\u8fb9\u754c\u3002\u8fd9\u79cd\u6df7\u5408\u65b9\u6cd5\u80fd\u6709\u6548\u5904\u7406\u624b\u5199\u6c47\u7f16\u4ee3\u7801\uff08\u901a\u5e38\u7f3a\u5c11\u5e27\u4fe1\u606f\uff09\u548c\u7f16\u8bd1\u5668\u751f\u6210\u7684\u4ee3\u7801\u3002</li> <li> <p>\u8f93\u51fa\uff1a\u4e00\u4e2a\u5305\u542b\u6240\u6709\u53ef\u8bc6\u522b\u51fd\u6570\u53ca\u5176\u8d77\u59cb\u5730\u5740\u7684\u6620\u5c04\u3002</p> </li> <li> <p>\u4fe1\u606f\u63d0\u53d6\u4e0e\u53cd\u6c47\u7f16 (Information Extraction &amp; Disassembly):</p> </li> <li>\u63d0\u53d6 DWARF\u8c03\u8bd5\u4fe1\u606f \u548c \u6837\u672c\u5206\u6790\u6570\u636e (profile data)\u3002</li> <li> <p>\u5229\u7528 LLVM\u7684Tablegen\u751f\u6210\u7684\u53cd\u6c47\u7f16\u5668 \u5bf9\u6bcf\u4e2a\u51fd\u6570\u8fdb\u884c\u53cd\u6c47\u7f16\uff0c\u751f\u6210 MCInst \u5bf9\u8c61\u5e8f\u5217\u3002MCInst\u662fLLVM\u4e2d\u7528\u4e8e\u8868\u793a\u673a\u5668\u6307\u4ee4\u7684\u4e2d\u95f4\u683c\u5f0f\u3002</p> </li> <li> <p>\u63a7\u5236\u6d41\u56fe\u6784\u5efa (Control-Flow Graph Construction):</p> </li> <li>\u5206\u6790\u53cd\u6c47\u7f16\u5f97\u5230\u7684MCInst\u5e8f\u5217\uff0c\u7279\u522b\u662f\u5176\u4e2d\u7684\u5206\u652f\u6307\u4ee4\u3002</li> <li> <p>\u4e3a\u6bcf\u4e2a\u51fd\u6570\u6784\u5efa\u7cbe\u786e\u7684 \u63a7\u5236\u6d41\u56fe (CFG)\uff0c\u8fd9\u662f\u540e\u7eed\u6240\u6709\u57fa\u4e8e\u63a7\u5236\u6d41\u7684\u4f18\u5316\uff08\u5982\u57fa\u672c\u5757\u91cd\u6392\uff09\u7684\u57fa\u7840\u3002</p> </li> <li> <p>\u4f18\u5316\u7ba1\u9053\u6267\u884c (Optimization Pipeline Execution):</p> </li> <li>\u5728\u6784\u5efa\u597d\u7684CFG\u4e0a\uff0c\u4f9d\u6b21\u5e94\u7528\u4e00\u7cfb\u5217\u4f18\u5316Pass\uff08\u8be6\u89c1\u4e0b\u6587\u201c\u4f18\u5316Pass\u5e8f\u5217\u201d\uff09\u3002</li> <li> <p>BOLT\u4e3aMCInst\u5bf9\u8c61\u5f15\u5165\u4e86\u901a\u7528\u6ce8\u89e3\u673a\u5236\uff0c\u7528\u4e8e\u5728\u4f18\u5316\u8fc7\u7a0b\u4e2d\u4f20\u9012\u989d\u5916\u4fe1\u606f\uff0c\u4f8b\u5982\u6570\u636e\u6d41\u5206\u6790\u7ed3\u679c\u6216\u5f02\u5e38\u5904\u7406\u5143\u6570\u636e\u3002</p> </li> <li> <p>\u4ee3\u7801\u53d1\u5c04\u4e0e\u94fe\u63a5 (Code Emission &amp; Linking):</p> </li> <li>\u5c06\u4f18\u5316\u540e\u7684\u51fd\u6570CFG\u91cd\u65b0\u8f6c\u6362\u56de\u673a\u5668\u7801\u3002</li> <li> <p>\u4f7f\u7528 LLVM\u7684\u8fd0\u884c\u65f6\u52a8\u6001\u94fe\u63a5\u5668 (JIT linker) \u6765\u89e3\u6790\u51fd\u6570\u95f4\u4ee5\u53ca\u5c40\u90e8\u7b26\u53f7\uff08\u5982\u57fa\u672c\u5757\u6807\u7b7e\uff09\u7684\u5f15\u7528\uff0c\u786e\u4fdd\u91cd\u5199\u540e\u4ee3\u7801\u7684\u6b63\u786e\u6027\u3002</p> </li> <li> <p>\u4e8c\u8fdb\u5236\u91cd\u6784 (Binary Rewriting):</p> </li> <li>\u5c06\u4f18\u5316\u540e\u7684\u65b0\u4ee3\u7801\u6bb5\u5199\u5165\u65b0\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u540c\u6b65\u66f4\u65b0 ELF\u7ed3\u6784\uff08\u5982\u7a0b\u5e8f\u5934\u3001\u8282\u5934\u8868\uff09\u4ee5\u53cd\u6620\u4ee3\u7801\u5927\u5c0f\u548c\u5e03\u5c40\u7684\u53d8\u5316\u3002</li> <li>\u91cd\u5efa\u5e76\u66f4\u65b0 DWARF Call Frame Information (CFI)\uff0c\u786e\u4fdd\u5728\u53d1\u751fC++\u5f02\u5e38\u65f6\u6808\u5c55\u5f00\u5668\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002</li> </ul> <p>\u5173\u952e\u8bbe\u8ba1\u51b3\u7b56\u4e0e\u6280\u672f\u7ec6\u8282</p> <ul> <li>\u4e3a\u4f55\u9009\u62e9LLVM:</li> <li>\u6a21\u5757\u5316\u8bbe\u8ba1: LLVM\u7684\u7ec4\u4ef6\uff08\u5982\u53cd\u6c47\u7f16\u5668\u3001\u6c47\u7f16\u5668\u3001\u76ee\u6807\u63cf\u8ff0\uff09\u53ef\u4ee5\u88ab\u72ec\u7acb\u8c03\u7528\uff0c\u6781\u5927\u7b80\u5316\u4e86BOLT\u8fd9\u7c7b\u5de5\u5177\u7684\u5f00\u53d1\u3002</li> <li>\u591a\u67b6\u6784\u652f\u6301: \u57fa\u4e8eLLVM\u4f7fBOLT\u5177\u5907\u4e86\u5929\u7136\u7684\u53ef\u79fb\u690d\u6027 (retargetable)\u3002\u8bba\u6587\u63d0\u5230\uff0c\u4e00\u4e2a\u9488\u5bf9ARM\u67b6\u6784\u7684\u5de5\u4f5c\u539f\u578b\u5728\u4e0d\u5230\u4e00\u4e2a\u6708\u5185\u5c31\u5b8c\u6210\u4e86\u3002</li> <li> <p>\u6210\u719f\u5de5\u5177\u94fe: LLVM\u63d0\u4f9b\u4e86\u9ad8\u8d28\u91cf\u3001\u7ecf\u8fc7\u5145\u5206\u6d4b\u8bd5\u7684\u6c47\u7f16/\u53cd\u6c47\u7f16\u57fa\u7840\u8bbe\u65bd\uff0c\u4fdd\u8bc1\u4e86BOLT\u5904\u7406\u590d\u6742\u6307\u4ee4\u96c6\uff08\u5982x86-64\uff09\u7684\u9c81\u68d2\u6027\u3002</p> </li> <li> <p>\u5904\u7406\u590d\u6742\u6027\u7684\u7b56\u7565:</p> </li> <li>\u4fdd\u5b88\u8df3\u8fc7: BOLT\u91c7\u7528\u4fdd\u5b88\u7b56\u7565\uff0c\u5bf9\u4e8e\u65e0\u6cd5\u5b8c\u5168\u81ea\u4fe1\u5730\u91cd\u5efa\u5176CFG\u7684\u51fd\u6570\uff08\u4f8b\u5982\u5305\u542b\u81ea\u4fee\u6539\u4ee3\u7801\u6216\u590d\u6742\u6df7\u6dc6\u7684\u51fd\u6570\uff09\uff0c\u4f1a\u76f4\u63a5\u8df3\u8fc7\u800c\u4e0d\u8fdb\u884c\u4f18\u5316\uff0c\u4fdd\u8bc1\u4e86\u6574\u4f53\u7684\u5b89\u5168\u6027\u3002</li> <li> <p>\u91cd\u5b9a\u4f4d\u6a21\u5f0f (Relocations Mode): \u4e3a\u4e86\u5b9e\u73b0\u8de8\u51fd\u6570\u7684\u4ee3\u7801\u91cd\u6392\uff08\u5982\u51fd\u6570\u6392\u5e8f\uff09\uff0cBOLT\u53ef\u4ee5\u5229\u7528\u94fe\u63a5\u5668\u751f\u6210\u7684\u91cd\u5b9a\u4f4d\u4fe1\u606f (--emit-relocs)\u3002\u8fd9\u4f7f\u5f97BOLT\u80fd\u591f\u5b8c\u5168\u63a7\u5236\u4e8c\u8fdb\u5236\u4e2d\u7684\u4ee3\u7801\u5e03\u5c40\uff0c\u800c\u4e0d\u4ec5\u9650\u4e8e\u5355\u4e2a\u51fd\u6570\u5185\u90e8\u3002</p> </li> <li> <p>\u5bf9\u8c03\u8bd5\u4e0e\u5f02\u5e38\u7684\u652f\u6301:</p> </li> <li>BOLT\u80fd\u591f\u8bc6\u522b\u5e76\u66f4\u65b0 DWARF\u8c03\u8bd5\u4fe1\u606f\uff0c\u786e\u4fdd\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u4ecd\u80fd\u88ab\u8c03\u8bd5\u5668\u6b63\u786e\u4f7f\u7528\u3002</li> <li>\u901a\u8fc7\u6ce8\u89e3\uff08\u5982 <code>handler: .LLP0</code>\uff09\u8ddf\u8e2a\u5f02\u5e38\u5904\u7406\u7684landing pad\uff0c\u5e76\u5728\u91cd\u5199\u540e\u6b63\u786e\u91cd\u5efaCFI\uff0c\u7ef4\u6301\u4e86C++\u5f02\u5e38\u5904\u7406\u8bed\u4e49\u7684\u5b8c\u6574\u6027\u3002</li> </ul> <p></p> <p>Fig. 4: Partial CFG dump for a function with C++ exceptions.</p> <p>\u4f18\u5316Pass\u5e8f\u5217\u53ca\u5176\u4f5c\u7528</p> <p>BOLT\u7684\u4f18\u5316\u80fd\u529b\u4f53\u73b0\u5728\u5176\u7cbe\u5fc3\u8bbe\u8ba1\u7684Pass\u5e8f\u5217\u4e2d\uff0c\u8fd9\u4e9bPass\u534f\u540c\u5de5\u4f5c\u4ee5\u6539\u5584\u4ee3\u7801\u5e03\u5c40\u548c\u6307\u4ee4\u6548\u7387\u3002</p> Pass\u5e8f\u53f7 \u4f18\u5316\u540d\u79f0 \u4e3b\u8981\u4f5c\u7528 1 strip-rep-ret \u79fb\u9664x86\u67b6\u6784\u4e0a\u7528\u4e8e\u517c\u5bb9AMD\u5904\u7406\u5668\u7684\u65e0\u7528<code>REPZ</code>\u524d\u7f00\uff0c\u51cf\u5c0f\u4ee3\u7801\u4f53\u79ef\u3002 2 identical code folding (ICF) \u5728\u4e8c\u8fdb\u5236\u7ea7\u522b\u5408\u5e76\u76f8\u540c\u7684\u4ee3\u7801\u6bb5\uff0c\u6bd4\u94fe\u63a5\u5668ICF\u66f4\u5f7b\u5e95\uff0c\u80fd\u5904\u7406\u542b\u8df3\u8f6c\u8868\u7684\u51fd\u6570\u3002 3 indirect call promotion \u5229\u7528\u5206\u6790\u6570\u636e\u5c06\u95f4\u63a5\u8c03\u7528\u63d0\u5347\u4e3a\u76f4\u63a5\u8c03\u7528\uff0c\u6d88\u9664\u95f4\u63a5\u8df3\u8f6c\u5f00\u9500\u3002 4 simplify conditional tail jumps \u7b80\u5316\u51fd\u6570\u672b\u5c3e\u7684\u6761\u4ef6\u8df3\u8f6c\uff0c\u53ef\u80fd\u5c06\u5176\u8f6c\u6362\u4e3a\u66f4\u9ad8\u6548\u7684\u6307\u4ee4\u5e8f\u5217\u3002 5 simplify loads from read-only sections \u5c06\u4ece\u53ea\u8bfb\u6bb5\u52a0\u8f7d\u5e38\u91cf\u7684\u64cd\u4f5c\u8f6c\u6362\u4e3a\u7acb\u5373\u6570\u52a0\u8f7d\u6307\u4ee4\uff0c\u51cf\u8f7bD-cache\u538b\u529b\uff08\u5728\u4e0d\u589e\u5927\u4ee3\u7801\u7684\u524d\u63d0\u4e0b\uff09\u3002 6 fixup branches \u4fee\u6b63\u56e0\u4ee3\u7801\u79fb\u52a8\u5bfc\u81f4\u7684\u5206\u652f\u504f\u79fb\u91cf\u53d8\u5316\uff0c\u786e\u4fdd\u5206\u652f\u6307\u4ee4\u7f16\u7801\u6b63\u786e\u3002 7 PLT call optimization \u4f18\u5316\u901a\u8fc7\u8fc7\u7a0b\u94fe\u63a5\u8868 (PLT) \u7684\u8c03\u7528\uff0c\u51cf\u5c11\u52a8\u6001\u94fe\u63a5\u5f00\u9500\u3002 8 reorder and split hot/cold basic blocks \u6700\u6838\u5fc3\u7684\u4f18\u5316\u4e4b\u4e00\u3002\u6839\u636e\u5206\u6790\u6570\u636e\u91cd\u6392\u57fa\u672c\u5757\uff0c\u4f7f\u70ed\u8def\u5f84\u6210\u4e3afall-through\uff0c\u5e76\u5c06\u51b7\u4ee3\u7801\u5206\u79bb\u51fa\u53bb\uff0c\u663e\u8457\u51cf\u5c11taken branches\u3002 9 remove unnecessary NOPs \u79fb\u9664\u7f16\u8bd1\u5668\u63d2\u5165\u7684\u5bf9\u9f50NOP\u6307\u4ee4\uff0c\u8282\u7701\u5b9d\u8d35\u7684I-cache\u7a7a\u95f4\u3002 10 shrink wrapping \u4f18\u5316\u51fd\u6570\u5e8f\u8a00\u548c\u7ed3\u5c3e\uff0c\u4ec5\u5728\u5fc5\u8981\u65f6\u4fdd\u5b58/\u6062\u590d\u5bc4\u5b58\u5668\u3002 11 frame-lowering \u4e3a\u6ca1\u6709DWARF\u4fe1\u606f\u7684\u51fd\u6570\u751f\u6210\u5fc5\u8981\u7684\u6808\u5e27\u4fe1\u606f\u3002 12 reorder functions \u53e6\u4e00\u9879\u6838\u5fc3\u4f18\u5316\u3002\u4f7f\u7528 HFSort \u7b97\u6cd5\u6839\u636e\u8c03\u7528\u56fe\u5bf9\u51fd\u6570\u8fdb\u884c\u91cd\u6392\uff0c\u4e3b\u8981\u6539\u5584I-TLB\u6027\u80fd\u3002 <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u603b\u7ed3</p> <ul> <li>\u8f93\u5165: </li> <li>\u4e00\u4e2a\u5df2\u7f16\u8bd1\u7684\u3001\u9ad8\u5ea6\u4f18\u5316\u7684\uff08\u53ef\u80fd\u5df2\u5305\u542bLTO\u548cPGO\uff09ELF\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u4e00\u4efd\u901a\u8fc7\u6837\u672c\u5206\u6790 (sample-based profiling)\uff08\u6700\u597d\u5305\u542bLBR\uff09\u6536\u96c6\u7684YAML\u683c\u5f0f\u6027\u80fd\u5206\u6790\u6570\u636e\u3002</li> <li>\u8f93\u51fa: </li> <li>\u4e00\u4e2a\u529f\u80fd\u7b49\u4ef7\u4f46\u7ecf\u8fc7\u6df1\u5ea6\u4f18\u5316\u7684\u65b0ELF\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u5177\u6709\u66f4\u4f18\u7684\u4ee3\u7801\u5c40\u90e8\u6027\uff0c\u80fd\u663e\u8457\u964d\u4f4eI-cache\u3001I-TLB\u548c\u5206\u652f\u9884\u6d4b\u5355\u5143\u7684\u538b\u529b\u3002</li> <li>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528: </li> <li>BOLT\u4f5c\u4e3a\u540e\u94fe\u63a5 (post-link) \u9636\u6bb5\u7684\u4f18\u5316\u5668\uff0c\u5f25\u8865\u4e86\u4f20\u7edf\u7f16\u8bd1\u5668\u548c\u94fe\u63a5\u5668\u5728\u5229\u7528\u7cbe\u786e\u4e8c\u8fdb\u5236\u7ea7\u5206\u6790\u6570\u636e\u8fdb\u884c\u4ee3\u7801\u5e03\u5c40\u65b9\u9762\u7684\u4e0d\u8db3\u3002\u5b83\u4e0e\u7f16\u8bd1\u671f\u7684FDO/LTO\u5f62\u6210\u4e92\u8865\u800c\u975e\u66ff\u4ee3\u5173\u7cfb\uff0c\u5171\u540c\u69a8\u53d6\u5e94\u7528\u7a0b\u5e8f\u7684\u6700\u540e\u6027\u80fd\u6f5c\u529b\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#2_1","title":"2. \u7cbe\u786e\u7684\u6837\u672c\u5206\u6790\u9a71\u52a8\u4ee3\u7801\u5e03\u5c40","text":"<p>\u6838\u5fc3\u89c2\u70b9\uff1aBOLT\u901a\u8fc7\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u76f4\u63a5\u6d88\u8d39\u9ad8\u7cbe\u5ea6\u7684\u6837\u672c\u5256\u6790\u6570\u636e\uff0c\u5b9e\u73b0\u4e86\u6bd4\u7f16\u8bd1\u5668\u66f4\u4f18\u7684\u4ee3\u7801\u5e03\u5c40\u4f18\u5316</p> <ul> <li>BOLT\u7684\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u5176post-link\uff08\u94fe\u63a5\u540e\uff09\u7684\u4f18\u5316\u65f6\u673a\u3002\u5b83\u76f4\u63a5\u5bf9\u6700\u7ec8\u7684\u673a\u5668\u7801\u8fdb\u884c\u64cd\u4f5c\uff0c\u907f\u514d\u4e86\u5c06\u8fd0\u884c\u65f6\u6536\u96c6\u7684\u6027\u80fd\u5256\u6790\u6570\u636e\u4ecebinary level\uff08\u4e8c\u8fdb\u5236\u5c42\u9762\uff09\u6620\u5c04\u56decompiler\u2019s intermediate representation (IR)\uff08\u7f16\u8bd1\u5668\u4e2d\u95f4\u8868\u793a\uff09\u8fd9\u4e00\u590d\u6742\u4e14\u6613\u5931\u771f\u7684\u8fc7\u7a0b\u3002</li> <li>\u8be5\u6620\u5c04\u8fc7\u7a0b\u662fAutoFDO\u7b49\u7f16\u8bd1\u65f6PGO\u6280\u672f\u7684\u4e3b\u8981\u74f6\u9888\u3002\u5982\u8bba\u6587\u6240\u8ff0\uff0c\u5373\u4f7f\u7ecf\u8fc7\u4f18\u5316\uff0c\u8fd9\u79cd\u6620\u5c04\u7684\u51c6\u786e\u6027\u4e5f\u4ec5\u80fd\u8fbe\u5230\u7ea692.9%\uff0c\u800cBOLT\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u7684\u64cd\u4f5c\u5929\u7136\u89c4\u907f\u4e86\u6b64\u95ee\u9898\uff0c\u5b9e\u73b0\u4e86\u6700\u9ad8\u7ea7\u522b\u7684\u5256\u6790\u6570\u636e\u51c6\u786e\u6027\u3002</li> </ul> <p>\u5256\u6790\u6570\u636e\u7684\u91c7\u96c6\u4e0e\u5904\u7406\u6d41\u7a0b</p> <ul> <li>\u8f93\u5165: BOLT\u4f9d\u8d56\u4e8esample-based profiling\uff08\u57fa\u4e8e\u91c7\u6837\u7684\u5256\u6790\uff09\uff0c\u7279\u522b\u662f\u5229\u7528\u73b0\u4ee3Intel CPU\u63d0\u4f9b\u7684\u786c\u4ef6\u7279\u6027\u2014\u2014Last Branch Records (LBR)\u3002<ul> <li>LBR\u80fd\u591f\u8bb0\u5f55\u6700\u8fd132\u6761taken branches\uff08\u5df2\u6267\u884c\u7684\u5206\u652f\uff09\u7684\u7cbe\u786e\u6765\u6e90\u548c\u76ee\u6807\u5730\u5740\u3002</li> <li>\u8fd9\u79cd\u91c7\u6837\u65b9\u5f0f\u5f00\u9500\u6781\u4f4e\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5bf9\u672a\u4fee\u6539\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u5256\u6790\uff0c\u89e3\u51b3\u4e86\u4f20\u7edfinstrumentation-based profiling\uff08\u57fa\u4e8e\u63d2\u6869\u7684\u5256\u6790\uff09\u5f00\u9500\u8fc7\u5927\u7684\u95ee\u9898\u3002</li> </ul> </li> <li>\u6570\u636e\u8f6c\u6362: \u539f\u59cb\u7684\u91c7\u6837\u6570\u636e\uff08\u901a\u5e38\u7531Linux <code>perf</code>\u5de5\u5177\u6536\u96c6\uff09\u901a\u8fc7\u4e00\u4e2a\u540d\u4e3a<code>perf2bolt</code>\u7684\u4e13\u7528\u5de5\u5177\u8f6c\u6362\u4e3aBOLT\u53ef\u8bfb\u7684YAML\u683c\u5f0f\u3002</li> <li>\u5173\u952e\u7b97\u6cd5: BOLT\u5229\u7528LBR\u6570\u636e\u6765reconstruct edge counts\uff08\u91cd\u6784\u8fb9\u8ba1\u6570\uff09\u3002<ul> <li>\u7531\u4e8eLBR\u53ea\u8bb0\u5f55\u5df2\u6267\u884c\u7684\u5206\u652f\uff0c\u5bf9\u4e8enon-taken path\uff08\u672a\u6267\u884c\u8def\u5f84\uff09\uff0cBOLT\u91c7\u7528\u4e00\u79cd\u542f\u53d1\u5f0f\u65b9\u6cd5\uff1a\u5c06\u6240\u6709\u8d85\u51fa\u9884\u671f\u7684\u6d41\uff08surplus flow\uff09\u5f52\u56e0\u4e8e\u672a\u88abLBR\u6355\u83b7\u7684\u975e\u8df3\u8f6c\u8def\u5f84\uff0c\u5e76\u503e\u5411\u4e8e\u4fe1\u4efb\u539f\u59cb\u7f16\u8bd1\u5668\u751f\u6210\u7684fall-through path\uff08\u76f4\u901a\u8def\u5f84\uff09\u3002</li> <li>\u8fd9\u79cd\u7b56\u7565\u4f7f\u5f97BOLT\u7684\u5e03\u5c40\u4f18\u5316\u5bf9\u91c7\u6837\u566a\u58f0\u66f4\u5177\u9c81\u68d2\u6027\uff0c\u5e76\u4e14\u53ea\u6709\u5f53\u5256\u6790\u6570\u636e\u663e\u8457\u5730\u4e0e\u539f\u59cb\u5e03\u5c40\u51b2\u7a81\u65f6\uff0c\u624d\u4f1a\u89e6\u53d1\u91cd\u6392\u5e8f\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 2: Example showing a challenge in mapping binary-level events back to higher-level code representations.</p> <ul> <li>\u4e0a\u56fe\uff08Fig. 2\uff09\u6e05\u6670\u5730\u9610\u91ca\u4e86\u7f16\u8bd1\u5668IR\u5c42\u9762\u6620\u5c04\u7684\u56f0\u5883\uff1a\u51fd\u6570<code>foo</code>\u88ab\u5185\u8054\u5230<code>bar</code>\u548c<code>baz</code>\u4e2d\uff0c\u4e14\u5728\u4e24\u4e2a\u8c03\u7528\u70b9\u7684\u6700\u4f73\u57fa\u672c\u5757\u5e03\u5c40\u662f\u76f8\u53cd\u7684\u3002\u5728IR\u5c42\u9762\uff0c\u5256\u6790\u6570\u636e\u4f1a\u88ab\u5e73\u5747\u5316\uff0850%\u6982\u7387\uff09\uff0c\u5bfc\u81f4\u7f16\u8bd1\u5668\u65e0\u6cd5\u505a\u51fa\u6700\u4f18\u51b3\u7b56\u3002\u800cBOLT\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u80fd\u770b\u5230\u4e24\u4e2a\u72ec\u7acb\u7684\u3001\u5e03\u5c40\u9700\u6c42\u4e0d\u540c\u7684<code>foo</code>\u5b9e\u4f8b\uff0c\u5e76\u80fd\u5206\u522b\u4f18\u5316\u5b83\u4eec\u3002</li> </ul> <p>\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u7684\u5177\u4f53\u5b9e\u73b0</p> <ul> <li>\u57fa\u672c\u5757\u91cd\u6392\u5e8f (Basic Block Reordering)<ul> <li>\u76ee\u6807: \u5c06\u6700\u9891\u7e41\u6267\u884c\u7684\u8def\u5f84\uff08hot path\uff09\u7ec4\u7ec7\u6210\u8fde\u7eed\u7684fall-through\u5e8f\u5217\uff0c\u4ee5\u51cf\u5c11taken branches\uff08\u8df3\u8f6c\u5206\u652f\uff09\u7684\u6570\u91cf\uff0c\u4ece\u800c\u63d0\u5347branch predictor\uff08\u5206\u652f\u9884\u6d4b\u5668\uff09\u6548\u7387\u548cI-cache locality\uff08\u6307\u4ee4\u7f13\u5b58\u5c40\u90e8\u6027\uff09\u3002</li> <li>\u9a71\u52a8: \u5b8c\u5168\u7531\u4eceLBR\u5256\u6790\u6570\u636e\u4e2d\u63a8\u65ad\u51fa\u7684\u7cbe\u786ebranch frequencies\uff08\u5206\u652f\u9891\u7387\uff09\u9a71\u52a8\u3002</li> <li>\u6548\u679c: \u5982Table II\u6240\u793a\uff0cBOLT\u80fd\u5728Clang\u4e0a\u5c06taken branches\u51cf\u5c1144.3%\uff08\u5728PGO+LTO\u57fa\u7840\u4e0a\uff09\u3002</li> </ul> </li> <li>\u51fd\u6570\u91cd\u6392\u5e8f (Function Reordering)<ul> <li>\u7b97\u6cd5: \u91c7\u7528HFSort\u7b97\u6cd5\uff0c\u8be5\u7b97\u6cd5\u57fa\u4e8e\u4e00\u4e2a\u7531\u5256\u6790\u6570\u636e\u6784\u5efa\u7684weighted call graph\uff08\u52a0\u6743\u8c03\u7528\u56fe\uff09\u3002</li> <li>\u6570\u636e\u6e90: \u5f53\u4f7f\u7528LBR\u65f6\uff0c\u8c03\u7528\u56fe\u7684\u8fb9\u6743\u91cd\u53ef\u4ee5\u76f4\u63a5\u4ece\u5206\u652f\u8bb0\u5f55\u4e2d\u7cbe\u786e\u63a8\u65ad\uff0c\u5305\u62ec\u51fd\u6570\u8c03\u7528\u548c\u8fd4\u56de\u3002\u82e5\u65e0LBR\uff0c\u5219\u53ea\u80fd\u901a\u8fc7\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\u9644\u8fd1\u7684\u91c7\u6837\u70b9\u6765\u4f30\u7b97\uff0c\u4e14\u65e0\u6cd5\u5904\u7406indirect calls\uff08\u95f4\u63a5\u8c03\u7528\uff09\u3002</li> <li>\u4e3b\u8981\u6536\u76ca: \u663e\u8457\u6539\u5584I-TLB\uff08\u6307\u4ee4\u7ffb\u8bd1\u540e\u5907\u7f13\u51b2\u533a\uff09\u6027\u80fd\uff0c\u5e76\u5bf9I-cache\u6709\u6b21\u8981\u6539\u5584\u3002</li> </ul> </li> </ul> <p>LBR\u7684\u5173\u952e\u4f5c\u7528\u4e0e\u6027\u80fd\u5f71\u54cd</p> <ul> <li>LBR\u5bf9\u4e8e\u5b9e\u73b0fine-grained profiling\uff08\u7ec6\u7c92\u5ea6\u5256\u6790\uff09\u81f3\u5173\u91cd\u8981\uff0c\u5c24\u5176\u662f\u5728\u57fa\u672c\u5757\u5c42\u9762\u3002</li> <li>\u8bba\u6587\u901a\u8fc7\u5bf9\u6bd4\u5b9e\u9a8c\u8bc1\u660e\u4e86LBR\u7684\u4ef7\u503c\uff1a<ul> <li>\u5bf9\u4e8eHHVM\uff0c\u5728\u542f\u7528\u6240\u6709\u4f18\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528LBR\u76f8\u6bd4\u4e0d\u4f7f\u7528LBR\uff0c\u80fd\u989d\u5916\u5e26\u6765\u7ea62%\u7684CPU\u65f6\u95f4\u7f29\u51cf\uff08\u603b\u63d0\u901f\u4e3a6.4%\uff09\u3002</li> <li>\u5bf9\u4e8e\u57fa\u672c\u5757\u91cd\u6392\u5e8f\uff0cLBR\u5e26\u6765\u7684\u6536\u76ca\u8fdc\u5927\u4e8e\u5bf9\u51fd\u6570\u91cd\u6392\u5e8f\u7684\u6536\u76ca\uff0c\u56e0\u4e3a\u524d\u8005\u5bf9\u5256\u6790\u7cbe\u5ea6\u7684\u8981\u6c42\u66f4\u9ad8\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 11: Heat maps for instruction memory accesses of Clang binaries. Heat is in a log scale.</p> <ul> <li>\u4e0a\u56fe\uff08Fig. 12\uff09\u91cf\u5316\u4e86LBR\u5bf9HHVM\u5404\u9879\u6307\u6807\u7684\u63d0\u5347\uff0c\u6e05\u6670\u5730\u8868\u660e\u5176\u5bf9basic block reordering\u7684\u51b3\u5b9a\u6027\u5f71\u54cd\u3002</li> </ul> <p>\u5728\u6574\u4f53\u4f18\u5316\u6d41\u6c34\u7ebf\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: \u9ad8\u5ea6\u4f18\u5316\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u53ef\u80fd\u5df2\u5305\u542bLTO\u548cFDO/PGO\uff09\u4ee5\u53ca\u7531<code>perf</code>\u91c7\u96c6\u5e76\u7ecf<code>perf2bolt</code>\u8f6c\u6362\u7684\u5256\u6790\u6570\u636e\u3002</li> <li>\u5904\u7406: BOLT\u7684\u4f18\u5316\u6d41\u6c34\u7ebf\uff08\u5982Table I\u6240\u793a\uff09\u5c06\u5256\u6790\u6570\u636e\u4f5c\u4e3a\u6838\u5fc3\u8f93\u5165\uff0c\u9a71\u52a8\u591a\u4e2a\u5173\u952e\u4f18\u5316\u6b65\u9aa4\uff0c\u5c24\u5176\u662f\u7b2c8\u6b65\uff08\u57fa\u672c\u5757\u91cd\u6392\u5e8f\u4e0e\u51b7\u70ed\u5206\u79bb\uff09\u548c\u7b2c12\u6b65\uff08\u51fd\u6570\u91cd\u6392\u5e8f\uff09\u3002</li> <li>\u8f93\u51fa: \u4e00\u4e2a\u7ecf\u8fc7\u91cd\u65b0\u5e03\u5c40\u3001\u4ee3\u7801\u66f4\u7d27\u51d1\u3001\u6267\u884c\u8def\u5f84\u66f4\u9ad8\u6548\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u4e92\u8865\u6027: BOLT\u7684\u4f18\u5316\u4e0e\u7f16\u8bd1\u5668\u7684LTO/FDO\u662fcomplementary\uff08\u4e92\u8865\uff09\u800c\u975eoverlapping\uff08\u91cd\u53e0\uff09\u7684\u3002\u7f16\u8bd1\u5668\u8d1f\u8d23\u9ad8\u5c42\u6b21\u7684\u4f18\u5316\uff08\u5982\u5185\u8054\u3001\u6b7b\u4ee3\u7801\u6d88\u9664\uff09\uff0c\u800cBOLT\u5219\u5728\u6700\u540e\u9636\u6bb5\uff0c\u5229\u7528\u6700\u7cbe\u786e\u7684\u8fd0\u884c\u65f6\u4fe1\u606f\uff0c\u5bf9code layout\uff08\u4ee3\u7801\u5e03\u5c40\uff09\u8fd9\u4e00\u5e95\u5c42\u4f46\u5173\u952e\u7684\u65b9\u9762\u8fdb\u884c\u7cbe\u96d5\u7ec6\u7422\uff0c\u4ece\u800c\u69a8\u53d6\u6700\u540e\u7684\u6027\u80fd\u6f5c\u529b\u3002</li> </ul> <p></p> <p>Fig. 12: Improvements on different metrics for HHVM by using LBRs (higher is better).</p> <ul> <li>\u4e0a\u56fe\uff08Fig. 11\uff09\u7684\u70ed\u529b\u56fe\u76f4\u89c2\u5c55\u793a\u4e86BOLT\u7684\u6548\u679c\uff1a\u5b83\u5c06\u539f\u672c\u5206\u6563\u572855MB\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u70ed\u70b9\u4ee3\u7801\uff0c\u7d27\u5bc6\u5730\u6253\u5305\u5230\u7ea66.7MB\u7684\u8fde\u7eed\u533a\u57df\u5185\uff0c\u6781\u5927\u5730\u63d0\u5347\u4e86I-cache\u548cI-TLB\u7684\u6548\u7387\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#3_1","title":"3. \u6df7\u5408\u51fd\u6570\u53d1\u73b0\u4e0e\u63a7\u5236\u6d41\u56fe\u91cd\u5efa","text":"<p>\u6df7\u5408\u51fd\u6570\u53d1\u73b0\u4e0e\u63a7\u5236\u6d41\u56fe\u91cd\u5efa</p> <p>BOLT \u7684\u4f18\u5316\u6d41\u7a0b\u59cb\u4e8e\u5bf9\u8f93\u5165\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u7cbe\u786e\u89e3\u6790\uff0c\u5176\u6838\u5fc3\u6311\u6218\u5728\u4e8e\u51c6\u786e\u8bc6\u522b\u6240\u6709\u53ef\u4f18\u5316\u51fd\u6570\u7684\u8fb9\u754c\u5e76\u4e3a\u5176\u6784\u5efa\u53ef\u9760\u7684\u63a7\u5236\u6d41\u56fe\uff08CFG\uff09\u3002\u4e3a\u5e94\u5bf9\u5927\u578b\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\u4e2d\u5305\u542b\u591a\u79cd\u8bed\u8a00\uff08\u5305\u62ec\u624b\u5199\u6c47\u7f16\uff09\u4ee3\u7801\u7684\u590d\u6742\u6027\uff0cBOLT \u91c7\u7528\u4e86\u4e00\u79cd\u6df7\u5408\u65b9\u6cd5\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u3002</p> <ul> <li> <p>\u51fd\u6570\u53d1\u73b0 (Function Discovery)</p> <ul> <li>\u8f93\u5165: \u539f\u59cb\u7684 x86-64 Linux ELF \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u6570\u636e\u6e90: BOLT \u4e3b\u8981\u4f9d\u8d56\u4e24\u79cd\u4fe1\u606f\u6e90\u6765\u5b9a\u4f4d\u51fd\u6570\uff1a<ul> <li>ELF \u7b26\u53f7\u8868 (Symbol Table): \u8fd9\u662f\u4e3b\u8981\u7684\u51fd\u6570\u53d1\u73b0\u673a\u5236\u3002\u7b26\u53f7\u8868\u63d0\u4f9b\u4e86\u51fd\u6570\u540d\u5230\u8d77\u59cb\u5730\u5740\u7684\u6620\u5c04\u3002</li> <li>DWARF Call Frame Information (CFI): ABI \u8981\u6c42\u63d0\u4f9b\u6b64\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u542b\u51fd\u6570\u8fb9\u754c\u3002\u7136\u800c\uff0cBOLT \u56e2\u961f\u89c2\u5bdf\u5230\u624b\u5199\u6c47\u7f16\u4ee3\u7801\u5e38\u5e38\u4f1a\u7701\u7565 CFI \u4fe1\u606f\u3002</li> </ul> </li> <li>\u6df7\u5408\u7b56\u7565: \u4e3a\u786e\u4fdd\u6700\u5927\u8986\u76d6\u8303\u56f4\uff0cBOLT \u91c7\u7528\u6df7\u5408\u65b9\u6cd5\uff0c\u4f18\u5148\u4f7f\u7528\u7b26\u53f7\u8868\uff0c\u5e76\u5728\u53ef\u7528\u65f6\u8f85\u4ee5 CFI \u4fe1\u606f\u8fdb\u884c\u4ea4\u53c9\u9a8c\u8bc1\u548c\u8865\u5145\u3002\u8fd9\u79cd\u7b56\u7565\u4f7f\u5176\u80fd\u591f\u5904\u7406\u90a3\u4e9b\u7f3a\u4e4f\u5b8c\u6574\u8c03\u8bd5\u4fe1\u606f\u7684\u51fd\u6570\u3002</li> <li>\u4fdd\u5b88\u5904\u7406: \u5bf9\u4e8e\u65e0\u6cd5\u4ee5\u9ad8\u7f6e\u4fe1\u5ea6\u91cd\u5efa\u5176 CFG \u7684\u51fd\u6570\uff08\u4f8b\u5982\uff0c\u5305\u542b\u590d\u6742\u7684\u95f4\u63a5\u8df3\u8f6c\u6216\u81ea\u4fee\u6539\u4ee3\u7801\uff09\uff0cBOLT \u4f1a\u4fdd\u5b88\u5730\u8df3\u8fc7\u8fd9\u4e9b\u51fd\u6570\uff0c\u4fdd\u6301\u5176\u539f\u59cb\u5f62\u6001\uff0c\u4ee5\u786e\u4fdd\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u529f\u80fd\u6b63\u786e\u6027\u3002</li> </ul> </li> <li> <p>\u63a7\u5236\u6d41\u56fe (CFG) \u91cd\u5efa</p> <ul> <li>\u53cd\u6c47\u7f16\u5f15\u64ce: BOLT \u5229\u7528 LLVM \u7684\u6a21\u5757\u5316\u57fa\u7840\u8bbe\u65bd\uff0c\u7279\u522b\u662f\u5176 Tablegen-generated disassembler \u6765\u5c06\u673a\u5668\u7801\u53cd\u6c47\u7f16\u4e3a MCInst \u5bf9\u8c61\u5e8f\u5217\u3002</li> <li>CFG \u6784\u5efa\u7b97\u6cd5: \u901a\u8fc7\u904d\u5386\u53cd\u6c47\u7f16\u5f97\u5230\u7684\u6307\u4ee4\u6d41\uff0cBOLT \u5206\u6790\u6240\u6709\u5206\u652f\u6307\u4ee4 (branch instructions)\uff0c\u5305\u62ec\u6761\u4ef6\u8df3\u8f6c\u3001\u65e0\u6761\u4ef6\u8df3\u8f6c\u3001\u8c03\u7528\u548c\u8fd4\u56de\u6307\u4ee4\u3002<ul> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u8bc6\u522b\u51fa\u7684\u5206\u652f\u6307\u4ee4\uff0cBOLT \u4f1a\u89e3\u6790\u5176\u76ee\u6807\u5730\u5740\uff08\u76f4\u63a5\u6216\u95f4\u63a5\uff09\u3002</li> <li>\u57fa\u4e8e\u8fd9\u4e9b\u5206\u652f\u5173\u7cfb\uff0c\u5c06\u8fde\u7eed\u7684\u975e\u5206\u652f\u6307\u4ee4\u5e8f\u5217\u5212\u5206\u4e3a\u57fa\u672c\u5757 (basic blocks)\u3002</li> <li>\u6700\u7ec8\uff0c\u5c06\u6240\u6709\u57fa\u672c\u5757\u53ca\u5176\u8df3\u8f6c\u5173\u7cfb\u7ec4\u5408\u6210\u4e00\u4e2a\u5b8c\u6574\u7684 CFG\u3002</li> </ul> </li> <li>\u67b6\u6784\u7279\u5b9a\u5904\u7406: \u8be5\u8fc7\u7a0b\u9700\u8981\u5904\u7406 x86-64 \u67b6\u6784\u7684\u7279\u5b9a\u7ec6\u8282\uff0c\u4f8b\u5982\u76f8\u5bf9\u5bfb\u5740\u548c\u4e0d\u540c\u957f\u5ea6\u7684\u6307\u4ee4\u7f16\u7801\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.</p> <p>\u5728\u6574\u4f53\u4f18\u5316\u6d41\u7a0b\u4e2d\u7684\u4f5c\u7528</p> <p>\u6b64\u9636\u6bb5\u662f BOLT \u6574\u4e2a\u4f18\u5316\u7ba1\u9053\u7684\u57fa\u77f3\uff0c\u5176\u8f93\u51fa\u76f4\u63a5\u51b3\u5b9a\u4e86\u540e\u7eed\u6240\u6709\u4f18\u5316\u7684\u6709\u6548\u6027\u548c\u5b89\u5168\u6027\u3002</p> <ul> <li>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb:<ul> <li>\u8f93\u5165: \u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\u3001\u53ef\u9009\u7684 relocations \u4fe1\u606f\uff08\u7528\u4e8e\u66f4\u6fc0\u8fdb\u7684\u91cd\u6392\uff09\u3001DWARF \u8c03\u8bd5\u4fe1\u606f\u3001\u4ee5\u53ca\u6837\u672c\u5206\u6790\u6570\u636e\u3002</li> <li>\u8f93\u51fa: \u4e00\u4e2a\u7531\u51fd\u6570\u5bf9\u8c61\u7ec4\u6210\u7684\u5185\u90e8\u8868\u793a\uff0c\u6bcf\u4e2a\u51fd\u6570\u5bf9\u8c61\u90fd\u5305\u542b\u4e00\u4e2a\u7cbe\u786e\u7684 CFG\u3001\u539f\u59cb\u6307\u4ee4\u7684 MCInst \u8868\u793a\u3001\u4ee5\u53ca\u4e0e\u6e90\u4ee3\u7801\u884c\u53f7\u548c\u8c03\u8bd5\u4fe1\u606f\u7684\u6620\u5c04\u3002</li> </ul> </li> <li>\u6838\u5fc3\u4f5c\u7528:<ul> <li>\u4e3a\u4f18\u5316\u63d0\u4f9b\u57fa\u7840: \u6240\u6709\u540e\u7eed\u7684\u4f18\u5316\uff08\u5982\u57fa\u672c\u5757\u91cd\u6392\u3001\u51fd\u6570\u5185\u8054\u3001\u95f4\u63a5\u8c03\u7528\u63d0\u5347\u7b49\uff09\u90fd\u76f4\u63a5\u5728\u91cd\u5efa\u7684 CFG \u4e0a\u8fdb\u884c\u64cd\u4f5c\u3002\u4e00\u4e2a\u51c6\u786e\u7684 CFG \u662f\u6267\u884c\u4efb\u4f55\u6709\u610f\u4e49\u4ee3\u7801\u53d8\u6362\u7684\u524d\u63d0\u3002</li> <li>\u652f\u6301\u8c03\u8bd5\u4e0e\u5f02\u5e38: \u901a\u8fc7\u4fdd\u7559\u548c\u66f4\u65b0 DWARF \u4fe1\u606f\uff08\u5982\u56fe4\u6240\u793a\uff09\uff0cBOLT \u786e\u4fdd\u4e86\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4ecd\u7136\u652f\u6301\u6e90\u7801\u7ea7\u8c03\u8bd5\u548c C++ exceptions \u7684\u6b63\u786e\u5c55\u5f00\u3002\u56fe\u4e2d\u7684 <code>landing-pad</code> \u6ce8\u89e3\u548c <code>CFI</code> \u5360\u4f4d\u7b26\u6e05\u6670\u5730\u5c55\u793a\u4e86 BOLT \u5982\u4f55\u5728\u5185\u90e8\u8868\u793a\u4e2d\u7ef4\u62a4\u8fd9\u4e9b\u5173\u952e\u5143\u6570\u636e\u3002</li> <li>\u542f\u7528\u5b89\u5168\u91cd\u5199: \u7cbe\u786e\u7684 CFG \u548c\u5bf9\u6240\u6709\u4ee3\u7801/\u6570\u636e\u5f15\u7528\u7684\u8bc6\u522b\uff0c\u4f7f\u5f97 BOLT \u80fd\u591f\u5b89\u5168\u5730\u79fb\u52a8\u4ee3\u7801\u5757\u3001\u5206\u88c2\u51fd\u6570\uff0c\u5e76\u5728\u6700\u540e\u4f7f\u7528 LLVM \u7684\u8fd0\u884c\u65f6\u52a8\u6001\u94fe\u63a5\u5668 \u6765\u6b63\u786e\u89e3\u6790\u548c\u66f4\u65b0\u6240\u6709\u5185\u90e8\u5f15\u7528\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 4: Partial CFG dump for a function with C++ exceptions.</p>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#4","title":"4. \u591a\u9636\u6bb5\u4f18\u5316\u6d41\u6c34\u7ebf","text":"<p>BOLT\u591a\u9636\u6bb5\u4f18\u5316\u6d41\u6c34\u7ebf\u67b6\u6784</p> <p>BOLT\u7684\u4f18\u5316\u6d41\u7a0b\u88ab\u8bbe\u8ba1\u4e3a\u4e00\u4e2a\u987a\u5e8f\u6267\u884c\u7684Pass\u5e8f\u5217\uff0c\u5176\u6838\u5fc3\u76ee\u6807\u662f\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u7cbe\u786e\u5229\u7528\u91c7\u6837\u5256\u6790\u6570\u636e\uff0c\u4ee5\u6539\u5584\u4ee3\u7801\u5e03\u5c40\u5e76\u51cf\u5c11\u524d\u7aef\u74f6\u9888\u3002\u6574\u4e2a\u6d41\u6c34\u7ebf\u5efa\u7acb\u5728LLVM\u57fa\u7840\u8bbe\u65bd\u4e4b\u4e0a\uff0c\u5229\u7528\u5176MCInst\uff08Machine Instruction\uff09\u4f5c\u4e3a\u5e95\u5c42\u8868\u793a\uff0c\u5e76\u901a\u8fc7\u81ea\u5b9a\u4e49\u6ce8\u89e3\u673a\u5236\u6765\u652f\u6301\u590d\u6742\u7684\u6570\u636e\u6d41\u548c\u63a7\u5236\u6d41\u5206\u6790\u3002</p> <p></p> <p>Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.</p> <ul> <li>\u8f93\u5165: \u4e00\u4e2a\u5df2\u7f16\u8bd1\u7684\u3001\u5e26\u6709\u53ef\u9009\u91cd\u5b9a\u4f4d\u4fe1\u606f\uff08<code>--emit-relocs</code>\uff09\u7684ELF\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4ee5\u53ca\u7531<code>perf</code>\u7b49\u5de5\u5177\u6536\u96c6\u5e76\u7ecf<code>perf2bolt</code>\u8f6c\u6362\u7684YAML\u683c\u5f0f\u5256\u6790\u6570\u636e\u3002</li> <li>\u8f93\u51fa: \u4e00\u4e2a\u7ecf\u8fc7\u91cd\u5199\u3001\u6027\u80fd\u4f18\u5316\u7684\u65b0ELF\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u66f4\u65b0\u540e\u7684\u4ee3\u7801\u3001\u6570\u636e\u6bb5\u3001\u7b26\u53f7\u8868\u3001\u91cd\u5b9a\u4f4d\u4fe1\u606f\u4ee5\u53caDWARF\u8c03\u8bd5\u4e0e\u5f02\u5e38\u5904\u7406\u5143\u6570\u636e\u3002</li> </ul> <p>\u6838\u5fc3\u4f18\u5316\u9636\u6bb5\u8be6\u89e3</p> <p>\u6839\u636e\u8bba\u6587\u4e2dTable I\u6240\u5217\u7684\u4f18\u5316\u5e8f\u5217\uff0cBOLT\u7684\u5173\u952e\u4f18\u5316\u9636\u6bb5\u53ca\u5176\u539f\u7406\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u57fa\u672c\u5757\u70ed/\u51b7\u8def\u5f84\u91cd\u6392\u4e0e\u62c6\u5206 (Reorder and Split Hot/Cold Basic Blocks)</p> <ul> <li>\u5b9e\u73b0\u539f\u7406: \u8be5\u4f18\u5316\u662f\u6d41\u6c34\u7ebf\u4e2d\uff08\u7b2c8\u6b65\uff09\u6700\u6709\u6548\u7684\u4f18\u5316\u4e4b\u4e00\u3002BOLT\u9996\u5148\u57fa\u4e8e\u5256\u6790\u6570\u636e\u6784\u5efa\u6bcf\u4e2a\u51fd\u6570\u7684\u63a7\u5236\u6d41\u56fe\uff08CFG\uff09\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u57fa\u672c\u5757\u548c\u8fb9\u6807\u6ce8\u6267\u884c\u9891\u7387\u3002\u968f\u540e\uff0c\u5b83\u5e94\u7528\u4e00\u79cd\u7c7b\u4f3c\u4e8ePettis and Hansen\u7b97\u6cd5\u7684\u53d8\u4f53\uff0c\u5bf9\u57fa\u672c\u5757\u8fdb\u884c\u91cd\u6392\u3002</li> <li>\u7b97\u6cd5\u6d41\u7a0b:<ul> <li>\u8bc6\u522b\u70ed\u8def\u5f84\uff08hot path\uff09\uff0c\u5373\u6267\u884c\u9891\u7387\u6700\u9ad8\u7684\u8fde\u7eed\u57fa\u672c\u5757\u5e8f\u5217\u3002</li> <li>\u5c06\u70ed\u8def\u5f84\u4e0a\u7684\u57fa\u672c\u5757\u7d27\u5bc6\u6392\u5217\uff0c\u786e\u4fdd\u6700\u5e38\u89c1\u7684\u540e\u7ee7\u5757\u6210\u4e3afall-through\u76ee\u6807\uff0c\u4ece\u800c\u51cf\u5c11taken branches\u7684\u6570\u91cf\u3002</li> <li>\u5c06\u6267\u884c\u9891\u7387\u6781\u4f4e\u7684\u51b7\u5757\uff08cold blocks\uff09\u4ece\u4e3b\u4ee3\u7801\u6d41\u4e2d\u62c6\u5206\uff08split\uff09\u51fa\u53bb\uff0c\u5e76\u79fb\u52a8\u5230\u4e00\u4e2a\u65b0\u7684ELF\u6bb5\uff08\u901a\u5e38\u662f<code>.text.unlikely</code>\uff09\u4e2d\u3002</li> </ul> </li> <li>\u4f5c\u7528: \u6b64\u64cd\u4f5c\u663e\u8457\u63d0\u5347\u4e86I-cache\u548cbranch predictor\u7684\u6548\u7387\u3002\u5982Table II\u6240\u793a\uff0c\u5373\u4f7f\u5728Clang\u5df2\u7ecf\u8fc7PGO+LTO\u4f18\u5316\u7684\u57fa\u7840\u4e0a\uff0cBOLT\u4ecd\u80fd\u5c06taken branches\u51cf\u5c1144.3%\u3002</li> </ul> </li> <li> <p>\u57fa\u4e8eHFSort\u7684\u51fd\u6570\u91cd\u6392\u5e8f (Function Reordering via HFSort)</p> <ul> <li>\u5b9e\u73b0\u539f\u7406: \u8fd9\u662f\u6d41\u6c34\u7ebf\u4e2d\u7684\u6700\u540e\u4e00\u6b65\uff08\u7b2c12\u6b65\uff09\uff0c\u4e3b\u8981\u7528\u4e8e\u4f18\u5316I-TLB\u6027\u80fd\u3002BOLT\u5229\u7528\u5256\u6790\u6570\u636e\u6784\u5efa\u4e00\u4e2a\u52a0\u6743\u8c03\u7528\u56fe\uff08weighted call graph\uff09\uff0c\u5176\u4e2d\u8282\u70b9\u662f\u51fd\u6570\uff0c\u8fb9\u7684\u6743\u91cd\u4ee3\u8868\u8c03\u7528\u9891\u7387\u3002</li> <li>\u7b97\u6cd5\u6d41\u7a0b:<ul> <li>\u4f7f\u7528HFSort\u7b97\u6cd5\u5bf9\u51fd\u6570\u8fdb\u884c\u62d3\u6251\u6392\u5e8f\u3002\u8be5\u7b97\u6cd5\u65e8\u5728\u5c06\u9891\u7e41\u76f8\u4e92\u8c03\u7528\u7684\u51fd\u6570\u5728\u5185\u5b58\u4e2d\u653e\u7f6e\u5f97\u66f4\u8fd1\uff0c\u4ee5\u6700\u5927\u5316I-TLB\u547d\u4e2d\u7387\u3002</li> <li>\u5728\u5177\u5907Last Branch Records (LBR)\u652f\u6301\u7684\u5e73\u53f0\u4e0a\uff0c\u8c03\u7528\u56fe\u7684\u8fb9\u6743\u91cd\u53ef\u4ee5\u76f4\u63a5\u4ece\u786c\u4ef6\u8bb0\u5f55\u7684\u5206\u652f\u8f68\u8ff9\u4e2d\u7cbe\u786e\u63a8\u65ad\uff0c\u5305\u62ec\u95f4\u63a5\u8c03\u7528\u3002</li> </ul> </li> <li>\u4f5c\u7528: \u4e0e\u57fa\u672c\u5757\u91cd\u6392\u534f\u540c\u5de5\u4f5c\uff0c\u4ece\u5168\u5c40\u89c6\u89d2\u4f18\u5316\u4ee3\u7801\u5e03\u5c40\u3002Figures 8\u548c9\u7684\u5206\u89e3\u5b9e\u9a8c\u8868\u660e\uff0c\u51fd\u6570\u91cd\u6392\u4e0e\u57fa\u672c\u5757\u91cd\u6392\u5171\u540c\u6784\u6210\u4e86BOLT\u6027\u80fd\u6536\u76ca\u7684\u4e3b\u4f53\u3002</li> </ul> </li> <li> <p>\u95f4\u63a5\u8c03\u7528\u63d0\u5347 (Indirect Call Promotion, ICP)</p> <ul> <li>\u5b9e\u73b0\u539f\u7406: \u8be5\u4f18\u5316\uff08\u7b2c3\u6b65\uff09\u5229\u7528\u5256\u6790\u6570\u636e\u4e2d\u5173\u4e8e\u95f4\u63a5\u8c03\u7528\u76ee\u6807\u7684\u9891\u7387\u4fe1\u606f\u3002</li> <li>\u7b97\u6cd5\u6d41\u7a0b:<ul> <li>\u5bf9\u4e8e\u4e00\u4e2a\u9ad8\u9891\u7684\u95f4\u63a5\u8c03\u7528\u70b9\uff0c\u5982\u679c\u5256\u6790\u6570\u636e\u663e\u793a\u5176\u7edd\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u90fd\u8df3\u8f6c\u5230\u540c\u4e00\u4e2a\u76ee\u6807\u51fd\u6570\uff0c\u5219BOLT\u4f1a\u5c06\u8be5\u95f4\u63a5\u8c03\u7528\u63d0\u5347\uff08promote\uff09\u4e3a\u4e00\u4e2a\u76f4\u63a5\u7684\u6761\u4ef6\u5206\u652f\u3002</li> <li>\u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u4f1a\u63d2\u5165\u4e00\u4e2a\u6bd4\u8f83\u6307\u4ee4\uff0c\u68c0\u67e5\u51fd\u6570\u6307\u9488\u662f\u5426\u7b49\u4e8e\u6700\u5e38\u89c1\u7684\u76ee\u6807\u5730\u5740\u3002\u5982\u679c\u662f\uff0c\u5219\u76f4\u63a5\u8df3\u8f6c\uff08call\uff09\u5230\u8be5\u76ee\u6807\uff1b\u5426\u5219\uff0c\u56de\u9000\u5230\u539f\u6709\u7684\u95f4\u63a5\u8c03\u7528\u3002</li> </ul> </li> <li>\u4f5c\u7528: \u6d88\u9664\u4e86\u95f4\u63a5\u8c03\u7528\u5e26\u6765\u7684\u5206\u652f\u9884\u6d4b\u5931\u8d25\u5f00\u9500\uff0c\u5e76\u4e3a\u540e\u7eed\u53ef\u80fd\u7684\u5185\u8054\uff08\u5c3d\u7ba1BOLT\u7684\u5185\u8054\u80fd\u529b\u6709\u9650\uff09\u521b\u9020\u4e86\u6761\u4ef6\u3002</li> </ul> </li> <li> <p>PLT\u8c03\u7528\u4f18\u5316 (PLT Call Optimization)</p> <ul> <li>\u5b9e\u73b0\u539f\u7406: \u8be5\u4f18\u5316\uff08\u7b2c7\u6b65\uff09\u9488\u5bf9\u901a\u8fc7Procedure Linkage Table (PLT)\u8fdb\u884c\u7684\u52a8\u6001\u5e93\u51fd\u6570\u8c03\u7528\u3002</li> <li>\u7b97\u6cd5\u6d41\u7a0b:<ul> <li>\u5bf9\u4e8e\u9ad8\u9891\u7684PLT\u8c03\u7528\uff0cBOLT\u53ef\u4ee5\u5c06\u5176\u66ff\u6362\u4e3a\u5bf9Global Offset Table (GOT)\u6761\u76ee\u7684\u76f4\u63a5\u52a0\u8f7d\u548c\u8c03\u7528\uff0c\u7ed5\u8fc7PLT\u5b58\u6839\uff08stub\uff09\u3002</li> <li>\u8fd9\u51cf\u5c11\u4e86\u6bcf\u6b21\u8c03\u7528\u6240\u9700\u7684\u6307\u4ee4\u6570\u548c\u6f5c\u5728\u7684\u8df3\u8f6c\u3002</li> </ul> </li> <li>\u4f5c\u7528: \u964d\u4f4e\u4e86\u52a8\u6001\u94fe\u63a5\u8c03\u7528\u7684\u5f00\u9500\u3002Fig. 9\u663e\u793a\uff0c\u5728Clang\u4e0a\u542f\u7528\u6240\u6709\u4f18\u5316\uff08\u5305\u542b\u6b64Pass\uff09\u540e\uff0cI-TLB misses\u6709\u663e\u8457\u4e0b\u964d\uff0c\u90e8\u5206\u539f\u56e0\u5373\u5728\u4e8e\u6b64\u3002</li> </ul> </li> </ul> <p>\u5143\u6570\u636e\u7ef4\u62a4\uff1aDWARF\u4e0eC++\u5f02\u5e38\u5904\u7406</p> <p>BOLT\u7684\u4e00\u4e2a\u5173\u952e\u6280\u672f\u6311\u6218\u662f\u5728\u91cd\u5199\u4ee3\u7801\u7684\u540c\u65f6\u4fdd\u6301\u7a0b\u5e8f\u7684\u53ef\u8c03\u8bd5\u6027\u548c\u6b63\u786e\u6027\u3002</p> <ul> <li>\u5b9e\u73b0\u539f\u7406: BOLT\u80fd\u591f\u89e3\u6790\u5e76\u66f4\u65b0DWARF\u8c03\u8bd5\u4fe1\u606f\u3002\u5b83\u5728\u5185\u90e8\u8868\u793a\u4e2d\u4e3a\u5173\u952e\u4f4d\u7f6e\uff08\u5982\u6808\u6307\u9488\u53d8\u5316\u5904\uff09\u4fdd\u7559Call Frame Information (CFI)\u7684\u5360\u4f4d\u7b26\u3002</li> <li>\u7b97\u6cd5\u6d41\u7a0b:<ul> <li>\u5728\u4ee3\u7801\u91cd\u6392\u548c\u62c6\u5206\u540e\uff0cBOLT\u6839\u636e\u65b0\u7684\u6307\u4ee4\u5e03\u5c40\u91cd\u5efa\u6240\u6709\u7684CFI\u6307\u4ee4\u3002</li> <li>\u5bf9\u4e8e\u5305\u542bC++ exceptions\u7684\u51fd\u6570\uff0cBOLT\u4f1a\u8bc6\u522b<code>callq</code>\u6307\u4ee4\u7684landing pad\uff08\u5f02\u5e38\u5904\u7406\u5165\u53e3\uff09\u6ce8\u89e3\uff0c\u5e76\u786e\u4fdd\u5728\u4ee3\u7801\u79fb\u52a8\u540e\uff0c\u5f02\u5e38\u5c55\u5f00\u5668\uff08unwinder\uff09\u4ecd\u80fd\u6b63\u786e\u627e\u5230\u5904\u7406\u7a0b\u5e8f\u3002</li> </ul> </li> <li>\u4f5c\u7528: \u786e\u4fdd\u4e86\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728\u53d1\u751f\u5f02\u5e38\u6216\u4f7f\u7528\u8c03\u8bd5\u5668\u65f6\u884c\u4e3a\u6b63\u786e\u3002Fig. 4\u5c55\u793a\u4e86BOLT\u5185\u90e8CFG\u5982\u4f55\u643a\u5e26\u8fd9\u4e9b\u5173\u952e\u5143\u6570\u636e\u3002</li> </ul> <p></p> <p>Fig. 4: Partial CFG dump for a function with C++ exceptions.</p> <p>\u4f18\u5316\u6548\u679c\u91cf\u5316\u5bf9\u6bd4</p> <p>\u4e0b\u8868\u603b\u7ed3\u4e86BOLT\u5728Clang\u57fa\u51c6\u6d4b\u8bd5\u4e0a\uff0c\u76f8\u5bf9\u4e8e\u4e0d\u540c\u7f16\u8bd1\u4f18\u5316\u7ea7\u522b\u6240\u5e26\u6765\u7684\u5173\u952e\u6307\u6807\u6539\u8fdb\u3002</p> \u4f18\u5316\u7ea7\u522b Taken Branches \u51cf\u5c11 I-TLB Misses \u51cf\u5c11 \u603b\u4f53\u6027\u80fd\u63d0\u5347 Baseline (\u65e0PGO/LTO) 69.8% \u663e\u8457 \u6700\u9ad8 20.4% PGO + LTO 44.3% \u663e\u8457 (All\u6a21\u5f0f) 15.0% <p>\u4f18\u5316\u4e92\u8865\u6027\u4e0e\u5c40\u9650\u6027</p> <ul> <li>\u4e92\u8865\u6027: BOLT\u7684\u4f18\u5316\u4e0e\u7f16\u8bd1\u671f\u7684FDO/PGO\u548cLTO\u662f\u4e92\u8865\u800c\u975e\u91cd\u53e0\u7684\u3002\u7f16\u8bd1\u5668\u5728IR\u5c42\u9762\u8fdb\u884c\u7684\u4f18\u5316\u53d7\u9650\u4e8e\u5c06\u4e8c\u8fdb\u5236\u5256\u6790\u6570\u636e\u6620\u5c04\u56de\u9ad8\u5c42\u8868\u793a\u7684\u7cbe\u5ea6\u635f\u5931\uff08\u5982Fig. 2\u6240\u793a\u7684\u5185\u8054\u540e\u5e03\u5c40\u56f0\u5883\uff09\u3002BOLT\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u64cd\u4f5c\uff0c\u89c4\u907f\u4e86\u8fd9\u4e00\u95ee\u9898\uff0c\u80fd\u505a\u51fa\u66f4\u7cbe\u786e\u7684\u5e03\u5c40\u51b3\u7b56\uff08\u5982Fig. 10\u6240\u793a\uff09\u3002</li> <li>\u5c40\u9650\u6027: BOLT\u65e0\u6cd5\u6267\u884c\u9ad8\u5c42\u8bed\u4e49\u4f18\u5316\uff08\u5982\u5faa\u73af\u53d8\u6362\u3001\u9ad8\u7ea7\u5185\u8054\uff09\u3002\u5b83\u7684\u4f18\u52bf\u9886\u57df\u4e25\u683c\u9650\u5b9a\u5728\u4f4e\u7ea7\u4ee3\u7801\u5e03\u5c40\u548c\u5fae\u67b6\u6784\u7279\u5b9a\u4f18\u5316\u4e0a\u3002\u56e0\u6b64\uff0c\u6700\u4f73\u5b9e\u8df5\u662f\u5c06BOLT\u4f5c\u4e3a\u73b0\u6709\u7f16\u8bd1\u4f18\u5316\u6d41\u7a0b\uff08PGO+LTO\uff09\u4e4b\u540e\u7684\u6700\u540e\u4e00\u73af\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#5","title":"5. \u91cd\u5b9a\u4f4d\u6a21\u5f0f\u4e0b\u7684\u5168\u7a0b\u5e8f\u91cd\u6392","text":"<p>\u5b9e\u73b0\u539f\u7406\u4e0e\u6838\u5fc3\u673a\u5236</p> <p>BOLT \u7684 \u91cd\u5b9a\u4f4d\u6a21\u5f0f (Relocations Mode) \u662f\u5176\u80fd\u591f\u6267\u884c\u5168\u7a0b\u5e8f\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u7684\u5173\u952e\u3002\u8be5\u6a21\u5f0f\u7684\u6838\u5fc3\u5728\u4e8e\u5229\u7528\u94fe\u63a5\u5668\u5728\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\u65f6\u4fdd\u7559\u7684 \u91cd\u5b9a\u4f4d\u4fe1\u606f (relocations)\u3002</p> <ul> <li>\u4f20\u7edf\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728\u94fe\u63a5\u540e\uff0c\u6240\u6709\u7b26\u53f7\u5f15\u7528\uff08\u5982\u51fd\u6570\u8c03\u7528\u3001\u5168\u5c40\u53d8\u91cf\u8bbf\u95ee\uff09\u90fd\u5df2\u88ab\u89e3\u6790\u4e3a\u56fa\u5b9a\u7684\u7edd\u5bf9\u5730\u5740\u6216\u76f8\u5bf9\u504f\u79fb\u91cf\uff0c\u539f\u59cb\u7684\u91cd\u5b9a\u4f4d\u8bb0\u5f55\u4f1a\u88ab\u4e22\u5f03\u3002\u8fd9\u4f7f\u5f97\u540e\u7eed\u7684\u4e8c\u8fdb\u5236\u91cd\u5199\u5668\u65e0\u6cd5\u5b89\u5168\u5730\u79fb\u52a8\u4ee3\u7801\u6bb5\uff0c\u56e0\u4e3a\u65e0\u6cd5\u8ffd\u8e2a\u548c\u4fee\u6b63\u6240\u6709\u6307\u5411\u88ab\u79fb\u52a8\u4ee3\u7801\u7684\u6307\u9488\u3002</li> <li>\u901a\u8fc7\u5728\u94fe\u63a5\u9636\u6bb5\u4f7f\u7528 <code>--emit-relocs</code> \u9009\u9879\uff08Gold \u6216 BFD \u94fe\u63a5\u5668\u5747\u652f\u6301\uff09\uff0c\u94fe\u63a5\u5668\u4f1a\u5c06\u8fd9\u4e9b\u91cd\u5b9a\u4f4d\u8bb0\u5f55\u4fdd\u7559\u5728\u6700\u7ec8\u7684 ELF \u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u3002\u8fd9\u4e9b\u8bb0\u5f55\u8be6\u7ec6\u8bf4\u660e\u4e86\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u54ea\u4e9b\u4f4d\u7f6e\u5305\u542b\u4e86\u9700\u8981\u6839\u636e\u7b26\u53f7\u6700\u7ec8\u5730\u5740\u8fdb\u884c\u4fee\u6b63\u7684\u5f15\u7528\u3002</li> <li>BOLT \u5728\u91cd\u5b9a\u4f4d\u6a21\u5f0f\u4e0b\uff0c\u9996\u5148\u4f1a\u89e3\u6790\u8fd9\u4e9b ELF \u91cd\u5b9a\u4f4d\u8868\u3002\u8fd9\u4e3a\u5176\u63d0\u4f9b\u4e86\u5bf9\u6574\u4e2a\u7a0b\u5e8f\u5730\u5740\u7a7a\u95f4\u7684\u201c\u5730\u56fe\u201d\uff0c\u4f7f\u5176\u80fd\u591f\u7cbe\u786e\u5730\u77e5\u9053\u4fee\u6539\u4efb\u610f\u4e00\u4e2a\u51fd\u6570\u6216\u6570\u636e\u6bb5\u7684\u4f4d\u7f6e\u540e\uff0c\u9700\u8981\u66f4\u65b0\u54ea\u4e9b\u5176\u4ed6\u4f4d\u7f6e\u7684\u6307\u4ee4\u6216\u6570\u636e\u3002</li> <li>\u5c3d\u7ba1\u91cd\u5b9a\u4f4d\u4fe1\u606f\u975e\u5e38\u5f3a\u5927\uff0c\u4f46\u5b83\u5e76\u975e\u4e07\u80fd\u3002\u8bba\u6587\u6307\u51fa\uff0c\u67d0\u4e9b\u7c7b\u578b\u7684\u5f15\u7528\uff08\u5982 PIC \u8df3\u8f6c\u8868 (PIC jump tables) \u7684\u76f8\u5bf9\u504f\u79fb\u3001\u540c\u4e00\u7f16\u8bd1\u5355\u5143\u5185 \u672c\u5730\u51fd\u6570 (local functions) \u7684\u8de8\u51fd\u6570\u5f15\u7528\uff09\u53ef\u80fd\u4e0d\u4f1a\u88ab\u5b8c\u6574\u8bb0\u5f55\u5728\u6807\u51c6\u7684\u91cd\u5b9a\u4f4d\u8868\u4e2d\u3002\u56e0\u6b64\uff0cBOLT \u5fc5\u987b\u7ed3\u5408 \u7cbe\u786e\u7684\u53cd\u6c47\u7f16 (disassembly) \u6765\u53d1\u73b0\u5e76\u5904\u7406\u8fd9\u4e9b\u201c\u9690\u85cf\u201d\u7684\u5f15\u7528\uff0c\u786e\u4fdd\u91cd\u5199\u7684\u6b63\u786e\u6027\u3002</li> </ul> <p></p> <p>Fig. 3: Diagram showing BOLT\u2019s binary rewriting pipeline.</p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5173\u952e\u64cd\u4f5c</p> <p>\u4e00\u65e6\u638c\u63e1\u4e86\u5b8c\u6574\u7684\u91cd\u5b9a\u4f4d\u4fe1\u606f\u548c\u7cbe\u786e\u7684\u63a7\u5236\u6d41\u56fe\uff08CFG\uff09\uff0cBOLT \u5c31\u53ef\u4ee5\u6267\u884c\u6fc0\u8fdb\u7684\u4ee3\u7801\u91cd\u6392\u548c\u91cd\u6784\u3002</p> <ul> <li>\u51fd\u6570\u7ea7\u91cd\u6392 (Function Reordering):</li> <li>BOLT \u4f7f\u7528 HFSort \u7b97\u6cd5\uff08\u4e00\u79cd\u57fa\u4e8e\u8c03\u7528\u56fe\u7684\u51fd\u6570\u5e03\u5c40\u7b97\u6cd5\uff09\u6765\u51b3\u5b9a\u51fd\u6570\u5728\u5185\u5b58\u4e2d\u7684\u6700\u4f18\u987a\u5e8f\u3002</li> <li>\u5176\u76ee\u6807\u662f\u6700\u5927\u5316 I-TLB (Instruction Translation Lookaside Buffer) \u548c I-cache (Instruction Cache) \u7684\u5c40\u90e8\u6027\uff0c\u5c06\u9891\u7e41\u76f8\u4e92\u8c03\u7528\u7684\u51fd\u6570\u653e\u7f6e\u5728\u76f8\u90bb\u7684\u5185\u5b58\u9875\u4e2d\u3002</li> <li> <p>\u91cd\u5b9a\u4f4d\u4fe1\u606f\u786e\u4fdd\u4e86\u6240\u6709\u8de8\u51fd\u6570\u7684\u8c03\u7528\u6307\u4ee4\uff08\u5982 <code>call</code>\uff09\u5728\u51fd\u6570\u88ab\u79fb\u52a8\u540e\uff0c\u5176\u76ee\u6807\u5730\u5740\u80fd\u88ab\u6b63\u786e\u66f4\u65b0\u3002</p> </li> <li> <p>\u51fd\u6570\u4f53\u62c6\u5206\u4e0e\u51b7\u70ed\u5206\u79bb (Function Splitting and Hot/Cold Separation):</p> </li> <li>\u8fd9\u662f\u91cd\u5b9a\u4f4d\u6a21\u5f0f\u5e26\u6765\u7684\u66f4\u6df1\u5c42\u6b21\u4f18\u5316\u3002BOLT \u4e0d\u4ec5\u80fd\u79fb\u52a8\u6574\u4e2a\u51fd\u6570\uff0c\u8fd8\u80fd\u5c06\u5355\u4e2a\u51fd\u6570\u5185\u90e8\u7684 \u57fa\u672c\u5757 (basic blocks) \u8fdb\u884c\u62c6\u5206\u3002</li> <li>\u57fa\u4e8e \u6837\u672c\u5206\u6790 (sample-based profiling) \u6570\u636e\uff0cBOLT \u8bc6\u522b\u51fa\u51fd\u6570\u5185\u7684 \u70ed\u8def\u5f84 (hot path) \u548c \u51b7\u8def\u5f84 (cold path)\u3002</li> <li>\u5b83\u5c06\u70ed\u8def\u5f84\u7684\u57fa\u672c\u5757\u7d27\u5bc6\u5730\u6392\u5217\u5728\u4e00\u8d77\uff0c\u5f62\u6210\u9ad8\u6548\u7684\u76f4\u7ebf\u4ee3\u7801\uff0c\u800c\u5c06\u5f88\u5c11\u6267\u884c\u7684\u51b7\u8def\u5f84\u4ee3\u7801\uff08\u5982\u9519\u8bef\u5904\u7406\u903b\u8f91\uff09\u79fb\u52a8\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5176\u4ed6\u533a\u57df\u3002</li> <li>\u8fd9\u79cd\u62c6\u5206\u6781\u5927\u5730\u6539\u5584\u4e86 I-cache \u7684\u5229\u7528\u7387\uff0c\u5e76\u51cf\u5c11\u4e86\u56e0\u8df3\u8f6c\u5230\u51b7\u4ee3\u7801\u800c\u5bfc\u81f4\u7684 \u5206\u652f\u9884\u6d4b\u5931\u8d25 (branch misprediction)\u3002</li> <li>\u91cd\u5b9a\u4f4d\u4fe1\u606f\u5728\u6b64\u8fc7\u7a0b\u4e2d\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4fee\u6b63\u6240\u6709\u6307\u5411\u88ab\u79fb\u52a8\u7684\u57fa\u672c\u5757\u7684\u8df3\u8f6c\u6307\u4ee4\uff08<code>jmp</code>, <code>je</code>, <code>jne</code> \u7b49\uff09\u3002</li> </ul> <p>\u8f93\u5165\u3001\u8f93\u51fa\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165:</li> <li>\u4e00\u4e2a\u5e26\u6709 <code>--emit-relocs</code> \u9009\u9879\u94fe\u63a5\u751f\u6210\u7684 ELF \u53ef\u6267\u884c\u6587\u4ef6\u3002</li> <li>\u4e00\u4efd\u7531 Linux perf \u7b49\u5de5\u5177\u6536\u96c6\u7684 \u6837\u672c\u5206\u6790\u6570\u636e (profile data)\uff0c\u901a\u5e38\u5305\u542b LBR (Last Branch Record) \u4fe1\u606f\u4ee5\u83b7\u5f97\u7cbe\u786e\u7684\u8fb9\u9891\u6b21\u3002</li> <li> <p>\u7528\u6237\u6307\u5b9a\u7684 BOLT \u4f18\u5316\u9009\u9879\uff08\u4f8b\u5982 <code>-reorder-functions=...</code>, <code>-split-all-cold</code>\uff09\u3002</p> </li> <li> <p>\u8f93\u51fa:</p> </li> <li>\u4e00\u4e2a\u7ecf\u8fc7 \u5168\u7a0b\u5e8f\u4ee3\u7801\u91cd\u6392\u548c\u91cd\u6784 \u7684\u65b0 ELF \u53ef\u6267\u884c\u6587\u4ef6\u3002</li> <li>\u8be5\u6587\u4ef6\u4e2d\u7684 \u51fd\u6570\u987a\u5e8f \u5df2\u88ab\u4f18\u5316\u3002</li> <li>\u8bb8\u591a\u51fd\u6570\u7684 \u5185\u90e8\u5e03\u5c40 \u5df2\u88ab\u91cd\u6784\uff0c\u70ed\u4ee3\u7801\u88ab\u96c6\u4e2d\uff0c\u51b7\u4ee3\u7801\u88ab\u5265\u79bb\u3002</li> <li>\u6240\u6709\u7684 \u91cd\u5b9a\u4f4d\u5f15\u7528 \u90fd\u5df2\u88ab\u66f4\u65b0\u4ee5\u53cd\u6620\u65b0\u7684\u4ee3\u7801\u5e03\u5c40\u3002</li> <li> <p>DWARF \u8c03\u8bd5\u4fe1\u606f \u548c CFI (Call Frame Information) \u4e5f\u5df2\u88ab\u540c\u6b65\u66f4\u65b0\uff0c\u4ee5\u4fdd\u8bc1\u8c03\u8bd5\u548c\u5f02\u5e38\u5904\u7406\u7684\u6b63\u5e38\u5de5\u4f5c\u3002</p> </li> <li> <p>\u5728 BOLT \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:</p> </li> <li>\u91cd\u5b9a\u4f4d\u6a21\u5f0f\u662f BOLT \u5b9e\u73b0\u5176\u6700\u5f3a\u5927\u4f18\u5316\uff08\u7279\u522b\u662f Pass 8: reorder and split hot/cold basic blocks \u548c Pass 12: reorder functions via HFSort\uff09\u7684\u524d\u63d0\u6761\u4ef6\u3002</li> <li>\u5982\u56fe3\u6240\u793a\u7684 \u91cd\u5199\u7ba1\u9053 (rewriting pipeline) \u4e2d\uff0c\u91cd\u5b9a\u4f4d\u4fe1\u606f\u7684\u5904\u7406\u8d2f\u7a7f\u4e8e \u51fd\u6570\u53d1\u73b0 (Function discovery)\u3001\u63a7\u5236\u6d41\u56fe\u6784\u5efa (CFG construction) \u4ee5\u53ca\u6700\u540e\u7684 \u4e8c\u8fdb\u5236\u53d1\u5c04 (Binary emission) \u9636\u6bb5\u3002</li> <li>\u5b83\u4f7f\u5f97 BOLT \u4ece\u4e00\u4e2a\u53ea\u80fd\u5728\u51fd\u6570\u5185\u90e8\u8fdb\u884c\u6709\u9650\u4f18\u5316\u7684\u5de5\u5177\uff0c\u8f6c\u53d8\u4e3a\u4e00\u4e2a\u62e5\u6709 \u5168\u7a0b\u5e8f\u89c6\u91ce (whole-program view) \u548c \u5b8c\u5168\u63a7\u5236\u6743 (full control) \u7684\u9759\u6001\u4e8c\u8fdb\u5236\u4f18\u5316\u5668\uff0c\u4ece\u800c\u80fd\u591f\u5b9e\u73b0\u8fdc\u8d85\u7f16\u8bd1\u5668\u548c\u94fe\u63a5\u5668\u7684\u4ee3\u7801\u5e03\u5c40\u6548\u679c\u3002\u6027\u80fd\u8bc4\u4f30\u6570\u636e\u663e\u793a\uff0c\u5bf9\u4e8e\u50cf HHVM \u548c Clang \u8fd9\u6837\u7684\u5927\u578b\u5e94\u7528\uff0c\u6b63\u662f\u8fd9\u4e9b\u57fa\u4e8e\u91cd\u5b9a\u4f4d\u6a21\u5f0f\u7684\u5e03\u5c40\u4f18\u5316\u5e26\u6765\u4e86\u9ad8\u8fbe 7.0% \u548c 15.0% \u7684\u663e\u8457\u6027\u80fd\u63d0\u5347\u3002</li> </ul>"},{"location":"notes_repo/bolt-a-practical-binary-optimizer-for-data-centers-and-beyond/paper_notes/#4_1","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u8bc4\u4f30\u5bf9\u8c61\uff1a</li> <li>Facebook \u6570\u636e\u4e2d\u5fc3\u5de5\u4f5c\u8d1f\u8f7d\uff1a\u5305\u62ec HHVM (PHP/Hack \u865a\u62df\u673a)\u3001TAO (\u5206\u5e03\u5f0f\u7f13\u5b58\u670d\u52a1)\u3001Proxygen (\u8d1f\u8f7d\u5747\u8861\u5668) \u548c Multifeed (\u65b0\u95fb\u6e90\u670d\u52a1)\u3002</li> <li>\u5f00\u6e90\u7f16\u8bd1\u5668\uff1aClang 7.0 \u548c GCC 8.2.0\u3002</li> <li>\u57fa\u7ebf\u914d\u7f6e\uff1a</li> <li>Facebook \u5de5\u4f5c\u8d1f\u8f7d\uff1a\u4f7f\u7528 GCC \u7f16\u8bd1\uff0c\u5e76\u5e94\u7528\u4e86\u57fa\u4e8e HFSort \u7684 function reordering\uff1bHHVM \u989d\u5916\u542f\u7528\u4e86 LTO\u3002</li> <li>Clang\uff1a\u6784\u5efa\u4e86\u56db\u79cd\u7248\u672c\u8fdb\u884c\u5bf9\u6bd4\uff1aBaseline\u3001PGO\u3001PGO+LTO\u3001\u4ee5\u53ca\u5728 PGO+LTO \u57fa\u7840\u4e0a\u5e94\u7528 BOLT\u3002</li> <li>GCC\uff1a\u6784\u5efa\u4e86\u56db\u79cd\u7248\u672c\uff1aBaseline\u3001PGO\u3001\u4ee5\u53ca\u5728\u5b83\u4eec\u57fa\u7840\u4e0a\u5e94\u7528 BOLT\u3002\u7531\u4e8e\u6784\u5efa\u9519\u8bef\uff0cGCC \u672a\u542f\u7528 LTO\u3002</li> <li>Profile \u6536\u96c6\uff1a</li> <li>\u4f7f\u7528 Linux <code>perf</code> \u5de5\u5177\u8fdb\u884c sample-based profiling\u3002</li> <li>\u4e3b\u8981\u91c7\u6837\u4e8b\u4ef6\u4e3a <code>cycles:u</code>\uff0c\u5e76\u7ed3\u5408 Intel Last Branch Records (LBR) \u6765\u83b7\u53d6\u7cbe\u786e\u7684\u5206\u652f\u8f68\u8ff9\u3002</li> <li>Profile \u6570\u636e\u901a\u8fc7 <code>perf2bolt</code> \u5de5\u5177\u8f6c\u6362\u4e3a BOLT \u53ef\u7528\u7684 YAML \u683c\u5f0f\u3002</li> <li>\u786c\u4ef6\u73af\u5883\uff1a</li> <li>\u8bc4\u4f30\u5728\u914d\u5907 Intel Xeon CPU (\u5982 E5-2680 v2, IvyBridge \u67b6\u6784) \u7684 Linux \u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u3002</li> <li>\u7cfb\u7edf\u5185\u5b58\u4e3a 32GiB \u6216 64GB\u3002</li> </ul> <p>\u7ed3\u679c\u6570\u636e</p> <ul> <li>Facebook \u5de5\u4f5c\u8d1f\u8f7d\u6027\u80fd\u63d0\u5347\uff1a</li> <li>\u5728\u5df2\u4f18\u5316\uff08HFSort + LTO for HHVM\uff09\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e0a\uff0cBOLT \u5e26\u6765\u4e86\u663e\u8457\u4e14\u4e00\u81f4\u7684\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u5e73\u5747\u901f\u5ea6\u63d0\u5347\u4e3a 5.1%\uff0c\u6700\u9ad8\u8fbe\u5230 7.0% (Multifeed2)\u3002</li> <li>HHVM \u83b7\u5f97\u4e86 6.8% \u7684\u63d0\u5347\uff0c\u8bc1\u660e\u5373\u4f7f\u5bf9\u4e8e\u5305\u542b\u5927\u91cf\u52a8\u6001\u751f\u6210\u4ee3\u7801\u7684\u5e94\u7528\uff0c\u4f18\u5316\u9759\u6001\u90e8\u5206\u4f9d\u7136\u6548\u679c\u663e\u8457\u3002</li> </ul> <p></p> <p>Fig. 5: Performance improvements from BOLT for our set of Facebook data-center workloads.</p> <ul> <li>\u5f00\u6e90\u7f16\u8bd1\u5668\u6027\u80fd\u63d0\u5347\uff1a</li> <li>Clang\uff1a\u5728 PGO+LTO \u7684\u57fa\u7840\u4e0a\uff0cBOLT \u8fdb\u4e00\u6b65\u5b9e\u73b0\u4e86 15.0% \u7684\u7f16\u8bd1\u901f\u5ea6\u63d0\u5347\u3002</li> <li>GCC\uff1a\u5728 PGO \u7684\u57fa\u7840\u4e0a\uff0cBOLT \u5b9e\u73b0\u4e86 7.45% \u7684\u901f\u5ea6\u63d0\u5347\u3002</li> <li>\u5f53\u4e8c\u8fdb\u5236\u6587\u4ef6\u672a\u7ecf\u8fc7 FDO/LTO \u4f18\u5316\u65f6\uff0cBOLT \u7684\u63d0\u5347\u66f4\u4e3a\u60ca\u4eba\uff0c\u5bf9 Clang \u6700\u9ad8\u53ef\u8fbe 52.1%\u3002</li> </ul> <p></p> <p>Fig. 6: Performance improvements for Clang.</p> <p></p> <p>Fig. 7: Performance improvements for GCC. LTO was not used due to build errors.</p> <ul> <li>\u5fae\u67b6\u6784\u6307\u6807\u6539\u8fdb (\u4ee5 Clang \u4e3a\u4f8b)\uff1a</li> <li>BOLT \u5728 PGO+LTO \u7684\u57fa\u7840\u4e0a\uff0c\u5c06 taken branches \u7684\u6570\u91cf\u51cf\u5c11\u4e86 44.3%\uff0c\u6781\u5927\u6539\u5584\u4e86 I-cache \u5c40\u90e8\u6027\u3002</li> </ul> <p></p> <p>TABLE II: Statistics reported by BOLT when applied to Clang\u2019s baseline and PGO+LTO binaries.</p> <p>\u6d88\u878d\u5b9e\u9a8c</p> <ul> <li>\u76ee\u7684\uff1a\u91cf\u5316 BOLT \u4e2d\u5404\u9879\u4f18\u5316\u6280\u672f\u5bf9\u6700\u7ec8\u6027\u80fd\u63d0\u5347\u7684\u8d21\u732e\u3002</li> <li>\u65b9\u6cd5\uff1a\u901a\u8fc7\u9010\u5c42\u5f00\u542f\u4e0d\u540c\u7684\u4f18\u5316\u7ec4\u5408\uff0c\u89c2\u5bdf\u5173\u952e\u5fae\u67b6\u6784\u6307\u6807\u7684\u53d8\u5316\u3002</li> <li>\u4e3b\u8981\u53d1\u73b0\uff1a</li> <li>\u57fa\u672c\u5757\u91cd\u6392\u5e8f (Basic-block reordering) \u548c \u51fd\u6570\u91cd\u6392\u5e8f (Function reordering) \u662f\u6700\u6838\u5fc3\u3001\u8d21\u732e\u6700\u5927\u7684\u4e24\u9879\u4f18\u5316\u3002</li> <li>\u5bf9\u4e8e HHVM\uff0c\u7ed3\u5408 huge pages \u53ef\u4ee5\u8fdb\u4e00\u6b65\u51cf\u5c11 I-TLB miss\u3002</li> <li>\u5bf9\u4e8e Clang\uff0cPLT call optimization \u5728\u201cAll\u201d\u6a21\u5f0f\u4e0b\u88ab\u6fc0\u6d3b\uff0c\u5bf9\u51cf\u5c11 I-TLB miss \u6709\u663e\u8457\u8d21\u732e\u3002</li> <li>\u5176\u4ed6\u4f18\u5316\u5982 identical code folding (ICF)\u3001indirect call promotion \u7b49\u4e5f\u63d0\u4f9b\u4e86\u53ef\u6d4b\u91cf\u7684\u589e\u76ca\uff0c\u4f46\u5f71\u54cd\u76f8\u5bf9\u8f83\u5c0f\u3002</li> </ul> <p></p> <p>Fig. 8: Breakdown of improvements on different metrics for HHVM (higher is better). ICF refers to identical code folding. Optimizations are always added on top of the previous bar, i.e., +BB reordering has function reordering, huge pages and basic block reordering all turned on.</p> <p></p> <p>Fig. 9: Breakdown of improvements on different metrics for Clang (higher is better). ICF refers to identical code folding. Optimizations are always added on top of the previous bar, i.e., +ICF includes BB reordering and ICF both turned on.</p> <ul> <li>\u4ee3\u7801\u5e03\u5c40\u5206\u6790\uff1a</li> <li>\u901a\u8fc7 <code>-report-bad-layout</code> \u9009\u9879\uff0c\u4f5c\u8005\u53d1\u73b0\u5373\u4f7f\u7ecf\u8fc7 PGO+LTO \u4f18\u5316\u7684 Clang \u4e8c\u8fdb\u5236\u4e2d\uff0c\u4ecd\u5b58\u5728\u5927\u91cf\u56e0 function inlining \u5bfc\u81f4\u7684\u6b21\u4f18\u5e03\u5c40\uff08\u70ed\u5757\u4e0e\u51b7\u5757\u4ea4\u9519\uff09\u3002</li> <li>BOLT \u80fd\u591f\u7cbe\u51c6\u8bc6\u522b\u8fd9\u4e9b\u95ee\u9898\u5e76\u8fdb\u884c\u4fee\u590d\u3002</li> </ul> <p></p> <p>Fig. 10: Real example of poor code layout produced by the Clang compiler (compiling itself) even with PGO. Block .LFT680413 is cold (Exec Count: 0), but it is placed between two hot blocks connected by a forward taken branch.</p> <ul> <li>LBR \u7684\u91cd\u8981\u6027\uff1a</li> <li>\u6d88\u878d\u5b9e\u9a8c\u8bc1\u660e\u4e86 LBR \u5bf9\u4e8e\u83b7\u53d6\u9ad8\u8d28\u91cf profile \u81f3\u5173\u91cd\u8981\uff0c\u5c24\u5176\u662f\u5728\u8fdb\u884c\u57fa\u672c\u5757\u7ea7\u522b\u7684\u91cd\u6392\u5e8f\u65f6\u3002</li> <li>\u76f8\u6bd4\u4e8e\u65e0 LBR \u7684\u91c7\u6837\uff0c\u4f7f\u7528 LBR \u53ef\u4ee5\u4e3a HHVM \u5e26\u6765\u7ea6 2% \u7684\u989d\u5916\u6027\u80fd\u6536\u76ca\u3002</li> <li>\u51fd\u6570\u91cd\u6392\u5e8f\u5bf9 LBR \u7684\u4f9d\u8d56\u76f8\u5bf9\u8f83\u4f4e\u3002</li> </ul> <p></p> <p>Fig. 12: Improvements on different metrics for HHVM by using LBRs (higher is better).</p> <p></p> <p>Fig. 11: Heat maps for instruction memory accesses of Clang binaries. Heat is in a log scale.</p>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/ELI5_notes/","title":"Feedback Directed Prefetching: Improving the Performance and Bandwidth-Efficiency of Hardware Prefetchers \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u786c\u4ef6 prefetcher\uff08\u9884\u53d6\u5668\uff09\u5c31\u50cf\u4e00\u4e2a\u83bd\u649e\u7684\u52a9\u624b\uff1a\u5b83\u8981\u4e48\u8fc7\u4e8e\u4fdd\u5b88\uff0c\u4e0d\u6562\u591a\u62ff\u6570\u636e\uff0c\u5bfc\u81f4 memory latency\uff08\u5185\u5b58\u5ef6\u8fdf\uff09\u65e0\u6cd5\u88ab\u6709\u6548\u9690\u85cf\uff1b\u8981\u4e48\u5c31\u8fc7\u4e8e\u6fc0\u8fdb\uff0c\u75af\u72c2\u5730\u4ece\u5185\u5b58\u62c9\u6570\u636e\u3002 - \u8fd9\u79cd\u201c\u6fc0\u8fdb\u201d\u4f1a\u5e26\u6765\u4e24\u5927\u707e\u96be\uff1a   - \u6d6a\u8d39\u5e26\u5bbd\uff1a\u5927\u91cf\u9884\u53d6\u7684\u6570\u636e\u6839\u672c\u6ca1\u7528\u4e0a\uff08\u4f4e accuracy\uff09\uff0c\u5374\u5360\u6ee1\u4e86\u5b9d\u8d35\u7684 memory bandwidth\uff08\u5185\u5b58\u5e26\u5bbd\uff09\uff0c\u751a\u81f3\u62d6\u6162\u4e86\u771f\u6b63\u9700\u8981\u7684 demand request\uff08\u9700\u6c42\u8bf7\u6c42\uff09\u3002   - \u6c61\u67d3\u7f13\u5b58\uff1a\u65e0\u7528\u7684\u9884\u53d6\u6570\u636e\u6324\u6389\u4e86\u672a\u6765\u4f1a\u7528\u5230\u7684\u6709\u6548\u6570\u636e\uff0c\u5bfc\u81f4 cache pollution\uff08\u7f13\u5b58\u6c61\u67d3\uff09\uff0c\u53cd\u800c\u5236\u9020\u4e86\u66f4\u591a cache miss\uff08\u7f13\u5b58\u7f3a\u5931\uff09\uff0c\u5f62\u6210\u6076\u6027\u5faa\u73af\u3002 - \u6700\u8981\u547d\u7684\u662f\uff0c\u8fd9\u79cd\u6fc0\u8fdb\u7b56\u7565\u5728\u67d0\u4e9b\u7a0b\u5e8f\u4e0a\uff08\u5982 <code>ammp</code>, <code>applu</code>\uff09\u4f1a\u8ba9\u6027\u80fd\u66b4\u8dcc\u8fd150%\uff0c\u8fd9\u8ba9\u82af\u7247\u8bbe\u8ba1\u8005\u4e0d\u5f97\u4e0d\u91c7\u7528\u4e00\u4e2a\u6298\u4e2d\u7684\u3001\u504f\u4fdd\u5b88\u7684\u7b56\u7565\uff0c\u4ece\u800c\u727a\u7272\u4e86\u5728\u5176\u4ed6\u7a0b\u5e8f\u4e0a\u672c\u53ef\u4ee5\u83b7\u5f97\u7684\u5de8\u5927\u6027\u80fd\u6536\u76ca\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08CPU\uff09\uff0c\u4f60\u7684\u529e\u516c\u684c\uff08L2 cache\uff09\u7a7a\u95f4\u6709\u9650\u3002\u6709\u4e2a\u5b9e\u4e60\u751f\uff08prefetcher\uff09\u8d1f\u8d23\u5e2e\u4f60\u4ece\u8fdc\u5904\u7684\u4e66\u5e93\uff08main memory\uff09\u62ff\u4e66\u3002 - \u4f20\u7edf\u505a\u6cd5\u662f\u7ed9\u5b9e\u4e60\u751f\u4e00\u4e2a\u6b7b\u547d\u4ee4\uff1a\u201c\u6bcf\u6b21\u770b\u5230\u6211\u67e5\u4e00\u672c\u4e66\uff0c\u4f60\u5c31\u5f80\u524d/\u5f80\u540e\u62ff4\u672c\uff08\u56fa\u5b9a aggressiveness\uff09\u3002\u201d - \u7ed3\u679c\u662f\uff1a\u5982\u679c\u6211\u5728\u8bfb\u4e00\u672c\u5c0f\u8bf4\uff08\u8bbf\u95ee\u6a21\u5f0f\u8fde\u7eed\uff09\uff0c\u8fd9\u62db\u5f88\u68d2\uff1b\u4f46\u5982\u679c\u6211\u5728\u67e5\u5b57\u5178\uff08\u8bbf\u95ee\u6a21\u5f0f\u968f\u673a\uff09\uff0c\u4ed6\u5c31\u4f1a\u628a\u4e00\u5806\u6ca1\u7528\u7684\u8bcd\u5178\u5806\u6ee1\u6211\u7684\u684c\u5b50\uff0c\u628a\u6211\u6b63\u5728\u7528\u7684\u90a3\u51e0\u9875\u90fd\u6324\u6389\u4e86\uff0c\u6211\u8fd8\u5f97\u82b1\u66f4\u5927\u529b\u6c14\u53bb\u7ffb\u627e\uff0c\u6548\u7387\u6781\u4f4e\u3002 - Feedback Directed Prefetching (FDP) \u7684\u6838\u5fc3\u601d\u60f3\u662f\uff1a\u8ba9\u5b9e\u4e60\u751f\u53d8\u5f97\u201c\u806a\u660e\u201d\u4e00\u70b9\u3002\u4ed6\u4e0d\u518d\u6b7b\u5b88\u547d\u4ee4\uff0c\u800c\u662f\u4f1a\u89c2\u5bdf\uff1a   - \u6211\u62ff\u5230\u4ed6\u62ff\u7684\u4e66\u540e\uff0c\u662f\u4e0d\u662f\u771f\u7684\u7528\u4e86\uff1f\uff08accuracy\uff09   - \u4ed6\u62ff\u7684\u4e66\u662f\u4e0d\u662f\u592a\u665a\u4e86\uff0c\u7b49\u6211\u6025\u7740\u7528\u65f6\u8fd8\u6ca1\u5230\uff1f\uff08lateness/timeliness\uff09   - \u4ed6\u62ff\u7684\u4e66\u662f\u4e0d\u662f\u628a\u6211\u7684\u91cd\u8981\u7b14\u8bb0\u90fd\u5f04\u4e22\u4e86\uff1f\uff08cache pollution\uff09 - \u57fa\u4e8e\u8fd9\u4e9b\u5b9e\u65f6\u53cd\u9988\uff0c\u4ed6\u4f1a\u52a8\u6001\u8c03\u6574\u81ea\u5df1\u7684\u884c\u4e3a\uff1a\u8be5\u591a\u62ff\u65f6\u591a\u62ff\uff0c\u8be5\u5c11\u62ff\u65f6\u5c11\u62ff\uff0c\u751a\u81f3\u51b3\u5b9a\u628a\u65b0\u62ff\u6765\u7684\u4e66\u5148\u653e\u5728\u684c\u5b50\u7684\u54ea\u4e2a\u4f4d\u7f6e\uff08\u662f\u653e\u6700\u4e0a\u9762MRU\u8fd8\u662f\u5feb\u4e22\u6389\u7684LRU\uff09\uff0c\u4ee5\u6700\u5c0f\u5316\u5bf9\u6211\u7684\u5e72\u6270\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u6ca1\u6709\u53d1\u660e\u4e00\u79cd\u5168\u65b0\u7684\u9884\u53d6\u7b97\u6cd5\uff0c\u800c\u662f\u5728\u73b0\u6709\u7684\u4e3b\u6d41\u9884\u53d6\u5668\uff08\u5982 stream prefetcher, GHB-based prefetcher\uff09\u4e4b\u4e0a\uff0c\u5de7\u5999\u5730\u589e\u52a0\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 feedback loop\uff08\u53cd\u9988\u56de\u8def\uff09\u3002 - \u8fd9\u4e2a\u56de\u8def\u901a\u8fc7\u51e0\u4e2a\u7cbe\u5de7\u7684\u786c\u4ef6\u8ba1\u6570\u5668\u548c\u4e00\u4e2a Bloom filter\uff08\u7528\u4e8e\u4f4e\u6210\u672c\u4f30\u7b97\u7f13\u5b58\u6c61\u67d3\uff09\uff0c\u5728\u8fd0\u884c\u65f6\u6301\u7eed\u76d1\u63a7\u4e09\u4e2a\u6838\u5fc3\u6307\u6807\uff1aaccuracy, lateness, \u548c pollution\u3002 - \u57fa\u4e8e\u8fd9\u4e9b\u6307\u6807\uff0cFDP \u52a8\u6001\u5730\u505a\u4e24\u4ef6\u4e8b\uff1a   - \u8c03\u6574\u9884\u53d6\u6fc0\u8fdb\u5ea6\uff1a\u901a\u8fc7\u4e00\u4e2a\u9971\u548c\u8ba1\u6570\u5668\uff08Dynamic Configuration Counter\uff09\u6765\u52a8\u6001\u6539\u53d8 Prefetch Distance \u548c Prefetch Degree\u3002\u4f8b\u5982\uff0c\u5f53\u68c0\u6d4b\u5230\u9ad8\u6c61\u67d3\u65f6\uff0c\u5c31\u7acb\u523b\u964d\u4f4e\u6fc0\u8fdb\u5ea6\u3002</p> <p></p> <ul> <li>\u8c03\u6574\u7f13\u5b58\u63d2\u5165\u7b56\u7565\uff1a\u4e0d\u518d\u603b\u662f\u628a\u9884\u53d6\u7684\u6570\u636e\u5757\u653e\u5230 MRU\uff08\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u6808\u9876\uff09\u3002\u800c\u662f\u6839\u636e\u6c61\u67d3\u7a0b\u5ea6\uff0c\u667a\u80fd\u5730\u9009\u62e9\u63d2\u5165\u5230 MID, LRU-4 \u6216 LRU \u4f4d\u7f6e\u3002\u8fd9\u6837\uff0c\u53ef\u7591\u7684\u9884\u53d6\u6570\u636e\u4e0d\u4f1a\u9738\u5360\u7f13\u5b58\u592a\u4e45\uff0c\u51cf\u5c11\u4e86\u6c61\u67d3\u98ce\u9669\u3002</li> <li>\u8fd9\u5957\u673a\u5236\u7684\u6210\u672c\u6781\u4f4e\uff08\u4ec5 2.54 KB \u989d\u5916\u5b58\u50a8\uff09\uff0c\u5374\u5e26\u6765\u4e86\u663e\u8457\u7684\u6536\u76ca\uff1a\u5728 SPEC CPU2000 \u6d4b\u8bd5\u4e2d\uff0c\u76f8\u6bd4\u6700\u597d\u7684\u4f20\u7edf\u914d\u7f6e\uff0c\u5e73\u5747\u6027\u80fd\u63d0\u5347 6.5%\uff0c\u540c\u65f6 \u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u51cf\u5c11 18.7%\uff0c\u5e76\u4e14\u5b8c\u5168\u6d88\u9664\u4e86\u5728 <code>ammp</code> \u548c <code>applu</code> \u7b49\u7a0b\u5e8f\u4e0a\u7684\u6027\u80fd\u5012\u9000\u3002</li> </ul> <p></p> <p>Table 5. Average IPC and BPKI for FDP vs conventional prefetchers</p>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/ELI5_notes/#1-eli5","title":"1. \u52a8\u6001\u53cd\u9988\u9a71\u52a8\u7684\u9884\u53d6\u5668\u6fc0\u8fdb\u5ea6\u8c03\u6574 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 stream prefetcher\uff09\u7684\u6fc0\u8fdb\u5ea6\uff08\u7531 Prefetch Distance \u548c Prefetch Degree \u51b3\u5b9a\uff09\u662f\u9759\u6001\u7684\uff0c\u5728\u82af\u7247\u8bbe\u8ba1\u65f6\u5c31\u56fa\u5b9a\u6b7b\u4e86\u3002 - \u8fd9\u5bfc\u81f4\u4e86\u4e00\u4e2a\u975e\u5e38\u96be\u53d7\u7684\u5c40\u9762\uff1a\u5bf9\u4e8e\u67d0\u4e9b\u7a0b\u5e8f\uff08\u5982 <code>mgrid</code>\uff09\uff0c\u6fc0\u8fdb\u7684\u9884\u53d6\u80fd\u5e26\u6765\u5de8\u5927\u6027\u80fd\u63d0\u5347\uff1b\u4f46\u5bf9\u4e8e\u53e6\u4e00\u4e9b\u7a0b\u5e8f\uff08\u5982 <code>ammp</code>, <code>applu</code>\uff09\uff0c\u540c\u6837\u7684\u6fc0\u8fdb\u7b56\u7565\u4f1a\u56e0\u4e3a\u4ea7\u751f\u5927\u91cf\u65e0\u7528\u9884\u53d6 (useless prefetches) \u800c\u4e25\u91cd\u62d6\u7d2f\u6027\u80fd\u3002 - \u8fd9\u4e9b\u65e0\u7528\u9884\u53d6\u4e3b\u8981\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u9020\u6210\u4f24\u5bb3\uff1a   - \u6d6a\u8d39\u5185\u5b58\u5e26\u5bbd\uff1a\u5b9d\u8d35\u7684\u603b\u7ebf\u8d44\u6e90\u88ab\u65e0\u7528\u6570\u636e\u5360\u636e\uff0c\u5bfc\u81f4\u771f\u6b63\u7684demand request\uff08\u7a0b\u5e8f\u5b9e\u9645\u9700\u8981\u7684\u6570\u636e\uff09\u88ab\u5ef6\u8fdf\u3002   - \u5f15\u53d1\u7f13\u5b58\u6c61\u67d3 (cache pollution)\uff1a\u65e0\u7528\u7684\u9884\u53d6\u6570\u636e\u6324\u5360\u4e86 L2 \u7f13\u5b58\u7a7a\u95f4\uff0c\u628a\u672a\u6765\u771f\u6b63\u4f1a\u7528\u5230\u7684\u6570\u636e\u7ed9\u8e22\u51fa\u53bb\u4e86\uff0c\u53cd\u800c\u5236\u9020\u4e86\u66f4\u591a cache miss\u3002 - \u56e0\u6b64\uff0c\u82af\u7247\u5382\u5546\u4e3a\u4e86\u201c\u6c42\u7a33\u201d\uff0c\u5f80\u5f80\u53ea\u80fd\u91c7\u7528\u4e00\u4e2a\u6298\u4e2d\u504f\u4fdd\u5b88\u7684\u9ed8\u8ba4\u914d\u7f6e\uff0c\u727a\u7272\u4e86\u5728\u53cb\u597d\u7a0b\u5e8f\u4e0a\u672c\u53ef\u4ee5\u83b7\u5f97\u7684\u5de8\u5927\u6536\u76ca\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08\u9884\u53d6\u5668\uff09\uff0c\u8d1f\u8d23\u4e3a\u4e00\u4f4d\u6b63\u5728\u5199\u8bba\u6587\u7684\u7814\u7a76\u5458\uff08CPU\uff09\u63d0\u524d\u4ece\u4e66\u5e93\uff08\u4e3b\u5b58\uff09\u62ff\u4e66\uff08\u6570\u636e\u5757\uff09\u653e\u5230\u4ed6\u7684\u684c\u4e0a\uff08L2 \u7f13\u5b58\uff09\u3002 - \u4ee5\u524d\u7684\u505a\u6cd5\u662f\uff0c\u4f60\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u201c\u670d\u52a1\u5957\u9910\u201d\uff1a\u8981\u4e48\u6bcf\u6b21\u53ea\u62ff1\u672c\u4e66\uff08\u4fdd\u5b88\uff09\uff0c\u8981\u4e48\u4e00\u6b21\u62ff4\u672c\u5e76\u4e14\u63d0\u524d\u770b\u597d\u51e0\u7ae0\u7684\u5185\u5bb9\uff08\u6fc0\u8fdb\uff09\u3002 - \u95ee\u9898\u5728\u4e8e\uff0c\u7814\u7a76\u5458\u4eca\u5929\u53ef\u80fd\u5728\u7cbe\u8bfb\u4e00\u672c\u5f88\u96be\u7684\u4e66\uff08\u50cf <code>ammp</code>\uff09\uff0c\u4ed6\u7ffb\u9875\u5f88\u6162\uff0c\u4f60\u62ff\u592a\u591a\u4e66\u53ea\u4f1a\u5806\u6ee1\u4ed6\u7684\u684c\u5b50\uff0c\u628a\u4ed6\u624b\u8fb9\u91cd\u8981\u7684\u8349\u7a3f\u7eb8\u90fd\u6324\u6389\u4e86\u3002\u4f46\u660e\u5929\u4ed6\u53ef\u80fd\u5728\u5feb\u901f\u67e5\u9605\u8d44\u6599\uff08\u50cf <code>mgrid</code>\uff09\uff0c\u7ffb\u9875\u98de\u5feb\uff0c\u5982\u679c\u4f60\u4e0d\u63d0\u524d\u591a\u62ff\u70b9\uff0c\u4ed6\u5c31\u4f1a\u4e00\u76f4\u7b49\u7740\u4f60\u8dd1\u817f\u800c\u505c\u5de5\u3002 - Feedback Directed Prefetching (FDP) \u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\uff0c\u4f60\u4e0d\u518d\u6b7b\u5b88\u4e00\u4e2a\u5957\u9910\uff0c\u800c\u662f\u8fb9\u670d\u52a1\u8fb9\u89c2\u5bdf\uff1a   - \u4f60\u6570\u4e00\u6570\u4f60\u62ff\u7684\u4e66\u91cc\uff0c\u6709\u591a\u5c11\u672c\u4ed6\u771f\u7684\u7528\u4e0a\u4e86\uff08\u51c6\u786e\u7387\uff09\u3002   - \u4f60\u7559\u610f\u4ed6\u662f\u4e0d\u662f\u7ecf\u5e38\u5728\u4f60\u53bb\u62ff\u4e66\u7684\u8def\u4e0a\u5c31\u6025\u7740\u8981\u90a3\u672c\u4e66\u4e86\uff08\u53ca\u65f6\u6027/lateness\uff09\u3002   - \u4f60\u8fd8\u6ce8\u610f\u4ed6\u7684\u684c\u5b50\u4e0a\u662f\u4e0d\u662f\u56e0\u4e3a\u4f60\u62ff\u7684\u4e66\u592a\u591a\uff0c\u5bfc\u81f4\u4ed6\u627e\u4e0d\u5230\u81ea\u5df1\u521a\u5199\u7684\u7b14\u8bb0\u4e86\uff08\u7f13\u5b58\u6c61\u67d3\uff09\u3002 - \u6839\u636e\u8fd9\u4e9b\u5b9e\u65f6\u53cd\u9988\uff0c\u4f60\u52a8\u6001\u5730\u51b3\u5b9a\u4e0b\u6b21\u662f\u8be5\u5c11\u62ff\u70b9\u3001\u591a\u62ff\u70b9\uff0c\u8fd8\u662f\u6539\u53d8\u653e\u4e66\u7684\u4f4d\u7f6e\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u6ca1\u6709\u91cd\u65b0\u53d1\u660e\u9884\u53d6\u7b97\u6cd5\uff0c\u800c\u662f\u5728\u73b0\u6709\u9884\u53d6\u5668\u7684\u5de5\u4f5c\u6d41\u7a0b\u4e2d\uff0c\u5de7\u5999\u5730\u63d2\u5165\u4e86\u4e00\u5957\u8f7b\u91cf\u7ea7\u7684\u201c\u76d1\u63a7-\u51b3\u7b56\u201d\u53cd\u9988\u56de\u8def\u3002 - \u76d1\u63a7\u73af\u8282\uff1a\u901a\u8fc7\u51e0\u4e2a\u4f4e\u6210\u672c\u7684\u786c\u4ef6\u8ba1\u6570\u5668\u548c\u4e00\u4e2a\u57fa\u4e8e Bloom filter \u7684\u6c61\u67d3\u4f30\u7b97\u5668\uff0c\u5728\u8fd0\u884c\u65f6\u6301\u7eed\u6536\u96c6\u4e09\u4e2a\u6838\u5fc3\u6307\u6807\uff1a   - \u51c6\u786e\u7387 (Accuracy)\uff1a\u901a\u8fc7\u7ed9\u9884\u53d6\u5757\u6253 <code>pref-bit</code> \u6807\u7b7e\uff0c\u5e76\u7edf\u8ba1\u88ab demand \u8bbf\u95ee\u7684\u6b21\u6570\u6765\u8ba1\u7b97\u3002   - \u53ca\u65f6\u6027 (Lateness)\uff1a\u901a\u8fc7\u68c0\u67e5 MSHR\uff08Miss Status Holding Register\uff09\u6765\u5224\u65ad demand \u8bf7\u6c42\u662f\u5426\u5728\u9884\u53d6\u8bf7\u6c42\u5b8c\u6210\u524d\u5c31\u5230\u8fbe\u4e86\u3002   - \u7f13\u5b58\u6c61\u67d3 (Pollution)\uff1a\u4f7f\u7528\u4e00\u4e2a 4096-entry bit vector \u6765\u8fd1\u4f3c\u8ffd\u8e2a\u56e0\u9884\u53d6\u800c\u88ab\u8e22\u51fa\u7684\u6709\u7528\u6570\u636e\u5757\u3002 - \u51b3\u7b56\u73af\u8282\uff1a\u7cfb\u7edf\u4ee5\u91c7\u6837\u95f4\u9694\uff08\u57fa\u4e8e L2 \u7f13\u5b58\u9a71\u9010\u6b21\u6570\u5b9a\u4e49\uff09\u4e3a\u5468\u671f\uff0c\u6839\u636e\u8fd9\u4e09\u4e2a\u6307\u6807\u7684\u5f53\u524d\u503c\u4e0e\u9884\u8bbe\u9608\u503c\u7684\u6bd4\u8f83\u7ed3\u679c\uff0c\u67e5\u4e00\u5f20\u7b80\u5355\u7684\u51b3\u7b56\u8868\uff08\u89c1\u4e0b\u8868\uff09\uff0c\u6765\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u7684\u914d\u7f6e\u3002 - \u6700\u7ec8\uff0c\u8fd9\u4e2a\u673a\u5236\u5c06\u4e00\u4e2a\u9759\u6001\u7684\u3001\u4e00\u5200\u5207\u7684\u9884\u53d6\u5668\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u80fd\u611f\u77e5\u73af\u5883\u3001\u81ea\u6211\u8c03\u8282\u7684\u667a\u80fd\u4ee3\u7406\u3002</p> <p></p> <p>\u9664\u4e86\u8c03\u6574\u6fc0\u8fdb\u5ea6\uff0cFDP \u8fd8\u6709\u4e00\u62db\u5999\u68cb\uff1a\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5757\u5728 LRU \u6808\u4e2d\u7684\u63d2\u5165\u4f4d\u7f6e\u3002 - \u4f20\u7edf\u505a\u6cd5\u662f\u628a\u6240\u6709\u9884\u53d6\u5757\u90fd\u63d2\u5230 MRU\uff08Most Recently Used\uff09\u4f4d\u7f6e\uff0c\u8fd9\u5728\u9884\u53d6\u51c6\u786e\u65f6\u5f88\u597d\uff0c\u4f46\u5728\u4e0d\u51c6\u65f6\u4f1a\u52a0\u5267\u6c61\u67d3\u3002 - FDP \u6839\u636e\u4f30\u7b97\u7684\u6c61\u67d3\u7a0b\u5ea6\uff0c\u51b3\u5b9a\u662f\u63d2\u5230 MID\u3001LRU-4 \u8fd8\u662f\u76f4\u63a5\u63d2\u5230 LRU \u4f4d\u7f6e\u3002\u6c61\u67d3\u8d8a\u4e25\u91cd\uff0c\u9884\u53d6\u5757\u7684\u201c\u521d\u59cb\u5bff\u547d\u201d\u5c31\u8d8a\u77ed\uff0c\u4ece\u800c\u81ea\u52a8\u964d\u4f4e\u4e86\u5176\u5bf9\u7f13\u5b58\u7684\u5e72\u6270\u3002</p> <p>\u6700\u7ec8\u6548\u679c\u975e\u5e38\u663e\u8457\uff1a\u76f8\u6bd4\u6700\u597d\u7684\u9759\u6001\u6fc0\u8fdb\u914d\u7f6e\uff0cFDP \u5728 SPEC CPU2000 \u7684 17 \u4e2a\u5185\u5b58\u5bc6\u96c6\u578b benchmark \u4e0a\uff0c\u5e73\u5747\u6027\u80fd\u63d0\u5347 6.5%\uff0c\u540c\u65f6\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u964d\u4f4e 18.7%\u3002\u66f4\u91cd\u8981\u7684\u662f\uff0c\u5b83\u5f7b\u5e95\u6d88\u9664\u4e86\u5728 <code>ammp</code> \u548c <code>applu</code> \u7b49\u7a0b\u5e8f\u4e0a\u7684\u5de8\u5927\u6027\u80fd\u635f\u5931\u3002</p> \u914d\u7f6e \u5e73\u5747 IPC BPKI (\u5e26\u5bbd) Very Aggressive (\u4f20\u7edf) 1.00x 1.00x FDP (\u672c\u6587) 1.065x 0.813x Middle-of-the-Road (\u4f20\u7edf) 0.945x 0.821x <p></p> <p>Table 5. Average IPC and BPKI for FDP vs conventional prefetchers</p>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/ELI5_notes/#2-eli5","title":"2. \u57fa\u4e8e\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u9884\u53d6\u7f13\u5b58\u6c61\u67d3\u4f30\u7b97 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <p>\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\uff08Prefetcher\uff09\u662f\u4e2a\u5178\u578b\u7684\u201c\u597d\u5fc3\u529e\u574f\u4e8b\u201d\u7684\u89d2\u8272\u3002\u5b83\u4e3a\u4e86\u52a0\u901f\u7a0b\u5e8f\uff0c\u4f1a\u63d0\u524d\u628a\u6570\u636e\u62c9\u8fdb\u7f13\u5b58\u3002\u4f46\u5982\u679c\u9884\u6d4b\u9519\u4e86\uff0c\u6216\u8005\u62c9\u5f97\u592a\u65e9\uff0c\u8fd9\u4e9b\u6ca1\u7528\u7684\u9884\u53d6\u6570\u636e\u5c31\u4f1a\u628a\u771f\u6b63\u9700\u8981\u7684\u9700\u6c42\u5757\uff08demand block\uff09\u7ed9\u6324\u51fa\u53bb\uff0c\u8fd9\u5c31\u662f\u9884\u53d6\u5668\u9020\u6210\u7684\u7f13\u5b58\u6c61\u67d3\uff08Prefetcher-Generated Cache Pollution\uff09\u3002\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6700\u76f4\u63a5\u7684\u60f3\u6cd5\u662f\uff1a\u7cbe\u786e\u8ffd\u8e2a\u6bcf\u4e00\u4e2a\u88ab\u9884\u53d6\u5757\u6324\u51fa\u53bb\u7684\u9700\u6c42\u5757\uff0c\u5e76\u5728\u540e\u7eed\u53d1\u751f\u7f3a\u5931\u65f6\uff0c\u5224\u65ad\u8fd9\u4e2a\u7f3a\u5931\u662f\u4e0d\u662f\u9884\u53d6\u5668\u7684\u9505\u3002</p> <ul> <li>\u4f46\u8fd9\u5728\u786c\u4ef6\u4e0a\u51e0\u4e4e\u4e0d\u53ef\u80fd\u5b9e\u73b0\u3002\u4f60\u9700\u8981\u4e00\u4e2a\u5de8\u5927\u7684\u8868\u6765\u8bb0\u5f55\u6240\u6709\u88ab\u9a71\u9010\u5757\u7684\u5386\u53f2\uff0c\u8fd9\u4f1a\u5e26\u6765\u65e0\u6cd5\u627f\u53d7\u7684\u5b58\u50a8\u5f00\u9500\u548c\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> <li>\u786c\u4ef6\u8bbe\u8ba1\u8ffd\u6c42\u7684\u662f\u4f4e\u6210\u672c\u3001\u9ad8\u6548\u7387\u7684\u8fd1\u4f3c\u65b9\u6848\uff0c\u800c\u4e0d\u662f\u5b8c\u7f8e\u7684\u7cbe\u786e\u8ba1\u7b97\u3002\u6240\u4ee5\uff0c\u6838\u5fc3\u75db\u70b9\u5728\u4e8e\uff1a\u5982\u4f55\u7528\u6781\u5c0f\u7684\u786c\u4ef6\u4ee3\u4ef7\uff0c\u5bf9\u8fd9\u79cd\u201c\u56e0\u679c\u5173\u7cfb\u201d\uff08\u9884\u53d6\u5bfc\u81f4\u4e86\u540e\u7eed\u7f3a\u5931\uff09\u505a\u51fa\u4e00\u4e2a\u8db3\u591f\u597d\u7684\u4f30\u7b97\uff1f</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9</p> <p>\u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08Cache Controller\uff09\uff0c\u4f60\u7684\u4e66\u67b6\uff08Cache\uff09\u7a7a\u95f4\u6709\u9650\u3002\u6709\u4e2a\u70ed\u5fc3\u4f46\u6709\u70b9\u83bd\u649e\u7684\u52a9\u624b\uff08Prefetcher\uff09\u4f1a\u4e0d\u65ad\u628a\u65b0\u4e66\uff08\u9884\u53d6\u5757\uff09\u585e\u5230\u4e66\u67b6\u4e0a\uff0c\u6709\u65f6\u4f1a\u4e0d\u5c0f\u5fc3\u628a\u4f60\u6807\u8bb0\u8fc7\u201c\u91cd\u8981\u201d\u7684\u4e66\uff08\u9700\u6c42\u5757\uff09\u6254\u5230\u5e9f\u7eb8\u7bd3\u91cc\u3002</p> <p>\u4f60\u60f3\u77e5\u9053\u8fd9\u4e2a\u52a9\u624b\u5230\u5e95\u95ef\u4e86\u591a\u5c11\u7978\u3002\u4f46\u4f60\u6ca1\u6709\u7cbe\u529b\u53bb\u8bb0\u4f4f\u6bcf\u4e00\u672c\u88ab\u6254\u6389\u7684\u4e66\u7684\u540d\u5b57\uff08\u7cbe\u786e\u8ffd\u8e2a\u6210\u672c\u592a\u9ad8\uff09\u3002</p> <p>\u4e8e\u662f\uff0c\u4f60\u53d1\u660e\u4e86\u4e00\u4e2a\u5de7\u5999\u7684\u529e\u6cd5\uff1a - \u4f60\u51c6\u5907\u4e86\u4e00\u5f20\u5de8\u5927\u7684\u6253\u5b54\u5361\u7247\uff08\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u4f4d\u5411\u91cf\uff09\u3002 - \u6bcf\u5f53\u52a9\u624b\u628a\u4e00\u672c\u201c\u91cd\u8981\u201d\u7684\u4e66\u6254\u6389\u65f6\uff0c\u4f60\u5c31\u6839\u636e\u8fd9\u672c\u4e66\u7684\u4e66\u540d\uff0c\u7528\u51e0\u4e2a\u4e0d\u540c\u7684\u54c8\u5e0c\u51fd\u6570\u7b97\u51fa\u51e0\u4e2a\u4f4d\u7f6e\uff0c\u5728\u5361\u7247\u4e0a\u628a\u5bf9\u5e94\u7684\u5b54\u6253\u7a7f\uff08\u5c06\u4f4d\u5411\u91cf\u4e2d\u7684\u5bf9\u5e94bit\u7f6e1\uff09\u3002 - \u8fc7\u4e86\u4e00\u4f1a\u513f\uff0c\u6709\u8bfb\u8005\u6765\u501f\u4e00\u672c\u4e66\uff08\u53d1\u751f\u9700\u6c42\u7f3a\u5931\uff09\uff0c\u4f60\u5148\u4e0d\u6025\u7740\u53bb\u4ed3\u5e93\u627e\uff0c\u800c\u662f\u5148\u62ff\u8fd9\u672c\u4e66\u7684\u4e66\u540d\u53bb\u4f60\u7684\u6253\u5b54\u5361\u7247\u4e0a\u201c\u9a8c\u4e00\u9a8c\u201d\u3002 - \u5982\u679c\u5361\u7247\u4e0a\u5bf9\u5e94\u7684\u6240\u6709\u5b54\u90fd\u5df2\u7ecf\u88ab\u6253\u7a7f\u4e86\uff08\u6240\u6709bit\u90fd\u662f1\uff09\uff0c\u4f60\u5c31\u9ad8\u5ea6\u6000\u7591\u8fd9\u672c\u4e66\u4e4b\u524d\u5c31\u662f\u88ab\u4f60\u7684\u83bd\u649e\u52a9\u624b\u6254\u6389\u7684\uff01\u867d\u7136\u5076\u5c14\u4f1a\u6709\u8bef\u5224\uff08\u522b\u7684\u4e66\u4e5f\u6070\u597d\u6253\u7a7f\u4e86\u8fd9\u51e0\u4e2a\u5b54\uff09\uff0c\u4f46\u8fd9\u4e2a\u65b9\u6cd5\u80fd\u8ba9\u4f60\u7528\u4e00\u5f20\u8584\u8584\u7684\u5361\u7247\uff0c\u5c31\u5bf9\u52a9\u624b\u7684\u201c\u7834\u574f\u529b\u201d\u6709\u4e00\u4e2a\u76f8\u5f53\u9760\u8c31\u7684\u4f30\u8ba1\u3002</p> <p></p> <p>Figure 3. IPC performance (left) and prefetch lateness (right) with different aggressiveness configurations Figure 4. Filter to estimate prefetcher-generated cache pollution</p> <p>\u5173\u952e\u4e00\u62db</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u53bb\u5b8c\u7f8e\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u88ab\u9a71\u9010\u5757\u7684\u5b8c\u6574\u5730\u5740\u5386\u53f2\uff0c\u800c\u662f\u5de7\u5999\u5730\u5229\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\uff08Bloom Filter\uff09\u8fd9\u4e00\u6982\u7387\u6570\u636e\u7ed3\u6784\uff0c\u5c06\u201c\u56e0\u679c\u8ffd\u8e2a\u201d\u95ee\u9898\u8f6c\u6362\u6210\u4e86\u4e00\u4e2a\u201c\u5b58\u5728\u6027\u67e5\u8be2\u201d\u95ee\u9898\u3002</p> <ul> <li>\u66ff\u6362\u7684\u64cd\u4f5c\uff1a\u7528\u4e00\u4e2a4096-entry\u7684\u4f4d\u5411\u91cf\uff08bit-vector\uff09\u66ff\u6362\u4e86\u90a3\u4e2a\u7406\u8bba\u4e0a\u9700\u8981\u65e0\u9650\u5927\u7684\u9a71\u9010\u5757\u5386\u53f2\u8bb0\u5f55\u8868\u3002</li> <li>\u626d\u8f6c\u7684\u903b\u8f91\uff1a</li> <li>\u5199\u5165\u9636\u6bb5\uff1a\u5f53\u4e00\u4e2a\u56e0\u9884\u53d6\u8bf7\u6c42\u800c\u88ab\u9a71\u9010\u7684\u9700\u6c42\u5757\u79bb\u5f00\u7f13\u5b58\u65f6\uff0c\u7cfb\u7edf\u4e0d\u662f\u8bb0\u5f55\u5b83\u7684\u5b8c\u6574\u5730\u5740\uff0c\u800c\u662f\u7528\u5176\u5730\u5740\u7684\u4e00\u90e8\u5206\uff08\u901a\u8fc7XOR\u64cd\u4f5c\uff09\u4f5c\u4e3a\u7d22\u5f15\uff0c\u5c06\u4f4d\u5411\u91cf\u4e2d\u5bf9\u5e94\u7684\u4e00\u4e2abit\u7f6e1\u3002\u8fd9\u76f8\u5f53\u4e8e\u5728\u201c\u5acc\u7591\u540d\u5355\u201d\u4e0a\u505a\u4e86\u4e2a\u6a21\u7cca\u6807\u8bb0\u3002</li> <li>\u8bfb\u53d6/\u9a8c\u8bc1\u9636\u6bb5\uff1a\u5f53\u4e00\u4e2a\u65b0\u7684\u9700\u6c42\u7f3a\u5931\u53d1\u751f\u65f6\uff0c\u7cfb\u7edf\u7acb\u5373\u7528\u7f3a\u5931\u5730\u5740\u53bb\u67e5\u8be2\u8fd9\u4e2a\u4f4d\u5411\u91cf\u3002\u5982\u679c\u5bf9\u5e94\u7684bit\u662f1\uff0c\u5c31\u8ba4\u4e3a\u8fd9\u6b21\u7f3a\u5931\u5f88\u53ef\u80fd\u662f\u7531\u9884\u53d6\u5668\u9020\u6210\u7684\uff0c\u5e76\u9012\u589epollution-total\u8ba1\u6570\u5668\u3002</li> <li>\u91cd\u7f6e\u673a\u5236\uff1a\u5f53\u4e00\u4e2a\u9884\u53d6\u8bf7\u6c42\u6210\u529f\u5c06\u6570\u636e\u586b\u56de\u7f13\u5b58\u65f6\uff0c\u4f1a\u5c06\u5176\u5730\u5740\u5bf9\u5e94\u7684bit\u6e05\u96f6\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u7cbe\u5999\u7684\u8bbe\u8ba1\uff0c\u5b83\u6a21\u62df\u4e86\u201c\u5982\u679c\u9884\u53d6\u7684\u6570\u636e\u6700\u7ec8\u88ab\u7528\u4e0a\u4e86\uff0c\u90a3\u4e48\u5b83\u5f53\u521d\u9a71\u9010\u522b\u4eba\u7684\u884c\u4e3a\u5c31\u4e0d\u7b97\u6c61\u67d3\u201d\uff0c\u4ece\u800c\u8ba9\u8fd9\u4e2a\u4f30\u7b97\u66f4\u52a0\u51c6\u786e\u3002</li> </ul> <p>\u8fd9\u5957\u673a\u5236\u7684\u6838\u5fc3\u667a\u6167\u5728\u4e8e\uff0c\u5b83\u63a5\u53d7\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5047\u9633\u6027\uff08False Positive\uff0c\u5373\u4e00\u4e2a\u7f3a\u5931\u88ab\u9519\u8bef\u5730\u5f52\u548e\u4e8e\u9884\u53d6\u5668\uff09\uff0c\u4f46\u5b8c\u5168\u907f\u514d\u4e86\u5047\u9634\u6027\uff08False Negative\uff09\uff0c\u5e76\u4e14\u4ee5\u6781\u4f4e\u7684\u786c\u4ef6\u6210\u672c\uff08\u4ec54KB\uff09\u4e3a\u53cd\u9988\u7cfb\u7edf\u63d0\u4f9b\u4e86\u81f3\u5173\u91cd\u8981\u7684\u6c61\u67d3\u5ea6\u91cf\uff08pollution metric\uff09\uff0c\u4f7f\u5f97\u52a8\u6001\u8c03\u6574\u9884\u53d6\u7b56\u7565\u6210\u4e3a\u53ef\u80fd\u3002</p>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/ELI5_notes/#3-eli5","title":"3. \u57fa\u4e8e\u6c61\u67d3\u611f\u77e5\u7684\u52a8\u6001\u7f13\u5b58\u63d2\u5165\u7b56\u7565 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08prefetcher\uff09\u6709\u4e2a\u201c\u6b7b\u8111\u7b4b\u201d\uff1a\u5b83\u603b\u662f\u628a\u9884\u53d6\u5230\u7684\u6570\u636e\u5757\u4e00\u80a1\u8111\u5730\u585e\u8fdb\u7f13\u5b58\u7684 MRU (Most-Recently-Used) \u4f4d\u7f6e\u3002\u8fd9\u4e48\u505a\u7684\u521d\u8877\u5f88\u597d\u2014\u2014\u8ba9\u9884\u53d6\u7684\u6570\u636e\u5728\u7f13\u5b58\u91cc\u6d3b\u5f97\u4e45\u4e00\u70b9\uff0c\u7b49\u7a0b\u5e8f\u771f\u6b63\u7528\u5230\u65f6\u8fd8\u5728\u3002 - \u4f46\u95ee\u9898\u5728\u4e8e\uff0c\u9884\u53d6\u5668\u5e76\u4e0d\u603b\u662f\u5bf9\u7684\u3002\u5f53\u5b83\u9884\u6d4b\u9519\u8bef\u6216\u8005\u7a0b\u5e8f\u884c\u4e3a\u7a81\u53d8\u65f6\uff0c\u8fd9\u4e9b\u6ca1\u7528\u7684\u9884\u53d6\u5757\u5c31\u53d8\u6210\u4e86 \u7f13\u5b58\u6c61\u67d3 (cache pollution)\u3002\u5b83\u4eec\u9738\u5360\u7740\u5b9d\u8d35\u7684\u7f13\u5b58\u7a7a\u95f4\uff0c\u628a\u771f\u6b63\u4f1a\u88ab\u7a0b\u5e8f\u7528\u5230\u7684 demand-fetched blocks \u7ed9\u6324\u51fa\u53bb\u4e86\u3002 - \u66f4\u7cdf\u7cd5\u7684\u662f\uff0c\u8fd9\u79cd\u7b56\u7565\u662f\u201c\u4e00\u5200\u5207\u201d\u7684\u3002\u65e0\u8bba\u5f53\u524d\u9884\u53d6\u5668\u662f\u5728\u9ad8\u6548\u5de5\u4f5c\u8fd8\u662f\u5728\u75af\u72c2\u5236\u9020\u5783\u573e\uff0c\u5b83\u90fd\u7528\u540c\u6837\u7684\u65b9\u5f0f\u63d2\u5165\u6570\u636e\u3002\u8fd9\u5c31\u5bfc\u81f4\u4e86\u4e00\u4e2a\u4e24\u96be\u56f0\u5883\uff1a\u6fc0\u8fdb\u7684\u9884\u53d6\u80fd\u5e26\u6765\u5de8\u5927\u6536\u76ca\uff0c\u4f46\u4e00\u65e6\u51fa\u9519\uff0c\u9020\u6210\u7684\u6027\u80fd\u635f\u5931\u4e5f\u6781\u5176\u60e8\u91cd\uff08\u5982\u8bba\u6587\u4e2d\u63d0\u5230\u7684 <code>ammp</code> \u548c <code>applu</code> \u57fa\u51c6\u6d4b\u8bd5\uff09\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08\u7f13\u5b58\u63a7\u5236\u5668\uff09\uff0c\u4f60\u7684\u4efb\u52a1\u662f\u7ba1\u7406\u4e00\u4e2a\u5bb9\u91cf\u6709\u9650\u7684\u70ed\u95e8\u4e66\u67b6\uff08L2 cache\uff09\u3002\u6709\u4e2a\u70ed\u5fc3\u4f46\u6709\u65f6\u4f1a\u72af\u9519\u7684\u52a9\u624b\uff08prefetcher\uff09\u4f1a\u63d0\u524d\u628a\u4e00\u4e9b\u4ed6\u8ba4\u4e3a\u8bfb\u8005\u4f1a\u501f\u7684\u4e66\u653e\u5230\u4e66\u67b6\u4e0a\u3002 - \u5982\u679c\u8fd9\u4e2a\u52a9\u624b\u975e\u5e38\u9760\u8c31\uff08\u9ad8\u51c6\u786e\u7387\u3001\u4f4e\u6c61\u67d3\uff09\uff0c\u4f60\u4f1a\u5f88\u4e50\u610f\u628a\u4ed6\u62ff\u6765\u7684\u4e66\u653e\u5728\u4e66\u67b6\u6700\u663e\u773c\u3001\u6700\u5bb9\u6613\u62ff\u5230\u7684\u4f4d\u7f6e\uff08MRU\uff09\uff0c\u8fd9\u6837\u8bfb\u8005\u4e00\u6765\u5c31\u80fd\u7acb\u523b\u770b\u5230\u3002 - \u4f46\u5982\u679c\u8fd9\u4e2a\u52a9\u624b\u6700\u8fd1\u8001\u662f\u62ff\u4e9b\u6ca1\u4eba\u770b\u7684\u51b7\u95e8\u4e66\u6765\uff08\u9ad8\u6c61\u67d3\uff09\uff0c\u4f60\u8fd8\u628a\u4ed6\u653e\u6700\u524d\u9762\uff0c\u5c31\u4f1a\u628a\u771f\u6b63\u70ed\u95e8\u7684\u4e66\u7ed9\u6321\u5728\u540e\u9762\u751a\u81f3\u6324\u4e0b\u4e66\u67b6\u3002\u8fd9\u65f6\u5019\uff0c\u806a\u660e\u7684\u505a\u6cd5\u662f\uff0c\u4f60\u8ba9\u4ed6\u628a\u65b0\u4e66\u5148\u653e\u5728\u4e66\u67b6\u9760\u540e\u4e00\u70b9\u3001\u4e0d\u90a3\u4e48\u663e\u773c\u7684\u4f4d\u7f6e\uff08\u6bd4\u5982 MID \u6216 LRU-4\uff09\u3002\u5982\u679c\u8fd9\u672c\u4e66\u771f\u6709\u4eba\u8981\uff0c\u8bfb\u8005\u8fd8\u662f\u4f1a\u627e\u5230\u5b83\uff0c\u5e76\u628a\u5b83\u79fb\u5230\u524d\u9762\uff1b\u5982\u679c\u6ca1\u4eba\u8981\uff0c\u5b83\u5f88\u5feb\u5c31\u4f1a\u88ab\u81ea\u7136\u6dd8\u6c70\uff0c\u4e0d\u4f1a\u957f\u671f\u5360\u7528\u5b9d\u8d35\u7a7a\u95f4\u3002 - \u8fd9\u4e2a\u673a\u5236\u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\uff1a\u6839\u636e\u52a9\u624b\u8fd1\u671f\u7684\u201c\u4fe1\u7528\u8bc4\u7ea7\u201d\uff08\u5373\u7f13\u5b58\u6c61\u67d3\u7a0b\u5ea6\uff09\uff0c\u52a8\u6001\u8c03\u6574\u4ed6\u9001\u6765\u7684\u4e66\u5728\u4e66\u67b6\u4e0a\u7684\u521d\u59cb\u6446\u653e\u4f4d\u7f6e\u3002</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u5e76\u6ca1\u6709\u6539\u53d8\u9884\u53d6\u5668\u672c\u8eab\u7684\u5de5\u4f5c\u903b\u8f91\uff0c\u800c\u662f\u5728\u7f13\u5b58\u7684\u63d2\u5165\u7b56\u7565\u4e0a\u505a\u4e86\u4e00\u4e2a\u5de7\u5999\u7684\u3001\u52a8\u6001\u7684\u5f00\u5173\u3002\u5177\u4f53\u6765\u8bf4\uff1a     - \u4ed6\u4eec\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u786c\u4ef6\u7ed3\u6784\uff08\u4e00\u4e2a\u57fa\u4e8e Bloom filter \u7684 pollution filter\uff0c\u89c1\u56fe4 <code>00535b5d378692089bc46ed2258d275e0e6d1cd80ea05c2799eef09253a25325.jpg</code>\uff09\uff0c\u7528\u4e8e\u5728\u8fd0\u884c\u65f6\u5b9e\u65f6\u4f30\u7b97 prefetcher-generated cache pollution\u3002     - \u5728\u6bcf\u4e2a\u56fa\u5b9a\u7684\u91c7\u6837\u5468\u671f\u7ed3\u675f\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8bfb\u53d6\u8fd9\u4e2a\u6c61\u67d3\u4f30\u7b97\u503c\uff0c\u5e76\u5c06\u5176\u4e0e\u9884\u8bbe\u7684\u9608\u503c\uff08<code>Plow</code>, <code>Phigh</code>\uff09\u8fdb\u884c\u6bd4\u8f83\u3002     - \u6839\u636e\u6bd4\u8f83\u7ed3\u679c\uff0c\u7cfb\u7edf\u4f1a\u4e3a\u4e0b\u4e00\u4e2a\u5468\u671f\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u63d2\u5165\u70b9\uff1a         - \u4f4e\u6c61\u67d3 -&gt; \u63d2\u5165 MID \u4f4d\u7f6e\uff08\u5e73\u8861\u7b56\u7565\uff09         - \u4e2d\u7b49\u6c61\u67d3 -&gt; \u63d2\u5165 LRU-4 \u4f4d\u7f6e\uff08\u66f4\u4fdd\u5b88\uff09         - \u9ad8\u6c61\u67d3 -&gt; \u63d2\u5165 LRU \u4f4d\u7f6e\uff08\u6700\u4fdd\u5b88\uff0c\u8ba9\u9884\u53d6\u5757\u81ea\u751f\u81ea\u706d\uff09 - \u8fd9\u4e2a\u201c\u626d\u8f6c\u201d\u70b9\u5728\u4e8e\uff0c\u5c06\u539f\u672c\u9759\u6001\u3001\u56fa\u5b9a\u7684\u7f13\u5b58\u63d2\u5165\u7b56\u7565\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u7531 \u5b9e\u65f6\u53cd\u9988\u4fe1\u53f7\uff08\u6c61\u67d3\u7a0b\u5ea6\uff09 \u9a71\u52a8\u7684\u52a8\u6001\u51b3\u7b56\u8fc7\u7a0b\u3002\u8fd9\u4f7f\u5f97\u7cfb\u7edf\u65e2\u80fd\u4eab\u53d7\u6fc0\u8fdb\u9884\u53d6\u5e26\u6765\u7684\u597d\u5904\uff0c\u53c8\u80fd\u8fc5\u901f\u6291\u5236\u5176\u5728\u9519\u8bef\u573a\u666f\u4e0b\u9020\u6210\u7684\u7834\u574f\u3002</p> <p></p> <p>Figure 8. Distribution of the insertion position of prefetched blocks</p> <p>\u4e0a\u56fe\uff08<code>70f8d913f7463350949980738a8c1304c6e031abbb64d9302047e97800c10cb0.jpg</code>\uff09\u6e05\u6670\u5730\u5c55\u793a\u4e86\u8fd9\u4e2a\u7b56\u7565\u7684\u6548\u679c\u3002\u5bf9\u4e8e <code>applu</code> \u548c <code>ammp</code> \u8fd9\u7c7b\u9ad8\u6c61\u67d3\u57fa\u51c6\uff0c\u52a8\u6001\u7b56\u7565\uff08Dynamic Insertion\uff09\u5927\u90e8\u5206\u65f6\u95f4\u90fd\u9009\u62e9\u4e86\u6700\u4fdd\u5b88\u7684 LRU \u63d2\u5165\uff0c\u4ece\u800c\u907f\u514d\u4e86\u6027\u80fd\u5d29\u6e83\uff0c\u540c\u65f6\u5728\u5176\u4ed6\u57fa\u51c6\u4e0a\u53c8\u80fd\u7075\u6d3b\u9009\u62e9\u66f4\u4f18\u7684\u4f4d\u7f6e\u4ee5\u83b7\u53d6\u6027\u80fd\u589e\u76ca\u3002</p>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/ELI5_notes/#4-eli5","title":"4. \u57fa\u4e8e\u91c7\u6837\u7684\u8fd0\u884c\u65f6\u53cd\u9988\u6536\u96c6\u673a\u5236 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 Stream Prefetcher\uff09\u7684 Prefetch Distance \u548c Prefetch Degree \u662f\u5728\u82af\u7247\u8bbe\u8ba1\u65f6\u5c31\u9759\u6001\u56fa\u5316\u7684\u3002\u8fd9\u5c31\u50cf\u7ed9\u6240\u6709\u75c5\u4eba\u5f00\u540c\u4e00\u5f20\u836f\u65b9\uff0c\u5b8c\u5168\u65e0\u89c6\u75c5\u60c5\u53d8\u5316\u3002 - \u7a0b\u5e8f\u7684\u5185\u5b58\u8bbf\u95ee\u884c\u4e3a\u662f\u9ad8\u5ea6\u52a8\u6001\u7684\uff0c\u4f1a\u968f\u7740\u65f6\u95f4\u8fdb\u5165\u4e0d\u540c\u7684\u201c\u6267\u884c\u9636\u6bb5\u201d\uff08memory phase\uff09\u3002\u5728\u4e00\u4e2a\u9636\u6bb5\u91cc\uff0c\u6fc0\u8fdb\u7684\u9884\u53d6\u53ef\u80fd\u6548\u679c\u62d4\u7fa4\uff1b\u4f46\u5728\u4e0b\u4e00\u4e2a\u9636\u6bb5\uff0c\u540c\u6837\u7684\u6fc0\u8fdb\u7b56\u7565\u53ef\u80fd\u56e0\u4e3a\u51c6\u786e\u7387\u4f4e\u3001\u9020\u6210\u4e25\u91cdCache\u6c61\u67d3\u6216\u5e26\u5bbd\u6d6a\u8d39\u800c\u8ba9\u6027\u80fd\u96ea\u5d29\uff08\u5982\u8bba\u6587\u4e2d ammp \u6027\u80fd\u66b4\u8dcc48%\uff09\u3002 - \u5982\u679c\u53cd\u9988\u592a\u6162\uff08\u6bd4\u5982\u5728\u6574\u4e2a\u7a0b\u5e8f\u8dd1\u5b8c\u540e\u624d\u7edf\u8ba1\uff09\uff0c\u6216\u8005\u53cd\u9988\u6307\u6807\u592a\u7c97\u7cd9\uff0c\u9884\u53d6\u5668\u5c31\u65e0\u6cd5\u53ca\u65f6\u201c\u8e29\u5239\u8f66\u201d\u6216\u201c\u8e29\u6cb9\u95e8\u201d\uff0c\u5bfc\u81f4\u5728\u9519\u8bef\u7684\u9636\u6bb5\u6267\u884c\u4e86\u9519\u8bef\u7684\u7b56\u7565\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u8fd9\u5957\u673a\u5236\u5c31\u50cf\u662f\u7ed9\u9884\u53d6\u5668\u88c5\u4e0a\u4e86\u4e00\u4e2a\u667a\u80fd\u5de1\u822a\u7cfb\u7edf\u3002\u8fd9\u4e2a\u7cfb\u7edf\u4e0d\u4f1a\u53ea\u770b\u4e00\u773c\u5730\u56fe\uff08\u9759\u6001\u914d\u7f6e\uff09\u5c31\u5b9a\u597d\u5168\u7a0b\u901f\u5ea6\u3002 - \u5b83\u4f1a\u628a\u65c5\u7a0b\u5206\u6210\u4e00\u4e2a\u4e2a\u5c0f\u8def\u6bb5\uff08\u91c7\u6837\u533a\u95f4\uff09\u3002\u5728\u6bcf\u4e2a\u8def\u6bb5\u7ed3\u675f\u65f6\uff0c\u5b83\u4f1a\u7acb\u523b\u590d\u76d8\uff1a\u521a\u624d\u8fd9\u6bb5\u8def\u5f00\u5f97\u600e\u4e48\u6837\uff1f\u662f\u4e0d\u662f\u8d85\u901f\u4e86\uff08Cache Pollution\u592a\u9ad8\uff09\uff1f\u662f\u4e0d\u662f\u5f00\u592a\u6162\u9519\u8fc7\u4e86\u8def\u53e3\uff08Prefetch Lateness\u592a\u9ad8\uff09\uff1f\u6cb9\u8017\uff08Memory Bandwidth\uff09\u662f\u4e0d\u662f\u592a\u9ad8\u4e86\uff1f - \u6839\u636e\u8fd9\u4e2a\u5373\u65f6\u590d\u76d8\u7684\u7ed3\u679c\uff0c\u5b83\u4f1a\u52a8\u6001\u8c03\u6574\u4e0b\u4e00\u8def\u6bb5\u7684\u8f66\u901f\u548c\u9a7e\u9a76\u98ce\u683c\uff08\u9884\u53d6\u6fc0\u8fdb\u5ea6\u548c\u7f13\u5b58\u63d2\u5165\u4f4d\u7f6e\uff09\uff0c\u786e\u4fdd\u5168\u7a0b\u53c8\u5feb\u53c8\u7a33\u8fd8\u7701\u6cb9\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") \u4f5c\u8005\u6ca1\u6709\u91c7\u7528\u57fa\u4e8e\u56fa\u5b9a\u65f6\u95f4\u6216\u6307\u4ee4\u6570\u7684\u91c7\u6837\uff0c\u800c\u662f\u63d0\u51fa\u4e86\u4e00\u4e2a\u6781\u5176\u5de7\u5999\u4e14\u4f4e\u6210\u672c\u7684\u89e6\u53d1\u6761\u4ef6\uff1a\u4ee5L2\u7f13\u5b58\u7684\u5b9e\u9645\u6d3b\u52a8\u5f3a\u5ea6\u4f5c\u4e3a\u91c7\u6837\u8282\u594f\u7684\u6807\u5c3a\u3002</p> <ul> <li>\u6838\u5fc3\u903b\u8f91\u8f6c\u6362\uff1a\u5c06\u201c\u4f55\u65f6\u6536\u96c6\u4e00\u6b21\u53cd\u9988\u201d\u8fd9\u4e2a\u95ee\u9898\uff0c\u4ece\u4e00\u4e2a\u4e0e\u7a0b\u5e8f\u884c\u4e3a\u8131\u8282\u7684\u5916\u90e8\u65f6\u949f\uff0c\u8f6c\u53d8\u4e3a\u7531\u7a0b\u5e8f\u81ea\u8eab\u5185\u5b58\u538b\u529b\u9a71\u52a8\u7684\u5185\u90e8\u4e8b\u4ef6\u3002</li> <li>\u5177\u4f53\u5b9e\u73b0\uff1a</li> <li>\u5f15\u5165\u4e00\u4e2a\u786c\u4ef6\u8ba1\u6570\u5668 eviction-count\uff0c\u4e13\u95e8\u8bb0\u5f55\u4eceL2\u7f13\u5b58\u4e2d\u88ab\u9a71\u9010\u51fa\u53bb\u7684\u5757\u7684\u6570\u91cf\u3002</li> <li>\u8bbe\u5b9a\u4e00\u4e2a\u9608\u503c Tinterval\uff08\u5b9e\u9a8c\u4e2d\u8bbe\u4e3a8192\uff0c\u7ea6\u7b49\u4e8eL2\u7f13\u5b58\u5757\u6570\u7684\u4e00\u534a\uff09\u3002</li> <li>\u6bcf\u5f53 eviction-count \u8d85\u8fc7 Tinterval\uff0c\u5c31\u5ba3\u544a\u5f53\u524d\u91c7\u6837\u533a\u95f4\u7ed3\u675f\u3002\u8fd9\u610f\u5473\u7740\uff0c\u91c7\u6837\u533a\u95f4\u7684\u957f\u5ea6\u662f\u81ea\u9002\u5e94\u7684\uff1a\u5185\u5b58\u8bbf\u95ee\u5bc6\u96c6\u3001\u7f13\u5b58\u538b\u529b\u5927\u7684\u65f6\u5019\uff0c\u533a\u95f4\u5c31\u77ed\uff0c\u53cd\u9988\u66f4\u9891\u7e41\uff1b\u53cd\u4e4b\uff0c\u533a\u95f4\u5c31\u957f\u3002</li> <li>\u5728\u533a\u95f4\u7ed3\u675f\u65f6\uff1a</li> <li>\u4f7f\u7528\u7c7b\u4f3c\u6307\u6570\u79fb\u52a8\u5e73\u5747\u7684\u516c\u5f0f\uff08<code>CounterValue = \u03b1 * CounterValue + (1-\u03b1) * CounterValueDuringInterval</code>\uff09\u6765\u66f4\u65b0\u4e09\u4e2a\u6838\u5fc3\u6307\u6807\u7684\u5386\u53f2\u4f30\u503c\u3002</li> </ul> <p></p> <ul> <li>\u57fa\u4e8e\u8fd9\u4e9b\u6700\u65b0\u7684\u3001\u53cd\u6620\u6700\u8fd1\u7a0b\u5e8f\u884c\u4e3a\u7684\u6307\u6807\uff08Accuracy, Lateness, Pollution\uff09\uff0c\u901a\u8fc7\u4e00\u5f20\u51b3\u7b56\u8868\uff08Table 2\uff09\u6765\u51b3\u5b9a\u4e0b\u4e00\u533a\u95f4\u7684\u9884\u53d6\u7b56\u7565\u3002</li> </ul> <p></p> <ul> <li>\u91cd\u7f6e eviction-count \u548c\u6240\u6709\u533a\u95f4\u5185\u8ba1\u6570\u5668\uff0c\u5f00\u59cb\u65b0\u7684\u91c7\u6837\u5468\u671f\u3002</li> </ul> <p>\u8fd9\u79cd\u8bbe\u8ba1\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u7528\u6781\u4f4e\u7684\u786c\u4ef6\u5f00\u9500\uff08\u4e00\u4e2a\u8ba1\u6570\u5668\u52a0\u4e00\u4e2a\u6bd4\u8f83\u5668\uff09\uff0c\u5c31\u5b9e\u73b0\u4e86\u4e0e\u7a0b\u5e8f\u771f\u5b9e\u5185\u5b58\u538b\u529b\u5f3a\u76f8\u5173\u7684\u53cd\u9988\u8282\u594f\uff0c\u786e\u4fdd\u4e86\u53cd\u9988\u4fe1\u606f\u7684\u65f6\u6548\u6027\u548c\u76f8\u5173\u6027\uff0c\u4ece\u800c\u8ba9\u52a8\u6001\u8c03\u6574\u771f\u6b63\u6709\u6548\u3002</p>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/","title":"Feedback Directed Prefetching: Improving the Performance and Bandwidth-Efficiency of Hardware Prefetchers \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-1-performance-vs-aggressiveness-of-the-prefetcher","title":"Figure 1. Performance vs. aggressiveness of the prefetcher","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 17 \u4e2a SPEC CPU2000 \u57fa\u51c6\u7a0b\u5e8f\u5728\u56db\u79cd\u4e0d\u540c\u9884\u53d6\u5668\u914d\u7f6e\u4e0b\u7684\u6027\u80fd\u8868\u73b0\uff0c\u6027\u80fd\u6307\u6807\u4e3a Instructions per Cycle (IPC)\u3002</li> <li>\u56db\u79cd\u914d\u7f6e\u5206\u522b\u4e3a\uff1aNo prefetching\uff08\u65e0\u9884\u53d6\uff09\u3001Very Conservative\uff08\u975e\u5e38\u4fdd\u5b88\uff09\u3001Middle-of-the-Road\uff08\u4e2d\u7b49\uff09\u3001Very Aggressive\uff08\u975e\u5e38\u6fc0\u8fdb\uff09\u3002</li> <li>\u6027\u80fd\u8d8b\u52bf\u663e\u793a\uff0c\u6fc0\u8fdb\u9884\u53d6\u5728\u591a\u6570\u7a0b\u5e8f\u4e2d\u663e\u8457\u63d0\u5347 IPC\uff0c\u4f8b\u5982 mgrid \u548c wupwise \u7684 IPC \u5728 Very Aggressive \u914d\u7f6e\u4e0b\u63a5\u8fd1\u6216\u8d85\u8fc7 4.0\u3002</li> <li>\u7136\u800c\uff0c\u5728\u90e8\u5206\u7a0b\u5e8f\u5982 ammp \u548c applu \u4e2d\uff0cVery Aggressive \u914d\u7f6e\u5bfc\u81f4 IPC \u663e\u8457\u4e0b\u964d\uff0c\u751a\u81f3\u4f4e\u4e8e No prefetching\uff0c\u8868\u660e\u9884\u53d6\u53ef\u80fd\u5e26\u6765\u8d1f\u9762\u6027\u80fd\u5f71\u54cd\u3002</li> <li>Middle-of-the-Road \u914d\u7f6e\u5728\u5927\u591a\u6570\u7a0b\u5e8f\u4e2d\u63d0\u4f9b\u5e73\u8861\u6027\u80fd\uff0c\u65e2\u907f\u514d\u4e86\u6fc0\u8fdb\u9884\u53d6\u7684\u8d1f\u9762\u5f71\u54cd\uff0c\u53c8\u4fdd\u7559\u4e86\u4e00\u5b9a\u7684\u6027\u80fd\u589e\u76ca\u3002</li> <li>Very Conservative \u914d\u7f6e\u5728\u6240\u6709\u7a0b\u5e8f\u4e2d\u7684\u6027\u80fd\u5747\u4f4e\u4e8e\u5176\u4ed6\u4e24\u79cd\u4e3b\u52a8\u9884\u53d6\u914d\u7f6e\uff0c\u4ec5\u7565\u4f18\u4e8e\u6216\u63a5\u8fd1 No prefetching\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u7a0b\u5ea6\u4e0e\u6027\u80fd\u63d0\u5347\u5e76\u975e\u7ebf\u6027\u6b63\u76f8\u5173\uff0c\u9700\u6839\u636e\u7a0b\u5e8f\u7279\u6027\u52a8\u6001\u8c03\u6574\u3002</li> </ul> Benchmark No Prefetching Very Conservative Middle-of-the-Road Very Aggressive bzip2 ~1.3 ~1.4 ~1.5 ~1.6 gap ~1.2 ~1.4 ~1.5 ~2.3 mcf ~0.3 ~0.4 ~0.5 ~0.5 parser ~1.2 ~1.4 ~1.5 ~1.6 vortex ~1.3 ~1.5 ~1.6 ~1.9 vpr ~1.3 ~1.4 ~1.5 ~1.6 ammp ~1.3 ~1.2 ~1.1 ~0.7 applu ~1.3 ~1.2 ~1.1 ~0.9 art ~0.5 ~0.6 ~0.7 ~0.8 equake ~0.8 ~1.0 ~1.2 ~2.5 facerec ~2.0 ~2.2 ~2.3 ~2.4 galgel ~2.0 ~2.2 ~2.3 ~2.4 mesa ~2.0 ~2.2 ~2.3 ~2.4 mgrid ~2.0 ~2.2 ~2.3 ~4.5 sixtrack ~2.0 ~2.2 ~2.3 ~2.4 swim ~2.0 ~2.2 ~2.3 ~2.4 wupwise ~2.0 ~2.2 ~2.3 ~4.5 gmean ~1.5 ~1.6 ~1.7 ~2.0 <ul> <li>gmean \u8868\u793a\u51e0\u4f55\u5e73\u5747\u503c\uff0c\u663e\u793a Very Aggressive \u914d\u7f6e\u5728\u6574\u4f53\u4e0a\u63d0\u4f9b\u6700\u9ad8\u6027\u80fd\uff0c\u4f46\u5176\u4ee3\u4ef7\u662f\u90e8\u5206\u7a0b\u5e8f\u6027\u80fd\u4e25\u91cd\u9000\u5316\u3002</li> <li>\u6b64\u56fe\u76f4\u89c2\u8bf4\u660e\u4e86\u56fa\u5b9a\u9884\u53d6\u7b56\u7565\u7684\u5c40\u9650\u6027\uff0c\u5e76\u4e3a\u540e\u7eed\u63d0\u51fa\u7684 Feedback Directed Prefetching (FDP) \u63d0\u4f9b\u52a8\u673a\u2014\u2014\u5373\u9700\u8981\u52a8\u6001\u8c03\u6574\u9884\u53d6\u884c\u4e3a\u4ee5\u9002\u5e94\u4e0d\u540c\u7a0b\u5e8f\u9636\u6bb5\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#fd39164810ba9e592f1484a60c705f26ff9146652f29165416db4bb885d729afjpg","title":"fd39164810ba9e592f1484a60c705f26ff9146652f29165416db4bb885d729af.jpg","text":"<ul> <li>\u56fe\u7247\u5185\u5bb9\u4e3a\u4e00\u4e2a\u6570\u5b66\u516c\u5f0f\uff0c\u5b9a\u4e49\u4e86 Prefetch Accuracy\uff08\u9884\u53d6\u51c6\u786e\u7387\uff09\u7684\u8ba1\u7b97\u65b9\u6cd5\u3002</li> <li>\u516c\u5f0f\u7ed3\u6784\u6e05\u6670\uff0c\u5206\u5b50\u4e3a Number of Useful Prefetches\uff08\u6709\u7528\u9884\u53d6\u6b21\u6570\uff09\uff0c\u5206\u6bcd\u4e3a Number of Prefetches Sent To Memory\uff08\u53d1\u9001\u81f3\u5185\u5b58\u7684\u9884\u53d6\u8bf7\u6c42\u6570\u91cf\uff09\u3002</li> <li>\u8be5\u516c\u5f0f\u7528\u4e8e\u91cf\u5316\u786c\u4ef6\u9884\u53d6\u5668\u5728\u9884\u6d4b\u7a0b\u5e8f\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u65f6\u7684\u6709\u6548\u6027\uff0c\u662f\u8bc4\u4f30\u9884\u53d6\u6027\u80fd\u7684\u6838\u5fc3\u6307\u6807\u4e4b\u4e00\u3002</li> <li>\u5728\u8bba\u6587\u4e2d\uff0c\u6b64\u516c\u5f0f\u88ab\u7528\u4e8e\u52a8\u6001\u53cd\u9988\u673a\u5236\uff08FDP\uff09\uff0c\u4ee5\u6307\u5bfc\u9884\u53d6\u5668\u8c03\u6574\u5176\u6fc0\u8fdb\u7a0b\u5ea6\uff0c\u907f\u514d\u56e0\u4f4e\u51c6\u786e\u7387\u5bfc\u81f4\u7684\u6027\u80fd\u4e0b\u964d\u548c\u5e26\u5bbd\u6d6a\u8d39\u3002</li> <li>\u8bba\u6587\u6307\u51fa\uff0c\u5f53\u9884\u53d6\u51c6\u786e\u7387\u4f4e\u4e8e40%\u65f6\uff08\u5982 applu\u3001galgel\u3001ammp \u7b49\u57fa\u51c6\u7a0b\u5e8f\uff09\uff0c\u542f\u7528\u9884\u53d6\u5668\u53cd\u800c\u4f1a\u964d\u4f4e\u6027\u80fd\uff1b\u800c\u9ad8\u4e8e40%\u65f6\uff0c\u901a\u5e38\u80fd\u5e26\u6765\u663e\u8457\u6027\u80fd\u63d0\u5347\u3002</li> </ul> \u6307\u6807\u540d\u79f0 \u5b9a\u4e49 \u4f5c\u7528 Prefetch Accuracy \u6709\u7528\u9884\u53d6\u6b21\u6570 / \u53d1\u9001\u81f3\u5185\u5b58\u7684\u9884\u53d6\u8bf7\u6c42\u6570\u91cf \u8861\u91cf\u9884\u53d6\u5668\u9884\u6d4b\u5185\u5b58\u5730\u5740\u7684\u51c6\u786e\u6027\uff0c\u662f\u52a8\u6001\u8c03\u6574\u9884\u53d6\u6fc0\u8fdb\u7a0b\u5ea6\u7684\u5173\u952e\u8f93\u5165 <ul> <li>\u6b64\u516c\u5f0f\u5728\u786c\u4ef6\u5b9e\u73b0\u4e2d\u901a\u8fc7\u4e24\u4e2a\u8ba1\u6570\u5668\u8ddf\u8e2a\uff1a<code>pref-total</code>\uff08\u603b\u9884\u53d6\u6570\uff09\u548c <code>used-total</code>\uff08\u6709\u7528\u9884\u53d6\u6570\uff09\uff0c\u5e76\u5728\u8fd0\u884c\u65f6\u5b9e\u65f6\u8ba1\u7b97\u6bd4\u7387\u3002</li> <li>\u8bba\u6587\u5f3a\u8c03\uff0c\u4ec5\u4f9d\u8d56\u51c6\u786e\u7387\u4e0d\u8db3\u4ee5\u5168\u9762\u4f18\u5316\u9884\u53d6\u884c\u4e3a\uff0c\u56e0\u6b64\u8fd8\u5f15\u5165\u4e86 Prefetch Lateness \u548c Prefetcher-Generated Cache Pollution \u4f5c\u4e3a\u8865\u5145\u53cd\u9988\u6307\u6807\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#ef3d8e04cdfaebbe1ef2eff186fa90bd3b5bc1336a5179e5c14b716c435502d9jpg","title":"ef3d8e04cdfaebbe1ef2eff186fa90bd3b5bc1336a5179e5c14b716c435502d9.jpg","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u4e00\u4e2a\u6570\u5b66\u516c\u5f0f\uff0c\u7528\u4e8e\u5b9a\u4e49 Prefetch Lateness\uff08\u9884\u53d6\u5ef6\u8fdf\uff09\u8fd9\u4e00\u6027\u80fd\u6307\u6807\u3002</li> <li>\u8be5\u516c\u5f0f\u7684\u5206\u5b50\u662f Number of Late Prefetches\uff08\u5ef6\u8fdf\u9884\u53d6\u7684\u6570\u91cf\uff09\uff0c\u5206\u6bcd\u662f Number of Useful Prefetches\uff08\u6709\u7528\u9884\u53d6\u7684\u6570\u91cf\uff09\u3002</li> <li>\u516c\u5f0f\u8868\u660e\uff0cPrefetch Lateness \u662f\u4e00\u4e2a\u6bd4\u7387\uff0c\u8861\u91cf\u7684\u662f\u5728\u6240\u6709\u88ab\u7a0b\u5e8f\u5b9e\u9645\u4f7f\u7528\u7684\u9884\u53d6\u8bf7\u6c42\u4e2d\uff0c\u6709\u591a\u5c11\u6bd4\u4f8b\u7684\u9884\u53d6\u6570\u636e\u672a\u80fd\u53ca\u65f6\u8fd4\u56de\u5230\u7f13\u5b58\uff0c\u4ece\u800c\u9519\u8fc7\u4e86\u88ab\u9700\u6c42\u8bbf\u95ee\u7684\u65f6\u95f4\u70b9\u3002</li> <li>\u5728\u8bba\u6587\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u8fd9\u4e2a\u6307\u6807\u662f\u53cd\u9988\u5bfc\u5411\u9884\u53d6\u673a\u5236\uff08FDP\uff09\u6240\u76d1\u63a7\u7684\u4e09\u4e2a\u6838\u5fc3\u6307\u6807\u4e4b\u4e00\uff0c\u53e6\u5916\u4e24\u4e2a\u662f Prefetch Accuracy \u548c Prefetcher-Generated Cache Pollution\u3002</li> <li>\u8bba\u6587\u6307\u51fa\uff0c\u5373\u4f7f\u9884\u53d6\u5730\u5740\u9884\u6d4b\u51c6\u786e\uff08\u9ad8 accuracy\uff09\uff0c\u5982\u679c\u9884\u53d6\u8bf7\u6c42\u8fc7\u4e8e\u201c\u665a\u201d\uff08high lateness\uff09\uff0c\u5373\u6570\u636e\u5728\u9700\u6c42\u8bbf\u95ee\u53d1\u751f\u540e\u624d\u5230\u8fbe\uff0c\u90a3\u4e48\u9884\u53d6\u4e5f\u65e0\u6cd5\u5e26\u6765\u6027\u80fd\u63d0\u5347\u3002\u4f8b\u5982\uff0c\u5728 <code>mcf</code> \u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u5c3d\u7ba1\u9884\u53d6\u51c6\u786e\u7387\u63a5\u8fd1100%\uff0c\u4f46\u8d85\u8fc790%\u7684\u6709\u7528\u9884\u53d6\u90fd\u662f\u5ef6\u8fdf\u7684\uff0c\u5bfc\u81f4\u6027\u80fd\u6ca1\u6709\u663e\u8457\u6539\u5584\u3002</li> <li>FDP \u673a\u5236\u4f1a\u6839\u636e\u8fd9\u4e2a\u6307\u6807\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u7a0b\u5ea6\uff1a\u5f53\u68c0\u6d4b\u5230\u9884\u53d6\u5ef6\u8fdf\u8f83\u9ad8\u65f6\uff0c\u7cfb\u7edf\u503e\u5411\u4e8e\u589e\u52a0\u9884\u53d6\u8ddd\u79bb\uff08Prefetch Distance\uff09\uff0c\u4ee5\u66f4\u65e9\u5730\u53d1\u8d77\u9884\u53d6\u8bf7\u6c42\uff0c\u4ece\u800c\u964d\u4f4e\u5ef6\u8fdf\u3002</li> </ul> \u6307\u6807\u540d\u79f0 \u5b9a\u4e49 \u8ba1\u7b97\u516c\u5f0f Prefetch Lateness \u8861\u91cf\u9884\u53d6\u8bf7\u6c42\u7684\u53ca\u65f6\u6027 <code>Number of Late Prefetches / Number of Useful Prefetches</code> Prefetch Accuracy \u8861\u91cf\u9884\u53d6\u5730\u5740\u9884\u6d4b\u7684\u51c6\u786e\u6027 <code>Number of Useful Prefetches / Number of Prefetches Sent</code> Prefetcher-Generated Cache Pollution \u8861\u91cf\u9884\u53d6\u9020\u6210\u7684\u7f13\u5b58\u6c61\u67d3 <code>Number of Demand Misses Caused By the Prefetcher / Number of Demand Misses</code>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#a0b2e4e1ed0fb2be4699a36a5a9dbed4c633eecc8802030e3f66e6ecbb2a84bejpg","title":"a0b2e4e1ed0fb2be4699a36a5a9dbed4c633eecc8802030e3f66e6ecbb2a84be.jpg","text":"<ul> <li>\u56fe\u7247\u5305\u542b\u4e24\u4e2a\u5e76\u5217\u7684\u67f1\u72b6\u56fe\uff0c\u5de6\u4fa7\u4e3a IPC (Instructions per Cycle) \u6027\u80fd\u5bf9\u6bd4\uff0c\u53f3\u4fa7\u4e3a Dynamic Prefetcher Accuracy \u51c6\u786e\u7387\u5bf9\u6bd4\uff0c\u4e24\u8005\u5747\u9488\u5bf9 17 \u4e2a SPEC CPU2000 \u57fa\u51c6\u7a0b\u5e8f\u3002</li> <li>\u5de6\u4fa7 IPC \u56fe\u4e2d\uff0c\u7eb5\u8f74\u8303\u56f4\u4ece 0.00 \u5230 5.00\uff0c\u6a2a\u8f74\u5217\u51fa\u5404\u57fa\u51c6\u7a0b\u5e8f\u540d\u79f0\uff08\u5982 bzip2, gap, mcf \u7b49\uff09\uff0c\u5e76\u4ee5\u4e0d\u540c\u7070\u5ea6\u67f1\u4f53\u8868\u793a\u56db\u79cd\u9884\u53d6\u914d\u7f6e\uff1aNo prefetching, Very Conservative, Middle-of-the-Road, Very Aggressive\u3002</li> <li>\u53f3\u4fa7\u51c6\u786e\u7387\u56fe\u4e2d\uff0c\u7eb5\u8f74\u8303\u56f4\u4ece 0.00 \u5230 1.00\uff0c\u6a2a\u8f74\u4e0e\u5de6\u56fe\u4e00\u81f4\uff0c\u67f1\u4f53\u4ec5\u5c55\u793a\u4e09\u79cd\u9884\u53d6\u914d\u7f6e\uff1aVery Conservative, Middle-of-the-Road, Very Aggressive\uff0c\u672a\u5305\u542b No prefetching\u3002</li> <li>\u4ece IPC \u56fe\u53ef\u89c1\uff0cVery Aggressive \u914d\u7f6e\u5728\u591a\u6570\u7a0b\u5e8f\uff08\u5982 wupwise, mgrid\uff09\u4e0a\u663e\u8457\u63d0\u5347\u6027\u80fd\uff0c\u4f46\u5728\u90e8\u5206\u7a0b\u5e8f\uff08\u5982 ammp, applu\uff09\u4e0a\u5bfc\u81f4\u6027\u80fd\u4e25\u91cd\u4e0b\u964d\uff0c\u751a\u81f3\u4f4e\u4e8e No prefetching\u3002</li> <li>\u4ece\u51c6\u786e\u7387\u56fe\u53ef\u89c1\uff0cVery Aggressive \u914d\u7f6e\u5728\u5927\u90e8\u5206\u7a0b\u5e8f\u4e0a\u4fdd\u6301\u8f83\u9ad8\u51c6\u786e\u7387\uff08&gt;0.8\uff09\uff0c\u4f46\u5728 ammp\u3001applu\u3001galgel \u7b49\u7a0b\u5e8f\u4e0a\u51c6\u786e\u7387\u6781\u4f4e\uff08&lt;0.4\uff09\uff0c\u4e0e IPC \u4e0b\u964d\u8d8b\u52bf\u9ad8\u5ea6\u76f8\u5173\u3002</li> <li>\u4e24\u56fe\u5171\u540c\u63ed\u793a\u4e00\u4e2a\u5173\u952e\u7ed3\u8bba\uff1a\u9884\u53d6\u5668\u7684\u6027\u80fd\u6536\u76ca\u4e0e\u5176\u51c6\u786e\u7387\u5f3a\u76f8\u5173\u3002\u9ad8\u51c6\u786e\u7387\u65f6\uff0c\u6fc0\u8fdb\u9884\u53d6\u5e26\u6765\u9ad8\u6536\u76ca\uff1b\u4f4e\u51c6\u786e\u7387\u65f6\uff0c\u6fc0\u8fdb\u9884\u53d6\u53cd\u800c\u9020\u6210\u6027\u80fd\u635f\u5931\u3002</li> <li>\u6570\u636e\u6982\u89c8\u5982\u4e0b\u8868\uff1a</li> </ul> Benchmark IPC (Very Aggressive) Accuracy (Very Aggressive) Performance Impact bzip2 ~3.0 ~0.8 Positive gap ~2.2 ~0.7 Positive mcf ~1.6 ~0.98 Neutral/Negative ammp ~0.7 ~0.1 Severe Negative applu ~0.6 ~0.1 Severe Negative galgel ~0.8 ~0.2 Negative wupwise ~4.8 ~0.7 High Positive mgrid ~4.5 ~0.9 High Positive <ul> <li>\u8be5\u56fe\u76f4\u89c2\u652f\u6301\u8bba\u6587\u6838\u5fc3\u89c2\u70b9\uff1a\u76f2\u76ee\u91c7\u7528\u6fc0\u8fdb\u9884\u53d6\u7b56\u7565\u4e0d\u53ef\u53d6\uff0c\u9700\u6839\u636e\u8fd0\u884c\u65f6\u53cd\u9988\u52a8\u6001\u8c03\u6574\uff0c\u4ee5\u907f\u514d\u5728\u4f4e\u51c6\u786e\u7387\u573a\u666f\u4e0b\u9020\u6210\u6027\u80fd\u9000\u5316\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-2-ipc-performance-left-and-prefetch-accuracy-right-with-different-aggressiveness-configurations","title":"Figure 2. IPC performance (left) and prefetch accuracy (right) with different aggressiveness configurations","text":"<ul> <li>\u56fe\u7247 f4d2505a3e698001e92b871136ff86de1fb2b749df64a9ebb2391a7af65c5c5f.jpg \u5305\u542b\u4e24\u4e2a\u5e76\u5217\u67f1\u72b6\u56fe\uff0c\u5de6\u4fa7\u4e3a IPC \u6027\u80fd\uff0c\u53f3\u4fa7\u4e3a Prefetch Accuracy\uff0c\u7528\u4e8e\u5bf9\u6bd4\u56db\u79cd\u4e0d\u540c aggressiveness \u914d\u7f6e\u4e0b\u7684\u8868\u73b0\u3002</li> <li>\u5de6\u4fa7\u56fe\u8868\u6807\u9898\u4e3a \u201cInstructions per Cycle\u201d\uff0c\u7eb5\u8f74\u8303\u56f4\u4ece 0.00 \u5230 5.00\uff0c\u6a2a\u8f74\u5217\u51fa 17 \u4e2a SPEC CPU2000 \u57fa\u51c6\u7a0b\u5e8f\uff08\u5982 bzip2, gap, mcf, parser, vortex, vpr, ammp, applu, art, equake, facerec, galgel, mesa, mgrid, sixtrack, swim, wupwise\uff09\u53ca\u4e00\u4e2a gmean\uff08\u51e0\u4f55\u5e73\u5747\u503c\uff09\u3002</li> <li>\u53f3\u4fa7\u56fe\u8868\u6807\u9898\u4e3a \u201cPrefetch Lateness\u201d\uff0c\u7eb5\u8f74\u8303\u56f4\u4ece 0.00 \u5230 1.00\uff0c\u6a2a\u8f74\u4e0e\u5de6\u4fa7\u4e00\u81f4\uff0c\u5c55\u793a\u5404\u7a0b\u5e8f\u5728\u4e0d\u540c\u914d\u7f6e\u4e0b\u7684\u9884\u53d6\u5ef6\u8fdf\u6bd4\u4f8b\u3002</li> <li>\u56db\u79cd\u914d\u7f6e\u901a\u8fc7\u56fe\u4f8b\u533a\u5206\uff1aNo prefetching\uff08\u65e0\u9884\u53d6\uff09\u3001Very Conservative\uff08\u975e\u5e38\u4fdd\u5b88\uff09\u3001Middle-of-the-Road\uff08\u4e2d\u7b49\uff09\u3001Very Aggressive\uff08\u975e\u5e38\u6fc0\u8fdb\uff09\u3002</li> <li>\u5728 IPC \u6027\u80fd\u56fe\u4e2d\uff0cVery Aggressive \u914d\u7f6e\u5728\u591a\u6570\u7a0b\u5e8f\u4e0a\u8868\u73b0\u6700\u4f18\uff0c\u5c24\u5176\u5728 mgrid\u3001wupwise \u7b49\u7a0b\u5e8f\u4e0a\u663e\u8457\u9886\u5148\uff1b\u4f46\u5728 ammp \u548c applu \u4e0a\u6027\u80fd\u53cd\u800c\u4f4e\u4e8e No prefetching\u3002</li> <li>\u5728 Prefetch Accuracy \u56fe\u4e2d\uff0cVery Aggressive \u914d\u7f6e\u5728\u5927\u591a\u6570\u7a0b\u5e8f\u4e0a\u51c6\u786e\u7387\u8f83\u9ad8\uff0c\u4f46\u5728 mcf \u4e0a\u867d\u51c6\u786e\u7387\u63a5\u8fd1 100%\uff0c\u4f46\u56e0\u5ef6\u8fdf\u9ad8\u5bfc\u81f4\u6027\u80fd\u672a\u63d0\u5347\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0cPrefetch Accuracy \u4e0e\u6027\u80fd\u63d0\u5347\u6b63\u76f8\u5173\uff1a\u5f53\u51c6\u786e\u7387\u9ad8\u4e8e 40% \u65f6\uff0c\u9884\u53d6\u901a\u5e38\u63d0\u5347\u6027\u80fd\uff1b\u4f4e\u4e8e 40% \u65f6\uff08\u5982 applu, galgel, ammp\uff09\uff0c\u9884\u53d6\u53cd\u800c\u964d\u4f4e\u6027\u80fd\u3002</li> <li>\u8868\u683c\u5316\u6570\u636e\u6458\u8981\u5982\u4e0b\uff1a</li> </ul> Benchmark IPC (Very Aggressive) Prefetch Accuracy (Very Aggressive) bzip2 ~1.3 ~0.1 gap ~2.3 ~0.6 mcf ~0.3 ~0.95 parser ~1.5 ~0.2 vortex ~1.7 ~0.7 vpr ~1.4 ~0.3 ammp ~0.7 ~0.2 applu ~0.8 ~0.2 art ~1.0 ~0.3 equake ~2.5 ~0.4 facerec ~2.5 ~0.5 galgel ~2.5 ~0.2 mesa ~2.8 ~0.6 mgrid ~4.8 ~0.9 sixtrack ~2.5 ~0.7 swim ~1.5 ~0.3 wupwise ~4.8 ~0.9 gmean ~2.0 ~0.5 <ul> <li>\u7efc\u5408\u5206\u6790\u663e\u793a\uff0c\u6fc0\u8fdb\u9884\u53d6\u7b56\u7565\u5728\u9ad8\u51c6\u786e\u7387\u573a\u666f\u4e0b\u6536\u76ca\u663e\u8457\uff0c\u4f46\u5728\u4f4e\u51c6\u786e\u7387\u6216\u9ad8\u5ef6\u8fdf\u573a\u666f\u4e0b\u4f1a\u635f\u5bb3\u6027\u80fd\uff0c\u51f8\u663e\u52a8\u6001\u8c03\u6574\u9884\u53d6\u884c\u4e3a\u7684\u5fc5\u8981\u6027\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-3-ipc-performance-left-and-prefetch-lateness-right-with-different-aggressiveness-configurations-figure-4-filter-to-estimate-prefetcher-generated-cache-pollution","title":"Figure 3. IPC performance (left) and prefetch lateness (right) with different aggressiveness configurations Figure 4. Filter to estimate prefetcher-generated cache pollution","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u7528\u4e8e\u4f30\u7b97 prefetcher-generated cache pollution \u7684\u786c\u4ef6\u8fc7\u6ee4\u5668\u7ed3\u6784\uff0c\u5176\u6838\u5fc3\u662f\u4e00\u4e2a Bloom filter \u5b9e\u73b0\u3002</li> <li>\u8be5\u8fc7\u6ee4\u5668\u7531\u4e00\u4e2a bit-vector \u6784\u6210\uff0c\u5176\u7d22\u5f15\u901a\u8fc7\u5c06\u7f13\u5b58\u5757\u5730\u5740\u7684\u9ad8\u4f4d\uff08CacheBlockAddress[23:12]\uff09\u4e0e\u4f4e\u4f4d\uff08CacheBlockAddress[11:0]\uff09\u8fdb\u884c XOR \u8fd0\u7b97\u540e\u5f97\u5230\u3002</li> <li>\u5f53\u4e00\u4e2a\u56e0 demand miss \u800c\u8f7d\u5165\u7684 L2 \u7f13\u5b58\u5757\u88ab prefetch request \u9a71\u9010\u65f6\uff0c\u7cfb\u7edf\u4f1a\u7528\u8be5\u5757\u7684\u5730\u5740\u8bbf\u95ee\u8fc7\u6ee4\u5668\uff0c\u5e76\u5c06\u5bf9\u5e94\u4f4d\u8bbe\u7f6e\u4e3a 1\uff0c\u8868\u793a\u8be5\u5757\u662f\u88ab\u9884\u53d6\u64cd\u4f5c\u201c\u6c61\u67d3\u201d\u800c\u9a71\u9010\u7684\u3002</li> <li>\u5f53\u4e00\u4e2a prefetch request \u4ece\u5185\u5b58\u8fd4\u56de\u5e76\u51c6\u5907\u63d2\u5165\u7f13\u5b58\u65f6\uff0c\u7cfb\u7edf\u4f1a\u7528\u5176\u5730\u5740\u8bbf\u95ee\u8fc7\u6ee4\u5668\uff0c\u5e76\u5c06\u5bf9\u5e94\u4f4d\u91cd\u7f6e\u4e3a 0\uff0c\u8868\u793a\u8be5\u9884\u53d6\u5757\u5df2\u6210\u529f\u63d2\u5165\uff0c\u4e0d\u518d\u6807\u8bb0\u4e3a\u201c\u6c61\u67d3\u6e90\u201d\u3002</li> <li>\u5f53\u4e00\u4e2a demand access \u5728\u7f13\u5b58\u4e2d\u672a\u547d\u4e2d\u65f6\uff0c\u7cfb\u7edf\u4f1a\u7528\u5176\u5730\u5740\u8bbf\u95ee\u8fc7\u6ee4\u5668\u3002\u82e5\u5bf9\u5e94\u4f4d\u4e3a 1\uff0c\u5219\u8868\u660e\u8be5\u7f3a\u5931\u662f\u7531\u9884\u53d6\u64cd\u4f5c\u5f15\u8d77\u7684\uff0c\u6b64\u65f6\u4f1a\u9012\u589e pollution-total \u8ba1\u6570\u5668\u3002</li> <li>\u53e6\u4e00\u4e2a\u8ba1\u6570\u5668 demand-total \u7528\u4e8e\u8bb0\u5f55\u6240\u6709\u9700\u6c42\u7f3a\u5931\u603b\u6570\uff0c\u6700\u7ec8 cache pollution \u6bd4\u7387\u901a\u8fc7 pollution-total / demand-total \u8ba1\u7b97\u5f97\u51fa\u3002</li> <li>\u8be5\u673a\u5236\u5728\u786c\u4ef6\u4e0a\u5f00\u9500\u6781\u5c0f\uff0c\u4ec5\u9700\u4e00\u4e2a 4096-entry bit vector\uff0c\u65e0\u9700\u7ef4\u62a4\u5b8c\u6574\u7684\u9a71\u9010\u5386\u53f2\uff0c\u662f\u4e00\u79cd\u9ad8\u6548\u8fd1\u4f3c\u65b9\u6848\u3002</li> </ul> \u7ec4\u4ef6 \u529f\u80fd CacheBlockAddress[11:0] \u5730\u5740\u4f4e\u4f4d\uff0c\u53c2\u4e0e XOR \u8fd0\u7b97\u751f\u6210\u8fc7\u6ee4\u5668\u7d22\u5f15 CacheBlockAddress[23:12] \u5730\u5740\u9ad8\u4f4d\uff0c\u53c2\u4e0e XOR \u8fd0\u7b97\u751f\u6210\u8fc7\u6ee4\u5668\u7d22\u5f15 XOR \u5c06\u9ad8\u4f4e\u4f4d\u5f02\u6216\uff0c\u751f\u6210\u8fc7\u6ee4\u5668\u8bbf\u95ee\u7d22\u5f15 Pollution Filter (bit-vector) \u6838\u5fc3\u5b58\u50a8\u7ed3\u6784\uff0c\u8bb0\u5f55\u54ea\u4e9b\u5757\u56e0\u9884\u53d6\u88ab\u9a71\u9010 Set Bit (1) \u8868\u793a\u67d0\u5757\u56e0\u9884\u53d6\u88ab\u9a71\u9010\uff0c\u53ef\u80fd\u9020\u6210\u6c61\u67d3 Reset Bit (0) \u8868\u793a\u9884\u53d6\u5757\u5df2\u63d2\u5165\u7f13\u5b58\uff0c\u6e05\u9664\u6c61\u67d3\u6807\u8bb0 <ul> <li>\u6b64\u8bbe\u8ba1\u5de7\u5999\u5229\u7528\u4e86 Bloom filter \u7684\u7a7a\u95f4\u6548\u7387\u548c\u6982\u7387\u6027\u5224\u65ad\u7279\u6027\uff0c\u5728\u4e0d\u589e\u52a0\u590d\u6742\u5ea6\u7684\u524d\u63d0\u4e0b\uff0c\u5b9e\u73b0\u4e86\u5bf9 cache pollution \u7684\u52a8\u6001\u76d1\u63a7\uff0c\u4e3a\u540e\u7eed\u8c03\u6574\u9884\u53d6\u5668\u884c\u4e3a\u63d0\u4f9b\u5173\u952e\u53cd\u9988\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#37b369db103b2e05a4f6345de6d966d64132e588811d2bb0658add10438d7d10jpg","title":"37b369db103b2e05a4f6345de6d966d64132e588811d2bb0658add10438d7d10.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u4e86\u4e00\u4e2a\u7528\u4e8e\u53cd\u9988\u5bfc\u5411\u9884\u53d6\uff08Feedback Directed Prefetching, FDP\uff09\u673a\u5236\u4e2d\u7684\u8ba1\u6570\u5668\u66f4\u65b0\u516c\u5f0f\uff0c\u5176\u6838\u5fc3\u76ee\u7684\u662f\u5728\u7a0b\u5e8f\u6267\u884c\u7684\u4e0d\u540c\u9636\u6bb5\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u884c\u4e3a\u3002</li> <li>\u516c\u5f0f\u5b9a\u4e49\u4e3a\uff1a<code>CounterValue = \u00bd CounterValueAtTheBeginningOfTheInterval + \u00bd CounterValueDuringInterval</code>\uff0c\u8868\u660e\u5f53\u524d\u8ba1\u6570\u503c\u662f\u4e0a\u4e00\u91c7\u6837\u533a\u95f4\u672b\u503c\u4e0e\u5f53\u524d\u533a\u95f4\u5185\u65b0\u589e\u503c\u7684\u7b49\u6743\u91cd\u5e73\u5747\u3002</li> <li>\u6b64\u8bbe\u8ba1\u8d4b\u4e88\u8fd1\u671f\u884c\u4e3a\u66f4\u9ad8\u6743\u91cd\uff0c\u540c\u65f6\u4fdd\u7559\u5386\u53f2\u8d8b\u52bf\u4fe1\u606f\uff0c\u4f7f\u7cfb\u7edf\u80fd\u5feb\u901f\u54cd\u5e94\u7a0b\u5e8f\u76f8\u4f4d\u53d8\u5316\uff0c\u907f\u514d\u56e0\u77ac\u65f6\u6ce2\u52a8\u5bfc\u81f4\u8bef\u5224\u3002</li> <li>\u8be5\u516c\u5f0f\u5e94\u7528\u4e8eFDP\u4e2d\u6240\u6709\u5173\u952e\u6307\u6807\u8ba1\u6570\u5668\uff0c\u5305\u62ec\uff1a</li> <li><code>pref-total</code>\uff08\u603b\u9884\u53d6\u8bf7\u6c42\u6570\uff09</li> <li><code>used-total</code>\uff08\u6709\u7528\u9884\u53d6\u6570\uff09</li> <li><code>late-total</code>\uff08\u8fdf\u5230\u9884\u53d6\u6570\uff09</li> <li><code>pollution-total</code>\uff08\u7531\u9884\u53d6\u5f15\u53d1\u7684\u9700\u6c42\u7f3a\u5931\u6570\uff09</li> <li><code>demand-total</code>\uff08\u603b\u9700\u6c42\u7f3a\u5931\u6570\uff09</li> <li>\u8ba1\u6570\u5668\u66f4\u65b0\u89e6\u53d1\u6761\u4ef6\u57fa\u4e8eL2\u7f13\u5b58\u5757\u9a71\u9010\u6b21\u6570\uff0c\u5f53\u9a71\u9010\u8ba1\u6570\u5668<code>eviction-count</code>\u8d85\u8fc7\u9759\u6001\u9608\u503c<code>Tinterval</code>\uff08\u5b9e\u9a8c\u4e2d\u8bbe\u4e3a8192\uff09\u65f6\uff0c\u542f\u52a8\u4e00\u6b21\u91c7\u6837\u95f4\u9694\u7ed3\u675f\u4e0e\u8ba1\u6570\u5668\u66f4\u65b0\u3002</li> <li>\u8be5\u673a\u5236\u786e\u4fdd\u4e86\u53cd\u9988\u4fe1\u606f\u7684\u65f6\u6548\u6027\u4e0e\u7a33\u5b9a\u6027\uff0c\u662f\u5b9e\u73b0\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u6fc0\u8fdb\u7a0b\u5ea6\u548c\u7f13\u5b58\u63d2\u5165\u7b56\u7565\u7684\u57fa\u7840\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#table-1-stream-prefetcher-configurations","title":"Table 1. Stream prefetcher configurations","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a Table 1. Stream prefetcher configurations\uff0c\u5c55\u793a\u4e86\u6d41\u5f0f\u9884\u53d6\u5668\uff08Stream prefetcher\uff09\u7684\u4e94\u79cd\u4e0d\u540c\u914d\u7f6e\uff0c\u7528\u4e8e\u5b9a\u4e49\u5176\u201c\u6fc0\u8fdb\u7a0b\u5ea6\u201d\uff08Aggressiveness\uff09\uff0c\u5e76\u901a\u8fc7 Prefetch Distance \u548c Prefetch Degree \u4e24\u4e2a\u53c2\u6570\u8fdb\u884c\u91cf\u5316\u63a7\u5236\u3002</li> <li>\u8868\u683c\u7ed3\u6784\u6e05\u6670\uff0c\u5305\u542b\u56db\u5217\uff1aDyn. Config. Counter\u3001Aggressiveness\u3001Pref. Distance\u3001Pref. Degree\uff0c\u5206\u522b\u5bf9\u5e94\u52a8\u6001\u914d\u7f6e\u8ba1\u6570\u5668\u503c\u3001\u9884\u53d6\u5668\u884c\u4e3a\u63cf\u8ff0\u3001\u9884\u53d6\u8ddd\u79bb\u548c\u9884\u53d6\u5ea6\u3002</li> <li>\u52a8\u6001\u914d\u7f6e\u8ba1\u6570\u5668\u662f\u4e00\u4e2a 3-bit \u9971\u548c\u8ba1\u6570\u5668\uff0c\u8303\u56f4\u4ece 1 \u5230 5\uff0c\u521d\u59cb\u503c\u8bbe\u4e3a 3\uff08Middle-of-the-Road\uff09\uff0c\u7528\u4e8e\u5728\u8fd0\u884c\u65f6\u6839\u636e\u53cd\u9988\u673a\u5236\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u884c\u4e3a\u3002</li> <li>\u5404\u914d\u7f6e\u53c2\u6570\u5982\u4e0b\uff1a</li> </ul> Dyn. Config. Counter Aggressiveness Pref. Distance Pref. Degree 1 Very Conservative 4 1 2 Conservative 8 1 3 Middle-of-the-Road 16 2 4 Aggressive 32 4 5 Very Aggressive 64 4 <ul> <li>Prefetch Distance \u5b9a\u4e49\u4e86\u9884\u53d6\u5668\u5728\u9700\u6c42\u8bbf\u95ee\u6d41\u4e4b\u524d\u53ef\u4ee5\u63d0\u524d\u591a\u8fdc\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\uff0c\u6570\u503c\u8d8a\u5927\u8868\u793a\u8d8a\u6fc0\u8fdb\u3002</li> <li>Prefetch Degree \u5b9a\u4e49\u4e86\u6bcf\u6b21\u9884\u53d6\u64cd\u4f5c\u4e2d\u8bf7\u6c42\u7684\u7f13\u5b58\u5757\u6570\u91cf\uff0c\u6570\u503c\u8d8a\u5927\u8868\u793a\u5355\u6b21\u9884\u53d6\u91cf\u8d8a\u5927\u3002</li> <li>\u8be5\u8868\u662f Feedback Directed Prefetching (FDP) \u673a\u5236\u7684\u6838\u5fc3\u7ec4\u6210\u90e8\u5206\uff0c\u7528\u4e8e\u5728\u8fd0\u884c\u65f6\u6839\u636e\u9884\u53d6\u51c6\u786e\u7387\u3001\u5ef6\u8fdf\u548c\u6c61\u67d3\u7b49\u6307\u6807\u52a8\u6001\u5207\u6362\u914d\u7f6e\uff0c\u4ee5\u4f18\u5316\u6027\u80fd\u4e0e\u5e26\u5bbd\u6548\u7387\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#259f1d313ba55402790845e6f0b34855d99d5731a54f5972b0a78ef7c2b6c014jpg","title":"259f1d313ba55402790845e6f0b34855d99d5731a54f5972b0a78ef7c2b6c014.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u7684\u662f Table 2\uff0c\u6807\u9898\u4e3a \u201cHow to adapt? Use of the three metrics to adjust the aggressiveness of the prefetcher\u201d\uff0c\u7528\u4e8e\u8bf4\u660e\u5982\u4f55\u6839\u636e\u4e09\u4e2a\u53cd\u9988\u6307\u6807\u52a8\u6001\u8c03\u6574\u786c\u4ef6\u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u7a0b\u5ea6\u3002</li> <li>\u8868\u683c\u5171\u5305\u542b 12 \u79cd\u60c5\u51b5\uff08Case 1\u201312\uff09\uff0c\u6bcf\u79cd\u60c5\u51b5\u7531\u4e09\u4e2a\u8f93\u5165\u6307\u6807\u51b3\u5b9a\uff1aPrefetch Accuracy\uff08\u9884\u53d6\u51c6\u786e\u7387\uff09\u3001Prefetch Lateness\uff08\u9884\u53d6\u5ef6\u8fdf\uff09\u3001Cache Pollution\uff08\u7f13\u5b58\u6c61\u67d3\uff09\uff0c\u5e76\u636e\u6b64\u51b3\u5b9a Dynamic Configuration Counter Update\uff08\u52a8\u6001\u914d\u7f6e\u8ba1\u6570\u5668\u66f4\u65b0\uff09\u53ca\u5176\u539f\u56e0\u3002</li> <li>\u4e09\u4e2a\u8f93\u5165\u6307\u6807\u88ab\u5212\u5206\u4e3a\u4e0d\u540c\u7b49\u7ea7\uff1a</li> <li>Prefetch Accuracy\uff1aHigh\u3001Medium\u3001Low</li> <li>Prefetch Lateness\uff1aLate\u3001Not-Late</li> <li>Cache Pollution\uff1aPolluting\u3001Not-Polluting</li> <li>\u8f93\u51fa\u52a8\u4f5c\u5305\u62ec\u4e09\u79cd\uff1aIncrement\uff08\u589e\u52a0\u6fc0\u8fdb\u7a0b\u5ea6\uff09\u3001Decrement\uff08\u964d\u4f4e\u6fc0\u8fdb\u7a0b\u5ea6\uff09\u3001No Change\uff08\u4fdd\u6301\u4e0d\u53d8\uff09\uff0c\u5e76\u9644\u5e26\u7b80\u8981\u7406\u7531\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u8868\u683c\u5185\u5bb9\u7684\u7ed3\u6784\u5316\u5448\u73b0\uff1a</p> Case Prefetch Accuracy Prefetch Lateness Cache Pollution Dynamic Configuration Counter Update (reason) 1 High Late Not-Polluting Increment (to increase timeliness) 2 High Late Polluting Increment (to increase timeliness) 3 High Not-Late Not-Polluting No Change (best case configuration) 4 High Not-Late Polluting Decrement (to reduce pollution) 5 Medium Late Not-Polluting Increment (to increase timeliness) 6 Medium Late Polluting Decrement (to reduce pollution) 7 Medium Not-Late Not-Polluting No Change (to keep the benefits of timely prefetches) 8 Medium Not-Late Polluting Decrement (to reduce pollution) 9 Low Late Not-Polluting Decrement (to save bandwidth) 10 Low Late Polluting Decrement (to reduce pollution) 11 Low Not-Late Not-Polluting No Change (to keep the benefits of timely prefetches) 12 Low Not-Late Polluting Decrement (to reduce pollution and save bandwidth) <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5f53\u9884\u53d6\u51c6\u786e\u7387\u9ad8\u4e14\u65e0\u6c61\u67d3\u65f6\uff08\u5982 Case 3\uff09\uff0c\u7cfb\u7edf\u7ef4\u6301\u5f53\u524d\u914d\u7f6e\uff0c\u89c6\u4e3a\u201c\u6700\u4f73\u72b6\u6001\u201d\u3002</li> <li>\u5f53\u9884\u53d6\u5ef6\u8fdf\u9ad8\u4f46\u51c6\u786e\u7387\u9ad8\u65f6\uff08\u5982 Case 1, 2, 5\uff09\uff0c\u7cfb\u7edf\u503e\u5411\u4e8e\u589e\u52a0\u6fc0\u8fdb\u7a0b\u5ea6\u4ee5\u63d0\u5347\u53ca\u65f6\u6027\uff0c\u5373\u4f7f\u5b58\u5728\u6c61\u67d3\u4e5f\u4f18\u5148\u4fdd\u8bc1\u547d\u4e2d\u3002</li> <li>\u5f53\u9884\u53d6\u51c6\u786e\u7387\u4f4e\u6216\u9020\u6210\u6c61\u67d3\u65f6\uff08\u5982 Case 4, 6, 8, 9, 10, 12\uff09\uff0c\u7cfb\u7edf\u503e\u5411\u4e8e\u964d\u4f4e\u6fc0\u8fdb\u7a0b\u5ea6\uff0c\u4ee5\u8282\u7701\u5e26\u5bbd\u6216\u51cf\u5c11\u6c61\u67d3\u3002</li> <li>Case 11 \u662f\u552f\u4e00\u5728\u4f4e\u51c6\u786e\u7387\u4e0b\u4ecd\u4fdd\u6301\u4e0d\u53d8\u7684\u60c5\u51b5\uff0c\u524d\u63d0\u662f\u9884\u53d6\u4e0d\u5ef6\u8fdf\u4e14\u65e0\u6c61\u67d3\u2014\u2014\u8868\u660e\u7cfb\u7edf\u8ba4\u4e3a\u6b64\u65f6\u9884\u53d6\u867d\u4e0d\u7cbe\u51c6\u4f46\u5c1a\u53ef\u63a5\u53d7\uff0c\u65e0\u9700\u8c03\u6574\u3002</li> <li>\u8be5\u8868\u662f Feedback Directed Prefetching (FDP) \u673a\u5236\u7684\u6838\u5fc3\u51b3\u7b56\u903b\u8f91\uff0c\u4f53\u73b0\u4e86\u5176\u52a8\u6001\u9002\u5e94\u6027\u548c\u591a\u7ef4\u5ea6\u6743\u8861\u80fd\u529b\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#5149595d2a64efbab3f11de1ed2f84818ee3734e5d23f036f1d78e03ff35ec5cjpg","title":"5149595d2a64efbab3f11de1ed2f84818ee3734e5d23f036f1d78e03ff35ec5c.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u4e86\u4e00\u4e2a\u5305\u542b\u516d\u4e2a\u5173\u952e\u9608\u503c\u53c2\u6570\u7684\u8868\u683c\uff0c\u8fd9\u4e9b\u53c2\u6570\u7528\u4e8e\u63a7\u5236 Feedback Directed Prefetching (FDP) \u673a\u5236\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u884c\u4e3a\u3002</li> <li>\u8868\u683c\u4e2d\u7684\u53c2\u6570\u53ca\u5176\u9ed8\u8ba4\u503c\u5982\u4e0b\uff1a</li> <li>Ahigh: 0.75 \u2014\u2014 \u7528\u4e8e\u5224\u65ad\u9884\u53d6\u51c6\u786e\u7387\u662f\u5426\u201c\u9ad8\u201d\u7684\u9608\u503c\u3002</li> <li>Alow: 0.40 \u2014\u2014 \u7528\u4e8e\u5224\u65ad\u9884\u53d6\u51c6\u786e\u7387\u662f\u5426\u201c\u4f4e\u201d\u7684\u9608\u503c\u3002</li> <li>Tlateness: 0.01 \u2014\u2014 \u7528\u4e8e\u5224\u65ad\u9884\u53d6\u662f\u5426\u201c\u5ef6\u8fdf\u201d\u7684\u9608\u503c\uff08\u5373\u5ef6\u8fdf\u6bd4\u4f8b\u8d85\u8fc7\u6b64\u503c\u5219\u89c6\u4e3a\u201clate\u201d\uff09\u3002</li> <li>Tpollution: 0.005 \u2014\u2014 \u7528\u4e8e\u5224\u65ad\u9884\u53d6\u662f\u5426\u9020\u6210\u201c\u9ad8\u6c61\u67d3\u201d\u7684\u9608\u503c\uff08\u5373\u6c61\u67d3\u6bd4\u4f8b\u8d85\u8fc7\u6b64\u503c\u5219\u89c6\u4e3a\u201cpolluting\u201d\uff09\u3002</li> <li>Phigh: 0.25 \u2014\u2014 \u7528\u4e8e\u5224\u65ad\u7f13\u5b58\u6c61\u67d3\u7a0b\u5ea6\u662f\u5426\u201c\u9ad8\u201d\u7684\u9608\u503c\uff08\u51b3\u5b9a\u63d2\u5165\u4f4d\u7f6e\u4e3a LRU\uff09\u3002</li> <li>Plow: 0.005 \u2014\u2014 \u7528\u4e8e\u5224\u65ad\u7f13\u5b58\u6c61\u67d3\u7a0b\u5ea6\u662f\u5426\u201c\u4f4e\u201d\u7684\u9608\u503c\uff08\u51b3\u5b9a\u63d2\u5165\u4f4d\u7f6e\u4e3a MID\uff09\u3002</li> </ul> \u53c2\u6570\u540d \u9608\u503c \u7528\u9014\u8bf4\u660e Ahigh 0.75 \u51c6\u786e\u7387\u9ad8\u4e8e\u6b64\u503c\u89c6\u4e3a\u201c\u9ad8\u201d\uff0c\u53ef\u80fd\u589e\u52a0\u9884\u53d6\u6fc0\u8fdb\u6027\u3002 Alow 0.40 \u51c6\u786e\u7387\u4f4e\u4e8e\u6b64\u503c\u89c6\u4e3a\u201c\u4f4e\u201d\uff0c\u53ef\u80fd\u964d\u4f4e\u9884\u53d6\u6fc0\u8fdb\u6027\u3002 Tlateness 0.01 \u5ef6\u8fdf\u6bd4\u4f8b\u9ad8\u4e8e\u6b64\u503c\u89c6\u4e3a\u201c\u5ef6\u8fdf\u201d\uff0c\u5f71\u54cd\u6fc0\u8fdb\u6027\u8c03\u6574\u3002 Tpollution 0.005 \u6c61\u67d3\u6bd4\u4f8b\u9ad8\u4e8e\u6b64\u503c\u89c6\u4e3a\u201c\u6c61\u67d3\u201d\uff0c\u89e6\u53d1\u964d\u7ea7\u7b56\u7565\u3002 Phigh 0.25 \u6c61\u67d3\u9ad8\u4e8e\u6b64\u503c\u65f6\uff0c\u9884\u53d6\u5757\u63d2\u5165 LRU \u4f4d\u7f6e\u3002 Plow 0.005 \u6c61\u67d3\u4f4e\u4e8e\u6b64\u503c\u65f6\uff0c\u9884\u53d6\u5757\u63d2\u5165 MID \u4f4d\u7f6e\u3002 <ul> <li>\u8fd9\u4e9b\u9608\u503c\u662f\u9759\u6001\u8bbe\u5b9a\uff0c\u4f5c\u8005\u5728\u6587\u4e2d\u6307\u51fa\uff0c\u901a\u8fc7\u52a8\u6001\u8c03\u4f18\u6216\u589e\u52a0\u9608\u503c\u5c42\u7ea7\u53ef\u8fdb\u4e00\u6b65\u63d0\u5347\u6027\u80fd\uff0c\u4f46\u672a\u5728\u672c\u7814\u7a76\u4e2d\u5c55\u5f00\u3002</li> <li>\u5728\u4e0d\u540c\u7cfb\u7edf\u73af\u5883\u4e0b\uff08\u5982\u66f4\u9ad8\u5185\u5b58\u5e26\u5bbd\u7ade\u4e89\u3001\u66f4\u5927\u7f13\u5b58\u538b\u529b\uff09\uff0c\u53ef\u9002\u5f53\u8c03\u6574\u8fd9\u4e9b\u9608\u503c\u4ee5\u4f18\u5316 FDP \u884c\u4e3a\u3002</li> <li>\u4f8b\u5982\uff0c\u5728\u5e26\u5bbd\u7d27\u5f20\u7cfb\u7edf\u4e2d\uff0c\u53ef\u63d0\u9ad8 Ahigh \u548c Alow \u4ee5\u9650\u5236\u9884\u53d6\u5668\u8fc7\u4e8e\u6fc0\u8fdb\uff1b\u5728\u7f13\u5b58\u7a7a\u95f4\u7d27\u5f20\u7cfb\u7edf\u4e2d\uff0c\u53ef\u964d\u4f4e Tpollution\u3001Phigh \u6216 Plow \u4ee5\u51cf\u5c11\u6c61\u67d3\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#table-3-baseline-processor-configuration","title":"Table 3. Baseline processor configuration","text":"<ul> <li>\u5904\u7406\u5668\u6838\u5fc3\u67b6\u6784\uff1a\u91c7\u7528 4 GHz \u4e3b\u9891\u7684\u8d85\u6807\u91cf\u3001\u4e71\u5e8f\u6267\u884c\u8bbe\u8ba1\uff0c\u5177\u5907 20-cycle \u7684\u6700\u5c0f\u5206\u652f\u9884\u6d4b\u9519\u8bef\u60e9\u7f5a\u673a\u5236\u3002</li> <li>\u5206\u652f\u9884\u6d4b\u5668\uff1a\u914d\u7f6e\u4e3a aggressive hybrid branch predictor\uff0c\u5305\u542b 64K-entry gshare\u300164K-entry per-address \u4e0e 64K-entry selector\uff0c\u5e76\u7cbe\u786e\u5efa\u6a21\u9519\u8bef\u8def\u5f84\u6267\u884c\u884c\u4e3a\u3002</li> <li>\u6307\u4ee4\u7a97\u53e3\u4e0e\u6267\u884c\u6838\u5fc3\uff1a</li> <li>\u6307\u4ee4\u7a97\u53e3\u652f\u6301 128-entry reorder buffer\uff0c\u914d\u5907 128-entry INT \u548c 128-entry FP physical register files\uff0c\u4ee5\u53ca 64-entry store buffer\u3002</li> <li>\u6267\u884c\u6838\u5fc3\u4e3a 8-wide\uff0c\u9664\u6d6e\u70b9\u9664\u6cd5\u5916\u5747\u5b8c\u5168\u6d41\u6c34\u7ebf\u5316\uff0c\u5e76\u914d\u5907\u5b8c\u6574\u65c1\u8def\u7f51\u7edc\u3002</li> <li>\u7247\u4e0a\u7f13\u5b58\u7cfb\u7edf\uff1a</li> <li>L1 Instruction Cache\uff1a\u5bb9\u91cf 64KB\uff0c\u5ef6\u8fdf 2-cycle\u3002</li> <li>L1 Data Cache\uff1a\u5bb9\u91cf 64KB\uff0c4-way set associative\uff0c8 banks\uff0c\u5ef6\u8fdf 2-cycle\uff0c\u652f\u6301\u6bcf\u5468\u671f 4 load accesses\u3002</li> <li>L2 Cache\uff1a\u5bb9\u91cf 1MB\uff0c16-way unified\uff0c8 banks\uff0c\u5ef6\u8fdf 10-cycle\uff0c\u914d\u5907 128 L2 MSHRs\uff0c1 read port \u4e0e 1 write port\uff0c\u91c7\u7528 LRU replacement policy\uff0c\u5757\u5927\u5c0f\u4e3a 64B\u3002</li> <li>\u603b\u7ebf\u4e0e\u5185\u5b58\u5b50\u7cfb\u7edf\uff1a</li> <li>\u4e3b\u5185\u5b58\u5ef6\u8fdf\u4e3a 500-cycle\uff0c\u91c7\u7528 32 DRAM banks\uff0c32B-wide split-transaction core-to-memory bus\uff0c\u9891\u7387\u6bd4\u4e3a 4:1\uff0c\u5e26\u5bbd\u4e0a\u9650\u4e3a 4.5 GB/s\u3002</li> <li>\u6700\u5927\u5141\u8bb8 128 outstanding misses \u81f3\u4e3b\u5b58\uff0c\u7cbe\u786e\u5efa\u6a21\u94f6\u884c\u51b2\u7a81\u3001\u5e26\u5bbd\u4e89\u7528\u53ca\u961f\u5217\u5ef6\u8fdf\u3002</li> </ul> \u7ec4\u4ef6 \u914d\u7f6e\u8be6\u60c5 Pipeline 20-cycle \u5206\u652f\u8bef\u9884\u6d4b\u60e9\u7f5a\uff1b4 GHz \u5904\u7406\u5668 Branch Predictor aggressive hybrid (64K gshare, 64K per-address, 64K selector) Instruction Window 128-entry ROB; 128 INT/FP \u5bc4\u5b58\u5668\u6587\u4ef6; 64-entry store buffer Execution Core 8-wide \u5168\u6d41\u6c34\u7ebf\uff08FP divide \u9664\u5916\uff09 On-chip Caches L1I: 64KB, 2-cycle; L1D: 64KB, 4-way, 8 banks, 2-cycle, 4 loads/cycle L2: 1MB, 16-way, 8 banks, 10-cycle, 128 MSHRs, LRU, 64B \u5757 Buses and Memory 500-cycle \u5185\u5b58\u5ef6\u8fdf; 32 banks; 32B \u5bbd\u603b\u7ebf; 4.5 GB/s \u5e26\u5bbd; 128 outstanding misses <ul> <li>\u5173\u952e\u8bbe\u8ba1\u76ee\u6807\uff1a\u8be5\u914d\u7f6e\u65e8\u5728\u6a21\u62df\u9ad8\u6027\u80fd\u73b0\u4ee3\u5904\u7406\u5668\uff0c\u91cd\u70b9\u4f18\u5316 memory latency hiding \u4e0e bandwidth efficiency\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u8bc4\u4f30\u786c\u4ef6\u9884\u53d6\u673a\u5236\uff08\u5982 stream prefetcher\uff09\u5728\u771f\u5b9e\u5185\u5b58\u538b\u529b\u4e0b\u7684\u8868\u73b0\u3002\u6240\u6709\u7f13\u5b58\u548c\u5185\u5b58\u7ed3\u6784\u5747\u6309\u5b9e\u9645\u786c\u4ef6\u884c\u4e3a\u5efa\u6a21\uff0c\u786e\u4fdd\u5b9e\u9a8c\u7ed3\u679c\u5177\u5907\u9ad8\u53ef\u4fe1\u5ea6\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#4028cd0b36439c3ce1a5b505ab56f6517b583a1a388f71de2746b078f2483960jpg","title":"4028cd0b36439c3ce1a5b505ab56f6517b583a1a388f71de2746b078f2483960.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u4e00\u5f20\u6570\u636e\u8868\u683c\uff0c\u6807\u9898\u4e3a\u201cTable 4. Number of prefetches sent by a very aggressive stream prefetcher for each benchmark in the SPEC CPU2000 suite\u201d\uff0c\u7528\u4e8e\u5c55\u793a\u5728SPEC CPU2000\u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6\u4e2d\uff0c\u91c7\u7528Very Aggressive\u914d\u7f6e\u7684\u6d41\u5f0f\u9884\u53d6\u5668\uff08stream prefetcher\uff09\u5411\u5185\u5b58\u53d1\u9001\u7684\u9884\u53d6\u8bf7\u6c42\u6570\u91cf\u3002</li> <li>\u8868\u683c\u5305\u542b13\u4e2aSPEC CPU2000\u57fa\u51c6\u7a0b\u5e8f\uff0c\u6309\u5217\u6392\u5217\uff0c\u5206\u522b\u4e3a\uff1abzip2, crafty, eon, gap, gcc, gzip, mcf, parser, perlbench, twolf, vortex, vpr\u3002</li> <li>\u6570\u636e\u4ee5\u5343\u6b21\uff08K\uff09\u4e3a\u5355\u4f4d\uff0c\u7cbe\u786e\u5230\u6574\u6570\uff0c\u53cd\u6620\u4e86\u5404\u7a0b\u5e8f\u5728250M\u6307\u4ee4\u6a21\u62df\u8fd0\u884c\u671f\u95f4\u4ea7\u751f\u7684\u9884\u53d6\u8bf7\u6c42\u603b\u91cf\u3002</li> <li>\u5173\u952e\u6570\u636e\u70b9\uff1a<ul> <li>gap \u7a0b\u5e8f\u751f\u6210\u4e86\u6700\u591a\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u9ad8\u8fbe 1656K\uff0c\u8868\u660e\u5176\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u9ad8\u5ea6\u53ef\u9884\u6d4b\u4e14\u9002\u5408\u6fc0\u8fdb\u9884\u53d6\u3002</li> <li>mcf \u7a0b\u5e8f\u7d27\u968f\u5176\u540e\uff0c\u751f\u6210 2585K \u9884\u53d6\u8bf7\u6c42\uff0c\u540c\u6837\u663e\u793a\u51fa\u5f3a\u70c8\u7684\u53ef\u9884\u53d6\u6027\u3002</li> <li>vortex \u548c vpr \u5206\u522b\u751f\u6210 591K \u548c 246K \u8bf7\u6c42\uff0c\u5c5e\u4e8e\u4e2d\u7b49\u6d3b\u8dc3\u5ea6\u3002</li> <li>crafty\u3001eon\u3001gcc\u3001gzip\u3001parser\u3001perlbench\u3001twolf \u7684\u9884\u53d6\u8bf7\u6c42\u6570\u91cf\u5747\u4f4e\u4e8e100K\uff0c\u5176\u4e2d twolf \u4ec5\u4e3a 2749\uff0c\u662f\u8868\u4e2d\u552f\u4e00\u672a\u8fbe\u5230\u5343\u4f4d\u7684\u7a0b\u5e8f\uff0c\u8868\u660e\u8fd9\u4e9b\u7a0b\u5e8f\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u8981\u4e48\u4e0d\u53ef\u9884\u6d4b\uff0c\u8981\u4e48\u5bf9\u9884\u53d6\u4e0d\u654f\u611f\u3002</li> </ul> </li> <li>\u6b64\u8868\u683c\u662f\u8bba\u6587\u8bc4\u4f30\u53cd\u9988\u5bfc\u5411\u9884\u53d6\u673a\u5236\uff08FDP\uff09\u6027\u80fd\u7684\u57fa\u7840\uff0c\u5b83\u5e2e\u52a9\u7b5b\u9009\u51fa\u90a3\u4e9b\u9884\u53d6\u5668\u6d3b\u8dc3\u5ea6\u9ad8\u3001\u6709\u6f5c\u529b\u901a\u8fc7\u52a8\u6001\u8c03\u6574\u83b7\u5f97\u663e\u8457\u6027\u80fd\u6216\u5e26\u5bbd\u6536\u76ca\u7684\u7a0b\u5e8f\u3002</li> </ul> Benchmark Prefetch Requests (K) bzip2 336K crafty 59K eon 4969 gap 1656K gcc 110K gzip 31K mcf 2585K parser 515K perlbench 9218 twolf 2749 vortex 591K vpr 246K"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#e8977b49d81ed9a8d8d7d2f478066baefca0a897ad4b15787dc32503b6ad69ecjpg","title":"e8977b49d81ed9a8d8d7d2f478066baefca0a897ad4b15787dc32503b6ad69ec.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u4e00\u5f20\u6570\u636e\u8868\u683c\uff0c\u6807\u9898\u4e3a\u201cTable 4. Number of prefetches sent by a very aggressive stream prefetcher for each benchmark in the SPEC CPU2000 suite\u201d\uff0c\u7528\u4e8e\u5c55\u793a\u5728SPEC CPU2000\u57fa\u51c6\u6d4b\u8bd5\u96c6\u4e2d\uff0c\u6bcf\u4e2a\u7a0b\u5e8f\u5728\u91c7\u7528Very Aggressive\u914d\u7f6e\u7684\u6d41\u5f0f\u9884\u53d6\u5668\u65f6\u6240\u53d1\u51fa\u7684\u9884\u53d6\u8bf7\u6c42\u6570\u91cf\u3002</li> <li>\u8868\u683c\u5171\u5305\u542b17\u4e2a\u5185\u5b58\u5bc6\u96c6\u578b\u57fa\u51c6\u7a0b\u5e8f\uff0c\u5176\u540d\u79f0\u6309\u987a\u5e8f\u6392\u5217\u5982\u4e0b\uff1aammp, applu, apsi, art, equake, facerec, fma3d, galgel, lucas, mesa, mgrid, sixtrack, swim, wupwise\u3002</li> <li>\u6bcf\u4e2a\u7a0b\u5e8f\u5bf9\u5e94\u7684\u9884\u53d6\u8bf7\u6c42\u6570\u91cf\u4ee5\u201cK\u201d\uff08\u5343\uff09\u4e3a\u5355\u4f4d\u8868\u793a\uff0c\u5177\u4f53\u6570\u503c\u5982\u4e0b\uff1a</li> </ul> Benchmark Prefetch Requests (K) ammp 1157K applu 6038K apsi 8656 art 13319K equake 2414K facerec 2437K fma3d 3643 galgel 243K lucas 1103 mesa 273K mgrid 2185K sixtrack 292K swim 8766K wupwise 799K <ul> <li>\u6570\u636e\u663e\u793a\uff0c\u4e0d\u540c\u7a0b\u5e8f\u7684\u9884\u53d6\u8bf7\u6c42\u91cf\u5dee\u5f02\u5de8\u5927\u3002\u4f8b\u5982\uff0cart\u7a0b\u5e8f\u53d1\u51fa\u4e86\u9ad8\u8fbe13319K\u6b21\u9884\u53d6\u8bf7\u6c42\uff0c\u800clucas\u4ec5\u53d1\u51fa1103\u6b21\u3002</li> <li>\u6b64\u8868\u662f\u8bba\u6587\u8bc4\u4f30\u53cd\u9988\u5bfc\u5411\u9884\u53d6\u673a\u5236\uff08FDP\uff09\u6027\u80fd\u7684\u57fa\u7840\u6570\u636e\u4e4b\u4e00\uff0c\u7528\u4e8e\u7b5b\u9009\u51fa\u90a3\u4e9b\u9884\u53d6\u5668\u6d3b\u8dc3\u5ea6\u9ad8\u3001\u5177\u6709\u663e\u8457\u4f18\u5316\u6f5c\u529b\u7684\u7a0b\u5e8f\u8fdb\u884c\u91cd\u70b9\u5206\u6790\u3002</li> <li>\u5728\u8bba\u6587\u7b2c4.2\u8282\u4e2d\u660e\u786e\u6307\u51fa\uff0c\u7814\u7a76\u805a\u7126\u4e8e\u90a3\u4e9b\u5728\u6700\u6fc0\u8fdb\u9884\u53d6\u914d\u7f6e\u4e0b\u53d1\u9001\u81f3\u5c11200K\u9884\u53d6\u8bf7\u6c42\u7684\u7a0b\u5e8f\uff0c\u6b64\u8868\u4e2d\u7684\u6240\u6709\u7a0b\u5e8f\u5747\u6ee1\u8db3\u8be5\u6761\u4ef6\uff0c\u56e0\u6b64\u88ab\u7eb3\u5165\u4e3b\u8981\u8bc4\u4f30\u8303\u56f4\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-5-dynamic-adjustment-of-prefetcher-aggressiveness","title":"Figure 5. Dynamic adjustment of prefetcher aggressiveness","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Figure 5\uff0c\u6807\u9898\u4e3a\u201cDynamic adjustment of prefetcher aggressiveness\u201d\uff0c\u7528\u4e8e\u6bd4\u8f83\u4e0d\u540c\u9884\u53d6\u5668\u914d\u7f6e\u572817\u4e2aSPEC CPU2000\u57fa\u51c6\u7a0b\u5e8f\u4e0a\u7684\u6027\u80fd\u8868\u73b0\uff0c\u4ee5 Instructions per Cycle (IPC) \u4e3a\u8861\u91cf\u6307\u6807\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u4e94\u79cd\u9884\u53d6\u5668\u914d\u7f6e\u7684\u67f1\u72b6\u56fe\u5bf9\u6bd4\uff1a</li> <li>No prefetching\uff08\u65e0\u9884\u53d6\uff09</li> <li>Very Conservative\uff08\u975e\u5e38\u4fdd\u5b88\uff09</li> <li>Middle-of-the-Road\uff08\u4e2d\u7b49\uff09</li> <li>Very Aggressive\uff08\u975e\u5e38\u6fc0\u8fdb\uff09</li> <li> <p>Dynamic Aggressiveness\uff08\u52a8\u6001\u6fc0\u8fdb\u6027\uff0c\u5373\u672c\u6587\u63d0\u51fa\u7684FDP\u673a\u5236\uff09</p> </li> <li> <p>\u5404\u914d\u7f6e\u5728\u4e0d\u540c\u57fa\u51c6\u7a0b\u5e8f\u4e0a\u7684IPC\u8868\u73b0\u5dee\u5f02\u663e\u8457\uff0c\u4f8b\u5982\uff1a</p> </li> <li>\u5728 mgrid\u3001wupwise\u3001equake \u7b49\u7a0b\u5e8f\u4e0a\uff0cVery Aggressive \u548c Dynamic Aggressiveness \u8868\u73b0\u4f18\u5f02\uff0cIPC\u8fdc\u9ad8\u4e8e\u5176\u4ed6\u914d\u7f6e\u3002</li> <li> <p>\u5728 applu\u3001ammp\u3001galgel \u7b49\u7a0b\u5e8f\u4e0a\uff0cVery Aggressive \u5bfc\u81f4IPC\u5927\u5e45\u4e0b\u964d\uff0c\u800c Dynamic Aggressiveness \u6210\u529f\u907f\u514d\u4e86\u6027\u80fd\u9000\u5316\uff0c\u751a\u81f3\u4f18\u4e8e No prefetching\u3002</p> </li> <li> <p>Dynamic Aggressiveness \u7684\u4f18\u52bf\u4f53\u73b0\u5728\uff1a</p> </li> <li>\u5728\u5927\u591a\u6570\u7a0b\u5e8f\u4e0a\u63a5\u8fd1\u6216\u8fbe\u5230\u6700\u4f73\u4f20\u7edf\u914d\u7f6e\u7684\u6027\u80fd\u3002</li> <li>\u5728\u539f\u672c\u56e0\u6fc0\u8fdb\u9884\u53d6\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u7684\u7a0b\u5e8f\uff08\u5982 applu\u3001ammp\uff09\u4e0a\uff0c\u901a\u8fc7\u52a8\u6001\u8c03\u6574\uff0c\u5c06\u6027\u80fd\u635f\u5931\u4ece48%\u4ee5\u4e0a\u964d\u4f4e\u81f36%\u4ee5\u5185\u3002</li> <li> <p>\u5e73\u5747IPC\u6bd4 Very Aggressive \u9ad8\u51fa 4.7%\uff0c\u6bd4 Middle-of-the-Road \u9ad8\u51fa 11.9%\u3002</p> </li> <li> <p>\u4e0b\u8868\u603b\u7ed3\u90e8\u5206\u5173\u952e\u7a0b\u5e8f\u7684IPC\u8868\u73b0\uff1a</p> </li> </ul> Benchmark No Prefetching Very Aggressive Dynamic Aggressiveness mgrid ~0.8 ~4.8 ~4.7 wupwise ~1.2 ~4.9 ~4.8 applu ~1.3 ~0.7 ~1.3 ammp ~1.4 ~0.7 ~1.3 equake ~0.8 ~3.0 ~2.9 <ul> <li>\u8be5\u56fe\u76f4\u89c2\u8bc1\u660e\uff1a\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u6fc0\u8fdb\u7a0b\u5ea6 \u80fd\u6709\u6548\u5e73\u8861\u6027\u80fd\u6536\u76ca\u4e0e\u98ce\u9669\uff0c\u5728\u4e0d\u540c\u7a0b\u5e8f\u76f8\u4f4d\u4e0b\u81ea\u52a8\u9009\u62e9\u6700\u4f18\u7b56\u7565\uff0c\u4ece\u800c\u5b9e\u73b0\u6574\u4f53\u6027\u80fd\u63d0\u5347\u5e76\u6d88\u9664\u8d1f\u5411\u5f71\u54cd\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-6-distribution-of-the-dynamic-aggressiveness-level","title":"Figure 6. Distribution of the dynamic aggressiveness level","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Figure 6. Distribution of the dynamic aggressiveness level\uff0c\u5373\u5728 Dynamic Aggressiveness \u673a\u5236\u4e0b\uff0c\u4e0d\u540c\u91c7\u6837\u533a\u95f4\u5185\u52a8\u6001\u914d\u7f6e\u8ba1\u6570\u5668\uff08Dynamic Configuration Counter\uff09\u7684\u5206\u5e03\u60c5\u51b5\u3002</li> <li>\u6a2a\u8f74\u4e3a SPEC CPU2000 \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\u540d\u79f0\uff0c\u7eb5\u8f74\u4e3a\u201c\u91c7\u6837\u533a\u95f4\u7684\u767e\u5206\u6bd4\u201d\uff0c\u8868\u793a\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\uff0c\u5404\u914d\u7f6e\u7b49\u7ea7\u88ab\u9009\u4e2d\u7684\u65f6\u95f4\u5360\u6bd4\u3002</li> <li>\u914d\u7f6e\u7b49\u7ea7\u5171\u4e94\u7ea7\uff0c\u4ece Very Conservative (1) \u5230 Very Aggressive (5)\uff0c\u5206\u522b\u7528\u4e0d\u540c\u586b\u5145\u56fe\u6848\u548c\u989c\u8272\u8868\u793a\uff1a</li> <li>Very Conservative (1)\uff1a\u6d45\u7070\u8272\u659c\u7ebf</li> <li>Conservative (2)\uff1a\u4e2d\u7070\u8272</li> <li>Middle-of-the-Road (3)\uff1a\u767d\u8272</li> <li>Aggressive (4)\uff1a\u6df1\u7070\u8272</li> <li>Very Aggressive (5)\uff1a\u9ed1\u8272</li> </ul> \u7a0b\u5e8f\u540d \u4e3b\u8981\u914d\u7f6e\u7b49\u7ea7 \u5360\u6bd4\u8d8b\u52bf\u8bf4\u660e bzip2 Very Aggressive (5) \u8d85\u8fc790%\u533a\u95f4\u4f7f\u7528\u6700\u6fc0\u8fdb\u914d\u7f6e gap Very Aggressive (5) \u51e0\u4e4e\u5168\u90e8\u533a\u95f4\u91c7\u7528\u6700\u6fc0\u8fdb\u914d\u7f6e mcf Very Aggressive (5) \u591a\u6570\u533a\u95f4\u4e3a\u6700\u6fc0\u8fdb\uff0c\u5c11\u91cf\u4e3a\u4fdd\u5b88 parser Very Aggressive (5) \u4e3b\u4f53\u4e3a\u6700\u6fc0\u8fdb\uff0c\u5c11\u91cf\u4e3a\u4e2d\u95f4\u6216\u4fdd\u5b88 vortex Very Aggressive (5) \u7edd\u5927\u90e8\u5206\u4e3a\u6700\u6fc0\u8fdb\uff0c\u6781\u5c11\u91cf\u4e3a\u4fdd\u5b88 vpr Very Aggressive (5) \u63a5\u8fd1100%\u4f7f\u7528\u6700\u6fc0\u8fdb\u914d\u7f6e ammp Very Conservative (1) \u8d85\u8fc798%\u533a\u95f4\u91c7\u7528\u6700\u4fdd\u5b88\u914d\u7f6e\uff0c\u56e0\u6fc0\u8fdb\u9884\u53d6\u4f1a\u4e25\u91cd\u635f\u5bb3\u6027\u80fd applu Very Conservative (1) \u8d85\u8fc798%\u533a\u95f4\u91c7\u7528\u6700\u4fdd\u5b88\u914d\u7f6e\uff0c\u4e0eammp\u7c7b\u4f3c\uff0c\u907f\u514d\u6027\u80fd\u635f\u5931 art Very Aggressive (5) \u51e0\u4e4e\u5168\u4e3a\u6700\u6fc0\u8fdb\u914d\u7f6e equake Very Aggressive (5) \u51e0\u4e4e\u5168\u4e3a\u6700\u6fc0\u8fdb\u914d\u7f6e facerec Very Aggressive (5) \u4e3b\u4f53\u4e3a\u6700\u6fc0\u8fdb\uff0c\u5c11\u91cf\u4e3a\u4fdd\u5b88 galgel Very Conservative (1) \u4e3b\u8981\u91c7\u7528\u6700\u4fdd\u5b88\u914d\u7f6e\uff0c\u56e0\u9884\u53d6\u6613\u9020\u6210\u6c61\u67d3\u548c\u6027\u80fd\u4e0b\u964d mesa Very Aggressive (5) \u4e3b\u4f53\u4e3a\u6700\u6fc0\u8fdb\uff0c\u5c11\u91cf\u4e3a\u4fdd\u5b88 mgrid Very Aggressive (5) \u51e0\u4e4e\u5168\u4e3a\u6700\u6fc0\u8fdb\u914d\u7f6e sixtrack Very Aggressive (5) \u4e3b\u4f53\u4e3a\u6700\u6fc0\u8fdb\uff0c\u5c11\u91cf\u4e3a\u4fdd\u5b88 swim Very Aggressive (5) \u4e3b\u4f53\u4e3a\u6700\u6fc0\u8fdb\uff0c\u5c11\u91cf\u4e3a\u4fdd\u5b88 wupwise Very Aggressive (5) \u8d85\u8fc798%\u533a\u95f4\u91c7\u7528\u6700\u6fc0\u8fdb\u914d\u7f6e\uff0c\u6027\u80fd\u53d7\u76ca\u663e\u8457 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5bf9\u4e8e applu\u3001ammp\u3001galgel \u7b49\u7a0b\u5e8f\uff0cFDP \u673a\u5236\u81ea\u52a8\u9009\u62e9 Very Conservative (1) \u914d\u7f6e\uff0c\u4ee5\u907f\u514d\u9884\u53d6\u9020\u6210\u7684\u6027\u80fd\u9000\u5316\u3002</li> <li>\u5bf9\u4e8e wupwise\u3001mgrid\u3001equake \u7b49\u7a0b\u5e8f\uff0cFDP \u673a\u5236\u51e0\u4e4e\u5168\u7a0b\u542f\u7528 Very Aggressive (5)\uff0c\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\u3002</li> <li>\u8fd9\u79cd\u52a8\u6001\u8c03\u6574\u80fd\u529b\u4f7f FDP \u80fd\u5728\u4e0d\u540c\u7a0b\u5e8f\u76f8\u4f4d\u4e2d\u81ea\u9002\u5e94\u5730\u9009\u62e9\u6700\u4f18\u9884\u53d6\u5f3a\u5ea6\uff0c\u4ece\u800c\u5728\u6574\u4f53\u4e0a\u63d0\u5347\u6027\u80fd\u5e76\u6d88\u9664\u4f20\u7edf\u56fa\u5b9a\u914d\u7f6e\u5e26\u6765\u7684\u8d1f\u5411\u5f71\u54cd\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-7-dynamic-adjustment-of-prefetch-insertion-policy","title":"Figure 7. Dynamic adjustment of prefetch insertion policy","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Figure 7. Dynamic adjustment of prefetch insertion policy\uff0c\u7528\u4e8e\u8bc4\u4f30\u4e0d\u540c\u7f13\u5b58\u63d2\u5165\u7b56\u7565\u5bf9\u6027\u80fd\uff08IPC\uff09\u7684\u5f71\u54cd\u3002</li> <li>\u6a2a\u8f74\u4e3a SPEC CPU2000 \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u7eb5\u8f74\u4e3a\u6bcf\u5468\u671f\u6307\u4ee4\u6570\uff08Instructions per Cycle\uff09\uff0c\u8861\u91cf\u6027\u80fd\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u516d\u79cd\u63d2\u5165\u7b56\u7565\u7684\u5bf9\u6bd4\uff1a</li> <li>No prefetching\uff1a\u65e0\u9884\u53d6\u3002</li> <li>LRU\uff1a\u9884\u53d6\u5757\u63d2\u5165 LRU \u4f4d\u7f6e\u3002</li> <li>LRU-4\uff1a\u63d2\u5165\u7b2c floor(n/4) \u4e2a\u6700\u4e45\u672a\u4f7f\u7528\u4f4d\u7f6e\u3002</li> <li>MID\uff1a\u63d2\u5165\u7b2c floor(n/2) \u4e2a\u6700\u4e45\u672a\u4f7f\u7528\u4f4d\u7f6e\u3002</li> <li>MRU\uff1a\u63d2\u5165 MRU \u4f4d\u7f6e\uff08\u9ed8\u8ba4\u7b56\u7565\uff09\u3002</li> <li>Dynamic Insertion\uff1a\u52a8\u6001\u8c03\u6574\u63d2\u5165\u4f4d\u7f6e\uff08\u57fa\u4e8e\u6c61\u67d3\u53cd\u9988\uff09\u3002</li> </ul> \u7b56\u7565 \u6027\u80fd\u8868\u73b0\u6982\u89c8 No prefetching \u57fa\u7ebf\u6027\u80fd\uff0c\u591a\u6570\u7a0b\u5e8f\u4f4e\u4e8e\u5176\u4ed6\u9884\u53d6\u7b56\u7565\u3002 LRU \u5728 applu\u3001ammp \u7b49\u7a0b\u5e8f\u4e0a\u8868\u73b0\u8f83\u597d\uff0c\u4f46\u5728 wupwise\u3001mgrid \u4e0a\u663e\u8457\u4f4e\u4e8e MRU\u3002 LRU-4 \u5e73\u5747\u6027\u80fd\u4f18\u4e8e MRU\uff0c\u63d0\u5347\u7ea6 3.2%\u3002 MID \u6027\u80fd\u4ecb\u4e8e LRU \u548c MRU \u4e4b\u95f4\uff0c\u90e8\u5206\u7a0b\u5e8f\u63a5\u8fd1\u6700\u4f18\u3002 MRU \u9ed8\u8ba4\u7b56\u7565\uff0c\u5728\u5927\u591a\u6570\u7a0b\u5e8f\u4e0a\u63d0\u4f9b\u8f83\u9ad8\u6027\u80fd\uff0c\u4f46\u6613\u5bfc\u81f4 cache pollution\u3002 Dynamic Insertion \u7efc\u5408\u8868\u73b0\u6700\u4f73\uff0c\u5728\u6240\u6709\u7a0b\u5e8f\u4e0a\u63a5\u8fd1\u6216\u8d85\u8d8a\u5404\u9759\u6001\u7b56\u7565\u7684\u6700\u4f73\u503c\uff0c\u5e73\u5747\u4f18\u4e8e MRU 5.1%\u3002 <ul> <li>\u5173\u952e\u53d1\u73b0\uff1a</li> <li>Dynamic Insertion \u5728\u51e0\u4e4e\u6240\u6709\u7a0b\u5e8f\u4e2d\u90fd\u80fd\u81ea\u52a8\u9009\u62e9\u6700\u4f18\u63d2\u5165\u4f4d\u7f6e\uff0c\u5b9e\u73b0\u201c\u81ea\u9002\u5e94\u201d\u4f18\u5316\u3002</li> <li>\u5728 applu \u548c ammp \u7b49\u6613\u53d7\u6c61\u67d3\u5f71\u54cd\u7684\u7a0b\u5e8f\u4e2d\uff0cDynamic Insertion \u663e\u8457\u4f18\u4e8e MRU\uff0c\u63a5\u8fd1 LRU \u8868\u73b0\u3002</li> <li>\u5728 wupwise\u3001mgrid \u7b49\u9ad8\u6536\u76ca\u7a0b\u5e8f\u4e2d\uff0cDynamic Insertion \u63a5\u8fd1 MRU\uff0c\u907f\u514d\u4e86 LRU \u7684\u6027\u80fd\u635f\u5931\u3002</li> <li> <p>\u9759\u6001\u7b56\u7565\u65e0\u6cd5\u517c\u987e\u6240\u6709\u7a0b\u5e8f\u7279\u6027\uff0c\u800c\u52a8\u6001\u673a\u5236\u901a\u8fc7\u8fd0\u884c\u65f6\u53cd\u9988\u5b9e\u73b0\u4e86\u5168\u5c40\u6700\u4f18\u3002</p> </li> <li> <p>\u7ed3\u8bba\uff1a\u52a8\u6001\u63d2\u5165\u7b56\u7565 \u80fd\u6839\u636e\u5b9e\u9645\u6c61\u67d3\u60c5\u51b5\u667a\u80fd\u8c03\u6574\u9884\u53d6\u5757\u5728 LRU \u6808\u4e2d\u7684\u4f4d\u7f6e\uff0c\u4ece\u800c\u5728\u4e0d\u589e\u52a0\u786c\u4ef6\u590d\u6742\u5ea6\u7684\u524d\u63d0\u4e0b\uff0c\u663e\u8457\u63d0\u5347\u6574\u4f53\u6027\u80fd\u548c\u5e26\u5bbd\u6548\u7387\u3002</p> </li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-8-distribution-of-the-insertion-position-of-prefetched-blocks","title":"Figure 8. Distribution of the insertion position of prefetched blocks","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u91c7\u7528 Dynamic Insertion \u673a\u5236\u65f6\uff0c\u4e0d\u540c SPEC CPU2000 \u57fa\u51c6\u7a0b\u5e8f\u4e2d\u9884\u53d6\u5757\uff08prefetched blocks\uff09\u88ab\u63d2\u5165\u5230 L2 \u7f13\u5b58 LRU \u6808\u4e0d\u540c\u4f4d\u7f6e\u7684\u767e\u5206\u6bd4\u5206\u5e03\u3002</li> <li>\u6a2a\u8f74\u4e3a\u5404\u57fa\u51c6\u7a0b\u5e8f\u540d\u79f0\uff0c\u7eb5\u8f74\u4e3a\u201cPercentage of prefetch insertions\u201d\uff0c\u5373\u9884\u53d6\u5757\u63d2\u5165\u64cd\u4f5c\u5728\u603b\u9884\u53d6\u4e2d\u7684\u5360\u6bd4\u3002</li> <li>\u56fe\u4f8b\u8bf4\u660e\u4e09\u79cd\u63d2\u5165\u4f4d\u7f6e\u7b56\u7565\uff1a</li> <li>LRU\uff1a\u6700\u4e45\u672a\u4f7f\u7528\u4f4d\u7f6e\uff08\u6df1\u7070\u8272\u5b9e\u5fc3\uff09</li> <li>LRU-4\uff1a\u7b2c floor(n/4) \u4e2a\u6700\u4e45\u672a\u4f7f\u7528\u4f4d\u7f6e\uff08\u659c\u7ebf\u586b\u5145\uff09</li> <li>MID\uff1a\u4e2d\u95f4\u4f4d\u7f6e\uff08\u6d45\u7070\u8272\u5b9e\u5fc3\uff09</li> </ul> Benchmark \u4e3b\u8981\u63d2\u5165\u4f4d\u7f6e \u63d2\u5165\u5206\u5e03\u7279\u5f81 bzip2 MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e gap MID \u7edd\u5927\u90e8\u5206\u63d2\u5165 MID \u4f4d\u7f6e mcf MID \u7edd\u5927\u90e8\u5206\u63d2\u5165 MID \u4f4d\u7f6e parser LRU-4 \u4e3b\u8981\u63d2\u5165 LRU-4 \u4f4d\u7f6e\uff0c\u5c11\u91cf LRU vortex MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e vpr MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e ammp LRU \u8d85\u8fc7 50% \u63d2\u5165 LRU \u4f4d\u7f6e\uff0c\u5176\u4f59\u4e3a LRU-4 \u548c MID applu LRU \u8d85\u8fc7 90% \u63d2\u5165 LRU \u4f4d\u7f6e\uff0c\u6781\u5c11\u91cf LRU-4 art MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e equake MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e facerec MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e galgel LRU \u7ea6 60% \u63d2\u5165 LRU \u4f4d\u7f6e\uff0c\u5176\u4f59\u4e3a LRU-4 \u548c MID mesa MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e mgrid MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e sixtrack MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e swim MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e wupwise MID \u51e0\u4e4e\u5168\u90e8\u63d2\u5165 MID \u4f4d\u7f6e <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5bf9\u4e8e applu\u3001ammp\u3001galgel \u8fd9\u4e09\u4e2a\u4f20\u7edf\u4e0a\u56e0\u9884\u53d6\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u7684\u7a0b\u5e8f\uff0cDynamic Insertion \u673a\u5236\u663e\u8457\u503e\u5411\u4e8e\u5c06\u9884\u53d6\u5757\u63d2\u5165\u5230 LRU \u4f4d\u7f6e\uff0c\u4ee5\u51cf\u5c11\u7f13\u5b58\u6c61\u67d3\u3002</li> <li>\u5bf9\u4e8e\u5176\u4ed6\u5927\u591a\u6570\u7a0b\u5e8f\uff08\u5982 wupwise\u3001mgrid\u3001equake\uff09\uff0c\u673a\u5236\u9009\u62e9\u63d2\u5165\u5230 MID \u6216 LRU-4 \u4f4d\u7f6e\uff0c\u5e73\u8861\u4e86\u4fdd\u7559\u6709\u7528\u6570\u636e\u4e0e\u907f\u514d\u6c61\u67d3\u7684\u9700\u6c42\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u9a8c\u8bc1\u4e86 FDP \u673a\u5236\u80fd\u6839\u636e\u8fd0\u884c\u65f6\u68c0\u6d4b\u5230\u7684 cache pollution \u6c34\u5e73\uff0c\u52a8\u6001\u8c03\u6574\u63d2\u5165\u7b56\u7565\uff0c\u4ece\u800c\u5728\u4e0d\u540c\u7a0b\u5e8f\u4e0a\u5b9e\u73b0\u6700\u4f18\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-9-overall-performance-of-fdp","title":"Figure 9. Overall performance of FDP","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Figure 9. Overall performance of FDP\uff0c\u5bf9\u6bd4\u4e86\u4e94\u79cd\u4e0d\u540c prefetching \u7b56\u7565\u5728 17 \u4e2a SPEC CPU2000 \u57fa\u51c6\u7a0b\u5e8f\u4e0a\u7684 IPC\uff08Instructions per Cycle\uff09\u6027\u80fd\u8868\u73b0\u3002</li> <li>\u6a2a\u8f74\u4e3a\u5404\u57fa\u51c6\u7a0b\u5e8f\u540d\u79f0\uff0c\u7eb5\u8f74\u4e3a IPC \u503c\uff0c\u5355\u4f4d\u4e3a Instructions per Cycle\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e94\u79cd\u7b56\u7565\uff1a</li> <li>No prefetching\uff1a\u65e0\u9884\u53d6\u3002</li> <li>Very Aggressive\uff1a\u4f20\u7edf\u6700\u6fc0\u8fdb\u9884\u53d6\u914d\u7f6e\u3002</li> <li>Dynamic Insertion\uff1a\u4ec5\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5757\u63d2\u5165\u4f4d\u7f6e\u3002</li> <li>Dynamic Aggressiveness\uff1a\u4ec5\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u6fc0\u8fdb\u5ea6\u3002</li> <li> <p>Dyn. Aggressiveness + Dyn. Insertion\uff1a\u540c\u65f6\u52a8\u6001\u8c03\u6574\u6fc0\u8fdb\u5ea6\u4e0e\u63d2\u5165\u4f4d\u7f6e\uff0c\u5373\u5b8c\u6574\u7684 Feedback Directed Prefetching (FDP)\u3002</p> </li> <li> <p>\u6027\u80fd\u5bf9\u6bd4\u6570\u636e\u6458\u8981\u5982\u4e0b\uff1a</p> </li> </ul> Benchmark No prefetching Very Aggressive Dynamic Insertion Dynamic Aggressiveness FDP (Both) bzip2 ~1.3 ~2.4 ~2.5 ~2.5 ~2.6 gap ~1.3 ~2.3 ~2.4 ~2.4 ~2.5 mcf ~0.3 ~0.3 ~0.3 ~0.3 ~0.3 parser ~1.0 ~1.8 ~1.9 ~1.9 ~2.0 vortex ~1.3 ~2.0 ~2.1 ~2.1 ~2.2 vpr ~1.3 ~1.8 ~1.9 ~1.9 ~2.0 ammp ~1.3 ~0.7 ~1.3 ~1.3 ~1.4 applu ~1.3 ~0.9 ~1.4 ~1.4 ~1.5 art ~0.4 ~0.4 ~0.4 ~0.4 ~0.4 equake ~2.3 ~2.5 ~2.6 ~2.6 ~2.7 facerec ~2.3 ~2.5 ~2.6 ~2.6 ~2.7 galgel ~2.3 ~2.5 ~2.6 ~2.6 ~2.7 mesa ~2.3 ~3.0 ~3.1 ~3.1 ~3.2 mgrid ~2.3 ~3.2 ~3.3 ~3.3 ~3.4 sixtrack ~2.3 ~2.8 ~2.9 ~2.9 ~3.0 swim ~1.3 ~1.8 ~1.9 ~1.9 ~2.0 wupwise ~1.3 ~4.8 ~4.9 ~4.9 ~5.0 fma3d ~1.3 ~1.8 ~1.9 ~1.9 ~2.0 gmean ~1.3 ~2.3 ~2.4 ~2.4 ~2.5 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>FDP (Dyn. Aggressiveness + Dyn. Insertion) \u5728\u51e0\u4e4e\u6240\u6709\u57fa\u51c6\u7a0b\u5e8f\u4e0a\u5747\u8fbe\u5230\u6216\u63a5\u8fd1\u6700\u9ad8 IPC\uff0c\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u5355\u4e00\u7b56\u7565\u3002</li> <li>\u5728 ammp \u548c applu \u4e0a\uff0c\u4f20\u7edf Very Aggressive \u914d\u7f6e\u5bfc\u81f4\u6027\u80fd\u4e25\u91cd\u4e0b\u964d\uff08IPC \u5206\u522b\u964d\u81f3 ~0.7 \u548c ~0.9\uff09\uff0c\u800c FDP \u6210\u529f\u6062\u590d\u5e76\u63d0\u5347\u6027\u80fd\u81f3 ~1.4 \u548c ~1.5\uff0c\u5b8c\u5168\u6d88\u9664\u8d1f\u5411\u5f71\u54cd\u3002</li> <li>gmean\uff08\u51e0\u4f55\u5e73\u5747\uff09\u663e\u793a\uff0cFDP \u76f8\u6bd4\u6700\u4f73\u4f20\u7edf\u914d\u7f6e\uff08Very Aggressive\uff09\u63d0\u5347 6.5%\uff0c\u9a8c\u8bc1\u8bba\u6587\u6838\u5fc3\u7ed3\u8bba\u3002</li> <li>\u5355\u72ec\u4f7f\u7528 Dynamic Aggressiveness \u6216 Dynamic Insertion \u5747\u6709\u6536\u76ca\uff0c\u4f46\u4e8c\u8005\u7ed3\u5408\u6548\u679c\u66f4\u4f18\uff0c\u4f53\u73b0\u673a\u5236\u4e92\u8865\u6027\u3002</li> <li>\u5bf9\u4e8e mcf \u548c art \u7b49\u5bf9\u9884\u53d6\u4e0d\u654f\u611f\u7684\u7a0b\u5e8f\uff0c\u6240\u6709\u7b56\u7565\u6027\u80fd\u76f8\u8fd1\uff0cFDP \u672a\u5f15\u5165\u989d\u5916\u5f00\u9500\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-10-effect-of-fdp-on-memory-bandwidth-consumption","title":"Figure 10. Effect of FDP on memory bandwidth consumption","text":"<ul> <li>\u56fe\u7247\u6807\u9898\u4e3a Figure 10. Effect of FDP on memory bandwidth consumption\uff0c\u5c55\u793a\u7684\u662f\u53cd\u9988\u5bfc\u5411\u9884\u53d6\uff08FDP\uff09\u673a\u5236\u5bf9\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u7684\u5f71\u54cd\uff0c\u4ee5 BPKI\uff08Memory Bus Accesses per thousand retired Instructions\uff09\u4e3a\u8861\u91cf\u5355\u4f4d\u3002</li> <li>\u56fe\u8868\u6a2a\u8f74\u5217\u51fa 17 \u4e2a SPEC CPU2000 \u5185\u5b58\u5bc6\u96c6\u578b\u57fa\u51c6\u7a0b\u5e8f\uff0c\u7eb5\u8f74\u8868\u793a BPKI \u503c\uff0c\u8303\u56f4\u4ece 0 \u5230 70\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e94\u79cd\u914d\u7f6e\uff1a</li> <li>No prefetching\uff1a\u65e0\u9884\u53d6</li> <li>Very Conservative\uff1a\u975e\u5e38\u4fdd\u5b88\u9884\u53d6</li> <li>Middle-of-the-Road\uff1a\u4e2d\u7b49\u9884\u53d6</li> <li>Very Aggressive\uff1a\u975e\u5e38\u6fc0\u8fdb\u9884\u53d6</li> <li> <p>Dynamic Aggressiveness + Dynamic Insertion\uff1aFDP \u52a8\u6001\u8c03\u6574\u6fc0\u8fdb\u6027\u4e0e\u63d2\u5165\u7b56\u7565</p> </li> <li> <p>\u5404\u914d\u7f6e\u5728\u4e0d\u540c\u57fa\u51c6\u7a0b\u5e8f\u4e0a\u7684 BPKI \u8868\u73b0\u5982\u4e0b\uff1a</p> </li> </ul> Benchmark No Prefetching Very Conservative Middle-of-the-Road Very Aggressive Dynamic Aggressiveness + Dynamic Insertion bzip2 ~3 ~4 ~5 ~6 ~5 gap ~6 ~7 ~8 ~9 ~7 mcf ~30 ~30 ~30 ~30 ~25 parser ~5 ~6 ~7 ~8 ~6 vortex ~4 ~5 ~6 ~7 ~5 vpr ~3 ~4 ~5 ~6 ~4 ammp ~10 ~12 ~15 ~30 ~12 applu ~10 ~12 ~15 ~30 ~12 art ~60 ~60 ~60 ~65 ~50 equake ~10 ~12 ~15 ~20 ~12 facerec ~10 ~12 ~15 ~20 ~12 galgel ~10 ~12 ~15 ~20 ~12 mesa ~5 ~6 ~7 ~8 ~6 mgrid ~10 ~12 ~15 ~20 ~12 sixtrack ~10 ~12 ~15 ~20 ~12 swim ~35 ~35 ~35 ~40 ~30 wupwise ~10 ~12 ~15 ~20 ~12 amean ~10 ~12 ~15 ~20 ~12 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>Very Aggressive \u914d\u7f6e\u5728\u591a\u4e2a\u7a0b\u5e8f\uff08\u5982 applu\u3001ammp\u3001art\uff09\u4e0a\u663e\u8457\u589e\u52a0 BPKI\uff0c\u8868\u660e\u5176\u5e26\u6765\u5927\u91cf\u65e0\u6548\u6216\u6c61\u67d3\u6027\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>Dynamic Aggressiveness + Dynamic Insertion \u5728\u6240\u6709\u7a0b\u5e8f\u4e0a\u5747\u4f18\u4e8e Very Aggressive\uff0c\u5c24\u5176\u5728 applu \u548c ammp \u4e0a\uff0cBPKI \u4ece\u7ea6 30 \u964d\u81f3\u7ea6 12\uff0c\u964d\u5e45\u8fbe 60%\u3002</li> <li>\u5728 art \u7a0b\u5e8f\u4e2d\uff0cFDP \u5c06 BPKI \u4ece 65 \u964d\u81f3 50\uff0c\u8282\u7701\u7ea6 23% \u5e26\u5bbd\u3002</li> <li>\u5bf9\u4e8e mcf\uff0cFDP \u4e0e\u4f20\u7edf\u914d\u7f6e\u5dee\u5f02\u8f83\u5c0f\uff0c\u8bf4\u660e\u8be5\u7a0b\u5e8f\u9884\u53d6\u6548\u7387\u9ad8\uff0c\u52a8\u6001\u8c03\u6574\u7a7a\u95f4\u6709\u9650\u3002</li> <li> <p>FDP \u5e73\u5747\u964d\u4f4e 18.7% \u5185\u5b58\u5e26\u5bbd\u6d88\u8017\uff0c\u540c\u65f6\u63d0\u5347\u6027\u80fd\uff0c\u5b9e\u73b0\u5e26\u5bbd\u6548\u7387\u4f18\u5316\u3002</p> </li> <li> <p>\u603b\u4f53\u8d8b\u52bf\u663e\u793a\uff0cFDP \u673a\u5236\u80fd\u667a\u80fd\u8bc6\u522b\u5e76\u6291\u5236\u4f4e\u6548\u9884\u53d6\u884c\u4e3a\uff0c\u5728\u4fdd\u6301\u9ad8\u6027\u80fd\u7684\u540c\u65f6\u5927\u5e45\u51cf\u5c11\u5185\u5b58\u603b\u7ebf\u8bbf\u95ee\u6b21\u6570\uff0c\u5c24\u5176\u5728\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u5bfc\u81f4\u6027\u80fd\u9000\u5316\u7684\u7a0b\u5e8f\u4e0a\u6548\u679c\u663e\u8457\u3002</p> </li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#table-5-average-ipc-and-bpki-for-fdp-vs-conventional-prefetchers","title":"Table 5. Average IPC and BPKI for FDP vs conventional prefetchers","text":"<ul> <li>\u56fe\u7247\u5185\u5bb9\u4e3a Table 5\uff0c\u6807\u9898\u4e3a \u201cAverage IPC and BPKI for FDP vs conventional prefetchers\u201d\uff0c\u7528\u4e8e\u5bf9\u6bd4\u4e0d\u540c\u9884\u53d6\u7b56\u7565\u5728\u5e73\u5747\u6307\u4ee4\u541e\u5410\u91cf\uff08IPC\uff09\u548c\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\uff08BPKI\uff09\u4e0a\u7684\u8868\u73b0\u3002</li> <li>\u8868\u683c\u6a2a\u5411\u5217\u51fa\u4e86\u4e94\u79cd\u9884\u53d6\u914d\u7f6e\uff1aNo pref.\uff08\u65e0\u9884\u53d6\uff09\u3001Very Cons.\uff08\u975e\u5e38\u4fdd\u5b88\uff09\u3001Middle\uff08\u4e2d\u7b49\uff09\u3001Very Aggr.\uff08\u975e\u5e38\u6fc0\u8fdb\uff09\u3001FDP\uff08Feedback Directed Prefetching\uff09\u3002</li> <li>\u7eb5\u5411\u6307\u6807\u5305\u62ec\u4e24\u4e2a\u6838\u5fc3\u6027\u80fd\u7ef4\u5ea6\uff1aIPC\uff08\u6bcf\u5468\u671f\u6307\u4ee4\u6570\uff09\u4e0e BPKI\uff08\u6bcf\u5343\u6761\u9000\u4f11\u6307\u4ee4\u7684\u5185\u5b58\u603b\u7ebf\u8bbf\u95ee\u6b21\u6570\uff0c\u8861\u91cf\u5e26\u5bbd\u6d88\u8017\uff09\u3002</li> <li>\u6570\u636e\u663e\u793a\uff0cFDP \u5728 IPC \u4e0a\u8fbe\u5230 1.67\uff0c\u663e\u8457\u4f18\u4e8e\u6240\u6709\u4f20\u7edf\u914d\u7f6e\uff0c\u6bd4\u6700\u4f73\u4f20\u7edf\u914d\u7f6e\uff08Very Aggr. \u7684 1.57\uff09\u9ad8\u51fa 6.5%\uff0c\u9a8c\u8bc1\u4e86\u5176\u6027\u80fd\u63d0\u5347\u80fd\u529b\u3002</li> <li>\u5728\u5e26\u5bbd\u6548\u7387\u65b9\u9762\uff0cFDP \u7684 BPKI \u4e3a 10.88\uff0c\u8fdc\u4f4e\u4e8e Very Aggr. \u914d\u7f6e\u7684 13.38\uff0c\u8282\u7701 18.7% \u5185\u5b58\u5e26\u5bbd\uff0c\u540c\u65f6\u4ecd\u4fdd\u6301\u66f4\u9ad8\u6027\u80fd\u3002</li> <li>\u5bf9\u6bd4\u6d88\u8017\u76f8\u4f3c\u5e26\u5bbd\u7684\u4f20\u7edf\u914d\u7f6e\uff08Middle\uff0cBPKI=10.60\uff09\uff0cFDP \u5728\u4ec5\u7565\u9ad8\u5e26\u5bbd\u4e0b\u5b9e\u73b0 13.6% \u7684 IPC \u63d0\u5347\uff0c\u51f8\u663e\u5176\u5e26\u5bbd\u6548\u7387\u4f18\u52bf\u3002</li> <li>\u7efc\u5408\u6765\u770b\uff0cFDP \u5b9e\u73b0\u4e86\u201c\u66f4\u9ad8\u6027\u80fd + \u66f4\u4f4e\u5e26\u5bbd\u6d88\u8017\u201d\u7684\u53cc\u91cd\u4f18\u5316\uff0c\u662f\u4f20\u7edf\u9759\u6001\u9884\u53d6\u673a\u5236\u7684\u6709\u6548\u5347\u7ea7\u65b9\u6848\u3002</li> </ul> \u914d\u7f6e IPC BPKI No pref. 0.85 8.56 Very Cons. 1.21 9.34 Middle 1.47 10.60 Very Aggr. 1.57 13.38 FDP 1.67 10.88"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-11-performance-of-prefetch-cache-vs-fdp","title":"Figure 11. Performance of prefetch cache vs. FDP","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a\u201cFigure 11. Performance of prefetch cache vs. FDP\u201d\uff0c\u7eb5\u8f74\u4e3a\u201cInstructions per Cycle\u201d\uff08IPC\uff09\uff0c\u6a2a\u8f74\u4e3aSPEC CPU2000\u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u7528\u4e8e\u6bd4\u8f83\u4e0d\u540c\u9884\u53d6\u673a\u5236\u7684\u6027\u80fd\u8868\u73b0\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e03\u79cd\u914d\u7f6e\uff1aNo prefetching\u3001Very Aggressive (base)\u30012KB\u30018KB\u300132KB\u300164KB\u30011MB \u9884\u53d6\u7f13\u5b58\uff0c\u4ee5\u53ca Dyn. Aggr. + Dyn. Ins.\uff08\u5373Feedback Directed Prefetching\uff0cFDP\uff09\u3002</li> <li>Very Aggressive (base) \u6307\u4f20\u7edf\u6d41\u5f0f\u9884\u53d6\u5668\u5728\u6700\u6fc0\u8fdb\u914d\u7f6e\u4e0b\u76f4\u63a5\u5c06\u9884\u53d6\u5757\u63d2\u5165L2\u7f13\u5b58\u7684\u57fa\u7ebf\u65b9\u6848\uff0c\u4f5c\u4e3a\u6027\u80fd\u5bf9\u6bd4\u57fa\u51c6\u3002</li> <li>FDP\uff08Dyn. Aggr. + Dyn. Ins.\uff09 \u5728\u7edd\u5927\u591a\u6570\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u6027\u80fd\u4f18\u4e8e\u6216\u63a5\u8fd1\u6240\u6709\u56fa\u5b9a\u5927\u5c0f\u7684\u9884\u53d6\u7f13\u5b58\u65b9\u6848\uff0c\u5c24\u5176\u5728 wupwise\u3001mgrid\u3001equake \u7b49\u5185\u5b58\u5bc6\u96c6\u578b\u7a0b\u5e8f\u4e2d\u8868\u73b0\u7a81\u51fa\u3002</li> <li>\u5c0f\u5bb9\u91cf\u9884\u53d6\u7f13\u5b58\uff08\u5982 2KB \u548c 8KB\uff09\u5728\u591a\u6570\u7a0b\u5e8f\u4e2d\u6027\u80fd\u4f4e\u4e8e\u57fa\u7ebf\u6216FDP\uff0c\u539f\u56e0\u5728\u4e8e\u9884\u53d6\u5757\u6613\u88ab\u540e\u7eed\u9884\u53d6\u8986\u76d6\uff0c\u5bfc\u81f4\u672a\u88ab\u4f7f\u7528\u5373\u5931\u6548\u3002</li> <li>\u4e2d\u7b49\u5bb9\u91cf\u9884\u53d6\u7f13\u5b58\uff0832KB \u548c 64KB\uff09\u6027\u80fd\u63d0\u5347\u660e\u663e\uff0c\u90e8\u5206\u7a0b\u5e8f\uff08\u5982 galgel\u3001mesa\uff09\u63a5\u8fd1FDP\uff0c\u4f46\u6574\u4f53\u4ecd\u843d\u540e\u4e8eFDP\u3002</li> <li>\u5927\u5bb9\u91cf\u9884\u53d6\u7f13\u5b58\uff081MB\uff09\u6027\u80fd\u63a5\u8fd1FDP\uff0c\u4f46\u5728\u67d0\u4e9b\u7a0b\u5e8f\uff08\u5982 applu\u3001ammp\uff09\u4e2d\u4ecd\u7565\u900a\u4e8eFDP\uff0c\u4e14\u786c\u4ef6\u6210\u672c\u663e\u8457\u589e\u52a0\u3002</li> <li>FDP\u5728 applu \u548c ammp \u4e0a\u7684\u8868\u73b0\u5c24\u4e3a\u5173\u952e\uff1a\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u4f1a\u4e25\u91cd\u964d\u4f4e\u6027\u80fd\uff0c\u800cFDP\u901a\u8fc7\u52a8\u6001\u8c03\u6574\u907f\u514d\u4e86\u8fd9\u4e00\u95ee\u9898\uff0c\u5b9e\u73b0\u4e86\u6b63\u5411\u6027\u80fd\u589e\u76ca\u3002</li> <li>\u6027\u80fd\u6570\u636e\u6c47\u603b\u5982\u4e0b\uff1a</li> </ul> \u914d\u7f6e \u5e73\u5747IPC\u4f18\u52bf\uff08\u76f8\u5bf9Very Aggressive base\uff09 2KB Prefetch Cache \u663e\u8457\u4f4e\u4e8e\u57fa\u7ebf 8KB Prefetch Cache \u63a5\u8fd1\u6216\u7565\u4f4e\u4e8e\u57fa\u7ebf 32KB Prefetch Cache +~5%\uff08\u76f8\u5bf9FDP\uff09 64KB Prefetch Cache +~2%\uff08\u76f8\u5bf9FDP\uff09 FDP (Dyn. Aggr. + Dyn. Ins.) +5.3%\uff08\u76f8\u5bf932KB\uff09 <ul> <li>\u7ed3\u8bba\uff1aFDP\u5728\u4e0d\u5f15\u5165\u989d\u5916\u5927\u5bb9\u91cf\u9884\u53d6\u7f13\u5b58\u7684\u524d\u63d0\u4e0b\uff0c\u5b9e\u73b0\u4e86\u4e0e\u5927\u578b\u9884\u53d6\u7f13\u5b58\u76f8\u5f53\u751a\u81f3\u66f4\u4f18\u7684\u6027\u80fd\uff0c\u540c\u65f6\u663e\u8457\u964d\u4f4e\u786c\u4ef6\u5f00\u9500\u548c\u5e26\u5bbd\u6d88\u8017\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-12-bandwidth-consumption-of-prefetch-cache-vs-fdp","title":"Figure 12. Bandwidth consumption of prefetch cache vs. FDP","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 12. Bandwidth consumption of prefetch cache vs. FDP\uff0c\u5c55\u793a\u4e0d\u540c\u9884\u53d6\u673a\u5236\u5728\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\uff08BPKI\uff09\u4e0a\u7684\u5bf9\u6bd4\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa SPEC CPU2000 \u5957\u4ef6\u4e2d\u7684\u591a\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u5305\u62ec bzip2\u3001gap\u3001mcf\u3001vortex\u3001ammp\u3001applu\u3001art\u3001equake\u3001galgel\u3001mgrid\u3001sixtrack\u3001swim\u3001wupwise\u3001amean \u7b49\u3002</li> <li>\u7eb5\u8f74\u8868\u793a BPKI\uff08Memory Bus Accesses per thousand retired Instructions\uff09\uff0c\u6570\u503c\u8d8a\u9ad8\u4ee3\u8868\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u8d8a\u5927\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e03\u79cd\u914d\u7f6e\uff1a</li> <li>No prefetching\uff1a\u65e0\u9884\u53d6\uff0c\u4f5c\u4e3a\u57fa\u7ebf\u3002</li> <li>Very Aggressive (base)\uff1a\u4f20\u7edf\u975e\u5e38\u6fc0\u8fdb\u7684\u6d41\u5f0f\u9884\u53d6\u5668\uff0c\u76f4\u63a5\u63d2\u5165 L2 \u7f13\u5b58\u3002</li> <li>2KB, fully-associative\uff1a2KB \u5168\u76f8\u8054\u9884\u53d6\u7f13\u5b58\u3002</li> <li>8KB, 16-way\uff1a8KB 16\u8def\u7ec4\u76f8\u8054\u9884\u53d6\u7f13\u5b58\u3002</li> <li>32KB, 16-way\uff1a32KB 16\u8def\u7ec4\u76f8\u8054\u9884\u53d6\u7f13\u5b58\u3002</li> <li>64KB, 16-way\uff1a64KB 16\u8def\u7ec4\u76f8\u8054\u9884\u53d6\u7f13\u5b58\u3002</li> <li>1MB, 16-way\uff1a1MB 16\u8def\u7ec4\u76f8\u8054\u9884\u53d6\u7f13\u5b58\u3002</li> <li> <p>Dyn. Aggr. + Dyn. Ins.\uff1a\u672c\u6587\u63d0\u51fa\u7684 Feedback Directed Prefetching (FDP)\uff0c\u52a8\u6001\u8c03\u6574\u9884\u53d6\u6fc0\u8fdb\u5ea6\u4e0e\u63d2\u5165\u7b56\u7565\u3002</p> </li> <li> <p>\u5173\u952e\u89c2\u5bdf\uff1a</p> </li> <li>Very Aggressive (base) \u5728\u591a\u6570\u7a0b\u5e8f\u4e2d\u5e26\u5bbd\u6d88\u8017\u6700\u9ad8\uff0c\u5c24\u5176\u5728 art\u3001equake\u3001mgrid\u3001sixtrack\u3001swim \u7b49\u7a0b\u5e8f\u4e0a\u663e\u8457\u9ad8\u4e8e\u5176\u4ed6\u65b9\u6848\u3002</li> <li>FDP (Dyn. Aggr. + Dyn. Ins.) \u5728\u51e0\u4e4e\u6240\u6709\u7a0b\u5e8f\u4e2d\u5747\u8868\u73b0\u51fa\u6700\u4f4e\u6216\u63a5\u8fd1\u6700\u4f4e\u7684 BPKI\uff0c\u8868\u660e\u5176\u5728\u51cf\u5c11\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u65b9\u9762\u6781\u4e3a\u9ad8\u6548\u3002</li> <li>\u9884\u53d6\u7f13\u5b58\u65b9\u6848\uff08\u5982 2KB\u30018KB\uff09\u867d\u7136\u80fd\u964d\u4f4e\u6c61\u67d3\uff0c\u4f46\u56e0\u5bb9\u91cf\u5c0f\u5bfc\u81f4\u9884\u53d6\u5757\u88ab\u63d0\u524d\u9a71\u9010\uff0c\u53cd\u800c\u5728\u90e8\u5206\u7a0b\u5e8f\uff08\u5982 art\u3001equake\uff09\u4e2d\u5e26\u5bbd\u6d88\u8017\u4ecd\u8f83\u9ad8\u3002</li> <li>\u5927\u5bb9\u91cf\u9884\u53d6\u7f13\u5b58\uff08\u5982 32KB\u300164KB\u30011MB\uff09\u867d\u80fd\u964d\u4f4e\u6c61\u67d3\uff0c\u4f46\u786c\u4ef6\u6210\u672c\u9ad8\uff0c\u4e14\u5e26\u5bbd\u6d88\u8017\u4ecd\u9ad8\u4e8e FDP\u3002\u4f8b\u5982\uff0c\u5728 art \u548c equake \u4e0a\uff0cFDP \u7684 BPKI \u660e\u663e\u4f4e\u4e8e 32KB \u548c 64KB \u9884\u53d6\u7f13\u5b58\u3002</li> <li> <p>\u5728 ammp\u3001applu \u7b49\u539f\u672c\u56e0\u9884\u53d6\u800c\u6027\u80fd\u4e0b\u964d\u7684\u7a0b\u5e8f\u4e2d\uff0cFDP \u4e0d\u4ec5\u907f\u514d\u4e86\u6027\u80fd\u635f\u5931\uff0c\u8fd8\u5927\u5e45\u964d\u4f4e\u4e86\u5e26\u5bbd\u6d88\u8017\uff0c\u8fdc\u4f18\u4e8e Very Aggressive \u914d\u7f6e\u3002</p> </li> <li> <p>\u6570\u636e\u5bf9\u6bd4\u6458\u8981\uff1a</p> </li> </ul> \u914d\u7f6e \u5e73\u5747 BPKI \u8868\u73b0 \u76f8\u6bd4 Very Aggressive \u76f8\u6bd4 32KB \u9884\u53d6\u7f13\u5b58 \u76f8\u6bd4 64KB \u9884\u53d6\u7f13\u5b58 Very Aggressive (base) \u6700\u9ad8 \u57fa\u51c6 \u66f4\u9ad8 \u66f4\u9ad8 FDP (Dyn. Aggr. + Dyn. Ins.) \u6700\u4f4e \u964d\u4f4e 18.7% \u964d\u4f4e 16% \u964d\u4f4e 9% 32KB, 16-way \u4e2d\u7b49\u504f\u9ad8 \u8f83\u9ad8 \u57fa\u51c6 \u66f4\u9ad8 64KB, 16-way \u4e2d\u7b49 \u8f83\u9ad8 \u8f83\u4f4e \u57fa\u51c6 <ul> <li>\u7ed3\u8bba\uff1aFDP \u5728\u4fdd\u6301\u9ad8\u6027\u80fd\u7684\u540c\u65f6\uff0c\u5b9e\u73b0\u4e86\u6700\u4f18\u7684\u5e26\u5bbd\u6548\u7387\uff0c\u663e\u8457\u4f18\u4e8e\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u548c\u5404\u7c7b\u9884\u53d6\u7f13\u5b58\u65b9\u6848\uff0c\u5c24\u5176\u5728\u5185\u5b58\u5bc6\u96c6\u578b\u7a0b\u5e8f\u4e2d\u4f18\u52bf\u660e\u663e\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#6939ef382a92475d45bd0b1b3eeb8b99cbef48fb169a6f6a76882a5a5066d349jpg","title":"6939ef382a92475d45bd0b1b3eeb8b99cbef48fb169a6f6a76882a5a5066d349.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u4e00\u5f20\u8868\u683c\uff0c\u8be6\u7ec6\u5217\u51fa\u4e86 Feedback Directed Prefetching (FDP) \u673a\u5236\u6240\u589e\u52a0\u7684\u786c\u4ef6\u5f00\u9500\u3002</li> <li>\u8868\u683c\u5185\u5bb9\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\u5404\u7ec4\u4ef6\u7684\u786c\u4ef6\u6210\u672c\u660e\u7ec6 \u548c \u603b\u6210\u672c\u53ca\u76f8\u5bf9\u5f00\u9500\u3002</li> <li>\u6240\u6709\u6210\u672c\u5747\u4ee5 bit \u4e3a\u5355\u4f4d\u8ba1\u7b97\uff0c\u5e76\u6700\u7ec8\u6c47\u603b\u4e3a KB\uff0c\u540c\u65f6\u7ed9\u51fa\u4e86\u76f8\u5bf9\u4e8e\u57fa\u7ebf 1MB L2 cache \u7684\u9762\u79ef\u5f00\u9500\u767e\u5206\u6bd4\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u5177\u4f53\u7684\u786c\u4ef6\u6210\u672c\u6784\u6210\uff1a</p> \u7ec4\u4ef6\u540d\u79f0 \u8ba1\u7b97\u65b9\u5f0f \u6210\u672c\uff08bits\uff09 pref-bit for each tag-store entry in the L2 cache 16384 blocks * 1 bit/block 16384 bits Pollution Filter 4096 entries * 1 bit/entry 4096 bits 16-bit counters used to estimate feedback metrics 11 counters * 16 bits/counter 176 bits pref-bit for each MSHR entry 128 entries * 1 bit/entry 128 bits <ul> <li>Total hardware cost \u4e3a\u4e0a\u8ff0\u5404\u9879\u4e4b\u548c\uff0c\u603b\u8ba1 20784 bits\uff0c\u6362\u7b97\u540e\u4e3a 2.54 KB\u3002</li> <li>\u76f8\u5bf9\u4e8e\u57fa\u7ebf 1MB L2 cache\uff08\u5373 1024 KB\uff09\uff0cFDP \u589e\u52a0\u7684\u786c\u4ef6\u5f00\u9500\u5360\u6bd4\u4ec5\u4e3a 0.24%\u3002</li> <li>\u6b64\u6570\u636e\u8868\u660e\uff0cFDP \u673a\u5236\u5728\u5b9e\u73b0\u52a8\u6001\u53cd\u9988\u8c03\u6574\u529f\u80fd\u7684\u540c\u65f6\uff0c\u5f15\u5165\u7684\u786c\u4ef6\u6210\u672c\u6781\u4f4e\uff0c\u5177\u6709\u5f88\u9ad8\u7684\u5b9e\u7528\u6027\u548c\u53ef\u90e8\u7f72\u6027\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#14f8a70701293f0779343e09135fcfb8499b28f6abf9db7bee81ada5fb1a3b70jpg","title":"14f8a70701293f0779343e09135fcfb8499b28f6abf9db7bee81ada5fb1a3b70.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u4e86\u4e00\u4e2a\u8868\u683c\uff0c\u7528\u4e8e\u5b9a\u4e49 Global History Buffer (GHB) \u9884\u53d6\u5668\u7684\u52a8\u6001\u914d\u7f6e\u53c2\u6570\u3002</li> <li>\u8868\u683c\u5305\u542b\u4e09\u5217\uff1aDyn. Config. Counter\u3001Aggressiveness \u548c Prefetch Degree\u3002</li> <li>Dyn. Config. Counter \u662f\u4e00\u4e2a 3 \u4f4d\u9971\u548c\u8ba1\u6570\u5668\uff0c\u5176\u503c\u8303\u56f4\u4ece 1 \u5230 5\uff0c\u7528\u4e8e\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u7a0b\u5ea6\u3002</li> <li>Aggressiveness \u63cf\u8ff0\u4e86\u9884\u53d6\u5668\u5728\u4e0d\u540c\u8ba1\u6570\u5668\u503c\u4e0b\u7684\u884c\u4e3a\u6a21\u5f0f\uff0c\u5206\u4e3a\u4e94\u4e2a\u7b49\u7ea7\uff1aVery Conservative\u3001Conservative\u3001Middle-of-the-Road\u3001Aggressive \u548c Very Aggressive\u3002</li> <li>Prefetch Degree \u8868\u793a\u6bcf\u6b21\u9884\u53d6\u8bf7\u6c42\u6240\u83b7\u53d6\u7684\u7f13\u5b58\u5757\u6570\u91cf\uff0c\u5176\u503c\u968f\u6fc0\u8fdb\u7a0b\u5ea6\u589e\u52a0\u800c\u6307\u6570\u589e\u957f\uff0c\u4ece 4 \u589e\u52a0\u5230 64\u3002</li> <li>\u8be5\u914d\u7f6e\u8868\u662f Feedback Directed Prefetching (FDP) \u673a\u5236\u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u6839\u636e\u8fd0\u884c\u65f6\u53cd\u9988\uff08\u5982\u51c6\u786e\u6027\u3001\u5ef6\u8fdf\u548c\u6c61\u67d3\uff09\u52a8\u6001\u8c03\u6574 GHB \u9884\u53d6\u5668\u7684\u884c\u4e3a\u3002</li> </ul> Dyn. Config. Counter Aggressiveness Prefetch Degree 1 Very Conservative 4 2 Conservative 8 3 Middle-of-the-Road 16 4 Aggressive 32 5 Very Aggressive 64"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#figure-13-effect-of-fdp-on-the-ipc-performance-left-bpki-memory-bandwidth-consumption-right-of-ghb-based-cdc-prefetchers","title":"Figure 13. Effect of FDP on the IPC performance (left) BPKI memory bandwidth consumption (right) of GHB-based C/DC prefetchers","text":"<ul> <li>\u56fe\u7247\u5305\u542b\u4e24\u4e2a\u5e76\u5217\u7684\u67f1\u72b6\u56fe\uff0c\u5206\u522b\u5c55\u793a FDP \u5bf9 GHB-based C/DC prefetcher \u7684\u5f71\u54cd\uff1a\u5de6\u4fa7\u4e3a IPC performance\uff0c\u53f3\u4fa7\u4e3a BPKI memory bandwidth consumption\u3002</li> <li>\u4e24\u56fe\u6a2a\u8f74\u5747\u4e3a SPEC CPU2000 \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u5305\u62ec <code>bzip2</code>, <code>gap</code>, <code>mcf</code>, <code>parser</code>, <code>vortex</code>, <code>vpr</code>, <code>ammp</code>, <code>applu</code>, <code>art</code>, <code>equake</code>, <code>facerec</code>, <code>galgel</code>, <code>mesa</code>, <code>mgrid</code>, <code>sixtrack</code>, <code>swim</code>, <code>wupwise</code>, <code>amean</code>\u3002</li> <li>\u7eb5\u8f74\u5de6\u4fa7\u4e3a Instructions per Cycle (IPC)\uff0c\u8303\u56f4\u4ece 0.0 \u5230 4.5\uff1b\u53f3\u4fa7\u4e3a BPKI (Bus Accesses Per Kilo Instructions)\uff0c\u8303\u56f4\u4ece 0 \u5230 45\u3002</li> <li>\u56fe\u4f8b\u7edf\u4e00\u5305\u542b\u4e94\u79cd\u914d\u7f6e\uff1a</li> <li>No prefetching</li> <li>Very Conservative</li> <li>Middle-of-the-Road</li> <li>Very Aggressive</li> <li>Dynamic Aggressiveness + Dynamic Insertion (FDP)</li> </ul> \u914d\u7f6e IPC \u8868\u73b0 BPKI \u8868\u73b0 No prefetching \u6700\u4f4e\u6216\u63a5\u8fd1\u6700\u4f4e \u6700\u4f4e Very Conservative \u4e2d\u7b49\u504f\u4f4e \u8f83\u4f4e Middle-of-the-Road \u4e2d\u7b49 \u4e2d\u7b49 Very Aggressive \u6700\u9ad8\uff08\u4f46\u90e8\u5206\u7a0b\u5e8f\u5982 applu\u3001ammp \u660e\u663e\u4e0b\u964d\uff09 \u6700\u9ad8\uff08\u5c24\u5176\u5728 applu\u3001art \u7b49\u7a0b\u5e8f\u4e2d\u663e\u8457\u4e0a\u5347\uff09 Dynamic Aggressiveness + Dynamic Insertion \u6574\u4f53\u63a5\u8fd1\u6216\u8d85\u8d8a Very Aggressive\uff0c\u4e14\u5728 applu\u3001ammp \u7b49\u7a0b\u5e8f\u4e2d\u663e\u8457\u4f18\u4e8e\u540e\u8005 \u663e\u8457\u4f4e\u4e8e Very Aggressive\uff0c\u63a5\u8fd1 Middle-of-the-Road \u6216\u66f4\u4f4e <ul> <li>\u5728 IPC \u6027\u80fd\u65b9\u9762\uff1a</li> <li>FDP \u5728\u5927\u591a\u6570\u7a0b\u5e8f\u4e0a\u8868\u73b0\u4e0e Very Aggressive \u76f8\u5f53\u6216\u7565\u4f18\u3002</li> <li>\u5728 applu \u548c ammp \u7b49\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u5668\u6027\u80fd\u53d7\u635f\u7684\u7a0b\u5e8f\u4e0a\uff0cFDP \u663e\u8457\u4f18\u4e8e Very Aggressive\uff0c\u907f\u514d\u4e86\u6027\u80fd\u9000\u5316\u3002</li> <li> <p>\u5e73\u5747\u503c\uff08amean\uff09\u663e\u793a FDP \u63d0\u4f9b\u4e86\u4e0e Very Aggressive \u63a5\u8fd1\u7684\u6700\u9ad8 IPC\u3002</p> </li> <li> <p>\u5728 \u5e26\u5bbd\u6d88\u8017 (BPKI) \u65b9\u9762\uff1a</p> </li> <li>FDP \u7684\u5e26\u5bbd\u6d88\u8017\u8fdc\u4f4e\u4e8e Very Aggressive\uff0c\u5c24\u5176\u5728 applu, art, galgel \u7b49\u7a0b\u5e8f\u4e2d\u964d\u5e45\u660e\u663e\u3002</li> <li>FDP \u7684 BPKI \u6c34\u5e73\u4e0e Middle-of-the-Road \u76f8\u5f53\u751a\u81f3\u66f4\u4f4e\uff0c\u8868\u660e\u5176\u5728\u4fdd\u6301\u9ad8\u6027\u80fd\u7684\u540c\u65f6\u5927\u5e45\u8282\u7701\u5e26\u5bbd\u3002</li> <li> <p>\u8fd9\u9a8c\u8bc1\u4e86\u8bba\u6587\u4e2d\u63d0\u5230\u7684\u201cFDP \u6d88\u8017 20.8% \u66f4\u5c11\u5185\u5b58\u5e26\u5bbd\u201d\u7684\u7ed3\u8bba\u3002</p> </li> <li> <p>\u7efc\u5408\u6765\u770b\uff0cFDP \u673a\u5236\u6210\u529f\u5b9e\u73b0\u4e86 \u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u884c\u4e3a\uff0c\u5728\u4e0d\u540c\u7a0b\u5e8f\u9636\u6bb5\u81ea\u52a8\u9009\u62e9\u6700\u4f18\u914d\u7f6e\uff0c\u4ece\u800c\u5728\u4e0d\u727a\u7272\u6027\u80fd\u7684\u524d\u63d0\u4e0b\u663e\u8457\u964d\u4f4e\u5e26\u5bbd\u538b\u529b\u3002</p> </li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#4ecb58ee74f1de0747b841dc4d7980bb9073a961f367d338239a47ec5ef3e830jpg","title":"4ecb58ee74f1de0747b841dc4d7980bb9073a961f367d338239a47ec5ef3e830.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u7684\u662f Table 7\uff0c\u5176\u5185\u5bb9\u4e3a\u5728\u4e0d\u540c L2 Cache Size \u548c Memory Latency \u6761\u4ef6\u4e0b\uff0cFeedback Directed Prefetching (FDP) \u76f8\u8f83\u4e8e\u6700\u4f73\u4f20\u7edf\u9884\u53d6\u5668\u914d\u7f6e\u6240\u5e26\u6765\u7684 IPC\uff08Instructions Per Cycle\uff09\u548c BPKI\uff08Bus Accesses Per Kilo Instructions\uff09\u53d8\u5316\u767e\u5206\u6bd4\u3002</li> <li>\u8868\u683c\u5206\u4e3a\u4e24\u5927\u4e3b\u5217\uff1a\u5de6\u4fa7\u4e3a\u56fa\u5b9a\u5185\u5b58\u5ef6\u8fdf\uff08500 cycles\uff09\u4e0b\u4e0d\u540c L2 \u7f13\u5b58\u5927\u5c0f\u7684\u5f71\u54cd\uff1b\u53f3\u4fa7\u4e3a\u56fa\u5b9a L2 \u7f13\u5b58\u5927\u5c0f\uff081 MB\uff09\u4e0b\u4e0d\u540c\u5185\u5b58\u5ef6\u8fdf\u7684\u5f71\u54cd\u3002</li> <li>\u5728\u6240\u6709\u6d4b\u8bd5\u6761\u4ef6\u4e0b\uff0cFDP \u5747\u80fd\u63d0\u4f9b\u6b63\u5411\u7684 IPC \u63d0\u5347\uff0c\u540c\u65f6\u663e\u8457\u964d\u4f4e BPKI\uff0c\u8868\u660e\u5176\u5728\u6027\u80fd\u4e0e\u5e26\u5bbd\u6548\u7387\u4e0a\u5747\u4f18\u4e8e\u4f20\u7edf\u65b9\u6848\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u5177\u4f53\u6570\u636e\u8868\u683c\uff1a</p> L2 Cache Size (memory latency = 500 cycles) Memory Latency (L2 cache size = 1 MB) 512 KB 250 cycles \u0394 IPC: 0% \u0394 IPC: 4.5% \u0394 BPKI: -13.9% \u0394 BPKI: -23.0% 1 MB 500 cycles \u0394 IPC: 6.5% \u0394 IPC: 6.5% \u0394 BPKI: -18.7% \u0394 BPKI: -18.7% 2 MB 1000 cycles \u0394 IPC: 6.3% \u0394 IPC: 8.4% \u0394 BPKI: -29.6% \u0394 BPKI: -16.9% <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5f53 L2 \u7f13\u5b58\u589e\u5927\u81f3 2MB \u65f6\uff0cFDP \u7684 BPKI \u964d\u4f4e\u5e45\u5ea6\u6700\u5927\uff08-29.6%\uff09\uff0c\u8bf4\u660e\u5728\u66f4\u5927\u7f13\u5b58\u4e0b\uff0cFDP \u5bf9\u51cf\u5c11\u65e0\u6548\u9884\u53d6\u548c\u6c61\u67d3\u7684\u4f18\u5316\u6548\u679c\u66f4\u660e\u663e\u3002</li> <li>\u5f53 \u5185\u5b58\u5ef6\u8fdf\u589e\u52a0\u81f3 1000 cycles \u65f6\uff0cFDP \u7684 IPC \u63d0\u5347\u8fbe\u5230\u6700\u9ad8\u503c\uff088.4%\uff09\uff0c\u8fd9\u9a8c\u8bc1\u4e86\u8bba\u6587\u7ed3\u8bba\uff1a\u5185\u5b58\u5ef6\u8fdf\u8d8a\u9ad8\uff0c\u9884\u53d6\u5668\u7684\u6709\u6548\u6027\u8d8a\u5173\u952e\uff0cFDP \u7684\u6027\u80fd\u589e\u76ca\u4e5f\u8d8a\u5927\u3002</li> <li>\u5728 512KB L2 \u7f13\u5b58 \u4e0b\uff0cFDP \u7684 IPC \u63d0\u5347\u4e3a 0%\uff0c\u4f46 BPKI \u4ecd\u964d\u4f4e 13.9%\uff0c\u8868\u660e\u5373\u4f7f\u5728\u5c0f\u7f13\u5b58\u573a\u666f\u4e0b\uff0cFDP \u4e5f\u80fd\u6709\u6548\u8282\u7701\u5e26\u5bbd\uff0c\u5c3d\u7ba1\u6027\u80fd\u63d0\u5347\u53d7\u9650\u4e8e\u7f13\u5b58\u5bb9\u91cf\u3002</li> <li>\u6240\u6709\u5b9e\u9a8c\u4e2d\uff0cBPKI \u5747\u4e3a\u8d1f\u503c\uff0c\u610f\u5473\u7740 FDP \u5728\u6240\u6709\u914d\u7f6e\u4e0b\u90fd\u6210\u529f\u964d\u4f4e\u4e86\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/figs_notes/#table-7-change-in-ipc-and-bpki-with-fdp-when-l2-size-and-memory-latency-are-varie-figure-14-ipc-performance-left-and-memory-bandwidth-consumption-in-bpki-right-impact-of-fdp-on-the-remaining-spec-benchmarks","title":"Table 7. Change in IPC and BPKI with FDP when L2 size and memory latency are varie Figure 14. IPC performance (left) and memory bandwidth consumption in BPKI (right) impact of FDP on the remaining SPEC benchmarks","text":"<ul> <li>\u56fe\u7247\u5305\u542b\u4e24\u4e2a\u5e76\u5217\u7684\u67f1\u72b6\u56fe\uff0c\u5206\u522b\u5c55\u793a FDP \u5bf9\u5269\u4f59 9 \u4e2a SPEC CPU2000 \u57fa\u51c6\u7a0b\u5e8f\u5728 IPC \u548c BPKI \u4e0a\u7684\u5f71\u54cd\u3002</li> <li>\u5de6\u4fa7\u56fe\u8868\u7eb5\u8f74\u4e3a Instructions per Cycle (IPC)\uff0c\u53f3\u4fa7\u56fe\u8868\u7eb5\u8f74\u4e3a BPKI (Memory Bus Accesses per thousand retired Instructions)\uff0c\u6a2a\u8f74\u5747\u4e3a\u57fa\u51c6\u7a0b\u5e8f\u540d\u79f0\uff1acrafty, eon, gcc, gzip, perlbench, twolf, apsi, fma3d, lucas, gmean\u3002</li> <li>\u56fe\u4f8b\u7edf\u4e00\u5305\u542b\u4e94\u79cd\u914d\u7f6e\uff1a</li> <li>No prefetching</li> <li>Very Conservative</li> <li>Middle-of-the-Road</li> <li>Very Aggressive</li> <li>Dyn. Aggressive. + Dyn. Insertion\uff08\u5373 FDP \u6700\u7ec8\u65b9\u6848\uff09</li> <li>\u5728 IPC \u6027\u80fd\u65b9\u9762\uff1a</li> <li>\u591a\u6570\u7a0b\u5e8f\u4e2d\uff0cFDP \u65b9\u6848\uff08Dyn. Aggressive. + Dyn. Insertion\uff09 \u7684 IPC \u8868\u73b0\u4e0e\u6700\u4f73\u4f20\u7edf\u914d\u7f6e\uff08\u901a\u5e38\u662f Middle-of-the-Road\uff09\u6301\u5e73\u6216\u7565\u4f18\u3002</li> <li>gcc \u7a0b\u5e8f\u8868\u73b0\u7a81\u51fa\uff0cFDP \u76f8\u6bd4 Middle-of-the-Road \u914d\u7f6e\u63d0\u5347\u7ea6 3.0%\u3002</li> <li>gmean\uff08\u51e0\u4f55\u5e73\u5747\u503c\uff09\u663e\u793a FDP \u63d0\u4f9b 0.4% \u7684\u5e73\u5747 IPC \u589e\u76ca\u3002</li> <li>\u5728 BPKI \u5e26\u5bbd\u6d88\u8017\u65b9\u9762\uff1a</li> <li>FDP \u65b9\u6848\u5728\u591a\u6570\u7a0b\u5e8f\u4e2d\u663e\u8457\u964d\u4f4e\u5e26\u5bbd\u6d88\u8017\uff0c\u5c24\u5176\u5728 gcc \u548c fma3d \u4e2d\u6548\u679c\u660e\u663e\u3002</li> <li>gmean \u663e\u793a FDP \u5e73\u5747\u51cf\u5c11 0.2% \u7684 BPKI\u3002</li> <li>\u5173\u952e\u7ed3\u8bba\uff1a</li> <li>\u5bf9\u4e8e\u8fd9 9 \u4e2a\u975e\u5185\u5b58\u5bc6\u96c6\u578b\u7a0b\u5e8f\uff0cFDP \u672a\u9020\u6210\u6027\u80fd\u635f\u5931\uff0c\u4e14\u5728\u90e8\u5206\u7a0b\u5e8f\uff08\u5982 gcc\uff09\u4e0a\u5e26\u6765\u53ef\u89c2\u6536\u76ca\u3002</li> <li>FDP \u901a\u8fc7\u52a8\u6001\u8c03\u6574\u6709\u6548\u6291\u5236\u4e86\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u5668\u5728\u8fd9\u4e9b\u7a0b\u5e8f\u4e2d\u53ef\u80fd\u5f15\u53d1\u7684 L2 cache pollution\uff0c\u7279\u522b\u662f\u5728 gcc \u4e2d\u907f\u514d\u4e86\u56e0\u6307\u4ee4\u5757\u88ab\u9a71\u9010\u5bfc\u81f4\u7684\u957f\u5ef6\u8fdf\u7f13\u5b58\u7f3a\u5931\u3002</li> <li>\u6570\u636e\u6c47\u603b\u5982\u4e0b\uff1a</li> </ul> Benchmark Best Traditional Config (IPC) FDP (IPC) IPC Gain (%) FDP (BPKI) BPKI Reduction (%) crafty Middle-of-the-Road \u2248Same ~0 \u2193 ~0 eon Middle-of-the-Road \u2248Same ~0 \u2193 ~0 gcc Middle-of-the-Road \u2191 +3.0 \u2193\u2193 Significant gzip Middle-of-the-Road \u2248Same ~0 \u2193 ~0 perlbench Middle-of-the-Road \u2248Same ~0 \u2193 ~0 twolf Middle-of-the-Road \u2248Same ~0 \u2193 ~0 apsi Middle-of-the-Road \u2248Same ~0 \u2193 ~0 fma3d Middle-of-the-Road \u2248Same ~0 \u2193 Significant lucas Middle-of-the-Road \u2248Same ~0 \u2193 ~0 gmean Middle-of-the-Road \u2191 +0.4 \u2193 -0.2 <ul> <li>\u6574\u4f53\u800c\u8a00\uff0cFDP \u5728\u975e\u5185\u5b58\u5bc6\u96c6\u578b\u7a0b\u5e8f\u4e2d\u5c55\u73b0\u4e86\u826f\u597d\u7684\u517c\u5bb9\u6027\u548c\u7a33\u5b9a\u6027\uff0c\u65e2\u80fd\u7ef4\u6301\u6027\u80fd\uff0c\u53c8\u80fd\u5c0f\u5e45\u4f18\u5316\u5e26\u5bbd\u6548\u7387\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/","title":"Feedback Directed Prefetching: Improving the Performance and Bandwidth-Efficiency of Hardware Prefetchers \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Santhosh Srinath\u2020\u2021 - Onur Mutlu\u00a7 - Hyesoon Kim\u2021 - Yale N. Patt\u2021</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - \u8be5\u8bba\u6587\u672a\u5728\u63d0\u4f9b\u7684\u6587\u672c\u4e2d\u660e\u786e\u6307\u51fa\u5176\u53d1\u8868\u7684\u671f\u520a\u6216\u4f1a\u8bae\u540d\u79f0\u3002</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - \u8be5\u8bba\u6587\u672a\u5728\u63d0\u4f9b\u7684\u6587\u672c\u4e2d\u660e\u786e\u6307\u51fa\u5176\u53d1\u8868\u5e74\u4efd\u3002</p>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u4f20\u7edf\u786c\u4ef6\u6570\u636e\u9884\u53d6\u5668\uff08hardware data prefetcher\uff09\u5b58\u5728\u7684\u4e24\u5927\u6838\u5fc3\u95ee\u9898\uff1a\u6027\u80fd\u4e0d\u7a33\u5b9a\uff08\u5728\u67d0\u4e9b\u7a0b\u5e8f\u4e0a\u56e0\u8fc7\u5ea6\u6fc0\u8fdb\u7684\u9884\u53d6\u5bfc\u81f4\u6027\u80fd\u4e25\u91cd\u4e0b\u964d\uff09\u548c\u5185\u5b58\u5e26\u5bbd\u6548\u7387\u4f4e\u4e0b\uff08\u4ea7\u751f\u5927\u91cf\u65e0\u7528\u9884\u53d6\uff0c\u6d6a\u8d39\u5e26\u5bbd\u5e76\u5f15\u53d1\u7f13\u5b58\u6c61\u67d3\uff09\u3002 - \u63d0\u51fa\u4e00\u79cd\u901a\u7528\u7684\u3001\u57fa\u4e8e\u52a8\u6001\u53cd\u9988\u7684\u673a\u5236\uff0c\u4ee5\u63d0\u5347\u9884\u53d6\u5668\u7684\u6027\u80fd\u548c\u5e26\u5bbd\u6548\u7387\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa Feedback Directed Prefetching (FDP) \u673a\u5236\uff0c\u901a\u8fc7\u5b9e\u65f6\u76d1\u63a7\u4e09\u4e2a\u5173\u952e\u6307\u6807\u6765\u52a8\u6001\u8c03\u6574\u9884\u53d6\u884c\u4e3a\uff1a   - Prefetch Accuracy (\u9884\u53d6\u51c6\u786e\u7387)\uff1a\u8861\u91cf\u9884\u53d6\u7684\u6570\u636e\u5757\u4e2d\u6709\u591a\u5c11\u88ab\u540e\u7eed\u7684\u5b9e\u9645\u9700\u6c42\uff08demand access\uff09\u6240\u4f7f\u7528\u3002   - Prefetch Lateness (\u9884\u53d6\u5ef6\u8fdf)\uff1a\u8861\u91cf\u6709\u7528\u7684\u9884\u53d6\u8bf7\u6c42\u4e2d\u6709\u591a\u5c11\u672a\u80fd\u53ca\u65f6\u8fd4\u56de\uff0c\u5bfc\u81f4\u9700\u6c42\u8bbf\u95ee\u65f6\u4ecd\u9700\u7b49\u5f85\u3002   - Prefetcher-Generated Cache Pollution (\u9884\u53d6\u5668\u5f15\u53d1\u7684\u7f13\u5b58\u6c61\u67d3)\uff1a\u8861\u91cf\u56e0\u9884\u53d6\u6570\u636e\u800c\u88ab\u9a71\u9010\u3001\u4e14\u540e\u7eed\u53c8\u88ab\u9700\u6c42\u8bbf\u95ee\u7684\u7f13\u5b58\u5757\u6570\u91cf\u3002 - \u8bbe\u8ba1\u4e86\u4f4e\u6210\u672c\u7684\u786c\u4ef6\u7ed3\u6784\u6765\u6536\u96c6\u4e0a\u8ff0\u53cd\u9988\u4fe1\u606f\uff1a   - \u4f7f\u7528 pref-bit \u6807\u8bb0\u9884\u53d6\u5757\uff0c\u5e76\u901a\u8fc7\u8ba1\u6570\u5668 <code>pref-total</code> \u548c <code>used-total</code> \u8ba1\u7b97\u51c6\u786e\u7387\u3002   - \u5229\u7528 MSHR (Miss Status Holding Register) \u4e2d\u7684 <code>pref-bit</code> \u548c\u8ba1\u6570\u5668 <code>late-total</code> \u6765\u68c0\u6d4b\u5ef6\u8fdf\u7684\u9884\u53d6\u3002   - \u91c7\u7528 Bloom filter \u7ed3\u6784\uff08\u4e00\u4e2a4096-entry\u7684\u4f4d\u5411\u91cf\uff09\u6765\u8fd1\u4f3c\u4f30\u7b97\u7f13\u5b58\u6c61\u67d3\uff0c\u907f\u514d\u4e86\u4e3a\u6bcf\u4e2a\u88ab\u9a71\u9010\u5757\u7ef4\u62a4\u72b6\u6001\u7684\u9ad8\u6602\u5f00\u9500 </p> <p></p> <p>Figure 3. IPC performance (left) and prefetch lateness (right) with different aggressiveness configurations Figure 4. Filter to estimate prefetcher-generated cache pollution</p> <p>\u3002 - \u57fa\u4e8e\u91c7\u6837\u95f4\u9694\uff08\u4ee5L2\u7f13\u5b58\u9a71\u9010\u6b21\u6570\u4e3a\u5355\u4f4d\uff09\u6536\u96c6\u7684\u6307\u6807\uff0c\u52a8\u6001\u8c03\u6574\u4e24\u4e2a\u65b9\u9762\uff1a   1.  \u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u5ea6 (Aggressiveness)\uff1a\u901a\u8fc7\u4e00\u4e2a3-bit\u7684\u9971\u548c\u8ba1\u6570\u5668\uff0c\u5728\u201c\u975e\u5e38\u4fdd\u5b88\u201d\u5230\u201c\u975e\u5e38\u6fc0\u8fdb\u201d\u4e94\u4e2a\u914d\u7f6e\u95f4\u5207\u6362\u3002\u8c03\u6574\u7b56\u7565\u7efc\u5408\u8003\u8651\u4e86\u51c6\u786e\u7387\u3001\u5ef6\u8fdf\u548c\u6c61\u67d3\u4e09\u4e2a\u6307\u6807 </p> <p></p> <p>\u3002   2.  \u9884\u53d6\u5757\u7684\u7f13\u5b58\u63d2\u5165\u4f4d\u7f6e (Cache Insertion Policy)\uff1a\u6839\u636e\u4f30\u7b97\u7684\u6c61\u67d3\u7a0b\u5ea6\uff0c\u52a8\u6001\u51b3\u5b9a\u5c06\u9884\u53d6\u5757\u63d2\u5165LRU\u6808\u7684 MRU\uff08\u6700\u8fd1\u4f7f\u7528\uff09\u3001MID\uff08\u4e2d\u95f4\uff09\u3001LRU-4 \u6216 LRU\uff08\u6700\u4e45\u672a\u4f7f\u7528\uff09\u4f4d\u7f6e\u3002</p> <p>\u7ed3\u679c - \u572817\u4e2a\u5185\u5b58\u5bc6\u96c6\u578bSPEC CPU2000\u57fa\u51c6\u6d4b\u8bd5\u4e0a\uff0c\u4e0e\u8868\u73b0\u6700\u4f73\u7684\u4f20\u7edf\u6d41\u5f0f\u9884\u53d6\u5668\uff08Very Aggressive\uff09\u76f8\u6bd4\uff1a   - FDP\uff08\u540c\u65f6\u8c03\u6574\u6fc0\u8fdb\u5ea6\u548c\u63d2\u5165\u7b56\u7565\uff09\u5b9e\u73b0\u4e86 6.5% \u7684\u5e73\u5747\u6027\u80fd\uff08IPC\uff09\u63d0\u5347\u3002   - \u5185\u5b58\u5e26\u5bbd\u6d88\u8017\uff08BPKI\uff09\u51cf\u5c11\u4e86 18.7%\u3002 - \u4e0e\u6d88\u8017\u76f8\u4f3c\u5e26\u5bbd\u7684\u4f20\u7edf\u9884\u53d6\u5668\uff08Middle-of-the-Road\uff09\u76f8\u6bd4\uff0cFDP\u63d0\u4f9b\u4e86 13.6% \u7684\u66f4\u9ad8\u6027\u80fd\u3002 - \u5b8c\u5168\u6d88\u9664\u4e86\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u5668\u5728 <code>ammp</code> \u548c <code>applu</code> \u7b49\u57fa\u51c6\u6d4b\u8bd5\u4e0a\u7684\u5de8\u5927\u6027\u80fd\u635f\u5931 </p> <p></p> <p>Figure 9. Overall performance of FDP</p> <p>\u3002 - FDP\u673a\u5236\u5177\u6709\u826f\u597d\u7684\u901a\u7528\u6027\uff0c\u5728 Global-History-Buffer (GHB) \u548c PC-based stride prefetcher \u4e0a\u540c\u6837\u6709\u6548\u3002 - \u786c\u4ef6\u5f00\u9500\u6781\u4f4e\uff0c\u4ec5\u4e3a 2.54 KB\uff0c\u4e0d\u52301MB L2\u7f13\u5b58\u6570\u636e\u5b58\u50a8\u5927\u5c0f\u76840.25%\u3002</p> \u914d\u7f6e \u5e73\u5747 IPC \u5e73\u5747 BPKI No Prefetching 1.00x 1.00x Very Conservative 1.08x 1.06x Middle-of-the-Road 1.12x 1.13x Very Aggressive (Best Conventional) 1.18x 1.30x FDP (Proposed) 1.26x (+6.5%) 1.06x (-18.7%) <p>\u7ed3\u8bba - \u5c06\u52a8\u6001\u53cd\u9988\u673a\u5236\u5f15\u5165\u786c\u4ef6\u9884\u53d6\u5668\u8bbe\u8ba1\u662f\u63d0\u5347\u5176\u6027\u80fd\u548c\u5e26\u5bbd\u6548\u7387\u7684\u6709\u6548\u9014\u5f84\u3002 - \u7efc\u5408\u8003\u91cf\u51c6\u786e\u7387\u3001\u5ef6\u8fdf\u548c\u7f13\u5b58\u6c61\u67d3\u8fd9\u4e09\u4e2a\u7ef4\u5ea6\uff0c\u6bd4\u4ec5\u4f9d\u8d56\u5355\u4e00\u6307\u6807\uff08\u5982\u51c6\u786e\u7387\uff09\u80fd\u5e26\u6765\u66f4\u663e\u8457\u7684\u6536\u76ca\uff08+3.4%\u6027\u80fd\uff0c-2.5%\u5e26\u5bbd\uff09\u3002 - \u6240\u63d0\u51fa\u7684\u4f4e\u6210\u672c\u786c\u4ef6\u65b9\u6848\uff08\u7279\u522b\u662f\u57fa\u4e8eBloom filter\u7684\u6c61\u67d3\u4f30\u7b97\u548c\u52a8\u6001LRU\u63d2\u5165\u7b56\u7565\uff09\u5177\u6709\u5f88\u9ad8\u7684\u5b9e\u7528\u4ef7\u503c\u548c\u53ef\u6269\u5c55\u6027\uff0c\u9002\u7528\u4e8e\u591a\u79cd\u73b0\u4ee3\u9884\u53d6\u5668\u67b6\u6784\u3002</p>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f\u4e0e\u52a8\u673a</p> <ul> <li>\u73b0\u4ee3\u9ad8\u6027\u80fd\u5904\u7406\u5668\u666e\u904d\u91c7\u7528\u786c\u4ef6\u6570\u636e\u9884\u53d6 (hardware data prefetching) \u6280\u672f\u6765\u9690\u85cf\u5de8\u5927\u7684\u4e3b\u5b58\u5ef6\u8fdf (main memory latency)\uff0c\u901a\u8fc7\u9884\u6d4b\u7a0b\u5e8f\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u5e76\u63d0\u524d\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u7f13\u5b58\u4e2d\u3002</li> <li>\u5c3d\u7ba1\u9884\u53d6\u80fd\u663e\u8457\u63d0\u5347\u8bb8\u591a\u7a0b\u5e8f\u7684\u6027\u80fd\uff0c\u4f46\u5b83\u4e5f\u5b58\u5728\u4e24\u5927\u4e25\u91cd\u5f0a\u7aef\uff1a</li> <li>\u5e26\u5bbd\u6d6a\u8d39\u4e0e\u4e89\u7528: \u4e0d\u51c6\u786e\u7684\u9884\u53d6\u8bf7\u6c42\u4f1a\u6d88\u8017\u5b9d\u8d35\u7684\u5185\u5b58\u5e26\u5bbd (memory bandwidth)\uff0c\u5e76\u4e0e\u5173\u952e\u7684\u9700\u6c42\u8bf7\u6c42 (demand requests) \u4ea7\u751f\u4e89\u7528\uff0c\u53cd\u800c\u589e\u52a0\u5ef6\u8fdf\u3002</li> <li>\u7f13\u5b58\u6c61\u67d3 (cache pollution): \u9884\u53d6\u7684\u6570\u636e\u53ef\u80fd\u9a71\u9010\u6389\u672a\u6765\u4f1a\u88ab\u7a0b\u5e8f\u771f\u6b63\u4f7f\u7528\u7684\u7f13\u5b58\u5757\uff0c\u4e0d\u4ec5\u964d\u4f4e\u6027\u80fd\uff0c\u8fd8\u4f1a\u56e0\u9700\u8981\u91cd\u65b0\u52a0\u8f7d\u88ab\u9a71\u9010\u7684\u6570\u636e\u800c\u8fdb\u4e00\u6b65\u6d6a\u8d39\u5e26\u5bbd\u3002</li> <li>\u4f20\u7edf\u7684\u9884\u53d6\u5668\uff08\u5982\u6d41\u5f0f\u9884\u53d6\u5668 (stream-based prefetcher)\uff09\u901a\u5e38\u91c7\u7528\u9759\u6001\u7684\u3001\u56fa\u5b9a\u6fc0\u8fdb\u5ea6 (fixed aggressiveness) \u914d\u7f6e\u3002\u5982\u56fe1\u6240\u793a\uff0c\u8fd9\u79cd\u201c\u4e00\u5200\u5207\u201d\u7684\u7b56\u7565\u5728\u67d0\u4e9b\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 <code>ammp</code>, <code>applu</code>\uff09\u4e0a\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u6027\u80fd\u4e0b\u964d\uff0c\u8feb\u4f7f\u73b0\u4ee3\u5904\u7406\u5668\u4e0d\u5f97\u4e0d\u91c7\u7528\u76f8\u5bf9\u4fdd\u5b88\u7684\u7b56\u7565\uff0c\u4ece\u800c\u727a\u7272\u4e86\u5728\u5176\u4ed6\u7a0b\u5e8f\u4e0a\u7684\u6f5c\u5728\u6027\u80fd\u6536\u76ca\u3002</li> </ul> <p></p> <p>Figure 1. Performance vs. aggressiveness of the prefetcher</p> <ul> <li>\u9884\u53d6\u5668\u672c\u8eab\u662f\u4e00\u4e2a\u6b63\u53cd\u9988\u7cfb\u7edf\uff1a\u9519\u8bef\u7684\u9884\u53d6\u5bfc\u81f4\u7f13\u5b58\u7f3a\u5931\uff0c\u65b0\u7684\u7f3a\u5931\u53c8\u53ef\u80fd\u89e6\u53d1\u66f4\u591a\u65e0\u7528\u7684\u9884\u53d6\uff0c\u5f62\u6210\u6076\u6027\u5faa\u73af\u3002\u56e0\u6b64\uff0c\u4e9f\u9700\u5f15\u5165\u4e00\u4e2a\u8d1f\u53cd\u9988\u673a\u5236\u6765\u52a8\u6001\u8c03\u8282\u5176\u884c\u4e3a\uff0c\u4f7f\u5176\u7a33\u5b9a\u9ad8\u6548\u3002</li> </ul> <p>\u6838\u5fc3\u8d21\u732e</p> <ul> <li>\u63d0\u51fa\u4e86\u4e00\u79cd\u540d\u4e3a\u53cd\u9988\u5bfc\u5411\u9884\u53d6 (Feedback Directed Prefetching, FDP) \u7684\u901a\u7528\u52a8\u6001\u8c03\u8282\u6846\u67b6\uff0c\u8be5\u6846\u67b6\u901a\u8fc7\u5b9e\u65f6\u76d1\u63a7\u4e09\u4e2a\u5173\u952e\u6307\u6807\u6765\u8c03\u6574\u9884\u53d6\u5668\u7684\u884c\u4e3a\uff1a</li> <li>\u9884\u53d6\u51c6\u786e\u7387 (Prefetch Accuracy): \u8861\u91cf\u9884\u53d6\u5730\u5740\u7684\u9884\u6d4b\u51c6\u786e\u6027\u3002</li> <li>\u9884\u53d6\u53ca\u65f6\u6027/\u5ef6\u8fdf (Prefetch Lateness): \u8861\u91cf\u9884\u53d6\u6570\u636e\u662f\u5426\u5728\u9700\u6c42\u5230\u6765\u524d\u5df2\u5c31\u7eea\u3002</li> <li>\u9884\u53d6\u5668\u5f15\u53d1\u7684\u7f13\u5b58\u6c61\u67d3 (Prefetcher-Generated Cache Pollution): \u8861\u91cf\u9884\u53d6\u64cd\u4f5c\u5bfc\u81f4\u7684\u6709\u7528\u6570\u636e\u88ab\u9a71\u9010\u7684\u7a0b\u5ea6\u3002</li> <li>\u8bbe\u8ba1\u4e86\u4e00\u79cd\u4f4e\u6210\u672c\u3001\u57fa\u4e8e\u5e03\u9686\u8fc7\u6ee4\u5668 (Bloom filter) \u7684\u786c\u4ef6\u673a\u5236\uff0c\u7528\u4e8e\u5728\u8fd0\u884c\u65f6\u9ad8\u6548\u5730\u4f30\u7b97\u7f13\u5b58\u6c61\u67d3\uff0c\u89e3\u51b3\u4e86\u7cbe\u786e\u8ffd\u8e2a\u6c61\u67d3\u5f00\u9500\u8fc7\u5927\u7684\u96be\u9898\u3002</li> </ul> <p></p> <p>Figure 3. IPC performance (left) and prefetch lateness (right) with different aggressiveness configurations Figure 4. Filter to estimate prefetcher-generated cache pollution</p> <ul> <li>FDP \u4ece\u4e24\u4e2a\u7ef4\u5ea6\u52a8\u6001\u8c03\u6574\u9884\u53d6\u884c\u4e3a\uff1a</li> <li>\u52a8\u6001\u8c03\u8282\u9884\u53d6\u6fc0\u8fdb\u5ea6: \u6839\u636e\u4e0a\u8ff0\u4e09\u4e2a\u6307\u6807\u7684\u53cd\u9988\uff0c\u4f7f\u7528\u4e00\u4e2a\u9971\u548c\u8ba1\u6570\u5668 (saturating counter) \u5728\u591a\u4e2a\u9884\u8bbe\u914d\u7f6e\uff08\u4ece\u975e\u5e38\u4fdd\u5b88\u5230\u975e\u5e38\u6fc0\u8fdb\uff09\u4e4b\u95f4\u5207\u6362\u3002</li> <li>\u52a8\u6001\u8c03\u8282\u7f13\u5b58\u63d2\u5165\u7b56\u7565: \u6839\u636e\u4f30\u7b97\u7684\u7f13\u5b58\u6c61\u67d3\u7a0b\u5ea6\uff0c\u51b3\u5b9a\u5c06\u9884\u53d6\u5757\u63d2\u5165\u5230 LRU \u6808\u7684\u4e0d\u540c\u4f4d\u7f6e\uff08\u5982 MRU, MID, LRU-4, LRU\uff09\uff0c\u4ee5\u5e73\u8861\u4fdd\u7559\u6709\u7528\u9884\u53d6\u548c\u51cf\u5c11\u6c61\u67d3\u4e4b\u95f4\u7684\u77db\u76fe\u3002</li> <li>\u5b9e\u9a8c\u7ed3\u679c\u8868\u660e\uff0cFDP \u5728 SPEC CPU2000 \u7684 17 \u4e2a\u5185\u5b58\u5bc6\u96c6\u578b\u57fa\u51c6\u6d4b\u8bd5\u4e0a\uff0c\u76f8\u6bd4\u6027\u80fd\u6700\u4f73\u7684\u4f20\u7edf\u6d41\u5f0f\u9884\u53d6\u5668\u914d\u7f6e\uff0c\u5b9e\u73b0\u4e86 6.5% \u7684\u5e73\u5747\u6027\u80fd\u63d0\u5347\uff0c\u5e76\u51cf\u5c11\u4e86 18.7% \u7684\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u3002\u66f4\u91cd\u8981\u7684\u662f\uff0c\u5b83\u5b8c\u5168\u6d88\u9664\u4e86\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u5728 <code>ammp</code> \u548c <code>applu</code> \u7b49\u7a0b\u5e8f\u4e0a\u7684\u5de8\u5927\u6027\u80fd\u635f\u5931\u3002</li> <li>FDP \u5177\u6709\u826f\u597d\u7684\u901a\u7528\u6027\uff0c\u540c\u6837\u9002\u7528\u4e8e GHB-based delta correlation prefetcher \u548c PC-based stride prefetcher\uff0c\u8bc1\u660e\u4e86\u5176\u4f5c\u4e3a\u4e00\u79cd\u901a\u7528\u4f18\u5316\u6846\u67b6\u7684\u4ef7\u503c\u3002\u5176\u786c\u4ef6\u5f00\u9500\u4ec5\u4e3a 2.54 KB\uff0c\u4e14\u4e0d\u589e\u52a0\u5173\u952e\u8def\u5f84\u5ef6\u8fdf\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>\u672c\u6587\u63d0\u51fa\u7684 Feedback Directed Prefetching (FDP) \u662f\u4e00\u79cd\u52a8\u6001\u53cd\u9988\u673a\u5236\uff0c\u65e8\u5728\u901a\u8fc7\u5b9e\u65f6\u76d1\u63a7\u786c\u4ef6\u9884\u53d6\u5668\uff08Hardware Prefetcher\uff09\u7684\u8fd0\u884c\u6548\u679c\uff0c\u6765\u52a8\u6001\u8c03\u6574\u5176\u884c\u4e3a\uff0c\u4ece\u800c\u5728\u63d0\u5347\u6027\u80fd\u7684\u540c\u65f6\u964d\u4f4e\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u3002\u5176\u6838\u5fc3\u67b6\u6784\u56f4\u7ed5\u4e09\u4e2a\u5173\u952e\u6307\u6807\u7684\u6536\u96c6\u3001\u5206\u6790\u4e0e\u53cd\u9988\u6267\u884c\u5c55\u5f00\u3002</p> <ul> <li>\u53cd\u9988\u4fe1\u606f\u6536\u96c6\u5c42 (Feedback Collection Layer)</li> <li>\u8be5\u5c42\u8d1f\u8d23\u5728\u786c\u4ef6\u5c42\u9762\u5b9e\u65f6\u4f30\u7b97\u4e09\u4e2a\u6838\u5fc3\u6307\u6807\uff1a<ul> <li>Prefetch Accuracy (\u9884\u53d6\u51c6\u786e\u7387): \u901a\u8fc7\u5728 L2 \u7f13\u5b58\u7684\u6bcf\u4e2a tag \u6761\u76ee\u4e2d\u589e\u52a0\u4e00\u4e2a pref-bit \u6807\u8bb0\u4f4d\uff0c\u5e76\u914d\u5408\u4e24\u4e2a\u8ba1\u6570\u5668 preftotal (\u603b\u9884\u53d6\u6570) \u548c used-total (\u6709\u7528\u9884\u53d6\u6570) \u6765\u8ba1\u7b97\u3002\u5f53\u9884\u53d6\u5757\u88ab\u9700\u6c42\u8bbf\u95ee\u65f6\uff0c\u8be5\u4f4d\u88ab\u91cd\u7f6e\u5e76\u589e\u52a0 used-total\u3002</li> <li>Prefetch Lateness (\u9884\u53d6\u5ef6\u8fdf\u5ea6): \u5229\u7528 Miss Status Holding Register (MSHR) \u7ed3\u6784\u3002MSHR \u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u4e5f\u5305\u542b\u4e00\u4e2a pref-bit\u3002\u5f53\u4e00\u4e2a\u9700\u6c42\u8bf7\u6c42\u547d\u4e2d\u4e86\u4e00\u4e2a pref-bit \u88ab\u7f6e\u4f4d\u7684 MSHR \u6761\u76ee\u65f6\uff0c\u8bf4\u660e\u8be5\u9884\u53d6\u662f\u5ef6\u8fdf\u7684\uff0c\u6b64\u65f6\u9012\u589e late-total \u8ba1\u6570\u5668\u3002</li> <li>Prefetcher-Generated Cache Pollution (\u9884\u53d6\u5668\u5f15\u53d1\u7684\u7f13\u5b58\u6c61\u67d3): \u91c7\u7528\u57fa\u4e8e Bloom filter \u6982\u5ff5\u7684\u786c\u4ef6\u7ed3\u6784\uff08\u79f0\u4e3a pollution filter\uff09\u6765\u4f4e\u6210\u672c\u5730\u8fd1\u4f3c\u4f30\u7b97\u3002\u8be5 filter \u662f\u4e00\u4e2a\u4f4d\u5411\u91cf\uff0c\u7528\u4e8e\u8ffd\u8e2a\u56e0\u9884\u53d6\u800c\u88ab\u9a71\u9010\u7684\u9700\u6c42\u5757\u3002\u5f53\u53d1\u751f\u9700\u6c42\u7f3a\u5931\u65f6\uff0c\u67e5\u8be2\u6b64 filter \u53ef\u5224\u65ad\u8be5\u7f3a\u5931\u662f\u5426\u7531\u9884\u53d6\u5f15\u8d77\uff0c\u5e76\u66f4\u65b0 pollution-total \u8ba1\u6570\u5668\u3002</li> </ul> </li> <li> <p>\u6240\u6709\u6307\u6807\u7684\u6536\u96c6\u90fd\u91c7\u7528\u57fa\u4e8e\u91c7\u6837\u7684\u533a\u95f4\u66f4\u65b0\u7b56\u7565\uff0c\u4ee5\u9002\u5e94\u7a0b\u5e8f\u7684\u9636\u6bb5\u6027\u884c\u4e3a\u53d8\u5316\u3002\u4e00\u4e2a\u91c7\u6837\u533a\u95f4\u7684\u957f\u5ea6\u7531 L2 \u7f13\u5b58\u7684\u9a71\u9010\u5757\u6570\u91cf\uff08eviction-count\uff09\u51b3\u5b9a\uff0c\u800c\u975e\u56fa\u5b9a\u65f6\u95f4\u5468\u671f\u3002</p> </li> <li> <p>\u51b3\u7b56\u4e0e\u8c03\u6574\u5c42 (Decision &amp; Adaptation Layer)</p> </li> <li>\u5728\u6bcf\u4e2a\u91c7\u6837\u533a\u95f4\u7ed3\u675f\u65f6\uff0c\u7cfb\u7edf\u4f1a\u6839\u636e\u6536\u96c6\u5230\u7684\u4e09\u4e2a\u6307\u6807\u7684\u52a0\u6743\u5e73\u5747\u503c\uff0c\u4e0e\u9884\u8bbe\u7684\u9759\u6001\u9608\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u800c\u505a\u51fa\u8c03\u6574\u51b3\u7b56\u3002</li> <li>FDP \u901a\u8fc7\u4e24\u79cd\u4e92\u8865\u7684\u65b9\u5f0f\u6765\u8c03\u6574\u9884\u53d6\u5668\u884c\u4e3a\uff1a<ul> <li>\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u6fc0\u8fdb\u7a0b\u5ea6 (Dynamic Aggressiveness):</li> <li>\u4f7f\u7528\u4e00\u4e2a 3-bit \u9971\u548c\u8ba1\u6570\u5668 (Dynamic Configuration Counter) \u6765\u8868\u793a\u5f53\u524d\u7684\u9884\u53d6\u914d\u7f6e\uff0c\u8303\u56f4\u4ece Very Conservative \u5230 Very Aggressive\u3002</li> <li>\u6839\u636e Accuracy, Lateness, \u548c Pollution \u4e09\u4e2a\u6307\u6807\u7684\u7ec4\u5408\u60c5\u51b5\uff08\u517112\u79cd\u573a\u666f\uff09\uff0c\u67e5\u8868\uff08Table 2\uff09\u51b3\u5b9a\u662f\u589e\u52a0\u3001\u51cf\u5c11\u8fd8\u662f\u4fdd\u6301\u8ba1\u6570\u5668\u7684\u503c\uff0c\u4ece\u800c\u52a8\u6001\u6539\u53d8 Prefetch Distance \u548c Prefetch Degree\u3002</li> </ul> </li> </ul> <p></p> <pre><code>- **\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5757\u7f13\u5b58\u63d2\u5165\u7b56\u7565 (Dynamic Insertion Policy)**:\n  - \u4e0d\u518d\u5c06\u6240\u6709\u9884\u53d6\u5757\u65e0\u5dee\u522b\u5730\u63d2\u5165 LRU \u6808\u7684 **MRU (Most-Recently-Used)** \u4f4d\u7f6e\u3002\n  - \u800c\u662f\u6839\u636e\u4f30\u7b97\u7684 **Cache Pollution** \u7a0b\u5ea6\uff0c\u52a8\u6001\u9009\u62e9\u63d2\u5165\u4f4d\u7f6e\uff1a**MID** (\u4e2d\u95f4\u4f4d\u7f6e), **LRU-4** (\u56db\u5206\u4e4b\u4e00\u4f4d\u7f6e), \u6216 **LRU** (\u6700\u4e0d\u5e38\u7528\u4f4d\u7f6e)\u3002\u6c61\u67d3\u8d8a\u9ad8\uff0c\u63d2\u5165\u4f4d\u7f6e\u8d8a\u9760\u8fd1 LRU \u7aef\uff0c\u4ee5\u51cf\u5c11\u5bf9\u6709\u7528\u6570\u636e\u7684\u5e72\u6270\u3002\n</code></pre> <ul> <li>\u9002\u7528\u6027\u4e0e\u8bc4\u4f30</li> <li>FDP \u88ab\u8bbe\u8ba1\u4e3a\u4e00\u4e2a\u901a\u7528\u6846\u67b6\uff0c\u8bba\u6587\u9a8c\u8bc1\u4e86\u5176\u5728 Stream-based prefetcher, Global-History-Buffer (GHB) based delta correlation prefetcher, \u548c PC-based stride prefetcher \u4e09\u79cd\u4e3b\u6d41\u786c\u4ef6\u9884\u53d6\u5668\u4e0a\u7684\u6709\u6548\u6027\u3002</li> <li>\u5b9e\u9a8c\u7ed3\u679c\u8868\u660e\uff0cFDP \u5728 SPEC CPU2000 \u5957\u4ef6\u7684 17 \u4e2a\u5185\u5b58\u5bc6\u96c6\u578b\u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u76f8\u6bd4\u6700\u4f73\u7684\u4f20\u7edf\u9884\u53d6\u5668\u914d\u7f6e\uff0c\u5b9e\u73b0\u4e86 6.5% \u7684\u5e73\u5747\u6027\u80fd\u63d0\u5347\u548c 18.7% \u7684\u5185\u5b58\u5e26\u5bbd\u8282\u7701\u3002</li> <li>\u5176\u786c\u4ef6\u5f00\u9500\u6781\u4f4e\uff0c\u4ec5\u4e3a 2.54 KB \u7684\u989d\u5916\u5b58\u50a8\uff0c\u4e14\u4e0d\u589e\u52a0\u5173\u952e\u8def\u5f84\u5ef6\u8fdf\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#1_1","title":"1. \u52a8\u6001\u53cd\u9988\u9a71\u52a8\u7684\u9884\u53d6\u5668\u6fc0\u8fdb\u5ea6\u8c03\u6574","text":"<p>\u52a8\u6001\u53cd\u9988\u9a71\u52a8\u7684\u9884\u53d6\u5668\u6fc0\u8fdb\u5ea6\u8c03\u6574\u673a\u5236</p> <p>\u8be5\u673a\u5236\u7684\u6838\u5fc3\u5728\u4e8e\u901a\u8fc7\u4e00\u4e2a\u95ed\u73af\u63a7\u5236\u7cfb\u7edf\uff0c\u5229\u7528\u8fd0\u884c\u65f6\u6536\u96c6\u7684\u53cd\u9988\u4fe1\u606f\u6765\u52a8\u6001\u8c03\u8282\u786c\u4ef6\u9884\u53d6\u5668\u7684\u884c\u4e3a\uff0c\u4ece\u800c\u5728\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\u7684\u540c\u65f6\uff0c\u6700\u5c0f\u5316\u5176\u5e26\u6765\u7684\u8d1f\u9762\u5f71\u54cd\u3002</p> <ul> <li> <p>\u8f93\u5165\uff1a\u4e09\u5927\u6838\u5fc3\u53cd\u9988\u6307\u6807</p> <ul> <li>Prefetch Accuracy (\u9884\u53d6\u51c6\u786e\u7387): \u8861\u91cf\u9884\u53d6\u8bf7\u6c42\u4e2d\u6709\u591a\u5c11\u662f\u771f\u6b63\u88ab\u7a0b\u5e8f\u4f7f\u7528\u7684\u3002\u8ba1\u7b97\u516c\u5f0f\u4e3a <code>\u6709\u7528\u9884\u53d6\u6570 / \u603b\u9884\u53d6\u6570</code>\u3002\u4f4e\u51c6\u786e\u7387\u610f\u5473\u7740\u5927\u91cf\u5e26\u5bbd\u88ab\u6d6a\u8d39\u5728\u65e0\u7528\u6570\u636e\u4e0a\u3002</li> <li>Prefetch Lateness (\u9884\u53d6\u53ca\u65f6\u6027): \u8861\u91cf\u6709\u7528\u7684\u9884\u53d6\u8bf7\u6c42\u4e2d\u6709\u591a\u5c11\u662f\u201c\u8fdf\u5230\u201d\u7684\uff0c\u5373\u5728\u7a0b\u5e8f\u771f\u6b63\u9700\u8981\u6570\u636e\u65f6\uff0c\u6570\u636e\u5c1a\u672a\u4ece\u5185\u5b58\u8fd4\u56de\u3002\u8ba1\u7b97\u516c\u5f0f\u4e3a <code>\u8fdf\u5230\u7684\u6709\u7528\u9884\u53d6\u6570 / \u6709\u7528\u9884\u53d6\u6570</code>\u3002\u9ad8\u5ef6\u8fdf\u4f1a\u524a\u5f31\u751a\u81f3\u62b5\u6d88\u9884\u53d6\u5e26\u6765\u7684\u6027\u80fd\u589e\u76ca\u3002</li> <li>Prefetcher-Generated Cache Pollution (\u9884\u53d6\u5668\u5f15\u53d1\u7684\u7f13\u5b58\u6c61\u67d3): \u8861\u91cf\u7531\u9884\u53d6\u64cd\u4f5c\u76f4\u63a5\u5bfc\u81f4\u7684\u989d\u5916\u9700\u6c42\u7f3a\u5931\uff08Demand Misses\uff09\u7684\u6bd4\u4f8b\u3002\u9ad8\u6c61\u67d3\u610f\u5473\u7740\u9884\u53d6\u7684\u6570\u636e\u6324\u5360\u4e86\u672a\u6765\u4f1a\u88ab\u4f7f\u7528\u7684\u6709\u6548\u6570\u636e\uff0c\u53cd\u800c\u589e\u52a0\u4e86\u603b\u7f3a\u5931\u7387\u548c\u5e26\u5bbd\u6d88\u8017\u3002</li> </ul> </li> <li> <p>\u53cd\u9988\u4fe1\u606f\u7684\u786c\u4ef6\u5b9e\u73b0</p> <ul> <li>\u51c6\u786e\u7387\u8ffd\u8e2a: \u5728L2\u7f13\u5b58\u7684\u6bcf\u4e2atag\u6761\u76ee\u4e2d\u589e\u52a0\u4e00\u4e2a pref-bit\u3002\u5f53\u9884\u53d6\u5757\u88ab\u63d2\u5165\u7f13\u5b58\u65f6\uff0c\u8be5\u4f4d\u88ab\u7f6e\u4f4d\uff1b\u5f53\u8be5\u5757\u88ab\u9700\u6c42\u8bbf\u95ee\uff08useful\uff09\u65f6\uff0c\u8be5\u4f4d\u88ab\u6e05\u9664\uff0c\u5e76\u7d2f\u52a0 used-total \u8ba1\u6570\u5668\u3002\u540c\u65f6\uff0c\u6bcf\u6b21\u53d1\u9001\u9884\u53d6\u8bf7\u6c42\u90fd\u4f1a\u7d2f\u52a0 pref-total \u8ba1\u6570\u5668\u3002</li> <li>\u53ca\u65f6\u6027\u8ffd\u8e2a: \u5229\u7528 MSHR (Miss Status Holding Register) \u7ed3\u6784\u3002MSHR\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u4e5f\u5305\u542b\u4e00\u4e2a pref-bit\u3002\u5f53\u4e00\u4e2a\u9700\u6c42\u8bf7\u6c42\u547d\u4e2d\u4e86\u4e00\u4e2apref-bit\u88ab\u7f6e\u4f4d\u7684MSHR\u6761\u76ee\u65f6\uff0c\u8bf4\u660e\u8be5\u9884\u53d6\u8bf7\u6c42\u8fd8\u672a\u5b8c\u6210\uff0c\u5373\u4e3a\u201c\u8fdf\u5230\u201d\uff0c\u6b64\u65f6\u7d2f\u52a0 late-total \u8ba1\u6570\u5668\u3002</li> <li>\u7f13\u5b58\u6c61\u67d3\u8ffd\u8e2a: \u91c7\u7528\u57fa\u4e8e Bloom filter \u6982\u5ff5\u7684\u4f4e\u6210\u672c\u786c\u4ef6\u7ed3\u6784\uff08\u79f0\u4e3a\u6c61\u67d3\u8fc7\u6ee4\u5668\uff09\u3002\u8be5\u8fc7\u6ee4\u5668\u662f\u4e00\u4e2a\u4f4d\u5411\u91cf\u3002<ul> <li>\u5f53\u4e00\u4e2a\u56e0\u9700\u6c42\u7f3a\u5931\u800c\u52a0\u8f7d\u7684\u5757\u88ab\u9884\u53d6\u8bf7\u6c42\u9a71\u9010\u51fa\u7f13\u5b58\u65f6\uff0c\u5728\u8fc7\u6ee4\u5668\u4e2d\u5bf9\u5e94\u5730\u5740\u7684\u4f4d\u7f6e1\u3002</li> <li>\u5f53\u4e00\u4e2a\u9884\u53d6\u8bf7\u6c42\u5b8c\u6210\u5e76\u63d2\u5165\u7f13\u5b58\u65f6\uff0c\u5728\u8fc7\u6ee4\u5668\u4e2d\u5bf9\u5e94\u5730\u5740\u7684\u4f4d\u7f6e0\u3002</li> <li>\u5f53\u53d1\u751f\u4e00\u4e2a\u65b0\u7684\u9700\u6c42\u7f3a\u5931\u65f6\uff0c\u67e5\u8be2\u8fc7\u6ee4\u5668\u3002\u5982\u679c\u5bf9\u5e94\u4f4d\u4e3a1\uff0c\u5219\u8ba4\u4e3a\u6b64\u6b21\u7f3a\u5931\u662f\u7531\u9884\u53d6\u5668\u9020\u6210\u7684\uff0c\u5e76\u7d2f\u52a0 pollution-total \u8ba1\u6570\u5668\u3002</li> </ul> </li> </ul> </li> <li> <p>\u91c7\u6837\u4e0e\u66f4\u65b0\u7b56\u7565</p> <ul> <li>\u4e3a\u4e86\u907f\u514d\u5bf9\u77ac\u65f6\u566a\u58f0\u8fc7\u5ea6\u53cd\u5e94\uff0c\u7cfb\u7edf\u91c7\u7528\u57fa\u4e8e\u91c7\u6837\u7684\u533a\u95f4\u66f4\u65b0\u7b56\u7565\u3002</li> <li>\u4e00\u4e2a\u91c7\u6837\u533a\u95f4\u7684\u957f\u5ea6\u7531L2\u7f13\u5b58\u7684\u9a71\u9010\u4e8b\u4ef6\u6570\u91cf\u5b9a\u4e49\uff08\u5b9e\u9a8c\u4e2d\u9608\u503c Tinterval=8192\uff09\u3002</li> <li>\u5728\u6bcf\u4e2a\u533a\u95f4\u7ed3\u675f\u65f6\uff0c\u4f7f\u7528\u6307\u6570\u79fb\u52a8\u5e73\u5747\uff08\u5982 <code>CounterValue = \u03b1 * CounterValueDuringInterval + (1-\u03b1) * CounterValue</code>\uff09\u6765\u5e73\u6ed1\u5386\u53f2\u6570\u636e\uff0c\u5e76\u636e\u6b64\u8ba1\u7b97\u6700\u65b0\u7684\u4e09\u4e2a\u6307\u6807\u503c\u3002</li> <li>\u8fd9\u4e9b\u66f4\u65b0\u540e\u7684\u6307\u6807\u503c\u5c06\u7528\u4e8e\u51b3\u5b9a\u4e0b\u4e00\u4e2a\u533a\u95f4\u7684\u9884\u53d6\u5668\u884c\u4e3a\u3002</li> </ul> </li> <li> <p>\u8f93\u51fa\uff1a\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u6fc0\u8fdb\u5ea6</p> <ul> <li>\u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u5ea6\u7531\u4e24\u4e2a\u5173\u952e\u53c2\u6570\u63a7\u5236\uff1aPrefetch Distance\uff08\u9884\u53d6\u8ddd\u79bb\uff0c\u51b3\u5b9a\u9884\u53d6\u591a\u8fdc\uff09\u548c Prefetch Degree\uff08\u9884\u53d6\u5ea6\uff0c\u51b3\u5b9a\u4e00\u6b21\u9884\u53d6\u591a\u5c11\u5757\uff09\u3002</li> <li>\u7cfb\u7edf\u7ef4\u62a4\u4e00\u4e2a3\u4f4d\u7684Dynamic Configuration Counter (\u52a8\u6001\u914d\u7f6e\u8ba1\u6570\u5668)\uff0c\u5176\u503c\uff081-5\uff09\u5bf9\u5e94\u4e94\u79cd\u9884\u8bbe\u7684\u6fc0\u8fdb\u5ea6\u914d\u7f6e\uff0c\u4ece Very Conservative \u5230 Very Aggressive\u3002</li> <li>\u5728\u6bcf\u4e2a\u91c7\u6837\u533a\u95f4\u7ed3\u675f\u65f6\uff0c\u6839\u636e\u4e09\u4e2a\u6307\u6807\u4e0e\u9884\u8bbe\u9608\u503c\uff08Ahigh, Alow, Tlateness, Tpollution\uff09\u7684\u6bd4\u8f83\u7ed3\u679c\uff0c\u67e5\u8868\uff08Table 2\uff09\u51b3\u5b9a\u5982\u4f55\u66f4\u65b0\u8be5\u8ba1\u6570\u5668\u3002<ul> <li>\u4f8b\u5982\uff0c\u5982\u679c\u68c0\u6d4b\u5230\u9ad8\u6c61\u67d3\uff0c\u901a\u5e38\u4f1a\u964d\u4f4e\u6fc0\u8fdb\u5ea6\u4ee5\u51cf\u5c11\u5e26\u5bbd\u6d6a\u8d39\u548c\u7f13\u5b58\u5e72\u6270\u3002</li> <li>\u5982\u679c\u68c0\u6d4b\u5230\u4f4e\u51c6\u786e\u7387\u4f46\u9ad8\u5ef6\u8fdf\uff0c\u53ef\u80fd\u4f1a\u964d\u4f4e\u6fc0\u8fdb\u5ea6\uff0c\u56e0\u4e3a\u76f2\u76ee\u63d0\u524d\u9884\u53d6\u53ea\u4f1a\u5e26\u6765\u66f4\u591a\u65e0\u7528\u6d41\u91cf\u3002</li> <li>\u5982\u679c\u68c0\u6d4b\u5230\u4f4e\u6c61\u67d3\u3001\u4f4e\u5ef6\u8fdf\u4f46\u9ad8\u51c6\u786e\u7387\uff0c\u5219\u7ef4\u6301\u5f53\u524d\u6fc0\u8fdb\u5ea6\uff0c\u56e0\u4e3a\u6b64\u65f6\u9884\u53d6\u6548\u679c\u6700\u4f73\u3002</li> </ul> </li> </ul> </li> </ul> <p></p> <ul> <li>\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528<ul> <li>\u8be5\u673a\u5236\u5145\u5f53\u4e86\u4e00\u4e2a\u81ea\u9002\u5e94\u7684\u8d1f\u53cd\u9988\u63a7\u5236\u5668\uff0c\u89e3\u51b3\u4e86\u4f20\u7edf\u56fa\u5b9a\u6fc0\u8fdb\u5ea6\u9884\u53d6\u5668\u7684\u6839\u672c\u7f3a\u9677\uff1a\u65e0\u6cd5\u9002\u5e94\u4e0d\u540c\u7a0b\u5e8f\u6216\u540c\u4e00\u7a0b\u5e8f\u4e0d\u540c\u6267\u884c\u9636\u6bb5\u7684\u5185\u5b58\u8bbf\u95ee\u7279\u6027\u3002</li> <li>\u5b83\u6210\u529f\u5730\u5c06\u9884\u53d6\u5668\u4ece\u4e00\u4e2a\u53ef\u80fd\u5e26\u6765\u5de8\u5927\u6027\u80fd\u635f\u5931\u7684\u201c\u53cc\u5203\u5251\u201d\uff0c\u8f6c\u53d8\u4e3a\u4e00\u4e2a\u7a33\u5b9a\u3001\u9ad8\u6548\u4e14\u5e26\u5bbd\u53cb\u597d\u7684\u6027\u80fd\u63d0\u5347\u5de5\u5177\u3002</li> <li>\u5b9e\u9a8c\u7ed3\u679c\u8868\u660e\uff0c\u8be5\u673a\u5236\u80fd\u5b8c\u5168\u6d88\u9664\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u5668\u5728\u67d0\u4e9b\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 ammp, applu\uff09\u4e0a\u9020\u6210\u7684\u4e25\u91cd\u6027\u80fd\u4e0b\u964d\uff0c\u540c\u65f6\u5728\u5176\u4ed6\u53d7\u76ca\u4e8e\u9884\u53d6\u7684\u7a0b\u5e8f\u4e0a\u4fdd\u6301\u751a\u81f3\u8d85\u8d8a\u5176\u6027\u80fd\uff0c\u5e76\u663e\u8457\u964d\u4f4e\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\uff08\u5e73\u5747\u51cf\u5c1118.7%\uff09\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#2_1","title":"2. \u57fa\u4e8e\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u9884\u53d6\u7f13\u5b58\u6c61\u67d3\u4f30\u7b97","text":"<p>\u5b9e\u73b0\u539f\u7406\u4e0e\u6838\u5fc3\u601d\u60f3</p> <ul> <li>\u8be5\u673a\u5236\u7684\u6838\u5fc3\u6311\u6218\u5728\u4e8e\uff0c\u7cbe\u786e\u8ffd\u8e2a\u6240\u6709\u56e0\u9884\u53d6\u800c\u88ab\u9a71\u9010\u7684 demand-fetched L2 cache blocks \u5728\u786c\u4ef6\u4e0a\u662f\u4e0d\u5207\u5b9e\u9645\u7684\uff0c\u56e0\u4e3a\u8fd9\u9700\u8981\u4e3a\u6bcf\u4e2a\u88ab\u9a71\u9010\u5757\u7ef4\u62a4\u5386\u53f2\u8bb0\u5f55\uff0c\u5f00\u9500\u5de8\u5927\u3002</li> <li>\u8bba\u6587\u63d0\u51fa\u4e86\u4e00\u79cd\u57fa\u4e8e Bloom filter \u6982\u5ff5\u7684\u4f4e\u6210\u672c\u8fd1\u4f3c\u65b9\u6848\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\uff1a\u7528\u4e00\u4e2a\u5171\u4eab\u7684 bit-vector\uff08\u5373\u5e03\u9686\u8fc7\u6ee4\u5668\uff09\u6765\u201c\u6807\u8bb0\u201d\u90a3\u4e9b\u53ef\u80fd\u56e0\u9884\u53d6\u800c\u88ab\u9a71\u9010\u7684\u5757\u7684\u5730\u5740\u3002</li> <li>\u8fd9\u662f\u4e00\u79cd\u6709\u635f\u4f46\u9ad8\u6548\u7684\u4f30\u7b97\u65b9\u6cd5\uff0c\u5b83\u727a\u7272\u4e86\u7cbe\u786e\u6027\uff08\u5b58\u5728\u5047\u9633\u6027\uff09\uff0c\u6362\u53d6\u4e86\u6781\u4f4e\u7684\u786c\u4ef6\u5b58\u50a8\u6210\u672c\uff08\u8bba\u6587\u4e2d\u4ec5\u4f7f\u7528 4096-entry bit vector\uff09\u3002</li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u72b6\u6001\u673a</p> <ul> <li>\u521d\u59cb\u5316: \u6c61\u67d3\u8fc7\u6ee4\u5668\uff08Pollution Filter\uff09\u662f\u4e00\u4e2a\u5168\u96f6\u7684\u4f4d\u5411\u91cf\u3002</li> <li>\u4e8b\u4ef61: \u9700\u6c42\u5757\u88ab\u9884\u53d6\u9a71\u9010 (Demand Block Evicted by Prefetch):<ul> <li>\u5f53\u4e00\u4e2a\u56e0 demand miss \u800c\u52a0\u8f7d\u8fdbL2\u7f13\u5b58\u7684\u5757\uff0c\u88ab\u4e00\u4e2a prefetch request \u9a71\u9010\u51fa\u7f13\u5b58\u65f6\uff0c\u7cfb\u7edf\u4f1a\u83b7\u53d6\u8be5\u88ab\u9a71\u9010\u5757\u7684\u5730\u5740\u3002</li> <li>\u4f7f\u7528\u8be5\u5730\u5740\uff08\u901a\u8fc7 <code>lower_bits XOR higher_bits</code> \u7684\u54c8\u5e0c\u51fd\u6570\uff09\u7d22\u5f15\u5230\u8fc7\u6ee4\u5668\u7684\u7279\u5b9a\u4f4d\uff0c\u5e76\u5c06\u8be5\u4f4d\u7f6e\u4e3a1\u3002\u8fd9\u8868\u793a\u201c\u6b64\u5730\u5740\u5bf9\u5e94\u7684\u5757\u53ef\u80fd\u5df2\u88ab\u9884\u53d6\u6c61\u67d3\u201d\u3002</li> </ul> </li> <li>\u4e8b\u4ef62: \u9884\u53d6\u5757\u88ab\u52a0\u8f7d (Prefetch Block Inserted):<ul> <li>\u5f53\u4e00\u4e2a prefetch request \u4ece\u5185\u5b58\u8fd4\u56de\u5e76\u88ab\u63d2\u5165L2\u7f13\u5b58\u65f6\uff0c\u7cfb\u7edf\u4f1a\u83b7\u53d6\u8be5\u9884\u53d6\u5757\u7684\u5730\u5740\u3002</li> <li>\u540c\u6837\u901a\u8fc7\u54c8\u5e0c\u51fd\u6570\u7d22\u5f15\u5230\u8fc7\u6ee4\u5668\uff0c\u5e76\u5c06\u5bf9\u5e94\u4f4d\u91cd\u7f6e\u4e3a0\u3002\u8fd9\u662f\u4e00\u4e2a\u5173\u952e\u7684\u201c\u6e05\u7406\u201d\u6b65\u9aa4\uff0c\u7528\u4e8e\u9632\u6b62\u8fc7\u6ee4\u5668\u9971\u548c\u548c\u5047\u9633\u6027\u7387\u8fc7\u9ad8\u3002\u5176\u903b\u8f91\u662f\uff1a\u5982\u679c\u4e00\u4e2a\u9884\u53d6\u5757\u6210\u529f\u8fdb\u5165\u7f13\u5b58\uff0c\u90a3\u4e48\u5b83\u5c31\u4e0d\u518d\u662f\u201c\u88ab\u9a71\u9010\u7684\u9700\u6c42\u5757\u201d\uff0c\u5e94\u8be5\u6e05\u9664\u4e4b\u524d\u7684\u6f5c\u5728\u6807\u8bb0\u3002</li> </ul> </li> <li>\u4e8b\u4ef63: \u9700\u6c42\u672a\u547d\u4e2d\u53d1\u751f (Demand Miss Occurs):<ul> <li>\u5f53\u4e00\u4e2a demand access \u5728L2\u7f13\u5b58\u4e2d\u672a\u547d\u4e2d\u65f6\uff0c\u7cfb\u7edf\u4f1a\u68c0\u67e5\u6c61\u67d3\u8fc7\u6ee4\u5668\u3002</li> <li>\u4f7f\u7528\u8be5\u9700\u6c42\u672a\u547d\u4e2d\u5730\u5740\u901a\u8fc7\u76f8\u540c\u7684\u54c8\u5e0c\u51fd\u6570\u7d22\u5f15\u8fc7\u6ee4\u5668\u3002</li> <li>\u5982\u679c\u5bf9\u5e94\u4f4d\u4e3a1\uff0c\u5219\u8ba4\u4e3a\u8fd9\u6b21 demand miss \u5f88\u53ef\u80fd\u662f\u7531\u9884\u53d6\u5668\u9020\u6210\u7684\uff08\u5373 prefetcher-caused demand miss\uff09\uff0c\u5e76\u5c06 pollution-total \u8ba1\u6570\u5668\u52a0\u4e00\u3002</li> <li>\u5982\u679c\u5bf9\u5e94\u4f4d\u4e3a0\uff0c\u5219\u8ba4\u4e3a\u8fd9\u6b21\u672a\u547d\u4e2d\u4e0e\u9884\u53d6\u65e0\u5173\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 3. IPC performance (left) and prefetch lateness (right) with different aggressiveness configurations Figure 4. Filter to estimate prefetcher-generated cache pollution</p> <p>\u8f93\u5165\u3001\u8f93\u51fa\u4e0e\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165:<ul> <li>L2\u7f13\u5b58\u7684\u9a71\u9010\u4e8b\u4ef6\uff08\u7279\u522b\u662f\u7531\u9884\u53d6\u8bf7\u6c42\u89e6\u53d1\u7684\u9a71\u9010\uff09\u3002</li> <li>L2\u7f13\u5b58\u7684\u63d2\u5165\u4e8b\u4ef6\uff08\u7279\u522b\u662f\u9884\u53d6\u5757\u7684\u63d2\u5165\uff09\u3002</li> <li>L2\u7f13\u5b58\u7684\u9700\u6c42\u672a\u547d\u4e2d\u4e8b\u4ef6\u3002</li> </ul> </li> <li>\u8f93\u51fa:<ul> <li>\u4e00\u4e2a\u786c\u4ef6\u8ba1\u6570\u5668 pollution-total\uff0c\u7528\u4e8e\u7edf\u8ba1\u4f30\u7b97\u51fa\u7684 prefetcher-caused demand misses \u6570\u91cf\u3002</li> <li>\u7ed3\u5408\u53e6\u4e00\u4e2a\u8ba1\u6570\u5668 demand-total\uff08\u603b\u9700\u6c42\u672a\u547d\u4e2d\u6570\uff09\uff0c\u53ef\u4ee5\u8ba1\u7b97\u51fa Prefetcher-Generated Cache Pollution \u6307\u6807\uff1a<code>pollution-total / demand-total</code>\u3002</li> </ul> </li> <li>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528:<ul> <li>\u8fd9\u4e2a\u4f30\u7b97\u51fa\u7684 cache pollution \u6307\u6807\u662f Feedback Directed Prefetching (FDP) \u673a\u5236\u7684\u5173\u952e\u53cd\u9988\u4fe1\u53f7\u4e4b\u4e00\u3002</li> <li>\u5b83\u76f4\u63a5\u9a71\u52a8\u4e24\u4e2a\u6838\u5fc3\u51b3\u7b56\uff1a<ol> <li>\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u6fc0\u8fdb\u7a0b\u5ea6 (Dynamic Aggressiveness): \u5982\u88682\u6240\u793a\uff0c\u5f53\u68c0\u6d4b\u5230\u9ad8\u6c61\u67d3\u65f6\uff0c\u7cfb\u7edf\u4f1a\u503e\u5411\u4e8e\u964d\u4f4e\u9884\u53d6\u5668\u7684\u6fc0\u8fdb\u7a0b\u5ea6\uff08\u51cf\u5c11Prefetch Distance\u548cDegree\uff09\uff0c\u4ee5\u51cf\u8f7b\u5bf9\u7f13\u5b58\u7684\u5e72\u6270\u3002</li> <li>\u52a8\u6001\u8c03\u6574\u9884\u53d6\u5757\u63d2\u5165\u7b56\u7565 (Dynamic Insertion Policy): \u59823.3.2\u8282\u6240\u8ff0\uff0c\u6839\u636e\u6c61\u67d3\u7a0b\u5ea6\u7684\u9ad8\u4f4e\uff0c\u7cfb\u7edf\u4f1a\u51b3\u5b9a\u5c06\u65b0\u9884\u53d6\u7684\u5757\u63d2\u5165\u5230LRU\u6808\u7684\u4e0d\u540c\u4f4d\u7f6e\uff08MRU, MID, LRU-4, \u6216 LRU\uff09\uff0c\u9ad8\u6c61\u67d3\u65f6\u63d2\u5165\u66f4\u9760\u8fd1LRU\u7684\u4f4d\u7f6e\uff0c\u4f7f\u5176\u66f4\u5feb\u88ab\u9a71\u9010\uff0c\u4ece\u800c\u51cf\u5c11\u5bf9\u6709\u7528\u6570\u636e\u7684\u6324\u5360\u3002</li> </ol> </li> </ul> </li> </ul> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u8bbe\u8ba1\u8003\u91cf</p> <ul> <li>\u8fc7\u6ee4\u5668\u5927\u5c0f: \u8bba\u6587\u4e2d\u4f7f\u7528\u4e86 4096-entry \u7684\u4f4d\u5411\u91cf\u3002\u8fd9\u662f\u4e00\u4e2a\u5728\u786c\u4ef6\u5f00\u9500\u548c\u4f30\u7b97\u7cbe\u5ea6\u4e4b\u95f4\u7684\u6743\u8861\u3002\u66f4\u5927\u7684\u8fc7\u6ee4\u5668\u53ef\u4ee5\u964d\u4f4e\u5047\u9633\u6027\u7387\uff0c\u4f46\u4f1a\u589e\u52a0\u9762\u79ef\uff1b\u66f4\u5c0f\u7684\u5219\u76f8\u53cd\u3002</li> <li>\u54c8\u5e0c\u51fd\u6570: \u91c7\u7528\u4e86\u7b80\u5355\u7684 <code>lower_bits XOR higher_bits</code> \u65b9\u5f0f\uff0c\u8fd9\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684\u54c8\u5e0c\u65b9\u6cd5\uff0c\u6613\u4e8e\u786c\u4ef6\u5b9e\u73b0\uff0c\u80fd\u6709\u6548\u5206\u6563\u5730\u5740\u7a7a\u95f4\uff0c\u907f\u514d\u5c40\u90e8\u51b2\u7a81\u3002</li> <li>\u201c\u63d2\u5165\u65f6\u6e05\u96f6\u201d\u7b56\u7565: \u8fd9\u662f\u8be5\u8bbe\u8ba1\u7684\u4e00\u4e2a\u7cbe\u5999\u4e4b\u5904\u3002\u5b83\u4e0d\u4ec5\u9632\u6b62\u4e86\u8fc7\u6ee4\u5668\u88ab\u957f\u671f\u5360\u7528\u800c\u5931\u6548\uff0c\u8fd8\u9690\u542b\u5730\u6a21\u62df\u4e86\u7f13\u5b58\u7684\u65f6\u95f4\u5c40\u90e8\u6027\u2014\u2014\u4e00\u4e2a\u5f88\u4e45\u4ee5\u524d\u88ab\u9a71\u9010\u7684\u5757\uff0c\u5176\u6807\u8bb0\u88ab\u540e\u7eed\u63d2\u5165\u7684\u9884\u53d6\u5757\u8986\u76d6\u662f\u5408\u7406\u7684\u3002</li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#3_1","title":"3. \u57fa\u4e8e\u6c61\u67d3\u611f\u77e5\u7684\u52a8\u6001\u7f13\u5b58\u63d2\u5165\u7b56\u7565","text":"<p>\u6838\u5fc3\u673a\u5236\u4e0e\u5b9e\u73b0\u539f\u7406</p> <ul> <li>\u8be5\u7b56\u7565\u7684\u6838\u5fc3\u601d\u60f3\u662f\uff0c\u9884\u53d6\u5757\u7684\u7f13\u5b58\u4ef7\u503c\u4e0e\u5176\u9020\u6210\u7684\u6c61\u67d3\u6210\u53cd\u6bd4\u3002\u5f53\u9884\u53d6\u5668\u51c6\u786e\u6027\u9ad8\u3001\u6c61\u67d3\u4f4e\u65f6\uff0c\u5e94\u8ba9\u9884\u53d6\u5757\u5728\u7f13\u5b58\u4e2d\u5b58\u6d3b\u66f4\u4e45\uff08\u63d2\u5165\u9760\u8fd1MRU\u7684\u4f4d\u7f6e\uff09\uff1b\u53cd\u4e4b\uff0c\u5f53\u6c61\u67d3\u4e25\u91cd\u65f6\uff0c\u5e94\u8ba9\u5176\u5feb\u901f\u88ab\u6dd8\u6c70\uff08\u63d2\u5165\u9760\u8fd1LRU\u7684\u4f4d\u7f6e\uff09\u3002</li> <li>\u5177\u4f53\u5b9e\u73b0\u4f9d\u8d56\u4e8e\u4e00\u4e2a\u52a8\u6001\u51b3\u7b56\u6a21\u5757\uff0c\u8be5\u6a21\u5757\u5728\u6bcf\u4e2a\u91c7\u6837\u95f4\u9694 (sampling interval) \u7ed3\u675f\u65f6\uff0c\u6839\u636e\u4f30\u7b97\u51fa\u7684 Prefetcher-Generated Cache Pollution \u6307\u6807\u6765\u51b3\u5b9a\u4e0b\u4e00\u4e2a\u95f4\u9694\u5185\u6240\u6709\u9884\u53d6\u5757\u7684\u63d2\u5165\u4f4d\u7f6e\u3002</li> <li>\u63d2\u5165\u4f4d\u7f6e\u5e76\u975e\u968f\u610f\u9009\u62e9\uff0c\u800c\u662f\u5b9a\u4e49\u4e86\u4e09\u4e2a\u79bb\u6563\u7684\u3001\u4e0e\u7f13\u5b58set-associativity (n) \u76f8\u5173\u7684\u56fa\u5b9a\u4f4d\u7f6e\uff1a<ul> <li>MID (Middle) \u4f4d\u7f6e: \u5b9a\u4e49\u4e3a LRU \u6808\u4e2d\u7b2c <code>floor(n/2)</code> \u4e2a\u6700\u4e0d\u5e38\u4f7f\u7528\u7684\u4f4d\u7f6e\u3002\u8fd9\u662f\u4e00\u4e2a\u6298\u4e2d\u7b56\u7565\uff0c\u65e2\u975e\u6700\u70ed\u4e5f\u975e\u6700\u51b7\u3002</li> <li>LRU-4 \u4f4d\u7f6e: \u5b9a\u4e49\u4e3a LRU \u6808\u4e2d\u7b2c <code>floor(n/4)</code> \u4e2a\u6700\u4e0d\u5e38\u4f7f\u7528\u7684\u4f4d\u7f6e\u3002\u6bd4 MID \u66f4\u9760\u8fd1\u6dd8\u6c70\u7aef\uff0c\u751f\u5b58\u65f6\u95f4\u66f4\u77ed\u3002</li> <li>LRU (Least Recently Used) \u4f4d\u7f6e: \u76f4\u63a5\u63d2\u5165\u5230\u5373\u5c06\u88ab\u6dd8\u6c70\u7684\u4f4d\u7f6e\uff0c\u751f\u5b58\u65f6\u95f4\u6700\u77ed\u3002</li> </ul> </li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u8f93\u5165\u8f93\u51fa</p> <ul> <li>\u8f93\u5165: \u7b97\u6cd5\u7684\u4e3b\u8981\u8f93\u5165\u662f Prefetcher-Generated Cache Pollution \u7684\u4f30\u7b97\u503c\u3002\u8be5\u503c\u901a\u8fc7\u4e00\u4e2a\u57fa\u4e8e Bloom filter \u6982\u5ff5\u7684\u786c\u4ef6\u7ed3\u6784\uff08\u6587\u4e2d\u79f0\u4e3a pollution filter\uff09\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u8ffd\u8e2a\u548c\u8ba1\u7b97\u5f97\u51fa\u3002<ul> <li>\u8be5 filter \u901a\u8fc7\u8ddf\u8e2a\u56e0\u9884\u53d6\u800c\u88ab\u9a71\u9010\u7684\u9700\u6c42\u5757 (demand-fetched blocks) \u6765\u95f4\u63a5\u4f30\u7b97\u6c61\u67d3\u3002</li> <li>\u5728\u6bcf\u4e2a\u91c7\u6837\u95f4\u9694\u7ed3\u675f\u65f6\uff0c\u4f1a\u8ba1\u7b97\u51fa\u4e00\u4e2a\u6c61\u67d3\u6bd4\u7387\uff1a<code>pollution-total / demand-total</code>\u3002</li> </ul> </li> <li>\u51b3\u7b56\u903b\u8f91: \u5c06\u8ba1\u7b97\u51fa\u7684\u6c61\u67d3\u6bd4\u7387\u4e0e\u4e24\u4e2a\u9759\u6001\u9608\u503c Plow \u548c Phigh \u8fdb\u884c\u6bd4\u8f83\uff0c\u8fdb\u884c\u4e09\u5206\u7c7b\uff1a<ul> <li>\u4f4e\u6c61\u67d3 (Low): \u6c61\u67d3\u6bd4\u7387 &lt; Plow \u2192 \u4e0b\u4e00\u95f4\u9694\u63d2\u5165 MID \u4f4d\u7f6e\u3002</li> <li>\u4e2d\u7b49\u6c61\u67d3 (Medium): Plow \u2264 \u6c61\u67d3\u6bd4\u7387 &lt; Phigh \u2192 \u4e0b\u4e00\u95f4\u9694\u63d2\u5165 LRU-4 \u4f4d\u7f6e\u3002</li> <li>\u9ad8\u6c61\u67d3 (High): \u6c61\u67d3\u6bd4\u7387 \u2265 Phigh \u2192 \u4e0b\u4e00\u95f4\u9694\u63d2\u5165 LRU \u4f4d\u7f6e\u3002</li> </ul> </li> <li>\u8f93\u51fa: \u51b3\u7b56\u7ed3\u679c\u662f\u4e00\u4e2a\u63d2\u5165\u4f4d\u7f6e\u6307\u9488\uff0c\u8be5\u6307\u9488\u88ab\u7f13\u5b58\u63a7\u5236\u5668\u7528\u4e8e\u6307\u5bfc\u6240\u6709\u9884\u53d6\u8bf7\u6c42\u7684\u7f13\u5b58\u586b\u5145\u64cd\u4f5c\u3002</li> <li>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528: \u6b64\u7b56\u7565\u4e0e \u52a8\u6001\u8c03\u6574\u9884\u53d6\u5668\u6fc0\u8fdb\u7a0b\u5ea6 (Dynamic Aggressiveness) \u673a\u5236\u76f8\u8f85\u76f8\u6210\u3002\u540e\u8005\u63a7\u5236\u201c\u9884\u53d6\u591a\u5c11\u201d\uff0c\u524d\u8005\u63a7\u5236\u201c\u9884\u53d6\u7684\u6570\u636e\u5728\u7f13\u5b58\u91cc\u5f85\u591a\u4e45\u201d\u3002\u4e24\u8005\u5171\u540c\u6784\u6210\u4e86 Feedback Directed Prefetching (FDP) \u7684\u5b8c\u6574\u95ed\u73af\u53cd\u9988\u7cfb\u7edf\uff0c\u65e8\u5728\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\u7684\u540c\u65f6\u6700\u5c0f\u5316\u5e26\u5bbd\u5f00\u9500\u548c\u7f13\u5b58\u6c61\u67d3\u3002</li> </ul> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u5b9e\u9a8c\u6548\u679c</p> <ul> <li>\u6587\u4e2d\u4f7f\u7528\u7684\u5177\u4f53\u9608\u503c\uff08\u6765\u81ea Section 4.3\uff09\u4e3a\uff1aPlow = 0.1, Phigh = 0.2\u3002</li> <li>\u5b9e\u9a8c\u7ed3\u679c\u8868\u660e\uff0c\u9759\u6001\u63d2\u5165\u7b56\u7565\u5404\u6709\u7f3a\u9677\uff1a<ul> <li>\u59cb\u7ec8\u63d2\u5165 MRU \u4f1a\u5bfc\u81f4\u9ad8\u6c61\u67d3\u573a\u666f\u4e0b\u6027\u80fd\u4e25\u91cd\u4e0b\u964d\u3002</li> <li>\u59cb\u7ec8\u63d2\u5165 LRU \u867d\u80fd\u907f\u514d\u6c61\u67d3\uff0c\u4f46\u4f1a\u4f7f\u6709\u7528\u7684\u9884\u53d6\u6570\u636e\u8fc7\u65e9\u88ab\u6dd8\u6c70\uff0c\u635f\u5931\u6027\u80fd\u3002</li> </ul> </li> <li>\u52a8\u6001\u7b56\u7565\u6210\u529f\u5730\u4e3a\u4e0d\u540c\u57fa\u51c6\u6d4b\u8bd5\u9009\u62e9\u4e86\u6700\u4f18\u6216\u63a5\u8fd1\u6700\u4f18\u7684\u9759\u6001\u7b56\u7565\u3002\u4f8b\u5982\uff0c\u5728 <code>applu</code> \u548c <code>ammp</code> \u7b49\u9ad8\u6c61\u67d3\u57fa\u51c6\u4e0a\uff0c\u52a8\u6001\u7b56\u7565\u5927\u90e8\u5206\u65f6\u95f4\u9009\u62e9 LRU \u63d2\u5165\uff1b\u800c\u5728 <code>wupwise</code> \u7b49\u4f4e\u6c61\u67d3\u57fa\u51c6\u4e0a\uff0c\u5219\u66f4\u591a\u5730\u4f7f\u7528 MID \u6216\u66f4\u9760\u524d\u7684\u4f4d\u7f6e\u3002</li> <li></li> </ul> <p></p> <p>Figure 8. Distribution of the insertion position of prefetched blocks</p> <ul> <li>\u6027\u80fd\u5bf9\u6bd4\u6570\u636e\u663e\u793a\uff0cDynamic Insertion \u7b56\u7565\u76f8\u6bd4\u6700\u4f73\u9759\u6001\u7b56\u7565\uff08LRU-4\uff09\u8fd8\u80fd\u518d\u63d0\u5347 1.9% \u7684\u6027\u80fd\uff0c\u5145\u5206\u8bc1\u660e\u4e86\u5176\u6709\u6548\u6027\u3002</li> </ul> <p>\u5173\u952e\u6570\u636e\u5bf9\u6bd4</p> <p>\u4e0b\u8868\u603b\u7ed3\u4e86\u4e0d\u540c\u7f13\u5b58\u63d2\u5165\u7b56\u7565\u5728 Very Aggressive \u9884\u53d6\u5668\u914d\u7f6e\u4e0b\u7684\u5e73\u5747\u6027\u80fd\u8868\u73b0\uff08\u4ee5 IPC \u4e3a\u6307\u6807\uff0cMRU \u7b56\u7565\u4e3a\u57fa\u51c6 1.0\uff09\uff1a</p> \u63d2\u5165\u7b56\u7565 \u76f8\u5bf9 IPC (vs. MRU) \u7279\u70b9 MRU 1.000 \u57fa\u51c6\uff0c\u9ad8\u6536\u76ca\u9ad8\u98ce\u9669 MID ~1.015 \u6298\u4e2d\u7b56\u7565 LRU-4 1.032 \u6700\u4f73\u9759\u6001\u7b56\u7565 LRU ~0.950 \u907f\u514d\u6c61\u67d3\uff0c\u4f46\u727a\u7272\u6536\u76ca Dynamic Insertion 1.051 \u6700\u4f18\uff0c\u81ea\u9002\u5e94\u5e73\u8861"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#4","title":"4. \u57fa\u4e8e\u91c7\u6837\u7684\u8fd0\u884c\u65f6\u53cd\u9988\u6536\u96c6\u673a\u5236","text":"<p>\u6838\u5fc3\u673a\u5236\uff1a\u57fa\u4e8e\u91c7\u6837\u7684\u8fd0\u884c\u65f6\u53cd\u9988\u6536\u96c6</p> <p>\u8be5\u673a\u5236\u7684\u6838\u5fc3\u601d\u60f3\u662f\u5c06\u7a0b\u5e8f\u6267\u884c\u5212\u5206\u4e3a\u52a8\u6001\u7684\u3001\u975e\u56fa\u5b9a\u65f6\u95f4\u957f\u5ea6\u7684\u91c7\u6837\u533a\u95f4 (sampling interval)\uff0c\u5e76\u5728\u6bcf\u4e2a\u533a\u95f4\u7ed3\u675f\u65f6\u5bf9\u9884\u53d6\u5668\u7684\u6027\u80fd\u8fdb\u884c\u8bc4\u4f30\uff0c\u4ece\u800c\u4e3a\u4e0b\u4e00\u533a\u95f4\u7684\u51b3\u7b56\u63d0\u4f9b\u4f9d\u636e\u3002</p> <ul> <li> <p>\u91c7\u6837\u533a\u95f4\u7684\u5b9a\u4e49\u4e0e\u89e6\u53d1:</p> <ul> <li>\u533a\u95f4\u7684\u8fb9\u754c\u5e76\u975e\u7531\u56fa\u5b9a\u7684\u6307\u4ee4\u6570\u6216\u65f6\u949f\u5468\u671f\u51b3\u5b9a\uff0c\u800c\u662f\u7531L2\u7f13\u5b58\u7684\u5b9e\u9645\u6d3b\u52a8\u6765\u9a71\u52a8\u3002</li> <li>\u5177\u4f53\u800c\u8a00\uff0c\u7cfb\u7edf\u7ef4\u62a4\u4e00\u4e2a\u540d\u4e3a <code>eviction-count</code> \u7684\u786c\u4ef6\u8ba1\u6570\u5668\uff0c\u7528\u4e8e\u8ffd\u8e2a\u4eceL2\u7f13\u5b58\u4e2d\u9a71\u9010\u51fa\u7684\u5757\u7684\u603b\u6570\u3002</li> <li>\u5f53 <code>eviction-count</code> \u7684\u503c\u8d85\u8fc7\u4e00\u4e2a\u9884\u8bbe\u7684\u9759\u6001\u9608\u503c <code>Tinterval</code> \u65f6\uff0c\u5f53\u524d\u91c7\u6837\u533a\u95f4\u5373\u544a\u7ed3\u675f\u3002</li> <li>\u5728\u5b9e\u9a8c\u4e2d\uff0c<code>Tinterval</code> \u88ab\u8bbe\u7f6e\u4e3a 8192\uff0c\u8fd9\u6070\u597d\u662f\u57fa\u51c6\u914d\u7f6e\u4e2d1MB L2\u7f13\u5b58\u603b\u5757\u6570\uff0816384\uff09\u7684\u4e00\u534a\u3002\u8fd9\u79cd\u8bbe\u8ba1\u786e\u4fdd\u4e86\u91c7\u6837\u9891\u7387\u4e0e\u7f13\u5b58\u7684\u5b9e\u9645\u538b\u529b\u76f8\u5173\u8054\u3002</li> </ul> </li> <li> <p>\u53cd\u9988\u6307\u6807\u7684\u8ba1\u7b97\u4e0e\u66f4\u65b0:</p> <ul> <li>\u5728\u6bcf\u4e2a\u91c7\u6837\u533a\u95f4\u5185\uff0c\u7cfb\u7edf\u4f1a\u6301\u7eed\u7d2f\u52a0\u4e09\u4e2a\u5173\u952e\u6307\u6807\u7684\u539f\u59cb\u8ba1\u6570\uff1a<ul> <li><code>pref-total</code>: \u53d1\u9001\u5230\u5185\u5b58\u7684\u9884\u53d6\u8bf7\u6c42\u6570\u3002</li> <li><code>used-total</code>: \u88ab\u9700\u6c42\u8bbf\u95ee\u547d\u4e2d\u7684\u6709\u7528\u9884\u53d6\u6570\u3002</li> <li><code>late-total</code>: \u56e0\u9884\u53d6\u8bf7\u6c42\u4ecd\u5728\u5904\u7406\u4e2d\u800c\u5bfc\u81f4\u7684\u9700\u6c42\u8bbf\u95ee\u5ef6\u8fdf\u6570\u3002</li> <li><code>pollution-total</code>: \u901a\u8fc7Bloom Filter\u4f30\u7b97\u7684\u3001\u7531\u9884\u53d6\u5668\u5bfc\u81f4\u7684\u9700\u6c42\u7f3a\u5931\u6570\u3002</li> </ul> </li> <li>\u5f53\u4e00\u4e2a\u91c7\u6837\u533a\u95f4\u7ed3\u675f\u65f6\uff0c\u8fd9\u4e9b\u8ba1\u6570\u5668\u7684\u503c\u4f1a\u88ab\u7528\u6765\u8ba1\u7b97\u4e09\u4e2a\u6838\u5fc3\u53cd\u9988\u6307\u6807\uff1a<ul> <li>Prefetch Accuracy (\u9884\u53d6\u51c6\u786e\u7387) = <code>used-total</code> / <code>pref-total</code></li> <li>Prefetch Lateness (\u9884\u53d6\u5ef6\u8fdf\u7387) = <code>late-total</code> / <code>used-total</code></li> <li>Prefetcher-Generated Cache Pollution (\u9884\u53d6\u5668\u751f\u6210\u7684\u7f13\u5b58\u6c61\u67d3) = <code>pollution-total</code> / <code>demand-total</code></li> </ul> </li> <li>\u8ba1\u7b97\u5b8c\u6210\u540e\uff0c\u6240\u6709\u539f\u59cb\u8ba1\u6570\u5668\uff08<code>pref-total</code>, <code>used-total</code>\u7b49\uff09\u4f1a\u88ab\u91cd\u7f6e\u4e3a\u96f6\uff0c\u4e3a\u4e0b\u4e00\u4e2a\u533a\u95f4\u505a\u51c6\u5907\u3002</li> </ul> </li> <li> <p>\u5386\u53f2\u884c\u4e3a\u7684\u5e73\u6ed1\u5904\u7406:</p> <ul> <li>\u4e3a\u4e86\u9632\u6b62\u56e0\u5355\u4e2a\u5f02\u5e38\u533a\u95f4\u800c\u5bfc\u81f4\u9884\u53d6\u7b56\u7565\u5267\u70c8\u6ce2\u52a8\uff0c\u7cfb\u7edf\u5e76\u672a\u5b8c\u5168\u4e22\u5f03\u5386\u53f2\u4fe1\u606f\u3002</li> <li>\u76f8\u53cd\uff0c\u5b83\u91c7\u7528\u4e86\u4e00\u79cd\u6307\u6570\u52a0\u6743\u79fb\u52a8\u5e73\u5747\u7684\u66f4\u65b0\u7b56\u7565\u3002\u5728\u8bba\u6587\u7684\u516c\u5f0f(1)\u4e2d\uff0c\u6bcf\u4e2a\u6307\u6807\u7684\u5168\u5c40\u72b6\u6001\u503c\uff08<code>CounterValueGlobal</code>\uff09\u4f1a\u6839\u636e\u5f53\u524d\u533a\u95f4\u7684\u6d4b\u91cf\u503c\uff08<code>CounterValueDuringInterval</code>\uff09\u8fdb\u884c\u66f4\u65b0\uff1a     <code>CounterValueGlobal = (7/8) * CounterValueGlobal + (1/8) * CounterValueDuringInterval</code></li> <li>\u8fd9\u79cd\u65b9\u5f0f\u8d4b\u4e88\u4e86\u6700\u8fd1\u533a\u95f4\u7684\u884c\u4e3a\u66f4\u9ad8\u7684\u6743\u91cd\uff0c\u540c\u65f6\u4fdd\u7559\u4e86\u5bf9\u5386\u53f2\u884c\u4e3a\u7684\u8bb0\u5fc6\uff0c\u4f7f\u5f97\u53cd\u9988\u4fe1\u53f7\u66f4\u52a0\u5e73\u6ed1\u548c\u7a33\u5065\u3002</li> </ul> </li> </ul> <p></p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li> <p>\u8f93\u5165:</p> <ul> <li>\u539f\u59cb\u4e8b\u4ef6\u6d41: \u6765\u81eaL2\u7f13\u5b58\u548cMSHR\uff08Miss Status Holding Register\uff09\u7684\u5e95\u5c42\u786c\u4ef6\u4e8b\u4ef6\uff0c\u5305\u62ec\u9884\u53d6\u8bf7\u6c42\u7684\u53d1\u9001\u3001\u9700\u6c42\u8bbf\u95ee\u5bf9\u9884\u53d6\u5757\u7684\u547d\u4e2d\u3001\u9700\u6c42\u8bbf\u95ee\u4e0e\u9884\u53d6\u8bf7\u6c42\u5728MSHR\u4e2d\u7684\u51b2\u7a81\u3001\u4ee5\u53ca\u901a\u8fc7Bloom Filter\u68c0\u6d4b\u5230\u7684\u6f5c\u5728\u6c61\u67d3\u4e8b\u4ef6\u3002</li> <li>L2\u9a71\u9010\u4e8b\u4ef6: \u4f5c\u4e3a\u89e6\u53d1\u91c7\u6837\u533a\u95f4\u7ed3\u675f\u7684\u4fe1\u53f7\u3002</li> </ul> </li> <li> <p>\u8f93\u51fa:</p> <ul> <li>\u4e09\u4e2a\u91cf\u5316\u6307\u6807: \u7ecf\u8fc7\u5e73\u6ed1\u5904\u7406\u540e\u7684 Prefetch Accuracy, Prefetch Lateness, \u548c Prefetcher-Generated Cache Pollution \u7684\u6570\u503c\u3002\u8fd9\u4e9b\u662f\u9ad8\u5c42\u51b3\u7b56\u903b\u8f91\u7684\u76f4\u63a5\u8f93\u5165\u3002</li> </ul> </li> <li> <p>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:</p> <ul> <li>\u8be5\u673a\u5236\u662fFeedback Directed Prefetching (FDP) \u67b6\u6784\u7684\u611f\u77e5\u5c42 (Perception Layer)\u3002\u5b83\u8d1f\u8d23\u5c06\u5e95\u5c42\u590d\u6742\u7684\u3001\u77ac\u65f6\u7684\u786c\u4ef6\u4ea4\u4e92\uff0c\u62bd\u8c61\u5e76\u805a\u5408\u4e3a\u4e09\u4e2a\u7b80\u6d01\u3001\u53ef\u64cd\u4f5c\u7684\u6027\u80fd\u6307\u6807\u3002</li> <li>\u5b83\u5145\u5f53\u4e86\u52a8\u6001\u8c03\u6574\u7b56\u7565\uff08\u5982\u6539\u53d8\u9884\u53d6\u6fc0\u8fdb\u7a0b\u5ea6\u548c\u7f13\u5b58\u63d2\u5165\u4f4d\u7f6e\uff09\u4e0e\u5b9e\u9645\u786c\u4ef6\u884c\u4e3a\u4e4b\u95f4\u7684\u6865\u6881\u3002\u6ca1\u6709\u8fd9\u4e2a\u5b9e\u65f6\u3001\u4f4e\u6210\u672c\u7684\u53cd\u9988\u56de\u8def\uff0c\u4e0a\u5c42\u7684\u81ea\u9002\u5e94\u7b56\u7565\u5c31\u5931\u53bb\u4e86\u51b3\u7b56\u4f9d\u636e\u3002</li> <li>\u901a\u8fc7\u5c06\u91c7\u6837\u4e0eL2\u9a71\u9010\u8fd9\u4e00\u4e0e\u7f13\u5b58\u6c61\u67d3\u548c\u5e26\u5bbd\u538b\u529b\u9ad8\u5ea6\u76f8\u5173\u7684\u4e8b\u4ef6\u7ed1\u5b9a\uff0c\u8be5\u673a\u5236\u80fd\u591f\u654f\u9510\u5730\u6355\u6349\u5230\u7a0b\u5e8f\u884c\u4e3a\u7684\u53d8\u5316\uff08\u4f8b\u5982\uff0c\u4ece\u5177\u6709\u826f\u597d\u7a7a\u95f4\u5c40\u90e8\u6027\u7684\u5faa\u73af\u8fdb\u5165\u4e00\u4e2a\u968f\u673a\u8bbf\u95ee\u9636\u6bb5\uff09\uff0c\u5e76\u53ca\u65f6\u505a\u51fa\u53cd\u5e94\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/feedback-directed-prefetching-improving-the-performance-and-bandwidth-efficiency-of-hardware-prefetchers/paper_notes/#4_1","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u6a21\u62df\u5668\u4e0e\u5904\u7406\u5668\u6a21\u578b\uff1a\u4f7f\u7528\u4e00\u4e2a\u5185\u90e8\u7684\u3001\u57fa\u4e8e\u6267\u884c\u9a71\u52a8\u7684 Alpha ISA \u6a21\u62df\u5668\uff0c\u8be5\u6a21\u62df\u5668\u5efa\u6a21\u4e86\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u4e71\u5e8f\u8d85\u6807\u91cf\u5904\u7406\u5668\u3002\u5177\u4f53\u7684\u57fa\u7ebf\u5904\u7406\u5668\u914d\u7f6e\u53c2\u6570\u89c1\u4e0b\u8868\u3002</li> <li>\u5185\u5b58\u6a21\u578b\uff1a\u91c7\u7528\u4e86\u4e00\u4e2a\u8be6\u7ec6\u7684\u5185\u5b58\u6a21\u578b\uff0c\u5fe0\u5b9e\u5730\u6a21\u62df\u4e86\u5185\u5b58\u7cfb\u7edf\u4e2d\u6240\u6709\u786c\u4ef6\u7ed3\u6784\uff08\u5982\u603b\u7ebf\u3001\u961f\u5217\uff09\u7684\u884c\u4e3a\u548c\u5e26\u5bbd/\u7aef\u53e3\u9650\u5236\u3002\u5185\u5b58\u603b\u7ebf\u5e26\u5bbd\u4e3a 4.5 GB/s\u3002</li> <li>\u57fa\u7ebf\u9884\u53d6\u5668\uff1a\u5efa\u6a21\u4e86\u4e00\u4e2a stream prefetcher\uff0c\u80fd\u591f\u8ddf\u8e2a 64 \u4e2a\u4e0d\u540c\u7684\u6570\u636e\u6d41\u3002\u9884\u53d6\u8bf7\u6c42\u88ab\u653e\u5165\u4e00\u4e2a 128 \u9879\u7684\u9884\u53d6\u8bf7\u6c42\u961f\u5217\uff0c\u5e76\u4ee5\u6700\u4f4e\u4f18\u5148\u7ea7\u5904\u7406\uff0c\u4ee5\u907f\u514d\u963b\u585e\u9700\u6c42\u8bf7\u6c42\u3002</li> <li>\u7f13\u5b58\u914d\u7f6e\uff1aL2 \u7f13\u5b58\u5927\u5c0f\u4e3a 1MB\uff0c\u91c7\u7528 16-way \u7ec4\u76f8\u8054\u3002\u5728\u57fa\u7ebf\u914d\u7f6e\u4e2d\uff0c\u9884\u53d6\u7684\u6570\u636e\u5757\u88ab\u63d2\u5165\u5230 LRU \u6808\u7684 MRU (Most-Recently-Used) \u4f4d\u7f6e\u3002</li> <li>\u57fa\u51c6\u6d4b\u8bd5\u96c6\uff1a\u4e3b\u8981\u8bc4\u4f30\u5bf9\u8c61\u662f SPEC CPU2000 \u5957\u4ef6\u4e2d\u7684 17 \u4e2a\u5185\u5b58\u5bc6\u96c6\u578b\u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\u3002\u9009\u62e9\u6807\u51c6\u662f\uff0c\u5728\u6700\u6fc0\u8fdb\u7684\u9884\u53d6\u5668\u914d\u7f6e\u4e0b\uff0c\u8fd9\u4e9b\u7a0b\u5e8f\u5728 2.5 \u4ebf\u6761\u6307\u4ee4\u7684\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u81f3\u5c11\u4f1a\u53d1\u51fa 200K \u6761\u9884\u53d6\u8bf7\u6c42\u3002\u6b64\u5916\uff0c\u8fd8\u5bf9\u5269\u4f59\u7684 9 \u4e2a\u7a0b\u5e8f\u8fdb\u884c\u4e86\u8bc4\u4f30\u3002</li> <li>\u8fd0\u884c\u914d\u7f6e\uff1a\u6240\u6709\u57fa\u51c6\u6d4b\u8bd5\u5747\u4f7f\u7528 Compaq C/Fortran \u7f16\u8bd1\u5668\uff0c\u5f00\u542f <code>-fast</code> \u4f18\u5316\u548c profile-driven feedback\u3002\u6a21\u62df\u524d\u4f1a\u8df3\u8fc7\u521d\u59cb\u5316\u9636\u6bb5\uff0c\u7136\u540e\u8fd0\u884c 250 million instructions\u3002</li> </ul> <p></p> <p>Table 3. Baseline processor configuration</p> <p>\u7ed3\u679c\u6570\u636e</p> <ul> <li>\u6574\u4f53\u6027\u80fd\u63d0\u5347\uff1a\u4e0e\u6027\u80fd\u6700\u4f73\u7684\u4f20\u7edf stream prefetcher \u914d\u7f6e\uff08\u5373 Very Aggressive\uff09\u76f8\u6bd4\uff0cFeedback Directed Prefetching (FDP) \u5c06 17 \u4e2a\u5185\u5b58\u5bc6\u96c6\u578b\u57fa\u51c6\u6d4b\u8bd5\u7684\u5e73\u5747\u6027\u80fd\u63d0\u5347\u4e86 6.5%\u3002</li> <li>\u6d88\u9664\u8d1f\u9762\u6027\u80fd\u5f71\u54cd\uff1aFDP \u5b8c\u5168\u6d88\u9664\u4e86\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u5668\u5728\u67d0\u4e9b\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 <code>ammp</code>, <code>applu</code>\uff09\u4e0a\u9020\u6210\u7684\u5de8\u5927\u6027\u80fd\u635f\u5931\u3002\u4f8b\u5982\uff0c\u5728 <code>applu</code> \u4e0a\uff0cFDP \u76f8\u6bd4\u65e0\u9884\u53d6\u5b9e\u73b0\u4e86 13.4% \u7684\u6027\u80fd\u63d0\u5347\uff0c\u800c\u4f20\u7edf\u6fc0\u8fdb\u9884\u53d6\u5668\u5219\u5bfc\u81f4 28.9% \u7684\u6027\u80fd\u4e0b\u964d\u3002</li> <li>\u5e26\u5bbd\u6548\u7387\uff1aFDP \u6bd4 Very Aggressive \u914d\u7f6e\u6d88\u8017 18.7% \u66f4\u5c11\u7684\u5185\u5b58\u5e26\u5bbd\uff08\u4ee5 BPKI, Bus accesses Per Kilo Instructions \u8861\u91cf\uff09\u3002\u4e0e\u6d88\u8017\u76f8\u4f3c\u5e26\u5bbd\u7684\u4f20\u7edf\u914d\u7f6e\u76f8\u6bd4\uff0cFDP \u63d0\u4f9b\u4e86 13.6% \u66f4\u9ad8\u7684\u6027\u80fd\u3002</li> <li>\u901a\u7528\u6027\uff1aFDP \u7684\u4f18\u52bf\u4e0d\u4ec5\u9650\u4e8e stream prefetcher\u3002\u5e94\u7528\u5230 GHB-based delta correlation prefetcher \u4e0a\u65f6\uff0c\u5728\u76f8\u4f3c\u5e26\u5bbd\u4e0b\u6027\u80fd\u63d0\u5347 9.9%\uff1b\u5e94\u7528\u5230 PC-based stride prefetcher \u4e0a\u65f6\uff0c\u5e73\u5747\u6027\u80fd\u63d0\u5347 4%\uff0c\u5e26\u5bbd\u51cf\u5c11 24%\u3002</li> <li>\u5bf9\u5176\u4ed6\u57fa\u51c6\u7684\u5f71\u54cd\uff1a\u5728\u5269\u4f59\u7684 9 \u4e2a SPEC \u57fa\u51c6\u6d4b\u8bd5\u4e0a\uff0cFDP \u4e5f\u8868\u73b0\u7a33\u5065\uff0c\u5e73\u5747\u6027\u80fd\u63d0\u5347 0.4%\uff0c\u4e14\u6ca1\u6709\u4efb\u4f55\u7a0b\u5e8f\u51fa\u73b0\u6027\u80fd\u4e0b\u964d\u3002</li> </ul> <p></p> <p>Figure 9. Overall performance of FDP</p> <p></p> <p>Table 5. Average IPC and BPKI for FDP vs conventional prefetchers</p> <p>\u6d88\u878d\u5b9e\u9a8c</p> <p>\u8bba\u6587\u901a\u8fc7\u4e00\u7cfb\u5217\u6d88\u878d\u5b9e\u9a8c\uff0c\u9a8c\u8bc1\u4e86 FDP \u4e2d\u5404\u4e2a\u7ec4\u4ef6\u7684\u6709\u6548\u6027\u548c\u5fc5\u8981\u6027\u3002</p> <ul> <li>\u52a8\u6001\u8c03\u6574\u9884\u53d6\u6fc0\u8fdb\u5ea6 (Dynamic Aggressiveness) vs. \u9759\u6001\u914d\u7f6e\uff1a</li> <li>\u4ec5\u4f7f\u7528\u52a8\u6001\u8c03\u6574\u6fc0\u8fdb\u5ea6\uff08\u56fa\u5b9a MRU \u63d2\u5165\u7b56\u7565\uff09\uff0c\u5176\u5e73\u5747\u6027\u80fd\u5c31\u8d85\u8fc7\u4e86\u6240\u6709\u9759\u6001\u914d\u7f6e\uff08No, Very Conservative, Middle-of-the-Road, Very Aggressive\uff09\u3002</li> <li>\u4e0e Very Aggressive \u914d\u7f6e\u76f8\u6bd4\uff0c\u6027\u80fd\u63d0\u5347 4.7%\uff0c\u5e76\u51e0\u4e4e\u5b8c\u5168\u6d88\u9664\u4e86 <code>ammp</code> \u548c <code>applu</code> \u4e0a\u7684\u6027\u80fd\u635f\u5931\u3002</li> <li></li> </ul> <p></p> <p>Figure 5. Dynamic adjustment of prefetcher aggressiveness</p> <ul> <li>\u673a\u5236\u80fd\u81ea\u9002\u5e94\u5730\u4e3a\u4e0d\u540c\u7a0b\u5e8f\u9009\u62e9\u6700\u4f18\u7684\u6fc0\u8fdb\u5ea6\u7ea7\u522b\uff0c\u4f8b\u5982\u5728 <code>wupwise</code> \u4e0a\u51e0\u4e4e\u603b\u662f\u9009\u62e9 Very Aggressive\uff0c\u800c\u5728 <code>ammp</code> \u4e0a\u51e0\u4e4e\u603b\u662f\u9009\u62e9 Very Conservative\u3002</li> <li></li> </ul> <p></p> <p>Figure 6. Distribution of the dynamic aggressiveness level</p> <ul> <li>\u52a8\u6001\u8c03\u6574\u7f13\u5b58\u63d2\u5165\u7b56\u7565 (Dynamic Insertion) vs. \u9759\u6001\u7b56\u7565\uff1a</li> <li>\u5728\u56fa\u5b9a Very Aggressive \u914d\u7f6e\u4e0b\uff0c\u52a8\u6001\u63d2\u5165\u7b56\u7565\u7684\u6027\u80fd\u4f18\u4e8e\u4efb\u4f55\u9759\u6001\u7b56\u7565\uff08MRU, MID, LRU-4, LRU\uff09\u3002</li> <li>\u4e0e\u6700\u4f73\u9759\u6001\u7b56\u7565 LRU-4 \u76f8\u6bd4\uff0c\u6027\u80fd\u63d0\u5347 1.9%\uff1b\u4e0e\u57fa\u7ebf MRU \u76f8\u6bd4\uff0c\u6027\u80fd\u63d0\u5347 5.1%\u3002</li> <li></li> </ul> <p></p> <p>Figure 7. Dynamic adjustment of prefetch insertion policy</p> <ul> <li>\u8be5\u673a\u5236\u80fd\u6839\u636e\u6c61\u67d3\u60c5\u51b5\u52a8\u6001\u9009\u62e9\u63d2\u5165\u4f4d\u7f6e\uff0c\u4f8b\u5982\u5728 <code>ammp</code> \u4e0a\u4e3b\u8981\u4f7f\u7528 LRU \u4f4d\u7f6e\u4ee5\u51cf\u5c11\u6c61\u67d3\u3002</li> <li></li> </ul> <p></p> <p>Figure 8. Distribution of the insertion position of prefetched blocks</p> <ul> <li>\u4ec5\u4f7f\u7528\u9884\u53d6\u51c6\u786e\u7387 (Accuracy-only) vs. \u5b8c\u6574\u53cd\u9988\u673a\u5236\uff1a</li> <li>\u4e00\u4e2a\u4ec5\u57fa\u4e8e Prefetch Accuracy \u6765\u8c03\u6574\u6fc0\u8fdb\u5ea6\u7684\u7b80\u5316\u7248 FDP\uff0c\u5176\u6027\u80fd\u548c\u5e26\u5bbd\u6548\u7387\u5747\u4f4e\u4e8e\u5b8c\u6574\u7684 FDP\u3002</li> <li> <p>\u5b8c\u6574\u7684 FDP\uff08\u540c\u65f6\u8003\u8651 Accuracy, Timeliness/Lateness, Pollution\uff09\u6bd4\u4ec5\u7528\u51c6\u786e\u7387\u7684\u7248\u672c\u6027\u80fd\u9ad8 3.4%\uff0c\u5e26\u5bbd\u6d88\u8017\u4f4e 2.5%\u3002\u8fd9\u8bc1\u660e\u4e86\u7efc\u5408\u591a\u7ef4\u5ea6\u53cd\u9988\u4fe1\u606f\u7684\u91cd\u8981\u6027\u3002</p> </li> <li> <p>FDP vs. \u9884\u53d6\u7f13\u5b58 (Prefetch Cache)\uff1a</p> </li> <li>\u4e3a\u4e86\u5bf9\u6bd4\u89e3\u51b3\u7f13\u5b58\u6c61\u67d3\u7684\u53e6\u4e00\u79cd\u65b9\u6848\uff0c\u4f5c\u8005\u5c06 FDP \u4e0e\u4f7f\u7528\u4e13\u7528 prefetch cache \u7684\u65b9\u6848\u8fdb\u884c\u4e86\u6bd4\u8f83\u3002</li> <li>FDP\uff08\u76f4\u63a5\u9884\u53d6\u5230 L2\uff09\u7684\u6027\u80fd\u6bd4\u4f7f\u7528 32KB prefetch cache \u7684\u6fc0\u8fdb\u9884\u53d6\u5668\u9ad8 5.3%\uff0c\u5e76\u4e14\u5e26\u5bbd\u6d88\u8017\u66f4\u4f4e\u3002</li> <li>FDP \u5728\u6027\u80fd\u4e0a\u63a5\u8fd1 64KB prefetch cache \u7684\u65b9\u6848\uff0c\u4f46\u786c\u4ef6\u5f00\u9500\u8fdc\u5c0f\u4e8e\u540e\u8005\u3002</li> <li></li> </ul> <p></p> <p>Figure 11. Performance of prefetch cache vs. FDP</p> <ul> <li></li> </ul> <p></p> <p>Figure 12. Bandwidth consumption of prefetch cache vs. FDP</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/ELI5_notes/","title":"Limoncello: Prefetchers for Scale \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/limoncello-prefetchers-for-scale/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <p>\u8fd9\u7bc7\u8bba\u6587\u8981\u89e3\u51b3\u7684\u6839\u672c\u95ee\u9898\uff0c\u662f\u73b0\u4ee3\u6570\u636e\u4e2d\u5fc3\u91cc\u4e00\u4e2a\u201c\u597d\u5fc3\u529e\u574f\u4e8b\u201d\u7684\u7ecf\u5178\u56f0\u5883\u3002\u786c\u4ef6 prefetcher \u7684\u672c\u610f\u662f\u597d\u7684\uff1a\u63d0\u524d\u628a\u6570\u636e\u4ece\u6162\u901f\u7684 DRAM \u642c\u5230\u5feb\u901f\u7684 cache \u91cc\uff0c\u51cf\u5c11 CPU \u7b49\u5f85\u65f6\u95f4\u3002\u7136\u800c\uff0c\u5728 Google \u8fd9\u79cd\u8d85\u5927\u89c4\u6a21\u3001\u9ad8\u5229\u7528\u7387\u7684\u6570\u636e\u4e2d\u5fc3\u91cc\uff0c\u8fd9\u4e2a\u201c\u597d\u5fc3\u201d\u5374\u6210\u4e86\u6027\u80fd\u74f6\u9888\u3002</p> <ul> <li>\u5728\u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u7684\u573a\u666f\u4e0b\uff08\u8fd9\u6b63\u662f\u6570\u636e\u4e2d\u5fc3\u8ffd\u6c42\u9ad8\u6548\u8fd0\u8425\u65f6\u7684\u5e38\u6001\uff09\uff0c\u786c\u4ef6 prefetcher \u4f1a\u75af\u72c2\u5730\u53d1\u51fa\u5927\u91cf\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>\u8fd9\u4e9b\u8bf7\u6c42\u4e0d\u4ec5\u5360\u7528\u4e86\u5b9d\u8d35\u7684 memory bandwidth\uff0c\u8fd8\u4f1a\u548c\u771f\u6b63\u9700\u8981\u6570\u636e\u7684\u5e94\u7528\u8bf7\u6c42\u5728\u5185\u5b58\u63a7\u5236\u5668\u5904\u201c\u6253\u67b6\u201d\uff0c\u5bfc\u81f4\u6392\u961f\u5ef6\u8fdf\uff08queuing delay\uff09\u6025\u5267\u589e\u52a0\u3002</li> <li>\u7ed3\u679c\u5c31\u662f\uff0c\u867d\u7136 cache miss rate \u53ef\u80fd\u964d\u4f4e\u4e86\uff0c\u4f46\u6bcf\u6b21 miss \u540e\u4ece DRAM \u53d6\u56de\u6570\u636e\u7684 latency \u5374\u5927\u5e45\u4e0a\u5347\uff0c\u6700\u7ec8\u62d6\u57ae\u4e86\u6574\u4f53\u5e94\u7528\u541e\u5410\u91cf\uff08throughput\uff09\u3002\u7b80\u5355\u8bf4\uff0c\u5c31\u662f\u201c\u7701\u4e86\u5c0f\u94b1\uff0c\u4e8f\u4e86\u5927\u94b1\u201d\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <p>\u60f3\u8c61\u4e00\u4e2a\u7e41\u5fd9\u7684\u6e2f\u53e3\uff08\u5185\u5b58\u7cfb\u7edf\uff09\uff0c\u6709\u5f88\u591a\u8d27\u8239\uff08CPU \u6838\u5fc3\uff09\u7b49\u7740\u5378\u8d27\uff08\u6570\u636e\uff09\u3002\u6e2f\u53e3\u8c03\u5ea6\u5458\uff08\u786c\u4ef6 prefetcher\uff09\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\uff0c\u770b\u5230\u4e00\u8258\u8239\u5feb\u5230\u4e86\uff0c\u5c31\u63d0\u524d\u8ba9\u4ed3\u5e93\uff08DRAM\uff09\u628a\u4e0b\u4e00\u8239\u7684\u8d27\u4e5f\u51c6\u5907\u597d\u3002</p> <ul> <li>\u5728\u6e2f\u53e3\u4e0d\u5fd9\u7684\u65f6\u5019\uff08\u4f4e\u5e26\u5bbd\u5229\u7528\u7387\uff09\uff0c\u8fd9\u62db\u5f88\u7075\uff0c\u8239\u4e00\u5230\u5c31\u80fd\u7acb\u523b\u5378\u8d27\u3002</li> <li>\u4f46\u5728\u6e2f\u53e3\u9ad8\u5cf0\u671f\uff08\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\uff09\uff0c\u6240\u6709\u8c03\u5ea6\u5458\u90fd\u8fd9\u4e48\u5e72\uff0c\u7ed3\u679c\u4ed3\u5e93\u95e8\u53e3\u5806\u6ee1\u4e86\u201c\u53ef\u80fd\u7528\u5f97\u4e0a\u201d\u7684\u8d27\u7269\uff0c\u53cd\u800c\u628a\u771f\u6b63\u6025\u9700\u5378\u8d27\u7684\u8239\u7ed9\u5835\u5728\u5916\u9762\u4e86\u3002\u6574\u4e2a\u6e2f\u53e3\u7684\u541e\u5410\u91cf\u4e0d\u5347\u53cd\u964d\u3002</li> </ul> <p>Limoncello \u7684\u601d\u8def\u662f\uff1a\u9ad8\u5cf0\u671f\u5e72\u8106\u8ba9\u8fd9\u4e9b\u201c\u70ed\u5fc3\u8fc7\u5934\u201d\u7684\u8c03\u5ea6\u5458\uff08\u786c\u4ef6 prefetcher\uff09\u5148\u4f11\u606f\uff0c\u7136\u540e\u6d3e\u51e0\u4e2a\u201c\u7279\u79cd\u5175\u201d\uff08\u8f6f\u4ef6 prefetcher\uff09\u53bb\u7cbe\u51c6\u5730\u4e3a\u6700\u5173\u952e\u3001\u6700\u8017\u65f6\u7684\u51e0\u8258\u8239\uff08\u7279\u5b9a\u5e93\u51fd\u6570\uff09\u63d0\u524d\u6e05\u51fa\u901a\u9053\u3002\u8fd9\u6837\u65e2\u7f13\u89e3\u4e86\u62e5\u5835\uff0c\u53c8\u4fdd\u8bc1\u4e86\u5173\u952e\u4efb\u52a1\u7684\u6548\u7387\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>\u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u53bb\u4fee\u6539\u6216\u66ff\u6362\u590d\u6742\u7684\u786c\u4ef6 prefetcher\uff0c\u800c\u662f\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u806a\u660e\u7684 \u8f6f\u786c\u534f\u540c\u52a8\u6001\u5207\u6362\u7b56\u7565\uff0c\u6838\u5fc3\u5728\u4e8e\u4e24\u70b9\uff1a</p> <ul> <li>\u52a8\u6001\u5f00\u5173\u786c\u4ef6 prefetcher\uff1a\u901a\u8fc7\u5b9e\u65f6\u76d1\u63a7 socket \u7ea7\u522b\u7684 memory bandwidth utilization\uff0c\u5f53\u8d1f\u8f7d\u8d85\u8fc7\u4e00\u4e2a\u9608\u503c\uff08\u598280%\uff09\u65f6\uff0c\u5c31\u901a\u8fc7\u5199 MSR \u5bc4\u5b58\u5668\u76f4\u63a5\u5173\u6389\u786c\u4ef6 prefetcher\uff1b\u5f53\u8d1f\u8f7d\u56de\u843d\u5230\u53e6\u4e00\u4e2a\u8f83\u4f4e\u9608\u503c\uff08\u598260%\uff09\u4ee5\u4e0b\u65f6\uff0c\u518d\u91cd\u65b0\u6253\u5f00\u3002\u8fd9\u5c31\u50cf\u6839\u636e\u4ea4\u901a\u6d41\u91cf\u81ea\u52a8\u5f00\u5173\u9ad8\u67b6\u6865\u7684\u5165\u53e3\u531d\u9053\uff0c\u9632\u6b62\u4e3b\u8def\u5f7b\u5e95\u762b\u75ea\u3002</li> </ul> <p></p> <p>Figure 6. Limoncello disables hardware prefetchers when memory bandwidth utilization is high to optimize for memory latency.</p> <ul> <li>\u7cbe\u51c6\u63d2\u5165\u8f6f\u4ef6 prefetcher\uff1a\u786c\u4ef6 prefetcher \u5173\u6389\u540e\uff0c\u4e00\u4e9b\u5bf9\u5185\u5b58\u5ef6\u8fdf\u6781\u5ea6\u654f\u611f\u7684\u201c\u6570\u636e\u4e2d\u5fc3\u7a0e\u201d\u51fd\u6570\uff08\u5982 memcpy, compression, hashing\uff09\u6027\u80fd\u4f1a\u4e0b\u964d\u3002\u4f5c\u8005\u6ca1\u6709\u76f2\u76ee\u5730\u5230\u5904\u52a0\u8f6f\u4ef6 prefetch\uff0c\u800c\u662f\u5229\u7528\u4e00\u6b21\u5927\u89c4\u6a21\u7684 hardware ablation study\uff08\u5728\u6570\u5341\u4e07\u53f0\u673a\u5668\u4e0a\u5173\u95ed\u786c\u4ef6 prefetcher \u505a\u5b9e\u9a8c\uff09\uff0c\u7ed3\u5408 fleet-wide profiling\uff0c\u7cbe\u51c6\u5b9a\u4f4d\u51fa\u54ea\u4e9b\u51fd\u6570\u6700\u201c\u53d7\u4f24\u201d\u3002\u7136\u540e\uff0c\u53ea\u9488\u5bf9\u8fd9\u4e9b\u51fd\u6570\uff0c\u5229\u7528\u5176\u5df2\u77e5\u7684\u3001\u89c4\u5219\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff08\u6bd4\u5982\u8fde\u7eed\u62f7\u8d1d\uff09\uff0c\u624b\u52a8\u63d2\u5165\u9ad8\u5ea6\u4f18\u5316\u7684\u8f6f\u4ef6 prefetch \u6307\u4ee4\u3002</li> </ul> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p> <p></p> <p>Figure 12. Aggregated change in CPU cycles (%) from Hard Limoncello. Data center tax functions (green) increased in CPU cycles under Hard Limoncello. In contrast, overall nondata center tax functions (blue) decreased in cycles.</p> <p>\u8fd9\u4e2a\u65b9\u6848\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u907f\u5f00\u4e86\u4f20\u7edf\u65b9\u6cd5\u7684\u4e24\u5927\u96be\u9898\uff1a\u4e00\u662f\u4e0d\u9700\u8981\u6602\u8d35\u7684\u786c\u4ef6\u6539\u52a8\uff0c\u4e8c\u662f\u907f\u514d\u4e86\u5728\u6d77\u91cf\u3001\u591a\u6837\u7684\u751f\u4ea7\u73af\u5883\u4e2d\u505a\u5168\u7a0b\u5e8f profile-guided optimization \u7684\u4e0d\u5207\u5b9e\u9645\u3002\u5b83\u7528\u4e00\u79cd\u201c\u5916\u79d1\u624b\u672f\u5f0f\u201d\u7684\u7cbe\u51c6\u6253\u51fb\uff0c\u89e3\u51b3\u4e86\u5927\u89c4\u6a21\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e2a\u5168\u5c40\u6027\u74f6\u9888\u3002\u6700\u7ec8\u6548\u679c\u663e\u8457\uff1a\u5728\u5cf0\u503c\u8d1f\u8f7d\u4e0b\uff0cmemory latency \u964d\u4f4e15%\uff0capplication throughput \u63d0\u534710%\u3002</p> <p></p> <p>Figure 16. Limoncello application throughput gain. Application throughput increases by 6-13% increase, dependent on the CPU utilization level of the machines.</p> <p></p> <p>Figure 17. Limoncello memory latency reduction. Memory latency reduces by 13% in the median and 10% in the P99.</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/ELI5_notes/#1-hard-limoncello-eli5","title":"1. Hard Limoncello (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\uff08Hardware Prefetcher\uff09\u7684\u8bbe\u8ba1\u54f2\u5b66\u662f\u201c\u4e0d\u60dc\u4e00\u5207\u4ee3\u4ef7\u51cf\u5c11 Cache Miss\u201d\uff0c\u8fd9\u5728\u5185\u5b58\u5e26\u5bbd\u5145\u88d5\u7684\u5b9e\u9a8c\u5ba4\u73af\u5883\uff08\u5982\u8dd1 SPEC benchmark\uff09\u4e0b\u5f88\u6709\u6548\u3002 - \u4f46\u5728 Google \u8fd9\u6837\u7684\u9ad8\u5229\u7528\u7387\u6570\u636e\u4e2d\u5fc3\u91cc\uff0c\u60c5\u51b5\u5b8c\u5168\u76f8\u53cd\uff1a\u5185\u5b58\u5e26\u5bbd\u662f\u7a00\u7f3a\u8d44\u6e90\uff0c\u65e9\u5df2\u6210\u4e3a\u74f6\u9888\u3002\u6b64\u65f6\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u8fd8\u5728\u62fc\u547d\u5730\u3001\u4e0d\u52a0\u533a\u5206\u5730\u9884\u53d6\u6570\u636e\uff0c\u7ed3\u679c\u5c31\u662f\uff1a   - \u6d6a\u8d39\u5b9d\u8d35\u7684\u5185\u5b58\u5e26\u5bbd\uff1a\u9884\u53d6\u4e86\u5f88\u591a\u53ef\u80fd\u6839\u672c\u7528\u4e0d\u4e0a\u7684\u6570\u636e\u3002   - \u52a0\u5267\u5185\u5b58\u62e5\u585e\uff1a\u5bfc\u81f4\u771f\u6b63\u9700\u8981\u7684\u6570\u636e\uff08demand request\uff09\u6392\u961f\u7b49\u5f85\u65f6\u95f4\u53d8\u957f\uff0c\u5373 load-to-use latency \u66b4\u589e\u3002   - \u7b80\u5355\u8bf4\uff0c\u5c31\u662f\u201c\u597d\u5fc3\u529e\u574f\u4e8b\u201d\u2014\u2014\u4e3a\u4e86\u7701\u4e00\u70b9 CPU \u5468\u671f\u53bb\u7b49 Cache\uff0c\u5374\u82b1\u4e86\u66f4\u591a\u65f6\u95f4\u5728\u5185\u5b58\u961f\u5217\u91cc\u5e72\u7b49\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4e00\u4e2a\u7e41\u5fd9\u7684\u6e2f\u53e3\uff08\u5185\u5b58\u63a7\u5236\u5668\uff09\uff0c\u8d27\u8239\uff08\u5185\u5b58\u8bf7\u6c42\uff09\u7edc\u7ece\u4e0d\u7edd\u3002 - \u786c\u4ef6\u9884\u53d6\u5668\u5c31\u50cf\u662f\u4e00\u4e2a\u8fc7\u4e8e\u70ed\u5fc3\u7684\u4ed3\u5e93\u7ba1\u7406\u5458\uff0c\u4ed6\u770b\u5230\u67d0\u8258\u8239\u8981\u6765\u5378\u8d27\uff0c\u5c31\u81ea\u4f5c\u4e3b\u5f20\u5730\u8ba9\u597d\u51e0\u8258\u7a7a\u8239\uff08\u9884\u53d6\u8bf7\u6c42\uff09\u63d0\u524d\u5f00\u5230\u6e2f\u53e3\u8fb9\u7b49\u7740\u88c5\u8d27\u3002 - \u5728\u6e2f\u53e3\u7a7a\u95f2\u65f6\uff08\u4f4e\u5e26\u5bbd\u5229\u7528\u7387\uff09\uff0c\u8fd9\u6ca1\u95ee\u9898\uff0c\u751a\u81f3\u80fd\u52a0\u5feb\u901f\u5ea6\u3002 - \u4f46\u5728\u6e2f\u53e3\u5df2\u7ecf\u5835\u5f97\u6c34\u6cc4\u4e0d\u901a\u65f6\uff08\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\uff09\uff0c\u8fd9\u4e9b\u7a7a\u8239\u4e0d\u4ec5\u5360\u7740\u5b9d\u8d35\u7684\u6cca\u4f4d\uff0c\u8fd8\u6321\u4f4f\u4e86\u771f\u6b63\u8981\u88c5\u5378\u8d27\u7269\u7684\u8239\u53ea\uff0c\u5bfc\u81f4\u6574\u4e2a\u6e2f\u53e3\u7684\u541e\u5410\u6548\u7387\u53cd\u800c\u4e0b\u964d\u4e86\u3002 - \u201cHard Limoncello\u201d \u5c31\u50cf\u662f\u6e2f\u53e3\u7684\u667a\u80fd\u8c03\u5ea6\u7cfb\u7edf\uff1a\u4e00\u65e6\u53d1\u73b0\u6e2f\u53e3\u62e5\u5835\u6307\u6570\uff08\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\uff09\u8d85\u8fc7\u8b66\u6212\u7ebf\uff0c\u5c31\u7acb\u523b\u4e0b\u4ee4\u8ba9\u90a3\u4e2a\u70ed\u5fc3\u8fc7\u5934\u7684\u7ba1\u7406\u5458\u201c\u95ed\u5634\u4f11\u606f\u201d\uff0c\u505c\u6b62\u6d3e\u53d1\u7a7a\u8239\uff0c\u628a\u6240\u6709\u8d44\u6e90\u90fd\u7559\u7ed9\u771f\u6b63\u6709\u9700\u6c42\u7684\u8239\u53ea\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u6ca1\u6709\u53bb\u4fee\u6539\u6216\u66ff\u6362\u786c\u4ef6\u9884\u53d6\u5668\u672c\u8eab\uff08\u90a3\u9700\u8981\u82af\u7247\u5382\u5546\u4ecb\u5165\uff0c\u6210\u672c\u592a\u9ad8\uff09\uff0c\u800c\u662f\u505a\u4e86\u4e00\u4e2a\u7eaf\u8f6f\u4ef6\u7684\u201c\u5f00\u5173\u63a7\u5236\u5668\u201d\u3002 - \u8fd9\u4e2a\u63a7\u5236\u5668\u7684\u6838\u5fc3\u903b\u8f91\u975e\u5e38\u6e05\u6670\uff0c\u4f46\u8bbe\u8ba1\u5f97\u5f88\u7a33\u5065\uff1a   - \u52a8\u6001\u9608\u503c\u5224\u65ad\uff1a\u6301\u7eed\u76d1\u63a7\u6bcf\u4e2a CPU Socket \u7684 \u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u3002     - \u5f53\u5229\u7528\u7387\u8d85\u8fc7\u4e00\u4e2a\u9ad8\u9608\u503c\uff08\u4f8b\u5982 80%\uff09\u65f6\uff0c\u901a\u8fc7\u5199 MSR (Model-Specific Register) \u76f4\u63a5 \u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u3002     - \u5f53\u5229\u7528\u7387\u56de\u843d\u5230\u4e00\u4e2a\u4f4e\u9608\u503c\uff08\u4f8b\u5982 60%\uff09\u4ee5\u4e0b\u65f6\uff0c\u518d\u91cd\u65b0\u6253\u5f00\u3002   - \u5f15\u5165\u8fdf\u6ede\u673a\u5236 (Hysteresis)\uff1a\u8fd9\u662f\u9632\u6b62\u7cfb\u7edf\u5728\u9608\u503c\u8fb9\u7f18\u75af\u72c2\u6296\u52a8\u7684\u5173\u952e\u3002\u9ad8\u4f4e\u9608\u503c\u4e4b\u95f4\u7559\u51fa\u4e00\u4e2a\u7f13\u51b2\u533a\uff0c\u5e76\u4e14\u8981\u6c42\u72b6\u6001\u5fc5\u987b\u6301\u7eed\u4e00\u6bb5\u65f6\u95f4\u624d\u89e6\u53d1\u5207\u6362\uff0c\u4fdd\u8bc1\u4e86\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u3002</p> <p></p> <p>Figure 8. State diagram of Hard Limoncello controller for modulating hardware prefetchers. Green (lighter) indicates hardware prefetchers are off, blue (darker) that they are on.</p> <ul> <li>\u8fd9\u4e00\u62db\u7684\u672c\u8d28\uff0c\u662f\u5728\u7cfb\u7edf\u8fd0\u884c\u65f6\u52a8\u6001\u5730\u5728\u4e24\u79cd\u6a21\u5f0f\u95f4\u5207\u6362\uff1a</li> <li>\u4f4e\u8d1f\u8f7d\u6a21\u5f0f\uff1a\u5f00\u542f\u786c\u4ef6\u9884\u53d6\uff0c\u4f18\u5316 Cache Miss Rate\u3002</li> <li>\u9ad8\u8d1f\u8f7d\u6a21\u5f0f\uff1a\u5173\u95ed\u786c\u4ef6\u9884\u53d6\uff0c\u4f18\u5316 Memory Latency \u548c Memory Bandwidth \u6548\u7387\u3002</li> <li>\u6700\u7ec8\u6548\u679c\u7acb\u7aff\u89c1\u5f71\uff1a\u5728\u9ad8\u8d1f\u8f7d\u4e0b\uff0c\u5185\u5b58\u5ef6\u8fdf\u964d\u4f4e\u4e86 15%\uff0c\u4e3a\u540e\u7eed\u7684\u6027\u80fd\u63d0\u5347\u6253\u4e0b\u4e86\u57fa\u7840\u3002</li> </ul> <p></p> <p>Figure 18. Limoncello socket bandwidth usage reduction. Average socket bandwidth reduces by 15%.</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/ELI5_notes/#2-soft-limoncello-eli5","title":"2. Soft Limoncello (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u786c\u4ef6 Prefetcher \u5728 \u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387 \u7684\u6570\u636e\u4e2d\u5fc3\u573a\u666f\u4e0b\uff0c\u4f1a\u201c\u597d\u5fc3\u529e\u574f\u4e8b\u201d\u3002</li> <li>\u5b83\u4eec\u4e3a\u4e86\u8ffd\u6c42 \u9ad8\u7f13\u5b58\u547d\u4e2d\u7387 (cache hit rate)\uff0c\u4f1a\u975e\u5e38 aggressive\uff08\u6fc0\u8fdb\uff09 \u5730\u53d1\u51fa\u5927\u91cf\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>\u8fd9\u5bfc\u81f4\u4e24\u4e2a\u4e25\u91cd\u95ee\u9898\uff1a</li> <li>\u6d6a\u8d39\u5b9d\u8d35\u7684\u5185\u5b58\u5e26\u5bbd\uff1a\u9884\u53d6\u7684\u6570\u636e\u53ef\u80fd\u6839\u672c\u7528\u4e0d\u4e0a\uff0c\u6216\u8005\u88ab\u5176\u4ed6\u4efb\u52a1\u6324\u6389\uff0c\u53d8\u6210 cache pollution\uff08\u7f13\u5b58\u6c61\u67d3\uff09\u3002</li> <li>\u589e\u52a0\u5185\u5b58\u5ef6\u8fdf\uff1a\u8fc7\u591a\u7684\u9884\u53d6\u8bf7\u6c42\u5728\u5185\u5b58\u63a7\u5236\u5668\u6392\u961f\uff0c\u8ba9\u771f\u6b63\u9700\u8981\u6570\u636e\u7684 demand request\uff08\u9700\u6c42\u8bf7\u6c42\uff09 \u7b49\u5f97\u66f4\u4e45\u3002</li> <li>\u5f53\u7cfb\u7edf\u5173\u95ed\u786c\u4ef6 Prefetcher \u6765\u7f13\u89e3\u4e0a\u8ff0\u95ee\u9898\u65f6\uff0c\u53c8\u4f1a\u5e26\u6765\u65b0\u9ebb\u70e6\uff1a\u90a3\u4e9b \u8bbf\u95ee\u6a21\u5f0f\u7b80\u5355\u3001\u89c4\u5f8b\u6027\u5f3a \u7684\u5173\u952e\u51fd\u6570\uff08\u8bba\u6587\u91cc\u53eb data center tax functions\uff09\u4f1a\u56e0\u4e3a\u7f3a\u5c11\u9884\u53d6\u800c \u6027\u80fd\u9aa4\u964d\uff0c\u8868\u73b0\u4e3a LLC MPKI\uff08Last Level Cache Misses Per Kilo Instructions\uff09 \u6025\u5267\u4e0a\u5347\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4e00\u4e2a\u7e41\u5fd9\u7684\u4e2d\u592e\u53a8\u623f\uff08\u5185\u5b58\u7cfb\u7edf\uff09\uff0c\u91cc\u9762\u6709\u5f88\u591a\u53a8\u5e08\uff08CPU\u6838\u5fc3\uff09\u5728\u540c\u65f6\u505a\u83dc\uff08\u5904\u7406\u4efb\u52a1\uff09\u3002</li> <li>\u786c\u4ef6 Prefetcher \u5c31\u50cf\u4e00\u4e2a \u81ea\u4f5c\u806a\u660e\u7684\u4ed3\u5e93\u7ba1\u7406\u5458\u3002\u4ed6\u770b\u5230\u67d0\u4e2a\u53a8\u5e08\u7ecf\u5e38\u7528\u76d0\uff0c\u5c31\u4e0d\u7ba1\u4e09\u4e03\u4e8c\u5341\u4e00\uff0c\u628a\u4e00\u6574\u888b\u76d0\u90fd\u63a8\u5230\u53a8\u5e08\u7684\u64cd\u4f5c\u53f0\u4e0a\u3002\u7ed3\u679c\u64cd\u4f5c\u53f0\u5806\u6ee1\u4e86\u7528\u4e0d\u4e0a\u7684\u76d0\uff08cache pollution\uff09\uff0c\u5176\u4ed6\u53a8\u5e08\u8981\u62ff\u9171\u6cb9\u90fd\u627e\u4e0d\u5230\u5730\u65b9\uff0c\u6574\u4e2a\u53a8\u623f\u6548\u7387\u53cd\u800c\u4e0b\u964d\u4e86\u3002</li> <li>Soft Limoncello \u7684\u505a\u6cd5\u662f\uff1a\u5f53\u53a8\u623f\u592a\u5fd9\uff08\u9ad8\u5e26\u5bbd\u538b\u529b\uff09\u65f6\uff0c\u5148\u8ba9\u90a3\u4e2a\u7b28\u7ba1\u7406\u5458 \u4f11\u606f\u4e00\u4e0b\uff08\u5173\u95ed\u786c\u4ef6 Prefetcher\uff09\u3002\u7136\u540e\uff0c\u7ed9\u51e0\u4e2a \u6700\u5173\u952e\u3001\u6d41\u7a0b\u6700\u56fa\u5b9a\u7684\u53a8\u5e08\uff08\u5982\u4e13\u95e8\u8d1f\u8d23\u5207\u83dc/\u712f\u6c34\u7684 data center tax functions\uff09 \u914d\u4e00\u4e2a \u79c1\u4eba\u52a9\u7406\u3002</li> <li>\u8fd9\u4e2a\u79c1\u4eba\u52a9\u7406 \u975e\u5e38\u7cbe\u51c6\uff1a\u4ed6\u77e5\u9053\u4e3b\u53a8\u4e0b\u4e00\u6b65 \u786e\u5207 \u8981\u7528\u54ea\u628a\u5200\u3001\u54ea\u79cd\u6599\uff0c\u5e76\u4e14\u53ea\u5728\u4ed6 \u521a\u597d\u9700\u8981\u524d\u7684\u4e00\u77ac\u95f4 \u628a\u4e1c\u897f\u9012\u8fc7\u53bb\u3002\u8fd9\u6837\u65e2\u4e0d\u4f1a\u5360\u5730\u65b9\uff0c\u53c8\u80fd\u4fdd\u8bc1\u4e3b\u53a8\u7684\u624b\u4e0d\u505c\u4e0b\u6765\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u53bb\u4fee\u6539\u6216\u66ff\u6362\u786c\u4ef6 Prefetcher\uff0c\u800c\u662f\u8bbe\u8ba1\u4e86\u4e00\u5957 \u7cbe\u51c6\u5916\u79d1\u624b\u672f\u5f0f \u7684\u8f6f\u4ef6\u9884\u53d6\u7b56\u7565\u3002</li> <li>\u5176\u6838\u5fc3\u903b\u8f91\u8f6c\u6362\u5728\u4e8e \u76ee\u6807\u9009\u62e9 \u548c \u63d2\u5165\u65b9\u5f0f\uff1a</li> <li>\u76ee\u6807\u9009\u62e9\uff1a\u901a\u8fc7\u5728 \u771f\u5b9e\u751f\u4ea7\u73af\u5883\uff08fleet-wide\uff09 \u4e2d\u8fdb\u884c\u5927\u89c4\u6a21 \u786c\u4ef6\u6d88\u878d\u5b9e\u9a8c\uff08ablation study\uff09\u2014\u2014\u5373\u5728\u6210\u5343\u4e0a\u4e07\u53f0\u673a\u5668\u4e0a\u5173\u95ed\u786c\u4ef6 Prefetcher\u2014\u2014\u6765\u89c2\u5bdf\u54ea\u4e9b\u51fd\u6570 \u771f\u6b63\u53d7\u5bb3\u3002\u4ed6\u4eec\u53d1\u73b0\uff0cdata center tax functions\uff08\u5982 <code>memcpy</code>\u3001\u538b\u7f29\u3001\u54c8\u5e0c\u7b49\uff09\u662f\u4e3b\u8981\u53d7\u5bb3\u8005\u3002\u8fd9\u4e9b\u51fd\u6570\u7684\u7279\u70b9\u662f \u8bbf\u95ee\u6a21\u5f0f\u9ad8\u5ea6\u53ef\u9884\u6d4b\uff08\u901a\u5e38\u662f\u987a\u5e8f\u8bbf\u95ee\u5927\u5757\u5185\u5b58\uff09\uff0c\u975e\u5e38\u9002\u5408\u8f6f\u4ef6\u9884\u53d6\u3002</li> </ul> <p></p> <p>Figure 10. Application throughput based on different Hard Limoncello configurations. ?? /?? indicates the lower (?? %) and upper (?? %) memory bandwidth thresholds in the configuration. Thresholds are expressed as a percentage of memory bandwidth saturation.</p> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p> <ul> <li>\u63d2\u5165\u65b9\u5f0f\uff1a\u9488\u5bf9\u8fd9\u4e9b\u7279\u5b9a\u51fd\u6570\uff0c\u5728\u5176\u6e90\u4ee3\u7801\u4e2d \u624b\u52a8\u3001\u7cbe\u786e\u5730\u63d2\u5165 <code>prefetch</code> \u6307\u4ee4\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u4e0d\u662f\u76f2\u76ee\u7684\uff0c\u800c\u662f\u57fa\u4e8e\u5bf9\u51fd\u6570 \u8c03\u7528\u53c2\u6570\u5206\u5e03\uff08\u4f8b\u5982 <code>memcpy</code> \u7684\u62f7\u8d1d\u5927\u5c0f\uff09\u548c \u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f \u7684\u6df1\u5165\u5206\u6790\uff0c\u6765\u51b3\u5b9a\u4e09\u4e2a\u5173\u952e\u53c2\u6570\uff1a<ul> <li>Prefetch address\uff1a\u9884\u53d6\u54ea\u4e2a\u786e\u5207\u7684\u5730\u5740\u3002</li> <li>Prefetch distance\uff1a\u63d0\u524d\u591a\u5c11\u5b57\u8282\u5f00\u59cb\u9884\u53d6\u3002</li> <li>Prefetch degree\uff1a\u4e00\u6b21\u9884\u53d6\u591a\u5c11\u6570\u636e\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 13. Software prefetch instructions act on addresses at a distance and can prefetch different degrees of data.</p> <ul> <li>\u4ee5 <code>memcpy</code> \u4e3a\u4f8b\uff0c\u4ed6\u4eec\u53d1\u73b0\u5927\u591a\u6570\u62f7\u8d1d\u64cd\u4f5c\u5f88\u5c0f\uff0c\u4f46\u6027\u80fd\u56de\u9000\u4e3b\u8981\u53d1\u751f\u5728 \u5927\u5757\u5185\u5b58\u62f7\u8d1d \u4e0a\u3002\u56e0\u6b64\uff0c\u4ed6\u4eec\u53ea\u4e3a \u8d85\u8fc7\u7279\u5b9a\u5927\u5c0f\u9608\u503c \u7684 <code>memcpy</code> \u8c03\u7528\u63d2\u5165\u9884\u53d6\u6307\u4ee4\uff0c\u5e76\u901a\u8fc7\u5fae\u57fa\u51c6\u6d4b\u8bd5\uff08microbenchmarks\uff09\u627e\u5230\u4e86\u6700\u4f18\u7684 distance \u548c degree \u7ec4\u5408\u3002</li> </ul> <p></p> <p>Figure 14. memcpy argument size distribution. The chart shows the probability density function (PDF) of the number of times each copy size appears in the profiling data. Most copy sizes are small.</p> <p></p> <p>Figure 15. Soft Limoncello memcpy microbenchmarking.</p> <ul> <li>\u6700\u7ec8\u6548\u679c\u662f\uff1a\u5728\u786c\u4ef6 Prefetcher \u5173\u95ed\u3001\u7cfb\u7edf\u5185\u5b58\u538b\u529b\u5927\u7684\u65f6\u5019\uff0c\u8fd9\u4e9b\u5173\u952e\u51fd\u6570\u4f9d\u7136\u80fd\u4fdd\u6301 \u4f4e MPKI\uff0c\u4ece\u800c\u907f\u514d\u4e86\u6574\u4f53\u6027\u80fd\u7684\u56de\u9000\u3002</li> </ul> <p></p> <p>Figure 20. Software prefetcher impact in Limoncello. The y-axis shows the portion of fleetwide cycles spent in the respective function categories. The center bar (green) shows Hard Limoncello deployed without any software prefetchers. Adding software prefetchers into Limoncello lowered CPU cycles spent in targeted functions by 2% (yellow).</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/ELI5_notes/#3-eli5","title":"3. \u57fa\u4e8e\u5927\u89c4\u6a21\u786c\u4ef6\u6d88\u878d\u7814\u7a76\u7684\u76ee\u6807\u8bc6\u522b\u65b9\u6cd5 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684 profile-guided software prefetching \u65b9\u6cd5\u5728\u8d85\u5927\u89c4\u6a21\u6570\u636e\u4e2d\u5fc3\u91cc\u6839\u672c\u73a9\u4e0d\u8f6c\u3002\u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a\u5b83\u4f9d\u8d56\u4e8e\u201c\u6709\u4ee3\u8868\u6027\u7684 benchmark \u548c\u8f93\u5165\u6570\u636e\u201d\u6765\u751f\u6210\u6027\u80fd\u753b\u50cf\u3002</li> <li>\u4f46\u5728 Google \u8fd9\u79cd\u7ea7\u522b\u7684\u8230\u961f\u91cc\uff0c\u5de5\u4f5c\u8d1f\u8f7d\uff08workloads\uff09\u548c\u8f93\u5165\u6570\u636e\u7684\u591a\u6837\u6027\u662f\u5929\u6587\u6570\u5b57\u7ea7\u522b\u7684\u3002\u4f60\u6839\u672c\u627e\u4e0d\u5230\u4e00\u4e2a\u80fd\u4ee3\u8868\u6240\u6709\u573a\u666f\u7684\u201c\u6807\u51c6\u6d4b\u8bd5\u96c6\u201d\u3002</li> <li>\u7ed3\u679c\u5c31\u662f\uff0c\u4f20\u7edf\u65b9\u6cd5\u8981\u4e48\u627e\u4e0d\u5230\u597d\u7684\u9884\u53d6\u70b9\uff0c\u8981\u4e48\u627e\u5230\u7684\u70b9\u53ea\u5bf9\u4e00\u5c0f\u90e8\u5206 workload \u6709\u6548\uff0c\u65e0\u6cd5\u89c4\u6a21\u5316\uff08scale\uff09\u3002\u8fd9\u5bfc\u81f4\u8f6f\u4ef6\u9884\u53d6\u7684\u6f5c\u529b\u88ab\u4e25\u91cd\u4f4e\u4f30\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u8981\u7ed9\u4e00\u4e2a\u62e5\u6709\u6570\u767e\u4e07\u5458\u5de5\u7684\u8de8\u56fd\u516c\u53f8\u505a\u201c\u5458\u5de5\u6548\u7387\u4f18\u5316\u201d\u3002\u4f20\u7edf\u65b9\u6cd5\u662f\u627e\u51e0\u4e2a\u201c\u5178\u578b\u5458\u5de5\u201d\u505a\u6df1\u5ea6\u8bbf\u8c08\u548c\u89c2\u5bdf\uff08benchmarking\uff09\uff0c\u7136\u540e\u63a8\u5e7f\u4ed6\u4eec\u7684\u9ad8\u6548\u5de5\u4f5c\u6cd5\u3002</li> <li>\u4f46\u8fd9\u4e2a\u516c\u53f8\u4e1a\u52a1\u592a\u6742\u4e86\uff0c\u6709\u7a0b\u5e8f\u5458\u3001\u9500\u552e\u3001\u7269\u6d41\u53f8\u673a\u3001\u53a8\u5e08\u2026\u2026\u4f60\u8bbf\u8c08\u7684\u201c\u5178\u578b\u7a0b\u5e8f\u5458\u201d\u7684\u65b9\u6cd5\uff0c\u5bf9\u7269\u6d41\u53f8\u673a\u5b8c\u5168\u6ca1\u7528\u3002</li> <li>Limoncello \u7684\u505a\u6cd5\u662f\uff1a\u76f4\u63a5\u7ed9\u5168\u516c\u53f8\u53d1\u4e00\u4e2a\u201c\u4e34\u65f6\u653f\u7b56\u53d8\u66f4\u201d\u2014\u2014\u6bd4\u5982\uff0c\u4eca\u5929\u6240\u6709\u4eba\u90fd\u4e0d\u80fd\u7528\u516c\u53f8\u5185\u90e8\u7684\u81ea\u52a8\u5496\u5561\u673a\uff08\u7c7b\u6bd4 disabling hardware prefetchers\uff09\u3002\u7136\u540e\uff0c\u901a\u8fc7\u904d\u5e03\u5168\u516c\u53f8\u7684\u76d1\u63a7\u7cfb\u7edf\uff08fleetwide profiling tools\uff09\uff0c\u5b9e\u65f6\u89c2\u5bdf\u54ea\u4e9b\u90e8\u95e8\u7684\u5458\u5de5\u5de5\u4f5c\u6548\u7387\u66b4\u8dcc\uff08CPU cycles \u589e\u52a0\uff0cLLC MPKI \u4e0a\u5347\uff09\u3002</li> <li>\u90a3\u4e9b\u6548\u7387\u66b4\u8dcc\u7684\u90e8\u95e8\uff0c\u5c31\u662f\u6700\u4f9d\u8d56\u201c\u81ea\u52a8\u5496\u5561\u673a\u201d\uff08\u786c\u4ef6\u9884\u53d6\uff09\u7684\u90e8\u95e8\u3002\u4ed6\u4eec\u5c31\u662f\u4f60\u4e0b\u4e00\u6b65\u8981\u91cd\u70b9\u5e2e\u6276\u7684\u5bf9\u8c61\u2014\u2014\u7ed9\u4ed6\u4eec\u6bcf\u4e2a\u4eba\u914d\u4e00\u4e2a\u79c1\u4eba\u52a9\u7406\uff0c\u7cbe\u51c6\u5730\u5728\u4ed6\u4eec\u9700\u8981\u65f6\u9001\u4e0a\u5496\u5561\uff08targeted software prefetching\uff09\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u53bb\u6a21\u62df\u6216\u9884\u6d4b workload \u884c\u4e3a\uff0c\u800c\u662f\u8fdb\u884c\u4e86\u4e00\u6b21\u53f2\u65e0\u524d\u4f8b\u7684\u5927\u89c4\u6a21 \u786c\u4ef6\u6d88\u878d\u5b9e\u9a8c (hardware ablation study)\u3002</li> <li>\u5177\u4f53\u64cd\u4f5c\u5c31\u662f\uff1a\u5728\u6570\u5341\u4e07\u53f0\u751f\u4ea7\u673a\u5668\u4e0a\uff0c\u771f\u7684\u628a hardware prefetchers \u7ed9\u5173\u6389\u3002</li> <li>\u7136\u540e\uff0c\u5229\u7528 Google \u5f3a\u5927\u7684 fleetwide profiling infrastructure\uff0c\u4ee5\u524d\u6240\u672a\u6709\u7684\u7c92\u5ea6\uff08\u51fd\u6570\u7ea7\u522b\uff09\u53bb\u6d4b\u91cf\u8fd9\u6b21\u201c\u5173\u505c\u201d\u5e26\u6765\u7684\u5f71\u54cd\u3002</li> <li>\u901a\u8fc7\u5bf9\u6bd4\u5b9e\u9a8c\u7ec4\uff08prefetchers off\uff09\u548c\u5bf9\u7167\u7ec4\uff08prefetchers on\uff09\u7684\u6027\u80fd\u6570\u636e\uff0c\u4ed6\u4eec\u80fd\u7cbe\u786e\u5730\u5b9a\u4f4d\u5230\uff1a</li> <li>\u54ea\u4e9b\u51fd\u6570\u5728\u786c\u4ef6\u9884\u53d6\u5173\u95ed\u540e\uff0cLLC MPKI \u6025\u5267\u4e0a\u5347\u3002</li> <li>\u54ea\u4e9b\u51fd\u6570\u56e0\u6b64\u6d88\u8017\u4e86\u66f4\u591a\u7684 CPU cycles\u3002</li> <li>\u8fd9\u4e9b\u201c\u53d7\u4f24\u6700\u91cd\u201d\u7684\u51fd\u6570\uff0c\u5c31\u662f\u6240\u8c13\u7684 data center tax functions\uff08\u5982 memcpy, compression, hashing \u7b49\uff09\uff0c\u5b83\u4eec\u88ab\u8bc1\u660e\u662f\u9ad8\u5ea6\u53ef\u9884\u53d6 (prefetch-friendly) \u7684\uff0c\u5e76\u4e14\u662f\u8f6f\u4ef6\u9884\u53d6\u7684\u6700\u4f73\u76ee\u6807\u3002</li> <li>\u8fd9\u4e2a\u65b9\u6cd5\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u628a\u4e00\u4e2a\u201c\u9884\u6d4b\u95ee\u9898\u201d\uff08predict where to prefetch\uff09\u8f6c\u5316\u6210\u4e86\u4e00\u4e2a\u201c\u89c2\u6d4b\u95ee\u9898\u201d\uff08observe what breaks when you remove prefetching\uff09\u3002\u89c2\u6d4b\u7ed3\u679c\u76f4\u63a5\u3001\u53ef\u9760\uff0c\u5e76\u4e14\u5929\u7136\u5177\u5907 fleet-wide \u7684\u4ee3\u8868\u6027\u3002</li> </ul> <p></p> <p>Figure 10. Application throughput based on different Hard Limoncello configurations. ?? /?? indicates the lower (?? %) and upper (?? %) memory bandwidth thresholds in the configuration. Thresholds are expressed as a percentage of memory bandwidth saturation.</p> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/ELI5_notes/#4-eli5","title":"4. \u8f6f\u4ef6\u9884\u53d6\u53c2\u6570\u8c03\u4f18\uff08\u5730\u5740\u3001\u8ddd\u79bb\u3001\u5ea6\uff09 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <ul> <li>\u4f20\u7edf\u7684 \u8f6f\u4ef6\u9884\u53d6\uff08Software Prefetching\uff09 \u8c03\u4f18\u662f\u4e2a\u201c\u76f2\u4eba\u6478\u8c61\u201d\u7684\u8fc7\u7a0b\u3002\u4f60\u4e0d\u77e5\u9053\u8be5\u5728\u4ee3\u7801\u54ea\u4e00\u884c\u63d2 prefetch \u6307\u4ee4\uff0c\u8be5\u63d0\u524d\u591a\u8fdc\uff08prefetch distance\uff09\uff0c\u53c8\u8be5\u4e00\u6b21\u62c9\u591a\u5c11\u6570\u636e\uff08prefetch degree\uff09\u3002</li> <li>\u5728\u5355\u673a\u6216\u5c0f\u89c4\u6a21\u573a\u666f\u4e0b\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u9760\u7ecf\u9a8c\u3001\u5fae\u57fa\u51c6\u6d4b\u8bd5\u751a\u81f3\u731c\u6765\u8c03\u53c2\u3002\u4f46\u5728\u50cf Google \u8fd9\u6837\u7684\u8d85\u5927\u89c4\u6a21\u6570\u636e\u4e2d\u5fc3\u91cc\uff0c\u5de5\u4f5c\u8d1f\u8f7d\u5343\u5947\u767e\u602a\uff0c\u8f93\u5165\u6570\u636e\u5206\u5e03\u6781\u5e7f\uff0c\u8fd9\u79cd\u201c\u624b\u5de5\u8c03\u53c2\u201d\u65b9\u5f0f\u5b8c\u5168\u4e0d\u53ef\u6269\u5c55\uff0c\u4e14\u6781\u6613\u8fc7\u62df\u5408\u5230\u67d0\u4e2a\u7279\u5b9a benchmark\u3002</li> <li>\u66f4\u8981\u547d\u7684\u662f\uff0c\u5982\u679c\u53c2\u6570\u6ca1\u8c03\u597d\uff0c\u8f6f\u4ef6\u9884\u53d6\u4e0d\u4ec5\u6ca1\u7528\uff0c\u53cd\u800c\u6709\u5bb3\uff1a\u5b83\u4f1a\u6d6a\u8d39\u5b9d\u8d35\u7684 CPU \u5468\u671f\u53bb\u6267\u884c\u65e0\u7528\u7684 prefetch \u6307\u4ee4\uff0c\u5e76\u4ea7\u751f\u989d\u5916\u7684\u3001\u4e0d\u5fc5\u8981\u7684 memory bandwidth \u6d41\u91cf\uff0c\u5728\u672c\u5c31\u7d27\u5f20\u7684\u5e26\u5bbd\u73af\u5883\u4e0b\u96ea\u4e0a\u52a0\u971c\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9</p> <ul> <li>\u8fd9\u5c31\u50cf\u4e00\u4e2a\u5feb\u9012\u8c03\u5ea6\u4e2d\u5fc3\uff0c\u9700\u8981\u4e3a\u5373\u5c06\u5230\u6765\u7684\u6d77\u91cf\u8ba2\u5355\u63d0\u524d\u628a\u8d27\u7269\u4ece\u4ed3\u5e93\u6df1\u5904\u642c\u5230\u5206\u62e3\u533a\u3002</li> <li>\u9884\u53d6\u5730\u5740 \u5c31\u662f\u4f60\u8981\u642c\u54ea\u4e2a\u8d27\u67b6\u4e0a\u7684\u8d27\u3002</li> <li>\u9884\u53d6\u8ddd\u79bb \u5c31\u662f\u4f60\u770b\u5230\u8ba2\u5355\u540e\uff0c\u8981\u63d0\u524d\u591a\u4e45\u5f00\u59cb\u642c\uff08\u592a\u65e9\uff0c\u8d27\u653e\u5206\u62e3\u533a\u592a\u4e45\u5360\u5730\u65b9\uff1b\u592a\u665a\uff0c\u8ba2\u5355\u6765\u4e86\u8d27\u8fd8\u6ca1\u5230\uff09\u3002</li> <li>\u9884\u53d6\u5ea6 \u5c31\u662f\u4f60\u4e00\u6b21\u642c\u591a\u5c11\u4ef6\uff08\u642c\u592a\u5c11\uff0c\u6765\u56de\u8dd1\u817f\u7d2f\u6b7b\uff1b\u642c\u592a\u591a\uff0c\u53ef\u80fd\u5f88\u591a\u8d27\u6839\u672c\u6ca1\u4eba\u8ba2\uff0c\u7eaf\u5c5e\u6d6a\u8d39\u529b\u6c14\uff09\u3002</li> <li>Limoncello \u7684\u505a\u6cd5\u4e0d\u662f\u9760\u8c03\u5ea6\u5458\u4e2a\u4eba\u7ecf\u9a8c\uff0c\u800c\u662f\u5206\u6790\u4e86\u6574\u4e2a\u57ce\u5e02\u8fc7\u53bb\u4e00\u5e74\u6240\u6709\u8ba2\u5355\u7684\u5386\u53f2\u6570\u636e\uff08\u5373 fleetwide profiling\uff09\uff0c\u7cbe\u51c6\u5730\u77e5\u9053\u54ea\u4e9b\u5546\u54c1\uff08memcpy \u7b49 data center tax functions\uff09\u7ecf\u5e38\u88ab\u5927\u91cf\u8ba2\u8d2d\uff0c\u4ee5\u53ca\u5b83\u4eec\u7684\u5178\u578b\u8ba2\u5355\u5927\u5c0f\uff08argument size distribution\uff09\u3002\u6709\u4e86\u8fd9\u4e2a\u5168\u5c40\u89c6\u91ce\uff0c\u5c31\u80fd\u79d1\u5b66\u5730\u5236\u5b9a\u642c\u8fd0\u7b56\u7565\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u51ed\u7a7a\u731c\u6d4b\u6216\u4f9d\u8d56\u4e0d\u5177\u4ee3\u8868\u6027\u7684 microbenchmarks\uff0c\u800c\u662f\u6784\u5efa\u4e86\u4e00\u4e2a\u6570\u636e\u9a71\u52a8\u7684\u95ed\u73af\u8c03\u4f18\u6d41\u7a0b\uff1a</p> <ul> <li>\u7b2c\u4e00\u6b65\uff1a\u5229\u7528\u786c\u4ef6\u6d88\u878d\u5b9e\u9a8c\u5b9a\u4f4d\u201c\u75db\u70b9\u51fd\u6570\u201d\u3002</li> <li>\u901a\u8fc7\u5728\u771f\u5b9e\u751f\u4ea7\u73af\u5883\u4e2d\u5927\u89c4\u6a21\u5173\u95ed hardware prefetchers\uff0c\u5e76\u5229\u7528\u5168\u5c40\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u7cbe\u786e\u8bc6\u522b\u51fa\u54ea\u4e9b\u51fd\u6570\uff08\u5982 memcpy, compression\uff09\u5728\u7f3a\u5931\u786c\u4ef6\u9884\u53d6\u540e\u6027\u80fd\u66b4\u8dcc\uff08\u8868\u73b0\u4e3a LLC MPKI \u548c CPU cycles \u5927\u5e45\u589e\u52a0\uff09\u3002</li> <li> <p>\u8fd9\u4e9b\u51fd\u6570\u5c31\u662f\u503c\u5f97\u6295\u5165\u7cbe\u529b\u8fdb\u884c\u8f6f\u4ef6\u9884\u53d6\u4f18\u5316\u7684\u9ad8\u4ef7\u503c\u76ee\u6807\u3002</p> </li> <li> <p>\u7b2c\u4e8c\u6b65\uff1a\u7528\u771f\u5b9e\u4e16\u754c\u7684\u6570\u636e\u6307\u5bfc\u53c2\u6570\u641c\u7d22\u7a7a\u95f4\u3002</p> </li> <li>\u5bf9\u4e8e\u50cf <code>memcpy</code> \u8fd9\u6837\u7684\u76ee\u6807\u51fd\u6570\uff0c\u4ed6\u4eec\u6ca1\u6709\u5bf9\u6240\u6709\u8c03\u7528\u4e00\u89c6\u540c\u4ec1\u3002\u901a\u8fc7\u5206\u6790 fleetwide profiling \u6570\u636e\uff0c\u53d1\u73b0\u5927\u591a\u6570\u8c03\u7528\u662f\u5c0f\u5c3a\u5bf8\u7684\uff0c\u4f46\u6027\u80fd\u56de\u9000\u4e3b\u8981\u6765\u81ea\u5927\u5c3a\u5bf8\u7684 memcpy \u8c03\u7528\u3002</li> <li>\u56e0\u6b64\uff0c\u4ed6\u4eec\u5c06\u8f6f\u4ef6\u9884\u53d6\u7684\u4f18\u5316\u91cd\u70b9\u805a\u7126\u5728\u5927\u5c3a\u5bf8\u8c03\u7528\u4e0a\uff0c\u8fd9\u6781\u5927\u5730\u7f29\u5c0f\u4e86\u9700\u8981\u8c03\u4f18\u7684\u573a\u666f\u8303\u56f4\uff0c\u4f7f\u4f18\u5316\u66f4\u6709\u9488\u5bf9\u6027\u3002</li> </ul> <p></p> <p>Figure 14. memcpy argument size distribution. The chart shows the probability density function (PDF) of the number of times each copy size appears in the profiling data. Most copy sizes are small.</p> <ul> <li>\u7b2c\u4e09\u6b65\uff1a\u5728\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u5fae\u57fa\u51c6\u4e0a\u8fdb\u884c\u7cfb\u7edf\u6027\u53c2\u6570\u626b\u63cf\u3002</li> <li>\u4ed6\u4eec\u4f7f\u7528\u80fd\u53cd\u6620\u771f\u5b9e fleet \u884c\u4e3a\u7684\u5fae\u57fa\u51c6\uff08\u5982 Fleetbench, LLVM libc benchmarks\uff09\u3002</li> <li>\u5728\u8fd9\u4e9b\u57fa\u51c6\u4e0a\uff0c\u56fa\u5b9a\u5176\u4ed6\u53d8\u91cf\uff0c\u53ea\u6539\u53d8\u4e00\u4e2a\u53c2\u6570\uff08\u4f8b\u5982\uff0c\u56fa\u5b9a prefetch degree \u4e3a 256 bytes\uff0c\u626b\u63cf\u4e0d\u540c\u7684 prefetch distance\uff09\uff0c\u89c2\u5bdf\u6027\u80fd\u53d8\u5316\u3002</li> </ul> <p></p> <ul> <li>\u901a\u8fc7\u8fd9\u79cd\u201c\u63a7\u5236\u53d8\u91cf\u6cd5\u201d\uff0c\u4ed6\u4eec\u80fd\u6e05\u6670\u5730\u627e\u5230\u6bcf\u4e2a\u53c2\u6570\u7ef4\u5ea6\u4e0a\u7684\u6700\u4f18\u503c\u6216\u6700\u4f18\u533a\u95f4\uff0c\u800c\u4e0d\u662f\u5728\u4e09\u7ef4\u53c2\u6570\u7a7a\u95f4\u91cc\u76f2\u76ee\u4e71\u649e\u3002</li> </ul> <p></p> <p>(b) Microbenchmark exercising different prefetch degrees. Prefetching is fixed at a distance of 512 bytes.</p> <ul> <li>\u7b2c\u56db\u6b65\uff1a\u56de\u5f52\u9a8c\u8bc1\uff0c\u786e\u4fdd\u771f\u5b9e\u6536\u76ca\u3002</li> <li>\u627e\u5230\u7406\u8bba\u4e0a\u7684\u6700\u4f18\u53c2\u6570\u7ec4\u5408\u540e\uff0c\u5fc5\u987b\u56de\u5230\u66f4\u590d\u6742\u7684 load tests \u4e2d\u8fdb\u884c\u9a8c\u8bc1\uff0c\u786e\u4fdd\u5728\u63a5\u8fd1\u771f\u5b9e\u751f\u4ea7\u73af\u5883\u7684\u538b\u529b\u4e0b\uff0c\u8fd9\u4e9b\u9884\u53d6\u6307\u4ee4\u4f9d\u7136\u80fd\u5e26\u6765\u51c0\u6027\u80fd\u6536\u76ca\uff0c\u800c\u4e0d\u662f\u5728\u7b80\u5355 microbenchmark \u4e0a\u7684\u201c\u865a\u5047\u7e41\u8363\u201d\u3002</li> </ul> <p>\u8fd9\u4e2a\u6d41\u7a0b\u7684\u7cbe\u9ad3\u5728\u4e8e\uff0c\u5b83\u7528\u771f\u5b9e\u3001\u5927\u89c4\u6a21\u7684\u751f\u4ea7\u6570\u636e\u66ff\u6362\u4e86\u4f20\u7edf\u8f6f\u4ef6\u9884\u53d6\u4e2d\u5145\u6ee1\u4e0d\u786e\u5b9a\u6027\u7684\u201c\u731c\u6d4b\u201d\u548c\u201c\u5047\u8bbe\u201d\uff0c\u5c06\u4e00\u4e2a\u6a21\u7cca\u7684\u5de5\u7a0b\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u4e00\u4e2a\u53ef\u91cf\u5316\u3001\u53ef\u9a8c\u8bc1\u7684\u6570\u636e\u79d1\u5b66\u95ee\u9898\u3002</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/","title":"Limoncello: Prefetchers for Scale \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-1-average-load-to-use-latency-per-dram-request-reduces-by-15-when-hardware-prefetchers-are-disabled-data-is-gathered-using-the-intel-mlc-tool-10","title":"Figure 1. Average load-to-use latency per DRAM request reduces by 15% when hardware prefetchers are disabled. Data is gathered using the Intel MLC tool [10].","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u5728\u4e0d\u540c Memory Bandwidth Utilization (%) \u6c34\u5e73\u4e0b\uff0cLoad-to-Use Latency (ns) \u7684\u53d8\u5316\u8d8b\u52bf\uff0c\u5bf9\u6bd4\u4e86 HW prefetcher on\uff08\u84dd\u8272\u7ebf\uff09\u4e0e HW prefetcher off\uff08\u7eff\u8272\u7ebf\uff09\u4e24\u79cd\u72b6\u6001\u3002</li> <li>\u968f\u7740\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u4ece 0% \u4e0a\u5347\u81f3 100%\uff0c\u4e24\u6761\u66f2\u7ebf\u5747\u5448\u4e0a\u5347\u8d8b\u52bf\uff0c\u8868\u660e\u7cfb\u7edf\u8d1f\u8f7d\u8d8a\u9ad8\uff0c\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\u8d8a\u5927\u3002</li> <li>\u5728\u4f4e\u5e26\u5bbd\u5229\u7528\u7387\u533a\u95f4\uff08&lt;40%\uff09\uff0c\u4e24\u6761\u66f2\u7ebf\u51e0\u4e4e\u91cd\u5408\uff0c\u8bf4\u660e\u6b64\u65f6\u786c\u4ef6\u9884\u53d6\u5668\u5bf9\u5ef6\u8fdf\u5f71\u54cd\u5fae\u4e4e\u5176\u5fae\u3002</li> <li>\u5f53\u5e26\u5bbd\u5229\u7528\u7387\u8d85\u8fc7 60% \u540e\uff0cHW prefetcher on \u66f2\u7ebf\u5f00\u59cb\u663e\u8457\u9ad8\u4e8e HW prefetcher off \u66f2\u7ebf\uff0c\u5c24\u5176\u5728 80%\u2013100% \u533a\u95f4\uff0c\u5dee\u8ddd\u6025\u5267\u6269\u5927\uff0c\u6700\u9ad8\u65f6\u5dee\u63a5\u8fd1 50 ns\u3002</li> <li>\u6839\u636e\u56fe\u6ce8\uff0c\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u53ef\u4f7f\u5e73\u5747 DRAM \u8bf7\u6c42\u7684 Load-to-Use Latency \u964d\u4f4e 15%\uff0c\u8fd9\u4e00\u6536\u76ca\u5728\u9ad8\u8d1f\u8f7d\u573a\u666f\u5c24\u4e3a\u660e\u663e\u3002</li> <li>\u6570\u636e\u91c7\u96c6\u5de5\u5177\u4e3a Intel MLC tool\uff0c\u786e\u4fdd\u6d4b\u91cf\u7ed3\u679c\u5177\u5907\u786c\u4ef6\u7ea7\u7cbe\u5ea6\u548c\u4ee3\u8868\u6027\u3002</li> <li>\u5173\u952e\u7ed3\u8bba\uff1a\u5728\u8d44\u6e90\u53d7\u9650\u3001\u9ad8\u5229\u7528\u7387\u7684\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e2d\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u53cd\u800c\u52a0\u5267\u5185\u5b58\u5ef6\u8fdf\uff0c\u56e0\u5176\u5f15\u5165\u989d\u5916\u7684\u5185\u5b58\u8bf7\u6c42\u6d41\u91cf\uff0c\u5bfc\u81f4\u6392\u961f\u5ef6\u8fdf\u589e\u52a0\u548c\u5e26\u5bbd\u4e89\u7528\u3002</li> </ul> Memory Bandwidth Utilization (%) HW Prefetcher On (ns) HW Prefetcher Off (ns) Latency Reduction (%) 0 ~120 ~120 0 50 ~170 ~160 ~6 80 ~200 ~180 ~10 90 ~300 ~260 ~13 100 ~390 ~340 ~15 <ul> <li>\u6b64\u56fe\u662f\u8bba\u6587\u6838\u5fc3\u52a8\u673a\u7684\u53ef\u89c6\u5316\u652f\u6491\uff1a\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u8bbe\u8ba1\u672a\u8003\u8651\u6570\u636e\u4e2d\u5fc3\u9ad8\u5e76\u53d1\u3001\u9ad8\u5e26\u5bbd\u538b\u529b\u573a\u666f\uff0c\u5bfc\u81f4\u201c\u8d8a\u9884\u53d6\uff0c\u8d8a\u6162\u201d\u7684\u53cd\u76f4\u89c9\u73b0\u8c61\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-2-memory-bandwidth-per-core-has-plateaued-over-several-generations-of-server-cpus","title":"Figure 2. Memory bandwidth per core has plateaued over several generations of server CPUs.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u4ece2010\u5e74\u81f32022\u5e74\u671f\u95f4\uff0c\u670d\u52a1\u5668CPU\u4ee3\u9645\u6f14\u8fdb\u4e2d\u5185\u5b58\u5e26\u5bbd\uff08membw\uff09\u4e0e\u6bcf\u6838\u5fc3\u5185\u5b58\u5e26\u5bbd\uff08membw per core\uff09\u7684\u589e\u957f\u8d8b\u52bf\u3002</li> <li>\u84dd\u8272\u66f2\u7ebf\u4ee3\u8868\u603b\u5185\u5b58\u5e26\u5bbd\uff08membw\uff09\uff0c\u5448\u73b0\u6301\u7eed\u4e0a\u5347\u8d8b\u52bf\uff0c\u5c24\u5176\u57282014\u5e74\u540e\u589e\u957f\u52a0\u901f\uff0c\u81f32022\u5e74\u8fbe\u5230\u7ea612\u500d\u589e\u957f\u3002</li> <li>\u7eff\u8272\u66f2\u7ebf\u4ee3\u8868\u6bcf\u6838\u5fc3\u5185\u5b58\u5e26\u5bbd\uff08membw per core\uff09\uff0c\u57282010\u81f32014\u5e74\u95f4\u7565\u6709\u6ce2\u52a8\uff0c\u4e4b\u540e\u8d8b\u4e8e\u5e73\u7a33\uff0c\u57fa\u672c\u7ef4\u6301\u57281\u500d\u5de6\u53f3\u6c34\u5e73\uff0c\u8868\u660e\u6bcf\u6838\u5fc3\u53ef\u7528\u5e26\u5bbd\u5df2\u8fdb\u5165\u5e73\u53f0\u671f\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u5370\u8bc1\u4e86\u8bba\u6587\u7b2c2.1\u8282\u6240\u8ff0\uff1a\u5c3d\u7ba1\u670d\u52a1\u5668\u6838\u5fc3\u6570\u6301\u7eed\u589e\u52a0\uff0c\u4f46\u53d7\u7269\u7406\u5f15\u811a\u6570\u91cf\u9650\u5236\uff0c\u6bcf\u6838\u5fc3\u5185\u5b58\u5e26\u5bbd\u5e76\u672a\u540c\u6b65\u63d0\u5347\uff0c\u6210\u4e3a\u7cfb\u7edf\u6027\u80fd\u74f6\u9888\u3002</li> <li>\u6570\u636e\u5bf9\u6bd4\u663e\u793a\uff0c\u603b\u5e26\u5bbd\u589e\u957f\u4e3b\u8981\u6e90\u4e8e\u591a\u6838\u96c6\u6210\uff0c\u800c\u975e\u5355\u6838\u5e26\u5bbd\u63d0\u5347\uff0c\u51f8\u663e\u6570\u636e\u4e2d\u5fc3\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\u9762\u4e34\u7684\u5185\u5b58\u5e26\u5bbd\u8d44\u6e90\u7a00\u7f3a\u6027\u3002</li> </ul> \u5e74\u4efd \u603b\u5185\u5b58\u5e26\u5bbd\u589e\u957f (membw) \u6bcf\u6838\u5fc3\u5185\u5b58\u5e26\u5bbd\u589e\u957f (membw per core) 2010 ~1x ~1x 2012 ~1.5x ~1x 2014 ~2x ~0.8x 2016 ~5x ~1x 2018 ~7x ~1x 2020 ~8x ~1x 2022 ~12x ~1x <ul> <li>\u6b64\u8d8b\u52bf\u4e3aLimoncello\u7cfb\u7edf\u8bbe\u8ba1\u63d0\u4f9b\u5173\u952e\u80cc\u666f\uff1a\u5728\u5e26\u5bbd\u53d7\u9650\u73af\u5883\u4e0b\uff0c\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u56e0\u52a0\u5267\u5e26\u5bbd\u7ade\u4e89\u800c\u964d\u4f4e\u6548\u7387\uff0c\u9700\u8f6c\u5411\u66f4\u7cbe\u7ec6\u7684\u8f6f\u786c\u4ef6\u534f\u540c\u9884\u53d6\u7b56\u7565\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-3-average-memory-bandwidth-usage-of-fleet-workloads-has-increased-over-the-last-4-years-each-point-in-the-graph-shows-memory-bandwidth-usage-per-compute-unit-averaged-across-all-workloads-in-the-fleet","title":"Figure 3. Average memory bandwidth usage of fleet workloads has increased over the last 4 years. Each point in the graph shows memory bandwidth usage per compute unit averaged across all workloads in the fleet.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 3\uff0c\u5c55\u793a\u7684\u662f Google \u6570\u636e\u4e2d\u5fc3\u96c6\u7fa4\uff08fleet\uff09\u4e2d\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5e73\u5747\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u60c5\u51b5\uff0c\u65f6\u95f4\u8de8\u5ea6\u4e3a\u8fc7\u53bb\u56db\u5e74\u3002</li> <li>\u7eb5\u8f74\u5355\u4f4d\u4e3a MB/s per compute unit\uff0c\u6a2a\u8f74\u4e3a\u5e74\u4efd\uff0c\u4ece 2020 \u5e74\u81f3 2023 \u5e74\u3002</li> <li>\u6570\u636e\u70b9\u4ee5\u7eff\u8272\u5706\u70b9\u6807\u8bb0\uff0c\u8fde\u63a5\u6210\u4e00\u6761\u4e0a\u5347\u8d8b\u52bf\u7ebf\uff0c\u8868\u660e\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u91cf\u5448\u6301\u7eed\u589e\u957f\u6001\u52bf\u3002</li> <li>\u5177\u4f53\u6570\u503c\u5982\u4e0b\uff1a</li> </ul> \u5e74\u4efd \u5185\u5b58\u5e26\u5bbd (MB/s per compute unit) 2020 ~520 2021 ~610 2022 ~670 2023 ~680 <ul> <li>\u4ece 2020 \u5230 2023 \u5e74\uff0c\u5e73\u5747\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u91cf\u589e\u957f\u7ea6 1.4 \u500d\uff0c\u5e74\u5747\u589e\u957f\u7387\u7ea6\u4e3a 10%\u3002</li> <li>\u56fe\u8868\u8bf4\u660e\u6307\u51fa\uff0c\u8be5\u6570\u636e\u662f\u6309\u201ccompute unit\u201d\u6807\u51c6\u5316\u540e\u7684\u7ed3\u679c\uff0c\u8be5\u5355\u4f4d\u62bd\u8c61\u4e86\u7269\u7406 CPU \u6838\u5fc3\uff0c\u4ee3\u8868\u8de8\u5e73\u53f0\u4e00\u81f4\u7684\u8ba1\u7b97\u80fd\u529b\u3002</li> <li>\u6b64\u8d8b\u52bf\u53cd\u6620\u4e86\u5de5\u4f5c\u8d1f\u8f7d\u65e5\u76ca\u6570\u636e\u5bc6\u96c6\u5316\uff0c\u5bf9\u5185\u5b58\u5e26\u5bbd\u7684\u9700\u6c42\u6301\u7eed\u6500\u5347\uff0c\u4e0e\u8bba\u6587\u4e2d\u201cmemory bandwidth is a scarce resource\u201d\u7684\u6838\u5fc3\u8bba\u70b9\u76f8\u547c\u5e94\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-4-memory-bandwidth-can-saturate-with-just-50-cpu-utilization-in-a-bandwidth-bound-platform-sizes-of-the-markers-are-in-proportion-to-the-number-of-platform-servers-in-the-cpu-usage-bucket","title":"Figure 4. Memory bandwidth can saturate with just 50% CPU utilization in a bandwidth-bound platform. Sizes of the markers are in proportion to the number of platform servers in the CPU usage bucket.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u4e24\u4e2a\u670d\u52a1\u5668\u5e73\u53f0\uff08platform 1 \u548c platform 2\uff09\u5728\u4e0d\u540c CPU \u5229\u7528\u7387\u533a\u95f4\u4e0b\u7684 \u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u7387 \u53d8\u5316\u8d8b\u52bf\uff0c\u63ed\u793a\u4e86\u6570\u636e\u4e2d\u5fc3\u4e2d\u5185\u5b58\u5e26\u5bbd\u74f6\u9888\u5bf9 CPU \u5229\u7528\u7387\u7684\u5236\u7ea6\u3002</li> <li>\u6a2a\u8f74\u4e3a CPU \u4f7f\u7528\u7387\u533a\u95f4\uff08CPU Usage Bucket %\uff09\uff0c\u4ece 0-10% \u5230 100-110%\uff0c\u6bcf\u4e2a\u533a\u95f4\u4ee3\u8868\u4e00\u4e2a\u8d1f\u8f7d\u6bb5\uff1b\u7eb5\u8f74\u4e3a\u5e73\u5747\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u7387\u767e\u5206\u6bd4\uff08Memory Bandwidth Usage %\uff09\u3002</li> <li>\u4e24\u6761\u66f2\u7ebf\u5206\u522b\u5bf9\u5e94\u4e24\u4e2a\u5e73\u53f0\uff1a\u7eff\u8272\u5706\u70b9\u7ebf\u4ee3\u8868 platform 1\uff0c\u7eff\u8272\u65b9\u5757\u7ebf\u4ee3\u8868 platform 2\u3002\u4e24\u8005\u8d8b\u52bf\u76f8\u4f3c\uff0c\u5747\u5728 CPU \u5229\u7528\u7387\u7ea6 50% \u65f6\u8fbe\u5230\u5185\u5b58\u5e26\u5bbd\u9971\u548c\u70b9\u3002</li> <li>\u56fe\u4e2d\u6709\u4e00\u6761\u6c34\u5e73\u84dd\u8272\u865a\u7ebf\u6807\u6ce8 \u201cmemory bandwidth saturation\u201d\uff0c\u8868\u793a\u5e73\u53f0\u5185\u5b58\u5e26\u5bbd\u5bb9\u91cf\u4e0a\u9650\u3002\u5f53\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u7387\u8fbe\u5230\u8be5\u7ebf\u65f6\uff0c\u7cfb\u7edf\u6027\u80fd\u5c06\u6025\u5267\u4e0b\u964d\u3002</li> <li>\u5728 CPU \u5229\u7528\u7387\u4f4e\u4e8e 50% \u65f6\uff0c\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u7387\u968f CPU \u5229\u7528\u7387\u4e0a\u5347\u800c\u5feb\u901f\u589e\u52a0\uff1b\u8d85\u8fc7 50% \u540e\uff0c\u66f2\u7ebf\u8d8b\u4e8e\u5e73\u7f13\u751a\u81f3\u7565\u6709\u4e0b\u964d\uff0c\u8868\u660e\u7cfb\u7edf\u5df2\u53d7\u5185\u5b58\u5e26\u5bbd\u9650\u5236\uff0c\u65e0\u6cd5\u8fdb\u4e00\u6b65\u63d0\u5347\u541e\u5410\u3002</li> <li>\u56fe\u4e2d\u8fd8\u6709\u4e00\u6761\u5782\u76f4\u9ec4\u8272\u865a\u7ebf\u6807\u8bb0 \u201ctarget CPU usage\u201d\uff0c\u4f4d\u4e8e 70-80% \u533a\u95f4\uff0c\u8fd9\u662f Google \u6570\u636e\u4e2d\u5fc3\u671f\u671b\u7684\u6700\u4f18 CPU \u5229\u7528\u7387\u76ee\u6807\u3002\u7136\u800c\uff0c\u6b64\u65f6\u5185\u5b58\u5e26\u5bbd\u65e9\u5df2\u9971\u548c\uff0c\u5bfc\u81f4\u5b9e\u9645\u5229\u7528\u7387\u65e0\u6cd5\u8fbe\u5230\u76ee\u6807\u3002</li> <li>\u56fe\u4e2d\u6570\u636e\u70b9\u5927\u5c0f\u4e0e\u5bf9\u5e94 CPU \u4f7f\u7528\u7387\u533a\u95f4\u7684\u670d\u52a1\u5668\u6570\u91cf\u6210\u6b63\u6bd4\uff0c\u8bf4\u660e\u9ad8\u5229\u7528\u7387\u533a\u95f4\uff08\u5982 60-70%\uff09\u7684\u670d\u52a1\u5668\u57fa\u6570\u8f83\u5927\uff0c\u4f46\u53d7\u9650\u4e8e\u5185\u5b58\u5e26\u5bbd\uff0c\u5176\u6027\u80fd\u6f5c\u529b\u672a\u88ab\u5b8c\u5168\u91ca\u653e\u3002</li> <li>\u5173\u952e\u7ed3\u8bba\uff1a\u5728\u5e26\u5bbd\u53d7\u9650\u7684\u5e73\u53f0\u4e0a\uff0c\u5185\u5b58\u5e26\u5bbd\u53ef\u80fd\u5728 CPU \u5229\u7528\u7387\u4ec5\u8fbe 50% \u65f6\u5373\u5df2\u9971\u548c\uff0c\u4ece\u800c\u963b\u6b62\u670d\u52a1\u5668\u8fbe\u5230\u7406\u60f3\u7684 70-80% \u5229\u7528\u7387\u76ee\u6807\uff0c\u9020\u6210\u5927\u91cf CPU \u8d44\u6e90\u95f2\u7f6e\u3002</li> </ul> CPU Usage Bucket (%) Platform 1 Memory BW Usage (%) Platform 2 Memory BW Usage (%) 0-10 ~5 ~5 10-20 ~35 ~30 20-30 ~55 ~45 30-40 ~65 ~55 40-50 ~75 ~65 50-60 ~80 ~70 60-70 ~80 ~70 70-80 ~75 ~65 80-90 ~60 ~55 90-100 ~35 ~30 100-110 ~20 ~20 <ul> <li>\u6b64\u56fe\u662f Limoncello \u7cfb\u7edf\u8bbe\u8ba1\u7684\u6838\u5fc3\u52a8\u673a\u4e4b\u4e00\uff1a\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u5728\u9ad8\u5e26\u5bbd\u538b\u529b\u4e0b\u52a0\u5267\u62e5\u5835\uff0c\u800c Limoncello \u901a\u8fc7\u52a8\u6001\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5e76\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\uff0c\u6709\u6548\u964d\u4f4e\u5185\u5b58\u5e26\u5bbd\u5360\u7528\uff0c\u4f7f\u7cfb\u7edf\u80fd\u5728\u66f4\u9ad8 CPU \u5229\u7528\u7387\u4e0b\u7ef4\u6301\u6027\u80fd\uff0c\u7a81\u7834\u201c\u5185\u5b58\u5e26\u5bbd\u5899\u201d\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#table-1-disabling-hardware-prefetchers-reduces-both-average-and-tail-memory-bandwidth","title":"Table 1. Disabling hardware prefetchers reduces both average and tail memory bandwidth.","text":"<ul> <li>Table 1 \u5c55\u793a\u4e86\u5728 Google \u6570\u636e\u4e2d\u5fc3\u96c6\u7fa4\u4e2d\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\uff08hardware prefetchers\uff09\u5bf9\u5185\u5b58\u5e26\u5bbd\u7684\u524a\u51cf\u6548\u679c\uff0c\u6570\u636e\u6309\u5e73\u53f0\uff08Platform 1 \u548c Platform 2\uff09\u548c\u7edf\u8ba1\u7ef4\u5ea6\uff08Average, P99, Peak\uff09\u5206\u7c7b\u3002</li> <li>\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\u663e\u8457\u964d\u4f4e\u4e86\u5e73\u5747\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u91cf\uff1aPlatform 1 \u4e0b\u964d 15.7%\uff0cPlatform 2 \u4e0b\u964d 11.2%\uff0c\u8868\u660e\u786c\u4ef6\u9884\u53d6\u5668\u662f\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u7684\u4e3b\u8981\u6765\u6e90\u3002</li> <li>\u5728\u5c3e\u90e8\u5ef6\u8fdf\uff08P99\uff09\u573a\u666f\u4e0b\uff0cPlatform 1 \u7684\u5185\u5b58\u5e26\u5bbd\u51cf\u5c11 10.4%\uff0c\u800c Platform 2 \u4ec5\u51cf\u5c11 2.8%\uff0c\u8bf4\u660e\u4e0d\u540c\u5e73\u53f0\u5bf9\u9884\u53d6\u5668\u7684\u4f9d\u8d56\u7a0b\u5ea6\u5b58\u5728\u5dee\u5f02\u3002</li> <li>\u5cf0\u503c\uff08Peak\uff09\u5185\u5b58\u5e26\u5bbd\u65b9\u9762\uff0cPlatform 1 \u51cf\u5c11 5.6%\uff0cPlatform 2 \u51cf\u5c11 5.5%\uff0c\u663e\u793a\u5373\u4f7f\u5728\u6781\u7aef\u8d1f\u8f7d\u4e0b\uff0c\u7981\u7528\u9884\u53d6\u5668\u4ecd\u80fd\u6709\u6548\u91ca\u653e\u5e26\u5bbd\u8d44\u6e90\u3002</li> <li>\u7efc\u5408\u6765\u770b\uff0c\u8be5\u8868\u652f\u6301\u8bba\u6587\u6838\u5fc3\u89c2\u70b9\uff1a\u5728\u9ad8\u5229\u7528\u7387\u7cfb\u7edf\u4e2d\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u4f1a\u52a0\u5267\u5185\u5b58\u5e26\u5bbd\u538b\u529b\uff0c\u7981\u7528\u5b83\u4eec\u53ef\u4f18\u5316\u7cfb\u7edf\u6027\u80fd\u3002</li> </ul> Memory Bandwidth Reduction Platform 1 Platform 2 Average 15.7% 11.2% P99 10.4% 2.8% Peak 5.6% 5.5%"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-5-memory-bandwidth-usage-on-spec-with-and-without-hardware-prefetching-over-3-generations-of-a-server-platform-we-see-a-30-40-increase-in-memory-bandwidth-usage-when-hardware-prefetching-is-enabled","title":"Figure 5. Memory bandwidth usage on SPEC with and without hardware prefetching over 3 generations of a server platform. We see a 30-40% increase in memory bandwidth usage when hardware prefetching is enabled.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u5728\u4e09\u6b3e\u4e0d\u540c\u4ee3\u9645\u7684\u670d\u52a1\u5668\u5e73\u53f0\u4e0a\uff0c\u542f\u7528\u4e0e\u7981\u7528 hardware prefetcher \u5bf9 SPEC \u5de5\u4f5c\u8d1f\u8f7d\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u7684\u5f71\u54cd\u3002</li> <li>\u7eb5\u5750\u6807\u5de6\u4fa7\u4e3a Memory Bandwidth Usage (MB/s per core)\uff0c\u53f3\u4fa7\u4e3a Prefetch Traffic (%)\uff0c\u6a2a\u5750\u6807\u4e3a Server Generation\uff081\u30012\u30013 \u4ee3\uff09\u3002</li> <li>\u84dd\u8272\u67f1\u72b6\u56fe \u8868\u793a\u542f\u7528\u786c\u4ef6\u9884\u53d6\u65f6\u7684\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u91cf\uff0c\u7eff\u8272\u67f1\u72b6\u56fe \u8868\u793a\u7981\u7528\u786c\u4ef6\u9884\u53d6\u65f6\u7684\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u91cf\uff0c\u7ea2\u8272\u865a\u7ebf\u6298\u7ebf\u56fe \u8868\u793a\u9884\u53d6\u6d41\u91cf\u5360\u6bd4\u3002</li> <li>\u6570\u636e\u663e\u793a\uff0c\u542f\u7528\u786c\u4ef6\u9884\u53d6\u540e\uff0c\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u91cf\u663e\u8457\u4e0a\u5347\uff0c\u9884\u53d6\u6d41\u91cf\u5360\u6bd4\u5728 30% \u81f3 40% \u4e4b\u95f4\u6ce2\u52a8\uff0c\u4e14\u968f\u5e73\u53f0\u4ee3\u9645\u6f14\u8fdb\u5448\u4e0a\u5347\u8d8b\u52bf\u3002</li> <li>\u5177\u4f53\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> Server Generation Prefetcher On (MB/s/core) Prefetcher Off (MB/s/core) Prefetch Traffic (%) 1 ~550 ~400 ~38 2 ~300 ~220 ~30 3 ~320 ~210 ~40 <ul> <li>\u7ed3\u8bba\uff1a\u786c\u4ef6\u9884\u53d6\u5668\u5728\u63d0\u5347\u7f13\u5b58\u547d\u4e2d\u7387\u7684\u540c\u65f6\uff0c\u5e26\u6765\u4e86\u663e\u8457\u7684\u5185\u5b58\u5e26\u5bbd\u5f00\u9500\uff0c\u5c24\u5176\u5728\u65b0\u4e00\u4ee3\u670d\u52a1\u5668\u4e0a\uff0c\u5176\u9884\u53d6\u6d41\u91cf\u5360\u6bd4\u5df2\u9ad8\u8fbe 40%\uff0c\u52a0\u5267\u4e86\u5e26\u5bbd\u7ade\u4e89\u538b\u529b\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-6-limoncello-disables-hardware-prefetchers-when-memory-bandwidth-utilization-is-high-to-optimize-for-memory-latency","title":"Figure 6. Limoncello disables hardware prefetchers when memory bandwidth utilization is high to optimize for memory latency.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 6\uff0c\u660e\u786e\u6307\u51fa Limoncello \u5728\u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u65f6\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\uff08HW prefetcher\uff09\uff0c\u4ee5\u4f18\u5316\u5185\u5b58\u5ef6\u8fdf\u3002</li> <li>\u6a2a\u8f74\u4e3a Memory Bandwidth Utilization (%)\uff0c\u8303\u56f4\u4ece 0% \u5230 100%\uff0c\u8868\u793a\u7cfb\u7edf\u5f53\u524d\u5185\u5b58\u5e26\u5bbd\u7684\u4f7f\u7528\u6bd4\u4f8b\u3002</li> <li>\u7eb5\u8f74\u4e3a Latency (ns)\uff0c\u5355\u4f4d\u7eb3\u79d2\uff0c\u8861\u91cf\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\uff0c\u6570\u503c\u8d8a\u4f4e\u4ee3\u8868\u6027\u80fd\u8d8a\u597d\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u4e24\u6761\u66f2\u7ebf\uff1a</li> <li>\u84dd\u8272\u7ebf\uff08HW prefetcher on\uff09\uff1a\u786c\u4ef6\u9884\u53d6\u5668\u5f00\u542f\u65f6\u7684\u5ef6\u8fdf\u8868\u73b0\u3002\u5728\u4f4e\u5e26\u5bbd\u5229\u7528\u7387\u4e0b\u5ef6\u8fdf\u8f83\u4f4e\uff0c\u4f46\u968f\u7740\u5229\u7528\u7387\u4e0a\u5347\uff0c\u5ef6\u8fdf\u6025\u5267\u589e\u52a0\uff0c\u5728\u63a5\u8fd1 100% \u65f6\u5ef6\u8fdf\u8d85\u8fc7 350 ns\u3002</li> <li>\u7eff\u8272\u7ebf\uff08HW prefetcher off\uff09\uff1a\u786c\u4ef6\u9884\u53d6\u5668\u5173\u95ed\u65f6\u7684\u5ef6\u8fdf\u8868\u73b0\u3002\u6574\u4f53\u5ef6\u8fdf\u663e\u8457\u4f4e\u4e8e\u5f00\u542f\u72b6\u6001\uff0c\u5c24\u5176\u5728\u9ad8\u5229\u7528\u7387\u533a\u95f4\uff08&gt;60%\uff09\u4f18\u52bf\u660e\u663e\uff0c\u6700\u9ad8\u5ef6\u8fdf\u7ea6 320 ns\u3002</li> <li>\u56fe\u8868\u9876\u90e8\u6807\u6ce8\u4e86\u4e24\u4e2a\u4f18\u5316\u76ee\u6807\u533a\u57df\uff1a</li> <li>\u5de6\u4fa7\u6d45\u84dd\u8272\u533a\u57df\u6807\u6ce8 optimized for cache hit rate\uff0c\u5bf9\u5e94\u4f4e\u5e26\u5bbd\u5229\u7528\u7387\u573a\u666f\uff0c\u6b64\u65f6\u542f\u7528\u786c\u4ef6\u9884\u53d6\u5668\u53ef\u63d0\u5347\u7f13\u5b58\u547d\u4e2d\u7387\u3002</li> <li>\u53f3\u4fa7\u6d45\u7eff\u8272\u533a\u57df\u6807\u6ce8 optimized for latency\uff0c\u5bf9\u5e94\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\u573a\u666f\uff0c\u6b64\u65f6\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u53ef\u964d\u4f4e\u5ef6\u8fdf\u3002</li> <li>Limoncello \u7684\u6838\u5fc3\u7b56\u7565\u4f53\u73b0\u5728\u8be5\u56fe\u4e2d\uff1a\u52a8\u6001\u5207\u6362\u786c\u4ef6\u9884\u53d6\u5668\u72b6\u6001\u2014\u2014\u5728\u4f4e\u8d1f\u8f7d\u65f6\u542f\u7528\u4ee5\u4f18\u5316\u547d\u4e2d\u7387\uff0c\u5728\u9ad8\u8d1f\u8f7d\u65f6\u7981\u7528\u4ee5\u4f18\u5316\u5ef6\u8fdf\u3002</li> <li>\u6570\u636e\u5bf9\u6bd4\u663e\u793a\uff0c\u5728 80% \u4ee5\u4e0a\u5e26\u5bbd\u5229\u7528\u7387\u65f6\uff0c\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u53ef\u5e26\u6765\u7ea6 15% \u7684\u5ef6\u8fdf\u964d\u4f4e\uff0c\u4e0e\u8bba\u6587\u6458\u8981\u4e2d\u63d0\u5230\u7684\u201c15% reduction in memory latency\u201d\u4e00\u81f4\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u9a8c\u8bc1\u4e86\u8bba\u6587\u7684\u6838\u5fc3\u89c2\u70b9\uff1a\u5728\u8d44\u6e90\u53d7\u9650\u7684\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e2d\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u5728\u9ad8\u5e26\u5bbd\u538b\u529b\u4e0b\u53cd\u800c\u6210\u4e3a\u6027\u80fd\u74f6\u9888\uff0c\u901a\u8fc7\u8f6f\u4ef6\u63a7\u5236\u52a8\u6001\u7981\u7528\u53ef\u91ca\u653e\u5e26\u5bbd\u3001\u964d\u4f4e\u5ef6\u8fdf\u3002</li> </ul> \u5e26\u5bbd\u5229\u7528\u7387\u533a\u95f4 HW Prefetcher \u72b6\u6001 \u5ef6\u8fdf\u8d8b\u52bf \u4f18\u5316\u76ee\u6807 0% \u2013 60% \u5f00\u542f \u7f13\u6162\u4e0a\u5347 Cache Hit Rate &gt;60% \u5173\u95ed \u663e\u8457\u4f4e\u4e8e\u5f00\u542f\u6001 Memory Latency <ul> <li>\u6b64\u56fe\u662f Limoncello \u52a8\u6001\u8c03\u63a7\u673a\u5236\u7684\u53ef\u89c6\u5316\u4f53\u73b0\uff0c\u652f\u6491\u5176\u201c\u8f6f\u786c\u534f\u540c\u201d\u7684\u8bbe\u8ba1\u54f2\u5b66\uff0c\u65e0\u9700\u786c\u4ef6\u4fee\u6539\u5373\u53ef\u5b9e\u73b0\u6027\u80fd\u4f18\u5316\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-7-memory-bandwidth-variability-in-a-machine","title":"Figure 7. Memory bandwidth variability in a machine.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5355\u53f0\u673a\u5668\u572860\u5206\u949f\u5185Memory Bandwidth (GB/s) \u7684\u6ce2\u52a8\u60c5\u51b5\uff0c\u6570\u636e\u91c7\u6837\u9891\u7387\u4e3a\u6bcf\u5206\u949f\u4e00\u6b21\u3002</li> <li>\u7eb5\u8f74\u8303\u56f4\u4ece80 GB/s\u5230150 GB/s\uff0c\u6a2a\u8f74\u4e3a\u65f6\u95f4\uff08\u5206\u949f\uff09\uff0c\u6574\u4f53\u5448\u73b0\u9ad8\u5ea6\u6ce2\u52a8\u6027\uff0c\u65e0\u660e\u663e\u5468\u671f\u6027\u6216\u8d8b\u52bf\u3002</li> <li>\u5cf0\u503c\u51fa\u73b0\u5728\u7ea6\u7b2c12\u5206\u949f\uff0c\u8fbe\u5230150 GB/s\uff1b\u8c37\u503c\u51fa\u73b0\u5728\u7ea6\u7b2c17\u5206\u949f\u548c\u7b2c55\u5206\u949f\uff0c\u63a5\u8fd175 GB/s\u3002</li> <li>\u6ce2\u52a8\u5e45\u5ea6\u5927\uff0c\u76f8\u90bb\u65f6\u95f4\u70b9\u95f4\u5e26\u5bbd\u53d8\u5316\u53ef\u8fbe30\u201350 GB/s\uff0c\u8868\u660e\u5185\u5b58\u5e26\u5bbd\u8d1f\u8f7d\u6781\u4e0d\u7a33\u5b9a\u3002</li> <li>\u8be5\u56fe\u7528\u4e8e\u8bf4\u660eHard Limoncello\u63a7\u5236\u5668\u8bbe\u8ba1\u4e2d\u5f15\u5165hysteresis\u673a\u5236\u7684\u5fc5\u8981\u6027\u2014\u2014\u907f\u514d\u56e0\u77ac\u65f6\u6ce2\u52a8\u9891\u7e41\u5f00\u5173\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u5bfc\u81f4\u7cfb\u7edf\u6027\u80fd\u4e0d\u7a33\u5b9a\u3002</li> <li>\u6570\u636e\u6765\u6e90\u4e3aGoogle\u6570\u636e\u4e2d\u5fc3\u771f\u5b9e\u751f\u4ea7\u73af\u5883\uff0c\u53cd\u6620\u5927\u89c4\u6a21\u670d\u52a1\u6df7\u5408\u8c03\u5ea6\u4e0b\u7684\u5178\u578b\u5185\u5b58\u884c\u4e3a\u3002</li> </ul> \u65f6\u95f4\u533a\u95f4 (min) \u5e26\u5bbd\u6ce2\u52a8\u7279\u5f81 \u5bf9\u5e94\u7cfb\u7edf\u5f71\u54cd 0\u201310 \u4e2d\u7b49\u6ce2\u52a8\uff0c\u5cf0\u503c\u7ea6120 GB/s \u8d1f\u8f7d\u9002\u4e2d\uff0c\u9884\u53d6\u5668\u53ef\u4fdd\u6301\u5f00\u542f 10\u201320 \u9ad8\u5cf0\u4e0e\u6df1\u8c37\u4ea4\u66ff \u6613\u89e6\u53d1\u8bef\u5207\u6362\uff0c\u9700\u6ede\u540e\u9608\u503c\u63a7\u5236 20\u201340 \u591a\u6b21\u5267\u70c8\u9707\u8361 \u63a7\u5236\u5668\u9700\u7ef4\u6301\u72b6\u6001\u7a33\u5b9a\u4ee5\u907f\u514d\u6296\u52a8 40\u201360 \u6301\u7eed\u6ce2\u52a8\uff0c\u672b\u6bb5\u7565\u6709\u56de\u5347 \u8868\u660e\u8d1f\u8f7d\u52a8\u6001\u53d8\u5316\u662f\u5e38\u6001 <ul> <li>\u5173\u952e\u7ed3\u8bba\uff1a\u5185\u5b58\u5e26\u5bbd\u4f5c\u4e3a\u51b3\u7b56\u4fe1\u53f7\u5177\u6709\u9ad8\u566a\u58f0\u7279\u6027\uff0c\u5fc5\u987b\u7ed3\u5408\u65f6\u95f4\u6301\u7eed\u6027\u5224\u65ad\u4e0e\u4e0a\u4e0b\u9608\u503c\u5dee\u624d\u80fd\u5b9e\u73b0\u7a33\u5b9a\u3001\u9ad8\u6548\u7684\u9884\u53d6\u5668\u8c03\u63a7\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-8-state-diagram-of-hard-limoncello-controller-for-modulating-hardware-prefetchers-green-lighter-indicates-hardware-prefetchers-are-off-blue-darker-that-they-are-on","title":"Figure 8. State diagram of Hard Limoncello controller for modulating hardware prefetchers. Green (lighter) indicates hardware prefetchers are off, blue (darker) that they are on.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u7684\u662f Hard Limoncello \u63a7\u5236\u5668\u7684\u72b6\u6001\u673a\u56fe\uff0c\u7528\u4e8e\u52a8\u6001\u8c03\u8282\u786c\u4ef6\u9884\u53d6\u5668\uff08Hardware Prefetchers, PF\uff09\u7684\u542f\u7528\u4e0e\u7981\u7528\u3002</li> <li>\u72b6\u6001\u673a\u5305\u542b\u4e09\u4e2a\u6838\u5fc3\u72b6\u6001\uff1aPF = enabled\uff08\u84dd\u8272\uff09\u3001PF = disabled\uff08\u7eff\u8272\uff09\u3001\u4ee5\u53ca\u4e00\u4e2a\u4e2d\u95f4\u8fc7\u6e21\u72b6\u6001 PF = disabled timeout = 0\uff08\u7eff\u8272\uff09\uff0c\u7528\u4e8e\u5b9e\u73b0\u6ede\u540e\u63a7\u5236\uff08hysteresis\uff09\u3002</li> <li>\u6240\u6709\u72b6\u6001\u8f6c\u6362\u5747\u57fa\u4e8e\u4e24\u4e2a\u5173\u952e\u53d8\u91cf\uff1a</li> <li>membw\uff1a\u5f53\u524d socket \u7684\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u3002</li> <li>timeout\uff1a\u8ba1\u65f6\u5668\uff0c\u7528\u4e8e\u786e\u4fdd\u72b6\u6001\u5207\u6362\u524d\u9700\u7ef4\u6301\u6761\u4ef6\u8fbe\u4e00\u5b9a\u65f6\u957f\uff08\u0394\uff09\u3002</li> <li>\u56fe\u4e2d\u5b9a\u4e49\u4e86\u4e09\u4e2a\u9608\u503c\u53c2\u6570\uff1a</li> <li>LT\uff1aLower Threshold\uff08\u4e0b\u9650\u9608\u503c\uff09</li> <li>UT\uff1aUpper Threshold\uff08\u4e0a\u9650\u9608\u503c\uff09</li> <li>\u0394\uff1aTime Threshold\uff08\u65f6\u95f4\u9608\u503c\uff09</li> </ul> \u5f53\u524d\u72b6\u6001 \u89e6\u53d1\u6761\u4ef6 \u4e0b\u4e00\u72b6\u6001 \u52a8\u4f5c\u8bf4\u660e PF = enabled (\u521d\u59cb/\u91cd\u542f) membw &lt; UT \u4e14 timeout &gt; 0 \u4fdd\u6301 enabled \u7ef4\u6301\u9884\u53d6\u5668\u5f00\u542f\uff0c\u82e5\u5e26\u5bbd\u672a\u8d85\u9650\u4e14\u5df2\u8fc7\u51b7\u5374\u671f PF = enabled membw &gt; UT \u4e14 timeout = 0 PF = disabled \u5e26\u5bbd\u9996\u6b21\u8d85\u8fc7\u4e0a\u9650\uff0c\u542f\u52a8\u7981\u7528\u6d41\u7a0b PF = enabled membw &gt; UT \u4e14 timeout &gt; 0 \u4fdd\u6301 enabled \u8d85\u9650\u4f46\u672a\u8fbe\u6301\u7eed\u65f6\u95f4 \u0394\uff0c\u6682\u4e0d\u5207\u6362 PF = disabled membw &lt; LT \u4e14 timeout = 0 PF = enabled \u5e26\u5bbd\u56de\u843d\u81f3\u4e0b\u9650\u4ee5\u4e0b\uff0c\u7acb\u5373\u542f\u7528\u9884\u53d6\u5668 PF = disabled membw &lt; LT \u4e14 timeout &gt; 0 \u4fdd\u6301 disabled \u4f4e\u4e8e\u4e0b\u9650\u4f46\u672a\u8fbe\u6301\u7eed\u65f6\u95f4 \u0394\uff0c\u6682\u4e0d\u542f\u7528 PF = disabled membw &gt; LT \u4e14 timeout = 0 PF = disabled timeout = 0 \u8fdb\u5165\u8fc7\u6e21\u6001\uff0c\u51c6\u5907\u91cd\u65b0\u8bc4\u4f30\u662f\u5426\u6062\u590d PF = disabled timeout = 0 membw &lt; LT \u4e14 timeout \u2192 0 PF = enabled \u6ee1\u8db3\u6062\u590d\u6761\u4ef6\uff0c\u7acb\u5373\u542f\u7528\u9884\u53d6\u5668 PF = disabled timeout = 0 membw &gt; LT \u4e14 timeout \u2192 0 \u4fdd\u6301\u8be5\u72b6\u6001 \u7ee7\u7eed\u7b49\u5f85\uff0c\u4e0d\u89e6\u53d1\u72b6\u6001\u53d8\u66f4 <ul> <li>\u989c\u8272\u8bed\u4e49\uff1a</li> <li>\u84dd\u8272\uff08\u6df1\u8272\uff09\uff1a\u8868\u793a\u786c\u4ef6\u9884\u53d6\u5668\u5904\u4e8e enabled \u72b6\u6001\u3002</li> <li>\u7eff\u8272\uff08\u6d45\u8272\uff09\uff1a\u8868\u793a\u786c\u4ef6\u9884\u53d6\u5668\u5904\u4e8e disabled \u72b6\u6001\u3002</li> <li>\u8bbe\u8ba1\u76ee\u7684\uff1a</li> <li>\u907f\u514d\u56e0\u5185\u5b58\u5e26\u5bbd\u77ac\u65f6\u6ce2\u52a8\u5bfc\u81f4\u9884\u53d6\u5668\u9891\u7e41\u5f00\u5173\uff0c\u4ece\u800c\u5f15\u53d1\u6027\u80fd\u4e0d\u7a33\u5b9a\u3002</li> <li>\u901a\u8fc7\u8bbe\u7f6e UT &gt; LT \u548c \u0394 &gt; 0 \u5b9e\u73b0\u6ede\u540e\u63a7\u5236\uff0c\u786e\u4fdd\u7cfb\u7edf\u5728\u9ad8\u8d1f\u8f7d\u65f6\u7a33\u5b9a\u7981\u7528\u9884\u53d6\u5668\uff0c\u5728\u4f4e\u8d1f\u8f7d\u65f6\u7a33\u5b9a\u542f\u7528\u3002</li> <li>\u5b9e\u9645\u884c\u4e3a\u793a\u4f8b\uff1a</li> <li>\u82e5\u673a\u5668\u521a\u542f\u52a8\u6216\u91cd\u542f\uff0c\u9884\u53d6\u5668\u9ed8\u8ba4\u4e3a enabled\u3002</li> <li>\u5f53 membw \u6301\u7eed\u9ad8\u4e8e UT \u8fbe\u5230 \u0394 \u65f6\u95f4\u540e\uff0c\u63a7\u5236\u5668\u5c06 PF \u7981\u7528\u3002</li> <li>\u53ea\u6709\u5f53 membw \u6301\u7eed\u4f4e\u4e8e LT \u8fbe\u5230 \u0394 \u65f6\u95f4\u540e\uff0c\u63a7\u5236\u5668\u624d\u4f1a \u91cd\u65b0\u542f\u7528 PF\u3002</li> <li>\u5728\u7981\u7528\u72b6\u6001\u4e0b\uff0c\u82e5 membw \u56de\u843d\u81f3 LT \u4ee5\u4e0b\u4f46\u672a\u6301\u7eed\u8db3\u591f\u65f6\u95f4\uff0c\u7cfb\u7edf\u4f1a\u8fdb\u5165 PF = disabled timeout = 0 \u72b6\u6001\uff0c\u7b49\u5f85\u8fdb\u4e00\u6b65\u786e\u8ba4\u3002</li> </ul> <p>\u8be5\u72b6\u6001\u673a\u662f Limoncello \u7cfb\u7edf\u5b9e\u73b0\u201c\u6309\u9700\u542f\u505c\u786c\u4ef6\u9884\u53d6\u5668\u201d\u7684\u6838\u5fc3\u673a\u5236\uff0c\u786e\u4fdd\u5728\u9ad8\u5185\u5b58\u5e26\u5bbd\u538b\u529b\u4e0b\u4f18\u5316\u5ef6\u8fdf\uff0c\u540c\u65f6\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u6296\u52a8\u3002</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-9-hardware-prefetcher-state-over-time-the-green-lines-in-the-figure-show-when-hardware-prefetchers-are-disabled-when-machine-load-exceeds-an-upper-threshold-hardware-prefetchers-are-disabled-and-remain-disabled-until-machine-load-returns-below-a-lower-threshold","title":"Figure 9. Hardware prefetcher state over time. The green lines in the figure show when hardware prefetchers are disabled. When machine load exceeds an upper threshold, hardware prefetchers are disabled and remain disabled until machine load returns below a lower threshold.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 Hardware Prefetcher \u5728\u4e0d\u540c\u65f6\u95f4\u70b9\u7684\u542f\u7528\u4e0e\u7981\u7528\u72b6\u6001\uff0c\u4ee5\u53ca Memory Bandwidth Utilization (%) \u7684\u6ce2\u52a8\u60c5\u51b5\u3002</li> <li>\u7eff\u8272\u5b9e\u7ebf \u4ee3\u8868\u786c\u4ef6\u9884\u53d6\u5668\u5173\u95ed\uff08HW prefetcher off\uff09\uff0c\u84dd\u8272\u5b9e\u7ebf \u4ee3\u8868\u786c\u4ef6\u9884\u53d6\u5668\u5f00\u542f\uff08HW prefetcher on\uff09\u3002</li> <li>\u7ea2\u8272\u865a\u7ebf \u6807\u6ce8\u4e86\u4e24\u4e2a\u5173\u952e\u9608\u503c\uff1aupper threshold\uff0880%\uff09\u548c lower threshold\uff0860%\uff09\uff0c\u7528\u4e8e\u63a7\u5236\u9884\u53d6\u5668\u7684\u5f00\u5173\u903b\u8f91\u3002</li> <li>\u7cfb\u7edf\u91c7\u7528 \u6ede\u56de\u63a7\u5236\u673a\u5236\uff08hysteresis\uff09\uff1a\u53ea\u6709\u5f53\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u6301\u7eed\u9ad8\u4e8e upper threshold \u65f6\u624d\u5173\u95ed\u9884\u53d6\u5668\uff1b\u53ea\u6709\u5f53\u5176\u6301\u7eed\u4f4e\u4e8e lower threshold \u65f6\u624d\u91cd\u65b0\u5f00\u542f\u3002</li> <li>\u65f6\u95f4\u8f74\u4ece 0 \u5230 25\uff0c\u89c2\u5bdf\u5230\u591a\u6b21\u89e6\u53d1\u5207\u6362\uff1a</li> <li>\u5728 t=0 \u9644\u8fd1\uff0c\u5e26\u5bbd\u5229\u7528\u7387\u8d85\u8fc7 80%\uff0c\u89e6\u53d1\u9884\u53d6\u5668\u5173\u95ed\uff08\u7eff\u7ebf\uff09\u3002</li> <li>\u5c3d\u7ba1\u5728 t=7.5 \u65f6\u5e26\u5bbd\u56de\u843d\u81f3 80% \u4ee5\u4e0b\uff0c\u4f46\u672a\u8dcc\u7834 60%\uff0c\u56e0\u6b64\u9884\u53d6\u5668\u4fdd\u6301\u5173\u95ed\u3002</li> <li>\u76f4\u5230 t=10 \u5de6\u53f3\uff0c\u5e26\u5bbd\u6301\u7eed\u4f4e\u4e8e 60%\uff0c\u7cfb\u7edf\u624d\u91cd\u65b0\u542f\u7528\u9884\u53d6\u5668\uff08\u84dd\u7ebf\uff09\u3002</li> <li>\u5728 t=20 \u4e4b\u540e\uff0c\u5e26\u5bbd\u518d\u6b21\u98d9\u5347\u5e76\u7a81\u7834 80%\uff0c\u9884\u53d6\u5668\u518d\u6b21\u88ab\u7981\u7528\u3002</li> <li>\u6b64\u8bbe\u8ba1\u907f\u514d\u4e86\u56e0\u77ed\u65f6\u6ce2\u52a8\u5bfc\u81f4\u7684\u9891\u7e41\u5f00\u5173\uff0c\u4ece\u800c\u63d0\u5347\u7cfb\u7edf\u7a33\u5b9a\u6027\u4e0e\u6027\u80fd\u4e00\u81f4\u6027\u3002</li> <li>\u5173\u952e\u53c2\u6570\u603b\u7ed3\u5982\u4e0b\uff1a</li> </ul> \u53c2\u6570 \u503c \u8bf4\u660e Upper Threshold 80% \u89e6\u53d1\u5173\u95ed\u9884\u53d6\u5668\u7684\u5e26\u5bbd\u5229\u7528\u7387\u4e0a\u9650 Lower Threshold 60% \u89e6\u53d1\u5f00\u542f\u9884\u53d6\u5668\u7684\u5e26\u5bbd\u5229\u7528\u7387\u4e0b\u9650 \u63a7\u5236\u7b56\u7565 \u6ede\u56de\u63a7\u5236 \u907f\u514d\u9707\u8361\uff0c\u786e\u4fdd\u72b6\u6001\u7a33\u5b9a <ul> <li>\u8be5\u56fe\u76f4\u89c2\u4f53\u73b0\u4e86 Hard Limoncello \u7684\u52a8\u6001\u8c03\u63a7\u80fd\u529b\uff0c\u662f\u5b9e\u73b0\u201c\u9ad8\u5e26\u5bbd\u65f6\u964d\u5ef6\u8fdf\u3001\u4f4e\u5e26\u5bbd\u65f6\u4fdd\u547d\u4e2d\u7387\u201d\u6838\u5fc3\u76ee\u6807\u7684\u5173\u952e\u673a\u5236\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-10-application-throughput-based-on-different-hard-limoncello-configurations-indicates-the-lower-and-upper-memory-bandwidth-thresholds-in-the-configuration-thresholds-are-expressed-as-a-percentage-of-memory-bandwidth-saturation","title":"Figure 10. Application throughput based on different Hard Limoncello configurations. ?? /?? indicates the lower (?? %) and upper (?? %) memory bandwidth thresholds in the configuration. Thresholds are expressed as a percentage of memory bandwidth saturation.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Hard Limoncello \u5728\u4e0d\u540c\u914d\u7f6e\u4e0b\u5bf9\u5e94\u7528\u541e\u5410\u91cf\u7684\u5f71\u54cd\uff0c\u6a2a\u8f74\u4e3a\u914d\u7f6e\u53c2\u6570\uff08\u8868\u793a\u5185\u5b58\u5e26\u5bbd\u9971\u548c\u9608\u503c\u7684\u767e\u5206\u6bd4\uff09\uff0c\u7eb5\u8f74\u4e3a\u5e94\u7528\u541e\u5410\u91cf\u63d0\u5347\u767e\u5206\u6bd4\u3002</li> <li>\u914d\u7f6e\u53c2\u6570\u683c\u5f0f\u4e3a\u201c\u4e0b\u9650/\u4e0a\u9650\u201d\uff0c\u4f8b\u5982\u201c60/80\u201d\u8868\u793a\u5f53\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u8d85\u8fc780%\u65f6\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u4f4e\u4e8e60%\u65f6\u91cd\u65b0\u542f\u7528\u3002</li> <li>\u4ece\u67f1\u72b6\u56fe\u53ef\u89c1\uff0c60/80\u914d\u7f6e\u5e26\u6765\u6700\u9ad8\u541e\u5410\u91cf\u63d0\u5347\uff0c\u7ea6\u4e3a 3.0%\uff0c\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u914d\u7f6e\u3002</li> <li>50/70\u914d\u7f6e\u6b21\u4e4b\uff0c\u541e\u5410\u91cf\u63d0\u5347\u7ea6 1.0%\uff1b70/90\u914d\u7f6e\u6700\u4f4e\uff0c\u4ec5\u7ea6 0.9%\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u4e2d\u7b49\u504f\u7d27\u7684\u9608\u503c\u8bbe\u7f6e\uff08\u598260/80\uff09\u80fd\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\uff0c\u8fc7\u677e\uff0870/90\uff09\u6216\u8fc7\u7d27\uff0850/70\uff09\u5747\u5bfc\u81f4\u6536\u76ca\u4e0b\u964d\u3002</li> <li>\u6b64\u7ed3\u679c\u652f\u6491\u4e86\u8bba\u6587\u4e2d\u5173\u4e8e\u901a\u8fc7\u52a8\u6001\u8c03\u8282\u786c\u4ef6\u9884\u53d6\u5668\u5f00\u5173\u65f6\u673a\u4ee5\u4f18\u5316\u7cfb\u7edf\u6027\u80fd\u7684\u6838\u5fc3\u8bbe\u8ba1\u3002</li> </ul> \u914d\u7f6e \u5e94\u7528\u541e\u5410\u91cf\u63d0\u5347 (%) 60/80 3.0 50/70 1.0 70/90 0.9"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-11-change-in-cpu-cycles-from-hard-limoncello-functions-that-regress-in-performance-when-hardware-prefetchers-are-disabled-show-an-increase-in-cpu-cycles-green-and-an-increase-in-llc-mpki-blue-data-center-tax-functions-in-particular-show-performance-regressions-from-disabling-hardware-prefetchers-while-other-functions-tend-to-improve-in-performance-and-decrease-in-cycles-and-mpki","title":"Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 11\uff0c\u5c55\u793a\u7684\u662f\u5728 Hard Limoncello \u90e8\u7f72\u540e\uff0c\u4e0d\u540c\u51fd\u6570\u7c7b\u578b\u5728 CPU cycles (%) \u548c LLC misses (%) \u4e0a\u7684\u53d8\u5316\u60c5\u51b5\u3002</li> <li>\u7eff\u8272\u67f1\u72b6\u56fe\u4ee3\u8868 CPU cycles \u589e\u52a0\u767e\u5206\u6bd4\uff0c\u84dd\u8272\u67f1\u72b6\u56fe\u4ee3\u8868 LLC misses \u589e\u52a0\u767e\u5206\u6bd4\uff0c\u4e24\u8005\u5747\u4ee5\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\uff08hardware prefetchers disabled\uff09\u4e3a\u57fa\u51c6\u8fdb\u884c\u5bf9\u6bd4\u3002</li> <li>\u6570\u636e\u4e2d\u2f3c\u7a0e\u51fd\u6570\uff08data center tax functions\uff09 \u5728\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u540e\u8868\u73b0\u51fa\u663e\u8457\u6027\u80fd\u9000\u5316\uff1a</li> <li>hashing_1\u3001hashing_2\u3001compression_1\u3001compression_2\u3001data_movement_1\u3001data_movement_2\u3001data_transmission_1\u3001data_transmission_2 \u5747\u663e\u793a CPU cycles \u548c LLC misses \u663e\u8457\u4e0a\u5347\u3002</li> <li>\u4f8b\u5982\uff0chashing_2 \u7684 CPU cycles \u589e\u52a0\u8d85\u8fc7 150%\uff0cLLC misses \u589e\u52a0\u63a5\u8fd1 300%\u3002</li> <li>\u76f8\u53cd\uff0c\u6807\u8bb0\u4e3a other_1 \u81f3 other_10 \u7684\u51fd\u6570\u5927\u591a\u5448\u73b0\u8d1f\u589e\u957f\uff0c\u8868\u660e\u8fd9\u4e9b\u51fd\u6570\u5728\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u540e\u6027\u80fd\u53cd\u800c\u63d0\u5347\uff0cCPU cycles \u548c LLC misses \u4e0b\u964d\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u6570\u636e\u4e2d\u2f3c\u7a0e\u51fd\u6570\u5bf9\u786c\u4ef6\u9884\u53d6\u5668\u9ad8\u5ea6\u4f9d\u8d56\uff0c\u5176\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff08\u5982\u8fde\u7eed\u5757\u8bbf\u95ee\u3001\u53ef\u9884\u6d4b\u5e8f\u5217\uff09\u6613\u88ab\u786c\u4ef6\u9884\u53d6\u5668\u6709\u6548\u6355\u6349\uff1b\u800c\u5176\u4ed6\u51fd\u6570\u53ef\u80fd\u56e0\u9884\u53d6\u4e0d\u51c6\u786e\u6216\u6c61\u67d3\u7f13\u5b58\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\uff0c\u5173\u95ed\u9884\u53d6\u5668\u53cd\u800c\u6709\u76ca\u3002</li> <li>\u56fe\u8868\u4e0b\u65b9\u56fe\u4f8b\u660e\u786e\u533a\u5206\u4e86\u7eff\u8272\uff08CPU cycles\uff09\u4e0e\u84dd\u8272\uff08LLC misses\uff09\uff0c\u4fbf\u4e8e\u5feb\u901f\u8bc6\u522b\u6027\u80fd\u5f71\u54cd\u7ef4\u5ea6\u3002</li> </ul> \u51fd\u6570\u7c7b\u578b CPU Cycles \u589e\u957f\u8d8b\u52bf LLC Misses \u589e\u957f\u8d8b\u52bf \u662f\u5426\u5c5e\u4e8e data center tax hashing_1 \u2191\u2191\u2191 \u2191\u2191 \u662f hashing_2 \u2191\u2191\u2191\u2191 \u2191\u2191\u2191\u2191 \u662f compression_1 \u2191\u2191\u2191 \u2191\u2191\u2191 \u662f compression_2 \u2191\u2191\u2191 \u2191\u2191\u2191 \u662f data_movement_1 \u2191\u2191 \u2191\u2191 \u662f data_movement_2 \u2191\u2191\u2191 \u2191\u2191\u2191 \u662f data_transmission_1 \u2191\u2191 \u2191\u2191 \u662f data_transmission_2 \u2191\u2191\u2191 \u2191\u2191\u2191 \u662f other_1 \u81f3 other_10 \u2193 \u6216\u5c0f\u5e45 \u2191 \u2193 \u6216\u5c0f\u5e45 \u2191 \u5426 <ul> <li>\u6b64\u5206\u6790\u652f\u6491\u4e86\u8bba\u6587\u6838\u5fc3\u89c2\u70b9\uff1a\u5728\u9ad8\u5e26\u5bbd\u538b\u529b\u4e0b\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u867d\u80fd\u964d\u4f4e\u6574\u4f53\u5ef6\u8fdf\uff0c\u4f46\u4f1a\u635f\u5bb3\u7279\u5b9a\u5173\u952e\u51fd\u6570\u6027\u80fd\uff0c\u9700\u901a\u8fc7 Soft Limoncello \u7684\u8f6f\u4ef6\u9884\u53d6\u8fdb\u884c\u8865\u507f\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-12-aggregated-change-in-cpu-cycles-from-hard-limoncello-data-center-tax-functions-green-increased-in-cpu-cycles-under-hard-limoncello-in-contrast-overall-nondata-center-tax-functions-blue-decreased-in-cycles","title":"Figure 12. Aggregated change in CPU cycles (%) from Hard Limoncello. Data center tax functions (green) increased in CPU cycles under Hard Limoncello. In contrast, overall nondata center tax functions (blue) decreased in cycles.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 12\uff0c\u5c55\u793a\u7684\u662f\u5728 Hard Limoncello \u542f\u7528\u540e\uff0c\u4e0d\u540c\u51fd\u6570\u7c7b\u578b\u5728 CPU \u5468\u671f\u4e0a\u7684\u53d8\u5316\u767e\u5206\u6bd4\u3002</li> <li>\u6a2a\u8f74\u4e3a Function Type\uff0c\u5305\u542b\u4e94\u7c7b\uff1acompression\u3001data transmission\u3001hashing\u3001data movement \u548c non-DC tax\u3002</li> <li>\u7eb5\u8f74\u4e3a Increase in CPU Cycles (%)\uff0c\u8868\u793a CPU \u5468\u671f\u589e\u52a0\u7684\u767e\u5206\u6bd4\uff0c\u8d1f\u503c\u4ee3\u8868\u5468\u671f\u51cf\u5c11\u3002</li> <li>\u6570\u636e\u663e\u793a\uff0c\u5728 Hard Limoncello \u4e0b\uff1a</li> <li>compression \u51fd\u6570\u5bfc\u81f4 CPU \u5468\u671f\u589e\u52a0\u7ea6 30%\uff0c\u662f\u53d7\u5f71\u54cd\u6700\u4e25\u91cd\u7684\u7c7b\u522b\u3002</li> <li>data transmission \u589e\u52a0\u7ea6 21%\u3002</li> <li>hashing \u589e\u52a0\u7ea6 20%\u3002</li> <li>data movement \u589e\u52a0\u7ea6 16%\u3002</li> <li>non-DC tax \u51fd\u6570\u5219\u5448\u73b0\u8f7b\u5fae\u4e0b\u964d\uff08\u7ea6 -1%\uff09\uff0c\u8868\u660e\u5176\u6027\u80fd\u53cd\u800c\u7565\u6709\u63d0\u5347\u3002</li> </ul> Function Type Increase in CPU Cycles (%) compression ~30% data transmission ~21% hashing ~20% data movement ~16% non-DC tax ~-1% <ul> <li>\u56fe\u4f8b\u8bf4\u660e\uff1a\u7eff\u8272\u67f1\u72b6\u56fe\u4ee3\u8868 Data center tax functions\uff0c\u5b83\u4eec\u5728 Hard Limoncello \u4e0b CPU \u5468\u671f\u663e\u8457\u589e\u52a0\uff1b\u84dd\u8272\u67f1\u72b6\u56fe\u4ee3\u8868 non-data center tax functions\uff0c\u6574\u4f53\u5468\u671f\u51cf\u5c11\u3002</li> <li>\u6b64\u7ed3\u679c\u5370\u8bc1\u4e86\u8bba\u6587\u89c2\u70b9\uff1aData center tax functions \u5bf9\u786c\u4ef6\u9884\u53d6\u5668\u9ad8\u5ea6\u4f9d\u8d56\uff0c\u5f53\u9884\u53d6\u5668\u88ab\u7981\u7528\u65f6\uff0c\u8fd9\u4e9b\u51fd\u6570\u6027\u80fd\u9000\u5316\u660e\u663e\uff0c\u56e0\u6b64\u6210\u4e3a Soft Limoncello \u8f6f\u4ef6\u9884\u53d6\u63d2\u5165\u7684\u91cd\u70b9\u76ee\u6807\u3002</li> <li>\u76f8\u53cd\uff0c\u975e\u6570\u636e\u4e2d\u5fc3\u7a0e\u51fd\u6570\u56e0\u907f\u514d\u4e86\u786c\u4ef6\u9884\u53d6\u5e26\u6765\u7684\u5185\u5b58\u5e26\u5bbd\u7ade\u4e89\u548c\u7f13\u5b58\u6c61\u67d3\uff0c\u53cd\u800c\u83b7\u5f97\u6027\u80fd\u589e\u76ca\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-13-software-prefetch-instructions-act-on-addresses-at-a-distance-and-can-prefetch-different-degrees-of-data","title":"Figure 13. Software prefetch instructions act on addresses at a distance and can prefetch different degrees of data.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u8f6f\u4ef6\u9884\u53d6\uff08Software prefetch\uff09\u7684\u6838\u5fc3\u6982\u5ff5\uff0c\u5373\u901a\u8fc7\u6307\u5b9a\u5185\u5b58\u5730\u5740\u3001\u9884\u53d6\u8ddd\u79bb\uff08prefetch distance\uff09\u548c\u9884\u53d6\u5ea6\uff08prefetch degree\uff09\u6765\u63a7\u5236\u6570\u636e\u52a0\u8f7d\u884c\u4e3a\u3002</li> <li>\u5185\u5b58\u8bbf\u95ee\u70b9\u4f4d\u4e8e\u5730\u5740 <code>0x080</code>\uff0c\u7528\u9ec4\u8272\u9ad8\u4eae\u6807\u51fa\uff0c\u8868\u793a\u5f53\u524d\u7a0b\u5e8f\u6b63\u5728\u8bbf\u95ee\u8be5\u4f4d\u7f6e\u7684\u6570\u636e\u3002</li> <li>\u9884\u53d6\u8ddd\u79bb\u6307\u4ece\u5f53\u524d\u8bbf\u95ee\u5730\u5740\u5230\u9884\u53d6\u8d77\u59cb\u5730\u5740\u4e4b\u95f4\u7684\u504f\u79fb\u91cf\u3002\u56fe\u4e2d\u663e\u793a\u9884\u53d6\u4ece <code>0x180</code> \u5f00\u59cb\uff0c\u4e0e <code>0x080</code> \u76f8\u8ddd 4 \u4e2a\u7f13\u5b58\u884c\uff08\u5047\u8bbe\u6bcf\u884c 64 \u5b57\u8282\uff09\uff0c\u5373 prefetch distance = 4 cache lines\u3002</li> <li>\u9884\u53d6\u5ea6\u6307\u4e00\u6b21\u6027\u9884\u53d6\u7684\u6570\u636e\u91cf\uff0c\u56fe\u4e2d\u7eff\u8272\u533a\u57df\u8986\u76d6\u4e86 <code>0x180</code> \u5230 <code>0x200</code>\uff0c\u5171\u5305\u542b 3 \u4e2a\u7f13\u5b58\u884c\uff08<code>0x180</code>, <code>0x1C0</code>, <code>0x200</code>\uff09\uff0c\u5373 prefetch degree = 3 cache lines\u3002</li> <li>\u56fe\u4e2d\u7bad\u5934\u660e\u786e\u6807\u6ce8\u4e86\u4e09\u4e2a\u5173\u952e\u53c2\u6570\uff1a</li> <li>\u201cmemory access\u201d \u6307\u5411\u5f53\u524d\u8bbf\u95ee\u5730\u5740 <code>0x080</code>\u3002</li> <li>\u201cprefetched\u201d \u8986\u76d6\u9884\u53d6\u6570\u636e\u8303\u56f4 <code>0x180\u20130x200</code>\u3002</li> <li>\u201cprefetch distance\u201d \u6807\u6ce8\u4ece <code>0x080</code> \u5230 <code>0x180</code> \u7684\u8de8\u5ea6\u3002</li> <li>\u201cprefetch degree\u201d \u6807\u6ce8\u4ece <code>0x180</code> \u5230 <code>0x200</code> \u7684\u6570\u636e\u91cf\u3002</li> <li>\u6b64\u56fe\u7528\u4e8e\u8bf4\u660e\u5728 Soft Limoncello \u4e2d\uff0c\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\u5982\u4f55\u6839\u636e\u51fd\u6570\u884c\u4e3a\u7cbe\u786e\u63a7\u5236\u9884\u53d6\u65f6\u673a\u4e0e\u6570\u636e\u91cf\uff0c\u907f\u514d\u786c\u4ef6\u9884\u53d6\u5668\u7684\u76f2\u76ee\u6027\u3002</li> </ul> \u53c2\u6570 \u503c \u8bf4\u660e Memory Access 0x080 \u5f53\u524d\u7a0b\u5e8f\u5b9e\u9645\u8bbf\u95ee\u7684\u5185\u5b58\u5730\u5740 Prefetch Start 0x180 \u9884\u53d6\u64cd\u4f5c\u5f00\u59cb\u7684\u5185\u5b58\u5730\u5740 Prefetch Distance 4 cache lines \u4ece\u8bbf\u95ee\u5730\u5740\u5230\u9884\u53d6\u8d77\u59cb\u5730\u5740\u7684\u8ddd\u79bb Prefetch Degree 3 cache lines \u4e00\u6b21\u6027\u9884\u53d6\u7684\u6570\u636e\u5757\u6570\u91cf Prefetched Range 0x180 \u2013 0x200 \u5b9e\u9645\u88ab\u9884\u53d6\u5230\u7f13\u5b58\u4e2d\u7684\u5185\u5b58\u533a\u57df <ul> <li>\u8be5\u8bbe\u8ba1\u5141\u8bb8\u5f00\u53d1\u8005\u6839\u636e\u5177\u4f53\u51fd\u6570\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff08\u5982 memcpy \u7684\u8fde\u7eed\u6d41\u5f0f\u8bbf\u95ee\uff09\u5b9a\u5236\u9884\u53d6\u7b56\u7565\uff0c\u4ece\u800c\u5728\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u65f6\u4ecd\u80fd\u7ef4\u6301\u4f4e MPKI \u548c\u9ad8\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-14-memcpy-argument-size-distribution-the-chart-shows-the-probability-density-function-pdf-of-the-number-of-times-each-copy-size-appears-in-the-profiling-data-most-copy-sizes-are-small","title":"Figure 14. memcpy argument size distribution. The chart shows the probability density function (PDF) of the number of times each copy size appears in the profiling data. Most copy sizes are small.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u7684\u662f memcpy \u51fd\u6570\u8c03\u7528\u65f6\u53c2\u6570\u5927\u5c0f\uff08\u5373\u590d\u5236\u6570\u636e\u91cf\uff09\u7684 \u6982\u7387\u5bc6\u5ea6\u51fd\u6570 (PDF) \u5206\u5e03\uff0c\u6a2a\u8f74\u4e3a\u590d\u5236\u5927\u5c0f\uff08\u5b57\u8282\uff09\uff0c\u7eb5\u8f74\u4e3a\u5bf9\u5e94\u5927\u5c0f\u51fa\u73b0\u7684\u6982\u7387\u5bc6\u5ea6\u3002</li> <li>\u4ece\u56fe\u4e2d\u53ef\u89c1\uff0c\u7edd\u5927\u591a\u6570 memcpy \u8c03\u7528\u53d1\u751f\u5728\u5c0f\u6570\u636e\u91cf\u533a\u95f4\uff0c\u5c24\u5176\u96c6\u4e2d\u5728 10^0 \u5230 10^2 \u5b57\u8282\u8303\u56f4\u5185\uff0c\u5cf0\u503c\u51fa\u73b0\u5728\u7ea6 10 \u5b57\u8282\u9644\u8fd1\uff0c\u8868\u660e\u77ed\u62f7\u8d1d\u662f\u4e3b\u6d41\u573a\u666f\u3002</li> <li>\u5728 10^2 \u5b57\u8282\u4ee5\u4e0a\uff0cPDF \u503c\u8fc5\u901f\u8870\u51cf\uff0c\u4f46\u4ecd\u6709\u5c11\u91cf\u957f\u5c3e\u5206\u5e03\uff0c\u8bf4\u660e\u5b58\u5728\u5c11\u6570\u5927\u5757\u6570\u636e\u62f7\u8d1d\u64cd\u4f5c\uff0c\u8fd9\u4e0e\u8bba\u6587\u4e2d\u201c\u5927\u90e8\u5206\u62f7\u8d1d\u662f\u77ed\u7684\uff0c\u4f46\u5b58\u5728\u957f\u5c3e\u7684\u5927\u62f7\u8d1d\u201d\u7684\u63cf\u8ff0\u4e00\u81f4\u3002</li> <li>\u8be5\u5206\u5e03\u5bf9 Soft Limoncello \u7684\u8bbe\u8ba1\u81f3\u5173\u91cd\u8981\uff1a\u7531\u4e8e\u786c\u4ef6\u9884\u53d6\u5668\u9700\u8981\u201c\u70ed\u8eab\u671f\u201d\uff0c\u5728\u77ed\u62f7\u8d1d\u4e2d\u6548\u679c\u5dee\uff1b\u800c\u8f6f\u4ef6\u9884\u53d6\u53ef\u7cbe\u51c6\u63a7\u5236\uff0c\u56e0\u6b64\u7cfb\u7edf\u9009\u62e9\u9488\u5bf9\u5927\u62f7\u8d1d\u5c3a\u5bf8\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\uff0c\u4ee5\u6700\u5927\u5316\u6536\u76ca\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5173\u952e\u89c2\u5bdf\u70b9\uff1a</li> </ul> \u89c2\u5bdf\u7ef4\u5ea6 \u63cf\u8ff0 \u4e3b\u8981\u5206\u5e03\u533a\u95f4 1\u2013100 \u5b57\u8282\uff0c\u5360\u7edd\u5927\u591a\u6570\u8c03\u7528 \u5cf0\u503c\u4f4d\u7f6e \u7ea6 10 \u5b57\u8282 \u957f\u5c3e\u7279\u5f81 \u5b58\u5728\u5c11\u91cf &gt;100 \u5b57\u8282 \u7684\u5927\u62f7\u8d1d\uff0c\u6784\u6210\u6027\u80fd\u4f18\u5316\u76ee\u6807 \u5bf9 Limoncello \u610f\u4e49 \u8bc1\u660e\u4ec5\u5bf9\u5927\u62f7\u8d1d\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u662f\u5408\u7406\u7b56\u7565\uff0c\u907f\u514d\u5728\u77ed\u62f7\u8d1d\u4e2d\u6d6a\u8d39\u8d44\u6e90 <ul> <li>\u6b64\u5206\u5e03\u652f\u6491\u4e86\u8bba\u6587\u4e2d\u201c\u901a\u8fc7\u5206\u6790\u8c03\u7528\u53c2\u6570\u5927\u5c0f\u5206\u5e03\u6765\u6307\u5bfc\u8f6f\u4ef6\u9884\u53d6\u63d2\u5165\u70b9\u201d\u7684\u65b9\u6cd5\u8bba\uff0c\u4f53\u73b0\u4e86\u57fa\u4e8e\u771f\u5b9e\u751f\u4ea7\u6570\u636e\u9a71\u52a8\u4f18\u5316\u7684\u8bbe\u8ba1\u601d\u60f3\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#3744e9f229003c206e8a23a5b974ee87bf8ee0f14a1863180ef3fc9a62019e8cjpg","title":"3744e9f229003c206e8a23a5b974ee87bf8ee0f14a1863180ef3fc9a62019e8c.jpg","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u5728\u4e0d\u540c prefetch distance\uff08\u9884\u53d6\u8ddd\u79bb\uff09\u4e0b\uff0cmemcpy \u64cd\u4f5c\u7684\u6027\u80fd\u63d0\u5347\uff08Speedup %\uff09\u968f\u590d\u5236\u6570\u636e\u5927\u5c0f\uff08Memcpy Size, KB\uff09\u7684\u53d8\u5316\u8d8b\u52bf\u3002</li> <li>\u6a2a\u8f74\u4e3a memcpy \u590d\u5236\u7684\u6570\u636e\u91cf\uff0c\u8303\u56f4\u4ece 0 \u5230 1000 KB\uff0c\u91c7\u7528\u5bf9\u6570\u523b\u5ea6\uff0c\u91cd\u70b9\u8986\u76d6\u5c0f\u5230\u4e2d\u7b49\u89c4\u6a21\u7684\u6570\u636e\u5757\u3002</li> <li>\u7eb5\u8f74\u4e3a\u6027\u80fd\u52a0\u901f\u6bd4\uff0c\u4ee5\u767e\u5206\u6bd4\u8868\u793a\uff0c\u6b63\u503c\u4ee3\u8868\u6027\u80fd\u63d0\u5347\uff0c\u8d1f\u503c\u4ee3\u8868\u6027\u80fd\u4e0b\u964d\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u516d\u6761\u66f2\u7ebf\uff0c\u5206\u522b\u5bf9\u5e94\u4e0d\u540c\u7684\u9884\u53d6\u8ddd\u79bb\uff1a32\u300164\u3001128\u3001256\u3001512\u30011K\uff08\u5355\u4f4d\u4e3a\u5b57\u8282\uff09\uff0c\u6bcf\u6761\u66f2\u7ebf\u7528\u4e0d\u540c\u989c\u8272\u6807\u8bc6\u3002</li> <li>\u6027\u80fd\u8868\u73b0\u5448\u73b0\u660e\u663e\u89c4\u5f8b\uff1a</li> <li>\u5bf9\u4e8e\u5c0f\u6570\u636e\u5757\uff08&lt; 1KB\uff09\uff0c\u6240\u6709\u9884\u53d6\u8ddd\u79bb\u5747\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u6216\u65e0\u663e\u8457\u6536\u76ca\uff0c\u5c24\u5176\u5728 0.25KB \u9644\u8fd1\u51fa\u73b0\u8d1f\u52a0\u901f\u3002</li> <li>\u5f53\u6570\u636e\u5757\u589e\u5927\u81f3 4KB \u4ee5\u4e0a\uff0c\u6027\u80fd\u5f00\u59cb\u663e\u8457\u63d0\u5347\uff0c\u4e14\u9884\u53d6\u8ddd\u79bb\u8d8a\u5927\uff0c\u52a0\u901f\u6548\u679c\u8d8a\u5f3a\u3002</li> <li>\u5728 64KB \u5de6\u53f3\uff0c512 \u548c 1K \u8ddd\u79bb\u8fbe\u5230\u5cf0\u503c\u52a0\u901f\uff0c\u7ea6 60%-70%\u3002</li> <li>\u6570\u636e\u5757\u7ee7\u7eed\u589e\u5927\uff08&gt; 256KB\uff09\uff0c\u6240\u6709\u66f2\u7ebf\u5747\u51fa\u73b0\u6027\u80fd\u56de\u843d\uff0c\u4f46\u5927\u8ddd\u79bb\u9884\u53d6\u4ecd\u4fdd\u6301\u76f8\u5bf9\u4f18\u52bf\u3002</li> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u77ed\u8ddd\u79bb\u9884\u53d6\uff08\u5982 32\u300164\uff09\u4ec5\u5728\u4e2d\u7b49\u6570\u636e\u5757\uff084\u201316KB\uff09\u6709\u8f7b\u5fae\u6536\u76ca\uff0c\u6574\u4f53\u8868\u73b0\u5e73\u5eb8\u3002</li> <li>\u957f\u8ddd\u79bb\u9884\u53d6\uff08512\u30011K\uff09\u5728\u4e2d\u5927\u578b\u6570\u636e\u5757\u4e0a\u8868\u73b0\u6700\u4f18\uff0c\u4f46\u9700\u8b66\u60d5\u5728\u6781\u5c0f\u6216\u6781\u5927\u5757\u65f6\u7684\u6027\u80fd\u9000\u5316\u3002</li> <li>\u6700\u4f73\u9884\u53d6\u8ddd\u79bb\u4e0e\u6570\u636e\u5757\u5927\u5c0f\u5f3a\u76f8\u5173\uff0c\u8868\u660e Soft Limoncello \u9700\u6839\u636e\u8fd0\u884c\u65f6\u53c2\u6570\u52a8\u6001\u8c03\u6574\u9884\u53d6\u7b56\u7565\u3002</li> <li>\u6570\u636e\u6458\u8981\u5982\u4e0b\uff1a</li> </ul> Prefetch Distance (Bytes) Peak Speedup (%) Optimal Data Size Range (KB) Performance at Small Sizes (&lt;1KB) 32 ~5% 4\u201316 Negative 64 ~10% 4\u201316 Negative 128 ~15% 4\u201332 Slightly negative 256 ~35% 16\u201364 Near zero 512 ~65% 64\u2013256 Positive from 4KB 1K ~70% 64\u2013256 Positive from 4KB <ul> <li>\u6b64\u56fe\u652f\u6491\u4e86\u8bba\u6587\u4e2d\u5173\u4e8e memcpy \u4f5c\u4e3a\u8f6f\u4ef6\u9884\u53d6\u76ee\u6807\u7684\u6709\u6548\u6027\uff0c\u5e76\u9a8c\u8bc1\u4e86\u901a\u8fc7\u5fae\u57fa\u51c6\u6d4b\u8bd5\u4f18\u5316\u9884\u53d6\u53c2\u6570\uff08\u8ddd\u79bb\u4e0e\u5ea6\uff09\u53ef\u5b9e\u73b0\u663e\u8457\u6027\u80fd\u589e\u76ca\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#b-microbenchmark-exercising-different-prefetch-degrees-prefetching-is-fixed-at-a-distance-of-512-bytes","title":"(b) Microbenchmark exercising different prefetch degrees. Prefetching is fixed at a distance of 512 bytes.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u7684\u662f Soft Limoncello \u5728 memcpy \u51fd\u6570\u4e2d\uff0c\u9488\u5bf9\u4e0d\u540c prefetch degree\uff08\u9884\u53d6\u7c92\u5ea6\uff09\u7684\u6027\u80fd\u8868\u73b0\uff0c\u5176 prefetch distance \u56fa\u5b9a\u4e3a 512 \u5b57\u8282\u3002</li> <li>\u6a2a\u8f74\u4e3a Memcpy Size (KB)\uff0c\u8303\u56f4\u4ece 0 \u5230 1000 KB\uff0c\u4ee3\u8868\u6570\u636e\u62f7\u8d1d\u64cd\u4f5c\u7684\u6570\u636e\u91cf\u5927\u5c0f\u3002</li> <li>\u7eb5\u8f74\u4e3a Speedup (%)\uff0c\u8868\u793a\u76f8\u5bf9\u4e8e\u57fa\u51c6\uff08+HW,-SW\uff09\u7684\u6027\u80fd\u63d0\u5347\u767e\u5206\u6bd4\uff0c\u6b63\u503c\u4ee3\u8868\u52a0\u901f\uff0c\u8d1f\u503c\u4ee3\u8868\u6027\u80fd\u9000\u5316\u3002</li> <li>\u56fe\u4e2d\u5171\u6709\u516d\u6761\u66f2\u7ebf\uff0c\u5206\u522b\u5bf9\u5e94\u4e0d\u540c\u7684\u9884\u53d6\u7c92\u5ea6\uff1a64\u3001128\u3001256\u3001512\u30011K\u30012K \u5b57\u8282\uff0c\u989c\u8272\u4e0e\u56fe\u4f8b\u4e00\u4e00\u5bf9\u5e94\u3002</li> <li>\u6027\u80fd\u8868\u73b0\u968f\u6570\u636e\u91cf\u53d8\u5316\u5448\u73b0\u975e\u7ebf\u6027\u8d8b\u52bf\uff1a</li> <li>\u5bf9\u4e8e\u5c0f\u6570\u636e\u91cf\uff08\u5982 &lt; 0.25 KB\uff09\uff0c\u6240\u6709\u9884\u53d6\u7b56\u7565\u5747\u5bfc\u81f4\u663e\u8457\u6027\u80fd\u4e0b\u964d\uff08\u8d1f\u52a0\u901f\uff09\uff0c\u5c24\u5176\u5728 64 \u548c 128 \u5b57\u8282\u7c92\u5ea6\u4e0b\u6700\u4e25\u91cd\u3002</li> <li>\u968f\u7740\u6570\u636e\u91cf\u589e\u5927\uff08&gt; 1 KB\uff09\uff0c\u5404\u7c92\u5ea6\u5f00\u59cb\u51fa\u73b0\u6b63\u5411\u52a0\u901f\uff0c\u4e14\u5728 4\u201364 KB \u533a\u95f4\u5185\u8fbe\u5230\u5cf0\u503c\u3002</li> <li>\u5728 64 KB \u5de6\u53f3\uff0c2K \u7c92\u5ea6\u8868\u73b0\u6700\u4f73\uff0c\u52a0\u901f\u63a5\u8fd1 60%\uff1b512 \u5b57\u8282\u6b21\u4e4b\u3002</li> <li>\u5f53\u6570\u636e\u91cf\u8d85\u8fc7 256 KB \u540e\uff0c\u5404\u7c92\u5ea6\u52a0\u901f\u6548\u679c\u8d8b\u4e8e\u6536\u655b\uff0c\u5dee\u5f02\u7f29\u5c0f\u3002</li> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5927\u7c92\u5ea6\uff08\u5982 2K\uff09\u5728\u4e2d\u7b49\u81f3\u5927\u6570\u636e\u91cf\u65f6\u8868\u73b0\u6700\u4f18\uff0c\u4f46\u5bf9\u5c0f\u6570\u636e\u91cf\u60e9\u7f5a\u6700\u5927\u3002</li> <li>\u5c0f\u7c92\u5ea6\uff08\u5982 64\u3001128\uff09\u5728\u5c0f\u6570\u636e\u91cf\u65f6\u6027\u80fd\u6076\u5316\u6700\u4e25\u91cd\uff0c\u4f46\u5728\u4e2d\u7b49\u6570\u636e\u91cf\u65f6\u4ecd\u53ef\u63d0\u4f9b\u9002\u5ea6\u52a0\u901f\u3002</li> <li>\u5b58\u5728\u201c\u751c\u70b9\u533a\u201d\uff08sweet spot\uff09\uff1a\u7ea6 4\u201364 KB \u6570\u636e\u91cf\u533a\u95f4\uff0c\u662f\u8f6f\u4ef6\u9884\u53d6\u6536\u76ca\u6700\u9ad8\u7684\u533a\u57df\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e0d\u540c\u9884\u53d6\u7c92\u5ea6\u5728\u5173\u952e\u6570\u636e\u91cf\u70b9\u7684\u8868\u73b0\uff1a</li> </ul> Memcpy Size (KB) Prefetch Degree 64 Prefetch Degree 128 Prefetch Degree 256 Prefetch Degree 512 Prefetch Degree 1K Prefetch Degree 2K 0.25 ~ -50% ~ -40% ~ -30% ~ -20% ~ -10% ~ -5% 4 ~ 0% ~ 10% ~ 20% ~ 30% ~ 35% ~ 40% 64 ~ 10% ~ 20% ~ 30% ~ 40% ~ 50% ~ 60% 256 ~ 15% ~ 25% ~ 35% ~ 40% ~ 45% ~ 50% <ul> <li>\u7ed3\u8bba\uff1a\u9009\u62e9\u5408\u9002\u7684 prefetch degree \u81f3\u5173\u91cd\u8981\uff0c\u9700\u6839\u636e\u5b9e\u9645\u5de5\u4f5c\u8d1f\u8f7d\u7684\u6570\u636e\u5206\u5e03\u8fdb\u884c\u8c03\u4f18\u3002Limoncello \u901a\u8fc7\u5fae\u57fa\u51c6\u6d4b\u8bd5\u548c\u8d1f\u8f7d\u6d4b\u8bd5\u8fed\u4ee3\u786e\u5b9a\u6700\u4f18\u53c2\u6570\uff0c\u4ee5\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\u5e76\u907f\u514d\u5c0f\u6570\u636e\u91cf\u4e0b\u7684\u6027\u80fd\u60e9\u7f5a\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-15-soft-limoncello-memcpy-microbenchmarking","title":"Figure 15. Soft Limoncello memcpy microbenchmarking.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Soft Limoncello \u5728\u4f18\u5316 <code>memcpy</code> \u51fd\u6570\u65f6\u7684\u5fae\u57fa\u51c6\u6d4b\u8bd5\u7ed3\u679c\uff0c\u91cd\u70b9\u6bd4\u8f83\u4e86\u4e0d\u540c\u786c\u4ef6\uff08HW\uff09\u4e0e\u8f6f\u4ef6\uff08SW\uff09\u9884\u53d6\u5668\u7ec4\u5408\u72b6\u6001\u4e0b\u7684\u6027\u80fd\u589e\u76ca\u3002</li> <li>\u6a2a\u8f74\u4e3a\u4e09\u79cd\u9884\u53d6\u5668\u72b6\u6001\uff1a-HW, -SW\uff08\u786c\u4ef6\u4e0e\u8f6f\u4ef6\u9884\u53d6\u5668\u5747\u5173\u95ed\uff09\u3001+HW, +SW\uff08\u4e24\u8005\u5747\u5f00\u542f\uff09\u3001-HW, +SW\uff08\u4ec5\u5f00\u542f\u8f6f\u4ef6\u9884\u53d6\u5668\uff09\u3002</li> <li>\u7eb5\u8f74\u4e3a Speedup (%)\uff0c\u8868\u793a\u76f8\u5bf9\u4e8e\u57fa\u51c6\u914d\u7f6e\uff08+HW, -SW\uff09\u7684\u6027\u80fd\u63d0\u5347\u767e\u5206\u6bd4\u3002</li> <li>\u6570\u636e\u8868\u660e\uff1a</li> <li>-HW, -SW \u914d\u7f6e\u4e0b\u6027\u80fd\u4e0b\u964d\u7ea6 0.25%\uff0c\u8bf4\u660e\u5728\u65e0\u4efb\u4f55\u9884\u53d6\u673a\u5236\u65f6\uff0c<code>memcpy</code> \u6027\u80fd\u53d7\u635f\u3002</li> <li>+HW, +SW \u914d\u7f6e\u4e0b\u6027\u80fd\u63d0\u5347\u7ea6 1.45%\uff0c\u663e\u793a\u8f6f\u786c\u7ed3\u5408\u53ef\u5e26\u6765\u663e\u8457\u6536\u76ca\u3002</li> <li>-HW, +SW \u914d\u7f6e\u4e0b\u6027\u80fd\u63d0\u5347\u7ea6 1.15%\uff0c\u8bc1\u660e\u5373\u4f7f\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u8f6f\u4ef6\u9884\u53d6\u5668\u4ecd\u80fd\u6709\u6548\u8865\u507f\u6027\u80fd\u635f\u5931\u3002</li> <li>\u6b64\u56fe\u9a8c\u8bc1\u4e86 Limoncello \u7684\u6838\u5fc3\u8bbe\u8ba1\u54f2\u5b66\uff1a\u5728\u9ad8\u5e26\u5bbd\u538b\u529b\u4e0b\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u4ee5\u964d\u4f4e\u5185\u5b58\u5ef6\u8fdf\uff0c\u540c\u65f6\u901a\u8fc7\u7cbe\u51c6\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\u7ef4\u6301\u6027\u80fd\u3002</li> <li>\u8be5\u7ed3\u679c\u652f\u6491\u4e86\u8bba\u6587\u4e2d\u5173\u4e8e\u201c\u6570\u636e\u4e2d\u5fc3\u7a0e\u51fd\u6570\uff08\u5982 memcpy\uff09\u9002\u5408\u8f6f\u4ef6\u9884\u53d6\u201d\u7684\u7ed3\u8bba\uff0c\u56e0\u5176\u8bbf\u95ee\u6a21\u5f0f\u660e\u786e\u3001\u53ef\u9884\u6d4b\uff0c\u8f6f\u4ef6\u53ef\u7cbe\u786e\u63a7\u5236\u9884\u53d6\u5730\u5740\u3001\u8ddd\u79bb\u4e0e\u5ea6\u6570\u3002</li> </ul> Prefetcher State Speedup (%) -HW, -SW -0.25 +HW, +SW +1.45 -HW, +SW +1.15"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-16-limoncello-application-throughput-gain-application-throughput-increases-by-6-13-increase-dependent-on-the-cpu-utilization-level-of-the-machines","title":"Figure 16. Limoncello application throughput gain. Application throughput increases by 6-13% increase, dependent on the CPU utilization level of the machines.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 16. Limoncello application throughput gain\uff0c\u5c55\u793a\u7684\u662f Limoncello \u7cfb\u7edf\u5728\u4e0d\u540c CPU \u5229\u7528\u7387\u4e0b\u5bf9\u5e94\u7528\u541e\u5410\u91cf\u7684\u63d0\u5347\u6548\u679c\u3002</li> <li>\u6a2a\u8f74\u8868\u793a CPU\u5229\u7528\u7387\uff0c\u5206\u4e3a\u4e09\u4e2a\u533a\u95f4\uff1a60%\u300170%\u300180%\uff0c\u4ee3\u8868\u670d\u52a1\u5668\u8d1f\u8f7d\u7684\u4e0d\u540c\u9636\u6bb5\u3002</li> <li>\u7eb5\u8f74\u4e3a Application Throughput (%)\uff0c\u5373\u5e94\u7528\u541e\u5410\u91cf\u7684\u767e\u5206\u6bd4\u53d8\u5316\uff0c\u8861\u91cf Limoncello \u90e8\u7f72\u524d\u540e\u7684\u6027\u80fd\u589e\u76ca\u3002</li> <li>\u6570\u636e\u663e\u793a\uff1a</li> <li>\u5728 60% CPU\u5229\u7528\u7387 \u4e0b\uff0c\u541e\u5410\u91cf\u63d0\u5347\u5fae\u5f31\uff0c\u7ea6\u4e3a 0.5%\uff0c\u8868\u660e\u7cfb\u7edf\u8d1f\u8f7d\u8f83\u4f4e\u65f6\uff0cLimoncello \u7684\u52a8\u6001\u8c03\u8282\u673a\u5236\u672a\u88ab\u89e6\u53d1\u6216\u5f71\u54cd\u6709\u9650\u3002</li> <li>\u5728 70% CPU\u5229\u7528\u7387 \u4e0b\uff0c\u541e\u5410\u91cf\u63d0\u5347\u663e\u8457\uff0c\u8fbe\u5230 7% \u5de6\u53f3\uff0c\u8bf4\u660e\u6b64\u65f6\u7cfb\u7edf\u5f00\u59cb\u8fdb\u5165\u9ad8\u8d1f\u8f7d\u72b6\u6001\uff0cLimoncello \u901a\u8fc7\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u5e76\u542f\u7528\u8f6f\u4ef6\u9884\u53d6\u6709\u6548\u7f13\u89e3\u5185\u5b58\u5e26\u5bbd\u538b\u529b\u3002</li> <li>\u5728 80% CPU\u5229\u7528\u7387 \u4e0b\uff0c\u541e\u5410\u91cf\u63d0\u5347\u6700\u5927\uff0c\u63a5\u8fd1 17%\uff0c\u53cd\u6620\u5728\u5cf0\u503c\u8d1f\u8f7d\u4e0b\uff0cLimoncello \u7684\u4f18\u5316\u7b56\u7565\uff08\u7279\u522b\u662f Soft Limoncello \u5bf9\u6570\u636e\u4e2d\u5fc3\u7a0e\u51fd\u6570\u7684\u7cbe\u51c6\u9884\u53d6\uff09\u53d1\u6325\u4e86\u6700\u5927\u6548\u80fd\u3002</li> </ul> CPU Utilization Throughput Gain (%) 60% ~0.5% 70% ~7% 80% ~17% <ul> <li>\u7ed3\u8bba\uff1aLimoncello \u7684\u6027\u80fd\u6536\u76ca\u4e0e\u7cfb\u7edf\u8d1f\u8f7d\u6b63\u76f8\u5173\uff0c\u5728 \u9ad8\u5229\u7528\u7387\u573a\u666f\uff0870%-80%\uff09 \u4e0b\u8868\u73b0\u6700\u4f73\uff0c\u9a8c\u8bc1\u4e86\u5176\u201c\u6309\u9700\u5207\u6362\u9884\u53d6\u7b56\u7565\u201d\u7684\u8bbe\u8ba1\u6709\u6548\u6027\u3002\u8be5\u7ed3\u679c\u4e5f\u547c\u5e94\u8bba\u6587\u6458\u8981\u4e2d\u63d0\u5230\u7684 10% \u5e73\u5747\u541e\u5410\u91cf\u63d0\u5347\uff0c\u56e0\u5b9e\u9645\u90e8\u7f72\u4e2d\u5de5\u4f5c\u8d1f\u8f7d\u5206\u5e03\u4e0d\u5747\uff0c\u5e73\u5747\u503c\u4ecb\u4e8e\u5404\u533a\u95f4\u4e4b\u95f4\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-17-limoncello-memory-latency-reduction-memory-latency-reduces-by-13-in-the-median-and-10-in-the-p99","title":"Figure 17. Limoncello memory latency reduction. Memory latency reduces by 13% in the median and 10% in the P99.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 Limoncello \u90e8\u7f72\u540e\u5bf9\u5185\u5b58\u5ef6\u8fdf\u7684\u6539\u5584\u6548\u679c\uff0c\u7eb5\u8f74\u4e3a\u201cChange in Memory Latency (%)\u201d\uff0c\u6a2a\u8f74\u4e3a\u4e09\u4e2a\u6027\u80fd\u5206\u4f4d\u70b9\uff1aP50\uff08\u4e2d\u4f4d\u6570\uff09\u3001P90 \u548c P99\u3002</li> <li>\u6240\u6709\u67f1\u72b6\u56fe\u5747\u4e3a\u7eff\u8272\u4e14\u5411\u4e0b\u5ef6\u4f38\uff0c\u8868\u660e\u5728\u6240\u6709\u5206\u4f4d\u70b9\u4e0a\uff0c\u5185\u5b58\u5ef6\u8fdf\u5747\u663e\u8457\u964d\u4f4e\uff0c\u7b26\u5408\u8bba\u6587\u6458\u8981\u548c\u6b63\u6587\u6240\u8ff0\u201c15% \u51cf\u5c11\u201d\u53ca\u201c13% \u4e2d\u4f4d\u6570\u51cf\u5c11\u201d\u7684\u7ed3\u8bba\u3002</li> <li>\u5177\u4f53\u6570\u503c\u5982\u4e0b\uff1a</li> </ul> \u5206\u4f4d\u70b9 \u5185\u5b58\u5ef6\u8fdf\u53d8\u5316\uff08%\uff09 P50 \u7ea6 -13% P90 \u7ea6 -8% P99 \u7ea6 -7% <ul> <li>\u4ece\u6570\u636e\u8d8b\u52bf\u53ef\u89c1\uff0c\u4e2d\u4f4d\u6570\uff08P50\uff09\u53d7\u76ca\u6700\u5927\uff0c\u800c\u5c3e\u90e8\u5ef6\u8fdf\uff08P99\uff09\u867d\u6539\u5584\u5e45\u5ea6\u8f83\u5c0f\uff0c\u4f46\u4ecd\u5b9e\u73b0\u7ea610%\u7684\u964d\u4f4e\uff0c\u8fd9\u5bf9\u9ad8\u8d1f\u8f7d\u670d\u52a1\u7684\u7a33\u5b9a\u6027\u81f3\u5173\u91cd\u8981\u3002</li> <li>\u6b64\u7ed3\u679c\u9a8c\u8bc1\u4e86 Limoncello \u7684\u6838\u5fc3\u673a\u5236\uff1a\u5728\u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u4e0b\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u53ef\u6709\u6548\u7f13\u89e3\u5185\u5b58\u7cfb\u7edf\u6392\u961f\u5ef6\u8fdf\uff0c\u4ece\u800c\u964d\u4f4e\u6574\u4f53\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> <li>\u56fe\u8868\u672a\u663e\u793a\u6b63\u5411\u5ef6\u8fdf\u589e\u957f\uff0c\u8bf4\u660e\u8be5\u4f18\u5316\u7b56\u7565\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5177\u6709\u7a33\u5b9a\u6027\u548c\u666e\u9002\u6027\uff0c\u65e0\u526f\u4f5c\u7528\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-18-limoncello-socket-bandwidth-usage-reduction-average-socket-bandwidth-reduces-by-15","title":"Figure 18. Limoncello socket bandwidth usage reduction. Average socket bandwidth reduces by 15%.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u7684\u662f Figure 18\uff0c\u6807\u9898\u4e3a \u201cLimoncello socket bandwidth usage reduction\u201d\uff0c\u6838\u5fc3\u7ed3\u8bba\u662f \u5e73\u5747 socket \u5e26\u5bbd\u964d\u4f4e 15%\u3002</li> <li>\u56fe\u8868\u7c7b\u578b\u4e3a\u5782\u76f4\u67f1\u72b6\u56fe\uff0c\u7eb5\u8f74\u4e3a \u201cChange in Socket Memory Bandwidth Usage (%)\u201d\uff0c\u6a2a\u8f74\u4e3a\u4e09\u4e2a\u7edf\u8ba1\u7ef4\u5ea6\uff1aAvg\uff08\u5e73\u5747\u503c\uff09\u3001P90\uff08\u7b2c90\u767e\u5206\u4f4d\uff09\u3001P99\uff08\u7b2c99\u767e\u5206\u4f4d\uff09\u3002</li> <li>\u6240\u6709\u67f1\u4f53\u5747\u4e3a\u7eff\u8272\uff0c\u8868\u793a\u5e26\u5bbd\u4f7f\u7528\u91cf\u7684\u51cf\u5c11\uff0c\u6570\u503c\u5747\u4e3a\u8d1f\u503c\uff0c\u8bf4\u660e Limoncello \u90e8\u7f72\u540e\u5bf9\u5185\u5b58\u5e26\u5bbd\u6d88\u8017\u6709\u663e\u8457\u6291\u5236\u4f5c\u7528\u3002</li> <li>\u5177\u4f53\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> \u7edf\u8ba1\u7ef4\u5ea6 \u5e26\u5bbd\u53d8\u5316\u767e\u5206\u6bd4 Avg \u7ea6 -13% P90 \u7ea6 -14% P99 \u7ea6 -10% <ul> <li>\u4ece\u6570\u636e\u5206\u5e03\u53ef\u89c1\uff0c\u4e2d\u4f4d\u6570\u548c\u9ad8\u767e\u5206\u4f4d\uff08P90\uff09\u7684\u5e26\u5bbd\u8282\u7701\u66f4\u663e\u8457\uff0c\u800c\u5c3e\u90e8\uff08P99\uff09\u8282\u7701\u7565\u5c11\uff0c\u8868\u660e Limoncello \u5bf9\u5178\u578b\u8d1f\u8f7d\u548c\u91cd\u8d1f\u8f7d\u573a\u666f\u5747\u6709\u6548\uff0c\u4f46\u6781\u7aef\u5c3e\u90e8\u5ef6\u8fdf\u573a\u666f\u4f18\u5316\u5e45\u5ea6\u7a0d\u5f31\u3002</li> <li>\u6b64\u7ed3\u679c\u652f\u6491\u8bba\u6587\u6838\u5fc3\u4e3b\u5f20\uff1a\u5728\u9ad8\u5229\u7528\u7387\u7cfb\u7edf\u4e2d\uff0c\u5173\u95ed\u786c\u4ef6 prefetcher \u53ef\u5927\u5e45\u964d\u4f4e\u5185\u5b58\u5e26\u5bbd\u538b\u529b\uff0c\u4ece\u800c\u7f13\u89e3\u5185\u5b58\u74f6\u9888\uff0c\u63d0\u5347\u6574\u4f53\u541e\u5410\u3002</li> <li>\u7ed3\u5408\u4e0a\u4e0b\u6587\uff0c\u8be5\u5e26\u5bbd\u964d\u4f4e\u76f4\u63a5\u4fc3\u6210 CPU \u5229\u7528\u7387\u63d0\u5347\u81f3 70\u201380% \u533a\u95f4\u800c\u4e0d\u89e6\u53d1\u5185\u5b58\u9971\u548c\uff0c\u662f Limoncello \u5b9e\u73b0 10% \u5e94\u7528\u541e\u5410\u63d0\u5347\u7684\u5173\u952e\u673a\u5236\u4e4b\u4e00\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-19-increase-in-cpu-utilization-due-to-limoncello-before-limoncello-memory-bandwidth-saturation-was-reached-in-the-40-50-cpu-utilization-band-figure-4-but-with-limoncello-memory-bandwidth-saturation-is-not-met-until-the-70-80-band-sizes-of-the-markers-are-in-proportion-to-the-fraction-of-platform-servers-in-the-cpu-usage-bucket","title":"Figure 19. Increase in CPU utilization due to Limoncello. Before Limoncello, memory bandwidth saturation was reached in the 40-50% CPU utilization band (Figure 4), but with Limoncello memory bandwidth saturation is not met until the 70-80% band. Sizes of the markers are in proportion to the fraction of platform servers in the CPU usage bucket.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 Limoncello \u90e8\u7f72\u524d\u540e\uff0cCPU \u5229\u7528\u7387\u4e0e Memory Bandwidth Usage \u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u6a2a\u8f74\u4e3a CPU \u4f7f\u7528\u7387\u5206\u6876\uff080-10% \u81f3 100-110%\uff09\uff0c\u7eb5\u8f74\u4e3a\u5185\u5b58\u5e26\u5bbd\u4f7f\u7528\u767e\u5206\u6bd4\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u4e24\u6761\u66f2\u7ebf\uff1aplatform 1\uff08\u7eff\u8272\u5706\u70b9\uff09\u548c platform 2\uff08\u7eff\u8272\u65b9\u5757\uff09\uff0c\u4ee3\u8868\u4e24\u4e2a\u4e0d\u540c\u4ee3\u9645\u7684\u670d\u52a1\u5668\u5e73\u53f0\uff0c\u5176\u8d8b\u52bf\u9ad8\u5ea6\u4e00\u81f4\uff0c\u8868\u660e Limoncello \u7684\u6548\u679c\u5177\u6709\u8de8\u5e73\u53f0\u4e00\u81f4\u6027\u3002</li> <li>\u5173\u952e\u9608\u503c\u7ebf\uff1a\u56fe\u4e2d\u84dd\u8272\u6c34\u5e73\u7ebf\u6807\u6ce8 \u201cmemory bandwidth saturation\u201d\uff0c\u8868\u793a\u5185\u5b58\u5e26\u5bbd\u9971\u548c\u70b9\uff0c\u7ea6\u4e3a 70% \u5e26\u5bbd\u5229\u7528\u7387\u3002\u9ec4\u8272\u5782\u76f4\u865a\u7ebf\u6807\u6ce8 \u201ctarget CPU usage\u201d\uff0c\u4f4d\u4e8e 70-80% CPU \u5229\u7528\u7387\u533a\u95f4\uff0c\u662f Google \u6570\u636e\u4e2d\u5fc3\u7684\u76ee\u6807\u5229\u7528\u7387\u533a\u95f4\u3002</li> <li>\u5728\u672a\u90e8\u7f72 Limoncello \u65f6\uff08\u53c2\u8003 Figure 4\uff09\uff0c\u5185\u5b58\u5e26\u5bbd\u5728 40-50% CPU \u5229\u7528\u7387\u533a\u95f4\u5373\u8fbe\u5230\u9971\u548c\uff0c\u5bfc\u81f4\u7cfb\u7edf\u65e0\u6cd5\u7ee7\u7eed\u63d0\u5347 CPU \u5229\u7528\u7387\uff0c\u9020\u6210\u8d44\u6e90\u95f2\u7f6e\u3002</li> <li>\u90e8\u7f72 Limoncello \u540e\uff0c\u5185\u5b58\u5e26\u5bbd\u9971\u548c\u70b9\u88ab\u63a8\u8fdf\u81f3 70-80% CPU \u5229\u7528\u7387\u533a\u95f4\uff0c\u4f7f\u7cfb\u7edf\u80fd\u591f\u5728\u66f4\u9ad8 CPU \u5229\u7528\u7387\u4e0b\u4ecd\u4fdd\u6301\u826f\u597d\u6027\u80fd\uff0c\u4ece\u800c\u663e\u8457\u63d0\u5347\u6574\u4f53\u8d44\u6e90\u5229\u7528\u7387\u3002</li> <li>\u56fe\u4e2d\u6570\u636e\u70b9\u5927\u5c0f\u4e0e\u8be5 CPU \u4f7f\u7528\u7387\u533a\u95f4\u7684\u670d\u52a1\u5668\u6570\u91cf\u6210\u6b63\u6bd4\uff0c\u8bf4\u660e\u9ad8\u5229\u7528\u7387\u533a\u95f4\uff08\u5982 70-80%\uff09\u7684\u670d\u52a1\u5668\u57fa\u6570\u8f83\u5927\uff0cLimoncello \u5bf9\u4e3b\u6d41\u8d1f\u8f7d\u573a\u666f\u5f71\u54cd\u663e\u8457\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5173\u952e\u62d0\u70b9\uff1a</li> </ul> CPU Usage Bucket Memory Bandwidth Usage (Before Limoncello) Memory Bandwidth Usage (After Limoncello) 40-50% ~70% (\u9971\u548c) ~60% 70-80% \u8d85\u8fc7\u9971\u548c\u70b9 ~70% (\u521a\u8fbe\u9971\u548c) <ul> <li>\u7ed3\u8bba\uff1aLimoncello \u901a\u8fc7\u52a8\u6001\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u5e76\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\uff0c\u6709\u6548\u7f13\u89e3\u4e86\u5185\u5b58\u5e26\u5bbd\u4e89\u7528\uff0c\u5c06\u7cfb\u7edf\u53ef\u7a33\u5b9a\u8fd0\u884c\u7684 CPU \u5229\u7528\u7387\u4e0a\u9650\u4ece 40-50% \u63d0\u5347\u81f3 70-80%\uff0c\u5b9e\u73b0 \u8d44\u6e90\u5229\u7528\u7387\u6700\u5927\u5316 \u4e0e \u6027\u80fd\u74f6\u9888\u540e\u79fb\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/figs_notes/#figure-20-software-prefetcher-impact-in-limoncello-the-y-axis-shows-the-portion-of-fleetwide-cycles-spent-in-the-respective-function-categories-the-center-bar-green-shows-hard-limoncello-deployed-without-any-software-prefetchers-adding-software-prefetchers-into-limoncello-lowered-cpu-cycles-spent-in-targeted-functions-by-2-yellow","title":"Figure 20. Software prefetcher impact in Limoncello. The y-axis shows the portion of fleetwide cycles spent in the respective function categories. The center bar (green) shows Hard Limoncello deployed without any software prefetchers. Adding software prefetchers into Limoncello lowered CPU cycles spent in targeted functions by 2% (yellow).","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 20\uff0c\u4e3b\u9898\u662f Software prefetcher impact in Limoncello\uff0c\u5c55\u793a\u7684\u662f\u5728\u4e0d\u540c Limoncello \u914d\u7f6e\u4e0b\uff0c\u5404\u7c7b\u6570\u636e\u4e2d\u2f3c\u7a0e\u51fd\u6570\uff08DC Tax\uff09\u6240\u6d88\u8017\u7684 CPU \u5468\u671f\u767e\u5206\u6bd4\u3002</li> <li>Y \u8f74\u8868\u793a CPU Cycles (%)\uff0c\u5373\u6574\u4e2a\u96c6\u7fa4\u4e2d\u5728\u5bf9\u5e94\u51fd\u6570\u7c7b\u522b\u4e0a\u82b1\u8d39\u7684 CPU \u5468\u671f\u5360\u6bd4\uff1bX \u8f74\u6309\u529f\u80fd\u5206\u7c7b\uff1acompression\u3001data transmission\u3001hashing\u3001data movement\uff0c\u4ee5\u53ca\u805a\u5408\u9879 all targeted DC tax\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e09\u79cd\u914d\u7f6e\uff1a</li> <li>No Limoncello\uff08\u84dd\u8272\uff09\uff1a\u672a\u542f\u7528\u4efb\u4f55 Limoncello \u673a\u5236\uff0c\u4f5c\u4e3a\u57fa\u7ebf\u3002</li> <li>Hard Limoncello\uff08\u7eff\u8272\uff09\uff1a\u4ec5\u542f\u7528\u786c\u4ef6\u9884\u53d6\u5668\u52a8\u6001\u5173\u95ed\u673a\u5236\uff0c\u672a\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u3002</li> <li> <p>Full Limoncello\uff08\u9ec4\u8272\uff09\uff1a\u5b8c\u6574\u542f\u7528 Hard + Soft Limoncello\uff0c\u5373\u52a8\u6001\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5e76\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u3002</p> </li> <li> <p>\u6570\u636e\u8d8b\u52bf\u5206\u6790\u5982\u4e0b\uff1a</p> </li> </ul> \u51fd\u6570\u7c7b\u522b No Limoncello (\u84dd) Hard Limoncello (\u7eff) Full Limoncello (\u9ec4) \u53d8\u5316\u8bf4\u660e compression ~0.8% ~1.1% ~0.7% \u786c\u4ef6\u5173\u95ed\u540e\u6027\u80fd\u4e0b\u964d\uff0c\u8f6f\u4ef6\u9884\u53d6\u6709\u6548\u56de\u8865 data transmission ~4.2% ~4.3% ~3.4% \u8f6f\u4ef6\u9884\u53d6\u663e\u8457\u964d\u4f4e\u5f00\u9500 hashing ~1.0% ~1.5% ~1.2% \u8f6f\u4ef6\u9884\u53d6\u90e8\u5206\u62b5\u6d88\u786c\u4ef6\u5173\u95ed\u5e26\u6765\u7684\u635f\u5931 data movement ~2.9% ~2.9% ~2.4% \u8f6f\u4ef6\u9884\u53d6\u5e26\u6765\u660e\u663e\u4f18\u5316 all targeted DC tax ~9.0% ~9.8% ~7.8% \u6574\u4f53\u8282\u7701\u7ea6 2% CPU \u5468\u671f <ul> <li>\u5173\u952e\u7ed3\u8bba\uff1a</li> <li>\u542f\u7528 Hard Limoncello \u4f1a\u5bfc\u81f4\u6240\u6709 DC Tax \u7c7b\u522b CPU \u5468\u671f\u4e0a\u5347\uff0c\u8868\u660e\u786c\u4ef6\u9884\u53d6\u5668\u5bf9\u8fd9\u4e9b\u51fd\u6570\u6709\u6b63\u5411\u4f5c\u7528\u3002</li> <li>\u52a0\u5165 Soft Limoncello \u540e\uff0c\u6240\u6709\u7c7b\u522b\u5747\u5b9e\u73b0\u5468\u671f\u4e0b\u964d\uff0c\u5c24\u5176\u5728 data transmission \u548c data movement \u4e0a\u6548\u679c\u6700\u663e\u8457\u3002</li> <li>\u5728\u805a\u5408\u9879 all targeted DC tax \u4e2d\uff0c\u4ece 9.8%\uff08Hard Limoncello\uff09\u964d\u81f3 7.8%\uff08Full Limoncello\uff09\uff0c\u9a8c\u8bc1\u4e86\u8bba\u6587\u6240\u8ff0\u201clowered CPU cycles spent in targeted functions by 2%\u201d\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u8bc1\u660e\uff1a\u8f6f\u4ef6\u9884\u53d6\u80fd\u7cbe\u51c6\u8865\u507f\u786c\u4ef6\u9884\u53d6\u5173\u95ed\u5e26\u6765\u7684\u6027\u80fd\u635f\u5931\uff0c\u5e76\u5728\u9ad8\u5e26\u5bbd\u538b\u529b\u4e0b\u5b9e\u73b0\u66f4\u4f18\u8d44\u6e90\u5229\u7528\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/","title":"Limoncello: Prefetchers for Scale \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Akanksha Jain - Hannah Lin - Carlos Villavieja - Baris Kasikci - Chris Kennelly - Milad Hashemi - Parthasarathy Ranganathan</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - 29th ACM International Conference on Architectural Support for Programming Languages and Operating Systems, Volume 3 (ASPLOS \u201924)</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - 2024</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u5728\u9ad8\u5229\u7528\u7387\u3001\u8d44\u6e90\u53d7\u9650\u7684\u5927\u578b\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e2d\uff0c\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668 (hardware prefetchers) \u56e0\u8fc7\u5ea6\u6d88\u8017\u5185\u5b58\u5e26\u5bbd (memory bandwidth) \u800c\u5bfc\u81f4\u5185\u5b58\u5ef6\u8fdf (memory latency) \u589e\u52a0\u3001\u7cfb\u7edf\u6027\u80fd\u4e0b\u964d\u7684\u95ee\u9898\u3002 - \u63d0\u51fa\u4e00\u79cd\u65e0\u9700\u786c\u4ef6\u4fee\u6539\u7684\u8f6f\u4ef6\u65b9\u6848\uff0c\u5728\u9ad8\u5e26\u5bbd\u538b\u529b\u4e0b\u901a\u8fc7\u52a8\u6001\u5207\u6362\u9884\u53d6\u7b56\u7565\uff0c\u5b9e\u73b0\u5185\u5b58\u5ef6\u8fdf\u4e0e\u7f13\u5b58\u672a\u547d\u4e2d\u7387 (cache miss rate) \u4e4b\u95f4\u7684\u66f4\u4f18\u6743\u8861\u3002</p> <p>\u65b9\u6cd5 - Limoncello \u7cfb\u7edf\u5305\u542b\u4e24\u4e2a\u6838\u5fc3\u7ec4\u4ef6\uff1aHard Limoncello \u548c Soft Limoncello\u3002 - Hard Limoncello (\u786c\u4ef6\u9884\u53d6\u5668\u52a8\u6001\u8c03\u63a7):   - \u57fa\u4e8esocket\u7ea7\u5185\u5b58\u5e26\u5bbd\u9065\u6d4b\u6570\u636e\uff0c\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u5e26\u6709\u6ede\u540e\u6027 (hysteresis) \u7684\u72b6\u6001\u673a\u63a7\u5236\u5668\u3002   - \u5f53\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u8d85\u8fc780% \u7684\u9971\u548c\u9608\u503c\u65f6\uff0c\u901a\u8fc7\u5199\u5165MSR (Model-Specific Registers) \u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\uff1b\u5f53\u5229\u7528\u7387\u964d\u81f360% \u4ee5\u4e0b\u65f6\uff0c\u91cd\u65b0\u542f\u7528\u3002   - </p> <p></p> <p>Figure 8. State diagram of Hard Limoncello controller for modulating hardware prefetchers. Green (lighter) indicates hardware prefetchers are off, blue (darker) that they are on.</p> <ul> <li>Soft Limoncello (\u7cbe\u51c6\u8f6f\u4ef6\u9884\u53d6):</li> <li>\u5229\u7528\u5927\u89c4\u6a21\u786c\u4ef6\u6d88\u878d\u7814\u7a76 (hardware ablation study)\uff0c\u5728\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\u7684\u673a\u5668\u4e0a\u8fdb\u884c\u5168\u8230\u961f\u6027\u80fd\u5206\u6790 (fleetwide profiling)\uff0c\u8bc6\u522b\u51fa\u5bf9\u786c\u4ef6\u9884\u53d6\u6700\u654f\u611f\u7684\u51fd\u6570\u3002</li> <li>\u53d1\u73b0\u6570\u636e\u4e2d\u5fc3\u7a0e (data center tax) \u51fd\u6570\uff08\u5982\u538b\u7f29\u3001\u54c8\u5e0c\u3001\u6570\u636e\u4f20\u8f93\u3001memcpy\uff09\u662f\u4e3b\u8981\u7684\u6027\u80fd\u56de\u9000\u6765\u6e90\uff0c\u4e5f\u662f\u7406\u60f3\u7684\u8f6f\u4ef6\u9884\u53d6\u76ee\u6807\u3002</li> <li></li> </ul> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p> <ul> <li>\u9488\u5bf9\u8fd9\u4e9b\u51fd\u6570\uff0c\u901a\u8fc7\u5fae\u57fa\u51c6\u6d4b\u8bd5\u548c\u8d1f\u8f7d\u6d4b\u8bd5\uff0c\u7cbe\u7ec6\u8c03\u4f18\u9884\u53d6\u5730\u5740 (prefetch address)\u3001\u9884\u53d6\u8ddd\u79bb (prefetch distance) \u548c\u9884\u53d6\u5ea6 (prefetch degree) \u7b49\u53c2\u6570\u3002</li> <li></li> </ul> <p></p> <p>Figure 15. Soft Limoncello memcpy microbenchmarking.</p> <p>\u7ed3\u679c - \u5728 Google \u751f\u4ea7\u8230\u961f\u7684\u5927\u89c4\u6a21\u90e8\u7f72\u8bc4\u4f30\u4e2d\uff0cLimoncello \u53d6\u5f97\u4e86\u663e\u8457\u6210\u6548\uff1a   - \u5e94\u7528\u541e\u5410\u91cf (application throughput) \u5728\u9ad8 CPU \u5229\u7528\u7387\uff0870%-80%\uff09\u4e0b\u63d0\u5347\u4e86 10%\u3002   - \u5185\u5b58\u5ef6\u8fdf\u663e\u8457\u964d\u4f4e\uff0c\u5176\u4e2d L3 \u5ef6\u8fdf\u7684\u4e2d\u4f4d\u6570\u51cf\u5c11\u4e86 13%\uff0cP99 \u5ef6\u8fdf\u51cf\u5c11\u4e86 10%\u3002   - Socket \u5185\u5b58\u5e26\u5bbd\u5e73\u5747\u51cf\u5c11\u4e86 15%\uff0c\u9971\u548c\u7684 socket \u6570\u91cf\u51cf\u5c11\u4e86\u8fd1 8%\u3002   - \u6210\u529f\u5c06\u670d\u52a1\u5668\u7684CPU \u5229\u7528\u7387\u74f6\u9888\u4ece\u539f\u6765\u7684 40-50% \u63d0\u5347\u81f3\u76ee\u6807\u7684 70-80% \u533a\u95f4\u3002 - \u5173\u952e\u6027\u80fd\u6307\u6807\u5bf9\u6bd4\u5982\u4e0b\u8868\u6240\u793a\uff1a</p> \u6307\u6807 \u6539\u8fdb\u5e45\u5ea6 \u5e94\u7528\u541e\u5410\u91cf +10% \u5185\u5b58\u5ef6\u8fdf (\u4e2d\u4f4d\u6570) -13% \u5185\u5b58\u5ef6\u8fdf (P99) -10% Socket \u5185\u5b58\u5e26\u5bbd -15% CPU \u5229\u7528\u7387\u4e0a\u9650 40-50% \u2192 70-80% <ul> <li></li> </ul> <p></p> <p>Figure 16. Limoncello application throughput gain. Application throughput increases by 6-13% increase, dependent on the CPU utilization level of the machines.</p> <ul> <li></li> </ul> <p></p> <p>Figure 17. Limoncello memory latency reduction. Memory latency reduces by 13% in the median and 10% in the P99.</p> <ul> <li></li> </ul> <p></p> <p>Figure 18. Limoncello socket bandwidth usage reduction. Average socket bandwidth reduces by 15%.</p> <ul> <li></li> </ul> <p></p> <p>Figure 19. Increase in CPU utilization due to Limoncello. Before Limoncello, memory bandwidth saturation was reached in the 40-50% CPU utilization band (Figure 4), but with Limoncello memory bandwidth saturation is not met until the 70-80% band. Sizes of the markers are in proportion to the fraction of platform servers in the CPU usage bucket.</p> <p>\u7ed3\u8bba - \u5728\u5927\u89c4\u6a21\u3001\u9ad8\u5229\u7528\u7387\u7684\u6570\u636e\u4e2d\u5fc3\u573a\u666f\u4e0b\uff0c\u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\u8bbe\u8ba1\u54f2\u5b66\uff08\u4f18\u5148\u8003\u8651\u8986\u76d6\u7387\u800c\u975e\u5e26\u5bbd\u6548\u7387\uff09\u5df2\u4e0d\u518d\u9002\u7528\uff0c\u751a\u81f3\u4f1a\u6210\u4e3a\u6027\u80fd\u74f6\u9888\u3002 - \u786c\u4ef6\u4e0e\u8f6f\u4ef6\u534f\u540c\u7684\u9884\u53d6\u7b56\u7565\uff08\u5373 Limoncello\uff09\u80fd\u591f\u6709\u6548\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\u3002\u901a\u8fc7\u5728\u9ad8\u5e26\u5bbd\u538b\u529b\u4e0b\u7981\u7528\u4f4e\u6548\u7684\u786c\u4ef6\u9884\u53d6\uff0c\u5e76\u8f85\u4ee5\u9488\u5bf9\u5173\u952e\u201c\u6570\u636e\u4e2d\u5fc3\u7a0e\u201d\u51fd\u6570\u7684\u7cbe\u51c6\u8f6f\u4ef6\u9884\u53d6\uff0c\u53ef\u4ee5\u5728\u4e0d\u727a\u7272\u7f13\u5b58\u547d\u4e2d\u7387\u7684\u524d\u63d0\u4e0b\uff0c\u5927\u5e45\u964d\u4f4e\u5185\u5b58\u5ef6\u8fdf\u5e76\u63d0\u5347\u7cfb\u7edf\u6574\u4f53\u541e\u5410\u91cf\u3002 - \u8be5\u5de5\u4f5c\u8bc1\u660e\u4e86\u5782\u76f4\u6574\u5408 (vertical integration) \u548c\u8f6f\u4ef6\u5b9a\u4e49\u7684\u786c\u4ef6\u8c03\u63a7\u5728\u73b0\u4ee3\u6570\u636e\u4e2d\u5fc3\u4f18\u5316\u4e2d\u7684\u5de8\u5927\u6f5c\u529b\uff0c\u5e76\u4e3a\u672a\u6765\u7684\u786c\u4ef6-\u8f6f\u4ef6\u63a5\u53e3 (Hardware-Software Interfaces) \u8bbe\u8ba1\u6307\u660e\u4e86\u65b0\u65b9\u5411\u3002</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f</p> <ul> <li>\u73b0\u4ee3\u8d85\u5927\u89c4\u6a21\u6570\u636e\u4e2d\u5fc3\u9762\u4e34\u4e25\u91cd\u7684 \u5185\u5b58\u5899 (memory wall) \u95ee\u9898\uff0c\u5185\u5b58\u5ef6\u8fdf\u5360\u7528\u4e86\u8fd1 40% \u7684CPU\u5468\u671f\uff0c\u6210\u4e3a\u4e3b\u8981\u6027\u80fd\u74f6\u9888\u3002</li> <li>\u4f20\u7edf\u7684 \u786c\u4ef6\u9884\u53d6\u5668 (hardware prefetchers) \u5728\u8bbe\u8ba1\u65f6\u901a\u5e38\u9488\u5bf9\u5982 SPEC \u7b49\u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6\u8fdb\u884c\u4f18\u5316\uff0c\u8fd9\u4e9b\u573a\u666f\u901a\u5e38 \u5185\u5b58\u5e26\u5bbd\u5145\u88d5\u3002</li> <li>\u7136\u800c\uff0c\u5728\u771f\u5b9e\u7684\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e2d\uff0c\u7cfb\u7edf\u957f\u671f\u8fd0\u884c\u5728 \u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387 \u72b6\u6001\u4e0b\u3002\u5728\u6b64\u573a\u666f\u4e2d\uff0c\u6fc0\u8fdb\u7684\u786c\u4ef6\u9884\u53d6\u5668\u4f1a\u4ea7\u751f\u5927\u91cf \u4e0d\u51c6\u786e\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u4e0d\u4ec5\u6d6a\u8d39\u5b9d\u8d35\u7684\u5185\u5b58\u5e26\u5bbd\uff0c\u8fd8\u4f1a\u56e0 \u961f\u5217\u5ef6\u8fdf\u589e\u52a0 \u800c\u663e\u8457 \u6076\u5316\u5185\u5b58\u5ef6\u8fdf\u3002</li> <li>\u540c\u65f6\uff0c\u5185\u5b58\u5e26\u5bbd/\u6838\u5fc3 \u7684\u786c\u4ef6\u53d1\u5c55\u8d8b\u52bf\u5df2\u8d8b\u4e8e\u505c\u6ede\uff0c\u800c\u5de5\u4f5c\u8d1f\u8f7d\u7684 \u5185\u5b58\u5e26\u5bbd\u9700\u6c42 \u5374\u5728\u6301\u7eed\u589e\u957f\uff0c\u5bfc\u81f4\u670d\u52a1\u5668\u5728\u8fbe\u5230\u76ee\u6807 CPU\u5229\u7528\u7387 (70-80%) \u524d\u5c31\u56e0\u5185\u5b58\u5e26\u5bbd\u9971\u548c\u800c\u65e0\u6cd5\u8c03\u5ea6\u66f4\u591a\u4efb\u52a1\u3002</li> </ul> <p></p> <p>Figure 2. Memory bandwidth per core has plateaued over several generations of server CPUs.</p> <p></p> <p>Figure 3. Average memory bandwidth usage of fleet workloads has increased over the last 4 years. Each point in the graph shows memory bandwidth usage per compute unit averaged across all workloads in the fleet.</p> <p></p> <p>Figure 4. Memory bandwidth can saturate with just 50% CPU utilization in a bandwidth-bound platform. Sizes of the markers are in proportion to the number of platform servers in the CPU usage bucket.</p> <p>\u7814\u7a76\u52a8\u673a</p> <ul> <li>\u7814\u7a76\u56e2\u961f\u901a\u8fc7\u5728Google\u6570\u4e07\u53f0\u673a\u5668\u4e0a\u8fdb\u884c\u5b9e\u9a8c\u53d1\u73b0\uff0c\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668 \u867d\u7136\u4f1a\u5bfc\u81f4 LLC miss rate (\u7f13\u5b58\u672a\u547d\u4e2d\u7387) \u4e0a\u5347\u7ea620%\uff0c\u5374\u80fd\u5e26\u6765 15%\u7684\u5185\u5b58\u5ef6\u8fdf\u964d\u4f4e \u548c 11.2%-15.7%\u7684\u5185\u5b58\u5e26\u5bbd\u8282\u7701\u3002</li> <li>\u8fd9\u63ed\u793a\u4e86\u4e00\u4e2a\u5173\u952e\u77db\u76fe\uff1a\u5728 \u4f4e\u5e26\u5bbd\u5229\u7528\u7387 \u573a\u666f\u4e0b\uff0c\u5e94\u4f18\u5316 \u7f13\u5b58\u547d\u4e2d\u7387\uff1b\u800c\u5728 \u9ad8\u5e26\u5bbd\u5229\u7528\u7387 \u573a\u666f\u4e0b\uff08\u6570\u636e\u4e2d\u5fc3\u5e38\u6001\uff09\uff0c\u5e94\u4f18\u5148\u4f18\u5316 \u5185\u5b58\u5ef6\u8fdf\u3002</li> <li>\u4f20\u7edf\u7684 \u8f6f\u4ef6\u9884\u53d6 (software prefetching) \u65b9\u6cd5\u4f9d\u8d56\u4e8e\u6709\u4ee3\u8868\u6027\u7684\u57fa\u51c6\u6d4b\u8bd5\uff0c\u8fd9\u5728\u5de5\u4f5c\u8d1f\u8f7d\u548c\u8f93\u5165\u6781\u5176\u591a\u6837\u5316\u7684\u5927\u578b\u751f\u4ea7\u96c6\u7fa4\u4e2d\u96be\u4ee5\u5b9e\u73b0\u3002</li> <li>\u56e0\u6b64\uff0c\u9700\u8981\u4e00\u79cd\u80fd\u591f \u52a8\u6001\u9002\u5e94 \u7cfb\u7edf\u8d1f\u8f7d\u72b6\u6001\uff0c\u5e76\u7ed3\u5408 \u786c\u4ef6\u4e0e\u8f6f\u4ef6\u4f18\u52bf \u7684\u65b0\u578b\u9884\u53d6\u65b9\u6848\u3002</li> </ul> <p></p> <p>Figure 1. Average load-to-use latency per DRAM request reduces by 15% when hardware prefetchers are disabled. Data is gathered using the Intel MLC tool [10].</p> <p></p> <p>Table 1. Disabling hardware prefetchers reduces both average and tail memory bandwidth.</p> <p>\u6838\u5fc3\u8d21\u732e</p> <ul> <li>\u63d0\u51fa\u5e76\u5b9e\u73b0\u4e86 Limoncello\uff0c\u4e00\u4e2a\u7eaf\u8f6f\u4ef6\u7684\u3001\u53ef\u5927\u89c4\u6a21\u90e8\u7f72\u7684\u52a8\u6001\u9884\u53d6\u63a7\u5236\u7cfb\u7edf\uff0c\u65e0\u9700\u4efb\u4f55\u786c\u4ef6\u4fee\u6539\u3002</li> <li>Limoncello \u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a</li> <li>Hard Limoncello: \u57fa\u4e8e\u5b9e\u65f6 socket\u7ea7\u5185\u5b58\u5e26\u5bbd\u9065\u6d4b \u6570\u636e\uff0c\u52a8\u6001\u5730 \u542f\u7528\u6216\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\u3002\u5f53\u5e26\u5bbd\u5229\u7528\u7387\u8d85\u8fc7\u9608\u503c\uff08\u598280%\uff09\u65f6\u7981\u7528\u4ee5\u964d\u4f4e\u5ef6\u8fdf\uff0c\u4f4e\u4e8e\u53e6\u4e00\u9608\u503c\uff08\u598260%\uff09\u65f6\u91cd\u65b0\u542f\u7528\u4ee5\u63d0\u9ad8\u547d\u4e2d\u7387\uff0c\u5e76\u5f15\u5165 \u6ede\u540e\u673a\u5236 (hysteresis) \u907f\u514d\u9891\u7e41\u5207\u6362\u3002</li> <li>Soft Limoncello: \u901a\u8fc7\u5927\u89c4\u6a21 \u786c\u4ef6\u6d88\u878d\u7814\u7a76 (hardware ablation study)\uff0c\u7cbe\u51c6\u8bc6\u522b\u51fa\u5bf9\u786c\u4ef6\u9884\u53d6\u6700\u654f\u611f\u7684\u201c\u6570\u636e\u4e2d\u5fc3\u7a0e (data center tax)\u201d\u51fd\u6570\uff08\u5982\u538b\u7f29\u3001\u54c8\u5e0c\u3001\u6570\u636e\u4f20\u8f93\u3001memcpy\uff09\uff0c\u5e76\u5728\u8fd9\u4e9b\u51fd\u6570\u4e2d \u624b\u52a8\u63d2\u5165\u7cbe\u7ec6\u8c03\u4f18\u7684\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\uff0c\u4ee5\u5f25\u8865\u7981\u7528\u786c\u4ef6\u9884\u53d6\u540e\u7684\u6027\u80fd\u635f\u5931\u3002</li> <li>\u5728Google\u751f\u4ea7\u96c6\u7fa4\u7684\u5927\u89c4\u6a21\u90e8\u7f72\u8bc4\u4f30\u8868\u660e\uff0cLimoncello\u53d6\u5f97\u4e86\u663e\u8457\u6210\u6548\uff1a</li> <li>\u5e94\u7528\u541e\u5410\u91cf\u63d0\u534710%\u3002</li> <li>\u5185\u5b58\u5ef6\u8fdf\u964d\u4f4e15%\uff08\u4e2d\u4f4d\u6570\u964d\u4f4e13%\uff0cP99\u964d\u4f4e10%\uff09\u3002</li> <li>Socket\u5185\u5b58\u5e26\u5bbd\u5e73\u5747\u51cf\u5c1115%\uff0c\u4f7f\u670d\u52a1\u5668\u80fd\u5728\u66f4\u9ad8CPU\u5229\u7528\u7387\uff0870-80%\uff09\u4e0b\u7a33\u5b9a\u8fd0\u884c\u3002</li> </ul> <p></p> <p>Figure 5. Memory bandwidth usage on SPEC with and without hardware prefetching over 3 generations of a server platform. We see a 30-40% increase in memory bandwidth usage when hardware prefetching is enabled.</p> <p></p> <p>Figure 16. Limoncello application throughput gain. Application throughput increases by 6-13% increase, dependent on the CPU utilization level of the machines.</p> <p></p> <p>Figure 17. Limoncello memory latency reduction. Memory latency reduces by 13% in the median and 10% in the P99.</p> <p></p> <p>Figure 18. Limoncello socket bandwidth usage reduction. Average socket bandwidth reduces by 15%.</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>Limoncello \u662f\u4e00\u4e2a\u8f6f\u4ef6\u4e3a\u4e2d\u5fc3\u7684\u7cfb\u7edf\uff0c\u901a\u8fc7\u52a8\u6001\u534f\u540c Hard Limoncello\uff08\u786c\u4ef6\u9884\u53d6\u5668\u8c03\u63a7\uff09\u548c Soft Limoncello\uff08\u9488\u5bf9\u6027\u8f6f\u4ef6\u9884\u53d6\uff09\u4e24\u4e2a\u7ec4\u4ef6\uff0c\u5728\u65e0\u9700\u4efb\u4f55\u786c\u4ef6\u4fee\u6539\u7684\u524d\u63d0\u4e0b\uff0c\u4f18\u5316\u9ad8\u5229\u7528\u7387\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e0b\u7684\u5185\u5b58\u6027\u80fd\u3002</p> <ul> <li>\u6838\u5fc3\u76ee\u6807\uff1a\u5728\u5185\u5b58\u5e26\u5bbd\u53d7\u9650\u7684\u9ad8\u8d1f\u8f7d\u573a\u666f\u4e0b\uff0c\u901a\u8fc7\u5173\u95ed\u4f4e\u6548\u7684\u786c\u4ef6\u9884\u53d6\u5668\u6765\u964d\u4f4e\u5185\u5b58\u5ef6\u8fdf\uff0c\u5e76\u8f85\u4ee5\u7cbe\u51c6\u7684\u8f6f\u4ef6\u9884\u53d6\u6765\u7ef4\u6301\u5173\u952e\u51fd\u6570\u7684\u7f13\u5b58\u547d\u4e2d\u7387\uff0c\u4ece\u800c\u63d0\u5347\u5e94\u7528\u541e\u5410\u91cf\u3002</li> <li>\u51b3\u7b56\u4f9d\u636e\uff1a\u7cfb\u7edf\u4f9d\u8d56\u4e8e\u5168\u8230\u961f\u8303\u56f4\uff08fleetwide\uff09\u7684\u5b9e\u65f6\u9065\u6d4b\u6570\u636e\u548c\u5386\u53f2\u6027\u80fd\u5256\u6790\uff0c\u5b9e\u73b0\u4e86\u5bf9\u5de5\u4f5c\u8d1f\u8f7d\u7279\u6027\u7684\u6df1\u523b\u7406\u89e3\u4e0e\u52a8\u6001\u54cd\u5e94\u3002</li> </ul> <p>Hard Limoncello: \u52a8\u6001\u786c\u4ef6\u9884\u53d6\u5668\u8c03\u63a7</p> <p>\u8be5\u7ec4\u4ef6\u8d1f\u8d23\u6839\u636e\u5b9e\u65f6\u5185\u5b58\u5e26\u5bbd\u538b\u529b\uff0c\u52a8\u6001\u5f00\u5173\u6574\u4e2a CPU socket \u7684\u786c\u4ef6\u9884\u53d6\u5668\u3002</p> <ul> <li>\u89e6\u53d1\u6761\u4ef6\uff1a\u57fa\u4e8e\u6bcf\u79d2\u91c7\u96c6\u7684 socket-level \u5185\u5b58\u5e26\u5bbd\u9065\u6d4b\u6570\u636e\u3002</li> <li>\u63a7\u5236\u903b\u8f91\uff1a\u91c7\u7528\u5e26\u6709\u6ede\u540e\uff08hysteresis\uff09\u7684\u53cc\u9608\u503c\u72b6\u6001\u673a\uff0c\u907f\u514d\u56e0\u5e26\u5bbd\u6ce2\u52a8\u5bfc\u81f4\u9891\u7e41\u5207\u6362\u3002</li> <li>\u5f53\u5185\u5b58\u5e26\u5bbd\u6301\u7eed\u8d85\u8fc7\u4e0a\u9650\u9608\u503c\uff08\u4f8b\u5982 80% \u7684\u5e73\u53f0\u9971\u548c\u5e26\u5bbd\uff09\u65f6\uff0c\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\u3002</li> <li>\u5f53\u5185\u5b58\u5e26\u5bbd\u6301\u7eed\u4f4e\u4e8e\u4e0b\u9650\u9608\u503c\uff08\u4f8b\u5982 60% \u7684\u5e73\u53f0\u9971\u548c\u5e26\u5bbd\uff09\u65f6\uff0c\u91cd\u65b0\u542f\u7528\u786c\u4ef6\u9884\u53d6\u5668\u3002</li> <li>\u6267\u884c\u65b9\u5f0f\uff1a\u901a\u8fc7\u5411 CPU \u7684 Model-Specific Registers (MSRs) \u5199\u5165\u7279\u5b9a\u503c\u6765\u5b9e\u73b0\u786c\u4ef6\u9884\u53d6\u5668\u7684\u5f00\u5173\u3002</li> <li>\u8bbe\u8ba1\u52a8\u673a\uff1a\u5982 </li> </ul> <p></p> <p>Figure 1. Average load-to-use latency per DRAM request reduces by 15% when hardware prefetchers are disabled. Data is gathered using the Intel MLC tool [10].</p> <p>\u6240\u793a\uff0c\u5728\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\u4e0b\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u4f1a\u663e\u8457\u589e\u52a0 load-to-use latency\uff1b\u800c\u7981\u7528\u5b83\u4eec\u53ef\u4ee5\u5e26\u6765 15% \u7684\u5ef6\u8fdf\u964d\u4f4e\u3002</p> <p></p> <p>Figure 6. Limoncello disables hardware prefetchers when memory bandwidth utilization is high to optimize for memory latency.</p> <p>Soft Limoncello: \u7cbe\u51c6\u8f6f\u4ef6\u9884\u53d6\u6ce8\u5165</p> <p>\u8be5\u7ec4\u4ef6\u65e8\u5728\u5f25\u8865 Hard Limoncello \u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u540e\uff0c\u5bf9\u7279\u5b9a\u5173\u952e\u51fd\u6570\u9020\u6210\u7684\u7f13\u5b58\u7f3a\u5931\u60e9\u7f5a\u3002</p> <ul> <li>\u76ee\u6807\u8bc6\u522b\uff1a\u901a\u8fc7\u5927\u89c4\u6a21\u7684\u786c\u4ef6\u6d88\u878d\u5b9e\u9a8c\uff08ablation study\uff09\uff0c\u5bf9\u6bd4\u5f00\u542f/\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u65f6\u7684\u51fd\u6570\u7ea7\u6027\u80fd\u5256\u6790\u6570\u636e\uff0c\u8bc6\u522b\u51fa\u5bf9\u786c\u4ef6\u9884\u53d6\u6700\u654f\u611f\u7684\u201cdata center tax functions\u201d\u3002</li> <li>\u8fd9\u4e9b\u51fd\u6570\u5305\u62ec\uff1aCompression\uff08\u538b\u7f29\uff09\u3001Data transmission\uff08\u6570\u636e\u4f20\u8f93\uff09\u3001Hashing\uff08\u54c8\u5e0c\uff09\u548c Data movement\uff08\u5982 <code>memcpy</code>\uff09\u3002</li> <li>\u5982 </li> </ul> <p></p> <p>Figure 10. Application throughput based on different Hard Limoncello configurations. ?? /?? indicates the lower (?? %) and upper (?? %) memory bandwidth thresholds in the configuration. Thresholds are expressed as a percentage of memory bandwidth saturation.</p> <p>\u548c </p> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p> <p>\u6240\u793a\uff0c\u8fd9\u4e9b\u51fd\u6570\u5728\u786c\u4ef6\u9884\u53d6\u5173\u95ed\u540e\u8868\u73b0\u51fa\u663e\u8457\u7684 CPU cycles \u548c LLC MPKI \u589e\u52a0\u3002 - \u9884\u53d6\u7b56\u7565\uff1a\u9488\u5bf9\u5df2\u8bc6\u522b\u7684\u76ee\u6807\u51fd\u6570\uff0c\u624b\u52a8\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\uff0c\u5e76\u7cbe\u7ec6\u8c03\u4f18\u4e09\u4e2a\u5173\u952e\u53c2\u6570\uff1a   - Prefetch address\uff08\u9884\u53d6\u5730\u5740\uff09\uff1a\u9009\u62e9\u6700\u80fd\u53d7\u76ca\u7684\u5185\u5b58\u8bbf\u95ee\u70b9\u3002   - Prefetch distance\uff08\u9884\u53d6\u8ddd\u79bb\uff09\uff1a\u51b3\u5b9a\u63d0\u524d\u591a\u5c11\u5b57\u8282\u53d1\u8d77\u9884\u53d6\u3002   - Prefetch degree\uff08\u9884\u53d6\u5ea6\uff09\uff1a\u51b3\u5b9a\u4e00\u6b21\u9884\u53d6\u591a\u5c11\u8fde\u7eed\u6570\u636e\u3002 - \u8c03\u4f18\u65b9\u6cd5\uff1a\u7ed3\u5408\u8230\u961f\u7ea7\u5256\u6790\u6570\u636e\uff08\u5982 <code>memcpy</code> \u7684\u53c2\u6570\u5927\u5c0f\u5206\u5e03\uff0c\u89c1 \uff09\u548c\u5fae\u57fa\u51c6\u6d4b\u8bd5\uff08microbenchmarks\uff09\uff0c\u8fed\u4ee3\u5bfb\u627e\u6700\u4f18\u53c2\u6570\u7ec4\u5408\u3002</p> <p>\u534f\u540c\u5de5\u4f5c\u6d41\u7a0b</p> <p>Limoncello \u7684\u4e24\u4e2a\u7ec4\u4ef6\u534f\u540c\u5de5\u4f5c\uff0c\u5f62\u6210\u4e00\u4e2a\u95ed\u73af\u7684\u52a8\u6001\u4f18\u5316\u7cfb\u7edf\u3002</p> <ol> <li>\u76d1\u63a7\u9636\u6bb5\uff1a\u7cfb\u7edf\u6301\u7eed\u76d1\u63a7\u6bcf\u4e2a socket \u7684\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u3002</li> <li>\u51b3\u7b56\u4e0e\u6267\u884c\uff08Hard Limoncello\uff09 \u6839\u636e\u9884\u8bbe\u9608\u503c\uff0c\u52a8\u6001\u5f00\u5173\u786c\u4ef6\u9884\u53d6\u5668\u3002\u5728\u4f4e\u8d1f\u8f7d\u65f6\u5229\u7528\u786c\u4ef6\u9884\u53d6\uff0c\u5728\u9ad8\u8d1f\u8f7d\u65f6\u5173\u95ed\u4ee5\u8282\u7701\u5e26\u5bbd\u3001\u964d\u4f4e\u5ef6\u8fdf\u3002</li> <li>\u8865\u507f\u4e0e\u4f18\u5316\uff08Soft Limoncello\uff09 \u5728\u786c\u4ef6\u9884\u53d6\u5668\u88ab\u5173\u95ed\u7684\u9ad8\u8d1f\u8f7d\u573a\u666f\u4e0b\uff0c\u7531\u9884\u5148\u690d\u5165\u7684\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\u4e3a\u5173\u952e\u7684\u201cdata center tax functions\u201d\u63d0\u4f9b\u7cbe\u51c6\u7684\u6570\u636e\u9884\u53d6\uff0c\u9632\u6b62\u5176\u6027\u80fd\u4e25\u91cd\u9000\u5316\u3002</li> <li>\u6548\u679c\uff1a\u5982 </li> </ol> <p></p> <p>Figure 16. Limoncello application throughput gain. Application throughput increases by 6-13% increase, dependent on the CPU utilization level of the machines.</p> <p>\u3001</p> <p></p> <p>Figure 17. Limoncello memory latency reduction. Memory latency reduces by 13% in the median and 10% in the P99.</p> <p>\u548c </p> <p></p> <p>Figure 18. Limoncello socket bandwidth usage reduction. Average socket bandwidth reduces by 15%.</p> <p>\u6240\u793a\uff0c\u8be5\u67b6\u6784\u6700\u7ec8\u5b9e\u73b0\u4e86 10% \u7684\u5e94\u7528\u541e\u5410\u91cf\u63d0\u5347\u300115% \u7684\u5185\u5b58\u5ef6\u8fdf\u964d\u4f4e\u548c 15% \u7684 socket \u5e26\u5bbd\u6d88\u8017\u51cf\u5c11\u3002</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#1-hard-limoncello","title":"1. Hard Limoncello","text":"<p>\u6838\u5fc3\u673a\u5236\u4e0e\u5b9e\u73b0\u539f\u7406</p> <ul> <li>Hard Limoncello \u7684\u6838\u5fc3\u662f\u4e00\u4e2a\u8f6f\u4ef6\u63a7\u5236\u5668 (software controller)\uff0c\u5b83\u901a\u8fc7\u52a8\u6001\u5730\u542f\u7528\u6216\u7981\u7528 CPU \u7684\u786c\u4ef6\u9884\u53d6\u5668 (hardware prefetchers) \u6765\u4f18\u5316\u7cfb\u7edf\u5728\u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u4e0b\u7684\u6027\u80fd\u3002</li> <li>\u5176\u57fa\u672c\u539f\u7406\u6e90\u4e8e\u4e00\u4e2a\u5173\u952e\u89c2\u5bdf\uff1a\u5728\u5185\u5b58\u5e26\u5bbd\u7a00\u7f3a\u7684\u73af\u5883\u4e2d\uff08\u5982\u5927\u578b\u6570\u636e\u4e2d\u5fc3\u7684\u9ad8\u8d1f\u8f7d\u65f6\u6bb5\uff09\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u867d\u7136\u80fd\u964d\u4f4e\u7f13\u5b58\u672a\u547d\u4e2d\u7387 (cache miss rate)\uff0c\u4f46\u5176\u4ea7\u751f\u7684\u989d\u5916\u5185\u5b58\u6d41\u91cf\u4f1a\u52a0\u5267\u5185\u5b58\u5b50\u7cfb\u7edf\u7684\u62e5\u585e\uff0c\u4ece\u800c\u663e\u8457\u589e\u52a0\u5185\u5b58\u5ef6\u8fdf (memory latency) \u548c\u52a0\u8f7d\u5230\u4f7f\u7528\u5ef6\u8fdf (load-to-use latency)\u3002\u56fe1\u6e05\u6670\u5730\u5c55\u793a\u4e86\u8fd9\u4e00\u73b0\u8c61\uff0c\u5728\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\u4e0b\uff0c\u5f00\u542f\u786c\u4ef6\u9884\u53d6\u5668\uff08\u84dd\u8272\u7ebf\uff09\u6bd4\u5173\u95ed\u65f6\uff08\u6a59\u8272\u7ebf\uff09\u7684\u5ef6\u8fdf\u9ad8\u51fa\u8fd1\u4e00\u500d\u3002</li> <li>\u56e0\u6b64\uff0cHard Limoncello \u7684\u7b56\u7565\u662f\uff1a\u5728\u4f4e\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u65f6\uff0c\u4fdd\u7559\u786c\u4ef6\u9884\u53d6\u5668\u4ee5\u4f18\u5316\u7f13\u5b58\u547d\u4e2d\uff1b\u5728\u9ad8\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u65f6\uff0c\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\u4ee5\u91ca\u653e\u5b9d\u8d35\u7684\u5185\u5b58\u5e26\u5bbd\u3001\u964d\u4f4e\u5ef6\u8fdf\u3002</li> </ul> <p></p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u63a7\u5236\u903b\u8f91</p> <ul> <li>\u63a7\u5236\u5668\u7684\u51b3\u7b56\u57fa\u4e8esocket-level\uff08\u5957\u63a5\u5b57\u7ea7\u522b\uff09\u7684\u5185\u5b58\u5e26\u5bbd\u9065\u6d4b\u6570\u636e (telemetry)\uff0c\u8be5\u6570\u636e\u901a\u8fc7 <code>perf</code> \u5de5\u5177\u6bcf\u79d2\u91c7\u96c6\u4e00\u6b21\u3002</li> <li>\u4e3a\u4e86\u907f\u514d\u56e0\u5185\u5b58\u5e26\u5bbd\u7684\u77ed\u671f\u6ce2\u52a8\uff08\u5982\u56fe7\u6240\u793a\uff09\u800c\u5bfc\u81f4\u9884\u53d6\u5668\u72b6\u6001\u9891\u7e41\u5207\u6362\uff0c\u63a7\u5236\u5668\u5f15\u5165\u4e86\u8fdf\u6ede\u673a\u5236 (hysteresis)\uff0c\u5177\u4f53\u4f53\u73b0\u5728\u4e24\u4e2a\u65b9\u9762\uff1a<ul> <li>\u53cc\u9608\u503c\u8bbe\u8ba1: \u8bbe\u7f6e\u4e00\u4e2a\u8f83\u9ad8\u7684\u4e0a\u9608\u503c (upper threshold) \u7528\u4e8e\u89e6\u53d1\u7981\u7528\u64cd\u4f5c\uff0c\u548c\u4e00\u4e2a\u8f83\u4f4e\u7684\u4e0b\u9608\u503c (lower threshold) \u7528\u4e8e\u89e6\u53d1\u91cd\u65b0\u542f\u7528\u64cd\u4f5c\u3002</li> <li>\u6301\u7eed\u65f6\u95f4\u8981\u6c42: \u5185\u5b58\u5e26\u5bbd\u5fc5\u987b\u5728\u4e0a\u9608\u503c\u4e4b\u4e0a\uff08\u6216\u4e0b\u9608\u503c\u4e4b\u4e0b\uff09\u6301\u7eed\u4e00\u6bb5\u9884\u8bbe\u7684\u65f6\u95f4\uff0c\u63a7\u5236\u5668\u624d\u4f1a\u6267\u884c\u72b6\u6001\u5207\u6362\u3002</li> </ul> </li> <li>\u6574\u4e2a\u63a7\u5236\u903b\u8f91\u88ab\u5c01\u88c5\u5728\u4e00\u4e2a\u72b6\u6001\u673a (state machine) \u4e2d\uff08\u5982\u56fe8\u6240\u793a\uff09\uff0c\u786e\u4fdd\u4e86\u72b6\u6001\u8f6c\u6362\u7684\u5e73\u6ed1\u548c\u7a33\u5b9a\u3002</li> </ul> <p></p> <p>Figure 7. Memory bandwidth variability in a machine.</p> <p></p> <p>Figure 8. State diagram of Hard Limoncello controller for modulating hardware prefetchers. Green (lighter) indicates hardware prefetchers are off, blue (darker) that they are on.</p> <ul> <li>\u5177\u4f53\u6267\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a<ul> <li>\u5f53\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u6301\u7eed\u8d85\u8fc7\u4e0a\u9608\u503c\u65f6\uff0c\u63a7\u5236\u5668\u5411 CPU \u7684\u6a21\u578b\u7279\u5b9a\u5bc4\u5b58\u5668 (Model-Specific Registers, MSRs) \u5199\u5165\u7279\u5b9a\u503c\uff0c\u4ee5\u7981\u7528\u8be5 socket \u4e0a\u7684\u6240\u6709\u786c\u4ef6\u9884\u53d6\u5668\u3002</li> <li>\u9884\u53d6\u5668\u4e00\u65e6\u88ab\u7981\u7528\uff0c\u5373\u4f7f\u5e26\u5bbd\u56de\u843d\u5230\u4e0a\u9608\u503c\u4ee5\u4e0b\uff0c\u4e5f\u4e0d\u4f1a\u7acb\u5373\u91cd\u65b0\u5f00\u542f\u3002</li> <li>\u53ea\u6709\u5f53\u5e26\u5bbd\u5229\u7528\u7387\u6301\u7eed\u4f4e\u4e8e\u4e0b\u9608\u503c\u65f6\uff0c\u63a7\u5236\u5668\u624d\u4f1a\u518d\u6b21\u5199\u5165 MSR\uff0c\u91cd\u65b0\u542f\u7528\u786c\u4ef6\u9884\u53d6\u5668\u3002</li> </ul> </li> <li>\u56fe9\u63d0\u4f9b\u4e86\u4e00\u4e2a\u76f4\u89c2\u7684\u65f6\u95f4\u7ebf\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u8fd9\u79cd\u5e26\u6709\u8fdf\u6ede\u7684\u5f00\u5173\u884c\u4e3a\u3002</li> </ul> <p></p> <p>Figure 9. Hardware prefetcher state over time. The green lines in the figure show when hardware prefetchers are disabled. When machine load exceeds an upper threshold, hardware prefetchers are disabled and remain disabled until machine load returns below a lower threshold.</p> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u9608\u503c\u786e\u5b9a</p> <ul> <li>\u4e0a\u3001\u4e0b\u9608\u503c\u5e76\u975e\u968f\u610f\u8bbe\u5b9a\uff0c\u800c\u662f\u901a\u8fc7\u5728 Google \u751f\u4ea7\u96c6\u7fa4\u4e2d\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u786c\u4ef6\u6d88\u878d\u7814\u7a76 (hardware ablation study) \u786e\u5b9a\u7684\u3002</li> <li>\u5b9e\u9a8c\u65b9\u6cd5\u662f\u5728\u6570\u4e07\u53f0\u673a\u5668\u4e0a\u90e8\u7f72\u4e0d\u540c\u9608\u503c\u7ec4\u5408\u7684 Hard Limoncello\uff0c\u5e76\u76d1\u63a7\u5176\u5bf9\u5e94\u7528\u541e\u5410\u91cf (application throughput) \u7684\u5f71\u54cd\u3002</li> <li>\u6700\u7ec8\uff0c\u9608\u503c\u88ab\u5b9a\u4e49\u4e3a\u5e73\u53f0\u5185\u5b58\u5e26\u5bbd\u9971\u548c\u9608\u503c (memory bandwidth saturation threshold) \u7684\u4e00\u4e2a\u767e\u5206\u6bd4\u3002\u8be5\u9971\u548c\u9608\u503c\u662f\u5728\u673a\u5668\u8d44\u683c\u8ba4\u8bc1\u8fc7\u7a0b\u4e2d\u786e\u5b9a\u7684\uff0c\u8d85\u8fc7\u6b64\u9608\u503c\uff0c\u5185\u5b58\u5ef6\u8fdf\u4f1a\u6025\u5267\u4e0a\u5347\u3002</li> <li>\u5982\u56fe10\u6240\u793a\uff0c\u7ecf\u8fc7\u5b9e\u9a8c\u5206\u6790\uff0c80% \u4f5c\u4e3a\u4e0a\u9608\u503c\u300160% \u4f5c\u4e3a\u4e0b\u9608\u503c\u7684\u914d\u7f6e\uff08\u5373 60/80 \u914d\u7f6e\uff09\u80fd\u5e26\u6765\u6700\u4f73\u7684\u5e94\u7528\u541e\u5410\u91cf\u63d0\u5347\u3002</li> </ul> <p></p> <p>Figure 10. Application throughput based on different Hard Limoncello configurations. ?? /?? indicates the lower (?? %) and upper (?? %) memory bandwidth thresholds in the configuration. Thresholds are expressed as a percentage of memory bandwidth saturation.</p> <p>\u8f93\u5165\u3001\u8f93\u51fa\u53ca\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: \u6bcf\u79d2\u91c7\u96c6\u7684 socket \u7ea7\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u6570\u636e\u3002</li> <li>\u8f93\u51fa: \u5bf9 CPU MSR \u7684\u5199\u5165\u6307\u4ee4\uff0c\u7528\u4e8e\u63a7\u5236\u786c\u4ef6\u9884\u53d6\u5668\u7684\u5f00\u5173\u72b6\u6001\u3002</li> <li>\u5728 Limoncello \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:<ul> <li>Hard Limoncello \u662f\u6574\u4e2a\u7cfb\u7edf\u7684\u7b2c\u4e00\u9053\u9632\u7ebf\uff0c\u8d1f\u8d23\u5728\u5b8f\u89c2\u5c42\u9762\u89e3\u51b3\u9ad8\u8d1f\u8f7d\u4e0b\u7684\u5185\u5b58\u5e26\u5bbd\u4e89\u7528\u95ee\u9898\u3002</li> <li>\u5b83\u901a\u8fc7\u727a\u7272\u4e00\u90e8\u5206\u7f13\u5b58\u547d\u4e2d\u7387\uff08\u56e0\u4e3a\u7981\u7528\u4e86\u786c\u4ef6\u9884\u53d6\u5668\uff09\uff0c\u6362\u53d6\u4e86\u66f4\u4f4e\u7684\u5185\u5b58\u5ef6\u8fdf\u548c\u66f4\u9ad8\u7684\u6709\u6548\u5185\u5b58\u5e26\u5bbd\u5bb9\u91cf\uff08\u5982\u56fe4\u548c\u56fe19\u6240\u793a\uff0c\u8fd9\u4f7f\u5f97\u670d\u52a1\u5668 CPU \u5229\u7528\u7387\u53ef\u4ee5\u4ece 40-50% \u63d0\u5347\u81f3\u76ee\u6807\u7684 70-80%\uff09\u3002</li> <li>\u7136\u800c\uff0c\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\u4f1a\u5bfc\u81f4\u67d0\u4e9b\u5bf9\u9884\u53d6\u654f\u611f\u7684\u51fd\u6570\uff08\u5982\u6570\u636e\u79fb\u52a8\u3001\u538b\u7f29\u7b49\u201c\u6570\u636e\u4e2d\u5fc3\u7a0e\u201d\u51fd\u6570\uff09\u6027\u80fd\u4e0b\u964d\u3002\u8fd9\u90e8\u5206\u635f\u5931\u7531 Soft Limoncello \u7ec4\u4ef6\u901a\u8fc7\u7cbe\u51c6\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6 (software prefetching) \u6307\u4ee4\u6765\u5f25\u8865\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u786c\u4ef6\u4e0e\u8f6f\u4ef6\u534f\u540c\u7684\u6700\u4f18\u6548\u679c\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#2-soft-limoncello","title":"2. Soft Limoncello","text":"<p>Soft Limoncello \u7684\u5b9e\u73b0\u539f\u7406\u4e0e\u76ee\u6807\u51fd\u6570\u8bc6\u522b</p> <ul> <li>Soft Limoncello \u7684\u6838\u5fc3\u76ee\u6807\u662f\u5728 Hard Limoncello \u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u540e\uff0c\u901a\u8fc7\u7cbe\u51c6\u7684\u8f6f\u4ef6\u9884\u53d6\uff08software prefetching\uff09\u6765\u8865\u507f\u7279\u5b9a\u5173\u952e\u51fd\u6570\u56e0\u7f13\u5b58\u672a\u547d\u4e2d\u7387\uff08MPKI\uff09\u4e0a\u5347\u800c\u5bfc\u81f4\u7684\u6027\u80fd\u635f\u5931\u3002</li> <li>\u5176\u5b9e\u73b0\u4e0d\u4f9d\u8d56\u4e8e\u4f20\u7edf\u7684\u3001\u57fa\u4e8e\u4ee3\u8868\u6027\u57fa\u51c6\u6d4b\u8bd5\uff08representative benchmarks\uff09\u7684 profile-guided optimization (PGO)\uff0c\u56e0\u4e3a\u8fd9\u5728 Google \u5927\u89c4\u6a21\u3001\u9ad8\u591a\u6837\u6027\u7684\u751f\u4ea7\u73af\u5883\u4e2d\u96be\u4ee5\u594f\u6548\u3002</li> <li>\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u4e00\u79cd\u521b\u65b0\u7684\u3001\u57fa\u4e8e fleetwide hardware ablation study\uff08\u5168\u8230\u961f\u786c\u4ef6\u6d88\u878d\u7814\u7a76\uff09\u7684\u65b9\u6cd5\uff1a</li> <li>\u5728\u5927\u89c4\u6a21\u5b9e\u9a8c\u96c6\u7fa4\u4e0a\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u3002</li> <li>\u5229\u7528 Google \u5185\u90e8\u7684 global profiling tool \u6301\u7eed\u91c7\u96c6\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\u3001CPU \u4f7f\u7528\u7387\u548c LLC\uff08Last Level Cache\uff09\u672a\u547d\u4e2d\u6570\u636e\u3002</li> <li>\u901a\u8fc7\u5bf9\u6bd4\u5f00\u542f/\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u65f6\u5404\u51fd\u6570\u7684\u6027\u80fd\u5dee\u5f02\uff08\u7279\u522b\u662f CPU cycles \u548c LLC MPKI\uff09\uff0c\u8bc6\u522b\u51fa\u5bf9\u786c\u4ef6\u9884\u53d6\u9ad8\u5ea6\u4f9d\u8d56\u7684\u201cprefetch-friendly\u201d\u51fd\u6570\u3002</li> <li>\u5206\u6790\u53d1\u73b0\uff0c\u6027\u80fd\u56de\u9000\u6700\u4e25\u91cd\u7684\u51fd\u6570\u4e3b\u8981\u96c6\u4e2d\u5728\u6240\u8c13\u7684\u201cdata center tax\u201d\uff08\u6570\u636e\u4e2d\u5fc3\u7a0e\uff09\u64cd\u4f5c\u4e0a\uff0c\u8fd9\u4e9b\u51fd\u6570\u5305\u62ec\uff1a</li> <li>Compression/Decompression\uff1a\u5904\u7406\u8fde\u7eed\u5185\u5b58\u5757\uff0c\u8bbf\u95ee\u6a21\u5f0f\u53ef\u9884\u6d4b\u3002</li> <li>Data transmission\uff08\u5982 RPC \u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\uff09\uff1a\u6d89\u53ca\u53ef\u9884\u6d4b\u7684\u5185\u5b58\u8bfb\u5199\u3002</li> <li>Hashing\uff1a\u5bf9\u6570\u636e\u5757\u8fdb\u884c\u9884\u5b9a\u4e49\u5e8f\u5217\u7684\u64cd\u4f5c\u3002</li> <li>Data movement\uff08\u5982 <code>memcpy</code>, <code>memmove</code>\uff09\uff1a\u5bf9\u8fde\u7eed\u5185\u5b58\u533a\u57df\u8fdb\u884c\u64cd\u4f5c\u3002</li> </ul> <p></p> <p>Figure 10. Application throughput based on different Hard Limoncello configurations. ?? /?? indicates the lower (?? %) and upper (?? %) memory bandwidth thresholds in the configuration. Thresholds are expressed as a percentage of memory bandwidth saturation.</p> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p> <p></p> <p>Figure 12. Aggregated change in CPU cycles (%) from Hard Limoncello. Data center tax functions (green) increased in CPU cycles under Hard Limoncello. In contrast, overall nondata center tax functions (blue) decreased in cycles.</p> <p>\u8f6f\u4ef6\u9884\u53d6\u5668\u7684\u8bbe\u8ba1\u7a7a\u95f4\u4e0e\u53c2\u6570\u8c03\u4f18</p> <ul> <li>\u8f6f\u4ef6\u9884\u53d6\u7684\u6709\u6548\u6027\u9ad8\u5ea6\u4f9d\u8d56\u4e8e\u4e09\u4e2a\u5173\u952e\u8bbe\u8ba1\u53c2\u6570\u7684\u7cbe\u7ec6\u8c03\u6574\uff1a</li> <li>Prefetch address (\u9884\u53d6\u5730\u5740)\uff1a\u5fc5\u987b\u7cbe\u786e\u6307\u5411\u5373\u5c06\u88ab\u4f7f\u7528\u7684\u6570\u636e\u3002\u9519\u8bef\u7684\u5730\u5740\u4f1a\u5bfc\u81f4\u6d6a\u8d39\u5e26\u5bbd\u3002\u76ee\u6807\u5730\u5740\u901a\u5e38\u6765\u81ea\u51fd\u6570\u7684\u8c03\u7528\u53c2\u6570\uff08\u5982 <code>memcpy</code> \u7684\u6e90\u6307\u9488\uff09\u3002</li> <li>Prefetch distance (\u9884\u53d6\u8ddd\u79bb)\uff1a\u6307\u5728\u5b9e\u9645\u4f7f\u7528\u524d\u591a\u5c11\u6307\u4ee4\u6216\u5b57\u8282\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\u3002\u8ddd\u79bb\u592a\u8fd1\u4f1a\u5bfc\u81f4\u9884\u53d6\u4e0d\u53ca\u65f6\uff08untimely\uff09\uff0c\u592a\u8fdc\u5219\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u5728\u7f13\u5b58\u4e2d\u88ab\u66ff\u6362\uff08stale\uff09\u3002</li> <li>Prefetch degree (\u9884\u53d6\u5ea6)\uff1a\u6307\u4e00\u6b21\u9884\u53d6\u64cd\u4f5c\u83b7\u53d6\u7684\u6570\u636e\u91cf\uff08\u4f8b\u5982\uff0c\u591a\u5c11\u4e2a cache line\uff09\u3002\u5ea6\u592a\u5c0f\u6536\u76ca\u4f4e\uff0c\u592a\u5927\u5219\u53ef\u80fd\u5f15\u5165\u4e0d\u5fc5\u8981\u7684\u6570\u636e\uff0c\u6d6a\u8d39\u5e26\u5bbd\u3002</li> <li>\u4e3a\u4e86\u786e\u5b9a\u8fd9\u4e9b\u53c2\u6570\uff0cLimoncello \u56e2\u961f\u91c7\u7528\u4e86\u4ee5\u4e0b\u6d41\u7a0b\uff1a</li> <li>\u5229\u7528 fleetwide profiling \u5de5\u5177\u6536\u96c6\u76ee\u6807\u51fd\u6570\uff08\u5982 <code>memcpy</code>\uff09\u7684\u8c03\u7528\u53c2\u6570\u5927\u5c0f\u5206\u5e03\uff0c\u4ee5\u8bc6\u522b\u503c\u5f97\u4f18\u5316\u7684\u201c\u957f\u5c3e\u201d\u5927\u5c3a\u5bf8\u64cd\u4f5c\u3002</li> <li>\u9488\u5bf9\u8fd9\u4e9b\u5927\u5c3a\u5bf8\u64cd\u4f5c\uff0c\u5728\u5fae\u57fa\u51c6\u6d4b\u8bd5\uff08microbenchmarks\uff0c\u5982 LLVM libc \u5957\u4ef6\uff09\u548c\u8d1f\u8f7d\u6d4b\u8bd5\uff08load tests\uff09\u4e0a\u8fdb\u884c\u5e7f\u6cdb\u7684\u53c2\u6570\u626b\u63cf\uff08sweeping\uff09\u3002</li> <li>\u8fed\u4ee3\u6d4b\u8bd5\u4e0d\u540c\u7684\u5730\u5740\u3001\u8ddd\u79bb\u548c\u5ea6\u7684\u7ec4\u5408\uff0c\u9009\u62e9\u80fd\u5e26\u6765\u6b63\u5411\u6027\u80fd\u63d0\u5347\u7684\u914d\u7f6e\u3002</li> </ul> <p></p> <p>Figure 14. memcpy argument size distribution. The chart shows the probability density function (PDF) of the number of times each copy size appears in the profiling data. Most copy sizes are small.</p> <p></p> <p>Figure 13. Software prefetch instructions act on addresses at a distance and can prefetch different degrees of data.</p> <p>\u4ee5 memcpy \u4e3a\u4f8b\u7684\u5177\u4f53\u5b9e\u73b0</p> <ul> <li><code>memcpy</code> \u88ab\u8bc6\u522b\u4e3a\u4e00\u4e2a\u5178\u578b\u7684 prefetch-friendly \u51fd\u6570\uff0c\u56e0\u4e3a\u5b83\u5bf9\u8fde\u7eed\u5185\u5b58\u8fdb\u884c\u64cd\u4f5c\uff0c\u4e14\u8f6f\u4ef6\u53ef\u4ee5\u76f4\u63a5\u83b7\u77e5\u8bbf\u95ee\u7684\u5730\u5740\u548c\u957f\u5ea6\u3002</li> <li>Profiling \u6570\u636e\u663e\u793a\uff0c\u5927\u591a\u6570 <code>memcpy</code> \u8c03\u7528\u5c3a\u5bf8\u5f88\u5c0f\uff0c\u4f46\u5bfc\u81f4\u6027\u80fd\u56de\u9000\u7684\u5de5\u4f5c\u8d1f\u8f7d\u5f80\u5f80\u6709\u66f4\u5927\u7684\u5e73\u5747\u62f7\u8d1d\u5c3a\u5bf8\uff08\u6bd4\u975e\u56de\u9000\u5de5\u4f5c\u8d1f\u8f7d\u5927 26%\uff09\u3002</li> <li>\u56e0\u6b64\uff0c\u8f6f\u4ef6\u9884\u53d6\u4ec5\u9488\u5bf9\u8d85\u8fc7\u7279\u5b9a\u9608\u503c\u7684\u5927\u5c3a\u5bf8 <code>memcpy</code> \u8c03\u7528\u8fdb\u884c\u63d2\u5165\uff0c\u4ee5\u907f\u514d\u5bf9\u5c0f\u62f7\u8d1d\u9020\u6210\u4e0d\u5fc5\u8981\u7684\u5f00\u9500\u3002</li> <li>\u901a\u8fc7\u5728 LLVM libc \u5fae\u57fa\u51c6\u4e0a\u56fa\u5b9a\u4e00\u4e2a\u53c2\u6570\u5e76\u626b\u63cf\u53e6\u4e00\u4e2a\u53c2\u6570\uff0c\u56e2\u961f\u627e\u5230\u4e86\u6700\u4f18\u7684\u9884\u53d6\u8ddd\u79bb\u548c\u5ea6\u3002</li> </ul> <p></p> <p></p> <p>(b) Microbenchmark exercising different prefetch degrees. Prefetching is fixed at a distance of 512 bytes.</p> <p></p> <p>Figure 15. Soft Limoncello memcpy microbenchmarking.</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165\uff1a</li> <li>\u6765\u81ea Hard Limoncello \u7684\u4fe1\u53f7\uff1a\u786c\u4ef6\u9884\u53d6\u5668\u5df2\u88ab\u5173\u95ed\u3002</li> <li>Fleetwide profiling \u6570\u636e\uff1a\u7528\u4e8e\u8bc6\u522b\u76ee\u6807\u51fd\u6570\u53ca\u5176\u8c03\u7528\u7279\u5f81\uff08\u5982\u53c2\u6570\u5927\u5c0f\uff09\u3002</li> <li>\u5fae\u57fa\u51c6\u548c\u8d1f\u8f7d\u6d4b\u8bd5\u7ed3\u679c\uff1a\u7528\u4e8e\u786e\u5b9a\u6700\u4f18\u7684\u9884\u53d6\u53c2\u6570\u3002</li> <li>\u8f93\u51fa\uff1a</li> <li>\u5728\u7279\u5b9a\u5e93\u51fd\u6570\uff08\u5982 glibc \u4e2d\u7684 <code>memcpy</code>\uff09\u7684\u6e90\u4ee3\u7801\u4e2d\u9759\u6001\u63d2\u5165\u7ecf\u8fc7\u8c03\u4f18\u7684\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\uff08\u5982 x86 \u7684 <code>prefetcht0</code>\uff09\u3002</li> <li>\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528\uff1a</li> <li>\u7ef4\u6301\u4f4e\u7f13\u5b58\u672a\u547d\u4e2d\u7387\uff1a\u5728\u786c\u4ef6\u9884\u53d6\u5668\u5173\u95ed\u7684\u9ad8\u5e26\u5bbd\u538b\u529b\u573a\u666f\u4e0b\uff0c\u901a\u8fc7\u7cbe\u51c6\u7684\u8f6f\u4ef6\u9884\u53d6\uff0c\u6709\u6548\u63a7\u5236\u4e86\u5173\u952e\u201c\u6570\u636e\u4e2d\u5fc3\u7a0e\u201d\u51fd\u6570\u7684 LLC MPKI\uff0c\u9632\u6b62\u4e86\u6027\u80fd\u5927\u5e45\u56de\u9000\u3002</li> <li>\u5b9e\u73b0\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\uff1aHard Limoncello \u8d1f\u8d23\u5b8f\u89c2\u5c42\u9762\u7684\u5e26\u5bbd\u7ba1\u7406\uff08\u5173\u6389\u5168\u5c40\u4f46\u4f4e\u6548\u7684\u786c\u4ef6\u9884\u53d6\uff09\uff0cSoft Limoncello \u8d1f\u8d23\u5fae\u89c2\u5c42\u9762\u7684\u6027\u80fd\u4fdd\u969c\uff08\u4e3a\u6700\u5173\u952e\u7684\u5c11\u6570\u51fd\u6570\u63d0\u4f9b\u9ad8\u6548\u3001\u7cbe\u51c6\u7684\u8f6f\u4ef6\u9884\u53d6\uff09\u3002</li> <li>\u6700\u7ec8\u6548\u679c\uff1a\u8bc4\u4f30\u6570\u636e\u663e\u793a\uff0cSoft Limoncello \u6210\u529f\u6d88\u9664\u4e86 Hard Limoncello \u5355\u72ec\u90e8\u7f72\u65f6\u89c2\u5bdf\u5230\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6027\u80fd\u56de\u9000\uff0c\u5e76\u5c06\u76ee\u6807\u51fd\u6570\u7684 CPU cycles \u663e\u8457\u964d\u4f4e\u3002</li> </ul> <p></p> <p>Figure 20. Software prefetcher impact in Limoncello. The y-axis shows the portion of fleetwide cycles spent in the respective function categories. The center bar (green) shows Hard Limoncello deployed without any software prefetchers. Adding software prefetchers into Limoncello lowered CPU cycles spent in targeted functions by 2% (yellow).</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#3_1","title":"3. \u57fa\u4e8e\u5927\u89c4\u6a21\u786c\u4ef6\u6d88\u878d\u7814\u7a76\u7684\u76ee\u6807\u8bc6\u522b\u65b9\u6cd5","text":"<p>\u6838\u5fc3\u65b9\u6cd5\u8bba\uff1a\u57fa\u4e8e\u5927\u89c4\u6a21\u786c\u4ef6\u6d88\u878d\u7814\u7a76\u7684\u76ee\u6807\u8bc6\u522b</p> <p>Limoncello \u9879\u76ee\u7684\u6838\u5fc3\u521b\u65b0\u4e4b\u4e00\u5728\u4e8e\u5176\u8bc6\u522b\u8f6f\u4ef6\u9884\u53d6\u76ee\u6807\u7684\u65b9\u6cd5\u3002\u8be5\u65b9\u6cd5\u6452\u5f03\u4e86\u4f20\u7edf\u4f9d\u8d56\u4ee3\u8868\u6027\u57fa\u51c6\u6d4b\u8bd5\uff08benchmark\uff09\u7684 Profile-Guided Optimization (PGO) \u8303\u5f0f\uff0c\u8f6c\u800c\u91c7\u7528\u4e00\u79cd\u5728\u8d85\u5927\u89c4\u6a21\u751f\u4ea7\u73af\u5883\u4e2d\u53ef\u884c\u7684\u3001\u6570\u636e\u9a71\u52a8\u7684\u786c\u4ef6\u6d88\u878d\u7814\u7a76\uff08hardware ablation study\uff09\u3002</p> <ul> <li>\u6d88\u878d\u5b9e\u9a8c\u8bbe\u8ba1\uff1a</li> <li>\u5728 Google \u6570\u636e\u4e2d\u5fc3\u8230\u961f\u4e2d\uff0c\u9009\u53d6\u6570\u5341\u4e07\u53f0\u5177\u6709\u4ee3\u8868\u6027\u7684\u673a\u5668\uff08\u8986\u76d6\u4e0d\u540c\u5730\u7406\u533a\u57df\u548c\u591a\u6837\u5316\u5de5\u4f5c\u8d1f\u8f7d\uff09\u3002</li> <li>\u5c06\u8fd9\u4e9b\u673a\u5668\u5206\u4e3a\u5b9e\u9a8c\u7ec4\u548c\u5bf9\u7167\u7ec4\u3002</li> <li>\u5b9e\u9a8c\u7ec4\uff1a\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\uff08\u7531 Hard Limoncello \u63a7\u5236\uff09\u7981\u7528\u6240\u6709\u786c\u4ef6\u9884\u53d6\u5668\u3002</li> <li>\u5bf9\u7167\u7ec4\uff1a\u4fdd\u6301\u786c\u4ef6\u9884\u53d6\u5668\u59cb\u7ec8\u5f00\u542f\uff0c\u4e14\u4e0d\u6dfb\u52a0\u4efb\u4f55\u8f6f\u4ef6\u9884\u53d6\u3002</li> <li> <p>\u5b9e\u9a8c\u6301\u7eed\u8fdb\u884c\u6570\u5468\uff0c\u4ee5\u6355\u83b7\u5168\u5929\u5019\u53ca\u8de8\u5468\u7684\u5de5\u4f5c\u8d1f\u8f7d\u53d8\u5316\u3002</p> </li> <li> <p>\u6570\u636e\u91c7\u96c6\u4e0e\u5206\u6790\uff1a</p> </li> <li>\u5229\u7528 Google \u5185\u90e8\u7684\u5168\u5c40\u6027\u80fd\u5206\u6790\u5de5\u5177\uff08global profiling tool\uff09\uff0c\u8be5\u5de5\u5177\u80fd\u591f\u6301\u7eed\u3001\u4f4e\u5f00\u9500\u5730\u91c7\u6837\u6574\u4e2a\u8230\u961f\u4e2d\u5e94\u7528\u7a0b\u5e8f\u7684\u6027\u80fd\u8ba1\u6570\u5668\u3002</li> <li>\u91c7\u96c6\u7684\u5173\u952e\u6307\u6807\u5305\u62ec\uff1a\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08program counter\uff09\u3001CPU \u5468\u671f\u6d88\u8017\u3001\u6700\u540e\u4e00\u7ea7\u7f13\u5b58\uff08LLC\uff09\u3002</li> <li> <p>\u901a\u8fc7\u5bf9\u6bd4\u5b9e\u9a8c\u7ec4\uff08\u65e0\u786c\u4ef6\u9884\u53d6\uff09\u548c\u5bf9\u7167\u7ec4\uff08\u6709\u786c\u4ef6\u9884\u53d6\uff09\u7684\u51fd\u6570\u7ea7\u6027\u80fd\u6570\u636e\uff0c\u7cbe\u786e\u91cf\u5316\u6bcf\u4e2a\u51fd\u6570\u5728\u5931\u53bb\u786c\u4ef6\u9884\u53d6\u652f\u6301\u540e\u7684\u6027\u80fd\u9000\u5316\u7a0b\u5ea6\u3002</p> </li> <li> <p>\u76ee\u6807\u51fd\u6570\u7b5b\u9009\u6807\u51c6\uff1a</p> </li> <li>\u6027\u80fd\u663e\u8457\u9000\u5316\uff1a\u51fd\u6570\u5728\u5b9e\u9a8c\u7ec4\u4e2d\u8868\u73b0\u51faCPU \u5468\u671f\u663e\u8457\u589e\u52a0\uff08\u5373\u6027\u80fd\u4e0b\u964d\uff09\u3002</li> <li>\u7f13\u5b58\u7f3a\u5931\u7387\u6fc0\u589e\uff1a\u4e0a\u8ff0\u6027\u80fd\u9000\u5316\u4e3b\u8981\u7531 LLC MPKI\uff08Misses Per Kilo Instructions\uff09\u5927\u5e45\u4e0a\u5347\u5f15\u8d77\uff0c\u8868\u660e\u8be5\u51fd\u6570\u9ad8\u5ea6\u4f9d\u8d56\u9884\u53d6\u6765\u9690\u85cf\u5185\u5b58\u5ef6\u8fdf\u3002</li> <li>\u9ad8\u8c03\u7528\u70ed\u5ea6\uff1a\u8be5\u51fd\u6570\u5fc5\u987b\u662f\u201chot function\u201d\uff0c\u5373\u5728\u6574\u4e2a\u8230\u961f\u4e2d\u6d88\u8017\u5927\u91cf CPU \u5468\u671f\uff0c\u4f18\u5316\u5b83\u80fd\u5e26\u6765\u5168\u5c40\u6027\u6536\u76ca\u3002</li> <li>\u5206\u6790\u7ed3\u679c\u63ed\u793a\uff0c\u6ee1\u8db3\u4ee5\u4e0a\u6761\u4ef6\u7684\u51fd\u6570\u7edd\u5927\u591a\u6570\u5c5e\u4e8e\u6240\u8c13\u7684\u201cdata center tax functions\u201d\uff08\u6570\u636e\u4e2d\u5fc3\u7a0e\u51fd\u6570\uff09\u3002</li> </ul> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p> <p></p> <p>Figure 12. Aggregated change in CPU cycles (%) from Hard Limoncello. Data center tax functions (green) increased in CPU cycles under Hard Limoncello. In contrast, overall nondata center tax functions (blue) decreased in cycles.</p> <p>\u8bc6\u522b\u51fa\u7684\u5173\u952e\u76ee\u6807\uff1a\u6570\u636e\u4e2d\u5fc3\u7a0e\u51fd\u6570</p> <p>\u901a\u8fc7\u4e0a\u8ff0\u6d88\u878d\u7814\u7a76\uff0c\u8bba\u6587\u660e\u786e\u6307\u51fa\u4e86\u56db\u7c7b\u6700\u9002\u5408\u4f5c\u4e3a\u8f6f\u4ef6\u9884\u53d6\u76ee\u6807\u7684\u51fd\u6570\uff1a</p> <ul> <li>Compression/Decompression (\u538b\u7f29/\u89e3\u538b\u7f29)\uff1a\u5904\u7406\u8fde\u7eed\u6570\u636e\u5757\uff0c\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u9ad8\u5ea6\u53ef\u9884\u6d4b\u3002</li> <li>Data transmission (\u6570\u636e\u4f20\u8f93)\uff1a\u5982 RPC \u7684\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\uff0c\u6d89\u53ca\u5bf9\u8fde\u7eed\u5185\u5b58\u5730\u5740\u7684\u8bfb\u5199\u3002</li> <li>Hashing (\u54c8\u5e0c)\uff1a\u7b97\u6cd5\u901a\u5e38\u6309\u9884\u5b9a\u987a\u5e8f\u5904\u7406\u6570\u636e\u5757\uff0c\u4ea7\u751f\u89c4\u5219\u7684\u5185\u5b58\u8bbf\u95ee\u6d41\u3002</li> <li>Data movement (\u6570\u636e\u79fb\u52a8)\uff1a\u5982 <code>memcpy</code> \u548c <code>memmove</code>\uff0c\u76f4\u63a5\u64cd\u4f5c\u5927\u6bb5\u8fde\u7eed\u5185\u5b58\u3002</li> </ul> <p>\u8fd9\u4e9b\u51fd\u6570\u4e4b\u6240\u4ee5\u6210\u4e3a\u7406\u60f3\u76ee\u6807\uff0c\u539f\u56e0\u5982\u4e0b\uff1a - \u5b83\u4eec\u88ab\u5c01\u88c5\u5728\u6807\u51c6\u5e93\u51fd\u6570\u4e2d\uff0c\u4fbf\u4e8e\u96c6\u4e2d\u4f18\u5316\u3002 - \u5b83\u4eec\u5360\u636e\u4e86\u6570\u636e\u4e2d\u5fc3 30-40% \u7684 CPU \u5468\u671f\uff0c\u4f18\u5316\u56de\u62a5\u6781\u9ad8\u3002 - \u51fd\u6570\u7b7e\u540d\uff08\u5982 <code>memcpy(void* dest, const void* src, size_t n)</code>\uff09\u76f4\u63a5\u66b4\u9732\u4e86\u5c06\u8981\u8bbf\u95ee\u7684\u6570\u636e\u5730\u5740\u548c\u603b\u91cf\uff0c\u4f7f\u5f97\u8f6f\u4ef6\u9884\u53d6\u53ef\u4ee5\u505a\u5230\u6781\u5176\u7cbe\u51c6\uff0c\u907f\u514d\u4e86\u786c\u4ef6\u9884\u53d6\u5668\u6240\u9700\u7684\u201cwarm-up\u201d\u5b66\u4e60\u671f\u548c\u6f5c\u5728\u7684\u8fc7\u5ea6\u9884\u53d6\u95ee\u9898\u3002</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165\uff1a</li> <li>\u539f\u59cb\u8f93\u5165\uff1a\u6765\u81ea\u6d88\u878d\u5b9e\u9a8c\u7684\u6d77\u91cf\u3001\u51fd\u6570\u7ea7\u6027\u80fd\u5256\u6790\u6570\u636e\uff08CPU cycles, LLC MPKI\uff09\u3002</li> <li> <p>\u5904\u7406\u903b\u8f91\uff1a\u901a\u8fc7\u5bf9\u6bd4\u5206\u6790\uff0c\u7b5b\u9009\u51fa\u56e0\u7981\u7528\u786c\u4ef6\u9884\u53d6\u800c\u6027\u80fd\u663e\u8457\u9000\u5316\u7684\u70ed\u70b9\u51fd\u6570\u3002</p> </li> <li> <p>\u8f93\u51fa\uff1a</p> </li> <li>\u660e\u786e\u7684\u4f18\u5316\u76ee\u6807\u5217\u8868\uff1a\u5373\u4e0a\u8ff0\u56db\u7c7b\u201c\u6570\u636e\u4e2d\u5fc3\u7a0e\u51fd\u6570\u201d\u3002</li> <li> <p>\u7cbe\u7ec6\u5316\u7684\u9884\u53d6\u53c2\u6570\u6307\u5bfc\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u76ee\u6807\u51fd\u6570\uff08\u5982 <code>memcpy</code>\uff09\uff0c\u5256\u6790\u6570\u636e\u8fd8\u63d0\u4f9b\u4e86\u8c03\u7528\u53c2\u6570\uff08\u5982\u62f7\u8d1d\u5927\u5c0f\uff09\u7684\u5206\u5e03\u4fe1\u606f\uff0c\u8fd9\u76f4\u63a5\u6307\u5bfc\u4e86\u540e\u7eed Soft Limoncello \u8bbe\u8ba1\u4e2d\u7684\u9884\u53d6\u8ddd\u79bb\uff08prefetch distance\uff09\u548c\u9884\u53d6\u5ea6\uff08prefetch degree\uff09\u7684\u9009\u62e9\u3002</p> </li> <li> <p>\u5728 Limoncello \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528\uff1a</p> </li> <li>\u8be5\u65b9\u6cd5\u662f Soft Limoncello \u7ec4\u4ef6\u7684\u57fa\u77f3\u3002\u5b83\u89e3\u51b3\u4e86\u201c\u5728\u54ea\u91cc\u63d2\u5165\u8f6f\u4ef6\u9884\u53d6\u201d\u8fd9\u4e00\u6700\u5173\u952e\u4e5f\u6700\u56f0\u96be\u7684\u95ee\u9898\u3002</li> <li>\u901a\u8fc7\u7cbe\u51c6\u5b9a\u4f4d\u5c11\u6570\u51e0\u4e2a\u9ad8\u5f71\u54cd\u529b\u3001\u9ad8\u6536\u76ca\u7684\u51fd\u6570\uff0c\u4f7f\u5f97\u8f6f\u4ef6\u9884\u53d6\u7684\u90e8\u7f72\u53d8\u5f97\u53ef\u6269\u5c55\uff08scalable\uff09\u548c\u9ad8\u6548\uff0c\u907f\u514d\u4e86\u76f2\u76ee\u5730\u5728\u6574\u4e2a\u4ee3\u7801\u5e93\u4e2d\u63d2\u5165\u9884\u53d6\u6307\u4ee4\u6240\u5e26\u6765\u7684\u7ef4\u62a4\u590d\u6742\u6027\u548c\u6f5c\u5728\u6027\u80fd\u635f\u5931\u3002</li> <li>\u5b83\u5b9e\u73b0\u4e86 Hard Limoncello \u548c Soft Limoncello \u7684\u5b8c\u7f8e\u534f\u540c\uff1aHard Limoncello \u5728\u9ad8\u5e26\u5bbd\u538b\u529b\u4e0b\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u4ee5\u964d\u4f4e\u7cfb\u7edf\u5ef6\u8fdf\uff0c\u800c Soft Limoncello \u5219\u901a\u8fc7\u9488\u5bf9\u6027\u5730\u8865\u507f\u5173\u952e\u51fd\u6570\u7684\u7f13\u5b58\u7f3a\u5931\uff0c\u786e\u4fdd\u4e86\u6574\u4f53\u5e94\u7528\u541e\u5410\u91cf\u7684\u51c0\u63d0\u5347\u3002</li> </ul>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#4","title":"4. \u8f6f\u4ef6\u9884\u53d6\u53c2\u6570\u8c03\u4f18\uff08\u5730\u5740\u3001\u8ddd\u79bb\u3001\u5ea6\uff09","text":"<p>\u8f6f\u4ef6\u9884\u53d6\u53c2\u6570\u8c03\u4f18\u7684\u6838\u5fc3\u65b9\u6cd5\u8bba</p> <p>Limoncello \u7684 Soft Limoncello \u7ec4\u4ef6\u901a\u8fc7\u4e00\u5957\u4e25\u8c28\u7684\u6570\u636e\u9a71\u52a8\u6d41\u7a0b\uff0c\u4e3a <code>memcpy</code> \u7b49\u6570\u636e\u5bc6\u96c6\u578b\u51fd\u6570\u786e\u5b9a\u6700\u4f18\u7684\u8f6f\u4ef6\u9884\u53d6\u53c2\u6570\u3002\u8be5\u6d41\u7a0b\u7ed3\u5408\u4e86\u8230\u961f\u8303\u56f4\u7684\u6027\u80fd\u5206\u6790 (fleetwide profiling) \u4e0e\u9488\u5bf9\u6027\u7684\u5fae\u57fa\u51c6\u6d4b\u8bd5 (microbenchmarking)\uff0c\u4ee5\u89e3\u51b3\u5728\u5927\u89c4\u6a21\u3001\u591a\u6837\u5316\u751f\u4ea7\u73af\u5883\u4e2d\u8fdb\u884c\u9884\u53d6\u4f18\u5316\u7684\u6311\u6218\u3002</p> <ul> <li>\u76ee\u6807\u51fd\u6570\u7b5b\u9009\uff1a\u9996\u5148\uff0c\u901a\u8fc7\u5728\u6570\u4e07\u673a\u5668\u4e0a\u8fdb\u884c\u786c\u4ef6\u6d88\u878d\u5b9e\u9a8c (hardware ablation study)\uff0c\u5373\u5168\u5c40\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u5229\u7528\u5168\u5c40\u6027\u80fd\u5206\u6790\u5de5\u5177\u76d1\u63a7\u5404\u51fd\u6570\u7684 CPU cycles \u548c LLC MPKI (Last-Level Cache Misses Per Kilo Instructions) \u53d8\u5316\u3002</li> </ul> <p></p> <p>Figure 10. Application throughput based on different Hard Limoncello configurations. ?? /?? indicates the lower (?? %) and upper (?? %) memory bandwidth thresholds in the configuration. Thresholds are expressed as a percentage of memory bandwidth saturation.</p> <pre><code>-\n</code></pre> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p> <ul> <li>\u53c2\u6570\u8bbe\u8ba1\u7a7a\u95f4\u5b9a\u4e49\uff1a\u9488\u5bf9\u9009\u5b9a\u7684\u76ee\u6807\u51fd\u6570\uff0c\u4f18\u5316\u805a\u7126\u4e8e\u4e09\u4e2a\u6838\u5fc3\u53c2\u6570\uff1a<ul> <li>\u9884\u53d6\u5730\u5740 (Prefetch address)\uff1a\u786e\u5b9a\u9700\u8981\u63d2\u5165\u9884\u53d6\u6307\u4ee4\u7684\u786e\u5207\u5185\u5b58\u4f4d\u7f6e\u3002\u9009\u62e9\u6807\u51c6\u662f\u8be5\u5730\u5740\u7684\u8bbf\u95ee\u5fc5\u987b\u5bfc\u81f4\u9ad8\u5ef6\u8fdf\u7684\u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u4e14\u5176\u8bbf\u95ee\u6a21\u5f0f\u53ef\u9884\u6d4b\u3002</li> <li>\u9884\u53d6\u8ddd\u79bb (Prefetch distance)\uff1a\u6307\u9884\u53d6\u6307\u4ee4\u6267\u884c\u65f6\uff0c\u8ddd\u79bb\u5b9e\u9645\u6570\u636e\u4f7f\u7528\u70b9\u7684\u63d0\u524d\u91cf\uff08\u901a\u5e38\u4ee5\u5b57\u8282\u6216\u7f13\u5b58\u884c\u4e3a\u5355\u4f4d\uff09\u3002\u8ddd\u79bb\u8fc7\u77ed\u4f1a\u5bfc\u81f4\u9884\u53d6\u4e0d\u53ca\u65f6\uff0c\u8fc7\u957f\u5219\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u5728\u4f7f\u7528\u524d\u88ab\u9010\u51fa\u7f13\u5b58\u3002</li> <li>\u9884\u53d6\u5ea6 (Prefetch degree)\uff1a\u6307\u5355\u6b21\u9884\u53d6\u64cd\u4f5c\u6240\u83b7\u53d6\u7684\u6570\u636e\u91cf\uff08\u4f8b\u5982\uff0c\u4e00\u6b21\u9884\u53d6\u591a\u5c11\u4e2a\u8fde\u7eed\u7684\u7f13\u5b58\u884c\uff09\u3002\u5ea6\u592a\u5c0f\u65e0\u6cd5\u8986\u76d6\u540e\u7eed\u8bbf\u95ee\uff0c\u592a\u5927\u5219\u4f1a\u6d6a\u8d39\u5b9d\u8d35\u7684\u5185\u5b58\u5e26\u5bbd\u3002</li> </ul> </li> </ul> <p>\u57fa\u4e8e\u6570\u636e\u7684\u53c2\u6570\u51b3\u7b56\u6d41\u7a0b</p> <p>\u51b3\u7b56\u8fc7\u7a0b\u5e76\u975e\u51ed\u7a7a\u731c\u6d4b\uff0c\u800c\u662f\u4e25\u683c\u4f9d\u8d56\u4ece\u751f\u4ea7\u73af\u5883\u4e2d\u6536\u96c6\u7684\u771f\u5b9e\u6570\u636e\u3002</p> <ul> <li>\u5229\u7528\u8c03\u7528\u53c2\u6570\u5206\u5e03\u6307\u5bfc\u4f18\u5316\uff1a<ul> <li>\u5bf9\u4e8e <code>memcpy</code> \u8fd9\u7c7b\u51fd\u6570\uff0c\u5176\u6027\u80fd\u5bf9\u62f7\u8d1d\u6570\u636e\u7684\u5927\u5c0f\u9ad8\u5ea6\u654f\u611f\u3002\u8230\u961f\u8303\u56f4\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\u6536\u96c6\u4e86\u8fd9\u4e9b\u51fd\u6570\u7684\u8c03\u7528\u53c2\u6570\u5927\u5c0f\u5206\u5e03\u3002</li> <li>\u5206\u6790\u663e\u793a\uff0c\u867d\u7136\u5927\u591a\u6570 <code>memcpy</code> \u8c03\u7528\u5904\u7406\u7684\u662f\u5c0f\u6570\u636e\u5757\uff0c\u4f46\u5bfc\u81f4\u6027\u80fd\u56de\u5f52\u7684\u5de5\u4f5c\u8d1f\u8f7d\u5f80\u5f80\u6d89\u53ca\u66f4\u5927\u7684\u62f7\u8d1d\u5c3a\u5bf8\uff08\u5e73\u5747\u5927 26%\uff09\u3002\u7531\u4e8e\u786c\u4ef6\u9884\u53d6\u5668\u9700\u8981\u201c\u70ed\u8eab\u201d\u65f6\u95f4\uff0c\u5bf9\u5927\u6570\u636e\u5757\u66f4\u6709\u6548\uff0c\u56e0\u6b64\u8f6f\u4ef6\u9884\u53d6\u4e5f\u5e94\u91cd\u70b9\u4f18\u5316\u5927\u6570\u636e\u573a\u666f\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 14. memcpy argument size distribution. The chart shows the probability density function (PDF) of the number of times each copy size appears in the profiling data. Most copy sizes are small.</p> <ul> <li>\u5fae\u57fa\u51c6\u6d4b\u8bd5\u9a71\u52a8\u7684\u53c2\u6570\u641c\u7d22\uff1a<ul> <li>\u57fa\u4e8e\u4e0a\u8ff0\u6d1e\u5bdf\uff0c\u56e2\u961f\u6784\u5efa\u4e86\u4e13\u95e8\u7684\u5fae\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 LLVM libc \u5fae\u57fa\u51c6\u5957\u4ef6\uff09\uff0c\u7528\u4e8e\u7cfb\u7edf\u6027\u5730\u641c\u7d22\u6700\u4f18\u53c2\u6570\u7ec4\u5408\u3002</li> <li>\u6d4b\u8bd5\u7b56\u7565\u91c7\u7528\u63a7\u5236\u53d8\u91cf\u6cd5\uff1a<ul> <li>\u56fa\u5b9a\u9884\u53d6\u5ea6\uff08\u4f8b\u5982 256 \u5b57\u8282\uff09\uff0c\u626b\u63cf\u4e0d\u540c\u7684\u9884\u53d6\u8ddd\u79bb\uff0c\u627e\u5230\u4f7f\u6027\u80fd\u6700\u4f73\u7684\u8ddd\u79bb\u503c\u3002</li> <li>\u56fa\u5b9a\u9884\u53d6\u8ddd\u79bb\uff08\u4f8b\u5982 512 \u5b57\u8282\uff09\uff0c\u626b\u63cf\u4e0d\u540c\u7684\u9884\u53d6\u5ea6\uff0c\u627e\u5230\u4f7f\u6027\u80fd\u6700\u4f73\u7684\u5ea6\u503c\u3002</li> </ul> </li> <li></li> </ul> </li> </ul> <p></p> <pre><code>-\n</code></pre> <p></p> <p>(b) Microbenchmark exercising different prefetch degrees. Prefetching is fixed at a distance of 512 bytes.</p> <pre><code>- \u6700\u7ec8\u7684\u6027\u80fd\u9a8c\u8bc1\u5728\u66f4\u63a5\u8fd1\u771f\u5b9e\u8d1f\u8f7d\u7684**\u8d1f\u8f7d\u6d4b\u8bd5 (load tests)** \u4e2d\u5b8c\u6210\uff0c\u786e\u4fdd\u5fae\u57fa\u51c6\u4e2d\u7684\u6536\u76ca\u80fd\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u590d\u73b0\u3002\n</code></pre> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u6574\u4f53\u4f5c\u7528</p> <ul> <li> <p>\u8f93\u5165\uff1a</p> <ul> <li>\u8230\u961f\u7ea7\u6027\u80fd\u753b\u50cf\uff1a\u6765\u81ea\u6d88\u878d\u5b9e\u9a8c\u7684\u51fd\u6570\u7ea7 CPU cycles \u548c LLC MPKI \u6570\u636e\uff0c\u7528\u4e8e\u8bc6\u522b\u4f18\u5316\u76ee\u6807\u3002</li> <li>\u8c03\u7528\u4e0a\u4e0b\u6587\u6570\u636e\uff1a\u76ee\u6807\u51fd\u6570\uff08\u5982 <code>memcpy</code>\uff09\u7684\u8c03\u7528\u53c2\u6570\uff08\u5982 size\uff09\u7684\u7edf\u8ba1\u5206\u5e03\u3002</li> <li>\u5fae\u67b6\u6784\u6307\u6807\uff1a\u5728\u4e0d\u540c\u9884\u53d6\u914d\u7f6e\u4e0b\uff0c\u5fae\u57fa\u51c6\u548c\u8d1f\u8f7d\u6d4b\u8bd5\u4ea7\u751f\u7684\u541e\u5410\u91cf\u3001\u5ef6\u8fdf\u7b49\u6027\u80fd\u6570\u636e\u3002</li> </ul> </li> <li> <p>\u8f93\u51fa\uff1a</p> <ul> <li>\u7cbe\u786e\u7684\u4ee3\u7801\u8865\u4e01\uff1a\u5728\u76ee\u6807\u5e93\u51fd\u6570\uff08\u5982 glibc \u4e2d\u7684 <code>memcpy</code>\uff09\u7684\u7279\u5b9a\u4f4d\u7f6e\uff0c\u63d2\u5165\u5e26\u6709\u6700\u4f18\u8ddd\u79bb\u548c\u5ea6\u7684\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\uff08\u5982 x86 \u7684 <code>prefetcht0</code>\uff09\u3002</li> <li>\u6761\u4ef6\u5316\u9884\u53d6\u903b\u8f91\uff1a\u901a\u5e38\u53ea\u5bf9\u8d85\u8fc7\u7279\u5b9a\u5927\u5c0f\u9608\u503c\u7684\u8c03\u7528\u542f\u7528\u8f6f\u4ef6\u9884\u53d6\uff0c\u4ee5\u907f\u514d\u5bf9\u5c0f\u6570\u636e\u5757\u9020\u6210\u4e0d\u5fc5\u8981\u7684\u5f00\u9500\u3002</li> </ul> </li> <li> <p>\u5728 Limoncello \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528\uff1a</p> <ul> <li>\u5f25\u8865\u786c\u4ef6\u9884\u53d6\u7684\u7a7a\u767d\uff1a\u5f53 Hard Limoncello \u5728\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\u4e0b\u5173\u95ed\u786c\u4ef6\u9884\u53d6\u5668\u4ee5\u964d\u4f4e\u5185\u5b58\u5ef6\u8fdf\u65f6\uff0cSoft Limoncello \u901a\u8fc7\u7cbe\u51c6\u7684\u8f6f\u4ef6\u9884\u53d6\uff0c\u7ef4\u6301\u4e86\u5173\u952e\u51fd\u6570\u7684\u4f4e\u7f13\u5b58\u672a\u547d\u4e2d\u7387 (MPKI)\uff0c\u9632\u6b62\u4e86\u6027\u80fd\u56de\u9000\u3002</li> <li>\u5b9e\u73b0\u534f\u540c\u589e\u6548\uff1a\u8fd9\u79cd\u8f6f\u786c\u534f\u540c\u7684\u7b56\u7565\uff0c\u4f7f\u5f97\u7cfb\u7edf\u5728\u9ad8\u8d1f\u8f7d\u4e0b\u65e2\u80fd\u4eab\u53d7\u66f4\u4f4e\u7684\u5185\u5b58\u5ef6\u8fdf\uff08\u6765\u81ea\u5173\u95ed\u786c\u4ef6\u9884\u53d6\uff09\uff0c\u53c8\u80fd\u4fdd\u6301\u8f83\u9ad8\u7684\u7f13\u5b58\u6548\u7387\uff08\u6765\u81ea\u7cbe\u51c6\u7684\u8f6f\u4ef6\u9884\u53d6\uff09\uff0c\u6700\u7ec8\u5b9e\u73b0\u4e86 10% \u7684\u5e94\u7528\u541e\u5410\u91cf\u63d0\u5347\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 20. Software prefetcher impact in Limoncello. The y-axis shows the portion of fleetwide cycles spent in the respective function categories. The center bar (green) shows Hard Limoncello deployed without any software prefetchers. Adding software prefetchers into Limoncello lowered CPU cycles spent in targeted functions by 2% (yellow).</p>"},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#-data-center-tax-memcpymemmovecycles-mpki-prefetch-friendly","title":"- \u5206\u6790\u53d1\u73b0\uff0c\u6570\u636e\u4e2d\u2f3c\u7a0e (data center tax) \u51fd\u6570\uff08\u5982\u538b\u7f29\u3001\u54c8\u5e0c\u3001\u6570\u636e\u4f20\u8f93\u3001<code>memcpy</code>/<code>memmove</code>\uff09\u5728\u786c\u4ef6\u9884\u53d6\u5668\u5173\u95ed\u540e\u8868\u73b0\u51fa\u663e\u8457\u7684\u6027\u80fd\u56de\u5f52\uff08cycles \u589e\u52a0\uff0cMPKI \u4e0a\u5347\uff09\uff0c\u88ab\u8bc6\u522b\u4e3a\u9884\u53d6\u53cb\u597d (prefetch-friendly) \u7684\u5173\u952e\u4f18\u5316\u76ee\u6807\u3002","text":""},{"location":"notes_repo/limoncello-prefetchers-for-scale/paper_notes/#4_1","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u90e8\u7f72\u73af\u5883: \u5b9e\u9a8c\u5728 Google \u7684\u751f\u4ea7\u6570\u636e\u4e2d\u5fc3\u96c6\u7fa4\u4e2d\u8fdb\u884c\uff0c\u6bcf\u53f0\u673a\u5668\u8fd0\u884c\u6570\u767e\u4e2a\u670d\u52a1\uff0c\u7531\u96c6\u4e2d\u5f0f\u8c03\u5ea6\u5668\u7ba1\u7406\u3002\u8bc4\u4f30\u57fa\u4e8e\u771f\u5b9e\u7684\u751f\u4ea7\u6d41\u91cf\u3002</li> <li>\u786c\u4ef6\u5e73\u53f0: \u8bc4\u4f30\u4f7f\u7528\u4e86\u4e24\u4e2a\u4e0d\u540c\u4ee3\u9645\u7684\u5927\u578b x86 out-of-order multicore \u5e73\u53f0\uff08Platform 1 \u548c Platform 2\uff09\u3002</li> <li>Hard Limoncello \u914d\u7f6e:<ul> <li>\u57fa\u4e8e\u7b2c3\u8282\u63cf\u8ff0\u7684\u786c\u4ef6\u6d88\u878d\u7814\u7a76\uff0c\u5c06\u786c\u4ef6\u9884\u53d6\u5668\u7684\u5f00\u5173\u9608\u503c\u8bbe\u5b9a\u4e3a\u5e73\u53f0\u5185\u5b58\u5e26\u5bbd\u9971\u548c\u9608\u503c\u7684 80% (\u4e0a\u9650) \u548c 60% (\u4e0b\u9650)\u3002</li> <li>\u4f7f\u7528\u4e00\u4e2a\u5e26\u6709\u6ede\u540e\u6548\u5e94 (hysteresis) \u7684\u63a7\u5236\u5668\u6765\u52a8\u6001\u8c03\u8282\u786c\u4ef6\u9884\u53d6\u5668\u72b6\u6001\uff0c\u907f\u514d\u56e0\u77ed\u671f\u6ce2\u52a8\u5bfc\u81f4\u9891\u7e41\u5207\u6362\u3002</li> </ul> </li> <li>Soft Limoncello \u914d\u7f6e:<ul> <li>\u5229\u7528\u6d88\u878d\u7814\u7a76\u4e2d\u7684\u6027\u80fd\u5206\u6790\u6570\u636e\uff0c\u8bc6\u522b\u51fa data center tax functions\uff08\u5982\u538b\u7f29\u3001\u54c8\u5e0c\u3001\u6570\u636e\u4f20\u8f93\u3001memcpy\uff09\u4f5c\u4e3a\u8f6f\u4ef6\u9884\u53d6\u7684\u76ee\u6807\u3002</li> <li>\u901a\u8fc7\u5fae\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 LLVM libc microbenchmark suite\uff09\u548c\u8d1f\u8f7d\u6d4b\u8bd5\uff0c\u4e3a\u8fd9\u4e9b\u76ee\u6807\u51fd\u6570\u7cbe\u5fc3\u8c03\u4f18\u9884\u53d6\u8ddd\u79bb (prefetch distance) \u548c\u9884\u53d6\u5ea6 (prefetch degree)\u3002</li> </ul> </li> <li>\u8bc4\u4f30\u6307\u6807:<ul> <li>\u673a\u5668\u7ea7\u6307\u6807: \u5185\u5b58\u5e26\u5bbd\u3001DRAM \u5ef6\u8fdf\u3001CPU \u5229\u7528\u7387\u3002</li> <li>\u5de5\u4f5c\u8d1f\u8f7d\u7ea7\u6307\u6807: \u5e94\u7528\u541e\u5410\u91cf (application throughput)\uff0c\u5373\u5355\u4f4d\u65f6\u95f4\u5185\u6bcf\u4e2a\u670d\u52a1\u5904\u7406\u7684\u8bf7\u6c42\u6570\u3002</li> </ul> </li> </ul> <p>\u7ed3\u679c\u6570\u636e</p> <ul> <li>\u5e94\u7528\u541e\u5410\u91cf: Limoncello \u5728\u9ad8\u5229\u7528\u7387\u573a\u666f\u4e0b\u663e\u8457\u63d0\u5347\u4e86\u6027\u80fd\u3002\u5728 70% \u548c 80% CPU \u5229\u7528\u7387\u4e0b\uff0c\u5e94\u7528\u541e\u5410\u91cf\u63d0\u5347\u4e86 10%\u3002\u5728 60% \u5229\u7528\u7387\u4e0b\uff0c\u6027\u80fd\u6ca1\u6709\u4e0b\u964d\u3002</li> </ul> <p></p> <p>Figure 16. Limoncello application throughput gain. Application throughput increases by 6-13% increase, dependent on the CPU utilization level of the machines.</p> <ul> <li>\u5185\u5b58\u5ef6\u8fdf: Limoncello \u6709\u6548\u964d\u4f4e\u4e86\u5185\u5b58\u5ef6\u8fdf\u3002L3 \u5ef6\u8fdf\u7684\u4e2d\u4f4d\u6570\u51cf\u5c11\u4e86 13%\uff0cP99 \u5ef6\u8fdf\u51cf\u5c11\u4e86 10%\u3002</li> </ul> <p></p> <p>Figure 17. Limoncello memory latency reduction. Memory latency reduces by 13% in the median and 10% in the P99.</p> <ul> <li>\u5185\u5b58\u5e26\u5bbd: \u63d2\u69fd\u7ea7\u522b\u7684\u5185\u5b58\u5e26\u5bbd\u5e73\u5747\u51cf\u5c11\u4e86 15%\uff0c\u8fbe\u5230\u9971\u548c\u72b6\u6001\u7684\u63d2\u69fd\u6570\u91cf\u51cf\u5c11\u4e86\u8fd1 8%\u3002</li> </ul> <p></p> <p>Figure 18. Limoncello socket bandwidth usage reduction. Average socket bandwidth reduces by 15%.</p> <ul> <li>CPU \u5229\u7528\u7387: \u90e8\u7f72 Limoncello \u540e\uff0c\u670d\u52a1\u5668\u80fd\u591f\u7a81\u7834\u539f\u6709\u7684\u5185\u5b58\u5e26\u5bbd\u74f6\u9888\uff0c\u5728\u4e0d\u727a\u7272\u6027\u80fd\u7684\u524d\u63d0\u4e0b\uff0c\u5c06 CPU \u5229\u7528\u7387\u4ece\u539f\u6765\u7684 40-50% \u63d0\u5347\u81f3\u76ee\u6807\u7684 70-80% \u533a\u95f4\u3002</li> </ul> <p></p> <p>Figure 19. Increase in CPU utilization due to Limoncello. Before Limoncello, memory bandwidth saturation was reached in the 40-50% CPU utilization band (Figure 4), but with Limoncello memory bandwidth saturation is not met until the 70-80% band. Sizes of the markers are in proportion to the fraction of platform servers in the CPU usage bucket.</p> <ul> <li>Data Center Tax Functions: \u5bf9\u4e8e\u88ab\u8bc6\u522b\u51fa\u7684\u56db\u7c7b\u5173\u952e\u51fd\u6570\uff0c\u4ec5\u4f7f\u7528 Hard Limoncello \u4f1a\u5bfc\u81f4\u5176 CPU \u5468\u671f\u589e\u52a0\uff0c\u4f46\u52a0\u5165 Soft Limoncello \u540e\uff0c\u6210\u529f\u62b5\u6d88\u4e86\u8fd9\u4e00\u8d1f\u9762\u5f71\u54cd\uff0c\u5e76\u8fdb\u4e00\u6b65\u964d\u4f4e\u4e86\u8fd9\u4e9b\u51fd\u6570\u7684 CPU \u5468\u671f\u5f00\u9500\u7ea6 2%\u3002</li> </ul> <p></p> <p>Figure 20. Software prefetcher impact in Limoncello. The y-axis shows the portion of fleetwide cycles spent in the respective function categories. The center bar (green) shows Hard Limoncello deployed without any software prefetchers. Adding software prefetchers into Limoncello lowered CPU cycles spent in targeted functions by 2% (yellow).</p> <p>\u6d88\u878d\u5b9e\u9a8c</p> <ul> <li>\u76ee\u7684: \u6d88\u878d\u5b9e\u9a8c\u662f Limoncello \u8bbe\u8ba1\u548c\u9a8c\u8bc1\u7684\u6838\u5fc3\uff0c\u4e3b\u8981\u7528\u4e8e\u4e24\u4e2a\u76ee\u7684\uff1a(1) \u91cf\u5316\u786c\u4ef6\u9884\u53d6\u5668\u5728\u5927\u89c4\u6a21\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u771f\u5b9e\u5f71\u54cd\uff1b(2) \u7cbe\u51c6\u5b9a\u4f4d\u9700\u8981\u8f6f\u4ef6\u9884\u53d6\u8865\u507f\u7684\u4ee3\u7801\u533a\u57df\u3002</li> <li>\u5b9e\u9a8c\u8bbe\u8ba1:<ul> <li>\u521b\u5efa\u4e86\u4e24\u7ec4\u5404\u5305\u542b 10,000 \u53f0\u673a\u5668\u7684\u5b9e\u9a8c\u7ec4\u548c\u5bf9\u7167\u7ec4\u3002</li> <li>\u5b9e\u9a8c\u7ec4: \u8fd0\u884c Hard Limoncello\uff08\u5373\u5728\u9ad8\u8d1f\u8f7d\u65f6\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\uff09\uff0c\u4e0d\u6dfb\u52a0\u4efb\u4f55\u8f6f\u4ef6\u9884\u53d6\u3002</li> <li>\u5bf9\u7167\u7ec4: \u4fdd\u6301\u6240\u6709\u786c\u4ef6\u9884\u53d6\u5668\u59cb\u7ec8\u5f00\u542f\u3002</li> <li>\u673a\u5668\u9009\u62e9\u8986\u76d6\u591a\u4e2a\u5730\u7406\u533a\u57df\u548c\u591a\u6837\u5316\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u4ee5\u786e\u4fdd\u7ed3\u679c\u7684\u4ee3\u8868\u6027\u3002\u5b9e\u9a8c\u6301\u7eed\u4e24\u5468\uff0c\u4ee5\u6355\u6349\u65e5\u95f4\u548c\u5468\u95f4\u7684\u6d41\u91cf\u53d8\u5316\u3002</li> </ul> </li> <li>\u5173\u952e\u53d1\u73b0:<ul> <li>\u6574\u4f53\u5f71\u54cd: \u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\u540e\uff0c\u96c6\u7fa4\u5e73\u5747\u6027\u80fd\u4e0b\u964d\u4e86 5%\uff0c\u4f46\u90e8\u5206\u5185\u5b58\u5bc6\u96c6\u578b\u5e94\u7528\uff08\u5982\u641c\u7d22\u3001ML \u6a21\u578b\u670d\u52a1\uff09\u7684 QPS \u5374\u6709\u663e\u8457\u63d0\u5347\uff08&gt;10% \u5230 &gt;30%\uff09\u3002\u8fd9\u63ed\u793a\u4e86\u786c\u4ef6\u9884\u53d6\u5668\u6548\u679c\u7684\u53cc\u91cd\u6027\u3002</li> <li>\u51fd\u6570\u7ea7\u5206\u6790: \u901a\u8fc7\u5168\u5c40\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u5bf9\u6bd4\u4e24\u7ec4\u673a\u5668\u5728\u51fd\u6570\u7c92\u5ea6\u4e0a\u7684 LLC MPKI (Last Level Cache Misses Per Kilo Instructions) \u548c CPU \u5468\u671f\u3002<ul> <li>\u53d1\u73b0 data center tax functions \u5728\u786c\u4ef6\u9884\u53d6\u5668\u5173\u95ed\u540e\uff0cMPKI \u548c CPU \u5468\u671f\u663e\u8457\u589e\u52a0\uff0c\u88ab\u5f52\u7c7b\u4e3a prefetch-friendly\u3002</li> <li>\u800c\u5176\u4ed6\u8bb8\u591a\u51fd\u6570\u5219\u56e0\u5185\u5b58\u5ef6\u8fdf\u964d\u4f4e\u548c\u7f13\u5b58\u6c61\u67d3\u51cf\u5c11\u800c\u6027\u80fd\u63d0\u5347\uff0c\u88ab\u5f52\u7c7b\u4e3a prefetch-unfriendly\u3002</li> </ul> </li> </ul> </li> </ul> <p></p> <p>Figure 11. Change in CPU cycles (%) from Hard Limoncello. Functions that regress in performance when hardware prefetchers are disabled show an increase in CPU cycles (green) and an increase in LLC MPKI (blue). Data center tax functions in particular show performance regressions from disabling hardware prefetchers while other functions tend to improve in performance and decrease in cycles and MPKI.</p> <p></p> <p>Figure 12. Aggregated change in CPU cycles (%) from Hard Limoncello. Data center tax functions (green) increased in CPU cycles under Hard Limoncello. In contrast, overall nondata center tax functions (blue) decreased in cycles.</p> <pre><code>- **\u5e26\u5bbd\u5f71\u54cd**: \u6d88\u878d\u5b9e\u9a8c\u6570\u636e\uff08\u89c1\u88681\uff09\u663e\u793a\uff0c\u7981\u7528\u786c\u4ef6\u9884\u53d6\u5668\u53ef\u5c06\u6574\u4e2a\u96c6\u7fa4\u7684\u5e73\u5747\u5185\u5b58\u5e26\u5bbd\u964d\u4f4e **11.2%\u201315.7%**\uff0c\u5bf9\u5cf0\u503c\u548c P99 \u5c3e\u90e8\u5e26\u5bbd\u4e5f\u6709\u663e\u8457\u5f71\u54cd\u3002\n</code></pre> <p></p> <p>Table 1. Disabling hardware prefetchers reduces both average and tail memory bandwidth.</p> <ul> <li>\u4f5c\u7528: \u8be5\u6d88\u878d\u5b9e\u9a8c\u76f4\u63a5\u6307\u5bfc\u4e86 Soft Limoncello \u7684\u8bbe\u8ba1\uff0c\u660e\u786e\u4e86\u8f6f\u4ef6\u9884\u53d6\u5e94\u7cbe\u51c6\u5730\u63d2\u5165\u5230\u54ea\u4e9b\u51fd\u6570\u4e2d\uff0c\u4ece\u800c\u5728\u4eab\u53d7 Hard Limoncello \u5e26\u6765\u7684\u4f4e\u5ef6\u8fdf\u548c\u4f4e\u5e26\u5bbd\u4f18\u52bf\u7684\u540c\u65f6\uff0c\u907f\u514d\u4e86\u5173\u952e\u8def\u5f84\u4e0a\u7684\u6027\u80fd\u56de\u9000\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/ELI5_notes/","title":"OCOLOS: Online COde Layout OptimizationS \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/ocolos-online-code-layout-optimizations/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <p>\u4f20\u7edf Profile-Guided Optimization (PGO) \u662f\u4e2a\u597d\u4e1c\u897f\uff0c\u4f46\u5b83\u6709\u4e2a\u81f4\u547d\u7684\u201c\u65f6\u95f4\u5dee\u201d\u95ee\u9898\u3002\u60f3\u8c61\u4e00\u4e0b\uff1a - \u4f60\u82b1\u4e86\u4e00\u5468\u65f6\u95f4\uff0c\u5728\u65e7\u7248\u672c\u7684 MySQL \u4e0a\u8dd1\u4e86\u4e00\u4e2a\u5178\u578b\u7684\u8d1f\u8f7d\uff0c\u6536\u96c6\u4e86profile\u3002 - \u7136\u540e\u4f60\u7528\u8fd9\u4e2a profile \u53bb\u4f18\u5316\u65b0\u7248\u672c\u7684 MySQL\u3002 - \u4f46\u5728\u8fd9\u671f\u95f4\uff0c\u4ee3\u7801\u5df2\u7ecf\u53d8\u4e86\uff01\u65b0\u529f\u80fd\u3001\u65b0\u8865\u4e01\u8ba9\u65e7 profile \u7684\u5f88\u591a\u4fe1\u606f\u53d8\u5f97\u65e0\u6cd5\u6620\u5c04\u751a\u81f3\u5b8c\u5168\u9519\u8bef\u3002 - \u7ed3\u679c\u5c31\u662f\uff0c\u4f60\u7cbe\u5fc3\u4f18\u5316\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u53ef\u80fd\u56e0\u4e3a\u7528\u4e86\u8fc7\u65f6\u7684 profile\uff0c\u6027\u80fd\u53cd\u800c\u4e0d\u5982\u4e0d\u4f18\u5316\uff0c\u6216\u8005\u9519\u5931\u4e86\u5927\u91cf\u4f18\u5316\u673a\u4f1a\u3002</p> <p>\u8fd9\u5c31\u50cf\u62ff\u7740\u53bb\u5e74\u7684\u5730\u56fe\u53bb\u5f00\u4eca\u5e74\u7684\u8f66\u2014\u2014\u8def\u90fd\u4fee\u597d\u4e86\uff0c\u4f60\u7684\u5730\u56fe\u8fd8\u663e\u793a\u662f\u6ce5\u5df4\u8def\uff0c\u5bfc\u822a\u81ea\u7136\u4e0d\u51c6\u3002\u5c24\u5176\u662f\u5728\u6570\u636e\u4e2d\u2f3c\u8fd9\u79cd\u4ee3\u7801\u9ad8\u9891\u8fed\u4ee3\u7684\u73af\u5883\u91cc\uff0c\u8fd9\u4e2a\u95ee\u9898\u5c24\u4e3a\u7a81\u51fa\u3002\u66f4\u522b\u63d0 PGO \u8fd8\u9700\u8981\u91cd\u65b0\u7f16\u8bd1/\u94fe\u63a5\u6574\u4e2a\u5e94\u7528\uff0c\u5bf9\u4e8e\u5927\u578b\u670d\u52a1\u6765\u8bf4\uff0c\u90e8\u7f72\u6210\u672c\u6781\u9ad8\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <p>OCOLOS \u7684\u601d\u8def\uff0c\u5c31\u50cf\u662f\u7ed9\u4e00\u8f86\u6b63\u5728\u9ad8\u901f\u884c\u9a76\u7684\u6c7d\u8f66\u6362\u5f15\u64ce\uff0c\u800c\u4e0d\u662f\u628a\u8f66\u5f00\u56de\u8f66\u5e93\u5927\u4fee\u3002</p> <ul> <li>\u4f20\u7edf PGO\uff1a\u76f8\u5f53\u4e8e\u628a\u8f66\u5f00\u56de4S\u5e97\uff08\u505c\u673a\uff09\uff0c\u62c6\u6389\u65e7\u5f15\u64ce\uff08\u65e7\u4e8c\u8fdb\u5236\uff09\uff0c\u6839\u636e\u4e0a\u6b21\u5f00\u8f66\u7684\u6570\u636e\uff08\u65e7 profile\uff09\u8bbe\u8ba1\u4e00\u4e2a\u65b0\u5f15\u64ce\uff08\u65b0\u4e8c\u8fdb\u5236\uff09\uff0c\u518d\u88c5\u56de\u53bb\u3002\u95ee\u9898\u662f\uff0c\u4f60\u8fd9\u6b21\u5f00\u8f66\u7684\u8def\u51b5\uff08\u8f93\u5165\uff09\u548c\u4e0a\u6b21\u5b8c\u5168\u4e0d\u540c\uff0c\u65b0\u5f15\u64ce\u53ef\u80fd\u6839\u672c\u4e0d\u9002\u5408\u3002</li> <li>OCOLOS\uff1a\u5b83\u76f4\u63a5\u5728\u8f66\u4e0a\u88c5\u4e86\u4e00\u4e2a\u201c\u70ed\u63d2\u62d4\u5f15\u64ce\u8231\u201d\u3002\u5b83\u4e00\u8fb9\u5f00\u7740\u8f66\uff08\u7a0b\u5e8f\u8fd0\u884c\uff09\uff0c\u4e00\u8fb9\u5077\u5077\u8bb0\u5f55\u5f53\u524d\u7684\u9a7e\u9a76\u4e60\u60ef\uff08\u5728\u7ebf profiling\uff09\u3002\u7b49\u65b0\u5f15\u64ce\uff08\u901a\u8fc7 BOLT \u4f18\u5316\u597d\u7684\u4ee3\u7801\uff09\u9020\u597d\u540e\uff0c\u5b83\u4f1a\u627e\u4e2a\u5b89\u5168\u65f6\u673a\uff08\u77ed\u6682\u6682\u505c\uff09\uff0c\u628a\u65b0\u5f15\u64ce\u585e\u8fdb\u5f15\u64ce\u8231\uff0c\u5e76\u5de7\u5999\u5730\u628a\u6cb9\u7ba1\u3001\u7535\u8def\uff08\u4ee3\u7801\u6307\u9488\uff09\u90fd\u63a5\u5230\u65b0\u5f15\u64ce\u4e0a\uff0c\u7136\u540e\u7ee7\u7eed\u98de\u9a70\u3002\u8fd9\u6837\uff0c\u5f15\u64ce\u6c38\u8fdc\u662f\u6700\u9002\u5408\u5f53\u524d\u8def\u51b5\u7684\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>OCOLOS \u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\uff0c\u5b83\u6ca1\u6709\u8bd5\u56fe\u53bb\u201c\u4fee\u6539\u201d\u6b63\u5728\u8fd0\u884c\u7684\u4ee3\u7801\uff0c\u800c\u662f\u91c7\u7528\u4e86\u201c\u4fdd\u7559+\u91cd\u5b9a\u5411\u201d\u7684\u7b56\u7565\uff0c\u5b8c\u7f8e\u89e3\u51b3\u4e86\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u4e2d\u6700\u68d8\u624b\u7684\u4ee3\u7801\u6307\u9488\u5931\u6548\u95ee\u9898\u3002</p> <ul> <li>\u4fdd\u7559\u65e7\u4ee3\u7801 (C0)\uff1aOCOLOS \u6c38\u8fdc\u4e0d\u4f1a\u8986\u76d6\u6216\u5220\u9664\u539f\u59cb\u7684\u4ee3\u7801\u6bb5\uff08C0\uff09\u3002\u8fd9\u4fdd\u8bc1\u4e86\u4efb\u4f55\u6307\u5411 C0 \u7684\u6307\u9488\uff08\u65e0\u8bba\u662f\u6808\u4e0a\u7684\u8fd4\u56de\u5730\u5740\u3001vtable \u91cc\u7684\u51fd\u6570\u6307\u9488\uff0c\u8fd8\u662f\u7a0b\u5e8f\u5458\u81ea\u5df1\u5b58\u7684\u51fd\u6570\u6307\u9488\uff09\u90fd\u4f9d\u7136\u6709\u6548\uff0c\u7a0b\u5e8f\u4e0d\u4f1a\u5d29\u6e83\u3002</li> <li>\u6ce8\u5165\u65b0\u4ee3\u7801 (C1)\uff1a\u5b83\u5c06 BOLT \u4f18\u5316\u540e\u7684\u65b0\u4ee3\u7801\uff08C1\uff09\u52a0\u8f7d\u5230\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u4e00\u4e2a\u65b0\u4f4d\u7f6e\u3002</li> <li>\u667a\u80fd\u91cd\u5b9a\u5411\uff1aOCOLOS \u53ea\u4fee\u6539\u90a3\u4e9b\u53ef\u63a7\u4e14\u503c\u5f97\u6539\u7684\u5165\u53e3\u70b9\uff0c\u5c06\u6267\u884c\u6d41\u5f15\u5bfc\u81f3\u66f4\u5feb\u7684 C1 \u4ee3\u7801\u3002\u5177\u4f53\u6765\u8bf4\uff1a</li> <li>\u5b83\u4f1a\u4fee\u6539 C0 \u4e2d\u7684\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\uff0c\u8ba9\u5b83\u4eec\u8df3\u8f6c\u5230 C1 \u4e2d\u5bf9\u5e94\u7684\u51fd\u6570\u3002</li> <li>\u5b83\u4f1a\u66f4\u65b0 vtable \u4e2d\u7684\u51fd\u6570\u6307\u9488\uff0c\u6307\u5411 C1\u3002</li> <li>\u5bf9\u4e8e\u8fde\u7eed\u4f18\u5316\uff08\u4ece C1 \u5230 C2\uff09\uff0c\u5b83\u751a\u81f3\u80fd\u5904\u7406\u6808\u4e0a\u6b63\u5728\u6267\u884c\u7684\u51fd\u6570\uff0c\u901a\u8fc7\u590d\u5236\u4e00\u4efd\u517c\u5bb9\u7684\u4ee3\u7801\u6765\u5b89\u5168\u5730\u66f4\u65b0\u8fd4\u56de\u5730\u5740\u3002</li> <li>\u89c4\u907f\u4e0d\u53ef\u63a7\u6307\u9488\uff1a\u5bf9\u4e8e\u90a3\u4e9b\u6563\u843d\u5728\u5806\u3001\u6808\u3001\u5bc4\u5b58\u5668\u91cc\uff0c\u65e0\u6cd5\u8ffd\u8e2a\u7684\u51fd\u6570\u6307\u9488\uff0cOCOLOS \u91c7\u7528\u4e86\u4e00\u4e2a\u806a\u660e\u7684\u7f16\u8bd1\u671f\u63d2\u6869\uff1a\u5f3a\u5236\u6240\u6709\u65b0\u521b\u5efa\u7684\u51fd\u6570\u6307\u9488\u90fd\u6307\u5411\u539f\u59cb\u7684 C0 \u5730\u5740\u3002\u8fd9\u6837\uff0c\u5373\u4f7f\u8fd9\u4e9b\u6307\u9488\u88ab\u5230\u5904\u4f20\u9012\uff0c\u5f53\u5b83\u4eec\u88ab\u8c03\u7528\u65f6\uff0c\u4e5f\u4f1a\u5148\u8fdb\u5165 C0\uff0c\u800c C0 \u91cc\u7684\u76f4\u63a5\u8c03\u7528\u5df2\u7ecf\u88ab\u91cd\u5b9a\u5411\u5230 C1 \u4e86\uff0c\u6700\u7ec8\u8fd8\u662f\u4f1a\u6267\u884c\u5230\u4f18\u5316\u540e\u7684\u4ee3\u7801\u3002</li> </ul> <p></p> <p>Figure 4a: Main steps OCOLOS takes to optimize a target process</p> <p>\u901a\u8fc7\u8fd9\u5957\u7ec4\u5408\u62f3\uff0cOCOLOS \u5b9e\u73b0\u4e86\u5bf9\u672a\u4fee\u6539\u7684\u3001\u590d\u6742\u7684 C/C++ \u5e94\u7528\uff08\u5982 MySQL, MongoDB\uff09\u8fdb\u884c\u5728\u7ebf\u3001\u5b89\u5168\u7684\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u3002\u5b83\u628a PGO \u4ece\u4e00\u4e2a\u79bb\u7ebf\u3001\u9759\u6001\u3001\u6709\u6ede\u540e\u6027\u7684\u5de5\u5177\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u5728\u7ebf\u3001\u52a8\u6001\u3001\u59cb\u7ec8\u4e0e\u5f53\u524d\u8d1f\u8f7d\u5339\u914d\u7684\u6d3b\u7cfb\u7edf\u3002</p> <p>\u6700\u7ec8\u6548\u679c\u975e\u5e38\u663e\u8457\uff0c\u8bba\u6587\u5c55\u793a\u4e86\u5bf9 MySQL \u6700\u9ad8 1.41\u00d7\u3001\u5bf9 Verilator \u9ad8\u8fbe 2.20\u00d7 \u7684\u52a0\u901f\u6bd4\uff0c\u800c\u4e14\u8fd9\u4e00\u5207\u90fd\u4e0d\u9700\u8981\u6539\u52a8\u4e00\u884c\u5e94\u7528\u4ee3\u7801\u3002</p> <p></p> <p>Fig. 5: Performance of OCOLOS (light blue bars) compared to BOLT using an oracle profile of the input being run (dark blue bars), Clang PGO using the same oracle profile (purple bars) and BOLT using an average-case profiling input aggregated from all inputs (pink bars). All bars are normalized to original non-PGO binaries (white bars).</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/ELI5_notes/#1-online-code-layout-optimization-eli5","title":"1. \u5728\u7ebf\u4ee3\u7801\u5e03\u5c40\u4f18\u5316 (Online Code Layout Optimization) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <ul> <li>\u4f20\u7edf\u7684 Profile-Guided Optimization (PGO) \u662f\u4e2a\u201c\u9a6c\u540e\u70ae\u201d\u3002\u5b83\u9700\u8981\u5148\u8dd1\u4e00\u904d\u7a0b\u5e8f\u6536\u96c6 profile\uff08\u5256\u6790\u6570\u636e\uff09\uff0c\u7136\u540e\u7528\u8fd9\u4e9b\u6570\u636e\u53bb\u91cd\u65b0\u7f16\u8bd1\u6216\u91cd\u5199\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6700\u540e\u518d\u7528\u8fd9\u4e2a\u65b0\u4e8c\u8fdb\u5236\u6587\u4ef6\u53bb\u8dd1\u771f\u6b63\u7684\u4efb\u52a1\u3002</li> <li>\u8fd9\u5957\u6d41\u7a0b\u5728\u73b0\u4ee3\u8f6f\u4ef6\u5f00\u53d1\u4e2d\u4f1a\u9047\u5230\u4e24\u4e2a\u81f4\u547d\u95ee\u9898\uff1a</li> <li>\u8f93\u5165\u6f02\u79fb (Input Drift)\uff1a\u4f60 profiling \u7684\u65f6\u5019\u7528\u7684\u662f A \u573a\u666f\u7684\u6570\u636e\uff0c\u4f46\u4e0a\u7ebf\u540e\u8dd1\u7684\u662f B \u573a\u666f\u3002\u7528 A \u7684\u6570\u636e\u53bb\u4f18\u5316 B \u7684\u4ee3\u7801\uff0c\u8f7b\u5219\u6ca1\u6548\u679c\uff0c\u91cd\u5219\u6027\u80fd\u66f4\u5dee\u3002</li> <li>\u4ee3\u7801\u6f02\u79fb (Code Drift)\uff1a\u5927\u578b\u9879\u76ee\uff08\u6bd4\u5982 MySQL\uff09\u53ef\u80fd\u6bcf\u5c0f\u65f6\u90fd\u5728\u66f4\u65b0\u3002\u6628\u5929 profiling \u7684\u6570\u636e\uff0c\u4eca\u5929\u4ee3\u7801\u4e00\u53d8\uff0c\u5c31\u5b8c\u5168\u5bf9\u4e0d\u4e0a\u53f7\u4e86\uff0c\u53ea\u80fd\u4e22\u5f03\uff0c\u5bfc\u81f4\u5b9d\u8d35\u7684\u4f18\u5316\u673a\u4f1a\u767d\u767d\u6d6a\u8d39\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9</p> <ul> <li>\u60f3\u8c61\u4f60\u5728\u5f00\u8f66\u53bb\u4e00\u4e2a\u964c\u751f\u57ce\u5e02\u3002\u4f20\u7edf\u7684 PGO \u5c31\u50cf\u662f\u51fa\u53d1\u524d\uff0c\u4f60\u6839\u636e\u4e00\u4efd\u6628\u5929\u7684\u7eb8\u8d28\u5730\u56fe\u89c4\u5212\u597d\u4e86\u6700\u4f18\u8def\u7ebf\u3002\u4f46\u73b0\u5b9e\u662f\uff0c\u8def\u4e0a\u53ef\u80fd\u6709\u7a81\u53d1\u7684\u4ea4\u901a\u4e8b\u6545\uff08\u8f93\u5165\u53d8\u5316\uff09\u6216\u8005\u4e00\u591c\u4e4b\u95f4\u4fee\u4e86\u65b0\u8def\uff08\u4ee3\u7801\u66f4\u65b0\uff09\uff0c\u4f60\u7684\u65e7\u5730\u56fe\u7acb\u523b\u5c31\u5931\u6548\u4e86\u3002</li> <li>OCOLOS \u505a\u7684\u4e8b\u60c5\uff0c\u76f8\u5f53\u4e8e\u7ed9\u4f60\u7684\u8f66\u88c5\u4e86\u4e00\u4e2a\u5b9e\u65f6\u8054\u7f51\u7684\u9ad8\u5fb7\u5730\u56fe\u3002\u5b83\u4e00\u8fb9\u5f00\u8f66\uff08\u7a0b\u5e8f\u8fd0\u884c\uff09\uff0c\u4e00\u8fb9\u901a\u8fc7 GPS\uff08\u786c\u4ef6\u6027\u80fd\u8ba1\u6570\u5668\uff09\u611f\u77e5\u5f53\u524d\u8def\u51b5\uff08\u4ee3\u7801\u70ed\u70b9\uff09\uff0c\u5e76\u52a8\u6001\u5730\u3001\u5728\u7ebf\u5730\u4e3a\u4f60\u91cd\u65b0\u89c4\u5212\u4e00\u6761\u6700\u5feb\u7684\u8def\u7ebf\uff08\u91cd\u6392\u4ee3\u7801\u5e03\u5c40\uff09\uff0c\u786e\u4fdd\u4f60\u6c38\u8fdc\u8d70\u5728\u6700\u9ad8\u6548\u7684\u8def\u5f84\u4e0a\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db</p> <ul> <li>OCOLOS \u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1a\u4e0e\u5176\u8d39\u52b2\u5730\u628a\u65e7 profile \u201c\u6620\u5c04\u201d\u5230\u65b0\u4ee3\u7801\u4e0a\uff0c\u4e0d\u5982\u76f4\u63a5\u5728\u6b63\u5728\u8dd1\u7684\u8fdb\u7a0b\u91cc\u505a\u4f18\u5316\u3002\u5b83\u7684\u5de7\u5999\u4e4b\u5904\u5728\u4e8e\u5982\u4f55\u5b89\u5168\u5730\u201c\u6362\u5f15\u64ce\u201d\u800c\u4e0d\u8ba9\u8f66\u7184\u706b\u3002</li> <li>\u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u6ca1\u6709\u91c7\u7528\u201c\u539f\u5730\u4fee\u6539\u201d\u7684\u5371\u9669\u64cd\u4f5c\uff0c\u800c\u662f\u9075\u5faa\u4e86\u4e00\u4e2a\u7a33\u5065\u7684\u8bbe\u8ba1\u539f\u5219\uff1a\u4fdd\u7559\u539f\u59cb\u4ee3\u7801 C0 \u7684\u5730\u5740\u4e0d\u53d8\u3002</li> <li>\u5b83\u5148\u628a\u4f18\u5316\u540e\u7684\u65b0\u4ee3\u7801 C1 \u6ce8\u5165\u5230\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u91cc\u3002</li> <li>\u7136\u540e\uff0c\u5b83\u53ea\u53bb\u7cbe\u51c6\u5730\u4fee\u6539\u90a3\u4e9b\u6700\u5bb9\u6613\u8ffd\u8e2a\u548c\u66f4\u65b0\u7684\u4ee3\u7801\u6307\u9488\uff0c\u6bd4\u5982\uff1a<ul> <li>v-table \u91cc\u7684\u865a\u51fd\u6570\u6307\u9488</li> <li>\u76f4\u63a5\u8c03\u7528 (direct call) \u7684\u6307\u4ee4\u76ee\u6807</li> </ul> </li> <li>\u5bf9\u4e8e\u90a3\u4e9b\u96be\u4ee5\u8ffd\u8e2a\u7684\u6307\u9488\uff08\u6bd4\u5982\u88ab cast \u6210\u6574\u6570\u3001\u5b58\u5230\u5806\u6808\u6df1\u5904\u7684\u51fd\u6570\u6307\u9488\uff09\uff0c\u5b83\u9009\u62e9\u4e0d\u53bb\u78b0\u5b83\u4eec\u3002\u56e0\u4e3a\u4e00\u65e6\u6267\u884c\u6d41\u8fdb\u5165 C0\uff0c\u5f88\u5feb\u5c31\u4f1a\u9047\u5230\u4e00\u4e2a\u88ab\u4fee\u8865\u8fc7\u7684\u76f4\u63a5\u8c03\u7528\u6216\u865a\u51fd\u6570\u8c03\u7528\uff0c\u4ece\u800c\u88ab\u201c\u5f15\u6d41\u201d\u56de\u9ad8\u6027\u80fd\u7684 C1 \u4ee3\u7801\u3002</li> <li>\u4e3a\u4e86\u652f\u6301\u6301\u7eed\u4f18\u5316\uff08\u6bd4\u5982\u5e94\u5bf9\u7a0b\u5e8f\u7684\u4e0d\u540c\u8fd0\u884c\u9636\u6bb5\uff09\uff0cOCOLOS \u8fd8\u5f15\u5165\u4e86\u4e00\u4e2a\u7cbe\u5de7\u7684\u673a\u5236\u6765\u5904\u7406 return address \u548c function pointer\uff1a</li> <li>\u5bf9\u4e8e\u6808\u4e0a\u7684 return address\uff0c\u5982\u679c\u5b83\u6307\u5411\u5373\u5c06\u88ab\u66ff\u6362\u7684\u65e7\u4ee3\u7801 Ci\uff0cOCOLOS \u4f1a\u5c06\u5bf9\u5e94\u7684\u51fd\u6570\u5728\u65b0\u4ee3\u7801\u533a\u57df Ci+1 \u4e2d\u505a\u4e00\u4e2a\u7cbe\u786e\u526f\u672c (bi,i+1)\uff0c\u5e76\u4fee\u6b63 return address \u6307\u5411\u8fd9\u4e2a\u526f\u672c\uff0c\u4fdd\u8bc1\u51fd\u6570\u80fd\u6b63\u786e\u8fd4\u56de\u3002</li> <li>\u5bf9\u4e8e function pointer\uff0c\u5b83\u901a\u8fc7\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 LLVM compiler pass\uff0c\u5728\u7f16\u8bd1\u65f6\u5c31\u63d2\u5165\u4e00\u4e2a\u94a9\u5b50 (<code>wrapFuncPtrCreation</code>)\u3002\u8fd9\u4e2a\u94a9\u5b50\u786e\u4fdd\u6240\u6709\u65b0\u521b\u5efa\u7684\u51fd\u6570\u6307\u9488\u90fd\u6307\u5411\u539f\u59cb\u4ee3\u7801 C0 \u7684\u5730\u5740\uff0c\u800c\u4e0d\u662f\u4efb\u4f55\u4f18\u5316\u7248\u672c Ci \u7684\u5730\u5740\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5728\u540e\u7eed\u7684\u4ee3\u7801\u66ff\u6362\u4e2d\uff0c\u5c31\u5b8c\u5168\u4e0d\u7528\u64cd\u5fc3\u8fd9\u4e9b\u6307\u9488\u7684\u517c\u5bb9\u6027\u95ee\u9898\u4e86\uff0c\u56e0\u4e3a\u5b83\u4eec\u6c38\u8fdc\u6307\u5411\u4e00\u4e2a\u7a33\u5b9a\u7684\u951a\u70b9\u3002</li> </ul> <p></p> <p>Figure 4a: Main steps OCOLOS takes to optimize a target process</p> <p></p> <p>Figure 4b: Starting state of the address space (left) and state after code replacement (right)</p> <p>\u8fd9\u79cd\u8bbe\u8ba1\u8ba9\u5b83\u65e2\u80fd\u83b7\u5f97\u63a5\u8fd1\u79bb\u7ebf BOLT oracle \u7684\u6027\u80fd\u6536\u76ca\uff08\u89c1\u4e0b\u8868\uff09\uff0c\u53c8\u5b8c\u7f8e\u89c4\u907f\u4e86 profile \u8fc7\u671f\u548c\u4ee3\u7801\u6620\u5c04\u7684\u96be\u9898\uff0c\u800c\u4e14\u5bf9\u5e94\u7528\u7a0b\u5e8f\u672c\u8eab\u5b8c\u5168\u900f\u660e\u3001\u65e0\u9700\u4fee\u6539\u3002</p> Benchmark (Input) OCOLOS Speedup BOLT (Oracle Input) Speedup MySQL (read only) 1.41x ~1.48x Verilator 2.20x ~2.25x Clang Build (BAM) 1.14x N/A <p></p> <p>Fig. 5: Performance of OCOLOS (light blue bars) compared to BOLT using an oracle profile of the input being run (dark blue bars), Clang PGO using the same oracle profile (purple bars) and BOLT using an average-case profiling input aggregated from all inputs (pink bars). All bars are normalized to original non-PGO binaries (white bars).</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/ELI5_notes/#2-safe-online-code-replacement-eli5","title":"2. \u5b89\u5168\u7684\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u673a\u5236 (Safe Online Code Replacement) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684 Profile-Guided Optimization (PGO) \u662f\u4e2a\u201c\u4e8b\u540e\u8bf8\u845b\u4eae\u201d\u3002\u5b83\u9700\u8981\u5148\u8dd1\u4e00\u904d\u7a0b\u5e8f\u6536\u96c6 profile\uff0c\u518d\u7528\u8fd9\u4e2a profile \u53bb\u91cd\u65b0\u7f16\u8bd1\u6216\u91cd\u5199\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u95ee\u9898\u6765\u4e86\uff1a<ul> <li>\u5982\u679c\u4f60\u7684\u7a0b\u5e8f\u8f93\u5165\u53d8\u4e86\uff08\u6bd4\u5982\u6570\u636e\u5e93\u4ece\u8bfb\u591a\u53d8\u6210\u5199\u591a\uff09\uff0c\u6628\u5929\u7684 profile \u4eca\u5929\u5c31\u53ef\u80fd\u6210\u4e86\u201c\u6bd2\u836f\u201d\uff0c\u4f18\u5316\u53cd\u800c\u53d8\u52a3\u5316\u3002</li> <li>\u66f4\u9ebb\u70e6\u7684\u662f\uff0c\u5982\u679c\u4f60\u7684\u4ee3\u7801\u672c\u8eab\u5728\u6301\u7eed\u66f4\u65b0\uff08\u6bd4\u5982\u6bcf\u5c0f\u65f6\u4e00\u4e2a\u65b0\u7248\u672c\uff09\uff0c\u65e7 profile \u6839\u672c\u6ca1\u6cd5\u51c6\u786e\u5730\u6620\u5c04\u5230\u65b0\u4ee3\u7801\u4e0a\uff0c\u5927\u90e8\u5206\u6570\u636e\u53ea\u80fd\u4e22\u5f03\uff0c\u975e\u5e38\u6d6a\u8d39\u3002</li> </ul> </li> <li>\u6240\u4ee5\uff0c\u7406\u60f3\u60c5\u51b5\u662f\u80fd\u8fb9\u8dd1\u8fb9\u4f18\u5316\uff0cprofile \u6c38\u8fdc\u662f\u6700\u65b0\u7684\u3002\u4f46\u8fd9\u5f15\u51fa\u4e86\u4e00\u4e2a\u81f4\u547d\u95ee\u9898\uff1a\u5982\u4f55\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5b89\u5168\u5730\u66ff\u6362\u6389\u6b63\u5728\u6267\u884c\u7684\u4ee3\u7801\uff1f</li> <li>\u5728 C/C++ \u8fd9\u7c7b unmanaged language \u91cc\uff0c\u4ee3\u7801\u6307\u9488\u65e0\u5904\u4e0d\u5728\uff1a\u51fd\u6570\u6307\u9488\u3001\u865a\u8868\u3001\u6808\u4e0a\u7684\u8fd4\u56de\u5730\u5740\u3001\u751a\u81f3\u88ab cast \u6210\u6574\u6570\u518d\u7b97\u6765\u7b97\u53bb\u7684\u6307\u9488\u3002\u4f60\u6839\u672c\u4e0d\u53ef\u80fd\u8ffd\u8e2a\u5230\u6240\u6709\u6307\u5411\u65e7\u4ee3\u7801\u7684\u6307\u9488\u3002\u4e00\u65e6\u4f60\u628a\u65e7\u4ee3\u7801\u8986\u76d6\u4e86\uff0c\u4efb\u4f55\u4e00\u4e2a\u6ca1\u88ab\u66f4\u65b0\u7684\u6307\u9488\u8df3\u56de\u53bb\uff0c\u7a0b\u5e8f\u5c31\u76f4\u63a5\u5d29\u6e83\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u5728\u9ad8\u901f\u516c\u8def\u4e0a\u5f00\u8f66\uff08\u7a0b\u5e8f\u5728\u8fd0\u884c\uff09\u3002\u4f60\u60f3\u628a\u524d\u65b9\u4e00\u6bb5\u5751\u6d3c\u7684\u8001\u8def\uff08C0\uff09\u6362\u6210\u4e00\u6761\u5d2d\u65b0\u7684\u3001\u66f4\u5e73\u987a\u7684\u5feb\u901f\u8def\uff08C1\uff09\u3002</li> <li>\u4f20\u7edf\u505a\u6cd5\u662f\uff1a\u5c01\u8def\uff01\u8ba9\u6240\u6709\u8f66\u505c\u4e0b\u6765\uff0c\u62c6\u6389\u8001\u8def\uff0c\u5efa\u597d\u65b0\u8def\uff0c\u518d\u653e\u884c\u3002\u8fd9\u5bf9\u5e94\u4e8e\u79bb\u7ebf PGO\uff0c\u4ee3\u4ef7\u5de8\u5927\u4e14\u4e0d\u7075\u6d3b\u3002</li> <li>OCOLOS \u7684\u505a\u6cd5\u5f88\u806a\u660e\uff1a\u5b83\u4e0d\u62c6\u8001\u8def\uff0c\u800c\u662f\u5728\u65c1\u8fb9\u5e73\u884c\u5730\u4fee\u4e00\u6761\u65b0\u8def\uff08C1\uff09\u3002\u7136\u540e\uff0c\u5b83\u53ea\u5728\u51e0\u4e2a\u6700\u5173\u952e\u7684\u9ad8\u901f\u516c\u8def\u5165\u53e3\u531d\u9053\uff08\u6bd4\u5982\u865a\u8868\u3001\u76f4\u63a5\u8c03\u7528\u70b9\uff09\u4e0a\u7acb\u65b0\u7684\u6307\u793a\u724c\uff0c\u5f15\u5bfc\u7edd\u5927\u591a\u6570\u8f66\u6d41\uff08\u6267\u884c\u6d41\uff09\u9a76\u5411\u65b0\u8def\u3002</li> <li>\u90a3\u4e9b\u6ca1\u770b\u5230\u65b0\u6307\u793a\u724c\u3001\u6216\u8005\u6267\u610f\u8981\u8d70\u8001\u8def\u7684\u5c0f\u8def\uff08\u6bd4\u5982\u67d0\u4e9b\u9690\u79d8\u7684\u51fd\u6570\u6307\u9488\uff09\uff0c\u4f9d\u7136\u53ef\u4ee5\u5f00\uff0c\u56e0\u4e3a\u8001\u8def\u8fd8\u5728\u3002\u867d\u7136\u8d70\u8001\u8def\u6162\u4e00\u70b9\uff0c\u4f46\u81f3\u5c11\u4e0d\u4f1a\u7ffb\u8f66\uff08\u7a0b\u5e8f\u4e0d\u4f1a\u5d29\u6e83\uff09\u3002\u7b49\u8f66\u6d41\u90fd\u4e60\u60ef\u8d70\u65b0\u8def\u540e\uff0c\u8001\u8def\u5c31\u53ef\u4ee5\u5b89\u5168\u5730\u5e9f\u5f03\u4e86\u3002</li> </ul> <p></p> <p>Figure 4b: Starting state of the address space (left) and state after code replacement (right)</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>OCOLOS \u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1a\u4e0e\u5176\u5192\u7740\u5d29\u6e83\u7684\u98ce\u9669\u53bb\u8ffd\u8e2a\u548c\u66f4\u65b0\u6240\u6709\u4ee3\u7801\u6307\u9488\uff0c\u4e0d\u5982\u4fdd\u7559\u65e7\u4ee3\u7801\u4f5c\u4e3a\u5b89\u5168\u7f51\uff0c\u5e76\u53ea\u66f4\u65b0\u90a3\u4e9b\u6700\u5173\u952e\u3001\u6700\u503c\u5f97\u66f4\u65b0\u7684\u6307\u9488\u3002</li> <li>\u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u505a\u4e86\u4e09\u4ef6\u4e8b\uff1a<ul> <li>\u4fdd\u7559\u539f\u59cb\u4ee3\u7801 (C0)\uff1a\u8fd9\u662f\u6574\u4e2a\u65b9\u6848\u5b89\u5168\u6027\u7684\u57fa\u77f3\u3002\u6240\u6709\u65e0\u6cd5\u8ffd\u8e2a\u7684\u6307\u9488\uff0c\u5373\u4f7f\u6307\u5411 C0\uff0c\u4e5f\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002</li> <li>\u6ce8\u5165\u4f18\u5316\u4ee3\u7801 (C1)\uff1a\u5229\u7528 BOLT \u7b49\u5de5\u5177\u751f\u6210\u4f18\u5316\u540e\u7684\u4ee3\u7801\uff0c\u5e76\u5c06\u5176\u52a0\u8f7d\u5230\u8fdb\u7a0b\u7684\u65b0\u5185\u5b58\u533a\u57df\u3002</li> <li>\u7cbe\u51c6\u5f15\u5bfc\u6267\u884c\u6d41\uff1a\u901a\u8fc7 ptrace \u6682\u505c\u8fdb\u7a0b\uff0c\u7136\u540e\u53ea\u4fee\u6539\u4e24\u7c7b\u5173\u952e\u6307\u9488\uff1a<ul> <li>\u865a\u8868 (v-table) \u4e2d\u7684\u51fd\u6570\u6307\u9488\uff1a\u8fd9\u662f\u9762\u5411\u5bf9\u8c61\u7a0b\u5e8f\u4e2d\u52a8\u6001\u5206\u53d1\u7684\u6838\u5fc3\uff0c\u66f4\u65b0\u5b83\u4eec\u80fd\u7acb\u523b\u8ba9\u5927\u91cf\u865a\u51fd\u6570\u8c03\u7528\u53d7\u76ca\u4e8e C1\u3002</li> <li>C0 \u4e2d\u7684\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\uff1a\u5c06\u8fd9\u4e9b\u8c03\u7528\u7684\u76ee\u6807\u5730\u5740\u4ece C0 \u7684\u51fd\u6570\u6539\u4e3a C1 \u7684\u5bf9\u5e94\u51fd\u6570\u3002</li> </ul> </li> </ul> </li> <li>\u8fd9\u4e2a\u7b56\u7565\u975e\u5e38\u52a1\u5b9e\u3002\u5b83\u627f\u8ba4\u4e86\u5728 unmanaged code \u4e2d\u5b8c\u5168\u638c\u63a7\u6240\u6709\u6307\u9488\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u4e8e\u662f\u9000\u800c\u6c42\u5176\u6b21\uff0c\u786e\u4fddcommon case\uff08\u901a\u8fc7\u865a\u8868\u548c\u76f4\u63a5\u8c03\u7528\u7684\u8def\u5f84\uff09\u80fd\u8dd1\u5230\u9ad8\u6027\u80fd\u7684 C1 \u4e0a\uff0c\u800c rare case\uff08\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u8c03\u7528\u7684\u8def\u5f84\uff09\u5219\u56de\u9000\u5230\u529f\u80fd\u6b63\u786e\u4f46\u6027\u80fd\u7a0d\u5dee\u7684 C0 \u4e0a\uff0c\u4ece\u800c\u5728\u5b89\u5168\u6027\u548c\u6027\u80fd\u4e4b\u95f4\u53d6\u5f97\u4e86\u5b8c\u7f8e\u7684\u5e73\u8861\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/ELI5_notes/#3-function-pointer-creation-interception-eli5","title":"3. \u51fd\u6570\u6307\u9488\u521b\u5efa\u62e6\u622a (Function Pointer Creation Interception) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <p>\u5728 OCOLOS \u8fd9\u7c7b\u652f\u6301 \u8fde\u7eed\u4f18\u5316 (Continuous Optimization) \u7684\u7cfb\u7edf\u91cc\uff0c\u4ee3\u7801\u4f1a\u7ecf\u5386 C0 \u2192 C1 \u2192 C2 ... \u7684\u591a\u6b21\u5728\u7ebf\u66ff\u6362\u3002\u65e7\u7248\u672c\u7684\u4ee3\u7801\uff08\u6bd4\u5982 C1\uff09\u5728\u65b0\u7248\u672c\uff08C2\uff09\u4e0a\u7ebf\u540e\u4f1a\u88ab\u5f53\u4f5c\u201c\u5783\u573e\u201d\u56de\u6536\u6389\u4ee5\u8282\u7701\u5185\u5b58\u3002\u4f46\u8fd9\u91cc\u6709\u4e2a\u81f4\u547d\u95ee\u9898\uff1a\u5982\u679c\u7a0b\u5e8f\u5728 C1 \u65f6\u4ee3\u521b\u5efa\u4e86\u4e00\u4e2a\u6307\u5411 C1 \u4e2d\u67d0\u4e2a\u51fd\u6570\u7684 \u51fd\u6570\u6307\u9488 (Function Pointer)\uff0c\u5e76\u628a\u5b83\u5b58\u5230\u4e86\u5806\u3001\u6808\u751a\u81f3\u5bc4\u5b58\u5668\u91cc\uff0c\u90a3\u4e48\u5f53 C1 \u88ab\u56de\u6536\u540e\uff0c\u8fd9\u4e2a\u6307\u9488\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a \u60ac\u7a7a\u6307\u9488 (Dangling Pointer)\u3002\u4e00\u65e6\u7a0b\u5e8f\u540e\u7eed\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u8c03\u7528\u51fd\u6570\uff0c\u5c31\u4f1a\u76f4\u63a5\u5d29\u6e83\u3002</p> <ul> <li>\u4f20\u7edf\u7684\u89e3\u51b3\u65b9\u6848\u662f\u5c1d\u8bd5\u5728\u8fd0\u884c\u65f6\u8ffd\u8e2a\u6240\u6709\u51fd\u6570\u6307\u9488\u7684\u521b\u5efa\u548c\u4f20\u64ad\uff0c\u4f46\u8fd9\u9700\u8981 \u6301\u7eed\u7684\u3001\u9ad8\u6602\u7684\u8fd0\u884c\u65f6\u5f00\u9500\uff0c\u8fdd\u80cc\u4e86 OCOLOS \u201c\u4e00\u6b21\u6027\u6210\u672c\u201d\u7684\u8bbe\u8ba1\u54f2\u5b66\u3002</li> <li>\u53e6\u4e00\u79cd\u65b9\u6848\u662f\u5728\u6bcf\u6b21\u4ee3\u7801\u66ff\u6362\u65f6\u626b\u63cf\u6574\u4e2a\u5185\u5b58\u53bb\u66f4\u65b0\u8fd9\u4e9b\u6307\u9488\uff0c\u8fd9\u4e0d\u4ec5 \u51e0\u4e4e\u4e0d\u53ef\u80fd\u505a\u5230\uff08\u6307\u9488\u53ef\u80fd\u88ab\u52a0\u5bc6\u3001\u62c6\u5206\uff09\uff0c\u800c\u4e14 \u4ee3\u4ef7\u5de8\u5927\uff0c\u4f1a\u4e25\u91cd\u62d6\u6162\u66ff\u6362\u8fc7\u7a0b\u3002</li> </ul> <p>\u6240\u4ee5\uff0c\u6838\u5fc3\u75db\u70b9\u662f\uff1a\u5982\u4f55\u5728\u5141\u8bb8\u4ee3\u7801\u7248\u672c\u4e0d\u65ad\u66f4\u8fed\u3001\u65e7\u7248\u672c\u88ab\u56de\u6536\u7684\u524d\u63d0\u4e0b\uff0c\u4e00\u52b3\u6c38\u9038\u5730\u89e3\u51b3\u51fd\u6570\u6307\u9488\u60ac\u7a7a\u95ee\u9898\uff0c\u4e14\u4e0d\u5f15\u5165\u4efb\u4f55\u6301\u7eed\u7684\u6027\u80fd\u8d1f\u62c5\uff1f</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <p>\u60f3\u8c61\u4f60\u5728\u4e00\u4e2a\u5927\u578b\u7269\u6d41\u4e2d\u5fc3\u5de5\u4f5c\uff0c\u8d27\u7269\uff08\u4ee3\u7801\uff09\u4f1a\u4e0d\u65ad\u5347\u7ea7\u6362\u4ee3\u3002\u65e7\u4ed3\u5e93\uff08C1\uff09\u91cc\u7684\u8d27\u7269\u4f1a\u88ab\u6e05\u7a7a\uff0c\u817e\u51fa\u5730\u65b9\u7ed9\u65b0\u4ed3\u5e93\uff08C2\uff09\u3002</p> <ul> <li>\u4f20\u7edf\u505a\u6cd5\uff1a\u6bcf\u5f53\u6709\u4eba\u8981\u8bb0\u5f55\u4e00\u4e2a\u8d27\u7269\u7684\u4f4d\u7f6e\uff08\u521b\u5efa\u51fd\u6570\u6307\u9488\uff09\uff0c\u4f60\u5c31\u7ed9\u4ed6\u4e00\u5f20\u5199\u6709\u5177\u4f53\u4ed3\u5e93\u683c\u5b50\u53f7\uff08C1\u5730\u5740\uff09\u7684\u7eb8\u6761\u3002\u7b49\u4ed3\u5e93\u6e05\u7a7a\u540e\uff0c\u6240\u6709\u62ff\u7740\u65e7\u7eb8\u6761\u7684\u4eba\u90fd\u4f1a\u8ff7\u8def\u3002</li> <li>OCOLOS\u7684\u505a\u6cd5\uff1a\u4f60\u8bbe\u7acb\u4e86\u4e00\u4e2a\u6c38\u4e45\u4e0d\u53d8\u7684\u4e2d\u592e\u67e5\u8be2\u53f0\uff08C0\uff09\u3002\u65e0\u8bba\u8d27\u7269\u642c\u5230\u54ea\u4e2a\u65b0\u4ed3\u5e93\uff0c\u5f53\u4f60\u7ed9\u522b\u4eba\u7eb8\u6761\u65f6\uff0c\u4e0a\u9762\u5199\u7684\u90fd\u4e0d\u662f\u5177\u4f53\u7684\u4ed3\u5e93\u683c\u5b50\u53f7\uff0c\u800c\u662f\u201c\u8bf7\u53bb\u4e2d\u592e\u67e5\u8be2\u53f0\u627eXX\u8d27\u7269\u201d\u3002\u8fd9\u6837\uff0c\u5373\u4f7f\u80cc\u540e\u7684\u4ed3\u5e93\uff08Ci\uff09\u53d8\u4e86\u53c8\u53d8\uff0c\u53ea\u8981\u4e2d\u592e\u67e5\u8be2\u53f0\uff08C0\uff09\u8fd8\u5728\uff0c\u5e76\u4e14\u80fd\u6b63\u786e\u6307\u5f15\u5230\u6700\u65b0\u4ed3\u5e93\uff0c\u5c31\u4e0d\u4f1a\u6709\u4eba\u8ff7\u8def\u3002</li> </ul> <p>\u8fd9\u4e2a\u201c\u4e2d\u592e\u67e5\u8be2\u53f0\u201d\u5c31\u662f\u539f\u59cb\u4ee3\u7801 C0\uff0c\u5b83\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u79fb\u52a8\u6216\u56de\u6536\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u53bb\u8ffd\u8e2a\u548c\u66f4\u65b0\u90a3\u4e9b\u5df2\u7ecf\u6563\u843d\u5728\u5404\u5904\u7684\u51fd\u6570\u6307\u9488\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728\u6e90\u5934\u4e0a\u505a\u4e86\u4e00\u4e2a\u201c\u5077\u6881\u6362\u67f1\u201d\u7684\u64cd\u4f5c\u3002</p> <ul> <li>\u5728\u7f16\u8bd1\u9636\u6bb5\uff0cOCOLOS \u63d2\u5165\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 LLVM Compiler Pass\u3002</li> <li>\u8fd9\u4e2a Pass \u4f1a\u627e\u5230\u7a0b\u5e8f\u4e2d\u6240\u6709 \u521b\u5efa\u51fd\u6570\u6307\u9488 \u7684\u5730\u65b9\uff08\u4f8b\u5982 <code>func_ptr = &amp;my_function;</code>\uff09\u3002</li> <li>\u5b83\u5c06\u8fd9\u4e9b\u8bed\u53e5\u91cd\u5199\uff0c\u5728\u5176\u540e\u63d2\u5165\u4e00\u4e2a\u5bf9 <code>wrapFuncPtrCreation</code> \u56de\u8c03\u51fd\u6570\u7684\u8c03\u7528\u3002</li> <li>\u8fd9\u4e2a <code>wrapFuncPtrCreation</code> \u51fd\u6570\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u5f20 \u6620\u5c04\u8868\uff0c\u8bb0\u5f55\u4e86\u6240\u6709\u4f18\u5316\u7248\u672c Ci \u4e2d\u7684\u51fd\u6570\u5730\u5740\u5230\u5176\u5728\u539f\u59cb\u7248\u672c C0 \u4e2d\u5bf9\u5e94\u5730\u5740\u7684\u6620\u5c04\u3002</li> <li>\u56e0\u6b64\uff0c\u65e0\u8bba <code>&amp;my_function</code> \u5728\u5f53\u524d\u65f6\u523b\u5b9e\u9645\u6307\u5411\u7684\u662f C1\u3001C2 \u8fd8\u662f C99 \u4e2d\u7684\u5730\u5740\uff0c<code>wrapFuncPtrCreation</code> \u90fd\u4f1a\u5c06\u5176 \u62e6\u622a\u5e76\u91cd\u5b9a\u5411 \u5230 C0 \u4e2d\u90a3\u4e2a\u6c38\u6052\u4e0d\u53d8\u7684\u5730\u5740\u3002</li> </ul> <p></p> <p>Figure 4c: Before (left) and after (right) continuous optimization</p> <p>\u8fd9\u4e2a\u8bbe\u8ba1\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff1a - \u6210\u672c\u6781\u4f4e\uff1a\u62e6\u622a\u53ea\u53d1\u751f\u5728\u51fd\u6570\u6307\u9488\u521b\u5efa\u7684\u77ac\u95f4\uff0c\u4e4b\u540e\u6307\u9488\u53ef\u4ee5\u50cf\u666e\u901a\u6570\u636e\u4e00\u6837\u81ea\u7531\u4f20\u9012\uff0c\u6ca1\u6709\u4efb\u4f55\u989d\u5916\u5f00\u9500\u3002\u8bba\u6587\u63d0\u5230 MySQL \u6bcf\u6beb\u79d2\u624d\u521b\u5efa\u7ea6 45 \u4e2a\u51fd\u6570\u6307\u9488\uff0c\u5f00\u9500\u5b8c\u5168\u53ef\u4ee5\u5ffd\u7565\u3002 - \u4e00\u52b3\u6c38\u9038\uff1a\u7531\u4e8e\u6240\u6709\u51fd\u6570\u6307\u9488\u6700\u7ec8\u90fd\u6307\u5411\u4e0d\u4f1a\u88ab\u56de\u6536\u7684 C0\uff0c\u56e0\u6b64\u540e\u7eed\u65e0\u8bba\u8fdb\u884c\u591a\u5c11\u6b21\u4ee3\u7801\u66ff\u6362\u548c\u5783\u573e\u56de\u6536\uff0c\u8fd9\u4e9b\u6307\u9488\u90fd\u59cb\u7ec8\u6709\u6548\u3002 - \u4fdd\u6301\u517c\u5bb9\u6027\uff1aC0 \u4e2d\u7684\u51fd\u6570\u867d\u7136\u672a\u88ab\u4f18\u5316\uff0c\u4f46\u5b83\u53ea\u662f\u4e00\u4e2a\u201c\u8df3\u677f\u201d\uff0c\u5185\u90e8\u4f1a\u7acb\u523b\u8df3\u8f6c\u5230\u5f53\u524d\u6700\u65b0\u7684\u4f18\u5316\u7248\u672c Ci+1 \u53bb\u6267\u884c\uff0c\u4fdd\u8bc1\u4e86\u6027\u80fd\u3002</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/ELI5_notes/#4-batch-accelerator-mode-bam-eli5","title":"4. \u6279\u5904\u7406\u52a0\u901f\u6a21\u5f0f (Batch Accelerator Mode, BAM) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4f20\u7edf\u7684 Profile-Guided Optimization (PGO) \u5de5\u5177\uff08\u5982 BOLT\uff09\u662f \u79bb\u7ebf (offline) \u7684\u3002\u5b83\u4eec\u9700\u8981\u5148\u5b8c\u6574\u5730\u8dd1\u4e00\u904d\u7a0b\u5e8f\u6765\u6536\u96c6 profile\uff0c\u7136\u540e\u7528\u8fd9\u4e2a profile \u53bb\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6700\u540e\u518d\u7528\u8fd9\u4e2a\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u53bb\u8fd0\u884c\u771f\u6b63\u7684\u4efb\u52a1\u3002 - \u8fd9\u4e2a\u6d41\u7a0b\u5bf9\u4e8e \u957f\u65f6\u8fd0\u884c\u7684\u670d\u52a1\uff08\u5982 MySQL\uff09\u662f\u53ef\u884c\u7684\uff0c\u4f46\u5bf9\u4e8e \u77ed\u65f6\u8fdb\u7a0b\u7ec4\u6210\u7684\u6279\u5904\u7406\u4efb\u52a1\uff08\u6bd4\u5982\u4e00\u4e2a\u5305\u542b\u6210\u5343\u4e0a\u4e07\u4e2a <code>gcc</code> \u8c03\u7528\u7684\u8f6f\u4ef6\u6784\u5efa\u8fc7\u7a0b\uff09\u5c31\u5b8c\u5168\u884c\u4e0d\u901a\u4e86\u3002\u56e0\u4e3a\uff1a     - \u5355\u6b21\u8fd0\u884c\u65f6\u95f4\u592a\u77ed\uff1a\u6bcf\u4e2a <code>gcc</code> \u8fdb\u7a0b\u53ef\u80fd\u53ea\u6d3b\u51e0\u79d2\u949f\uff0c\u6839\u672c\u6765\u4e0d\u53ca\u5728\u5b83\u81ea\u5df1\u8eab\u4e0a\u5b8c\u6210\u201c\u5256\u6790 -&gt; \u4f18\u5316 -&gt; \u66ff\u6362\u201d\u8fd9\u4e00\u6574\u5957\u6602\u8d35\u7684\u64cd\u4f5c\u3002\u7b49\u4f60\u4f18\u5316\u597d\u4e86\uff0c\u8fd9\u4e2a\u8fdb\u7a0b\u65e9\u5c31\u7ed3\u675f\u4e86\u3002     - \u65e0\u6cd5\u53d7\u76ca\u4e8e\u81ea\u8eab\u4f18\u5316\uff1a\u5373\u4f7f\u4f60\u4e3a\u67d0\u4e2a <code>gcc</code> \u8c03\u7528\u751f\u6210\u4e86\u4f18\u5316\u7248\u672c\uff0c\u5b83\u81ea\u5df1\u4e5f\u7528\u4e0d\u4e0a\u4e86\uff0c\u53ea\u80fd\u5bc4\u5e0c\u671b\u4e8e\u540e\u9762\u7684\u8c03\u7528\u80fd\u7528\u4e0a\u3002\u4f46\u79bb\u7ebf PGO \u9700\u8981\u4eba\u4e3a\u7ba1\u7406 profile \u548c\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u8fd9\u5728\u590d\u6742\u7684\u6784\u5efa\u7cfb\u7edf\u4e2d\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\u4efb\u52a1\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u8981\u505a\u4e00\u9505 100 \u4e2a\u997a\u5b50\u3002\u4f20\u7edf\u79bb\u7ebf PGO \u5c31\u50cf\u662f\uff1a\u4f60\u5148\u62ff\u4e00\u4e2a\u997a\u5b50\u4e0b\u9505\u716e\uff0c\u5c1d\u4e00\u53e3\u53d1\u73b0\u76ae\u6709\u70b9\u539a\u3001\u9985\u6709\u70b9\u5c11\uff0c\u4e8e\u662f\u4f60\u8bb0\u4e0b\u7b14\u8bb0\u3002\u7136\u540e\u4f60\u628a\u9505\u6d17\u4e86\uff0c\u6839\u636e\u7b14\u8bb0\u91cd\u65b0\u548c\u9762\u3001\u8c03\u9985\uff0c\u518d\u5305\u4e00\u4e2a\u65b0\u7684\u997a\u5b50\u3002\u8fd9\u4e2a\u65b0\u997a\u5b50\u786e\u5b9e\u66f4\u597d\u5403\u4e86\uff0c\u4f46\u4f60\u4e4b\u524d\u716e\u7684\u90a3\u4e2a\u5df2\u7ecf\u6d6a\u8d39\u4e86\u3002 - BAM \u7684\u505a\u6cd5\u5219\u806a\u660e\u5f97\u591a\uff1a\u5b83\u5c31\u50cf\u4e00\u4e2a \u667a\u80fd\u7684\u53a8\u623f\u52a9\u624b\u3002\u4ed6\u770b\u5230\u4f60\u5f00\u59cb\u5305\u997a\u5b50\uff08\u542f\u52a8\u6784\u5efa\uff09\uff0c\u5c31\u9ed8\u9ed8\u5730\u89c2\u5bdf\u4f60\u524d\u51e0\u4e2a\u997a\u5b50\u7684\u505a\u6cd5\uff08\u5256\u6790\u65e9\u671f\u7684 <code>gcc</code> \u8c03\u7528\uff09\u3002\u5728\u4ed6\u89c2\u5bdf\u7684\u540c\u65f6\uff0c\u4f60\u8fd8\u5728\u7ee7\u7eed\u5305\u7740\u666e\u901a\u7684\u997a\u5b50\u3002\u7b49\u4ed6\u770b\u660e\u767d\u4e86\uff08profile \u6536\u96c6\u591f\u4e86\uff09\uff0c\u4ed6\u5c31\u7acb\u523b\u5728\u65c1\u8fb9 \u5feb\u901f\u51c6\u5907\u597d\u4e00\u6279\u6539\u826f\u7248\u7684\u997a\u5b50\u76ae\u548c\u9985\u6599\uff08\u751f\u6210 BOLT \u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff09\u3002\u4ece\u4e0b\u4e00\u4e2a\u997a\u5b50\u5f00\u59cb\uff0c\u4f60\u5c31\u81ea\u52a8\u7528\u4e0a\u4e86\u8fd9\u4e9b\u66f4\u597d\u7684\u6750\u6599\uff0c\u540e\u9762\u6240\u6709\u7684\u997a\u5b50\u90fd\u53d8\u5f97\u66f4\u597d\u5403\uff0c\u800c\u6574\u4e2a\u8fc7\u7a0b\u5bf9\u4f60\uff08\u6784\u5efa\u811a\u672c\uff09\u6765\u8bf4\u662f\u5b8c\u5168\u900f\u660e\u7684\uff0c\u4f60\u751a\u81f3\u4e0d\u77e5\u9053\u52a9\u624b\u7684\u5b58\u5728\u3002</p> <p>\u5173\u952e\u4e00\u62db - BAM \u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1a\u5728\u4e00\u4e2a\u6279\u5904\u7406\u4efb\u52a1\u4e2d\uff0c\u540c\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f1a\u88ab\u53cd\u590d\u6267\u884c\u591a\u6b21\u3002\u56e0\u6b64\uff0c\u4e0d\u9700\u8981\u5bf9\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u505a\u5728\u7ebf\u4f18\u5316\uff0c\u800c\u662f\u53ef\u4ee5 \u201c\u524d\u4eba\u683d\u6811\uff0c\u540e\u4eba\u4e58\u51c9\u201d\u3002 - \u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u4f5c\u8005\u5de7\u5999\u5730\u5229\u7528\u4e86 Linux \u7684 LD_PRELOAD \u673a\u5236\uff0c\u5e76\u505a\u4e86\u4e00\u4e2a\u5173\u952e\u7684\u903b\u8f91\u626d\u8f6c\uff1a     - \u62e6\u622a\u70b9\u626d\u8f6c\uff1a\u4f5c\u8005\u6ca1\u6709\u5c1d\u8bd5\u53bb\u66ff\u6362\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u77ed\u8fdb\u7a0b\u7684\u4ee3\u7801\uff08\u8fd9\u51e0\u4e4e\u4e0d\u53ef\u80fd\uff09\uff0c\u800c\u662f\u5c06\u4f18\u5316\u7684\u5207\u5165\u70b9\u653e\u5728\u4e86 \u8fdb\u7a0b\u521b\u5efa\u4e4b\u524d\u3002BAM \u901a\u8fc7 LD_PRELOAD \u6ce8\u5165\u4e00\u4e2a\u5171\u4eab\u5e93\uff0c\u8fd9\u4e2a\u5e93\u4f1a \u900f\u660e\u5730\u62e6\u622a\u6240\u6709 <code>exec*</code> \u7cfb\u7edf\u8c03\u7528\u3002     - \u52a8\u6001\u91cd\u5b9a\u5411\uff1a\u5f53 BAM \u53d1\u73b0 <code>exec</code> \u8c03\u7528\u7684\u76ee\u6807\u662f\u5b83\u8981\u4f18\u5316\u7684\u90a3\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u6bd4\u5982 <code>clang</code>\uff09\u65f6\uff0c\u5b83\u4f1a\u5206\u4e24\u6b65\u8d70\uff1a         1.  \u524d\u671f\uff1a\u8ba9 <code>exec</code> \u6b63\u5e38\u6267\u884c\uff0c\u4f46\u540c\u65f6 \u6084\u6084\u5f00\u542f\u786c\u4ef6\u6027\u80fd\u5256\u6790\uff08\u901a\u8fc7 <code>perf</code>\uff09\uff0c\u6536\u96c6\u8fd9\u4e2a\u8fd0\u884c\u5b9e\u4f8b\u7684 profile\u3002         2.  \u540e\u671f\uff1a\u4e00\u65e6\u540e\u53f0\u7684 BOLT \u5de5\u5177\u5229\u7528\u6536\u96c6\u5230\u7684 profile \u751f\u6210\u4e86\u4f18\u5316\u7248\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0cBAM \u5c31\u4f1a \u52a8\u6001\u4fee\u6539\u540e\u7eed\u7684 <code>exec</code> \u8c03\u7528\uff0c\u8ba9\u5b83\u76f4\u63a5\u53bb\u6267\u884c\u90a3\u4e2a \u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u539f\u59cb\u7684\u3002 - \u8fd9\u4e2a\u8bbe\u8ba1\u6781\u5176\u7cbe\u5999\uff0c\u56e0\u4e3a\u5b83\uff1a     - \u5b8c\u5168\u900f\u660e\uff1a\u6784\u5efa\u7cfb\u7edf\uff08\u5982 <code>make</code>\uff09\u5bf9\u6b64\u6beb\u65e0\u611f\u77e5\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u4ee3\u7801\u6216\u811a\u672c\u4fee\u6539\u3002     - \u96f6\u5207\u6362\u5f00\u9500\uff1a\u4ece\u539f\u59cb\u4e8c\u8fdb\u5236\u5207\u6362\u5230\u4f18\u5316\u4e8c\u8fdb\u5236\uff0c\u53ea\u662f <code>exec</code> \u4e86\u4e00\u4e2a\u4e0d\u540c\u7684\u6587\u4ef6\uff0c\u6ca1\u6709\u8fd0\u884c\u65f6\u7684\u201c\u505c\u987f\u4e16\u754c\u201d\uff08stop-the-world\uff09\u9636\u6bb5\u3002     - \u81ea\u52a8\u9002\u5e94\uff1a\u5b83\u5256\u6790\u7684\u5c31\u662f\u5f53\u524d\u6784\u5efa\u4efb\u52a1\u7684\u771f\u5b9e workload\uff0c\u751f\u6210\u7684\u4f18\u5316\u662f\u9ad8\u5ea6\u76f8\u5173\u7684\uff0c\u907f\u514d\u4e86\u79bb\u7ebf PGO \u4e2d profile \u8fc7\u65f6\u6216\u4e0d\u5339\u914d\u7684\u95ee\u9898\u3002</p> <p></p> <p>Fig. 10: The running time of a Clang build with the original compiler, and compilers optimized by BOLT and BAM.</p> <p>\u5982\u56fe\u6240\u793a\uff0c\u5728 Clang \u6784\u5efa\u5b9e\u9a8c\u4e2d\uff0cBAM \u4ec5\u9700\u5256\u6790 \u5c11\u91cf\uff08\u7ea65\u4e2a\uff09\u65e9\u671f\u7684\u7f16\u8bd1\u5668\u8c03\u7528\uff0c\u5c31\u80fd\u751f\u6210\u4e00\u4e2a\u8db3\u591f\u597d\u7684\u4f18\u5316\u7248\u672c\uff0c\u4ece\u800c\u5c06\u6574\u4e2a\u6784\u5efa\u65f6\u95f4\u52a0\u901f 1.14\u500d\u3002\u8fd9\u8bc1\u660e\u4e86\u5176\u201c\u89c2\u5bdf\u5c11\u6570\uff0c\u60e0\u53ca\u591a\u6570\u201d\u7684\u7b56\u7565\u975e\u5e38\u9ad8\u6548\u3002</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/","title":"OCOLOS: Online COde Layout OptimizationS \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-1-amd-intel-per-core-l1i-capacity-over-time","title":"Fig. 1: AMD &amp; Intel per-core L1i capacity over time","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a\u201cFig. 1: AMD &amp; Intel per-core L1i capacity over time\u201d\uff0c\u5c55\u793a\u4e86\u4ece2006\u5e74\u81f32022\u5e74\u95f4\uff0cAMD\u4e0eIntel\u4e24\u5bb6\u516c\u53f8\u5904\u7406\u5668\u6bcf\u6838\u5fc3\u7684L1 instruction cache (L1i)\u5bb9\u91cf\u53d8\u5316\u8d8b\u52bf\u3002</li> <li>Intel\u7684L1i\u5bb9\u91cf\u5728\u56fe\u793a\u65f6\u95f4\u8303\u56f4\u5185\u59cb\u7ec8\u4fdd\u630132 KiB\u4e0d\u53d8\uff0c\u4ee5\u84dd\u8272\u5b9e\u7ebf\u65b9\u5757\u6807\u8bb0\uff0c\u8868\u660e\u5176\u8bbe\u8ba1\u7b56\u7565\u503e\u5411\u4e8e\u7ef4\u6301\u7a33\u5b9a\u3001\u4f4e\u5ef6\u8fdf\u7684\u7f13\u5b58\u7ed3\u6784\u3002</li> <li>AMD\u7684L1i\u5bb9\u91cf\u5219\u5448\u73b0\u6ce2\u52a8\u53d8\u5316\uff1a\u8d77\u59cb\u4e8e2006\u5e74\u768464 KiB\uff08\u7ea2\u8272\u865a\u7ebf\u4e09\u89d2\u5f62\uff09\uff0c\u968f\u540e\u57282010\u5e74\u964d\u81f332 KiB\uff0c\u5e76\u57282014\u5e74\u56de\u5347\u81f348 KiB\uff0c2018\u5e74\u518d\u6b21\u8fbe\u523064 KiB\uff0c\u6700\u7ec8\u57282022\u5e74\u56de\u843d\u81f332 KiB\u3002</li> <li>\u6570\u636e\u70b9\u5206\u5e03\u663e\u793a\uff0cIntel\u5728\u6240\u6709\u5e74\u4efd\u5747\u4fdd\u6301\u6052\u5b9a\u5bb9\u91cf\uff0c\u800cAMD\u5219\u6839\u636e\u67b6\u6784\u6f14\u8fdb\u591a\u6b21\u8c03\u6574L1i\u5927\u5c0f\uff0c\u53cd\u6620\u5176\u5bf9\u6027\u80fd\u4e0e\u529f\u8017\u5e73\u8861\u7684\u4e0d\u540c\u53d6\u820d\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5173\u952e\u5e74\u4efd\u6570\u636e\uff1a</li> </ul> \u5e74\u4efd Intel L1i (KiB) AMD L1i (KiB) 2006 32 64 2010 32 32 2014 32 48 2018 32 64 2022 32 32 <ul> <li>\u56fe\u4e2d\u8d8b\u52bf\u5370\u8bc1\u8bba\u6587\u5f15\u8a00\u6240\u8ff0\uff1a\u5c3d\u7ba1\u6469\u5c14\u5b9a\u5f8b\u6301\u7eed\u63a8\u52a8\u6676\u4f53\u7ba1\u5bc6\u5ea6\u589e\u957f\uff0c\u4f46L1i\u56e0latency-critical\u7279\u6027\uff0c\u5176\u5bb9\u91cf\u5e76\u672a\u540c\u6b65\u6269\u5c55\uff0c\u5c24\u5176Intel\u957f\u671f\u7ef4\u630132 KiB\uff0c\u51f8\u663e\u524d\u7aef\u74f6\u9888\u95ee\u9898\u65e5\u76ca\u4e25\u5cfb\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-2-example-program-which-benefits-from-pgo","title":"Fig. 2: Example program which benefits from PGO","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Fig. 2: Example program which benefits from PGO\uff0c\u7528\u4e8e\u8bf4\u660e Profile-Guided Optimization (PGO) \u5982\u4f55\u901a\u8fc7\u8c03\u6574\u4ee3\u7801\u5e03\u5c40\u63d0\u5347\u6027\u80fd\u3002</li> <li>\u5de6\u4fa7\u4e3a\u6e90\u4ee3\u7801\u7247\u6bb5\uff0c\u5305\u542b\u4e24\u4e2a <code>if-else</code> \u6761\u4ef6\u8bed\u53e5\uff1a</li> <li>\u7b2c\u4e00\u4e2a <code>if (cond1)</code> \u5206\u652f\uff1a\u6267\u884c\u5757 A\u3001B\uff08true\uff09\u6216 C\uff08false\uff09\u3002</li> <li>\u7b2c\u4e8c\u4e2a <code>if (cond2)</code> \u5206\u652f\uff1a\u6267\u884c\u5757 D\u3001E\uff08true\uff09\u6216 F\uff08false\uff09\u3002</li> <li>\u6700\u540e\u6267\u884c\u5757 G\u3002</li> <li>\u53f3\u4fa7\u5bf9\u6bd4\u4e86\u4e24\u79cd\u4ee3\u7801\u5e03\u5c40\u65b9\u5f0f\uff1a</li> <li>Naive layout\uff08\u6734\u7d20\u5e03\u5c40\uff09\uff1a\u6309\u6e90\u7801\u987a\u5e8f\u6392\u5217\u57fa\u672c\u5757 A\u2192B\u2192C\u2192D\u2192E\u2192F\u2192G\u3002\u82e5 <code>cond1</code> \u548c <code>cond2</code> \u5747\u4e3a\u771f\uff0c\u5219\u9700\u6267\u884c\u4e24\u6b21\u8df3\u8f6c\uff08\u4ece B \u5230 D\uff0c\u4ece E \u5230 G\uff09\uff0c\u5bfc\u81f4 taken branches \u589e\u52a0\u3002</li> <li>Optimal layout\uff08\u4f18\u5316\u5e03\u5c40\uff09\uff1a\u6839\u636e PGO \u5206\u6790\u7684\u70ed\u70b9\u8def\u5f84\u91cd\u65b0\u6392\u5e8f\u4e3a A\u2192B\u2192D\u2192E\u2192G\u2192C\u2192F\u3002\u82e5 <code>cond1</code> \u548c <code>cond2</code> \u5747\u4e3a\u771f\uff0c\u5219\u6240\u6709\u5757\u8fde\u7eed\u6267\u884c\uff0c\u65e0 taken branches\uff0c\u6700\u5927\u5316 L1i \u548c iTLB \u5c40\u90e8\u6027\u3002</li> <li>\u5173\u952e\u6027\u80fd\u5f71\u54cd\uff1a</li> <li>Taken branches \u4f1a\u589e\u52a0 Branch Target Buffer (BTB) \u538b\u529b\uff0c\u800c BTB \u4ec5\u5b58\u50a8 taken \u5206\u652f\u4fe1\u606f\u3002</li> <li>\u4f18\u5316\u5e03\u5c40\u901a\u8fc7\u7ebf\u6027\u5316\u5e38\u89c1\u8def\u5f84\uff0c\u51cf\u5c11\u5206\u652f\u9884\u6d4b\u5f00\u9500\u548c\u6307\u4ee4\u7f13\u5b58\u7f3a\u5931\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u4f53\u73b0\u4e86 PGO \u7684\u6838\u5fc3\u4ef7\u503c\uff1a\u5c06\u9ad8\u9891\u6267\u884c\u8def\u5f84\u7684\u4ee3\u7801\u5757\u7269\u7406\u76f8\u90bb\u653e\u7f6e\uff0c\u4ece\u800c\u964d\u4f4e\u524d\u7aef\u505c\u987f\uff0c\u63d0\u5347 IPC\u3002</li> </ul> \u5e03\u5c40\u7c7b\u578b \u57fa\u672c\u5757\u987a\u5e8f cond1=true, cond2=true \u65f6\u7684\u8df3\u8f6c\u6b21\u6570 \u6027\u80fd\u4f18\u52bf Naive layout A\u2192B\u2192C\u2192D\u2192E\u2192F\u2192G 2 \u65e0 Optimal layout A\u2192B\u2192D\u2192E\u2192G\u2192C\u2192F 0 \u51cf\u5c11 taken branches\uff0c\u63d0\u5347\u5c40\u90e8\u6027"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-3-performance-achieved-when-running-mysql-with-the-sysbench-read-only-input-using-bolt-to-produce-a-binary-from-the-given-profiling-input-or-with-the-all-bar-from-profiles-of-all-inputs-combined","title":"Fig. 3: Performance achieved when running MySQL with the Sysbench read only input, using BOLT to produce a binary from the given profiling input or, with the all bar, from profiles of all inputs combined.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728 MySQL \u4f7f\u7528 Sysbench \u7684 read only \u8f93\u5165\u65f6\uff0c\u4e0d\u540c\u914d\u7f6e\u4e0b\u7684\u6027\u80fd\u8868\u73b0\uff0c\u5355\u4f4d\u4e3a\u6bcf\u79d2\u4e8b\u52a1\u6570\uff08transactions / second\uff09\u3002</li> <li>\u6027\u80fd\u6570\u636e\u57fa\u4e8e\u4f7f\u7528 BOLT \u5de5\u5177\u4ece\u4e0d\u540c\u201c\u8bad\u7ec3\u201d\u8f93\u5165\u751f\u6210\u7684\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u7136\u540e\u5728\u7edf\u4e00\u7684 read only \u8f93\u5165\u4e0b\u8fdb\u884c\u6d4b\u8bd5\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u4e09\u79cd\u5bf9\u6bd4\u57fa\u51c6\uff1a</li> <li>OCOLOS\uff1a\u5728\u7ebf\u4f18\u5316\u7cfb\u7edf\uff0c\u5176\u6027\u80fd\u7528\u6d45\u7070\u8272\u6761\u5f62\u8868\u793a\u3002</li> <li>original\uff1a\u672a\u7ecf\u8fc7\u4efb\u4f55 PGO \u4f18\u5316\u7684\u539f\u59cb\u4e8c\u8fdb\u5236\uff0c\u7528\u865a\u7ebf\u8868\u793a\u3002</li> <li>BOLT\uff1a\u79bb\u7ebf\u4f18\u5316\u5de5\u5177\uff0c\u5176\u6027\u80fd\u7528\u6df1\u84dd\u8272\u6761\u5f62\u8868\u793a\u3002</li> <li>\u6a2a\u8f74\u4ee3\u8868\u4e0d\u540c\u7684\u201c\u8bad\u7ec3\u201d\u8f93\u5165\uff0c\u5373\u7528\u4e8e\u751f\u6210 BOLT \u4f18\u5316\u4e8c\u8fdb\u5236\u7684\u914d\u7f6e\uff1b\u7eb5\u8f74\u5217\u51fa\u8fd9\u4e9b\u8f93\u5165\u540d\u79f0\u3002</li> <li>\u5173\u952e\u89c2\u5bdf\u70b9\uff1a</li> <li>\u5f53 BOLT \u4f7f\u7528\u4e0e\u8fd0\u884c\u65f6\u8f93\u5165\u5b8c\u5168\u4e00\u81f4\u7684 read only \u914d\u7f6e\u8fdb\u884c\u8bad\u7ec3\u65f6\uff0c\u6027\u80fd\u8fbe\u5230\u5cf0\u503c\uff0c\u7ea6\u4e3a 5800 tps\u3002</li> <li>\u5f53\u4f7f\u7528 insert \u8f93\u5165\u4f5c\u4e3a\u8bad\u7ec3\u6570\u636e\u65f6\uff0c\u6027\u80fd\u6700\u5dee\uff0c\u7ea6\u4e3a 4600 tps\uff0c\u6bd4\u6700\u4f73\u60c5\u51b5\u4f4e\u7ea6 21%\u3002</li> <li>\u5c06\u6240\u6709\u8f93\u5165\u7684\u914d\u7f6e\u5408\u5e76\u4e3a all \u8fdb\u884c\u8bad\u7ec3\u65f6\uff0c\u6027\u80fd\u7ea6\u4e3a 5300 tps\uff0c\u6bd4\u6700\u4f73\u60c5\u51b5\u4f4e\u7ea6 8%\uff0c\u663e\u793a\u51fa\u805a\u5408\u914d\u7f6e\u5b58\u5728\u201c\u7834\u574f\u6027\u5e72\u6270\u201d\u3002</li> <li>OCOLOS \u7684\u6027\u80fd\uff08\u7ea6 5700 tps\uff09\u51e0\u4e4e\u4e0e BOLT \u6700\u4f73\u914d\u7f6e\u6301\u5e73\uff0c\u8bc1\u660e\u5176\u5728\u7ebf\u4f18\u5316\u80fd\u59cb\u7ec8\u5339\u914d\u5f53\u524d\u8fd0\u884c\u8d1f\u8f7d\u3002</li> <li>\u6570\u636e\u603b\u7ed3\u5982\u4e0b\u8868\uff1a</li> </ul> \u8bad\u7ec3\u8f93\u5165 (Profiling Input) BOLT \u6027\u80fd (tps) OCOLOS \u6027\u80fd (tps) \u76f8\u5bf9\u5dee\u5f02 read only ~5800 ~5700 +1.8% insert ~4600 ~5700 +24% all ~5300 ~5700 +7.5% <ul> <li>\u7ed3\u8bba\uff1a\u8be5\u56fe\u6709\u529b\u9a8c\u8bc1\u4e86\u8bba\u6587\u6838\u5fc3\u89c2\u70b9\u2014\u2014\u79bb\u7ebf PGO \u7684\u6027\u80fd\u9ad8\u5ea6\u4f9d\u8d56\u4e8e\u8bad\u7ec3\u6570\u636e\u7684\u8d28\u91cf\u548c\u76f8\u5173\u6027\uff0c\u800c OCOLOS \u901a\u8fc7\u5728\u7ebf\u5b9e\u65f6\u4f18\u5316\uff0c\u907f\u514d\u4e86\u8fd9\u4e00\u95ee\u9898\uff0c\u59cb\u7ec8\u63d0\u4f9b\u63a5\u8fd1\u6700\u4f18\u7684\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#figure-4a-main-steps-ocolos-takes-to-optimize-a-target-process","title":"Figure 4a: Main steps OCOLOS takes to optimize a target process","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 OCOLOS \u7cfb\u7edf\u4f18\u5316\u76ee\u6807\u8fdb\u7a0b\u7684\u516d\u4e2a\u4e3b\u8981\u6b65\u9aa4\uff0c\u4ee5\u65f6\u95f4\u8f74\u5f62\u5f0f\u5448\u73b0\uff0c\u4ece\u5de6\u81f3\u53f3\u4f9d\u6b21\u63a8\u8fdb\u3002</li> <li>\u6b65\u9aa4\u2460\uff1aProfile \u2014\u2014 \u5728\u76ee\u6807\u8fdb\u7a0b\u8fd0\u884c\u671f\u95f4\uff0cOCOLOS \u901a\u8fc7 Linux perf \u5de5\u5177\u6536\u96c6\u786c\u4ef6\u6027\u80fd\u6570\u636e\uff08\u5982 LBR \u6837\u672c\uff09\uff0c\u7528\u4e8e\u8bc6\u522b\u70ed\u70b9\u63a7\u5236\u6d41\u8def\u5f84\u3002\u6b64\u9636\u6bb5\u4e0e\u76ee\u6807\u8fdb\u7a0b\u5e76\u884c\u6267\u884c\uff0c\u4e0d\u4e2d\u65ad\u5176\u8fd0\u884c\u3002</li> <li>\u6b65\u9aa4\u2461\uff1aBuild optimized binary \u2014\u2014 \u5229\u7528\u6536\u96c6\u5230\u7684 profile \u6570\u636e\u548c\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u8c03\u7528 BOLT \u5de5\u5177\u751f\u6210\u4e00\u4e2a\u7ecf\u8fc7\u5e03\u5c40\u4f18\u5316\u7684\u65b0\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u8be5\u8fc7\u7a0b\u5728\u540e\u53f0\u8fdb\u884c\uff0c\u540c\u6837\u4e0d\u5f71\u54cd\u76ee\u6807\u8fdb\u7a0b\u7684\u6b63\u5e38\u6267\u884c\u3002</li> <li>\u6b65\u9aa4\u2462\uff1aPause process \u2014\u2014 \u5f53\u4f18\u5316\u4e8c\u8fdb\u5236\u51c6\u5907\u5c31\u7eea\u540e\uff0cOCOLOS \u4f7f\u7528 ptrace API \u6682\u505c\u76ee\u6807\u8fdb\u7a0b\uff0c\u8fdb\u5165\u201cstop-the-world\u201d\u72b6\u6001\uff0c\u4e3a\u4ee3\u7801\u6ce8\u5165\u505a\u51c6\u5907\u3002\u8fd9\u662f\u552f\u4e00\u4e2d\u65ad\u670d\u52a1\u7684\u9636\u6bb5\u3002</li> <li>\u6b65\u9aa4\u2463\uff1aInject code \u2014\u2014 \u5c06 BOLT \u751f\u6210\u7684\u4f18\u5316\u4ee3\u7801\u6bb5\u6ce8\u5165\u5230\u76ee\u6807\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\uff0c\u901a\u5e38\u653e\u7f6e\u4e8e\u9ad8\u5730\u5740\u533a\u57df\uff0c\u907f\u514d\u8986\u76d6\u539f\u6709\u4ee3\u7801\u3002\u539f\u4ee3\u7801\uff08C0\uff09\u4fdd\u6301\u4e0d\u53d8\uff0c\u65b0\u4ee3\u7801\uff08C1\uff09\u4f5c\u4e3a\u66ff\u4ee3\u7248\u672c\u5b58\u5728\u3002</li> <li>\u6b65\u9aa4\u2464\uff1aUpdate pointers \u2014\u2014 \u5728\u6682\u505c\u72b6\u6001\u4e0b\uff0cOCOLOS \u66f4\u65b0\u5173\u952e\u4ee3\u7801\u6307\u9488\uff0c\u5982\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\u3001\u865a\u51fd\u6570\u8868\u6761\u76ee\u3001\u6808\u4e0a\u8fd4\u56de\u5730\u5740\u7b49\uff0c\u4f7f\u5176\u6307\u5411\u65b0\u6ce8\u5165\u7684 C1 \u4ee3\u7801\u3002\u6b64\u64cd\u4f5c\u9075\u5faa\u201crun C1 code in the common case\u201d\u539f\u5219\uff0c\u4f18\u5148\u786e\u4fdd\u9ad8\u9891\u8def\u5f84\u4f7f\u7528\u4f18\u5316\u4ee3\u7801\u3002</li> <li>\u6b65\u9aa4\u2465\uff1aRun with optimized code \u2014\u2014 \u5b8c\u6210\u4ee3\u7801\u6ce8\u5165\u4e0e\u6307\u9488\u66f4\u65b0\u540e\uff0c\u6062\u590d\u76ee\u6807\u8fdb\u7a0b\u6267\u884c\u3002\u6b64\u65f6\u8fdb\u7a0b\u5c06\u4e3b\u8981\u8fd0\u884c\u4f18\u5316\u540e\u7684 C1 \u4ee3\u7801\uff0c\u4ece\u800c\u83b7\u5f97\u6027\u80fd\u63d0\u5347\u3002</li> </ul> \u6b65\u9aa4\u7f16\u53f7 \u6b65\u9aa4\u540d\u79f0 \u662f\u5426\u4e2d\u65ad\u8fdb\u7a0b \u4e3b\u8981\u64cd\u4f5c \u2460 Profile \u5426 \u6536\u96c6 LBR \u6027\u80fd\u6837\u672c\uff0c\u8bc6\u522b\u70ed\u70b9\u8def\u5f84 \u2461 Build optimized binary \u5426 \u8c03\u7528 BOLT \u751f\u6210\u4f18\u5316\u4e8c\u8fdb\u5236 \u2462 Pause process \u662f \u4f7f\u7528 ptrace \u6682\u505c\u76ee\u6807\u8fdb\u7a0b \u2463 Inject code \u662f \u5c06\u4f18\u5316\u4ee3\u7801\u6ce8\u5165\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4 \u2464 Update pointers \u662f \u4fee\u6539\u76f4\u63a5\u8c03\u7528\u3001v-table\u3001\u8fd4\u56de\u5730\u5740\u7b49\u6307\u9488\u6307\u5411\u65b0\u4ee3\u7801 \u2465 Run with optimized code \u5426 \u6062\u590d\u8fdb\u7a0b\uff0c\u6267\u884c\u4f18\u5316\u540e\u4ee3\u7801 <ul> <li>\u6574\u4e2a\u6d41\u7a0b\u8bbe\u8ba1\u5f3a\u8c03\u6700\u5c0f\u5316\u8fd0\u884c\u65f6\u5f00\u9500\uff0c\u4ec5\u5728\u6b65\u9aa4\u2462\u81f3\u2464\u671f\u95f4\u77ed\u6682\u6682\u505c\u8fdb\u7a0b\uff0c\u5176\u4f59\u9636\u6bb5\u5747\u4e0e\u76ee\u6807\u8fdb\u7a0b\u5e76\u53d1\u6267\u884c\uff0c\u786e\u4fdd\u670d\u52a1\u8fde\u7eed\u6027\u3002</li> <li>\u8be5\u56fe\u6e05\u6670\u4f53\u73b0\u4e86 OCOLOS \u7684\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5\uff1a\u5728\u7ebf\u4f18\u5316\u3001\u65e0\u4fb5\u5165\u3001\u56fa\u5b9a\u6210\u672c\uff0c\u5373\u901a\u8fc7\u4e00\u6b21\u6027\u7684\u4ee3\u7801\u66ff\u6362\u5b9e\u73b0\u6301\u7eed\u6027\u80fd\u6536\u76ca\uff0c\u65e0\u9700\u4fee\u6539\u5e94\u7528\u6e90\u7801\u6216\u4f9d\u8d56\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#figure-4b-starting-state-of-the-address-space-left-and-state-after-code-replacement-right","title":"Figure 4b: Starting state of the address space (left) and state after code replacement (right)","text":"<ul> <li>\u56fe\u7247 8e4009da7cb85456e504591a7cb55b364aebc5c3d4c6534f6c0e172f2fb96366.jpg \u5c55\u793a\u4e86 OCOLOS \u7cfb\u7edf\u5728\u8fd0\u884c\u65f6\u8fdb\u884c\u4ee3\u7801\u66ff\u6362\u524d\u540e\u7684\u5730\u5740\u7a7a\u95f4\u72b6\u6001\u5bf9\u6bd4\uff0c\u5de6\u4fa7\u4e3a\u521d\u59cb\u72b6\u6001\uff08C0\uff09\uff0c\u53f3\u4fa7\u4e3a\u66ff\u6362\u540e\u72b6\u6001\uff08C1\uff09\u3002</li> <li>\u6838\u5fc3\u8bbe\u8ba1\u539f\u5219\uff1aOCOLOS \u4e0d\u76f4\u63a5\u8986\u76d6\u539f\u59cb\u4ee3\u7801\uff0c\u800c\u662f\u5c06\u4f18\u5316\u540e\u7684\u4ee3\u7801 C1 \u6ce8\u5165\u5230\u65b0\u5730\u5740\u7a7a\u95f4\uff0c\u540c\u65f6\u4fdd\u7559\u539f\u59cb\u4ee3\u7801 C0\u3002\u901a\u8fc7\u66f4\u65b0\u90e8\u5206\u4ee3\u7801\u6307\u9488\uff0c\u5f15\u5bfc\u6267\u884c\u6d41\u8fdb\u5165 C1\uff0c\u4ece\u800c\u5728\u4fdd\u8bc1\u6b63\u786e\u6027\u7684\u540c\u65f6\u5b9e\u73b0\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u5728\u521d\u59cb\u72b6\u6001\uff08\u5de6\u56fe\uff09\u4e2d\uff1a</li> <li>\u51fd\u6570 a0\u3001b0\u3001c0 \u6784\u6210\u539f\u59cb\u4ee3\u7801\u6bb5 C0\u3002</li> <li>v-table \u4e2d\u5b58\u50a8\u6307\u5411 b0 \u7684\u51fd\u6570\u6307\u9488\u3002</li> <li>\u6808\u4e2d\u4fdd\u5b58\u8fd4\u56de\u5730\u5740 c0\uff0c\u8868\u793a\u5f53\u524d\u8c03\u7528\u6808\u5305\u542b c0\u3002</li> <li>\u5728\u66ff\u6362\u540e\u72b6\u6001\uff08\u53f3\u56fe\uff09\u4e2d\uff1a</li> <li>\u539f\u59cb\u4ee3\u7801 C0 \u4fdd\u6301\u4e0d\u53d8\uff0c\u786e\u4fdd\u672a\u88ab\u66f4\u65b0\u7684\u6307\u9488\u4ecd\u53ef\u5b89\u5168\u6267\u884c\u3002</li> <li>\u65b0\u4ee3\u7801 C1 \u5305\u542b\u4f18\u5316\u7248\u672c b1 \u548c c1\uff0c\u5176\u4e2d b1 \u88ab\u6807\u8bb0\u4e3a\u7070\u8272\uff0c\u8868\u793a\u5176\u4e3a\u65b0\u6ce8\u5165\u7684\u4f18\u5316\u4ee3\u7801\u3002</li> <li>\u5173\u952e\u4fee\u6539\uff1av-table \u4e2d\u7684\u51fd\u6570\u6307\u9488\u4ece\u6307\u5411 b0 \u66f4\u65b0\u4e3a\u6307\u5411 b1\uff1bc0 \u5185\u90e8\u7684 call \u6307\u4ee4\u4e5f\u4ece\u8c03\u7528 b0 \u6539\u4e3a\u8c03\u7528 b1\u3002</li> <li>\u6808\u4e2d\u7684\u8fd4\u56de\u5730\u5740\u4ecd\u6307\u5411 c0\uff0c\u8868\u660e OCOLOS \u5e76\u672a\u4fee\u6539\u6240\u6709\u4ee3\u7801\u6307\u9488\uff0c\u4ec5\u66f4\u65b0\u4e86\u201c\u5e38\u89c1\u8def\u5f84\u201d\u4e0a\u7684\u6307\u9488\u4ee5\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\u3002</li> <li>\u6b64\u8bbe\u8ba1\u4f53\u73b0\u4e86 OCOLOS \u7684\u4e24\u5927\u8bbe\u8ba1\u539f\u5219\uff1a</li> <li>Design Principle #1: preserve addresses of C0 instructions \u2014 \u4fdd\u7559\u539f\u59cb\u6307\u4ee4\u5730\u5740\uff0c\u907f\u514d\u7834\u574f\u4e0d\u53ef\u8ffd\u8e2a\u7684\u4ee3\u7801\u6307\u9488\u3002</li> <li>Design Principle #2: run C1 code in the common case \u2014 \u4f18\u5148\u6267\u884c\u4f18\u5316\u4ee3\u7801 C1\uff0c\u4f46\u5141\u8bb8\u5076\u5c14\u56de\u9000\u81f3 C0 \u4ee5\u4fdd\u8bc1\u517c\u5bb9\u6027\u548c\u6b63\u786e\u6027\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e86\u4ee3\u7801\u66ff\u6362\u524d\u540e\u5173\u952e\u7ec4\u4ef6\u7684\u53d8\u5316\uff1a</li> </ul> \u7ec4\u4ef6 \u521d\u59cb\u72b6\u6001 (C0) \u66ff\u6362\u540e\u72b6\u6001 (C1) \u53d8\u5316\u8bf4\u660e \u51fd\u6570 a0 \u5b58\u5728\u4e8e C0 \u672a\u53d8 \u672a\u88ab\u4f18\u5316\u6216\u8c03\u7528\uff0c\u65e0\u9700\u66f4\u65b0 \u51fd\u6570 b0 \u5b58\u5728\u4e8e C0 \u4fdd\u7559\uff0c\u65b0\u589e b1 b1 \u4e3a\u4f18\u5316\u7248\u672c\uff0c\u6ce8\u5165\u65b0\u5730\u5740 \u51fd\u6570 c0 \u5b58\u5728\u4e8e C0 \u4fdd\u7559\uff0c\u65b0\u589e c1 c1 \u4e3a\u4f18\u5316\u7248\u672c\uff0c\u5185\u90e8 call \u66f4\u65b0 v-table \u6307\u5411 b0 \u6307\u5411 b1 \u66f4\u65b0\u6307\u9488\u4ee5\u5f15\u5bfc\u6267\u884c\u81f3 C1 \u6808\u8fd4\u56de\u5730\u5740 \u6307\u5411 c0 \u4ecd\u6307\u5411 c0 \u672a\u66f4\u65b0\uff0c\u4f53\u73b0\u201c\u5e38\u89c1\u8def\u5f84\u201d\u7b56\u7565 call \u6307\u4ee4 c0 \u2192 b0 c0 \u2192 b1 \u66f4\u65b0\u8c03\u7528\u76ee\u6807\u81f3\u4f18\u5316\u51fd\u6570 <ul> <li>\u8be5\u56fe\u76f4\u89c2\u5c55\u793a\u4e86 OCOLOS \u5982\u4f55\u5728\u4e0d\u4fee\u6539\u5e94\u7528\u6e90\u7801\u7684\u524d\u63d0\u4e0b\uff0c\u901a\u8fc7\u9009\u62e9\u6027\u5730\u91cd\u5b9a\u5411\u63a7\u5236\u6d41\uff0c\u5b9e\u73b0\u5728\u7ebf\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\uff0c\u540c\u65f6\u89c4\u907f\u56e0\u6307\u9488\u5931\u6548\u5bfc\u81f4\u7684\u7a0b\u5e8f\u5d29\u6e83\u98ce\u9669\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#figure-4c-before-left-and-after-right-continuous-optimization","title":"Figure 4c: Before (left) and after (right) continuous optimization","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 OCOLOS \u7cfb\u7edf\u5728\u8fde\u7eed\u4f18\u5316\uff08Continuous Optimization\uff09\u573a\u666f\u4e0b\uff0c\u4ee3\u7801\u7248\u672c\u4ece Ci \u5230 Ci+1 \u7684\u66ff\u6362\u8fc7\u7a0b\u3002\u5de6\u4fa7\u4e3a\u201c\u4f18\u5316\u524d\u201d\u72b6\u6001\uff0c\u53f3\u4fa7\u4e3a\u201c\u4f18\u5316\u540e\u201d\u72b6\u6001\u3002</li> <li>\u6838\u5fc3\u76ee\u6807\u662f\uff1a\u5728\u4e0d\u7834\u574f\u7a0b\u5e8f\u6b63\u786e\u6027\u7684\u524d\u63d0\u4e0b\uff0c\u79fb\u9664\u65e7\u7684\u3001\u4e0d\u518d\u88ab\u5f15\u7528\u7684\u4ee3\u7801\u7248\u672c Ci\uff0c\u4ee5\u8282\u7701\u5185\u5b58\u5e76\u7ef4\u6301\u524d\u7aef\u6027\u80fd\u3002</li> <li>\u8be5\u56fe\u901a\u8fc7\u4e09\u4e2a\u5173\u952e\u533a\u57df\u8bf4\u660e\u4e86\u4ee3\u7801\u6307\u9488\u7684\u66f4\u65b0\u673a\u5236\uff1a</li> <li>\u51fd\u6570\u8c03\u7528\u5173\u7cfb\uff1a\u51fd\u6570 a0 \u8c03\u7528 b0\uff0cb0 \u8c03\u7528 c0\u3002\u5728\u4f18\u5316\u540e\uff0ca0 \u4ecd\u8c03\u7528 b0\uff0c\u4f46 b0 \u7684\u8c03\u7528\u76ee\u6807\u88ab\u66f4\u65b0\u4e3a\u65b0\u7684 b1,i+1\uff08\u4e00\u4e2a\u4ece bi \u590d\u5236\u800c\u6765\u7684\u526f\u672c\uff09\uff0c\u800c\u975e\u66f4\u4f18\u5316\u7684 bi+1\u3002</li> <li>\u865a\u8868\uff08v-table\uff09\uff1a\u865a\u8868\u4e2d\u7684\u51fd\u6570\u6307\u9488\u4ece\u6307\u5411 b1 \u66f4\u65b0\u4e3a\u6307\u5411 b1,i+1\uff0c\u786e\u4fdd\u52a8\u6001\u5206\u6d3e\u80fd\u6b63\u786e\u8df3\u8f6c\u5230\u65b0\u7248\u672c\u3002</li> <li>\u6808\u5e27\u8fd4\u56de\u5730\u5740\uff08stack\uff09\uff1a\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u51fd\u6570\uff08\u5982 b1\uff09\u7684\u8fd4\u56de\u5730\u5740\uff0c\u5728\u4f18\u5316\u540e\u88ab\u66f4\u65b0\u4e3a\u6307\u5411 b1,i+1 \u4e2d\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u4fdd\u8bc1\u51fd\u6570\u8fd4\u56de\u65f6\u4e0d\u4f1a\u8df3\u56de\u5df2\u5220\u9664\u7684\u65e7\u4ee3\u7801\u3002</li> </ul> \u533a\u57df \u4f18\u5316\u524d (Ci) \u4f18\u5316\u540e (Ci+1) \u66f4\u65b0\u7b56\u7565\u8bf4\u660e \u51fd\u6570\u8c03\u7528 a0 \u2192 b0 \u2192 c0 a0 \u2192 b0 \u2192 c1 \u76f4\u63a5\u8c03\u7528\u8def\u5f84\u4fdd\u6301\u4e0d\u53d8\uff0c\u4f46\u88ab\u8c03\u7528\u51fd\u6570\u7684\u76ee\u6807\u88ab\u91cd\u5b9a\u5411\u81f3\u65b0\u7248\u672c\u6216\u5176\u526f\u672c\u3002 \u865a\u8868\u6307\u9488 v-table \u2192 func ptr: b1 v-table \u2192 func ptr: b1,i+1 \u865a\u8868\u4e2d\u7684\u6307\u9488\u88ab\u663e\u5f0f\u66f4\u65b0\uff0c\u6307\u5411\u65b0\u7248\u672c\u4e2d\u5bf9\u5e94\u7684\u51fd\u6570\u526f\u672c\uff0c\u786e\u4fdd\u591a\u6001\u8c03\u7528\u6b63\u786e\u6027\u3002 \u6808\u8fd4\u56de\u5730\u5740 stack \u2192 ret addr: b1 stack \u2192 ret addr: b1,i+1 \u901a\u8fc7 libunwind \u548c ptrace \u904d\u5386\u6808\uff0c\u5c06\u6240\u6709\u6307\u5411\u65e7\u51fd\u6570\u7684\u8fd4\u56de\u5730\u5740\u66f4\u65b0\u4e3a\u6307\u5411\u526f\u672c\u3002 <ul> <li>\u5173\u952e\u8bbe\u8ba1\u70b9\u5728\u4e8e\uff1aOCOLOS \u5e76\u975e\u76f4\u63a5\u5c06\u6240\u6709\u8c03\u7528\u91cd\u5b9a\u5411\u5230\u6700\u4f18\u5316\u7684\u7248\u672c bi+1\uff0c\u800c\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u529f\u80fd\u7b49\u4ef7\u4f46\u4f4d\u7f6e\u4e0d\u540c\u7684\u526f\u672c b1,i+1\u3002\u8fd9\u662f\u56e0\u4e3a bi+1 \u7684\u5185\u90e8\u6307\u4ee4\u5e03\u5c40\u53ef\u80fd\u4e0e bi \u4e0d\u540c\uff0c\u5bfc\u81f4\u65e0\u6cd5\u7b80\u5355\u5730\u901a\u8fc7\u504f\u79fb\u91cf\u8ba1\u7b97\u6765\u66f4\u65b0\u8fd4\u56de\u5730\u5740\u3002</li> <li>\u8fd9\u79cd\u201c\u590d\u5236+\u91cd\u5b9a\u5411\u201d\u7684\u7b56\u7565\u786e\u4fdd\u4e86\u6b63\u5728\u6267\u884c\u7684\u51fd\u6570\u4e0a\u4e0b\u6587\u4e0d\u4f1a\u88ab\u7834\u574f\uff0c\u540c\u65f6\u5141\u8bb8\u540e\u7eed\u7684\u65b0\u8c03\u7528\uff08\u5982\u6765\u81ea\u5176\u4ed6\u7ebf\u7a0b\u6216\u65b0\u51fd\u6570\uff09\u81ea\u7136\u5730\u8fdb\u5165\u66f4\u4f18\u5316\u7684\u7248\u672c bi+1\u3002</li> <li>\u6b64\u673a\u5236\u662f OCOLOS \u5b9e\u73b0\u201c\u8fde\u7eed\u4f18\u5316\u201d\u7684\u6838\u5fc3\uff0c\u5b83\u89e3\u51b3\u4e86\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u4e2d\u201c\u5982\u4f55\u5b89\u5168\u5730\u56de\u6536\u65e7\u4ee3\u7801\u201d\u7684\u96be\u9898\uff0c\u907f\u514d\u4e86\u5185\u5b58\u65e0\u9650\u589e\u957f\u7684\u95ee\u9898\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-5-performance-of-ocolos-light-blue-bars-compared-to-bolt-using-an-oracle-profile-of-the-input-being-run-dark-blue-bars-clang-pgo-using-the-same-oracle-profile-purple-bars-and-bolt-using-an-average-case-profiling-input-aggregated-from-all-inputs-pink-bars-all-bars-are-normalized-to-original-non-pgo-binaries-white-bars","title":"Fig. 5: Performance of OCOLOS (light blue bars) compared to BOLT using an oracle profile of the input being run (dark blue bars), Clang PGO using the same oracle profile (purple bars) and BOLT using an average-case profiling input aggregated from all inputs (pink bars). All bars are normalized to original non-PGO binaries (white bars).","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 OCOLOS \u4e0e\u591a\u79cd PGO \u4f18\u5316\u65b9\u6848\u5728\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\u7684\u6027\u80fd\u5bf9\u6bd4\uff0c\u6240\u6709\u6570\u636e\u5747\u4ee5 original\uff08\u672a\u4f18\u5316\u4e8c\u8fdb\u5236\uff09\u4e3a\u57fa\u51c6\u8fdb\u884c\u5f52\u4e00\u5316\u3002</li> <li>\u6027\u80fd\u6307\u6807\u4e3a normalized throughput\uff0c\u6570\u503c\u8d8a\u9ad8\u8868\u793a\u52a0\u901f\u6548\u679c\u8d8a\u663e\u8457\u3002</li> <li>\u5bf9\u6bd4\u65b9\u6848\u5305\u62ec\uff1a</li> <li>OCOLOS\uff08\u6d45\u84dd\u8272\uff09\uff1a\u5728\u7ebf\u4f18\u5316\u7cfb\u7edf\u3002</li> <li>BOLT, oracle input\uff08\u6df1\u84dd\u8272\uff09\uff1a\u4f7f\u7528\u5f53\u524d\u8f93\u5165\u7684\u201c\u5b8c\u7f8e\u201d\u914d\u7f6e\u6587\u4ef6\u79bb\u7ebf\u4f18\u5316\u3002</li> <li>PGO, oracle input\uff08\u7d2b\u8272\uff09\uff1aClang \u5185\u7f6e PGO \u4f7f\u7528\u76f8\u540c\u201c\u5b8c\u7f8e\u201d\u914d\u7f6e\u6587\u4ef6\u3002</li> <li>BOLT, average-case input\uff08\u7c89\u8272\uff09\uff1aBOLT \u4f7f\u7528\u805a\u5408\u6240\u6709\u8f93\u5165\u7684\u5e73\u5747\u914d\u7f6e\u6587\u4ef6\u3002</li> <li> <p>original\uff08\u767d\u8272\uff09\uff1a\u65e0\u4efb\u4f55 PGO \u4f18\u5316\u7684\u539f\u59cb\u4e8c\u8fdb\u5236\u3002</p> </li> <li> <p>\u4e3b\u8981\u89c2\u5bdf\u7ed3\u679c\u5982\u4e0b\uff1a</p> </li> </ul> \u5de5\u4f5c\u8d1f\u8f7d\u7c7b\u522b \u6700\u4f73\u8868\u73b0\u65b9\u6848 OCOLOS \u76f8\u5bf9\u8868\u73b0 MySQL (read only) BOLT, oracle input \u63a5\u8fd1\u6700\u4f73\uff0c\u7565\u4f4e\u4e8e BOLT oracle MySQL (delete/write only) BOLT, oracle input \u660e\u663e\u843d\u540e\u4e8e BOLT oracle\uff08\u5dee\u8ddd\u7ea6 13-18%\uff09 MongoDB (read update) BOLT, oracle input \u63a5\u8fd1\u6700\u4f73\uff0c\u7565\u4f4e\u4e8e BOLT oracle Memcached (set10 get90) BOLT, oracle input \u7565\u4f18\u4e8e BOLT oracle Verilator (dhrystone) BOLT, oracle input \u663e\u8457\u4f18\u4e8e BOLT oracle\uff0c\u8fbe 2.20\u00d7 \u52a0\u901f <ul> <li>OCOLOS \u5728\u591a\u6570\u573a\u666f\u4e0b\u6027\u80fd\u63a5\u8fd1 BOLT oracle input\uff0c\u5e73\u5747\u4ec5\u843d\u540e 4.6%\uff0c\u8bc1\u660e\u5176\u5728\u7ebf\u4f18\u5316\u673a\u5236\u7684\u6709\u6548\u6027\u3002</li> <li>BOLT average-case input \u8868\u73b0\u666e\u904d\u8f83\u5dee\uff0c\u5e73\u5747\u6bd4 OCOLOS \u6162 8.9%\uff0c\u8bf4\u660e\u805a\u5408\u914d\u7f6e\u6587\u4ef6\u4f1a\u5f15\u5165\u5e72\u6270\uff0c\u964d\u4f4e\u4f18\u5316\u6548\u679c\u3002</li> <li>Clang PGO \u5728\u591a\u4e2a\u6d4b\u8bd5\u4e2d\u8868\u73b0\u4e0d\u5982 BOLT\uff0c\u5c24\u5176\u5728 MySQL \u548c MongoDB \u4e0a\uff0c\u9a8c\u8bc1\u4e86\u8bba\u6587\u4e2d\u63d0\u5230\u7684 PC \u5230\u6e90\u7801\u6620\u5c04\u56f0\u96be \u5bfc\u81f4\u7684\u4f18\u5316\u4e0d\u8db3\u95ee\u9898\u3002</li> <li>MongoDB scan95 insert5 \u662f\u4e00\u4e2a\u5f02\u5e38\u6848\u4f8b\uff0c\u6240\u6709 PGO \u65b9\u6848\uff08\u5305\u62ec OCOLOS\uff09\u6027\u80fd\u5747\u52a3\u4e8e original\uff0cTopDown \u5206\u6790\u663e\u793a\u5176\u74f6\u9888\u4ece\u524d\u7aef\u8f6c\u79fb\u5230\u540e\u7aef\u5185\u5b58\u8bbf\u95ee\uff0c\u6697\u793a\u4f18\u5316\u53ef\u80fd\u5f15\u53d1\u65b0\u7684\u6027\u80fd\u95ee\u9898\u3002</li> <li> <p>Verilator \u5de5\u4f5c\u8d1f\u8f7d\u53d7\u76ca\u6700\u5927\uff0cOCOLOS \u8fbe\u5230 2.20\u00d7 \u52a0\u901f\uff0c\u8868\u660e\u5176\u5bf9\u8ba1\u7b97\u5bc6\u96c6\u578b\u3001\u5355\u7ebf\u7a0b\u5e94\u7528\u7684\u4f18\u5316\u6f5c\u529b\u5de8\u5927\u3002</p> </li> <li> <p>\u5173\u952e\u7ed3\u8bba\uff1a</p> </li> <li>OCOLOS \u6210\u529f\u5b9e\u73b0\u4e86\u5728\u7ebf PGO\uff0c\u907f\u514d\u4e86\u79bb\u7ebf PGO \u7684\u914d\u7f6e\u6587\u4ef6\u8fc7\u65f6\u548c\u6620\u5c04\u5931\u6548\u95ee\u9898\u3002</li> <li>\u5176\u6027\u80fd\u63a5\u8fd1\u79bb\u7ebf\u6700\u4f18\u65b9\u6848\uff0c\u540c\u65f6\u5177\u5907\u52a8\u6001\u9002\u5e94\u8f93\u5165\u53d8\u5316\u7684\u80fd\u529b\u3002</li> <li>\u5728\u7279\u5b9a\u573a\u666f\uff08\u5982 Verilator\uff09\u4e0b\uff0c\u751a\u81f3\u8d85\u8d8a\u79bb\u7ebf\u6700\u4f18\u65b9\u6848\uff0c\u5c55\u793a\u51fa\u72ec\u7279\u4f18\u52bf\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#table-i-benchmark-characterization-data","title":"TABLE I: Benchmark characterization data","text":"<ul> <li>\u8be5\u8868\u683c\uff08TABLE I\uff09\u63d0\u4f9b\u4e86\u56db\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff08MySQL\u3001Mongo\u3001Mem$\u3001Verilator\uff09\u5728OCOLOS\u4f18\u5316\u8fc7\u7a0b\u4e2d\u7684\u5173\u952e\u7279\u5f81\u6570\u636e\uff0c\u7528\u4e8e\u91cf\u5316\u5176\u89c4\u6a21\u548c\u4f18\u5316\u64cd\u4f5c\u7684\u8303\u56f4\u3002</li> <li>\u8868\u683c\u5185\u5bb9\u5206\u4e3a\u4e24\u5927\u90e8\u5206\uff1a\u4ee3\u7801\u7ed3\u6784\u4e0e\u4f18\u5316\u64cd\u4f5c\u7edf\u8ba1\uff0c\u4ee5\u53ca\u5185\u5b58\u6d88\u8017\uff08max RSS\uff09\u3002</li> </ul> <p>\u4ee3\u7801\u7ed3\u6784\u4e0e\u4f18\u5316\u64cd\u4f5c\u7edf\u8ba1</p> \u6307\u6807 MySQL Mongo Mem$ Verilator functions 33,170 69,807 374 406 v-tables 3,812 6,165 0 10 .text section (MiB) 24.6 50.0 0.142 2.3 avg funcs reordered 963.6 2,364.2 74.2 83.2 avg funcs on stack 79 100.6 10 5 avg call sites changed 31,677.2 30,9297.8 496.6 251.2 <ul> <li>\u51fd\u6570\u603b\u6570\uff08functions\uff09\u663e\u793a\u4e86\u7a0b\u5e8f\u7684\u590d\u6742\u5ea6\uff0cMongoDB\u62e5\u6709\u8fd17\u4e07\u51fd\u6570\uff0c\u8fdc\u8d85\u5176\u4ed6\u7a0b\u5e8f\u3002</li> <li>\u865a\u8868\u6570\u91cf\uff08v-tables\uff09\u53cd\u6620\u4e86\u9762\u5411\u5bf9\u8c61\u8bbe\u8ba1\u7684\u7a0b\u5ea6\uff0cMySQL\u548cMongoDB\u6709\u6570\u5343\u4e2a\uff0c\u800cMemcached\u6ca1\u6709\uff0cVerilator\u4ec5\u670910\u4e2a\u3002</li> <li>.text\u6bb5\u5927\u5c0f\uff08.text section\uff09\u4ee3\u8868\u539f\u59cb\u4e8c\u8fdb\u5236\u4ee3\u7801\u4f53\u79ef\uff0cMongoDB\u6700\u5927\uff0850 MiB\uff09\uff0cMemcached\u6700\u5c0f\uff080.142 MiB\uff09\u3002</li> <li>\u5e73\u5747\u91cd\u6392\u51fd\u6570\u6570\uff08avg funcs reordered\uff09\u8868\u660eBOLT\u4f18\u5316\u6d89\u53ca\u7684\u51fd\u6570\u89c4\u6a21\uff0cMongoDB\u6700\u591a\uff08\u8d85\u8fc72300\u4e2a\uff09\uff0c\u8fd9\u4e0e\u5176\u5e9e\u5927\u7684\u51fd\u6570\u603b\u6570\u76f8\u7b26\u3002</li> <li>\u5e73\u5747\u6808\u4e0a\u51fd\u6570\u6570\uff08avg funcs on stack\uff09\u6307\u4ee3\u7801\u66ff\u6362\u65f6\uff0c\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u51fd\u6570\u6570\u91cf\uff0c\u7528\u4e8e\u6307\u5bfc\u54ea\u4e9b\u51fd\u6570\u9700\u8981\u88ab\u590d\u5236\u4ee5\u7ef4\u6301\u6b63\u786e\u6027\u3002MongoDB\u5728\u6b64\u9879\u4e5f\u6700\u9ad8\uff08100.6\uff09\u3002</li> <li>\u5e73\u5747\u4fee\u6539\u8c03\u7528\u70b9\u6570\uff08avg call sites changed\uff09\u662fOCOLOS\u5728\u8fd0\u884c\u65f6\u9700\u8981\u4fee\u8865\u7684\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\u6570\u91cf\uff0cMySQL\u9ad8\u8fbe3.1\u4e07\u4e2a\uff0c\u8bf4\u660e\u5176\u63a7\u5236\u6d41\u590d\u6742\uff0c\u9700\u8981\u5927\u91cf\u6307\u9488\u66f4\u65b0\u3002</li> </ul> <p>\u5185\u5b58\u6d88\u8017\uff08max RSS\uff09</p> \u914d\u7f6e MySQL Mongo Mem$ Verilator original 397.4 1434.4 67.8 263.4 BOLT 398.0 1432.8 67.9 263.7 OCOLOS 438.5 1640.5 69.8 265.4 <ul> <li>\u6700\u5927\u9a7b\u7559\u96c6\u5927\u5c0f\uff08max RSS\uff09\u8861\u91cf\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5360\u7528\u7684\u7269\u7406\u5185\u5b58\u5cf0\u503c\u3002</li> <li>\u5bf9\u6bd4\u53ef\u89c1\uff0cOCOLOS\u76f8\u6bd4\u539f\u59cb\u7248\u672c\u548c\u79bb\u7ebfBOLT\u7248\u672c\uff0c\u5747\u5f15\u5165\u4e86\u989d\u5916\u7684\u5185\u5b58\u5f00\u9500\u3002</li> <li>\u5185\u5b58\u5f00\u9500\u4e3b\u8981\u6765\u81ea\u5728\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u4e2d\u6ce8\u5165\u65b0\u7684\u4f18\u5316\u4ee3\u7801\uff08C1\uff09\uff0c\u800c\u975e\u8986\u76d6\u539f\u4ee3\u7801\uff08C0\uff09\u3002</li> <li>\u5f00\u9500\u5e45\u5ea6\u56e0\u7a0b\u5e8f\u800c\u5f02\uff1aMongoDB\u589e\u52a0\u6700\u663e\u8457\uff08+206.1 MiB\uff09\uff0c\u800cVerilator\u4ec5\u589e\u52a02.0 MiB\u3002</li> <li>\u4f5c\u8005\u5728\u6587\u4e2d\u6307\u51fa\uff0c\u6b64\u5185\u5b58\u6d88\u8017\u662f\u77ac\u65f6\u7684\uff0c\u4ec5\u5728\u4ee3\u7801\u66ff\u6362\u671f\u95f4\u5b58\u5728\uff0c\u5b8c\u6210\u540e\u53ef\u91ca\u653e\uff0c\u4e0d\u5c5e\u4e8e\u6301\u7eed\u6027\u5f00\u9500\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-6-the-impact-of-profile-duration-on-speedup-for-mysql-read-only","title":"Fig. 6: The impact of profile duration on speedup for MySQL read only","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 OCOLOS \u4e0e BOLT \u5728\u4e0d\u540c profile duration\uff08\u914d\u7f6e\u6587\u4ef6\u6301\u7eed\u65f6\u95f4\uff09 \u4e0b\u5bf9 MySQL read only \u5de5\u4f5c\u8d1f\u8f7d\u7684\u6027\u80fd\u52a0\u901f\u6548\u679c\uff0c\u7eb5\u8f74\u4e3a\u76f8\u5bf9\u4e8e\u539f\u59cb\u4e8c\u8fdb\u5236\u7684 speedup over original\uff0c\u6a2a\u8f74\u4e3a\u4ee5\u79d2\u4e3a\u5355\u4f4d\u7684\u5bf9\u6570\u523b\u5ea6\u3002</li> <li>OCOLOS\uff08\u7eff\u8272\u865a\u7ebf\u65b9\u5757\uff09\u548c BOLT\uff08\u84dd\u8272\u5b9e\u7ebf\u4e09\u89d2\uff09\u5728\u6781\u77ed\u91c7\u6837\u65f6\u95f4\uff08\u5982 10\u207b\u2075 \u79d2\uff09\u4e0b\u5747\u63a5\u8fd1\u65e0\u52a0\u901f\uff08speedup \u2248 1.0\uff09\uff0c\u8868\u660e\u6b64\u65f6\u91c7\u96c6\u7684\u6027\u80fd\u6570\u636e\u4e0d\u8db3\u4ee5\u9a71\u52a8\u6709\u6548\u4f18\u5316\u3002</li> <li>\u5f53 profile duration \u8fbe\u5230 10\u207b\u00b2 \u79d2\uff080.01\u79d2\uff09 \u65f6\uff0c\u4e24\u8005\u5f00\u59cb\u51fa\u73b0\u660e\u663e\u52a0\u901f\uff0cOCOLOS \u7ea6\u8fbe 1.1x\uff0cBOLT \u7ea6\u8fbe 1.15x\uff0c\u663e\u793a\u5373\u4f7f\u77ed\u6682\u91c7\u6837\u4e5f\u80fd\u5e26\u6765\u53ef\u89c2\u6536\u76ca\u3002</li> <li>\u5728 10\u207b\u00b9 \u79d2\uff080.1\u79d2\uff09 \u65f6\uff0cOCOLOS \u52a0\u901f\u81f3\u7ea6 1.3x\uff0c\u800c BOLT \u8fbe\u5230 1.4x\uff0c\u8bf4\u660e\u66f4\u957f\u7684\u91c7\u6837\u65f6\u95f4\u80fd\u63d0\u5347\u4f18\u5316\u8d28\u91cf\uff0c\u4f46\u8fb9\u9645\u6536\u76ca\u9012\u51cf\u3002</li> <li>\u8d85\u8fc7 1\u79d2 \u540e\uff0c\u4e24\u8005\u589e\u901f\u653e\u7f13\uff0cOCOLOS \u5728 100 \u79d2\u65f6\u7a33\u5b9a\u5728\u7ea6 1.4x\uff0cBOLT \u5219\u7565\u9ad8\uff0c\u7a33\u5b9a\u5728 1.42x \u5de6\u53f3\uff0c\u8868\u660e\u91c7\u6837\u65f6\u95f4\u8d85\u8fc7 1 \u79d2\u540e\u4f18\u5316\u6536\u76ca\u8d8b\u4e8e\u9971\u548c\u3002</li> <li>BOLT \u59cb\u7ec8\u4f18\u4e8e OCOLOS\uff0c\u56e0\u5176\u4e3a\u79bb\u7ebf\u4f18\u5316\uff0c\u53ef\u5b8c\u6574\u5e94\u7528\u6240\u6709\u4ee3\u7801\u6307\u9488\u91cd\u5b9a\u5411\uff0c\u800c OCOLOS \u4ec5\u66f4\u65b0\u90e8\u5206\u6307\u9488\u4ee5\u907f\u514d\u8fd0\u884c\u65f6\u5f00\u9500\uff0c\u5bfc\u81f4\u5176\u6027\u80fd\u7565\u900a\u4e8e\u7406\u8bba\u4e0a\u9650\u3002</li> <li>\u8be5\u56fe\u9a8c\u8bc1\u4e86 OCOLOS \u7684\u5b9e\u7528\u6027\uff1a\u5373\u4f7f\u4ec5\u9700 1\u79d2 \u91c7\u6837\uff0c\u5373\u53ef\u83b7\u5f97\u63a5\u8fd1\u79bb\u7ebf\u4f18\u5316\u7684\u5927\u90e8\u5206\u6027\u80fd\u589e\u76ca\uff0c\u6ee1\u8db3\u5728\u7ebf\u52a8\u6001\u4f18\u5316\u7684\u9700\u6c42\u3002</li> </ul> Profile Duration (s) OCOLOS Speedup BOLT Speedup 10\u207b\u2075 ~1.0 ~1.1 10\u207b\u00b3 ~1.05 ~1.1 10\u207b\u00b2 ~1.1 ~1.15 10\u207b\u00b9 ~1.3 ~1.4 1 ~1.35 ~1.4 10 ~1.4 ~1.42 100 ~1.4 ~1.42 <ul> <li>\u5173\u952e\u7ed3\u8bba\uff1aOCOLOS \u53ef\u5728\u6781\u77ed\u65f6\u95f4\u5185\uff08\u5982 1 \u79d2\uff09\u5b8c\u6210\u6709\u6548\u6027\u80fd\u4f18\u5316\uff0c\u65e0\u9700\u957f\u65f6\u95f4\u91c7\u6837\uff0c\u9002\u5408\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u5728\u7ebf\u52a8\u6001\u8c03\u6574\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-7-throughput-of-mysql-read-only-before-during-and-after-code-replacement-95-tail-latency-degrades-from-100ms-to-at-most-155ms-during-code-replacement","title":"Fig. 7: Throughput of MySQL read only before, during, and after code replacement. 95% tail latency degrades from 1.00ms to at most 1.55ms during code replacement.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 MySQL \u5728\u53ea\u8bfb\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\uff0cOCOLOS \u6267\u884c\u4ee3\u7801\u66ff\u6362\u524d\u3001\u4e2d\u3001\u540e\u7684\u541e\u5410\u91cf\u53d8\u5316\uff0c\u5355\u4f4d\u4e3a\u6bcf\u79d2\u4e8b\u52a1\u6570\uff08transactions/second\uff09\u3002</li> <li>\u6a2a\u8f74\u4e3a\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u7eb5\u8f74\u4e3a\u541e\u5410\u91cf\u3002\u6574\u4e2a\u8fc7\u7a0b\u88ab\u5212\u5206\u4e3a\u4e94\u4e2a\u9636\u6bb5\uff0c\u7531\u6570\u5b57 1 \u81f3 5 \u6807\u6ce8\u3002</li> <li>\u9636\u6bb5 1 (0\u201320 \u79d2)\uff1a\u7cfb\u7edf\u5904\u4e8e\u9884\u70ed\u671f\uff0c\u8fd0\u884c\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u541e\u5410\u91cf\u7a33\u5b9a\u5728\u7ea6 4,200 tps\u3002</li> <li>\u9636\u6bb5 2 (20\u2013100 \u79d2)\uff1a\u542f\u52a8 Linux <code>perf</code> \u5de5\u5177\u6536\u96c6 LBR \u6027\u80fd\u6570\u636e\uff0c\u541e\u5410\u91cf\u8f7b\u5fae\u4e0b\u964d\u81f3\u7ea6 3,600 tps\uff0c\u56e0\u91c7\u6837\u5f15\u5165\u5c11\u91cf\u5f00\u9500\u3002</li> <li>\u9636\u6bb5 3 (100\u2013120 \u79d2)\uff1a\u540e\u53f0\u6267\u884c <code>perf2bolt</code> \u548c BOLT \u4f18\u5316\u6d41\u7a0b\uff0c\u751f\u6210\u65b0\u4e8c\u8fdb\u5236\u3002\u6b64\u9636\u6bb5 CPU \u8d44\u6e90\u7ade\u4e89\u52a0\u5267\uff0c\u541e\u5410\u91cf\u8fdb\u4e00\u6b65\u6ce2\u52a8\u5e76\u77ed\u6682\u8dcc\u81f3 3,000 tps \u4ee5\u4e0b\u3002</li> <li>\u9636\u6bb5 4 (\u7ea6 120 \u79d2)\uff1aOCOLOS \u6267\u884c\u201c\u505c\u673a\u4e16\u754c\u201d\uff08stop-the-world\uff09\u4ee3\u7801\u66ff\u6362\uff0c\u6301\u7eed 669 \u6beb\u79d2\u3002\u5728\u6b64\u671f\u95f4\uff0c\u541e\u5410\u91cf\u9aa4\u964d\u81f3\u96f6\uff0c\u670d\u52a1\u6682\u505c\u3002</li> <li>\u9636\u6bb5 5 (120 \u79d2\u540e)\uff1a\u4ee3\u7801\u66ff\u6362\u5b8c\u6210\uff0cMySQL \u4f7f\u7528\u4f18\u5316\u540e\u4ee3\u7801\u6062\u590d\u5e76\u884c\u6267\u884c\uff0c\u541e\u5410\u91cf\u8dc3\u5347\u81f3\u8fd1 6,000 tps\uff0c\u6027\u80fd\u63d0\u5347\u663e\u8457\u3002</li> <li>\u5c3e\u5ef6\u8fdf\u65b9\u9762\uff0c95% \u5206\u4f4d\u7684\u4e8b\u52a1\u5ef6\u8fdf\u5728\u9636\u6bb5 1 \u5e73\u5747\u4e3a 1.00 ms\uff0c\u5728\u9636\u6bb5 3\u20134 \u6700\u9ad8\u6076\u5316\u81f3 1.55 ms\uff0c\u9636\u6bb5 5 \u56de\u843d\u81f3 0.73 ms\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5404\u9636\u6bb5\u5173\u952e\u6027\u80fd\u6307\u6807\uff1a</li> </ul> \u9636\u6bb5 \u65f6\u95f4\u8303\u56f4 (\u79d2) \u541e\u5410\u91cf (tps) \u4e3b\u8981\u6d3b\u52a8 \u5ef6\u8fdf (95%) 1 0\u201320 ~4,200 \u9884\u70ed 1.00 ms 2 20\u2013100 ~3,600 LBR \u91c7\u6837 \u7565\u589e 3 100\u2013120 3,000\u20134,000 BOLT \u4f18\u5316 1.55 ms (\u5cf0\u503c) 4 ~120 0 \u4ee3\u7801\u66ff\u6362 \u65e0\u54cd\u5e94 5 &gt;120 ~5,850 \u4f18\u5316\u8fd0\u884c 0.73 ms <ul> <li>\u6574\u4f53\u6765\u770b\uff0c\u5c3d\u7ba1\u4ee3\u7801\u66ff\u6362\u5e26\u6765\u77ed\u6682\u4e2d\u65ad\u548c\u6027\u80fd\u6ce2\u52a8\uff0c\u4f46OCOLOS \u5728\u5b8c\u6210\u540e\u5b9e\u73b0\u4e86\u7ea6 1.41\u00d7 \u7684\u541e\u5410\u91cf\u63d0\u5347\uff0c\u4e14\u5c3e\u5ef6\u8fdf\u4f18\u4e8e\u539f\u59cb\u7248\u672c\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#table-ii-fixed-costs-of-code-replacement","title":"TABLE II: Fixed costs of code replacement","text":"<ul> <li>\u56fe\u7247\u5185\u5bb9\uff1a\u8be5\u56fe\u662f\u8bba\u6587\u4e2d\u7684 Table II\uff0c\u6807\u9898\u4e3a \u201cFixed costs of code replacement\u201d\uff0c\u5c55\u793a\u4e86 OCOLOS \u7cfb\u7edf\u5728\u4e0d\u540c\u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\u4e0a\u6267\u884c\u4ee3\u7801\u66ff\u6362\u65f6\u7684\u56fa\u5b9a\u5f00\u9500\u65f6\u95f4\uff08\u5355\u4f4d\uff1a\u79d2\uff09\u3002</li> <li>\u6570\u636e\u7ed3\u6784\uff1a\u8868\u683c\u5305\u542b\u4e09\u884c\u56db\u5217\uff0c\u5206\u522b\u5bf9\u5e94\u4e09\u4e2a\u9636\u6bb5\u7684\u65f6\u95f4\u6d88\u8017\u548c\u56db\u4e2a\u4e0d\u540c\u7684\u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff08MySQL\u3001Mongo\u3001Mem$\u3001Verilator\uff09\u3002</li> <li>\u5173\u952e\u6570\u636e\uff1a</li> <li>perf2bolt time (sec)\uff1a\u5c06 Linux <code>perf</code> \u5de5\u5177\u6536\u96c6\u7684 LBR \u6837\u672c\u8f6c\u6362\u4e3a BOLT \u53ef\u7528\u683c\u5f0f\u6240\u9700\u7684\u65f6\u95f4\u3002MySQL \u6700\u957f\uff0828.186 \u79d2\uff09\uff0cVerilator \u6700\u77ed\uff084.181 \u79d2\uff09\u3002</li> <li>llvm-bolt time (sec)\uff1aBOLT \u5de5\u5177\u5b9e\u9645\u6267\u884c\u4f18\u5316\u5e76\u751f\u6210\u65b0\u4e8c\u8fdb\u5236\u6587\u4ef6\u6240\u9700\u7684\u65f6\u95f4\u3002Mongo \u6700\u957f\uff0817.882 \u79d2\uff09\uff0cMem$ \u6700\u77ed\uff080.1404 \u79d2\uff09\u3002</li> <li>replacement time (sec)\uff1aOCOLOS \u5728\u8fd0\u884c\u65f6\u6682\u505c\u76ee\u6807\u8fdb\u7a0b\u3001\u6ce8\u5165\u65b0\u4ee3\u7801\u5e76\u66f4\u65b0\u6307\u9488\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u3002Mem$ \u6700\u77ed\uff080.020 \u79d2\uff09\uff0cMongo \u6700\u957f\uff081.221 \u79d2\uff09\u3002</li> </ul> \u9636\u6bb5 MySQL Mongo Mem$ Verilator perf2bolt time (sec) 28.186 26.624 12.918 4.181 llvm-bolt time (sec) 8.237 17.882 0.1404 1.935 replacement time (sec) 0.669 1.221 0.020 0.146 <ul> <li>\u6027\u80fd\u5206\u6790\uff1a</li> <li>\u6574\u4f53\u8017\u65f6\uff1a\u5bf9\u4e8e MySQL \u548c Mongo \u8fd9\u7c7b\u5927\u578b\u670d\u52a1\u7aef\u5e94\u7528\uff0c\u6574\u4e2a\u4f18\u5316\u6d41\u7a0b\u8017\u65f6\u8f83\u957f\uff08\u7ea6 30\u201345 \u79d2\uff09\uff0c\u4e3b\u8981\u74f6\u9888\u5728\u4e8e <code>perf2bolt</code> \u548c <code>llvm-bolt</code> \u9636\u6bb5\u3002</li> <li>\u66ff\u6362\u6548\u7387\uff1areplacement time \u76f8\u5bf9\u8f83\u77ed\uff0c\u5373\u4f7f\u5728\u590d\u6742\u591a\u7ebf\u7a0b\u5e94\u7528\u5982 MongoDB \u4e2d\u4e5f\u4ec5\u9700 1.221 \u79d2\uff0c\u4f53\u73b0\u4e86 OCOLOS \u5728\u8fd0\u884c\u65f6\u4ee3\u7801\u66ff\u6362\u673a\u5236\u4e0a\u7684\u9ad8\u6548\u6027\u3002</li> <li>\u8f7b\u91cf\u7ea7\u5e94\u7528\u4f18\u52bf\uff1a\u5bf9\u4e8e Memcached \u548c Verilator \u8fd9\u7c7b\u76f8\u5bf9\u8f7b\u91cf\u6216\u5355\u7ebf\u7a0b\u7684\u5e94\u7528\uff0c\u6574\u4e2a\u6d41\u7a0b\u8017\u65f6\u663e\u8457\u964d\u4f4e\uff0c\u5c24\u5176 Mem$ \u7684 <code>llvm-bolt time</code> \u4ec5\u4e3a 0.1404 \u79d2\uff0c\u8bf4\u660e OCOLOS \u5bf9\u5c0f\u578b\u7a0b\u5e8f\u540c\u6837\u9002\u7528\u4e14\u5f00\u9500\u6781\u4f4e\u3002</li> <li>\u8bbe\u8ba1\u542f\u793a\uff1a</li> <li>\u53ef\u6269\u5c55\u6027\uff1a\u5c3d\u7ba1 <code>llvm-bolt time</code> \u5728\u5927\u578b\u7a0b\u5e8f\u4e2d\u8f83\u9ad8\uff0c\u4f46\u8be5\u9636\u6bb5\u53ef\u5728\u540e\u53f0\u5e76\u53d1\u6267\u884c\uff0c\u4e0d\u5f71\u54cd\u4e3b\u7a0b\u5e8f\u8fd0\u884c\uff0c\u7b26\u5408 OCOLOS \u201cfixed-costs only\u201d \u7684\u8bbe\u8ba1\u7406\u5ff5\u3002</li> <li>\u6682\u505c\u5f71\u54cd\u53ef\u63a7\uff1areplacement time \u662f\u552f\u4e00\u9700\u8981\u6682\u505c\u7a0b\u5e8f\u7684\u9636\u6bb5\uff0c\u5176\u77ed\u6682\u6027\uff08\u6700\u957f\u4e0d\u8db3 1.3 \u79d2\uff09\u786e\u4fdd\u4e86\u5bf9\u670d\u52a1\u53ef\u7528\u6027\u7684\u51b2\u51fb\u6700\u5c0f\u5316\uff0c\u5c24\u5176\u9002\u5408\u5728\u7ebf\u7cfb\u7edf\u90e8\u7f72\u3002</li> <li>\u9002\u7528\u573a\u666f\uff1a\u5bf9\u4e8e\u9891\u7e41\u91cd\u542f\u6216\u77ed\u751f\u547d\u5468\u671f\u7684\u7a0b\u5e8f\uff0c\u53ef\u7ed3\u5408 BAM \u6a21\u5f0f\u89c4\u907f\u8fd0\u884c\u65f6\u6682\u505c\u6210\u672c\uff1b\u5bf9\u4e8e\u957f\u671f\u8fd0\u884c\u7684\u670d\u52a1\uff0cOCOLOS \u80fd\u901a\u8fc7\u5468\u671f\u6027\u4f18\u5316\u6301\u7eed\u63d0\u5347\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-8-microarchitectural-events-per-1000-instructions-for-mysql-inputs","title":"Fig. 8: Microarchitectural events (per 1,000 instructions) for MySQL inputs","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 MySQL \u5728\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\uff0c\u56db\u79cd\u914d\u7f6e\uff08original, OCOLOS, BOLT_oracle, BOLT_average-case\uff09\u7684\u5fae\u67b6\u6784\u4e8b\u4ef6\u6307\u6807\uff0c\u5355\u4f4d\u4e3a\u6bcf\u5343\u6761\u6307\u4ee4\u7684\u4e8b\u4ef6\u6570\u3002</li> <li>L1i misses\uff1aOCOLOS \u548c BOLT_oracle \u5747\u663e\u8457\u964d\u4f4e L1i \u7f13\u5b58\u672a\u547d\u4e2d\u6b21\u6570\uff0c\u964d\u5e45\u666e\u904d\u5728 30%-60% \u4e4b\u95f4\u3002BOLT_average-case \u8868\u73b0\u6b21\u4e4b\uff0c\u800c original \u914d\u7f6e\u672a\u547d\u4e2d\u7387\u6700\u9ad8\u3002\u4f8b\u5982\uff0c\u5728 <code>read only</code> \u8f93\u5165\u4e0b\uff0coriginal \u7ea6 58 \u6b21/\u5343\u6307\u4ee4\uff0cOCOLOS \u964d\u81f3\u7ea6 25 \u6b21\u3002</li> <li>iTLB misses\uff1aOCOLOS \u548c BOLT_oracle \u540c\u6837\u5927\u5e45\u51cf\u5c11 iTLB \u672a\u547d\u4e2d\uff0c\u591a\u6570\u573a\u666f\u4e0b\u964d\u5e45\u5ea6\u8d85\u8fc7 50%\u3002BOLT_average-case \u6548\u679c\u6709\u9650\uff0c\u90e8\u5206\u8f93\u5165\u751a\u81f3\u63a5\u8fd1 original\u3002\u5982 <code>update index</code> \u4e0b\uff0coriginal \u4e3a 10.5\uff0cOCOLOS \u964d\u81f3 3.5\u3002</li> <li>taken branches\uff1a\u6240\u6709\u4f18\u5316\u914d\u7f6e\u5747\u6709\u6548\u51cf\u5c11 taken branches \u6570\u91cf\uff0cOCOLOS \u548c BOLT_oracle \u51e0\u4e4e\u6301\u5e73\uff0c\u8868\u660e\u5176\u57fa\u672c\u5757\u91cd\u6392\u6548\u679c\u63a5\u8fd1\u79bb\u7ebf\u6700\u4f18\u3002\u4f8b\u5982 <code>delete</code> \u8f93\u5165\u4e2d\uff0coriginal \u4e3a 120\uff0c\u4f18\u5316\u540e\u964d\u81f3 90 \u5de6\u53f3\u3002</li> <li>branch mispredictions\uff1a\u4f18\u5316\u5bf9\u5206\u652f\u9884\u6d4b\u9519\u8bef\u5f71\u54cd\u8f83\u5c0f\uff0c\u5404\u914d\u7f6e\u95f4\u5dee\u5f02\u4e0d\u5927\uff0c\u8bf4\u660e\u4e3b\u8981\u6027\u80fd\u63d0\u5347\u6765\u81ea\u7f13\u5b58\u548c\u5206\u652f\u9891\u7387\u4f18\u5316\uff0c\u800c\u975e\u9884\u6d4b\u7cbe\u5ea6\u6539\u8fdb\u3002\u4f8b\u5982 <code>insert</code> \u8f93\u5165\u4e0b\uff0c\u6240\u6709\u914d\u7f6e\u5747\u5728 15-20 \u4e4b\u95f4\u6ce2\u52a8\u3002</li> <li>\u6570\u636e\u6c47\u603b\u5982\u4e0b\u8868\uff1a</li> </ul> Input Metric original OCOLOS BOLT_oracle BOLT_average-case point select L1i misses ~60 ~40 ~45 ~50 iTLB misses ~2.5 ~1.0 ~1.0 ~2.0 taken branches ~110 ~80 ~85 ~95 branch mispreds ~2 ~1 ~1 ~2 read only L1i misses ~58 ~25 ~25 ~40 iTLB misses ~7.5 ~2.5 ~2.5 ~5.0 taken branches ~100 ~70 ~70 ~85 branch mispreds ~3 ~2 ~2 ~3 rand ranges L1i misses ~10 ~5 ~5 ~8 iTLB misses ~0.5 ~0.2 ~0.2 ~0.5 taken branches ~80 ~60 ~60 ~70 branch mispreds ~1 ~0.5 ~0.5 ~1 update nonindex L1i misses ~50 ~25 ~25 ~40 iTLB misses ~10.0 ~3.5 ~3.5 ~7.5 taken branches ~110 ~80 ~80 ~95 branch mispreds ~20 ~15 ~15 ~18 <ul> <li>\u603b\u4f53\u6765\u770b\uff0cOCOLOS \u7684\u5fae\u67b6\u6784\u8868\u73b0\u4e0e BOLT_oracle \u9ad8\u5ea6\u4e00\u81f4\uff0c\u8bc1\u660e\u5176\u5728\u7ebf\u4f18\u5316\u80fd\u903c\u8fd1\u79bb\u7ebf\u6700\u4f18\u5e03\u5c40\u3002BOLT_average-case \u56e0\u6df7\u5408\u591a\u8f93\u5165\u5bfc\u81f4\u4f18\u5316\u51b2\u7a81\uff0c\u6027\u80fd\u635f\u5931\u660e\u663e\u3002\u539f\u59cb\u914d\u7f6e\u5728\u6240\u6709\u6307\u6807\u4e0a\u5747\u6700\u5dee\uff0c\u51f8\u663e PGO \u7684\u5fc5\u8981\u6027\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-9-topdowns-109-front-end-latency-and-retire-percentages-allow-us-to-accurately-classify-which-workloads-will-benefit-from-ocolos-and-which-wont","title":"Fig. 9: TopDown\u2019s [109] Front-end Latency and Retire percentages allow us to accurately classify which workloads will benefit from OCOLOS and which won\u2019t.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u4f7f\u7528 Intel TopDown \u65b9\u6cd5\u5206\u6790\u7684\u4e24\u4e2a\u5173\u952e\u5fae\u67b6\u6784\u6307\u6807\uff1aFront-End Latency %\uff08\u6a2a\u8f74\uff09\u548c Retire %\uff08\u7eb5\u8f74\uff09\uff0c\u7528\u4e8e\u9884\u6d4b OCOLOS \u662f\u5426\u80fd\u5e26\u6765\u6027\u80fd\u589e\u76ca\u3002</li> <li>\u6570\u636e\u70b9\u5206\u4e3a\u4e24\u7c7b\uff1a\u7ea2\u8272\u201c\u00d7\u201d\u8868\u793a\u65e0\u6027\u80fd\u589e\u76ca\uff0c\u84dd\u8272\u201c\u25cb\u201d\u8868\u793a\u6709\u6027\u80fd\u589e\u76ca\u3002\u4e24\u8005\u88ab\u4e00\u6761\u659c\u7ebf\u6e05\u6670\u5206\u9694\uff0c\u5f62\u6210\u5206\u7c7b\u8fb9\u754c\u3002</li> <li>\u5206\u7c7b\u8fb9\u754c\u5927\u81f4\u4ece\u5de6\u4e0a\u89d2\uff08\u4f4e Front-End Latency\u3001\u9ad8 Retire\uff09\u5ef6\u4f38\u81f3\u53f3\u4e0b\u89d2\uff08\u9ad8 Front-End Latency\u3001\u4f4e Retire\uff09\u3002\u8be5\u533a\u57df\u5212\u5206\u8868\u660e\uff1a</li> <li>\u5f53\u5de5\u4f5c\u8d1f\u8f7d\u7684 Front-End Latency \u8f83\u9ad8\uff08&gt; ~50%\uff09\u4e14 Retire \u8f83\u4f4e\uff08&lt; ~15%\uff09\u65f6\uff0cOCOLOS \u5f88\u53ef\u80fd\u5e26\u6765\u663e\u8457\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u53cd\u4e4b\uff0c\u5f53 Front-End Latency \u8f83\u4f4e\u6216 Retire \u8f83\u9ad8\u65f6\uff0cOCOLOS \u5e26\u6765\u7684\u6536\u76ca\u6709\u9650\u751a\u81f3\u4e3a\u8d1f\u3002</li> <li>\u8be5\u56fe\u9a8c\u8bc1\u4e86 OCOLOS \u7684\u4f18\u5316\u76ee\u6807\u2014\u2014\u7f13\u89e3\u524d\u7aef\u74f6\u9888\u3002\u53ea\u6709\u5f53\u524d\u7aef\u5ef6\u8fdf\u6210\u4e3a\u4e3b\u8981\u6027\u80fd\u74f6\u9888\u65f6\uff0c\u901a\u8fc7\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u51cf\u5c11\u6307\u4ee4\u7f13\u5b58\u7f3a\u5931\u548c\u5206\u652f\u9884\u6d4b\u538b\u529b\uff0c\u624d\u80fd\u6709\u6548\u63d0\u5347 IPC\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e86\u56fe\u8868\u4e2d\u5173\u952e\u533a\u57df\u7684\u542b\u4e49\uff1a</li> </ul> \u533a\u57df Front-End Latency % Retire % OCOLOS \u6548\u679c \u84dd\u8272\u533a\u57df\uff08\u53f3\u4e0a\uff09 \u9ad8\uff08&gt;50%\uff09 \u4f4e\uff08&lt;15%\uff09 \u6709\u6027\u80fd\u589e\u76ca \u7c89\u8272\u533a\u57df\uff08\u5de6\u4e0b\uff09 \u4f4e\uff08&lt;50%\uff09 \u9ad8\uff08&gt;15%\uff09 \u65e0\u6027\u80fd\u589e\u76ca <ul> <li>\u6b64\u5206\u7c7b\u6a21\u578b\u53ef\u4f5c\u4e3a OCOLOS \u7684\u90e8\u7f72\u51b3\u7b56\u4f9d\u636e\uff1a\u4ec5\u5728\u68c0\u6d4b\u5230\u9ad8 Front-End Latency \u65f6\u624d\u542f\u52a8\u5728\u7ebf\u4f18\u5316\uff0c\u907f\u514d\u5bf9\u975e\u524d\u7aef\u53d7\u9650\u7684\u5de5\u4f5c\u8d1f\u8f7d\u9020\u6210\u4e0d\u5fc5\u8981\u7684\u5f00\u9500\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/figs_notes/#fig-10-the-running-time-of-a-clang-build-with-the-original-compiler-and-compilers-optimized-by-bolt-and-bam","title":"Fig. 10: The running time of a Clang build with the original compiler, and compilers optimized by BOLT and BAM.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u5728\u4e0d\u540c\u4f18\u5316\u7b56\u7565\u4e0b\uff0c\u4ece\u96f6\u5f00\u59cb\u6784\u5efa Clang \u7f16\u8bd1\u5668\u6240\u9700\u7684\u771f\u5b9e\u8fd0\u884c\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u6a2a\u8f74\u4e3a\u201c\u5df2\u5206\u6790\u7684\u6267\u884c\u6b21\u6570\u201d\uff0c\u7eb5\u8f74\u4e3a\u201c\u8fd0\u884c\u65f6\u95f4\u201d\u3002</li> <li>\u539f\u59cb\u7f16\u8bd1\u5668\uff08original\uff09\uff1a\u4ee5\u7ea2\u8272\u865a\u7ebf\u8868\u793a\uff0c\u5176\u8fd0\u884c\u65f6\u95f4\u7a33\u5b9a\u5728\u7ea6 940 \u79d2\uff0c\u4f5c\u4e3a\u6027\u80fd\u57fa\u7ebf\u3002</li> <li>BAM \u6a21\u5f0f\uff08\u84dd\u8272\u65b9\u5757\uff09\uff1a\u4ee3\u8868 OCOLOS \u7684\u6279\u5904\u7406\u52a0\u901f\u6a21\u5f0f\u3002\u5176\u8fd0\u884c\u65f6\u95f4\u968f\u5206\u6790\u6b21\u6570\u589e\u52a0\u800c\u4e0b\u964d\uff0c\u5728\u5206\u6790\u7ea6 5 \u6b21\u540e\u8fbe\u5230\u6700\u4f4e\u70b9\uff08\u7ea6 850 \u79d2\uff09\uff0c\u968f\u540e\u7565\u6709\u56de\u5347\u3002\u8fd9\u8868\u660e BAM \u5728\u65e9\u671f\u6536\u96c6\u5c11\u91cf\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\u83b7\u5f97\u663e\u8457\u6536\u76ca\uff0c\u4f46\u8fc7\u591a\u5206\u6790\u4f1a\u56e0\u5ef6\u8fdf\u4f18\u5316\u542f\u52a8\u800c\u5f97\u4e0d\u507f\u5931\u3002</li> <li>BOLT profile prefix\uff08\u7eff\u8272\u4e09\u89d2\u5f62\uff09\uff1a\u4ee3\u8868\u4f7f\u7528 BOLT \u4f18\u5316\uff0c\u4f46\u4ec5\u57fa\u4e8e\u524d N \u6b21\u6267\u884c\u7684\u914d\u7f6e\u6587\u4ef6\u751f\u6210\u4f18\u5316\u4e8c\u8fdb\u5236\u3002\u5176\u8868\u73b0\u4f18\u4e8e\u539f\u59cb\u7248\u672c\uff0c\u6700\u4f4e\u70b9\u7ea6\u4e3a 710 \u79d2\uff0c\u8bf4\u660e\u5373\u4f7f\u53ea\u7528\u90e8\u5206\u6570\u636e\u4e5f\u80fd\u6709\u6548\u4f18\u5316\u3002</li> <li>BOLT profile all\uff08\u6a59\u8272\u865a\u7ebf\uff09\uff1a\u4ee3\u8868\u4f7f\u7528\u5b8c\u6574\u6784\u5efa\u8fc7\u7a0b\u7684\u6240\u6709\u6267\u884c\u6570\u636e\u751f\u6210\u4f18\u5316\u4e8c\u8fdb\u5236\u3002\u5176\u8fd0\u884c\u65f6\u95f4\u7a33\u5b9a\u5728\u7ea6 690 \u79d2\uff0c\u662f\u6240\u6709\u65b9\u6848\u4e2d\u6700\u5feb\u7684\uff0c\u4f5c\u4e3a\u7406\u8bba\u6700\u4f18\u503c\u3002</li> <li>\u6570\u636e\u5bf9\u6bd4\u663e\u793a\uff0cBAM \u5728\u4ec5\u5206\u6790 1 \u6b21\u65f6\u5373\u5b9e\u73b0 1.09\u00d7 \u52a0\u901f\uff0c\u5728\u6700\u4f73\u70b9\uff08\u7ea6 5 \u6b21\uff09\u8fbe\u5230 1.14\u00d7 \u52a0\u901f\uff0c\u63a5\u8fd1 BOLT profile all \u7684\u6027\u80fd\uff0c\u9a8c\u8bc1\u4e86\u5176\u5728\u5b9e\u9645\u90e8\u7f72\u4e2d\u7684\u9ad8\u6548\u6027\u3002</li> <li>\u6027\u80fd\u8d8b\u52bf\u63ed\u793a\u4e86\u4e00\u4e2a\u5173\u952e\u6743\u8861\uff1a\u5206\u6790\u5f00\u9500 vs. \u4f18\u5316\u6536\u76ca\u3002BAM \u5728\u521d\u671f\u5feb\u901f\u83b7\u76ca\uff0c\u4f46\u540e\u671f\u56e0\u7b49\u5f85\u66f4\u591a\u5206\u6790\u6570\u636e\u5bfc\u81f4\u6574\u4f53\u6784\u5efa\u65f6\u95f4\u4e0a\u5347\uff0c\u4f53\u73b0\u4e86\u201c\u8fb9\u9645\u6548\u76ca\u9012\u51cf\u201d\u3002</li> </ul> \u4f18\u5316\u7b56\u7565 \u6700\u4f4e\u8fd0\u884c\u65f6\u95f4 (\u79d2) \u76f8\u5bf9\u539f\u59cb\u52a0\u901f\u6bd4 \u5173\u952e\u7279\u70b9 original ~940 1.00\u00d7 \u57fa\u7ebf\uff0c\u65e0\u4f18\u5316 BAM ~850 1.14\u00d7 \u5b9e\u65f6\u5206\u6790\uff0c\u81ea\u52a8\u5207\u6362\uff0c\u6709\u5ef6\u8fdf BOLT profile prefix ~710 ~1.32\u00d7 \u7406\u8bba\u6700\u4f18\uff0c\u9700\u9884\u77e5\u5168\u90e8\u8f93\u5165 BOLT profile all ~690 ~1.36\u00d7 \u7406\u60f3\u60c5\u51b5\uff0c\u975e\u5b9e\u65f6 <ul> <li>\u7ed3\u8bba\uff1a\u8be5\u56fe\u6709\u529b\u8bc1\u660e\u4e86 BAM \u80fd\u5728\u65e0\u9700\u4fee\u6539\u6e90\u7801\u6216\u6784\u5efa\u811a\u672c\u7684\u524d\u63d0\u4e0b\uff0c\u901a\u8fc7\u5728\u7ebf\u3001\u589e\u91cf\u5f0f\u5206\u6790\uff0c\u4e3a\u5927\u578b\u8f6f\u4ef6\u6784\u5efa\u63d0\u4f9b\u663e\u8457\u52a0\u901f\uff0c\u4e14\u5176\u6027\u80fd\u63a5\u8fd1\u79bb\u7ebf\u5168\u91cf\u5206\u6790\u7684\u6700\u4f18\u7ed3\u679c\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/","title":"OCOLOS: Online COde Layout OptimizationS \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Yuxuan Zhang (University of Pennsylvania) - Tanvir Ahmed Khan (University of Michigan) - Gilles Pokam (Intel Corporation) - Baris Kasikci (University of Michigan) - Heiner Litz (University of California, Santa Cruz) - Joseph Devietti (University of Pennsylvania)</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - \u8be5\u8bba\u6587\u672a\u5728\u63d0\u4f9b\u7684\u6587\u672c\u4e2d\u660e\u786e\u6307\u51fa\u5176\u53d1\u8868\u7684\u671f\u520a\u6216\u4f1a\u8bae\u540d\u79f0\u3002</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - \u8be5\u8bba\u6587\u672a\u5728\u63d0\u4f9b\u7684\u6587\u672c\u4e2d\u660e\u786e\u6307\u51fa\u5176\u53d1\u8868\u5e74\u4efd\u3002</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u4f20\u7edf Profile-Guided Optimization (PGO) \u5728 unmanaged languages\uff08\u5982 C/C++\uff09\u4e2d\u9762\u4e34\u7684\u4e09\u5927\u6838\u5fc3\u6311\u6218\uff1a   - Profile \u6ede\u540e\u6027\uff1a\u79bb\u7ebf\u6536\u96c6\u7684 profile \u6570\u636e\u53ef\u80fd\u4e0e\u5f53\u524d\u7a0b\u5e8f\u7684\u5b9e\u9645\u8f93\u5165\u6216\u884c\u4e3a\u4e0d\u5339\u914d\uff0c\u5bfc\u81f4\u4f18\u5316\u6548\u679c\u4e0d\u4f73\u751a\u81f3\u6709\u5bb3\u3002   - \u4ee3\u7801\u53d8\u66f4\u6620\u5c04\u56f0\u96be\uff1a\u5e94\u7528\u7a0b\u5e8f\u9891\u7e41\u66f4\u65b0\u540e\uff0c\u65e7\u7248\u672c\u7684 profile \u6570\u636e\u96be\u4ee5\u51c6\u786e\u6620\u5c04\u5230\u65b0\u7248\u672c\u7684\u4ee3\u7801\u4e0a\uff0c\u9020\u6210\u4f18\u5316\u673a\u4f1a\u4e22\u5931\u3002   - \u8fd0\u7ef4\u8d1f\u62c5\uff1a\u7ba1\u7406\u548c\u90e8\u7f72 profile \u6570\u636e\u589e\u52a0\u4e86\u7cfb\u7edf\u590d\u6742\u6027\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa OCOLOS\uff0c\u9996\u4e2a\u9762\u5411 unmanaged code \u7684 online PGO \u7cfb\u7edf\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u52a8\u6001\u8fdb\u884c\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u3002 - \u6838\u5fc3\u8bbe\u8ba1\u539f\u5219\uff1a   - \u4fdd\u7559\u539f\u59cb\u4ee3\u7801\u5730\u5740 (preserve addresses of C0 instructions)\uff1a\u901a\u8fc7\u5c06\u4f18\u5316\u540e\u7684\u65b0\u4ee3\u7801 C1 \u6ce8\u5165\u5230\u65b0\u7684\u5185\u5b58\u5730\u5740\uff0c\u540c\u65f6\u4fdd\u7559\u539f\u59cb\u4ee3\u7801 C0\uff0c\u907f\u514d\u56e0\u4ee3\u7801\u79fb\u52a8\u800c\u7834\u574f\u65e0\u6cd5\u8ffd\u8e2a\u7684\u4ee3\u7801\u6307\u9488\uff08\u5982\u6808\u4e0a\u7684\u8fd4\u56de\u5730\u5740\u3001<code>setjmp/longjmp</code> \u4fdd\u5b58\u7684\u5730\u5740\u7b49\uff09\u3002   - \u5728\u5e38\u89c1\u8def\u5f84\u4e0a\u8fd0\u884c\u4f18\u5316\u4ee3\u7801 (run C1 code in the common case)\uff1a\u901a\u8fc7\u66f4\u65b0\u53ef\u8ffd\u8e2a\u7684\u4ee3\u7801\u6307\u9488\uff08\u5982 v-table \u4e2d\u7684\u51fd\u6570\u6307\u9488\u3001\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\uff09\uff0c\u5c06\u6267\u884c\u6d41\u5f15\u5bfc\u81f3\u6027\u80fd\u66f4\u4f18\u7684 C1 \u4ee3\u7801\u3002   - \u56fa\u5b9a\u6210\u672c\u6a21\u578b (fixed-costs only)\uff1a\u786e\u4fdd\u4f18\u5316\u8fc7\u7a0b\u53ea\u4ea7\u751f\u4e00\u6b21\u6027\u7684\u5f00\u9500\uff0c\u907f\u514d\u6301\u7eed\u7684\u8fd0\u884c\u65f6\u6027\u80fd\u635f\u8017\u3002 - \u5173\u952e\u6280\u672f\u5b9e\u73b0\uff1a   - \u5229\u7528 BOLT \u4f5c\u4e3a\u540e\u7aef\u4f18\u5316\u5f15\u64ce\uff0c\u5bf9\u8fd0\u884c\u4e2d\u7684\u7a0b\u5e8f\u8fdb\u884c hardware performance profiling\uff08\u901a\u8fc7 Linux <code>perf</code> \u548c Intel LBR\uff09\u3002   - \u4f7f\u7528 ptrace API \u6682\u505c\u76ee\u6807\u8fdb\u7a0b\uff0c\u5e76\u901a\u8fc7 LD_PRELOAD \u6ce8\u5165\u7684\u5e93\u9ad8\u6548\u5730\u5c06 BOLT \u751f\u6210\u7684\u4f18\u5316\u4ee3\u7801 C1 \u590d\u5236\u5230\u76ee\u6807\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u3002   - \u4e3a\u652f\u6301 continuous optimization\uff0c\u5f15\u5165\u4e86\u9488\u5bf9 return addresses \u548c function pointers \u7684\u7279\u6b8a\u5904\u7406\u673a\u5236\uff0c\u5e76\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684 LLVM compiler pass \u5728\u51fd\u6570\u6307\u9488\u521b\u5efa\u65f6\u8fdb\u884c\u62e6\u622a\u548c\u91cd\u5b9a\u5411\uff0c\u786e\u4fdd\u6240\u6709\u52a8\u6001\u521b\u5efa\u7684\u51fd\u6570\u6307\u9488\u90fd\u6307\u5411\u539f\u59cb\u4ee3\u7801 C0\u3002   - \u9488\u5bf9\u77ed\u65f6\u4efb\u52a1\uff08\u5982\u8f6f\u4ef6\u6784\u5efa\uff09\uff0c\u8bbe\u8ba1\u4e86 BATCH ACCELERATOR MODE (BAM) \u6a21\u5f0f\uff0c\u901a\u8fc7\u900f\u660e\u5730\u66ff\u6362\u540e\u7eed <code>exec</code> \u8c03\u7528\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u5e94\u7528\u4f18\u5316\uff0c\u5b8c\u5168\u89c4\u907f\u4e86\u8fd0\u884c\u65f6\u6682\u505c\u7684\u5f00\u9500\u3002</p> <p>\u7ed3\u679c - \u6027\u80fd\u63d0\u5347\u663e\u8457\uff1a\u5728\u591a\u4e2a\u771f\u5b9e\u4e16\u754c\u7684\u5927\u89c4\u6a21\u5e94\u7528\u4e0a\u9a8c\u8bc1\u4e86 OCOLOS \u7684\u6709\u6548\u6027\u3002   - MySQL \u6027\u80fd\u6700\u9ad8\u63d0\u5347 1.41\u00d7\u3002   - Verilator \u786c\u4ef6\u6a21\u62df\u5668\u6027\u80fd\u6700\u9ad8\u63d0\u5347 2.20\u00d7\u3002   - Clang \u7f16\u8bd1\u5668\u6784\u5efa\u4efb\u52a1\u901a\u8fc7 BAM \u6a21\u5f0f\u52a0\u901f 1.14\u00d7\u3002 - \u4e0e\u79bb\u7ebf PGO \u5bf9\u6bd4\uff1aOCOLOS \u7684\u6027\u80fd\u975e\u5e38\u63a5\u8fd1\u4f7f\u7528\u201c\u795e\u8c15\u201d\uff08oracle\uff09profile \u7684\u79bb\u7ebf BOLT\uff08\u5e73\u5747\u4ec5\u6162 4.6%\uff09\uff0c\u4f46\u8fdc\u4f18\u4e8e\u4f7f\u7528\u805a\u5408\u5e73\u5747 profile \u7684\u79bb\u7ebf BOLT\uff08\u5e73\u5747\u5feb 8.9%\uff09\u3002 - \u5f00\u9500\u53ef\u63a7\uff1a   - \u5185\u5b58\u5f00\u9500\uff1a\u9002\u5ea6\uff0c\u4f8b\u5982 MongoDB \u4ec5\u589e\u52a0\u7ea6 208 MiB\u3002   - \u6682\u505c\u65f6\u95f4\uff1a\u4ee3\u7801\u66ff\u6362\u9636\u6bb5\u9700\u8981\u77ed\u6682\u7684\u201cstop-the-world\u201d\u6682\u505c\uff0c\u4f8b\u5982 MySQL \u4e3a 669 \u6beb\u79d2\u3002   - \u6062\u590d\u65f6\u95f4\uff1a\u4ee5 MySQL \u4e3a\u4f8b\uff0c\u5728\u5b8c\u6210\u4f18\u5316\u540e\u7ea6 30 \u79d2 \u5373\u53ef\u5f25\u8865\u4f18\u5316\u8fc7\u7a0b\u4e2d\u7684\u6027\u80fd\u635f\u5931\uff0c\u6b64\u540e\u5747\u4e3a\u51c0\u6536\u76ca\u3002 - \u5fae\u67b6\u6784\u5c42\u9762\u5f71\u54cd\uff1aOCOLOS \u6210\u529f\u51cf\u5c11\u4e86 L1i misses\u3001iTLB misses \u548c taken branches \u7684\u6570\u91cf\uff0c\u6709\u6548\u7f13\u89e3\u4e86\u5904\u7406\u5668\u524d\u7aef\u74f6\u9888\u3002</p> <p></p> <p>Fig. 8: Microarchitectural events (per 1,000 instructions) for MySQL inputs</p> <ul> <li>\u9002\u7528\u6027\u5206\u6790\uff1a\u901a\u8fc7 Intel TopDown \u65b9\u6cd5\u5b66\u53d1\u73b0\uff0cFront-End Latency \u9ad8\u800c Retiring \u4f4e\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6700\u80fd\u4ece OCOLOS \u4e2d\u53d7\u76ca\u3002</li> </ul> <p></p> <p>Fig. 9: TopDown\u2019s [109] Front-end Latency and Retire percentages allow us to accurately classify which workloads will benefit from OCOLOS and which won\u2019t.</p> <p>\u7ed3\u8bba - OCOLOS \u6210\u529f\u5730\u5c06 online PGO \u7684\u4f18\u52bf\u5e26\u7ed9\u4e86 unmanaged languages\uff0c\u514b\u670d\u4e86\u4f20\u7edf\u79bb\u7ebf PGO \u7684 profile \u6ede\u540e\u548c\u6620\u5c04\u96be\u9898\u3002 - \u901a\u8fc7\u521b\u65b0\u7684 \u4ee3\u7801\u5171\u5b58 \u548c \u6307\u9488\u91cd\u5b9a\u5411 \u7b56\u7565\uff0cOCOLOS \u80fd\u591f\u5728\u65e0\u9700\u4fee\u6539\u5e94\u7528\u6e90\u7801\u7684\u524d\u63d0\u4e0b\uff0c\u5b89\u5168\u3001\u9ad8\u6548\u5730\u5bf9\u590d\u6742\u7684\u591a\u7ebf\u7a0b\u5e94\u7528\uff08\u5982 MySQL, MongoDB\uff09\u8fdb\u884c\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u3002 - \u5176 \u56fa\u5b9a\u6210\u672c\u6a21\u578b \u548c\u9488\u5bf9\u6279\u5904\u7406\u573a\u666f\u7684 BAM \u6a21\u5f0f\uff0c\u4f7f\u5176\u5728\u6570\u636e\u4e2d\u5fc3\u7b49\u73af\u5883\u4e2d\u5177\u6709\u5f88\u9ad8\u7684\u5b9e\u7528\u4ef7\u503c\u548c\u90e8\u7f72\u6f5c\u529b\u3002</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f\u4e0e\u52a8\u673a</p> <ul> <li>\u73b0\u4ee3\u6570\u636e\u4e2d\u5fc3\u5e94\u7528\u7684\u4ee3\u7801\u8db3\u8ff9\uff08code footprint\uff09\u6301\u7eed\u589e\u957f\uff08\u5982 Google \u62a5\u544a\u5e74\u589e 30%\uff09\uff0c\u800c\u5904\u7406\u5668\u524d\u7aef\uff08front-end\uff09\u786c\u4ef6\u8d44\u6e90\uff08\u5982 L1 \u6307\u4ee4\u7f13\u5b58 L1i\uff09\u5728\u8fc7\u53bb 15 \u5e74\u4e2d\u5bb9\u91cf\u57fa\u672c\u4fdd\u6301\u4e0d\u53d8\uff0c\u5bfc\u81f4\u4e25\u91cd\u7684\u524d\u7aef\u74f6\u9888\uff08front-end stalls\uff09\uff0c\u964d\u4f4e\u4e86 IPC\uff08Instructions Per Cycle\uff09\u3002</li> <li>Profile-Guided Optimizations (PGO) \u662f\u4e00\u79cd\u6709\u6548\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5b83\u901a\u8fc7\u91cd\u6392\u4ee3\u7801\u6765\u4f18\u5316\u6307\u4ee4\u7f13\u5b58\u5c40\u90e8\u6027\u548c\u5206\u652f\u9884\u6d4b\u6548\u7387\u3002\u7136\u800c\uff0c\u73b0\u6709\u7684 PGO \u7cfb\u7edf\uff08\u5982 BOLT, AutoFDO\uff09\u90fd\u662f\u79bb\u7ebf\uff08offline\uff09\u7684\uff0c\u9762\u4e34\u4e09\u5927\u6838\u5fc3\u6311\u6218\uff1a<ul> <li>\u914d\u7f6e\u6587\u4ef6\u8fc7\u65f6\uff08Stale Profiles\uff09\uff1a\u79bb\u7ebf PGO \u7684\u914d\u7f6e\u6587\u4ef6\u6536\u96c6\u4e0e\u5e94\u7528\u4e4b\u95f4\u5b58\u5728\u65f6\u95f4\u5dee\uff0c\u82e5\u7a0b\u5e8f\u8f93\u5165\u6216\u884c\u4e3a\u53d1\u751f\u53d8\u5316\uff0c\u65e7\u7684\u914d\u7f6e\u6587\u4ef6\u4f1a\u53d8\u5f97\u4e0d\u76f8\u5173\u751a\u81f3\u6709\u5bb3\u3002</li> <li>\u4ee3\u7801\u53d8\u66f4\u6620\u5c04\u56f0\u96be\uff08Mapping Across Code Changes\uff09\uff1a\u5f53\u5e94\u7528\u7a0b\u5e8f\u9891\u7e41\u66f4\u65b0\u65f6\uff0c\u4e3a\u65e7\u7248\u672c\u6536\u96c6\u7684\u914d\u7f6e\u6587\u4ef6\u96be\u4ee5\u51c6\u786e\u6620\u5c04\u5230\u65b0\u7248\u672c\u7684\u673a\u5668\u7801\u4e0a\uff0c\u5bfc\u81f4\u5927\u91cf\u4f18\u5316\u673a\u4f1a\u88ab\u6d6a\u8d39\u3002</li> <li>\u8fd0\u7ef4\u8d1f\u62c5\uff08Operational Burden\uff09\uff1a\u7ba1\u7406\u548c\u90e8\u7f72\u914d\u7f6e\u6587\u4ef6\u589e\u52a0\u4e86\u7cfb\u7edf\u590d\u6742\u6027\uff0c\u5c24\u5176\u5728\u79fb\u52a8\u7aef\u7b49\u573a\u666f\u4e0b\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 1: AMD &amp; Intel per-core L1i capacity over time</p> <ul> <li>\u867d\u7136\u6258\u7ba1\u8bed\u8a00\uff08managed languages\uff09\u8fd0\u884c\u65f6\uff08\u5982 JVM\uff09\u652f\u6301\u5728\u7ebf PGO\uff0c\u4f46\u9488\u5bf9 C/C++ \u7b49\u975e\u6258\u7ba1\u8bed\u8a00\uff08unmanaged languages\uff09\u7684\u5728\u7ebf PGO \u7cfb\u7edf\u5c1a\u5c5e\u7a7a\u767d\u3002</li> </ul> <p>\u6838\u5fc3\u8d21\u732e</p> <ul> <li>\u63d0\u51fa\u4e86 OCOLOS (Online COde Layout OptimizationS)\uff0c\u8fd9\u662f\u9996\u4e2a\u9762\u5411\u975e\u6258\u7ba1\u8bed\u8a00\u7684\u5728\u7ebf\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u7cfb\u7edf\u3002OCOLOS \u80fd\u591f\u5728\u4e0d\u4fee\u6539\u5e94\u7528\u7a0b\u5e8f\u6e90\u7801\u7684\u524d\u63d0\u4e0b\uff0c\u5bf9\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u8fdb\u884c\u52a8\u6001\u4ee3\u7801\u4f18\u5316\u3002</li> <li>\u8bbe\u8ba1\u5e76\u5b9e\u73b0\u4e86\u9ad8\u6548\u3001\u5b89\u5168\u7684\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u673a\u5236\uff0c\u89e3\u51b3\u4e86\u5728\u590d\u6742\u591a\u7ebf\u7a0b\u5e94\u7528\uff08\u5982 MySQL, MongoDB\uff09\u4e2d\u52a8\u6001\u4fee\u6539\u4ee3\u7801\u6240\u5e26\u6765\u7684\u4ee3\u7801\u6307\u9488\uff08code pointers\uff09\u96be\u9898\u3002\u5176\u6838\u5fc3\u8bbe\u8ba1\u539f\u5219\u5305\u62ec\uff1a<ul> <li>\u4fdd\u7559\u539f\u59cb\u4ee3\u7801\u5730\u5740\uff08preserve addresses of C0 instructions\uff09\uff1a\u901a\u8fc7\u6ce8\u5165\u65b0\u4ee3\u7801\uff08C1\uff09\u800c\u975e\u539f\u5730\u4fee\u6539\uff0c\u5e76\u5c06\u6267\u884c\u6d41\u91cd\u5b9a\u5411\u5230\u65b0\u4ee3\u7801\uff0c\u786e\u4fdd\u6b63\u786e\u6027\u3002</li> <li>\u5728\u5e38\u89c1\u60c5\u51b5\u4e0b\u8fd0\u884c\u4f18\u5316\u4ee3\u7801\uff08run C1 code in the common case\uff09\uff1a\u901a\u8fc7\u66f4\u65b0 v-table \u548c\u76f4\u63a5\u8c03\u7528\u70b9\u7b49\u5173\u952e\u6307\u9488\uff0c\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\u3002</li> <li>\u4ec5\u4ea7\u751f\u4e00\u6b21\u6027\u5f00\u9500\uff08fixed costs only\uff09\uff1a\u907f\u514d\u5f15\u5165\u6301\u7eed\u6027\u7684\u8fd0\u884c\u65f6\u5f00\u9500\u3002</li> </ul> </li> <li>\u63d0\u51fa\u4e86 BATCH ACCELERATOR MODE (BAM)\uff0c\u4e00\u79cd\u9488\u5bf9\u77ed\u751f\u547d\u5468\u671f\u8fdb\u7a0b\u6279\u5904\u7406\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982\u8f6f\u4ef6\u6784\u5efa\uff09\u7684\u53d8\u4f53\u3002BAM \u901a\u8fc7\u900f\u660e\u5730\u62e6\u622a <code>exec</code> \u8c03\u7528\uff0c\u5728\u540e\u53f0\u751f\u6210\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e76\u5728\u540e\u7eed\u8fdb\u7a0b\u4e2d\u81ea\u52a8\u4f7f\u7528\uff0c\u4ece\u800c\u52a0\u901f\u6574\u4e2a\u6279\u5904\u7406\u4efb\u52a1\u3002</li> <li>\u901a\u8fc7\u5b9e\u9a8c\u9a8c\u8bc1\u4e86 OCOLOS \u7684\u6709\u6548\u6027\uff0c\u5728\u591a\u4e2a\u771f\u5b9e\u4e16\u754c\u7684\u5927\u89c4\u6a21\u5e94\u7528\u4e0a\u53d6\u5f97\u4e86\u663e\u8457\u6027\u80fd\u63d0\u5347\uff1a<ul> <li>MySQL \u52a0\u901f\u6700\u9ad8\u8fbe 1.41\u00d7</li> <li>Verilator \u786c\u4ef6\u6a21\u62df\u5668\u52a0\u901f\u6700\u9ad8\u8fbe 2.20\u00d7</li> <li>Clang \u7f16\u8bd1\u5668\u6784\u5efa\uff08\u901a\u8fc7 BAM\uff09\u52a0\u901f\u6700\u9ad8\u8fbe 1.14\u00d7</li> </ul> </li> </ul> <p></p> <p>Fig. 3: Performance achieved when running MySQL with the Sysbench read only input, using BOLT to produce a binary from the given profiling input or, with the all bar, from profiles of all inputs combined.</p> <p></p> <p>Fig. 5: Performance of OCOLOS (light blue bars) compared to BOLT using an oracle profile of the input being run (dark blue bars), Clang PGO using the same oracle profile (purple bars) and BOLT using an average-case profiling input aggregated from all inputs (pink bars). All bars are normalized to original non-PGO binaries (white bars).</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>OCOLOS \u7684\u6838\u5fc3\u76ee\u6807\u662f\u4e3a unmanaged languages\uff08\u5982 C/C++\uff09\u5b9e\u73b0 online Profile-Guided Optimization (PGO)\uff0c\u901a\u8fc7\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u4f18\u5316\u4ee3\u7801\u5e03\u5c40\u6765\u89e3\u51b3\u5904\u7406\u5668 front-end bottleneck \u95ee\u9898\u3002\u5176\u67b6\u6784\u5de7\u5999\u5730\u7ed3\u5408\u4e86\u6210\u719f\u7684\u79bb\u7ebf\u5de5\u5177\u4e0e\u521b\u65b0\u7684\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u673a\u5236\u3002</p> <ul> <li> <p>\u57fa\u7840\u4f9d\u8d56\uff1a</p> <ul> <li>BOLT (Binary Optimization and Layout Tool)\uff1a\u4f5c\u4e3a\u540e\u7aef\u4f18\u5316\u5f15\u64ce\uff0c\u8d1f\u8d23\u6839\u636e\u6027\u80fd\u5256\u6790\u6570\u636e\u5bf9\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c basic block reordering \u548c function reordering \u7b49\u5e03\u5c40\u4f18\u5316\u3002</li> <li>Linux perf\uff1a\u5229\u7528\u786c\u4ef6\u6027\u80fd\u8ba1\u6570\u5668\uff08\u7279\u522b\u662f Intel LBR\uff09\u5728\u8fd0\u884c\u65f6\u6536\u96c6\u4f4e\u5f00\u9500\u7684\u63a7\u5236\u6d41\u5256\u6790\u6570\u636e\u3002</li> </ul> </li> <li> <p>\u6838\u5fc3\u5de5\u4f5c\u6d41\u7a0b\uff1a</p> <ul> <li>\u540e\u53f0\u5256\u6790\u4e0e\u4f18\u5316\uff1a\u7cfb\u7edf\u9996\u5148\u5bf9\u76ee\u6807\u8fdb\u7a0b\u8fdb\u884c\u5256\u6790\u3002\u82e5\u68c0\u6d4b\u5230\u663e\u8457\u7684 front-end stalls\uff0c\u5219\u542f\u52a8\u7b2c\u4e8c\u9636\u6bb5\u5256\u6790\u4ee5\u6536\u96c6\u8be6\u7ec6\u7684 LBR \u6837\u672c\u3002\u8fd9\u4e9b\u6837\u672c\u88ab\u9001\u5165 BOLT \u4ee5\u751f\u6210\u4e00\u4e2a\u5168\u65b0\u7684\u3001\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u6b64\u8fc7\u7a0b\u5728\u540e\u53f0\u5e76\u53d1\u6267\u884c\uff0c\u4e0d\u5f71\u54cd\u4e3b\u7a0b\u5e8f\u8fd0\u884c\u3002</li> <li>\u5728\u7ebf\u4ee3\u7801\u6ce8\u5165\u4e0e\u66ff\u6362\uff1a\u4e00\u65e6\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u51c6\u5907\u5c31\u7eea\uff0cOCOLOS \u4f1a\u6682\u505c\u76ee\u6807\u8fdb\u7a0b\uff08stop-the-world \u9636\u6bb5\uff09\uff0c\u5c06\u65b0\u4ee3\u7801\uff08\u79f0\u4e3a C1\uff09\u6ce8\u5165\u5230\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\uff0c\u540c\u65f6\u4fdd\u7559\u539f\u59cb\u4ee3\u7801\uff08C0\uff09\u4e0d\u53d8\u3002</li> <li>\u6307\u9488\u91cd\u5b9a\u5411\uff1aOCOLOS \u66f4\u65b0\u5173\u952e\u7684 code pointers\uff08\u5982 v-table \u4e2d\u7684\u51fd\u6570\u6307\u9488\u548c C0 \u4e2d\u7684\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\uff09\uff0c\u5c06\u6267\u884c\u6d41\u5f15\u5bfc\u81f3\u6027\u80fd\u66f4\u9ad8\u7684 C1 \u4ee3\u7801\u3002\u5b83\u9075\u5faa\u201crun C1 code in the common case\u201d\u7684\u8bbe\u8ba1\u539f\u5219\uff0c\u786e\u4fdd\u7edd\u5927\u591a\u6570\u6267\u884c\u8def\u5f84\u90fd\u80fd\u53d7\u76ca\u4e8e\u4f18\u5316\u3002</li> <li>\u6062\u590d\u6267\u884c\uff1a\u5b8c\u6210\u4ee3\u7801\u6ce8\u5165\u548c\u6307\u9488\u66f4\u65b0\u540e\uff0c\u76ee\u6807\u8fdb\u7a0b\u88ab\u6062\u590d\uff0c\u4ee5\u4f18\u5316\u540e\u7684\u4ee3\u7801\u7ee7\u7eed\u8fd0\u884c\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 4a: Main steps OCOLOS takes to optimize a target process</p> <ul> <li> <p>\u5173\u952e\u6280\u672f\u8bbe\u8ba1\u539f\u5219\uff1a</p> <ul> <li>Preserve addresses of C0 instructions\uff1a\u901a\u8fc7\u4fdd\u7559\u539f\u59cb\u4ee3\u7801 C0\uff0c\u907f\u514d\u4e86\u56e0\u4ee3\u7801\u79fb\u52a8\u800c\u5bfc\u81f4\u7684\u65e0\u6cd5\u8ffd\u8e2a\u7684\u6307\u9488\u5931\u6548\u95ee\u9898\uff0c\u6781\u5927\u5730\u7b80\u5316\u4e86\u5728\u7ebf\u66ff\u6362\u7684\u590d\u6742\u6027\uff0c\u5e76\u80fd\u6b63\u786e\u5904\u7406 setjmp/longjmp \u7b49\u68d8\u624b\u573a\u666f\u3002</li> <li>Fixed-costs only\uff1a\u7cfb\u7edf\u53ea\u5728\u4ee3\u7801\u66ff\u6362\u65f6\u4ea7\u751f\u4e00\u6b21\u6027\u7684\u5f00\u9500\uff08\u5982\u6682\u505c\u8fdb\u7a0b\u3001\u5185\u5b58\u62f7\u8d1d\uff09\uff0c\u4e4b\u540e\u7a0b\u5e8f\u4ee5\u539f\u751f\u6027\u80fd\u8fd0\u884c\uff0c\u907f\u514d\u4e86\u4f20\u7edf Dynamic Binary Instrumentation (DBI) \u6846\u67b6\uff08\u5982 Pin, Valgrind\uff09\u5e26\u6765\u7684\u6301\u7eed\u6027\u6027\u80fd\u635f\u8017\u3002</li> <li>Function pointer handling\uff1a\u901a\u8fc7\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 LLVM compiler pass\uff0c\u5728\u7f16\u8bd1\u65f6\u63d2\u5165\u4e00\u4e2a <code>wrapFuncPtrCreation</code> \u56de\u8c03\u51fd\u6570\uff0c\u5f3a\u5236\u6240\u6709\u65b0\u521b\u5efa\u7684\u51fd\u6570\u6307\u9488\u90fd\u6307\u5411 C0 \u4e2d\u7684\u539f\u59cb\u5730\u5740\u3002\u8fd9\u4fdd\u8bc1\u4e86\u5373\u4f7f\u5728\u4ee3\u7801\u66ff\u6362\u540e\uff0c\u901a\u8fc7\u51fd\u6570\u6307\u9488\u7684\u8c03\u7528\u4e5f\u80fd\u5b89\u5168\u5730\u8fdb\u5165 C0\uff0c\u5e76\u5f88\u5feb\u901a\u8fc7\u5df2\u66f4\u65b0\u7684\u76f4\u63a5\u8c03\u7528\u8df3\u8f6c\u5230 C1\u3002</li> </ul> </li> <li> <p>\u6269\u5c55\u6a21\u5f0f\uff1aBATCH ACCELERATOR MODE (BAM)\uff1a</p> <ul> <li>\u9488\u5bf9 short-running programs\uff08\u5982\u7f16\u8bd1\u5668\uff09\uff0cOCOLOS \u7684\u4e00\u6b21\u6027\u5f00\u9500\u96be\u4ee5\u88ab\u644a\u9500\u3002\u4e3a\u6b64\uff0cOCOLOS \u63d0\u4f9b\u4e86 BAM \u6a21\u5f0f\u3002</li> <li>BAM \u901a\u8fc7 LD_PRELOAD \u900f\u660e\u5730\u62e6\u622a\u5bf9\u76ee\u6807\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684 exec* \u8c03\u7528\u3002</li> <li>\u5b83\u5bf9\u524d\u51e0\u6b21\u6267\u884c\u8fdb\u884c\u5256\u6790\uff0c\u7136\u540e\u5728\u540e\u53f0\u4f7f\u7528 BOLT \u751f\u6210\u4f18\u5316\u7248\u672c\u3002</li> <li>\u540e\u7eed\u7684\u6240\u6709 exec* \u8c03\u7528\u90fd\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u8fd9\u4e2a\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4ece\u800c\u52a0\u901f\u6574\u4e2a\u6279\u5904\u7406\u4efb\u52a1\uff08\u5982\u8f6f\u4ef6\u6784\u5efa\uff09\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 10: The running time of a Clang build with the original compiler, and compilers optimized by BOLT and BAM.</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#1-online-code-layout-optimization","title":"1. \u5728\u7ebf\u4ee3\u7801\u5e03\u5c40\u4f18\u5316 (Online Code Layout Optimization)","text":"<p>\u6838\u5fc3\u89c2\u70b9</p> <p>OCOLOS \u7684\u6838\u5fc3\u5728\u4e8e\u5c06\u4f20\u7edf\u7684\u79bb\u7ebf Profile-Guided Optimization (PGO) \u8fc1\u79fb\u5230\u8fd0\u884c\u65f6\uff0c\u901a\u8fc7\u52a8\u6001\u66ff\u6362\u6b63\u5728\u6267\u884c\u8fdb\u7a0b\u7684\u4ee3\u7801\u6765\u5b9e\u73b0\u6301\u7eed\u4f18\u5316\u3002\u5176\u5173\u952e\u6311\u6218\u662f\u5982\u4f55\u5728\u4e0d\u7834\u574f\u7a0b\u5e8f\u6b63\u786e\u6027\u7684\u524d\u63d0\u4e0b\uff0c\u5b89\u5168\u5730\u66f4\u65b0\u904d\u5e03\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u5404\u7c7b code pointers\u3002</p> <ul> <li>OCOLOS \u5e76\u975e\u4ece\u96f6\u5f00\u59cb\u6784\u5efa\u4f18\u5316\u5668\uff0c\u800c\u662f\u5de7\u5999\u5730\u590d\u7528\u5e76\u6269\u5c55\u4e86\u6210\u719f\u7684\u79bb\u7ebf PGO \u5de5\u5177 BOLT\u3002</li> <li>\u5176\u5de5\u4f5c\u6d41\u7a0b\u5206\u4e3a\u4e24\u5927\u9636\u6bb5\uff1a\u540e\u53f0\u5f02\u6b65\u51c6\u5907\uff08\u5256\u6790\u4e0e\u4f18\u5316\uff09\u548c \u524d\u53f0\u540c\u6b65\u66ff\u6362\uff08\u4ee3\u7801\u6ce8\u5165\u4e0e\u6307\u9488\u66f4\u65b0\uff09\u3002</li> <li>\u4e3a\u89e3\u51b3\u8fd0\u884c\u65f6\u4ee3\u7801\u66ff\u6362\u7684\u96be\u9898\uff0cOCOLOS \u63d0\u51fa\u4e86\u4e09\u9879\u6838\u5fc3\u8bbe\u8ba1\u539f\u5219\uff1a<ul> <li>Design Principle #1: preserve addresses of C0 instructions\uff1a\u4fdd\u7559\u539f\u59cb\u4ee3\u7801 <code>C0</code> \u7684\u5730\u5740\u4e0d\u53d8\uff0c\u5c06\u4f18\u5316\u540e\u7684\u65b0\u4ee3\u7801 <code>C1</code> \u6ce8\u5165\u5230\u65b0\u7684\u5185\u5b58\u533a\u57df\u3002</li> <li>Design Principle #2: run C1 code in the common case\uff1a\u5c3d\u53ef\u80fd\u5c06\u6267\u884c\u6d41\u5f15\u5bfc\u81f3\u6027\u80fd\u66f4\u4f18\u7684 <code>C1</code> \u4ee3\u7801\uff0c\u4ec5\u5728\u5fc5\u8981\u65f6\u56de\u9000\u5230 <code>C0</code> \u4ee5\u4fdd\u8bc1\u6b63\u786e\u6027\u3002</li> <li>Design Principle #3: code replacement can incur fixed costs, but must avoid all possible recurring costs\uff1a\u4ee3\u7801\u66ff\u6362\u53ef\u4ee5\u6709\u4e00\u6b21\u6027\u5f00\u9500\uff0c\u4f46\u5fc5\u987b\u907f\u514d\u4efb\u4f55\u6301\u7eed\u6027\u7684\u6027\u80fd\u635f\u8017\u3002</li> </ul> </li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5b9e\u73b0\u7ec6\u8282</p> <p>OCOLOS \u7684\u5b8c\u6574\u5728\u7ebf\u4f18\u5316\u6d41\u7a0b\u5982\u56fe\u6240\u793a\uff0c\u5305\u542b\u516d\u4e2a\u4e3b\u8981\u6b65\u9aa4\u3002</p> <p></p> <p>Figure 4a: Main steps OCOLOS takes to optimize a target process</p> <ul> <li> <p>\u6b65\u9aa4 1 &amp; 2: \u540e\u53f0\u5256\u6790\u4e0e BOLT \u4f18\u5316 (\u5f02\u6b65):</p> <ul> <li>\u8f93\u5165: \u6b63\u5728\u8fd0\u884c\u7684\u76ee\u6807\u8fdb\u7a0b\u3002</li> <li>\u5256\u6790: \u4f7f\u7528 Linux <code>perf</code> \u5de5\u5177\uff0c\u9996\u5148\u901a\u8fc7 TopDown \u65b9\u6cd5\u5224\u65ad\u662f\u5426\u5b58\u5728\u4e25\u91cd\u7684 front-end stalls\u3002\u82e5\u5b58\u5728\uff0c\u5219\u542f\u7528 Intel LBR (Last Branch Record) \u673a\u5236\u6536\u96c6\u70ed\u70b9\u63a7\u5236\u6d41\u8def\u5f84\u3002</li> <li>\u4f18\u5316: \u5c06\u6536\u96c6\u5230\u7684 LBR \u5256\u6790\u6570\u636e\u548c\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f5c\u4e3a\u8f93\u5165\uff0c\u8c03\u7528 BOLT \u751f\u6210\u4e00\u4e2a\u5168\u65b0\u7684\u3001\u7ecf\u8fc7\u4ee3\u7801\u5e03\u5c40\u4f18\u5316\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u6b64\u8fc7\u7a0b\u5728\u540e\u53f0\u8fdb\u884c\uff0c\u4e0d\u5f71\u54cd\u4e3b\u8fdb\u7a0b\u7684\u6b63\u5e38\u6267\u884c\u3002</li> </ul> </li> <li> <p>\u6b65\u9aa4 3-6: \u5728\u7ebf\u4ee3\u7801\u66ff\u6362 (\u540c\u6b65):</p> <ul> <li>\u6682\u505c\u8fdb\u7a0b: \u4f7f\u7528 Linux ptrace API \u6682\u505c\u76ee\u6807\u8fdb\u7a0b\u7684\u6240\u6709\u7ebf\u7a0b\uff0c\u8fdb\u5165\u201cstop-the-world\u201d\u72b6\u6001\u3002</li> <li>\u6ce8\u5165\u4ee3\u7801: \u901a\u8fc7 LD_PRELOAD \u673a\u5236\u9884\u5148\u6ce8\u5165\u7684\u5e93\uff0c\u5728\u76ee\u6807\u8fdb\u7a0b\u5185\u90e8\u9ad8\u6548\u5730\u5c06 BOLT \u751f\u6210\u7684\u4f18\u5316\u4ee3\u7801 (<code>C1</code>) \u590d\u5236\u5230\u5176\u5730\u5740\u7a7a\u95f4\u4e2d\uff0c\u540c\u65f6\u4fdd\u7559\u539f\u59cb\u4ee3\u7801 (<code>C0</code>)\u3002</li> <li>\u66f4\u65b0\u6307\u9488: \u8fd9\u662f\u6700\u5173\u952e\u7684\u4e00\u6b65\u3002OCOLOS \u4f1a\u66f4\u65b0\u4ee5\u4e0b\u51e0\u7c7b\u6307\u9488\u4ee5\u5f15\u5bfc\u6267\u884c\u6d41\u81f3 <code>C1</code>:<ul> <li>\u76f4\u63a5\u8c03\u7528 (Direct calls): \u4fee\u8865 <code>C0</code> \u4e2d\u5bf9\u70ed\u70b9\u51fd\u6570\u7684\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\uff0c\u4f7f\u5176\u8df3\u8f6c\u5230 <code>C1</code> \u4e2d\u7684\u5bf9\u5e94\u51fd\u6570\u3002</li> <li>\u865a\u8868 (v-tables): \u66f4\u65b0\u5168\u5c40\u6216\u5806\u4e0a\u7684\u865a\u8868\uff0c\u4f7f\u5176\u51fd\u6570\u6307\u9488\u6307\u5411 <code>C1</code> \u4e2d\u7684\u5b9e\u73b0\u3002</li> <li>\u6808\u4e0a\u8fd4\u56de\u5730\u5740: \u5bf9\u4e8e\u6b63\u5904\u4e8e\u8c03\u7528\u6808\u4e0a\u7684\u51fd\u6570\uff0cOCOLOS \u4f1a\u5c06\u5176\u5728 <code>C0</code> \u4e2d\u7684\u4ee3\u7801\u539f\u6837\u590d\u5236\u4e00\u4efd\u5230 <code>C1</code> \u533a\u57df\uff08\u8bb0\u4e3a <code>bi,i+1</code>\uff09\uff0c\u5e76\u7cbe\u786e\u8ba1\u7b97\u548c\u66f4\u65b0\u6808\u4e0a\u7684\u8fd4\u56de\u5730\u5740\uff0c\u786e\u4fdd\u51fd\u6570\u80fd\u6b63\u786e\u8fd4\u56de\u3002</li> </ul> </li> <li>\u6062\u590d\u8fdb\u7a0b: \u5b8c\u6210\u6240\u6709\u4fee\u8865\u540e\uff0c\u6062\u590d\u6240\u6709\u7ebf\u7a0b\u7684\u6267\u884c\u3002</li> </ul> </li> </ul> <p>\u5904\u7406\u8fde\u7eed\u4f18\u5316\u4e0e\u51fd\u6570\u6307\u9488</p> <p>\u4e3a\u4e86\u652f\u6301\u6839\u636e\u7a0b\u5e8f\u884c\u4e3a\u53d8\u5316\u8fdb\u884c\u591a\u6b21\u4f18\u5316\uff08\u5373 <code>C0</code> -&gt; <code>C1</code> -&gt; <code>C2</code> ...\uff09\uff0cOCOLOS \u5f15\u5165\u4e86\u5783\u573e\u56de\u6536\u673a\u5236\u6765\u6e05\u7406\u4e0d\u518d\u9700\u8981\u7684\u65e7\u4ee3\u7801\u7248\u672c\uff0c\u5e76\u901a\u8fc7\u4e00\u79cd\u5de7\u5999\u7684\u65b9\u6cd5\u5904\u7406\u96be\u4ee5\u8ffd\u8e2a\u7684\u51fd\u6570\u6307\u9488\u3002</p> <ul> <li>\u51fd\u6570\u6307\u9488\u521b\u5efa\u62e6\u622a:<ul> <li>OCOLOS \u8981\u6c42\u5e94\u7528\u7a0b\u5e8f\u5728\u7f16\u8bd1\u65f6\u5e94\u7528\u4e00\u4e2a\u7b80\u5355\u7684 LLVM compiler pass\u3002</li> <li>\u8be5 Pass \u4f1a\u5728\u6240\u6709\u51fd\u6570\u6307\u9488\u521b\u5efa\u70b9\u63d2\u5165\u4e00\u4e2a\u56de\u8c03\u51fd\u6570 <code>wrapFuncPtrCreation</code>\u3002</li> <li>\u65e0\u8bba\u7a0b\u5e8f\u4f55\u65f6\u521b\u5efa\u4e00\u4e2a\u6307\u5411 <code>Ci</code> (i&gt;0) \u7684\u51fd\u6570\u6307\u9488\uff0c\u8be5\u56de\u8c03\u90fd\u4f1a\u5c06\u5176\u900f\u660e\u5730\u91cd\u5b9a\u5411\u4e3a\u6307\u5411\u539f\u59cb <code>C0</code> \u4e2d\u7684\u5bf9\u5e94\u51fd\u6570\u3002</li> <li>\u8fd9\u6837\uff0c\u6240\u6709\u5728\u7a0b\u5e8f\u4e2d\u81ea\u7531\u4f20\u64ad\u7684\u51fd\u6570\u6307\u9488\u90fd\u53ea\u6307\u5411 <code>C0</code>\uff0c\u800c <code>C0</code> \u4e2d\u7684\u4ee3\u7801\u53c8\u4f1a\u88ab\u4fee\u8865\u4ee5\u8c03\u7528 <code>Ci</code>\uff0c\u4ece\u800c\u5728\u4fdd\u8bc1\u5b89\u5168\u6027\u7684\u540c\u65f6\uff0c\u5c06\u7edd\u5927\u591a\u6570\u6267\u884c\u6d41\u5bfc\u5411\u6700\u65b0\u7684\u4f18\u5316\u4ee3\u7801\u3002</li> </ul> </li> </ul> <p>BATCH ACCELERATOR MODE (BAM)</p> <p>\u5bf9\u4e8e\u5927\u91cf\u77ed\u751f\u547d\u5468\u671f\u8fdb\u7a0b\u7684\u6279\u5904\u7406\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982\u8f6f\u4ef6\u6784\u5efa\uff09\uff0cOCOLOS \u7684\u4e00\u6b21\u6027\u66ff\u6362\u5f00\u9500\u65e0\u6cd5\u88ab\u6709\u6548\u644a\u9500\u3002\u4e3a\u6b64\uff0c\u8bba\u6587\u63d0\u51fa\u4e86 BAM \u6a21\u5f0f\u3002</p> <ul> <li>\u5de5\u4f5c\u539f\u7406:<ul> <li>BAM \u4f5c\u4e3a\u4e00\u4e2a LD_PRELOAD \u5e93\uff0c\u900f\u660e\u5730\u62e6\u622a\u5bf9\u76ee\u6807\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u5982 <code>clang</code>\uff09\u7684 <code>exec*</code> \u8c03\u7528\u3002</li> <li>\u5b83\u5bf9\u524d N \u6b21\u6267\u884c\u8fdb\u884c\u5256\u6790\uff0c\u5e76\u5728\u540e\u53f0\u4f7f\u7528 BOLT \u751f\u6210\u4f18\u5316\u7248\u672c\u3002</li> <li>\u4e00\u65e6\u4f18\u5316\u4e8c\u8fdb\u5236\u5c31\u7eea\uff0c\u540e\u7eed\u6240\u6709\u7684 <code>exec*</code> \u8c03\u7528\u90fd\u4f1a\u88ab\u91cd\u5199\uff0c\u76f4\u63a5\u542f\u52a8\u8fd9\u4e2a\u4f18\u5316\u540e\u7684\u7248\u672c\u3002</li> </ul> </li> <li>\u4f18\u52bf: \u5b8c\u5168\u65e0\u9700\u4fee\u6539\u6784\u5efa\u811a\u672c\u6216\u6e90\u4ee3\u7801\uff0c\u5373\u53ef\u52a0\u901f\u6574\u4e2a\u6784\u5efa\u8fc7\u7a0b\u3002\u5b9e\u9a8c\u8868\u660e\uff0cBAM \u80fd\u5c06 Clang \u7684\u5b8c\u6574\u6784\u5efa\u901f\u5ea6\u63d0\u5347 1.14\u00d7\u3002</li> </ul> <p>\u6027\u80fd\u8bc4\u4f30\u4e0e\u5c40\u9650\u6027</p> <p>OCOLOS \u5728\u591a\u4e2a\u771f\u5b9e\u4e16\u754c\u5e94\u7528\u4e0a\u5c55\u793a\u4e86\u663e\u8457\u7684\u6027\u80fd\u63d0\u5347\u3002</p> Benchmark (Input) OCOLOS Speedup BOLT Oracle Speedup MySQL (read only) 1.41\u00d7 1.48\u00d7 Verilator (dhrystone) 2.20\u00d7 2.21\u00d7 MongoDB (read update) 1.29\u00d7 1.33\u00d7 Clang Build (BAM) 1.14\u00d7 1.16\u00d7 <ul> <li>\u6838\u5fc3\u6536\u76ca\u6765\u6e90: \u5982\u56fe\u6240\u793a\uff0cOCOLOS \u663e\u8457\u964d\u4f4e\u4e86 L1i MPKI (\u6bcf\u5343\u6761\u6307\u4ee4\u7684 L1 \u6307\u4ee4\u7f13\u5b58\u7f3a\u5931\u6570)\u3001iTLB MPKI \u548c taken branches \u7684\u6570\u91cf\uff0c\u6709\u6548\u7f13\u89e3\u4e86\u5904\u7406\u5668\u524d\u7aef\u74f6\u9888\u3002</li> </ul> <p></p> <p>Fig. 8: Microarchitectural events (per 1,000 instructions) for MySQL inputs</p> <ul> <li>\u5f53\u524d\u5c40\u9650\u6027:<ul> <li>\u4e0d\u652f\u6301 jump tables: \u9700\u8981\u4f7f\u7528 <code>-fno-jump-tables</code> \u7f16\u8bd1\u6807\u5fd7\u3002</li> <li>\u66ff\u6362\u6682\u505c\u65f6\u95f4: \u4ee3\u7801\u66ff\u6362\u671f\u95f4\u8fdb\u7a0b\u5b8c\u5168\u6682\u505c\uff0c\u53ef\u80fd\u5f71\u54cd\u5c3e\u90e8\u5ef6\u8fdf\u3002\u8bba\u6587\u4e2d MySQL \u7684\u6682\u505c\u65f6\u95f4\u4e3a 669ms\u3002</li> <li>BOLT \u9650\u5236: \u5f53\u524d\u7248\u672c\u7684 BOLT \u65e0\u6cd5\u5bf9\u5df2\u7ecf BOLT \u4f18\u5316\u8fc7\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u518d\u6b21\u4f18\u5316\uff0c\u8fd9\u963b\u788d\u4e86\u5bf9 continuous optimization \u7684\u5b8c\u6574\u8bc4\u4f30\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#2-safe-online-code-replacement","title":"2. \u5b89\u5168\u7684\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u673a\u5236 (Safe Online Code Replacement)","text":"<p>OCOLOS \u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\u5176\u5b9e\u73b0\u4e86\u9488\u5bf9 unmanaged languages\uff08\u5982 C/C++\uff09\u7684 \u5b89\u5168\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u673a\u5236\u3002\u8be5\u673a\u5236\u5de7\u5999\u5730\u89c4\u907f\u4e86\u5728\u8fd0\u884c\u65f6\u4fee\u6539\u4ee3\u7801\u6240\u5e26\u6765\u7684\u6307\u9488\u5931\u6548\u98ce\u9669\uff0c\u5176\u8bbe\u8ba1\u56f4\u7ed5\u4e09\u4e2a\u6838\u5fc3\u539f\u5219\u5c55\u5f00\u3002</p> <p>\u8bbe\u8ba1\u539f\u5219\u4e0e\u5b9e\u73b0\u539f\u7406</p> <ul> <li>Design Principle #1: preserve addresses of C0 instructions (\u4fdd\u7559\u539f\u59cb\u4ee3\u7801 C0 \u7684\u6307\u4ee4\u5730\u5740)\u3002</li> <li>OCOLOS \u4e0d\u4f1a\u76f4\u63a5\u8986\u5199\u539f\u59cb\u4ee3\u7801\u6bb5\uff08\u79f0\u4e3a C0\uff09\u3002</li> <li>\u76f8\u53cd\uff0c\u5b83\u4f1a\u5c06\u7ecf\u8fc7 BOLT \u4f18\u5316\u540e\u7684\u65b0\u4ee3\u7801\uff08\u79f0\u4e3a C1\uff09\u6ce8\u5165\u5230\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u4e00\u4e2a\u65b0\u4f4d\u7f6e\u3002</li> <li> <p>\u539f\u59cb\u4ee3\u7801 C0 \u88ab\u5b8c\u6574\u4fdd\u7559\uff0c\u8fd9\u786e\u4fdd\u4e86\u4efb\u4f55\u6307\u5411 C0 \u7684\u3001\u65e0\u6cd5\u88ab\u8ffd\u8e2a\u6216\u66f4\u65b0\u7684\u6307\u9488\uff08\u4f8b\u5982\u901a\u8fc7 <code>setjmp/longjmp</code> \u4fdd\u5b58\u7684\u6307\u4ee4\u6307\u9488\u3001\u6216\u88ab\u6df7\u6dc6\u7684\u51fd\u6570\u6307\u9488\uff09\u4f9d\u7136\u6709\u6548\uff0c\u4ece\u800c\u4fdd\u8bc1\u4e86\u7a0b\u5e8f\u7684\u6b63\u786e\u6027\u3002</p> </li> <li> <p>Design Principle #2: run C1 code in the common case (\u5728\u5e38\u89c1\u60c5\u51b5\u4e0b\u6267\u884c C1 \u4ee3\u7801)\u3002</p> </li> <li>\u4e3a\u4e86\u83b7\u5f97\u6027\u80fd\u6536\u76ca\uff0cOCOLOS \u9700\u8981\u5c06\u6267\u884c\u6d41\u5c3d\u53ef\u80fd\u591a\u5730\u5f15\u5bfc\u81f3\u4f18\u5316\u540e\u7684 C1 \u4ee3\u7801\u3002</li> <li>\u5b83\u901a\u8fc7\u6709\u9009\u62e9\u5730\u66f4\u65b0\u5173\u952e\u4e14\u53ef\u8ffd\u8e2a\u7684\u4ee3\u7801\u6307\u9488\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff0c\u4e3b\u8981\u5305\u62ec\uff1a<ul> <li>\u865a\u8868 (v-table) \u4e2d\u7684\u51fd\u6570\u6307\u9488\u3002</li> <li>\u76f4\u63a5\u8c03\u7528 (direct calls) \u6307\u4ee4\u7684\u76ee\u6807\u5730\u5740\u3002</li> </ul> </li> <li> <p>\u8fd9\u79cd\u7b56\u7565\u63a5\u53d7\u4e00\u4e2a\u6743\u8861\uff1a\u5c11\u6570\u60c5\u51b5\u4e0b\uff08\u4f8b\u5982\u901a\u8fc7\u672a\u88ab\u66f4\u65b0\u7684\u65e7\u51fd\u6570\u6307\u9488\u8c03\u7528\uff09\uff0c\u7a0b\u5e8f\u4ecd\u4f1a\u6267\u884c C0 \u4ee3\u7801\uff0c\u4f46\u8fd9\u90e8\u5206\u5f00\u9500\u5f88\u5c0f\uff0c\u5e76\u4e14\u4e00\u65e6\u8fdb\u5165 C0\uff0c\u540e\u7eed\u7684\u76f4\u63a5\u8c03\u7528\u6216\u865a\u51fd\u6570\u8c03\u7528\u901a\u5e38\u4f1a\u518d\u6b21\u8df3\u8f6c\u56de C1\u3002</p> </li> <li> <p>Design Principle #3: code replacement can incur fixed costs, but must avoid all possible recurring costs (\u4ee3\u7801\u66ff\u6362\u53ef\u4ee5\u4ea7\u751f\u4e00\u6b21\u6027\u5f00\u9500\uff0c\u4f46\u5fc5\u987b\u907f\u514d\u6240\u6709\u53ef\u80fd\u7684\u6301\u7eed\u6027\u5f00\u9500)\u3002</p> </li> <li>OCOLOS \u7684\u8bbe\u8ba1\u907f\u514d\u4e86\u50cf\u4f20\u7edf Dynamic Binary Instrumentation (DBI) \u6846\u67b6\uff08\u5982 Pin, DynamoRIO\uff09\u90a3\u6837\u7684\u6301\u7eed\u6027\u6027\u80fd\u635f\u8017\u3002</li> <li>\u5176\u4e3b\u8981\u5f00\u9500\u53d1\u751f\u5728\u4ee3\u7801\u66ff\u6362\u7684\u77ed\u6682\u201cstop-the-world\u201d\u9636\u6bb5\uff0c\u4e4b\u540e\u7a0b\u5e8f\u4ee5\u63a5\u8fd1\u539f\u751f\u7684\u901f\u5ea6\u8fd0\u884c\u5728 C1 \u4e0a\u3002</li> </ul> <p></p> <p>Figure 4b: Starting state of the address space (left) and state after code replacement (right)</p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5173\u952e\u6280\u672f</p> <p>OCOLOS \u7684\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u6d41\u7a0b\u5982\u56fe\u6240\u793a\uff0c\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u540e\u53f0\u51c6\u5907:</p> <ul> <li>\u5728\u76ee\u6807\u8fdb\u7a0b\u8fd0\u884c\u7684\u540c\u65f6\uff0cOCOLOS \u5728\u540e\u53f0\u4f7f\u7528 Linux perf \u5de5\u5177\u6536\u96c6 LBR (Last Branch Record) \u6027\u80fd\u5256\u6790\u6570\u636e\u3002</li> <li>\u5229\u7528\u6536\u96c6\u5230\u7684 LBR \u6570\u636e\u548c\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u8c03\u7528 BOLT \u5de5\u5177\u751f\u6210\u4e00\u4e2a\u5168\u65b0\u7684\u3001\u7ecf\u8fc7\u4f18\u5316\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u5373 C1 \u7684\u6765\u6e90\uff09\u3002</li> </ul> </li> <li> <p>\u6682\u505c\u76ee\u6807\u8fdb\u7a0b:</p> <ul> <li>\u5f53\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u51c6\u5907\u597d\u540e\uff0cOCOLOS \u4f7f\u7528 ptrace API \u6682\u505c\u76ee\u6807\u8fdb\u7a0b\u7684\u6240\u6709\u7ebf\u7a0b\uff0c\u8fdb\u5165\u201cstop-the-world\u201d\u9636\u6bb5\u3002</li> </ul> </li> <li> <p>\u6ce8\u5165\u65b0\u4ee3\u7801 (C1):</p> <ul> <li>OCOLOS \u901a\u8fc7 LD_PRELOAD \u6ce8\u5165\u7684\u5e93\uff0c\u5728\u76ee\u6807\u8fdb\u7a0b\u5185\u90e8\u9ad8\u6548\u5730\u5c06 C1 \u4ee3\u7801\u4ece\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u590d\u5236\u5230\u5176\u5730\u5740\u7a7a\u95f4\u7684\u65b0\u533a\u57df\u3002</li> </ul> </li> <li> <p>\u66f4\u65b0\u5173\u952e\u6307\u9488:</p> <ul> <li>\u76f4\u63a5\u8c03\u7528\u4fee\u8865: OCOLOS \u5728\u79bb\u7ebf\u9636\u6bb5\u5df2\u89e3\u6790\u51fa\u539f\u59cb\u4e8c\u8fdb\u5236\u4e2d\u6240\u6709\u76f4\u63a5\u8c03\u7528\u6307\u4ee4\u7684\u4f4d\u7f6e\u3002\u5728\u6b64\u9636\u6bb5\uff0c\u5b83\u5c06\u8fd9\u4e9b\u8c03\u7528\u7684\u76ee\u6807\u5730\u5740\u4ece C0 \u4e2d\u7684\u51fd\u6570\u66f4\u65b0\u4e3a C1 \u4e2d\u5bf9\u5e94\u7684\u51fd\u6570\u3002</li> <li>\u865a\u8868\u4fee\u8865: OCOLOS \u626b\u63cf\u8fdb\u7a0b\u5185\u5b58\uff08\u6216\u5229\u7528\u5df2\u77e5\u7684\u865a\u8868\u5e03\u5c40\uff09\uff0c\u5b9a\u4f4d\u5e76\u66f4\u65b0\u6240\u6709\u6307\u5411 C0 \u51fd\u6570\u7684\u865a\u8868\u6761\u76ee\uff0c\u4f7f\u5176\u6307\u5411 C1 \u4e2d\u7684\u5bf9\u5e94\u51fd\u6570\u3002</li> </ul> </li> <li> <p>\u6062\u590d\u6267\u884c:</p> <ul> <li>\u5b8c\u6210\u4ee3\u7801\u6ce8\u5165\u548c\u6307\u9488\u66f4\u65b0\u540e\uff0cOCOLOS \u6062\u590d\u6240\u6709\u7ebf\u7a0b\u7684\u6267\u884c\u3002\u6b64\u540e\uff0c\u7edd\u5927\u591a\u6570\u6267\u884c\u6d41\u5c06\u901a\u8fc7\u66f4\u65b0\u540e\u7684\u76f4\u63a5\u8c03\u7528\u548c\u865a\u8868\u8fdb\u5165\u9ad8\u6027\u80fd\u7684 C1 \u4ee3\u7801\u3002</li> </ul> </li> </ol> <p>\u5904\u7406\u8fde\u7eed\u4f18\u5316\u4e0e\u51fd\u6570\u6307\u9488</p> <p>\u4e3a\u4e86\u652f\u6301 Continuous Optimization\uff08\u6301\u7eed\u4f18\u5316\uff09\uff0c\u5373\u4ece C1 \u5347\u7ea7\u5230 C2\uff0cOCOLOS \u5f15\u5165\u4e86\u989d\u5916\u7684\u673a\u5236\u6765\u5904\u7406\u6808\u4e0a\u6d3b\u8dc3\u7684\u51fd\u6570\u548c\u52a8\u6001\u521b\u5efa\u7684\u51fd\u6570\u6307\u9488\u3002</p> <ul> <li>\u6808\u4e0a\u51fd\u6570\u5904\u7406:</li> <li>\u5982\u679c\u4e00\u4e2a\u6b63\u5728 C1 \u4e2d\u6267\u884c\u7684\u51fd\u6570\uff08\u4f8b\u5982 <code>b1</code>\uff09\u9700\u8981\u88ab\u66ff\u6362\u4e3a C2\uff0cOCOLOS \u65e0\u6cd5\u7b80\u5355\u5730\u8ba9\u5176\u8fd4\u56de\u5230 C2 \u4e2d\u7684 <code>b2</code>\uff0c\u56e0\u4e3a <code>b2</code> \u7684\u6307\u4ee4\u5e03\u5c40\u53ef\u80fd\u5df2\u5b8c\u5168\u4e0d\u540c\u3002</li> <li>\u89e3\u51b3\u65b9\u6848\u662f\uff0c\u5728 C2 \u4e2d\u4e3a\u8be5\u6808\u4e0a\u51fd\u6570\u521b\u5efa\u4e00\u4e2a \u7cbe\u786e\u526f\u672c\uff08\u4f8b\u5982 <code>b1,2</code>\uff09\uff0c\u5e76\u4fee\u6b63\u5176\u5185\u90e8\u7684 PC-relative addressing\u3002</li> <li> <p>\u540c\u65f6\uff0cOCOLOS \u4f1a\u904d\u5386\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u6808\uff08\u4f7f\u7528 libunwind\uff09\uff0c\u627e\u5230\u8fd4\u56de\u5730\u5740\uff0c\u5e76\u5c06\u5176\u91cd\u5b9a\u5411\u5230 <code>b1,2</code> \u4e2d\u7684\u5bf9\u5e94\u4f4d\u7f6e\uff0c\u786e\u4fdd\u51fd\u6570\u80fd\u6b63\u786e\u8fd4\u56de\u3002</p> </li> <li> <p>\u51fd\u6570\u6307\u9488\u521b\u5efa\u62e6\u622a:</p> </li> <li>\u4e3a\u4e86\u907f\u514d\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u521b\u5efa\u6307\u5411 C1/C2 \u7b49\u4e2d\u95f4\u7248\u672c\u4ee3\u7801\u7684\u51fd\u6570\u6307\u9488\uff08\u8fd9\u4e9b\u6307\u9488\u5728\u4e0b\u4e00\u6b21\u4ee3\u7801\u66ff\u6362\u65f6\u4f1a\u5931\u6548\uff09\uff0cOCOLOS \u5f3a\u5236\u89c4\u5b9a\uff1a\u6240\u6709\u52a8\u6001\u521b\u5efa\u7684\u51fd\u6570\u6307\u9488\u5fc5\u987b\u6307\u5411\u539f\u59cb\u7684 C0 \u5730\u5740\u3002</li> <li>\u5b83\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684 LLVM compiler pass \u6765\u5b9e\u73b0\uff0c\u5728\u6bcf\u4e2a\u51fd\u6570\u6307\u9488\u521b\u5efa\u70b9\u63d2\u5165\u4e00\u4e2a\u56de\u8c03\u51fd\u6570 <code>wrapFuncPtrCreation</code>\u3002</li> <li>\u8be5\u56de\u8c03\u51fd\u6570\u7ef4\u62a4\u4e00\u4e2a\u4ece Ci \u5230 C0 \u7684\u5730\u5740\u6620\u5c04\uff0c\u5c06\u4efb\u4f55\u5bf9 Ci \u51fd\u6570\u7684\u5f15\u7528\u81ea\u52a8\u8f6c\u6362\u4e3a\u5bf9 C0 \u51fd\u6570\u7684\u5f15\u7528\u3002\u7531\u4e8e\u51fd\u6570\u6307\u9488\u521b\u5efa\u662f\u4e00\u4e2a\u76f8\u5bf9\u4f4e\u9891\u7684\u64cd\u4f5c\uff08\u4f8b\u5982 MySQL \u4e2d\u6bcf\u6beb\u79d2\u4ec5\u7ea6 45 \u6b21\uff09\uff0c\u6b64\u673a\u5236\u7684\u8fd0\u884c\u65f6\u5f00\u9500\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\u3002</li> </ul> <p></p> <p>Figure 4c: Before (left) and after (right) continuous optimization</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u6574\u4f53\u4f5c\u7528</p> <ul> <li>\u8f93\u5165:</li> <li>\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u3001\u672a\u7ecf\u4f18\u5316\u7684\u76ee\u6807\u8fdb\u7a0b\u3002</li> <li>\u7531 perf \u6536\u96c6\u7684\u3001\u9488\u5bf9\u8be5\u8fdb\u7a0b\u5f53\u524d\u884c\u4e3a\u7684 LBR profiling data\u3002</li> <li> <p>\u539f\u59cb\u7684\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> </li> <li> <p>\u8f93\u51fa:</p> </li> <li>\u540c\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u4f46\u5176\u70ed\u4ee3\u7801\u8def\u5f84\u5df2\u88ab\u66ff\u6362\u4e3a\u7ecf\u8fc7 BOLT \u4f18\u5316\u7684 C1 \u4ee3\u7801\u3002</li> <li> <p>\u8fdb\u7a0b\u7ee7\u7eed\u8fd0\u884c\uff0c\u6027\u80fd\u5f97\u5230\u63d0\u5347\uff0c\u4e14\u65e0\u9700\u91cd\u542f\u3002</p> </li> <li> <p>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528:</p> </li> <li>\u8be5\u673a\u5236\u662f OCOLOS \u5b9e\u73b0 Online Profile-Guided Optimization (PGO) \u7684\u57fa\u77f3\u3002\u5b83\u89e3\u51b3\u4e86\u4f20\u7edf\u79bb\u7ebf PGO \u7684\u4e24\u5927\u75db\u70b9\uff1aprofile staleness\uff08\u5256\u6790\u6570\u636e\u8fc7\u65f6\uff09\u548c binary mapping\uff08\u5256\u6790\u6570\u636e\u4e0e\u65b0\u7248\u672c\u4e8c\u8fdb\u5236\u96be\u4ee5\u6620\u5c04\uff09\u3002</li> <li>\u901a\u8fc7\u5b89\u5168\u5730\u5728\u8fd0\u884c\u65f6\u66ff\u6362\u4ee3\u7801\uff0cOCOLOS \u786e\u4fdd\u4e86\u5256\u6790\u6570\u636e\u59cb\u7ec8\u4e0e\u5f53\u524d\u6267\u884c\u7684\u4ee3\u7801\u5b8c\u7f8e\u5339\u914d\uff0c\u4ece\u800c\u80fd\u591f\u6301\u7eed\u5730\u4e3a\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u6700\u4f18\u7684\u4ee3\u7801\u5e03\u5c40\uff0c\u6700\u5927\u5316 L1i \u548c branch predictor \u7684\u6548\u7387\u3002</li> </ul>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#3-function-pointer-creation-interception","title":"3. \u51fd\u6570\u6307\u9488\u521b\u5efa\u62e6\u622a (Function Pointer Creation Interception)","text":"<p>\u5b9e\u73b0\u539f\u7406\u4e0e\u6838\u5fc3\u76ee\u6807</p> <p>OCOLOS \u7684\u8fde\u7eed\u4f18\u5316\u673a\u5236\u4f1a\u751f\u6210\u591a\u4e2a\u4ee3\u7801\u7248\u672c\uff08C0, C1, C2, ...\uff09\uff0c\u5e76\u6700\u7ec8\u56de\u6536\u4e0d\u518d\u9700\u8981\u7684\u65e7\u7248\u672c\uff08\u5982 Ci\uff09\u3002\u8fd9\u5e26\u6765\u4e00\u4e2a\u4e25\u5cfb\u6311\u6218\uff1a\u5982\u679c\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u521b\u5efa\u4e86\u6307\u5411\u4e2d\u95f4\u7248\u672c Ci \u7684\u51fd\u6570\u6307\u9488\uff0c\u5f53 Ci \u88ab\u56de\u6536\u540e\uff0c\u8fd9\u4e9b\u60ac\u7a7a\u6307\u9488\u5c06\u5bfc\u81f4\u7a0b\u5e8f\u5d29\u6e83\u3002\u4e3a\u89e3\u51b3\u6b64\u95ee\u9898\uff0cOCOLOS \u5f15\u5165\u4e86\u4e00\u79cd\u5de7\u5999\u7684\u8bbe\u8ba1\uff0c\u5176\u6838\u5fc3\u76ee\u6807\u662f\u5f3a\u5236\u6240\u6709\u52a8\u6001\u521b\u5efa\u7684\u51fd\u6570\u6307\u9488\u90fd\u6307\u5411\u539f\u59cb\u3001\u6c38\u4e0d\u88ab\u56de\u6536\u7684 C0 \u4ee3\u7801\u3002</p> <ul> <li>\u6839\u672c\u7b56\u7565\uff1a\u901a\u8fc7\u4e00\u4e2a LLVM compiler pass\uff0c\u5728\u7f16\u8bd1\u9636\u6bb5\u5bf9\u6240\u6709\u51fd\u6570\u6307\u9488\u7684\u521b\u5efa\u70b9\u8fdb\u884c\u9759\u6001\u5206\u6790\u548c\u63d2\u6869\u3002</li> <li>\u8fd0\u884c\u65f6\u91cd\u5b9a\u5411\uff1a\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u6bcf\u5f53\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u51fd\u6570\u6307\u9488\uff0c\u8be5\u63d2\u6869\u4ee3\u7801\u4f1a\u8c03\u7528\u4e00\u4e2a\u540d\u4e3a <code>wrapFuncPtrCreation</code> \u7684\u56de\u8c03\u51fd\u6570\u3002</li> <li>\u5730\u5740\u6620\u5c04\uff1a<code>wrapFuncPtrCreation</code> \u51fd\u6570\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a\u4ece\u4f18\u5316\u4ee3\u7801\u7248\u672c\uff08Ci\uff09\u5230\u539f\u59cb\u4ee3\u7801\u7248\u672c\uff08C0\uff09\u7684\u5730\u5740\u6620\u5c04\u8868\u3002\u5b83\u63a5\u6536\u4e00\u4e2a\u53ef\u80fd\u6307\u5411 Ci \u7684\u51fd\u6570\u6307\u9488\u4f5c\u4e3a\u8f93\u5165\uff0c\u5e76\u8fd4\u56de\u5176\u5728 C0 \u4e2d\u7684\u5bf9\u5e94\u5730\u5740\u3002</li> <li>\u8bed\u4e49\u4e00\u81f4\u6027\uff1a\u7531\u4e8e C0 \u548c Ci \u4e2d\u7684\u5bf9\u5e94\u51fd\u6570\u5728\u529f\u80fd\u4e0a\u662f\u7b49\u4ef7\u7684\uff08\u4ec5\u5e03\u5c40\u4e0d\u540c\uff09\uff0c\u5c06\u51fd\u6570\u6307\u9488\u91cd\u5b9a\u5411\u5230 C0 \u4e0d\u4f1a\u7834\u574f\u7a0b\u5e8f\u903b\u8f91\uff0c\u4f46\u80fd\u786e\u4fdd\u6307\u9488\u7684\u957f\u671f\u6709\u6548\u6027\u3002</li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u53c2\u6570\u8bbe\u7f6e</p> <p>\u8be5\u673a\u5236\u7684\u5b8c\u6574\u6d41\u7a0b\u8d2f\u7a7f\u7f16\u8bd1\u65f6\u548c\u8fd0\u884c\u65f6\u4e24\u4e2a\u9636\u6bb5\u3002</p> <ul> <li> <p>\u7f16\u8bd1\u65f6 (Offline)</p> <ul> <li>OCOLOS \u7684 LLVM Pass \u626b\u63cf\u6574\u4e2a\u7a0b\u5e8f\u7684 IR \u6216 MIR\u3002</li> <li>\u5b83\u8bc6\u522b\u51fa\u6240\u6709\u53ef\u80fd\u4ea7\u751f\u51fd\u6570\u6307\u9488\u7684\u6307\u4ee4\u6216\u8868\u8fbe\u5f0f\uff08\u4f8b\u5982\uff0c\u53d6\u51fd\u6570\u5730\u5740 <code>&amp;func</code> \u7684\u64cd\u4f5c\uff09\u3002</li> <li>\u5728\u8fd9\u4e9b\u4f4d\u7f6e\u63d2\u5165\u5bf9 <code>wrapFuncPtrCreation</code> \u51fd\u6570\u7684\u8c03\u7528\uff0c\u5c06\u539f\u59cb\u7684\u51fd\u6570\u5730\u5740\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u3002</li> <li>\u6b64\u8fc7\u7a0b\u65e0\u9700\u4efb\u4f55\u7528\u6237\u5e72\u9884\u6216\u6e90\u4ee3\u7801\u4fee\u6539\uff0c\u5b8c\u5168\u81ea\u52a8\u5316\u3002</li> </ul> </li> <li> <p>\u8fd0\u884c\u65f6 (Online)</p> <ul> <li>\u7a0b\u5e8f\u542f\u52a8\u540e\uff0c<code>wrapFuncPtrCreation</code> \u51fd\u6570\u88ab\u521d\u59cb\u5316\uff0c\u5176\u5185\u90e8\u7684\u5730\u5740\u6620\u5c04\u8868\u4e3a\u7a7a\u3002</li> <li>\u5f53\u6267\u884c\u6d41\u5230\u8fbe\u4e00\u4e2a\u88ab\u63d2\u6869\u7684\u51fd\u6570\u6307\u9488\u521b\u5efa\u70b9\u65f6\uff0c\u4f1a\u8c03\u7528 <code>wrapFuncPtrCreation(original_ptr)</code>\u3002</li> <li>\u5224\u65ad\u903b\u8f91\uff1a<ul> <li>\u5982\u679c <code>original_ptr</code> \u6307\u5411\u7684\u662f C0 \u4ee3\u7801\u3001\u5e93\u51fd\u6570\u6216\u5c1a\u672a\u88ab OCOLOS \u4f18\u5316\u7684\u4ee3\u7801\uff0c\u5219 <code>wrapFuncPtrCreation</code> \u76f4\u63a5\u8fd4\u56de <code>original_ptr</code>\uff08\u5373\u5145\u5f53identity function\uff09\u3002</li> <li>\u5982\u679c <code>original_ptr</code> \u6307\u5411\u7684\u662f\u67d0\u4e2a\u5df2\u88ab OCOLOS \u4f18\u5316\u7684 Ci \u7248\u672c\uff0c\u5219\u51fd\u6570\u67e5\u8be2\u5176\u5185\u90e8\u6620\u5c04\u8868\uff0c\u627e\u5230\u5bf9\u5e94\u7684 C0 \u5730\u5740\u5e76\u8fd4\u56de\u3002</li> </ul> </li> <li>\u7a0b\u5e8f\u63a5\u6536\u5230\u7684\u51fd\u6570\u6307\u9488\u503c\u59cb\u7ec8\u662f\u5b89\u5168\u7684 C0 \u5730\u5740\uff0c\u540e\u7eed\u53ef\u4ee5\u5728\u5bc4\u5b58\u5668\u3001\u6808\u6216\u5806\u4e2d\u81ea\u7531\u4f20\u64ad\uff0c\u800c\u65e0\u9700\u4efb\u4f55\u989d\u5916\u7684\u8ffd\u8e2a\u5f00\u9500\u3002</li> </ul> </li> </ul> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <p>\u8be5\u673a\u5236\u7684\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u6e05\u6670\uff0c\u5e76\u5728 OCOLOS \u7684\u6574\u4f53\u8bbe\u8ba1\u4e2d\u626e\u6f14\u7740\u81f3\u5173\u91cd\u8981\u7684\u89d2\u8272\u3002</p> <ul> <li>\u8f93\u5165\uff1a\u4e00\u4e2a\u539f\u59cb\u7684\u3001\u53ef\u80fd\u6307\u5411\u4efb\u610f\u4ee3\u7801\u7248\u672c\uff08C0, C1, ..., Ci\uff09\u7684\u51fd\u6570\u6307\u9488\u5730\u5740\u3002</li> <li>\u8f93\u51fa\uff1a\u4e00\u4e2a\u7ecf\u8fc7\u91cd\u5b9a\u5411\u7684\u3001\u4fdd\u8bc1\u6307\u5411 C0 \u7684\u51fd\u6570\u6307\u9488\u5730\u5740\u3002</li> <li>\u6027\u80fd\u5f00\u9500\uff1a\u8bba\u6587\u6307\u51fa\u6b64\u63d2\u6869\u7684\u5f00\u9500negligible\uff08\u53ef\u5ffd\u7565\u4e0d\u8ba1\uff09\u3002\u4ee5 MySQL \u4e3a\u4f8b\uff0c\u5e73\u5747\u6bcf\u6beb\u79d2\u4ec5\u521b\u5efa\u7ea6 45 \u4e2a\u51fd\u6570\u6307\u9488\uff0c\u56e0\u6b64\u56de\u8c03\u51fd\u6570\u7684\u8c03\u7528\u9891\u7387\u6781\u4f4e\u3002</li> </ul> <p>\u5728 OCOLOS \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u4fdd\u969c\u8fde\u7eed\u4f18\u5316\u7684\u5b89\u5168\u6027\uff1a\u8fd9\u662f\u5b9e\u73b0\u5b89\u5168\u5783\u573e\u56de\u6536\uff08\u56de\u6536 Ci \u4ee3\u7801\uff09\u7684\u524d\u63d0\u3002\u901a\u8fc7\u6d88\u9664\u6307\u5411 Ci \u7684\u201c\u5916\u90e8\u201d\u5f15\u7528\uff0cOCOLOS \u53ef\u4ee5\u786e\u4fe1\u4e00\u65e6\u5185\u90e8\u6307\u9488\uff08\u5982 v-table\u3001\u76f4\u63a5\u8c03\u7528\uff09\u88ab\u66f4\u65b0\uff0cCi \u4ee3\u7801\u5c31\u771f\u6b63\u53d8\u6210\u4e86dead code\uff0c\u53ef\u4ee5\u88ab\u5b89\u5168\u8986\u76d6\u3002</li> <li>\u7ef4\u6301\u201c\u56fa\u5b9a\u6210\u672c\u201d\u6a21\u578b\uff1a\u8be5\u8bbe\u8ba1\u5b8c\u7f8e\u5951\u5408\u4e86 OCOLOS \u7684 Design Principle #3\uff1a\u201ccode replacement can incur fixed costs, but must avoid all possible recurring costs\u201d\u3002\u63d2\u6869\u53ea\u5728\u6307\u9488\u521b\u5efa\u65f6\u53d1\u751f\u4e00\u6b21\uff0c\u4e4b\u540e\u6307\u9488\u7684\u4f7f\u7528\u6ca1\u6709\u4efb\u4f55\u989d\u5916\u5f00\u9500\uff0c\u907f\u514d\u4e86\u50cf\u4f20\u7edf DBI \u6846\u67b6\u90a3\u6837\u7684\u6301\u7eed\u6027\u6027\u80fd\u635f\u8017\u3002</li> <li>\u7b80\u5316\u6307\u9488\u7ba1\u7406\uff1a\u5b83\u5c06\u4e00\u4e2a\u6781\u5176\u590d\u6742\u7684\u52a8\u6001\u6307\u9488\u8ffd\u8e2a\u95ee\u9898\uff0c\u8f6c\u5316\u4e3a\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u3001\u4e00\u6b21\u6027\u7684\u5730\u5740\u7ffb\u8bd1\u95ee\u9898\uff0c\u6781\u5927\u5730\u964d\u4f4e\u4e86\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u7684\u5de5\u7a0b\u590d\u6742\u5ea6\u3002</li> </ul> <p></p> <p>Figure 4c: Before (left) and after (right) continuous optimization</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#4-batch-accelerator-mode-bam","title":"4. \u6279\u5904\u7406\u52a0\u901f\u6a21\u5f0f (Batch Accelerator Mode, BAM)","text":"<p>BAM \u7684\u6838\u5fc3\u76ee\u6807\u4e0e\u8bbe\u8ba1\u52a8\u673a</p> <ul> <li>\u89e3\u51b3 OCOLOS \u4e3b\u6a21\u5f0f\u7684\u5c40\u9650\u6027\uff1aOCOLOS \u7684\u5728\u7ebf\u4ee3\u7801\u66ff\u6362\u673a\u5236\u5b58\u5728\u4e00\u4e2a\u56fa\u5b9a\u7684\u201c\u4e00\u6b21\u6027\u201d\u5f00\u9500\uff08\u5305\u62ec\u5256\u6790\u3001\u8fd0\u884c BOLT\u3001\u6682\u505c\u8fdb\u7a0b\u3001\u6ce8\u5165\u4ee3\u7801\uff09\u3002\u5bf9\u4e8e\u77ed\u65f6\u8fdb\u7a0b (short-running programs)\uff0c\u8fd9\u4e2a\u5f00\u9500\u65e0\u6cd5\u88ab\u5176\u77ed\u6682\u7684\u8fd0\u884c\u65f6\u95f4\u6240\u644a\u9500\uff0c\u5bfc\u81f4\u51c0\u6536\u76ca\u4e3a\u8d1f\u3002</li> <li>\u9488\u5bf9\u7279\u5b9a\u5de5\u4f5c\u8d1f\u8f7d\uff1aBAM \u4e13\u95e8\u4f18\u5316\u6279\u5904\u7406\u5de5\u4f5c\u8d1f\u8f7d (batch workloads)\uff0c\u8fd9\u7c7b\u8d1f\u8f7d\u7684\u7279\u70b9\u662f\u4f1a\u53cd\u590d\u8c03\u7528\u540c\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u591a\u6b21\uff0c\u5178\u578b\u7684\u4f8b\u5b50\u5c31\u662f\u5927\u578b\u8f6f\u4ef6\u9879\u76ee\uff08\u5982 Clang\uff09\u7684\u6784\u5efa\u8fc7\u7a0b\uff0c\u5176\u4e2d\u5305\u542b\u6210\u5343\u4e0a\u4e07\u6b21\u7684\u7f16\u8bd1\u5668\u8c03\u7528\u3002</li> <li>\u7ee7\u627f OCOLOS \u7684\u6838\u5fc3\u4f18\u52bf\uff1a\u4e0e\u4e3b\u6a21\u5f0f\u4e00\u6837\uff0cBAM \u65e8\u5728\u907f\u514d\u79bb\u7ebf PGO \u7684\u75db\u70b9\uff0c\u5373\u5256\u6790\u6570\u636e\u8fc7\u65f6\u3001\u5256\u6790\u6570\u636e\u4e0e\u65b0\u7248\u672c\u4ee3\u7801\u6620\u5c04\u56f0\u96be\u4ee5\u53ca\u5256\u6790\u6570\u636e\u7ba1\u7406\u7684\u8fd0\u7ef4\u8d1f\u62c5\u3002</li> </ul> <p>BAM \u7684\u5b9e\u73b0\u539f\u7406\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <p>BAM \u7684\u5b9e\u73b0\u5b8c\u5168\u57fa\u4e8e Linux \u7684 LD_PRELOAD \u673a\u5236\uff0c\u4f7f\u5176\u5bf9\u5e94\u7528\u7a0b\u5e8f\u5b8c\u5168\u900f\u660e\uff0c\u65e0\u9700\u4efb\u4f55\u4ee3\u7801\u6216\u6784\u5efa\u811a\u672c\u4fee\u6539\u3002</p> <ul> <li>\u90e8\u7f72\u65b9\u5f0f\uff1a</li> <li>\u7528\u6237\u901a\u8fc7 <code>LD_PRELOAD=bam.so</code> \u542f\u52a8\u9876\u5c42\u547d\u4ee4\uff08\u4f8b\u5982 <code>make</code>\uff09\u3002</li> <li> <p>BAM \u5e93 (<code>bam.so</code>) \u4f1a\u88ab\u52a0\u8f7d\u5230\u8be5\u8fdb\u7a0b\u53ca\u5176\u6240\u6709\u5b50\u8fdb\u7a0b\u4e2d\u3002</p> </li> <li> <p>\u6838\u5fc3\u62e6\u622a\u4e0e\u5256\u6790\u9636\u6bb5\uff1a</p> </li> <li>BAM \u900f\u660e\u62e6\u622a (transparent interception) \u5bf9 libc \u4e2d <code>exec*</code> \u7cfb\u5217\u51fd\u6570\u7684\u8c03\u7528\u3002</li> <li>\u5f53\u68c0\u6d4b\u5230\u5bf9\u76ee\u6807\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\uff0c\u4f8b\u5982 <code>clang</code>\uff09\u7684 <code>exec</code> \u8c03\u7528\u65f6\uff0cBAM \u4f1a\u52a8\u6001\u4fee\u6539 <code>exec</code> \u7684\u53c2\u6570\u3002</li> <li>\u4fee\u6539\u540e\u7684\u53c2\u6570\u4f1a\u81ea\u52a8\u542f\u7528\u786c\u4ef6\u6027\u80fd\u5256\u6790\uff08\u901a\u8fc7 <code>perf</code>\uff09\uff0c\u4ece\u800c\u5728\u76ee\u6807\u4e8c\u8fdb\u5236\u6587\u4ef6\u6267\u884c\u65f6\u6536\u96c6 LBR (Last Branch Record) \u5256\u6790\u6570\u636e\u3002</li> <li> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u5bf9\u65e9\u671f\u7684\u51e0\u6b21\u8fd0\u884c\u662f\u900f\u660e\u7684\uff0c\u5b83\u4eec\u4f1a\u6b63\u5e38\u6267\u884c\uff0c\u4f46\u540c\u65f6\u4e3a\u540e\u7eed\u4f18\u5316\u6536\u96c6\u6570\u636e\u3002</p> </li> <li> <p>\u4f18\u5316\u4e8c\u8fdb\u5236\u751f\u6210\u9636\u6bb5\uff1a</p> </li> <li>BAM \u5728\u540e\u53f0\u6301\u7eed\u6536\u96c6\u5256\u6790\u6570\u636e\u3002</li> <li>\u5f53\u6536\u96c6\u5230\u9884\u8bbe\u6570\u91cf\u7684\u5256\u6790\u6837\u672c\u540e\uff08\u8fd9\u662f\u4e00\u4e2a\u53ef\u914d\u7f6e\u7684\u53c2\u6570\uff09\uff0cBAM \u4f1a\u5728\u540e\u53f0\u542f\u52a8\u4e00\u4e2a\u72ec\u7acb\u8fdb\u7a0b\u6765\u6267\u884c BOLT \u4f18\u5316\u6d41\u7a0b\u3002</li> <li> <p>\u8be5\u6d41\u7a0b\u4e0e\u6807\u51c6 BOLT \u76f8\u540c\uff1a\u4f7f\u7528 <code>perf2bolt</code> \u5904\u7406 LBR \u6570\u636e\uff0c\u5e76\u7528 BOLT \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u3001\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u4f8b\u5982 <code>clang.bolt</code>\uff09\u3002</p> </li> <li> <p>\u65e0\u7f1d\u5207\u6362\u4e0e\u52a0\u901f\u9636\u6bb5\uff1a</p> </li> <li>\u4e00\u65e6\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u751f\u6210\u5b8c\u6bd5\uff0cBAM \u4f1a\u52a8\u6001\u91cd\u5199\u540e\u7eed\u7684 <code>exec</code> \u8c03\u7528\u3002</li> <li>\u6240\u6709\u540e\u7eed\u5bf9\u539f\u59cb\u76ee\u6807\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08<code>clang</code>\uff09\u7684\u8c03\u7528\uff0c\u90fd\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u6267\u884c\u4f18\u5316\u540e\u7684\u7248\u672c\uff08<code>clang.bolt</code>\uff09\u3002</li> <li>\u4ece\u8fd9\u4e00\u523b\u8d77\uff0c\u6279\u5904\u7406\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5269\u4f59\u90e8\u5206\u5c31\u80fd\u4eab\u53d7\u5230\u539f\u751f\u7684\u3001\u65e0\u4efb\u4f55\u8fd0\u884c\u65f6\u5f00\u9500\u7684\u6027\u80fd\u63d0\u5347\u3002</li> </ul> <p>\u5173\u952e\u53c2\u6570\u4e0e\u914d\u7f6e</p> <ul> <li>\u76ee\u6807\u4e8c\u8fdb\u5236\u6587\u4ef6\uff1a\u901a\u8fc7\u4e00\u4e2a\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\u9700\u8981\u4f18\u5316\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u8def\u5f84\u3002</li> <li>\u5256\u6790\u6837\u672c\u6570\u91cf\u9608\u503c\uff1a\u4e00\u4e2a\u53ef\u914d\u7f6e\u7684\u53c2\u6570\uff0c\u51b3\u5b9a\u4e86 BAM \u9700\u8981\u89c2\u5bdf\u591a\u5c11\u6b21\u76ee\u6807\u4e8c\u8fdb\u5236\u7684\u6267\u884c\u540e\u624d\u89e6\u53d1 BOLT \u4f18\u5316\u3002\u8fd9\u4e2a\u53c2\u6570\u662f\u6027\u80fd\u6743\u8861\u7684\u5173\u952e\uff1a</li> <li>\u9608\u503c\u8fc7\u4f4e\uff1a\u5256\u6790\u6570\u636e\u4e0d\u8db3\uff0c\u751f\u6210\u7684\u4f18\u5316\u4e8c\u8fdb\u5236\u6548\u679c\u4e0d\u4f73\u3002</li> <li>\u9608\u503c\u8fc7\u9ad8\uff1a\u7b49\u5f85\u5256\u6790\u548c\u4f18\u5316\u7684\u65f6\u95f4\u8fc7\u957f\uff0c\u9519\u8fc7\u4e86\u7528\u4f18\u5316\u7248\u672c\u52a0\u901f\u66f4\u591a\u4efb\u52a1\u7684\u673a\u4f1a\u3002</li> <li>\u8bba\u6587\u5b9e\u9a8c\u8868\u660e\uff0c\u5bf9\u4e8e Clang \u6784\u5efa\uff0c\u4ec5\u9700\u5256\u6790 5 \u6b21\u5de6\u53f3\u7684\u7f16\u8bd1\u5668\u8c03\u7528\u5c31\u80fd\u83b7\u5f97\u63a5\u8fd1\u6700\u4f73\u7684\u52a0\u901f\u6548\u679c\uff0c\u4e4b\u540e\u6536\u76ca\u9012\u51cf\u3002</li> </ul> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165\uff1a</li> <li>\u4e00\u4e2a\u4f1a\u53cd\u590d\u6267\u884c\u540c\u4e00\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u6279\u5904\u7406\u547d\u4ee4\uff08\u5982 <code>make -j</code>\uff09\u3002</li> <li>\u4e00\u4e2a\u6307\u5b9a\u76ee\u6807\u4f18\u5316\u4e8c\u8fdb\u5236\u7684\u914d\u7f6e\u6587\u4ef6\u3002</li> <li>\u8f93\u51fa\uff1a</li> <li>\u4e00\u4e2a\u900f\u660e\u52a0\u901f\u7684\u6279\u5904\u7406\u8fc7\u7a0b\uff0c\u7528\u6237\u611f\u77e5\u4e0d\u5230\u4efb\u4f55\u53d8\u5316\u3002</li> <li>\u4e00\u4e2a\u4e34\u65f6\u7684\u3001\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u7531 BAM \u5728\u540e\u53f0\u7ba1\u7406\uff09\u3002</li> <li>\u5728 OCOLOS \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528\uff1a</li> <li>\u4e92\u8865\u6a21\u5f0f\uff1aBAM \u662f OCOLOS \u4e3b\u6a21\u5f0f\uff08\u9488\u5bf9\u957f\u65f6\u3001\u5355\u8fdb\u7a0b\u670d\u52a1\uff09\u7684\u6709\u529b\u8865\u5145\uff0c\u5c06\u5728\u7ebf PGO \u7684\u4f18\u52bf\u6269\u5c55\u5230\u4e86\u77ed\u65f6\u3001\u591a\u8fdb\u7a0b\u7684\u573a\u666f\u3002</li> <li>\u96f6\u8fd0\u884c\u65f6\u5f00\u9500\uff1a\u4e0e\u4e3b\u6a21\u5f0f\u4e0d\u540c\uff0cBAM \u6ca1\u6709\u201cstop-the-world\u201d\u6682\u505c\uff0c\u56e0\u4e3a\u5b83\u4e0d\u4fee\u6539\u8fd0\u884c\u4e2d\u7684\u8fdb\u7a0b\uff0c\u800c\u662f\u901a\u8fc7 <code>exec</code> \u5207\u6362\u5230\u4e00\u4e2a\u5168\u65b0\u7684\u3001\u5df2\u4f18\u5316\u7684\u8fdb\u7a0b\u3002\u8fd9\u4f7f\u5f97\u5b83\u5bf9\u5c3e\u5ef6\u8fdf\u6ca1\u6709\u4efb\u4f55\u5f71\u54cd\u3002</li> <li>\u7b80\u5316\u90e8\u7f72\uff1aBAM \u7684 LD_PRELOAD \u8bbe\u8ba1\u4f7f\u5176\u90e8\u7f72\u6781\u5176\u7b80\u5355\uff0c\u7279\u522b\u9002\u5408\u96c6\u6210\u5230 CI/CD (Continuous Integration / Continuous Delivery) \u6d41\u7a0b\u4e2d\uff0c\u7528\u4e8e\u52a0\u901f\u6bcf\u65e5\u6784\u5efa\u7b49\u4efb\u52a1\u3002</li> </ul> <p></p> <p>Fig. 10: The running time of a Clang build with the original compiler, and compilers optimized by BOLT and BAM.</p> <p>\u4e0a\u56fe\u5c55\u793a\u4e86 BAM \u5728 Clang \u6784\u5efa\u4e2d\u7684\u5b9e\u9645\u6548\u679c\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u968f\u7740\u5256\u6790\u7684\u7f16\u8bd1\u5668\u6267\u884c\u6b21\u6570\u589e\u52a0\uff0cBAM \u80fd\u591f\u5c06\u6784\u5efa\u65f6\u95f4\u4ece\u539f\u59cb\u7684\u7ea6 1050 \u79d2\u964d\u4f4e\u5230\u7ea6 920 \u79d2\uff0c\u5b9e\u73b0\u4e86 1.14\u00d7 \u7684\u52a0\u901f\u3002\u540c\u65f6\uff0c\u56fe\u4e2d\u4e5f\u6e05\u6670\u5730\u663e\u793a\u4e86\u6536\u76ca\u9012\u51cf\u7684\u73b0\u8c61\uff1a\u5728\u5256\u6790\u7ea6 5 \u6b21\u540e\uff0c\u7ee7\u7eed\u589e\u52a0\u5256\u6790\u6b21\u6570\u53cd\u800c\u56e0\u4e3a\u7b49\u5f85\u65f6\u95f4\u8fc7\u957f\u800c\u5bfc\u81f4\u603b\u6784\u5efa\u65f6\u95f4\u56de\u5347\u3002</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#4","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u786c\u4ef6\u5e73\u53f0: \u5b9e\u9a8c\u5728\u4e00\u53f0\u53cc\u8def Intel Broadwell Xeon E5-2620v4 \u670d\u52a1\u5668\u4e0a\u8fdb\u884c\uff0c\u603b\u8ba1 16 \u6838 32 \u7ebf\u7a0b\uff0c\u4e3b\u9891 2.1GHz\u3002\u6bcf\u6838\u914d\u5907 32KiB L1i \u7f13\u5b58\u3002</li> <li>\u8f6f\u4ef6\u73af\u5883: \u8fd0\u884c Linux 4.18 \u5185\u6838\uff0c\u5e76\u4f7f\u7528 Lightning BOLT \u7cfb\u7edf\u7684\u7279\u5b9a\u63d0\u4ea4\u7248\u672c (88c70afe)\u3002</li> <li>\u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6:<ul> <li>MySQL 8.0.28\uff0c\u7531 Sysbench \u9a71\u52a8\uff0c\u5305\u542b\u591a\u79cd\u8d1f\u8f7d\uff08\u5982 read only, delete, write only\uff09\u3002</li> <li>MongoDB 6.0.0-alpha\uff0c\u7531 YCSB \u9a71\u52a8\u3002</li> <li>Memcached 1.6.12\uff0c\u7531 memaslap \u9a71\u52a8\u3002</li> <li>Verilator 3.904\uff0c\u4e00\u4e2a\u5355\u7ebf\u7a0b\u7684 RISC-V \u82af\u7247\u6a21\u62df\u5668\u3002</li> <li>Clang 14.0\uff0c\u7528\u4e8e\u8bc4\u4f30 BATCH ACCELERATOR MODE (BAM)\u3002</li> </ul> </li> <li>\u7f16\u8bd1\u9009\u9879: MySQL \u548c Verilator \u4f7f\u7528 <code>-O3</code>\uff0cMongoDB \u548c Memcached \u4f7f\u7528 <code>-O2</code>\u3002</li> <li>\u6d4b\u91cf\u65b9\u6cd5: \u6027\u80fd\u6570\u636e\u4e3a\u7a33\u6001\u6027\u80fd\uff08OCOLOS \u5728\u4ee3\u7801\u66ff\u6362\u5b8c\u6210\u540e\u6d4b\u91cf\uff09\uff0c\u9664\u975e\u53e6\u6709\u8bf4\u660e\u3002\u6240\u6709\u7ed3\u679c\u5747\u4e3a 5 \u6b21\u8fd0\u884c\u7684\u5e73\u5747\u503c\uff0c\u5e76\u9644\u5e26\u6807\u51c6\u5dee\u3002</li> </ul> <p>\u7ed3\u679c\u6570\u636e\u5206\u6790</p> <ul> <li>\u6838\u5fc3\u6027\u80fd\u63d0\u5347: OCOLOS \u5728\u591a\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u5b9e\u73b0\u4e86\u663e\u8457\u52a0\u901f\uff0c\u6700\u9ad8\u53ef\u8fbe 2.20\u00d7 (Verilator)\uff0c\u5728 MySQL read only \u8d1f\u8f7d\u4e0a\u8fbe\u5230 1.41\u00d7\u3002</li> <li>\u4e0e\u79bb\u7ebf PGO \u7684\u5bf9\u6bd4: <ul> <li>\u5c06 OCOLOS \u4e0e\u79bb\u7ebf BOLT \u7684\u201coracle input\u201d\uff08\u5373\u4f7f\u7528\u76f8\u540c\u8f93\u5165\u8fdb\u884c profiling \u548c\u8fd0\u884c\uff09\u7ed3\u679c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0 OCOLOS \u7684\u6027\u80fd\u975e\u5e38\u63a5\u8fd1\u4e0a\u9650\u3002\u5e73\u5747\u800c\u8a00\uff0cOCOLOS \u4ec5\u6bd4 BOLT oracle \u6162 4.6 \u4e2a\u767e\u5206\u70b9\u3002</li> <li>\u76f8\u6bd4\u4f7f\u7528\u805a\u5408\u4e86\u6240\u6709\u8f93\u5165\u7684\u201caverage-case\u201dprofile \u7684\u79bb\u7ebf BOLT\uff0cOCOLOS \u5e73\u5747\u5feb 8.9 \u4e2a\u767e\u5206\u70b9\uff0c\u8fd9\u51f8\u663e\u4e86\u5176\u5728\u7ebf profiling \u5e26\u6765\u7684 profile \u65b0\u9c9c\u5ea6\u4f18\u52bf\u3002</li> </ul> </li> <li>\u5fae\u67b6\u6784\u5c42\u9762\u7684\u5f71\u54cd: </li> </ul> <p></p> <p>Fig. 8: Microarchitectural events (per 1,000 instructions) for MySQL inputs</p> <ul> <li>\u5f02\u5e38\u60c5\u51b5: \u5728 MongoDB \u7684 <code>scan95 insert5</code> \u8d1f\u8f7d\u4e0b\uff0c\u5305\u62ec OCOLOS \u5728\u5185\u7684\u6240\u6709 PGO \u65b9\u6cd5\u90fd\u5bfc\u81f4\u4e86 14% \u7684\u6027\u80fd\u4e0b\u964d\u3002\u901a\u8fc7 Intel TopDown \u5206\u6790\u53d1\u73b0\uff0c\u8be5\u8d1f\u8f7d\u5728\u4f18\u5316\u540e\u4ece Front-End Bound \u8f6c\u53d8\u4e3a Back-End Bound\uff0c\u74f6\u9888\u8f6c\u79fb\u5230\u4e86\u5185\u5b58\u5b50\u7cfb\u7edf\uff0c\u8868\u660e PGO \u5e76\u975e\u4e07\u80fd\uff0c\u5176\u6548\u679c\u4f9d\u8d56\u4e8e\u5e94\u7528\u7684\u5b9e\u9645\u74f6\u9888\u3002</li> <li>\u5f00\u9500\u5206\u6790:<ul> <li>\u5185\u5b58\u5f00\u9500: OCOLOS \u5f15\u5165\u4e86\u9002\u5ea6\u7684\u5185\u5b58\u5f00\u9500\uff0c\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u65b0\u65e7\u4e24\u4efd\u4ee3\u7801\u3002\u5bf9\u4e8e MongoDB\uff0c\u5cf0\u503c\u5185\u5b58\u589e\u52a0\u7ea6 208 MiB\uff0c\u5176\u4ed6\u5e94\u7528\u5219\u66f4\u5c11\u3002</li> <li>\u7aef\u5230\u7aef\u6062\u590d\u65f6\u95f4: \u4ee5 MySQL read only \u4e3a\u4f8b\uff0c\u5728\u5b8c\u6210\u4ee3\u7801\u66ff\u6362\u540e\uff0cOCOLOS \u9700\u8981\u8fd0\u884c\u7ea6 30 \u79d2 \u624d\u80fd\u5f25\u8865\u5728\u4f18\u5316\u8fc7\u7a0b\u4e2d\u635f\u5931\u7684\u6027\u80fd\uff0c\u6b64\u540e\u4fbf\u5f00\u59cb\u83b7\u5f97\u51c0\u6536\u76ca\u3002</li> <li>\u5c3e\u90e8\u5ef6\u8fdf: \u5728\u4ee3\u7801\u66ff\u6362\u671f\u95f4\uff0cMySQL \u7684 95% \u5c3e\u90e8\u5ef6\u8fdf\u4ece 1.00ms \u6076\u5316\u5230\u6700\u5dee 1.55ms\uff0c\u4f46\u5728\u4f18\u5316\u540e\u6539\u5584\u81f3 0.73ms\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 7: Throughput of MySQL read only before, during, and after code replacement. 95% tail latency degrades from 1.00ms to at most 1.55ms during code replacement.</p> <p>\u4e0b\u8868\u603b\u7ed3\u4e86\u5404\u57fa\u51c6\u6d4b\u8bd5\u7684\u5173\u952e\u6027\u80fd\u6570\u636e\u548c\u5f00\u9500\uff1a</p> Benchmark (Input) OCOLOS Speedup vs. BOLT Oracle Memory Overhead (MiB) Pause Time (ms) MySQL (read only) 1.41\u00d7 -4.6% 42 669 MongoDB (read update) 1.29\u00d7 -5.3% 208 102 Memcached (set10 get90) 1.05\u00d7 -1.9% 1 12 Verilator (dhrystone) 2.20\u00d7 -1.8% 1 1 <p></p> <p>TABLE I: Benchmark characterization data</p> <p></p> <p>TABLE II: Fixed costs of code replacement</p> <p>\u6d88\u878d\u5b9e\u9a8c\u4e0e\u5173\u952e\u53c2\u6570\u5206\u6790</p> <ul> <li>Profiling \u65f6\u957f\u7684\u5f71\u54cd: \u5b9e\u9a8c\u8868\u660e\uff0c\u5373\u4f7f\u53ea\u6709 1 \u79d2 \u7684 profiling \u6570\u636e\uff0cOCOLOS \u4e5f\u80fd\u83b7\u5f97\u5927\u90e8\u5206\u6027\u80fd\u6536\u76ca\u3002\u5c11\u4e8e 100 \u6beb\u79d2 \u65f6\uff0cprofile \u8d28\u91cf\u6025\u5267\u4e0b\u964d\uff0c\u5bfc\u81f4\u4f18\u5316\u6548\u679c\u4e0d\u4f73\u3002\u8fd9\u8bc1\u660e\u4e86 OCOLOS \u5bf9\u77ed\u65f6\u3001\u9ad8\u8d28\u91cf profile \u7684\u9ad8\u6548\u5229\u7528\u80fd\u529b\u3002<ul> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 6: The impact of profile duration on speedup for MySQL read only</p> <ul> <li>BATCH ACCELERATOR MODE (BAM) \u7684\u6743\u8861: \u5728 Clang \u6784\u5efa\u4efb\u52a1\u4e2d\uff0cBAM \u7684\u6027\u80fd\u5b58\u5728\u4e00\u4e2a\u6700\u4f18\u5e73\u8861\u70b9\u3002<ul> <li>\u8fc7\u65e9\u5207\u6362\uff08\u5982\u53ea profiling 1 \u6b21\uff09\u80fd\u83b7\u5f97 1.09\u00d7 \u52a0\u901f\u3002</li> <li>\u6700\u4f73\u6027\u80fd\uff081.14\u00d7\uff09\u51fa\u73b0\u5728 profiling \u7ea6 5 \u6b21 \u7f16\u8bd1\u540e\u3002</li> <li>\u7ee7\u7eed\u589e\u52a0 profiling \u6b21\u6570\u4f1a\u5bfc\u81f4\u6536\u76ca\u9012\u51cf\uff0c\u56e0\u4e3a\u7b49\u5f85 profiling \u5b8c\u6210\u7684\u673a\u4f1a\u6210\u672c\u8d85\u8fc7\u4e86\u989d\u5916 profile \u6570\u636e\u5e26\u6765\u7684\u8fb9\u9645\u6548\u76ca\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 10: The running time of a Clang build with the original compiler, and compilers optimized by BOLT and BAM.</p> <ul> <li>Profile \u8d28\u91cf\u654f\u611f\u6027\u9a8c\u8bc1: \u901a\u8fc7\u4f7f\u7528\u4e0d\u540c\u8f93\u5165\u7684 profile \u6765\u4f18\u5316 MySQL\uff0c\u5b9e\u9a8c\u91cf\u5316\u4e86\u79bb\u7ebf PGO \u7684\u8f93\u5165\u654f\u611f\u6027\u95ee\u9898\u3002\u5f53\u4f7f\u7528 <code>insert</code> \u8f93\u5165\u7684 profile \u6765\u8fd0\u884c <code>read only</code> \u8d1f\u8f7d\u65f6\uff0c\u6027\u80fd\u6bd4\u4f7f\u7528\u5339\u914d\u7684 <code>read only</code> profile \u6162 21%\u3002\u800c OCOLOS \u7531\u4e8e\u5728\u7ebf profiling\uff0c\u59cb\u7ec8\u80fd\u83b7\u5f97\u4e0e\u5f53\u524d\u8d1f\u8f7d\u5339\u914d\u7684\u6700\u4f73\u6027\u80fd\u3002<ul> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 3: Performance achieved when running MySQL with the Sysbench read only input, using BOLT to produce a binary from the given profiling input or, with the all bar, from profiles of all inputs combined.</p> <ul> <li>\u5de5\u4f5c\u8d1f\u8f7d\u9002\u7528\u6027\u9884\u6d4b: \u7814\u7a76\u53d1\u73b0\uff0c\u7b80\u5355\u7684\u524d\u7aef\u6027\u80fd\u8ba1\u6570\u5668\uff08\u5982 L1i MPKI\uff09\u4e0e\u6700\u7ec8\u52a0\u901f\u6bd4\u7684\u76f8\u5173\u6027\u4e0d\u5f3a\u3002\u4f46\u4f7f\u7528 Intel TopDown \u65b9\u6cd5\u4e2d\u7684 Front-End Latency \u548c Retiring \u767e\u5206\u6bd4\uff0c\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u7ebf\u6027\u56de\u5f52\u51c6\u786e\u9884\u6d4b\u4e00\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u662f\u5426\u80fd\u4ece OCOLOS \u4e2d\u53d7\u76ca\u3002<ul> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 9: TopDown\u2019s [109] Front-end Latency and Retire percentages allow us to accurately classify which workloads will benefit from OCOLOS and which won\u2019t.</p>"},{"location":"notes_repo/ocolos-online-code-layout-optimizations/paper_notes/#-ocolos-l1i-mpki-l1-itlb-mpki-taken-branches","title":"- OCOLOS \u6210\u529f\u51cf\u5c11\u4e86\u524d\u7aef\u74f6\u9888\uff0c\u5177\u4f53\u8868\u73b0\u4e3a L1i MPKI (\u6bcf\u5343\u6761\u6307\u4ee4\u7684 L1 \u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d\u6570)\u3001iTLB MPKI \u548c taken branches (\u5df2\u6267\u884c\u5206\u652f) \u7684\u663e\u8457\u4e0b\u964d\u3002","text":""},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/ELI5_notes/","title":"Prodigy: Improving the Memory Latency of Data-Indirect Irregular Workloads Using Hardware-Software Co-Design \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 \u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 GHB-based prefetcher\uff09\u4f9d\u8d56\u4e8e\u5730\u5740\u7684\u7a7a\u95f4\u5c40\u90e8\u6027\u6216\u56fa\u5b9a\u6b65\u957f\uff0c\u4f46\u50cf\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u77e9\u9635\u8fd9\u7c7b\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\uff08irregular workloads\uff09\u7684\u5185\u5b58\u8bbf\u95ee\u662f\u201c\u8df3\u8dc3\u5f0f\u201d\u7684\uff0c\u5b8c\u5168\u65e0\u6cd5\u9884\u6d4b\uff0c\u5bfc\u81f4\u8fd9\u4e9b\u9884\u53d6\u5668\u57fa\u672c\u5931\u6548\u3002 - \u7eaf\u8f6f\u4ef6\u9884\u53d6\u867d\u7136\u77e5\u9053\u7a0b\u5e8f\u903b\u8f91\uff0c\u4f46\u5b83\u662f\u5728\u7f16\u8bd1\u65f6\u9759\u6001\u63d2\u5165\u6307\u4ee4\u7684\uff0c\u65e0\u6cd5\u611f\u77e5\u8fd0\u884c\u65f6 CPU \u7684\u5b9e\u9645\u6267\u884c\u901f\u5ea6\u3002\u5982\u679c CPU \u8dd1\u5f97\u5feb\uff0c\u9884\u53d6\u7684\u6570\u636e\u8fd8\u6ca1\u5230\uff1b\u5982\u679c CPU \u8dd1\u5f97\u6162\uff0c\u9884\u53d6\u7684\u6570\u636e\u65e9\u5c31\u88ab\u6324\u51fa\u7f13\u5b58\u4e86\uff0c\u9020\u6210\u7f13\u5b58\u6c61\u67d3\u3002\u8fd9\u5c31\u662f\u5178\u578b\u7684\u201c\u987e\u5934\u4e0d\u987e\u5c3e\u201d\u3002 - \u4e4b\u524d\u4e00\u4e9b\u9488\u5bf9\u56fe\u8ba1\u7b97\u7684\u4e13\u7528\u786c\u4ef6\u65b9\u6848\uff08\u5982 IMP, DROPLET\uff09\u8981\u4e48\u53ea\u80fd\u5904\u7406\u7b80\u5355\u7684\u6307\u9488\u8df3\u8f6c\uff08single-valued indirection\uff09\uff0c\u8981\u4e48\u53ea\u8986\u76d6\u90e8\u5206\u6570\u636e\u7ed3\u6784\uff0c\u65e0\u6cd5\u5e94\u5bf9\u66f4\u590d\u6742\u7684\u3001\u901a\u8fc7\u4e00\u4e2a\u6570\u7ec4\u7684\u4e24\u4e2a\u503c\u6765\u754c\u5b9a\u53e6\u4e00\u4e2a\u6570\u7ec4\u8bbf\u95ee\u8303\u56f4\u7684\u6a21\u5f0f\uff08ranged indirection\uff0c\u6bd4\u5982 CSR \u683c\u5f0f\u4e2d\u901a\u8fc7 offset \u6570\u7ec4\u627e edge \u6570\u7ec4\u7684\u4e00\u6bb5\u90bb\u5c45\uff09\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) \u60f3\u8c61\u4f60\u8981\u5728\u4e00\u4e2a\u5de8\u5927\u7684\u3001\u6742\u4e71\u65e0\u7ae0\u7684\u56fe\u4e66\u9986\u91cc\u627e\u4e66\u3002\u4f20\u7edf\u9884\u53d6\u5668\u5c31\u50cf\u4e00\u4e2a\u53ea\u4f1a\u6cbf\u7740\u4e66\u67b6\u4e00\u884c\u884c\u626b\u7684\u673a\u5668\u4eba\uff0c\u5bf9\u4f60\u8981\u627e\u7684\u4e66\u6beb\u65e0\u6982\u5ff5\u3002\u800c Prodigy \u5219\u50cf\u662f\u4f60\u7ed9\u4e86\u56fe\u4e66\u7ba1\u7406\u5458\u4e00\u5f20\u85cf\u5b9d\u56fe\uff08DIG\uff09\u3002\u8fd9\u5f20\u56fe\u4e0d\u662f\u544a\u8bc9\u4f60\u5177\u4f53\u54ea\u672c\u4e66\uff0c\u800c\u662f\u6e05\u6670\u5730\u753b\u51fa\u4e86\u201c\u5148\u53bb A \u533a\u57df\u62ff\u4e00\u5f20\u7d22\u5f15\u5361\uff0c\u7d22\u5f15\u5361\u4e0a\u5199\u7740\u8981\u53bb B \u533a\u57df\u7684\u7b2c X \u6392\uff1b\u5230\u4e86 B \u533a\u57df\uff0c\u4f60\u4f1a\u53d1\u73b0\u4e00\u6574\u6392\u4e66\uff08\u4ece Y \u5230 Z\uff09\u90fd\u662f\u4f60\u9700\u8981\u7684\u201d\u3002\u7ba1\u7406\u5458\uff08\u786c\u4ef6\u9884\u53d6\u5668\uff09\u62ff\u7740\u8fd9\u5f20\u56fe\uff0c\u5c31\u80fd\u5728\u4f60\u771f\u6b63\u8d70\u5230 A \u533a\u57df\u4e4b\u524d\uff0c\u5c31\u63d0\u524d\u628a B \u533a\u57df\u90a3\u6574\u6392\u4e66\u90fd\u642c\u5230\u4f60\u624b\u8fb9\u7684\u684c\u5b50\u4e0a\uff0c\u8ba9\u4f60\u968f\u7528\u968f\u53d6\u3002</p> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") \u4f5c\u8005\u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1a\u867d\u7136\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u7684\u8bbf\u95ee\u5730\u5740\u5343\u53d8\u4e07\u5316\uff0c\u4f46\u5176\u80cc\u540e\u7684\u6570\u636e\u7ed3\u6784\u904d\u5386\u6a21\u5f0f\u5374\u53ef\u4ee5\u88ab\u62bd\u8c61\u4e3a\u4e24\u79cd\u57fa\u672c\u64cd\u4f5c\u2014\u2014single-valued indirection \u548c ranged indirection\u3002\u4e8e\u662f\uff0c\u4ed6\u4eec\u6ca1\u6709\u8bd5\u56fe\u8ba9\u786c\u4ef6\u53bb\u201c\u5b66\u4e60\u201d\u590d\u6742\u7684\u5730\u5740\u6d41\uff0c\u800c\u662f\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u7cbe\u5de7\u7684\u8f6f\u786c\u534f\u540c\u6d41\u7a0b\uff1a</p> <ul> <li>\u7b2c\u4e00\u6b65\uff08\u8f6f\u4ef6\u4fa7\uff09\uff1a\u901a\u8fc7\u4e00\u4e2a LLVM \u7f16\u8bd1\u5668 Pass\uff0c\u81ea\u52a8\u5206\u6790\u6e90\u4ee3\u7801\uff0c\u5c06\u7a0b\u5e8f\u4e2d\u5173\u952e\u6570\u636e\u7ed3\u6784\uff08\u5982 CSR \u7684 offset \u548c edge \u6570\u7ec4\uff09\u53ca\u5176\u76f8\u4e92\u95f4\u7684\u8bbf\u95ee\u5173\u7cfb\uff0c\u7f16\u7801\u6210\u4e00\u4e2a\u6781\u5176\u7d27\u51d1\u7684\u6570\u636e\u95f4\u63a5\u56fe\uff08Data Indirection Graph, DIG\uff09\u3002\u8fd9\u4e2a DIG \u5c31\u662f\u4e0a\u9762\u63d0\u5230\u7684\u201c\u85cf\u5b9d\u56fe\u201d\u3002</li> <li>\u7b2c\u4e8c\u6b65\uff08\u786c\u4ef6\u4fa7\uff09\uff1a\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u8d85\u4f4e\u6210\u672c\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u5b83\u5185\u90e8\u6709\u4e13\u95e8\u7684\u5b58\u50a8\uff08\u603b\u5171\u53ea\u9700 0.8KB\uff09\u6765\u5b58\u653e\u8fd9\u4e2a DIG\u3002\u5f53 CPU \u53d1\u51fa\u4e00\u4e2a\u5bf9\u201c\u89e6\u53d1\u8282\u70b9\u201d\uff08\u5982 BFS \u7684 work queue\uff09\u7684\u8bf7\u6c42\u65f6\uff0c\u9884\u53d6\u5668\u5c31\u6839\u636e DIG \u4e0a\u7684\u6307\u5f15\uff0c\u7acb\u523b\u542f\u52a8\u4e00\u4e2a\u591a\u7ea7\u9884\u53d6\u94fe\u3002</li> <li>\u6700\u5173\u952e\u7684\u626d\u8f6c\uff1a\u8fd9\u4e2a\u786c\u4ef6\u9884\u53d6\u5668\u4e0d\u662f\u76f2\u76ee\u5730\u4e00\u8def\u9884\u53d6\u5230\u5e95\u3002\u5b83\u5f15\u5165\u4e86\u4e00\u4e2a\u53eb PFHR\uff08PreFetch status Handling Register\uff09\u7684\u7ed3\u6784\u6765\u8ddf\u8e2a\u6bcf\u4e2a\u9884\u53d6\u94fe\u7684\u72b6\u6001\uff0c\u5e76\u4e14\u80fd\u52a8\u6001\u611f\u77e5 CPU \u7684\u6267\u884c\u8fdb\u5ea6\u3002\u4e00\u65e6\u53d1\u73b0 CPU \u5df2\u7ecf\u5feb\u8981\u8ffd\u4e0a\u9884\u53d6\u5668\u4e86\uff0c\u5b83\u5c31\u4f1a\u679c\u65ad\u4e22\u5f03\u5f53\u524d\u8fd9\u6761\u53ef\u80fd\u6765\u4e0d\u53ca\u7528\u4e0a\u7684\u9884\u53d6\u94fe\uff0c\u8f6c\u800c\u53bb\u4e3a\u540e\u9762\u7684\u8bf7\u6c42\u9884\u53d6\uff0c\u4ece\u800c\u4fdd\u8bc1\u4e86\u9884\u53d6\u7684\u65f6\u6548\u6027\uff08timeliness\uff09\uff0c\u907f\u514d\u4e86\u7f13\u5b58\u6c61\u67d3\u3002</li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <p>\u6700\u7ec8\u6548\u679c\u5c31\u662f\uff0c\u901a\u8fc7\u8fd9\u79cd\u201c\u8f6f\u4ef6\u63d0\u4f9b\u8bed\u4e49\u5730\u56fe\uff0c\u786c\u4ef6\u52a8\u6001\u7cbe\u51c6\u5bfc\u822a\u201d\u7684\u65b9\u5f0f\uff0cProdigy \u4ee5\u6781\u4f4e\u7684\u786c\u4ef6\u5f00\u9500\uff080.8KB\uff09\uff0c\u5b9e\u73b0\u4e86\u5bf9\u590d\u6742\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u9ad8\u6548\u9884\u53d6\uff0c\u5728\u771f\u5b9e workload \u4e0a\u5e73\u5747\u83b7\u5f97\u4e86 2.6\u500d \u7684\u6027\u80fd\u63d0\u5347\u3002</p> \u5bf9\u6bd4\u65b9\u6848 \u5e73\u5747\u6027\u80fd\u63d0\u5347 (vs. \u65e0\u9884\u53d6) \u786c\u4ef6\u5b58\u50a8\u5f00\u9500 Prodigy (\u672c\u6587) 2.6\u00d7 0.8KB Ainsworth &amp; Jones [6] ~1.7\u00d7 ~1.6KB DROPLET [15] ~1.6\u00d7 ~7.8KB IMP [99] ~1.1\u00d7 ~1.1KB"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/ELI5_notes/#1-data-indirection-graph-dig-eli5","title":"1. Data Indirection Graph (DIG) (ELI5)","text":"<p>\u4e4b\u524d\u90a3\u4e9b\u901a\u7528\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u6bd4\u5982 GHB-based prefetcher\uff09\u5728\u5904\u7406\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u77e9\u9635\u8fd9\u7c7b\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u65f6\uff0c\u7b80\u76f4\u662f\u5728\u201c\u76f2\u4eba\u6478\u8c61\u201d\u3002</p> <ul> <li>\u5b83\u4eec\u4f9d\u8d56\u7a7a\u95f4\u5c40\u90e8\u6027\u6216\u7b80\u5355\u7684\u5730\u5740\u76f8\u5173\u6027\uff0c\u4f46\u50cf CSR \u683c\u5f0f\u7684\u56fe\uff0c\u5176\u8bbf\u95ee\u6a21\u5f0f\u662f data-dependent \u7684\uff1a\u4f60\u5f97\u5148\u8bfb <code>offset[i]</code> \u548c <code>offset[i+1]</code> \u8fd9\u4e24\u4e2a\u503c\uff0c\u624d\u80fd\u77e5\u9053\u63a5\u4e0b\u6765\u8981\u4e00\u53e3\u6c14\u8bfb <code>edge[offset[i]]</code> \u5230 <code>edge[offset[i+1]-1]</code> \u8fd9\u4e00\u6574\u6bb5\u6570\u636e\u3002</li> <li>\u4f20\u7edf\u7684\u9884\u53d6\u5668\u6839\u672c\u770b\u4e0d\u61c2\u8fd9\u79cd\u201c\u5148\u67e5\u8868\u518d\u51b3\u5b9a\u8bfb\u54ea\u201d\u7684\u903b\u8f91\u3002\u5b83\u4eec\u8981\u4e48\u5b8c\u5168\u5931\u6548\uff0c\u8981\u4e48\u53ea\u80fd\u778e\u731c\uff0c\u751a\u81f3\u56e0\u4e3a\u4e71\u9884\u53d6\u800c\u6c61\u67d3\u7f13\u5b58\uff0c\u8ba9\u6027\u80fd\u66f4\u5dee\u3002</li> <li>\u800c\u7eaf\u8f6f\u4ef6\u9884\u53d6\u5462\uff1f\u5b83\u867d\u7136\u77e5\u9053\u7a0b\u5e8f\u903b\u8f91\uff0c\u4f46\u5b83\u662f\u5728\u7f16\u8bd1\u65f6\u5c31\u63d2\u597d\u6307\u4ee4\u7684\u201c\u6b7b\u547d\u4ee4\u201d\uff0c\u65e0\u6cd5\u611f\u77e5\u8fd0\u884c\u65f6 CPU \u6267\u884c\u7684\u5feb\u6162\u3002\u5982\u679c CPU \u8dd1\u5f97\u6162\uff0c\u9884\u53d6\u7684\u6570\u636e\u65e9\u5c31\u88ab\u6324\u51fa\u7f13\u5b58\u4e86\uff1b\u5982\u679c CPU \u8dd1\u5f97\u5feb\uff0c\u9884\u53d6\u53c8\u8ddf\u4e0d\u4e0a\uff0c\u8fd8\u662f\u5f97\u7b49\u5185\u5b58\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9</p> <p>\u60f3\u8c61\u4f60\u8981\u5728\u4e00\u4e2a\u5de8\u5927\u7684\u3001\u6ca1\u6709\u76ee\u5f55\u7684\u56fe\u4e66\u9986\u91cc\u627e\u4e66\u3002\u4f60\u7684\u4efb\u52a1\u4e0d\u662f\u627e\u4e00\u672c\uff0c\u800c\u662f\u6267\u884c\u4e00\u4e2a\u590d\u6742\u7684\u67e5\u8be2\uff1a\u201c\u627e\u51fa\u4f5c\u8005A\u5199\u7684\u3001\u6240\u6709\u51fa\u7248\u5e74\u4efd\u5728B\u548cC\u4e4b\u95f4\u7684\u4e66\uff0c\u7136\u540e\u628a\u8fd9\u4e9b\u4e66\u7684\u7b2c\u4e00\u9875\u5185\u5bb9\u90fd\u590d\u5370\u4e00\u4efd\u201d\u3002</p> <ul> <li>\u4f20\u7edf\u9884\u53d6\u5668\u5c31\u50cf\u4e00\u4e2a\u53ea\u4f1a\u6309\u4e66\u67b6\u987a\u5e8f\u62ff\u4e66\u7684\u673a\u5668\u4eba\u3002\u5b83\u770b\u5230\u4f60\u62ff\u4e86\u4e66\u67b61\u7684\u4e66\uff0c\u5c31\u4ee5\u4e3a\u4f60\u4e0b\u4e00\u4e2a\u8981\u62ff\u4e66\u67b62\u7684\uff0c\u7ed3\u679c\u4f60\u5176\u5b9e\u8981\u53bb\u4e66\u67b61000\u67e5\u4f5c\u8005\u7d22\u5f15\u3002</li> <li>\u8f6f\u4ef6\u9884\u53d6\u5c31\u50cf\u4f60\u81ea\u5df1\u63d0\u524d\u5199\u597d\u4e86\u4e00\u5f20\u8d85\u957f\u7684\u5f85\u529e\u6e05\u5355\u3002\u4f46\u5982\u679c\u4f60\u4e2d\u9014\u88ab\u4eba\u6253\u65ad\uff08\u6bd4\u5982CPU\u6d41\u6c34\u7ebf\u505c\u987f\uff09\uff0c\u6e05\u5355\u5c31\u4f5c\u5e9f\u4e86\uff0c\u6216\u8005\u4f60\u6267\u884c\u5f97\u592a\u5feb\uff0c\u6e05\u5355\u8fd8\u6ca1\u5199\u5b8c\u3002</li> <li>Prodigy \u7684 DIG \u505a\u7684\u4e8b\u60c5\uff0c\u76f8\u5f53\u4e8e\u4f60\u7ed9\u4e86\u673a\u5668\u4eba\u4e00\u5f20\u6d41\u7a0b\u56fe\uff08\u5c31\u662f\u90a3\u4e2a Data Indirection Graph\uff09\u3002\u8fd9\u5f20\u56fe\u4e0a\u6e05\u6670\u5730\u753b\u7740\uff1a<ul> <li>\u7b2c\u4e00\u6b65\uff1a\u53bb\u201c\u4f5c\u8005\u7d22\u5f15\u533a\u201d\uff08<code>offset</code> \u6570\u7ec4\uff09\u627e\u5230\u4f5c\u8005A\u5bf9\u5e94\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u4f4d\u7f6e\u3002</li> <li>\u7b2c\u4e8c\u6b65\uff1a\u6839\u636e\u8fd9\u4e24\u4e2a\u4f4d\u7f6e\uff0c\u53bb\u201c\u56fe\u4e66\u6b63\u6587\u533a\u201d\uff08<code>edge</code> \u6570\u7ec4\uff09\u6279\u91cf\u62ff\u4e66\u3002</li> <li>\u7b2c\u4e09\u6b65\uff1a\u5bf9\u6bcf\u672c\u62ff\u5230\u7684\u4e66\uff0c\u518d\u53bb\u201c\u56fe\u4e66\u5c5e\u6027\u533a\u201d\uff08<code>visited</code> \u6570\u7ec4\uff09\u67e5\u4e00\u4e0b\u72b6\u6001\u3002</li> </ul> </li> </ul> <p>\u8fd9\u4e2a\u673a\u5668\u4eba\uff08\u786c\u4ef6\u9884\u53d6\u5668\uff09\u62ff\u7740\u8fd9\u5f20\u6d41\u7a0b\u56fe\uff0c\u5c31\u80fd\u5728\u4f60\u771f\u6b63\u8d70\u5230\u201c\u4f5c\u8005\u7d22\u5f15\u533a\u201d\u5e76\u5f00\u59cb\u67e5\u8be2\u65f6\uff0c\u7acb\u523b\u660e\u767d\u4f60\u4e0b\u4e00\u6b65\u3001\u4e0b\u4e0b\u4e00\u6b65\u8981\u5e72\u4ec0\u4e48\uff0c\u5e76\u63d0\u524d\u628a\u4e66\u642c\u5230\u4f60\u624b\u8fb9\u7684\u684c\u5b50\u4e0a\uff08L1 cache\uff09\u3002</p> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <p>\u5173\u952e\u4e00\u62db</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u8ba9\u786c\u4ef6\u53bb\u201c\u5b66\u4e60\u201d\u6216\u201c\u731c\u6d4b\u201d\u8fd9\u79cd\u590d\u6742\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u800c\u662f\u505a\u4e86\u4e00\u4e2a\u975e\u5e38\u806a\u660e\u7684\u804c\u8d23\u5206\u79bb\uff1a</p> <ul> <li>\u8f6f\u4ef6\uff08\u7f16\u8bd1\u5668\uff09\u8d1f\u8d23\u201c\u7ffb\u8bd1\u201d\uff1a\u5728\u7f16\u8bd1\u9636\u6bb5\uff0c\u901a\u8fc7\u9759\u6001\u5206\u6790\uff0c\u628a\u7a0b\u5e8f\u91cc\u90a3\u4e9b\u590d\u6742\u7684\u3001\u7531\u6570\u636e\u9a71\u52a8\u7684\u5185\u5b58\u8bbf\u95ee\u903b\u8f91\uff0c\u7ffb\u8bd1\u6210\u4e00\u79cd\u6781\u5176\u7d27\u51d1\u7684\u3001\u4e0e\u5177\u4f53\u6570\u636e\u683c\u5f0f\u65e0\u5173\u7684\u56fe\u7ed3\u6784\u2014\u2014DIG\u3002\u8fd9\u4e2a DIG \u53ea\u5305\u542b\u4e24\u7c7b\u6838\u5fc3\u4fe1\u606f\uff1a<ul> <li>\u8282\u70b9 (Node)\uff1a\u4ee3\u8868\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff08\u5982 <code>offset</code>, <code>edge</code>\uff09\uff0c\u8bb0\u5f55\u5176\u5185\u5b58\u5e03\u5c40\uff08\u57fa\u5730\u5740\u3001\u5927\u5c0f\u3001\u5143\u7d20\u5c3a\u5bf8\uff09\u3002</li> <li>\u8fb9 (Edge)\uff1a\u4ee3\u8868\u6570\u636e\u7ed3\u6784\u95f4\u7684\u8bbf\u95ee\u5173\u7cfb\uff0c\u660e\u786e\u6807\u6ce8\u662f single-valued indirection\uff08\u7528\u4e00\u4e2a\u503c\u53bb\u7d22\u5f15\uff0c\u5982 <code>visited[vertex_id]</code>\uff09\u8fd8\u662f ranged indirection\uff08\u7528\u4e00\u5bf9\u503c\u786e\u5b9a\u4e00\u4e2a\u8303\u56f4\uff0c\u5982 <code>edge[offset[i] ... offset[i+1]]</code>\uff09\u3002</li> </ul> </li> <li>\u786c\u4ef6\uff08\u9884\u53d6\u5668\uff09\u8d1f\u8d23\u201c\u6267\u884c\u201d\uff1a\u786c\u4ef6\u4e0d\u518d\u9700\u8981\u590d\u6742\u7684\u6a21\u5f0f\u8bc6\u522b\u7535\u8def\u3002\u5b83\u53ea\u9700\u8981\u4e00\u4e2a\u5f88\u5c0f\u7684\u672c\u5730\u5b58\u50a8\uff08\u4ec5 0.8KB\uff01\uff09\u6765\u5b58\u653e\u8fd9\u4e2a DIG\uff0c\u7136\u540e\u50cf\u4e00\u4e2a\u201c\u56fe\u904d\u5386\u5f15\u64ce\u201d\u4e00\u6837\u5de5\u4f5c\uff1a<ul> <li>\u5f53 CPU \u53d1\u51fa\u4e00\u4e2a\u5bf9\u201c\u89e6\u53d1\u8282\u70b9\u201d\uff08\u5982 BFS \u4e2d\u7684 <code>workQueue</code>\uff09\u7684\u8bf7\u6c42\u65f6\uff0c\u786c\u4ef6\u5c31\u77e5\u9053\u4e00\u4e2a\u9884\u53d6\u5e8f\u5217\u5f00\u59cb\u4e86\u3002</li> <li>\u5b83\u6839\u636e DIG \u4e2d\u7684\u8fb9\uff0c\u52a8\u6001\u5730\u3001\u4e00\u6b65\u6b65\u5730\u751f\u6210\u540e\u7eed\u7684\u9884\u53d6\u5730\u5740\u3002\u5bf9\u4e8e ranged indirection\uff0c\u5b83\u751a\u81f3\u80fd\u4e00\u6b21\u6027\u53d1\u51fa\u5bf9\u6574\u4e2a\u8303\u56f4\u7684\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>\u6700\u5173\u952e\u7684\u662f\uff0c\u5b83\u5f15\u5165\u4e86 PFHR (PreFetch status Handling Register) \u6587\u4ef6\u6765\u8ddf\u8e2a\u591a\u4e2a\u5e76\u884c\u7684\u9884\u53d6\u5e8f\u5217\uff0c\u5e76\u80fd\u6839\u636e CPU \u7684\u5b9e\u9645\u6267\u884c\u8fdb\u5ea6\uff08\u901a\u8fc7\u76d1\u542c load \u8bf7\u6c42\uff09\u52a8\u6001\u4e22\u5f03\u90a3\u4e9b\u5df2\u7ecf\u6ca1\u7528\u7684\u3001\u8fc7\u65f6\u7684\u9884\u53d6\uff0c\u4fdd\u8bc1\u9884\u53d6\u7684\u201c\u65f6\u6548\u6027\u201d\u3002</li> </ul> </li> </ul> <p>\u8fd9\u4e00\u62db\u7684\u6838\u5fc3\u626d\u8f6c\u5728\u4e8e\uff1a\u628a\u201c\u7406\u89e3\u8bed\u4e49\u201d\u7684\u91cd\u62c5\u4ea4\u7ed9\u4e86\u79bb\u6e90\u7801\u6700\u8fd1\u3001\u6700\u61c2\u903b\u8f91\u7684\u7f16\u8bd1\u5668\uff0c\u800c\u628a\u201c\u9ad8\u6548\u6267\u884c\u201d\u7684\u4efb\u52a1\u7559\u7ed9\u4e86\u786c\u4ef6\u3002\u4e24\u8005\u901a\u8fc7 DIG \u8fd9\u4e2a\u7cbe\u5de7\u7684\u201c\u5951\u7ea6\u201d\u8fdb\u884c\u6c9f\u901a\uff0c\u5b9e\u73b0\u4e86\u201c1+1\u8fdc\u5927\u4e8e2\u201d\u7684\u6548\u679c\u3002</p>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/ELI5_notes/#2-eli5","title":"2. \u7f16\u8bd1\u5668\u81ea\u52a8\u5206\u6790\u4e0e\u4ee3\u7801\u751f\u6210 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4ee5\u524d\u5904\u7406\u50cf\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u77e9\u9635\u8fd9\u7c7b irregular workloads \u65f6\uff0c\u786c\u4ef6 prefetcher \u51e0\u4e4e\u662f\u778e\u5b50\u3002\u56e0\u4e3a\u5b83\u4eec\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u4e0d\u662f\u7b80\u5355\u7684\u6b65\u957f\u6216\u6d41\u5f0f\uff0c\u800c\u662f\u7531\u6570\u636e\u5185\u5bb9\u51b3\u5b9a\u7684\uff08data-dependent\uff09\uff0c\u6bd4\u5982 <code>A[B[i]]</code> \u8fd9\u79cd\u95f4\u63a5\u5bfb\u5740\u3002 - \u7a0b\u5e8f\u5458\u53ef\u4ee5\u624b\u52a8\u52a0\u6ce8\u89e3\u544a\u8bc9\u786c\u4ef6\u600e\u4e48\u9884\u53d6\uff08\u5c31\u50cf\u8bba\u6587\u91cc\u63d0\u5230\u7684 <code>registerNode()</code> \u90a3\u4e00\u5957 API\uff09\uff0c\u4f46\u8fd9\u6d3b\u513f\u53c8\u810f\u53c8\u7d2f\uff0c\u8fd8\u5bb9\u6613\u51fa\u9519\u3002\u4f60\u5f97\u5bf9\u7b97\u6cd5\u548c\u6570\u636e\u7ed3\u6784\u6709\u975e\u5e38\u6df1\u7684\u7406\u89e3\uff0c\u624d\u80fd\u51c6\u786e\u5730\u628a\u90a3\u4e9b\u590d\u6742\u7684\u904d\u5386\u5173\u7cfb\u63cf\u8ff0\u6e05\u695a\u3002 - \u6240\u4ee5\u95ee\u9898\u5c31\u5361\u5728\u8fd9\u513f\u4e86\uff1a\u7406\u60f3\u5f88\u4e30\u6ee1\uff08\u7528\u8bed\u4e49\u4fe1\u606f\u6307\u5bfc\u9884\u53d6\u6548\u679c\u6781\u4f73\uff09\uff0c\u4f46\u73b0\u5b9e\u5f88\u9aa8\u611f\uff08\u6ca1\u4eba\u613f\u610f/\u80fd\u5e72\u597d\u8fd9\u4e2a\u4f53\u529b\u6d3b\uff09\u3002\u8fd9\u5c31\u5bfc\u81f4\u518d\u597d\u7684\u786c\u4ef6\u8bbe\u8ba1\u4e5f\u96be\u4ee5\u63a8\u5e7f\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u8981\u7ed9\u4e00\u4e2a\u5b8c\u5168\u6ca1\u89c1\u8fc7\u4e50\u9ad8\u7684\u65b0\u624b\uff08\u786c\u4ef6 prefetcher\uff09\u4e00\u5957\u56fe\u7eb8\uff08DIG\uff09\uff0c\u8ba9\u4ed6\u80fd\u63d0\u524d\u628a\u4e0b\u4e00\u5757\u8981\u7528\u7684\u79ef\u6728\uff08\u6570\u636e\uff09\u627e\u51fa\u6765\u3002\u6700\u7b28\u7684\u529e\u6cd5\u662f\u4f60\uff08\u7a0b\u5e8f\u5458\uff09\u81ea\u5df1\u5bf9\u7167\u7740\u8bf4\u660e\u4e66\uff0c\u624b\u52a8\u753b\u4e00\u5f20\u65b0\u56fe\u7eb8\u7ed9\u4ed6\u3002 - \u800c Prodigy \u7684\u505a\u6cd5\u662f\uff0c\u76f4\u63a5\u7ed9\u4e86\u4ed6\u4e00\u4e2a\u667a\u80fd\u626b\u63cf\u4eea\uff08compiler pass\uff09\u3002\u8fd9\u4e2a\u626b\u63cf\u4eea\u80fd\u81ea\u52a8\u8bfb\u53d6\u539f\u59cb\u7684\u4e50\u9ad8\u8bf4\u660e\u4e66\uff08\u6e90\u4ee3\u7801\uff09\uff0c\u7406\u89e3\u91cc\u9762\u7684\u62fc\u88c5\u903b\u8f91\uff08\u6bd4\u5982\u201c\u5148\u627e\u5230\u7ea2\u8272\u5e95\u5ea7\uff0c\u7136\u540e\u5728\u5b83\u7684\u7b2c3\u4e2a\u63a5\u53e3\u4e0a\u63d2\u4e00\u4e2a\u84dd\u8272\u6a2a\u6881\u201d\uff09\uff0c\u5e76\u81ea\u52a8\u751f\u6210\u4e00\u4efd\u65b0\u624b\u80fd\u770b\u61c2\u7684\u3001\u6e05\u6670\u7684\u884c\u52a8\u6307\u5357\uff08DIG\uff09\u3002\u4f60\u5b8c\u5168\u4e0d\u7528\u52a8\u624b\uff0c\u673a\u5668\u5c31\u66ff\u4f60\u5b8c\u6210\u4e86\u4ece\u201c\u4eba\u7c7b\u77e5\u8bc6\u201d\u5230\u201c\u673a\u5668\u6307\u4ee4\u201d\u7684\u7ffb\u8bd1\u3002</p> <p>\u5173\u952e\u4e00\u62db \u4f5c\u8005\u5e76\u6ca1\u6709\u8981\u6c42\u7a0b\u5e8f\u5458\u505a\u989d\u5916\u5de5\u4f5c\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728 LLVM \u7f16\u8bd1\u6d41\u7a0b\u4e2d\u63d2\u5165\u4e86\u4e00\u4e2a\u5206\u6790\u5668\u3002\u8fd9\u4e2a\u5206\u6790\u5668\u5e72\u4e86\u4e24\u4ef6\u6838\u5fc3\u7684\u4e8b\uff1a</p> <ul> <li>\u9759\u6001\u201c\u4fa6\u63a2\u201d\u5de5\u4f5c\uff1a</li> <li>\u5b83\u9996\u5148\u626b\u63cf\u4ee3\u7801\u4e2d\u7684\u5185\u5b58\u5206\u914d\u70b9\uff08\u5982 <code>malloc</code>\uff09\uff0c\u628a\u8fd9\u4e9b\u5f53\u4f5c\u6f5c\u5728\u7684 DIG Node \u5019\u9009\uff0c\u5e76\u8bb0\u5f55\u4e0b\u5b83\u4eec\u7684\u57fa\u5730\u5740\u3001\u5927\u5c0f\u7b49\u5e03\u5c40\u4fe1\u606f\u3002</li> <li> <p>\u63a5\u7740\uff0c\u5b83\u8ffd\u8e2a\u8fd9\u4e9b\u5206\u914d\u51fa\u6765\u7684\u5185\u5b58\u662f\u5982\u4f55\u88ab\u4f7f\u7528\u7684\u3002\u5b83\u4f1a\u7279\u522b\u5173\u6ce8\u90a3\u4e9b\u5d4c\u5957\u7684\u6570\u7ec4\u8bbf\u95ee\u6a21\u5f0f\uff0c\u6bd4\u5982 <code>b[a[i]]</code>\u3002\u901a\u8fc7\u5206\u6790 LLVM IR \u4e2d\u7684\u5730\u5740\u8ba1\u7b97\uff08<code>AddrCalc</code>\uff09\u548c\u52a0\u8f7d\uff08<code>Load</code>\uff09\u6307\u4ee4\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u5b83\u80fd\u81ea\u52a8\u8bc6\u522b\u51fa\u4e24\u79cd\u5173\u952e\u6a21\u5f0f\uff1a</p> <ul> <li>Single-valued indirection: <code>a[i]</code> \u7684\u7ed3\u679c\u76f4\u63a5\u4f5c\u4e3a <code>b</code> \u7684\u7d22\u5f15\u3002</li> <li>Ranged indirection: <code>a[i]</code> \u548c <code>a[i+1]</code> \u7684\u7ed3\u679c\u5171\u540c\u51b3\u5b9a\u4e86 <code>b</code> \u4e2d\u4e00\u4e2a\u8fde\u7eed\u533a\u95f4\u7684\u8bbf\u95ee\u8303\u56f4\uff08\u8fd9\u6b63\u662f CSR \u683c\u5f0f\u7684\u6838\u5fc3\uff09\u3002</li> </ul> </li> <li> <p>\u81ea\u52a8\u5316\u201c\u7ffb\u8bd1\u201d\u5de5\u4f5c\uff1a</p> </li> <li>\u4e00\u65e6\u8bc6\u522b\u51fa\u8fd9\u4e9b\u6a21\u5f0f\u548c\u76f8\u5173\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7f16\u8bd1\u5668 pass \u5c31\u4f1a\u81ea\u52a8\u5728\u4e8c\u8fdb\u5236\u4ee3\u7801\u4e2d\u63d2\u5165\u5bf9 Prodigy API \u7684\u8c03\u7528\uff08\u5982 <code>registerNode</code>, <code>registerTravEdge</code>\uff09\u3002</li> <li>\u8fd9\u4e9b API \u8c03\u7528\u4f1a\u5728\u7a0b\u5e8f\u8fd0\u884c\u521d\u671f\u88ab\u6267\u884c\uff0c\u4ece\u800c\u52a8\u6001\u5730\u5728\u786c\u4ef6\u4e0a\u6784\u5efa\u51fa\u5b8c\u6574\u7684 Data Indirection Graph (DIG)\u3002\u8fd9\u6837\uff0c\u786c\u4ef6 prefetcher \u5728\u7a0b\u5e8f\u771f\u6b63\u5f00\u59cb\u5bc6\u96c6\u8ba1\u7b97\u524d\uff0c\u5c31\u5df2\u7ecf\u201c\u80f8\u6709\u6210\u7af9\u201d\uff0c\u77e5\u9053\u4e86\u6574\u4e2a\u6570\u636e\u904d\u5386\u7684\u8def\u7ebf\u56fe\u3002</li> </ul> <p></p> <p>Figure 7. An example C program (a) and (b), translated into LLVM IR (c) and instrumented with our API calls to register DIG nodes and edges. Figure 8. Pseudocode of Prodigy\u2019s compiler analyses for (a) node identification, (b) single-valued indirection, (c) ranged indirection, and (d) runtime.</p> <p></p> <p>Figure 12. Design space exploration on the PFHR file size. Performance of each configuration is normalized to 4 entries.</p> <p>\u8fd9\u4e2a\u8bbe\u8ba1\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u628a\u4e00\u4e2a\u9ad8\u5ea6\u4f9d\u8d56\u9886\u57df\u77e5\u8bc6\u7684\u3001\u6613\u9519\u7684\u624b\u52a8\u8fc7\u7a0b\uff0c\u8f6c\u5316\u6210\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u3001\u81ea\u52a8\u5316\u7684\u7f16\u8bd1\u671f\u5206\u6790\u4efb\u52a1\u3002\u8fd9\u6781\u5927\u5730\u964d\u4f4e\u4e86\u4f7f\u7528\u95e8\u69db\uff0c\u8ba9 Prodigy \u7684\u5f3a\u5927\u80fd\u529b\u53ef\u4ee5\u88ab\u5e7f\u6cdb\u5e94\u7528\uff0c\u800c\u4e0d\u4ec5\u4ec5\u5c40\u9650\u4e8e\u5c11\u6570\u4e13\u5bb6\u4f18\u5316\u7684\u573a\u666f\u3002</p>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/ELI5_notes/#3-dig-eli5","title":"3. \u57fa\u4e8eDIG\u7684\u4f4e\u5f00\u9500\u786c\u4ef6\u9884\u53d6\u5668 (ELI5)","text":"<p>\u4e4b\u524d\u90a3\u4e9b\u901a\u7528\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u6bd4\u5982 GHB-based prefetcher\uff09\u5728\u5904\u7406\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u77e9\u9635\u8fd9\u7c7b\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u65f6\uff0c\u7b80\u76f4\u662f\u5728\u201c\u76f2\u4eba\u6478\u8c61\u201d\u3002\u5b83\u4eec\u4f9d\u8d56\u5730\u5740\u95f4\u7684\u7a7a\u95f4\u6216\u65f6\u95f4\u5c40\u90e8\u6027\u6765\u9884\u6d4b\u4e0b\u4e00\u4e2a\u8981\u8bbf\u95ee\u7684\u5730\u5740\uff0c\u4f46\u50cf CSR \u683c\u5f0f\u7684\u56fe\u904d\u5386\uff0c\u5176\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u662f\u7531\u6570\u636e\u5185\u5bb9\u52a8\u6001\u51b3\u5b9a\u7684\u2014\u2014\u4eca\u5929\u8bbf\u95ee\u54ea\u4e2a\u90bb\u5c45\uff0c\u5b8c\u5168\u53d6\u51b3\u4e8e\u5f53\u524d\u9876\u70b9\u5728 <code>offset</code> \u6570\u7ec4\u91cc\u7684\u503c\u3002\u8fd9\u79cd\u6570\u636e\u4f9d\u8d56\u7684\u95f4\u63a5\u5bfb\u5740\uff08data-dependent indirection\uff09\u8ba9\u4f20\u7edf\u9884\u53d6\u5668\u5f7b\u5e95\u5931\u6548\uff0c\u5bfc\u81f4 CPU \u88ab DRAM stalls \u62d6\u57ae\uff0c\u6027\u80fd\u74f6\u9888\u6781\u5176\u4e25\u91cd\u3002</p> <p>\u60f3\u8c61\u4e00\u4e0b\uff0c\u4f60\u8981\u5728\u4e00\u4e2a\u5de8\u5927\u7684\u3001\u6ca1\u6709\u76ee\u5f55\u7684\u56fe\u4e66\u9986\u91cc\u627e\u4e66\u3002\u4f20\u7edf\u9884\u53d6\u5668\u5c31\u50cf\u4e00\u4e2a\u53ea\u4f1a\u6309\u4e66\u67b6\u987a\u5e8f\u4e00\u672c\u672c\u62ff\u4e66\u7684\u52a9\u624b\uff0c\u6548\u7387\u6781\u4f4e\u3002\u800c Prodigy \u7684\u505a\u6cd5\u662f\uff1a\u5728\u4f60\u5f00\u59cb\u627e\u4e66\u524d\uff0c\u5148\u7ed9\u4f60\u4e00\u5f20\u85cf\u5b9d\u56fe\uff08DIG\uff09\u3002\u8fd9\u5f20\u56fe\u4e0d\u662f\u544a\u8bc9\u4f60\u5177\u4f53\u54ea\u672c\u4e66\u5728\u54ea\uff0c\u800c\u662f\u6e05\u6670\u5730\u6807\u51fa\u4e86\u201c\u533a\u57dfA\u7684\u5361\u7247\u80fd\u6307\u5f15\u4f60\u53bb\u533a\u57dfB\u7684\u4e00\u6bb5\u4e66\u67b6\uff0c\u800c\u533a\u57dfB\u6bcf\u672c\u4e66\u7684\u9644\u5f55\u53c8\u80fd\u5e26\u4f60\u53bb\u533a\u57dfC\u7684\u67d0\u672c\u4e66\u201d\u8fd9\u6837\u7684\u903b\u8f91\u5173\u7cfb\u3002\u786c\u4ef6\u9884\u53d6\u5668\u62ff\u5230\u8fd9\u5f20\u56fe\u540e\uff0c\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u806a\u660e\u7684\u5411\u5bfc\uff1a\u5b83\u770b\u5230\u4f60\u62ff\u5230\u4e86\u533a\u57dfA\u7684\u4e00\u5f20\u5361\u7247\uff08demand access\uff09\uff0c\u7acb\u523b\u5c31\u80fd\u6839\u636e\u85cf\u5b9d\u56fe\uff0c\u63d0\u524d\u628a\u533a\u57dfB\u5bf9\u5e94\u4e66\u67b6\u4e0a\u7684\u4e00\u6574\u6392\u4e66\uff08ranged indirection\uff09\u90fd\u642c\u5230\u4f60\u7684\u684c\u8fb9\uff1b\u7b49\u4f60\u7ffb\u5230\u5176\u4e2d\u4e00\u672c\u4e66\u7684\u9644\u5f55\u65f6\uff0c\u5b83\u53c8\u5df2\u7ecf\u628a\u533a\u57dfC\u90a3\u672c\u6307\u5b9a\u7684\u4e66\uff08single-valued indirection\uff09\u51c6\u5907\u597d\u4e86\u3002\u6574\u4e2a\u8fc7\u7a0b\u6d41\u7545\u4e14\u7cbe\u51c6\uff0c\u56e0\u4e3a\u5b83\u77e5\u9053\u7684\u662f\u201c\u89c4\u5219\u201d\uff0c\u800c\u4e0d\u662f\u6b7b\u8bb0\u786c\u80cc\u201c\u5730\u5740\u201d\u3002</p> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <p>\u4f5c\u8005\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u5173\u952e\u4e00\u62db\uff0c\u5728\u4e8e\u5c06\u8f6f\u4ef6\u7684\u9759\u6001\u8bed\u4e49\u77e5\u8bc6\u4e0e\u786c\u4ef6\u7684\u52a8\u6001\u6267\u884c\u4fe1\u606f\u5b8c\u7f8e\u6865\u63a5\uff0c\u5e76\u4e14\u7528\u4e00\u79cd\u6781\u5ea6\u7d27\u51d1\u7684\u65b9\u5f0f\u7f16\u7801\u3002</p> <ul> <li>\u4ed6\u4eec\u6ca1\u6709\u8bd5\u56fe\u5728\u786c\u4ef6\u91cc\u7528\u590d\u6742\u7684\u6a21\u5f0f\u8bc6\u522b\u7535\u8def\u53bb\u201c\u5b66\u4e60\u201d\u8fd9\u4e9b\u4e0d\u89c4\u5219\u6a21\u5f0f\uff08\u90a3\u6837\u6210\u672c\u592a\u9ad8\uff09\uff0c\u800c\u662f\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u53eb Data Indirection Graph (DIG) \u7684\u4e2d\u95f4\u8868\u793a\u3002</li> <li>\u8fd9\u4e2a DIG \u7531\u7f16\u8bd1\u5668\u5728\u7f16\u8bd1\u671f\u81ea\u52a8\u5206\u6790\u6e90\u4ee3\u7801\u751f\u6210\uff08\u4e5f\u53ef\u4ee5\u624b\u52a8\u6807\u6ce8\uff09\uff0c\u5b83\u53ea\u5e72\u4e00\u4ef6\u4e8b\uff1a\u7528\u4e00\u4e2a\u5e26\u6743\u91cd\u7684\u6709\u5411\u56fe\u6765\u62bd\u8c61\u7a0b\u5e8f\u4e2d\u5173\u952e\u6570\u636e\u7ed3\u6784\u4e4b\u95f4\u7684\u4e24\u79cd\u6838\u5fc3\u95f4\u63a5\u8bbf\u95ee\u5173\u7cfb\uff1a</li> <li>Single-valued indirection (w0)\uff1a\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u91cc\u7684\u503c\u4f5c\u4e3a\u7d22\u5f15\uff0c\u53bb\u8bbf\u95ee\u53e6\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u91cc\u7684\u5355\u4e2a\u5143\u7d20\uff08\u5982\u7528\u9876\u70b9ID\u67e5\u5c5e\u6027\uff09\u3002</li> <li>Ranged indirection (w1)\uff1a\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u91cc\u7684\u4e00\u5bf9\u503c\uff08base, bound\uff09\u5b9a\u4e49\u4e86\u5bf9\u53e6\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u4e00\u6bb5\u8fde\u7eed\u8bbf\u95ee\u8303\u56f4\uff08\u5982\u7528offset\u6570\u7ec4\u67e5\u90bb\u5c45\u5217\u8868\uff09\u3002</li> <li>\u8fd9\u4e2a DIG \u88ab\u7f16\u7801\u540e\uff0c\u4ec5\u9700 0.8KB \u7684\u5b58\u50a8\u7a7a\u95f4\u5c31\u80fd\u653e\u8fdb\u786c\u4ef6\u3002\u786c\u4ef6\u9884\u53d6\u5668\u5728\u8fd0\u884c\u65f6\uff0c\u901a\u8fc7\u76d1\u542c L1D cache \u7684\u8bf7\u6c42\uff0c\u4e00\u65e6\u53d1\u73b0\u5bf9\u201c\u89e6\u53d1\u8282\u70b9\u201d\uff08trigger edge\uff09\u7684\u8bbf\u95ee\uff0c\u5c31\u7acb\u523b\u542f\u52a8\u9884\u53d6\u3002</li> <li>\u9884\u53d6\u5668\u4f1a\u6839\u636e DIG \u4e2d\u7684\u8fb9\uff08edge\uff09\u7c7b\u578b\uff0c\u52a8\u6001\u5730\u89e3\u6790\u521a\u9884\u53d6\u56de\u6765\u7684\u6570\u636e\uff0c\u5e76\u636e\u6b64\u8ba1\u7b97\u51fa\u4e0b\u4e00\u6279\u8981\u9884\u53d6\u7684\u5730\u5740\u3002\u4e3a\u4e86\u4fdd\u8bc1\u9884\u53d6\u7684\u201c\u53ca\u65f6\u6027\u201d\uff08timeliness\uff09\uff0c\u5b83\u8fd8\u5f15\u5165\u4e86 PFHR (PreFetch status Handling Register) \u6587\u4ef6\u6765\u8ddf\u8e2a\u591a\u4e2a\u5e76\u884c\u7684\u9884\u53d6\u5e8f\u5217\uff0c\u5e76\u80fd\u5728 CPU \u8ffd\u4e0a\u9884\u53d6\u8fdb\u5ea6\u65f6\u679c\u65ad\u4e22\u5f03\u8fc7\u65f6\u7684\u5e8f\u5217\uff0c\u907f\u514d\u6c61\u67d3\u7f13\u5b58\u3002</li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <p>\u6700\u7ec8\u6548\u679c\u5c31\u662f\uff0c\u8fd9\u4e2a\u57fa\u4e8e DIG \u7684\u9884\u53d6\u5668\uff0c\u4ee5\u51e0\u4e4e\u53ef\u4ee5\u5ffd\u7565\u7684\u786c\u4ef6\u5f00\u9500\uff080.8KB\uff09\uff0c\u5b9e\u73b0\u4e86\u5bf9\u590d\u6742\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u7cbe\u51c6\u9884\u5224\uff0c\u4ece\u800c\u5c06\u5e73\u5747\u6027\u80fd\u63d0\u5347\u4e86 2.6\u500d\uff0c\u5e76\u8282\u7701\u4e86 1.6\u500d \u7684\u80fd\u8017\u3002</p>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/ELI5_notes/#4-pfhr-eli5","title":"4. \u9884\u53d6\u72b6\u6001\u5904\u7406\u5bc4\u5b58\u5668\u6587\u4ef6 (PFHR) (ELI5)","text":"<p>\u4e4b\u524d\u505a\u786c\u4ef6\u9884\u53d6\uff08Hardware Prefetching\uff09\u5904\u7406\u50cf\u56fe\u8ba1\u7b97\u8fd9\u79cd\u4e0d\u89c4\u5219\u8d1f\u8f7d\u65f6\uff0c\u6709\u4e2a\u7279\u522b\u96be\u53d7\u7684\u5730\u65b9\uff1a\u9884\u53d6\u5668\u4e00\u65e6\u542f\u52a8\u4e00\u4e2a\u590d\u6742\u7684\u3001\u8de8\u591a\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u9884\u53d6\u94fe\uff08\u6bd4\u5982\u4ece work queue -&gt; offset list -&gt; edge list -&gt; visited list\uff09\uff0c\u5c31\u5fc5\u987b\u50bb\u4e4e\u4e4e\u5730\u7b49\u8fd9\u6761\u94fe\u4e0a\u6240\u6709\u8bf7\u6c42\u90fd\u5b8c\u6210\u624d\u80fd\u5e72\u4e0b\u4e00\u4ef6\u4e8b\u3002\u8fd9\u5c31\u50cf\u4f60\u6d3e\u4e86\u4e00\u4e2a\u5feb\u9012\u5458\u53bb\u5e2e\u4f60\u4e70\u5496\u5561\uff0c\u4f46\u4ed6\u5fc5\u987b\u5148\u53bb\u8d85\u5e02\u4e70\u5496\u5561\u8c46\uff0c\u518d\u53bb\u78e8\u574a\u78e8\u7c89\uff0c\u6700\u540e\u624d\u53bb\u5496\u5561\u673a\u51b2\u6ce1\u2014\u2014\u5728\u8fd9\u6574\u4e2a\u6f2b\u957f\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4ed6\u88ab\u201c\u963b\u585e\u201d\u4e86\uff0c\u6ca1\u6cd5\u63a5\u65b0\u6d3b\u3002\u66f4\u8981\u547d\u7684\u662f\uff0c\u5982\u679c\u4f60\u81ea\u5df1\u8d70\u8def\u6bd4\u4ed6\u9a91\u8f66\u8fd8\u5feb\uff0c\u7b49\u4ed6\u628a\u5496\u5561\u9001\u5230\u65f6\uff0c\u4f60\u65e9\u5c31\u559d\u5b8c\u6c34\u8d70\u4eba\u4e86\uff0c\u8fd9\u676f\u5496\u5561\u5c31\u6210\u4e86\u8fc7\u65f6\u7684\u5783\u573e\uff0c\u767d\u767d\u5360\u7740\u4f60\u7684\u80cc\u5305\uff08Cache\uff09\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u9884\u53d6\u65f6\u6548\u6027\uff08Prefetch Timeliness\uff09\u95ee\u9898\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 \u4f60\u53ef\u4ee5\u628a PFHR\uff08PreFetch status Handling Register\uff09\u6587\u4ef6\u60f3\u8c61\u6210\u4e00\u4e2a\u667a\u80fd\u5916\u5356\u8c03\u5ea6\u4e2d\u5fc3\u7684\u770b\u677f\u3002\u4ee5\u524d\u7684\u9884\u53d6\u5668\u53ea\u6709\u4e00\u4e2a\u8111\u5b50\uff0c\u8bb0\u4e0d\u4f4f\u591a\u4ef6\u4e8b\u3002\u73b0\u5728\uff0c\u8fd9\u4e2a\u8c03\u5ea6\u4e2d\u5fc3\u6709\u4e86\u4e00\u5757\u5927\u770b\u677f\uff08PFHR file\uff09\uff0c\u4e0a\u9762\u6709\u5f88\u591a\u5c0f\u5361\u7247\uff08PFHR entries\uff09\u3002\u6bcf\u5f53\u4f60\uff08CPU\u6838\u5fc3\uff09\u70b9\u4e86\u4e00\u4efd\u201c\u590d\u6742\u5957\u9910\u201d\uff08\u89e6\u53d1\u4e00\u4e2a\u9884\u53d6\u5e8f\u5217\uff09\uff0c\u8c03\u5ea6\u4e2d\u5fc3\u5c31\u7acb\u523b\u5728\u770b\u677f\u4e0a\u6302\u4e00\u5f20\u65b0\u5361\u7247\uff0c\u4e0a\u9762\u5199\u7740\uff1a - \u8fd9\u5355\u662f\u8c01\u70b9\u7684\uff08Node ID\uff09 - \u4ece\u54ea\u5f00\u59cb\u9001\u7684\uff08Prefetch trigger address\uff09 - \u73b0\u5728\u5df2\u7ecf\u6d3e\u51fa\u53bb\u4f46\u8fd8\u6ca1\u9001\u5230\u7684\u6709\u54ea\u4e9b\u83dc\uff08Outstanding prefetch addresses\uff09</p> <p>\u6700\u5173\u952e\u7684\u662f\uff0c\u8c03\u5ea6\u4e2d\u5fc3\u4f1a\u4e00\u76f4\u76ef\u7740\u4f60\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u4f60\u5df2\u7ecf\u8d70\u5230\u9910\u5385\u95e8\u53e3\u51c6\u5907\u81ea\u5df1\u5403\u4e86\uff08CPU\u53d1\u51fa\u4e86\u5bf9 trigger address \u7684\u9700\u6c42\uff09\uff0c\u8c03\u5ea6\u4e2d\u5fc3\u7acb\u523b\u5c31\u628a\u8fd9\u5f20\u5361\u7247\u6495\u6389\uff0c\u544a\u8bc9\u5916\u5356\u5458\uff1a\u201c\u522b\u9001\u4e86\uff0c\u5ba2\u6237\u7b49\u4e0d\u53ca\u4e86\uff01\u201d \u8fd9\u6837\u65e2\u907f\u514d\u4e86\u9001\u4e00\u5806\u6ca1\u7528\u7684\u83dc\u8fc7\u6765\u6c61\u67d3\u4f60\u7684\u9910\u684c\uff08Cache Pollution\uff09\uff0c\u53c8\u7acb\u523b\u7a7a\u51fa\u4e86\u4eba\u624b\uff08Free PFHR entry\uff09\u53bb\u63a5\u771f\u6b63\u6709\u4ef7\u503c\u7684\u4e0b\u4e00\u5355\u3002</p> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <p>\u5173\u952e\u4e00\u62db \u4f5c\u8005\u5e76\u6ca1\u6709\u6cbf\u7528\u4f20\u7edf Cache \u91cc MSHR\uff08Miss Status Handling Register\uff09\u90a3\u79cd\u53ea\u4e3a\u5904\u7406\u7f3a\u5931\u800c\u8bbe\u8ba1\u7684\u7b80\u5355\u601d\u8def\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728\u9884\u53d6\u5668\u5185\u90e8\u4e13\u95e8\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u72b6\u6001\u673a\u548c\u914d\u5957\u7684\u5bc4\u5b58\u5668\u6587\u4ef6\uff0c\u7528\u6765\u7ba1\u7406\u9884\u53d6\u7279\u6709\u7684\u957f\u94fe\u6761\u548c\u52a8\u6001\u6027\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u4ed6\u4eec\u505a\u4e86\u4e24\u4e2a\u6838\u5fc3\u626d\u8f6c\uff1a</p> <ul> <li>\u5f15\u5165\u4e86\u201c\u89e6\u53d1\u5730\u5740\u201d\u4f5c\u4e3a\u65f6\u6548\u6027\u951a\u70b9\uff1a</li> <li>\u6bcf\u4e2a PFHR \u6761\u76ee\u90fd\u8bb0\u5f55\u4e0b\u9884\u53d6\u5e8f\u5217\u5f00\u59cb\u7684\u90a3\u4e2a\u865a\u62df\u5730\u5740\uff08Prefetch trigger address\uff09\u3002</li> <li>\u9884\u53d6\u5668\u4f1a\u6301\u7eed\u76d1\u542c CPU \u7684 L1D \u8bbf\u95ee\u3002\u4e00\u65e6\u53d1\u73b0 CPU \u81ea\u5df1\u8bbf\u95ee\u4e86\u8fd9\u4e2a\u201c\u89e6\u53d1\u5730\u5740\u201d\uff0c\u5c31\u7acb\u523b\u5224\u5b9a\uff1a\u201c\u574f\u4e86\uff0c\u6211\u9884\u53d6\u5f97\u592a\u6162\u4e86\uff0cCPU\u5df2\u7ecf\u8ffd\u4e0a\u6765\u4e86\uff01\u201d</li> <li> <p>\u4e8e\u662f\uff0c\u5b83\u4f1a\u679c\u65ad\u4e22\u5f03\uff08drop\uff09\u6574\u4e2a\u4e0e\u4e4b\u5173\u8054\u7684\u9884\u53d6\u5e8f\u5217\uff0c\u91ca\u653e\u6240\u6709\u76f8\u5173\u8d44\u6e90\u3002\u8fd9\u4fdd\u8bc1\u4e86\u9884\u53d6\u5668\u6c38\u8fdc\u5728\u201c\u6709\u6548\u63d0\u524d\u91cf\u201d\u7684\u8303\u56f4\u5185\u5de5\u4f5c\uff0c\u800c\u4e0d\u662f\u76f2\u76ee\u5730\u3001\u8fc7\u65f6\u5730\u642c\u8fd0\u6570\u636e\u3002</p> </li> <li> <p>\u5b9e\u73b0\u4e86\u771f\u6b63\u7684\u975e\u963b\u585e\u591a\u8def\u9884\u53d6\uff1a</p> </li> <li>\u4f20\u7edf\u7684\u9884\u53d6\u5668\u5728\u5904\u7406\u4e00\u4e2a\u957f\u94fe\u6761\u65f6\u662f\u4e32\u884c\u963b\u585e\u7684\u3002\u800c PFHR \u6587\u4ef6\u5141\u8bb8\u591a\u4e2a\u9884\u53d6\u5e8f\u5217\u5e76\u884c\u5b58\u5728\u3001\u72ec\u7acb\u8ffd\u8e2a\u3002</li> <li>\u5f53\u4e00\u4e2a\u9884\u53d6\u8bf7\u6c42\u7684\u6570\u636e\u8fd4\u56de\u65f6\uff0c\u9884\u53d6\u5668\u901a\u8fc7 CAM\uff08Content-Addressable Memory\uff09\u67e5\u627e Outstanding prefetch addresses \u5b57\u6bb5\uff0c\u77ac\u95f4\u5b9a\u4f4d\u5230\u5bf9\u5e94\u7684 PFHR \u6761\u76ee\u3002</li> <li>\u7136\u540e\uff0c\u5b83\u5229\u7528\u5b58\u50a8\u5728 DIG \u4e2d\u7684\u8bed\u4e49\u4fe1\u606f\uff08\u6bd4\u5982\u662f single-valued indirection \u8fd8\u662f ranged indirection\uff09\uff0c\u7acb\u523b\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u8981\u9884\u53d6\u7684\u5730\u5740\uff0c\u5e76\u53d1\u51fa\u65b0\u7684\u8bf7\u6c42\uff0c\u540c\u65f6\u66f4\u65b0\u8be5 PFHR \u6761\u76ee\u7684\u72b6\u6001\u3002</li> <li>\u8fd9\u4e2a\u8fc7\u7a0b\u5b8c\u5168\u4e0d\u963b\u585e\u5176\u4ed6\u6b63\u5728\u6267\u884c\u7684\u9884\u53d6\u5e8f\u5217\uff0c\u6781\u5927\u5730\u63d0\u5347\u4e86\u9884\u53d6\u5668\u7684\u541e\u5410\u91cf\u548c\u5bf9\u590d\u6742\u904d\u5386\u6a21\u5f0f\u7684\u8986\u76d6\u80fd\u529b\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/ELI5_notes/#5-eli5","title":"5. \u81ea\u9002\u5e94\u9884\u53d6\u7b97\u6cd5 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <p>\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u5728\u5904\u7406\u56fe\u8ba1\u7b97\u8fd9\u7c7b\u4e0d\u89c4\u5219\u8d1f\u8f7d\u65f6\uff0c\u5e38\u5e38\u9677\u5165\u4e24\u96be\u5883\u5730\uff1a - \u5982\u679c\u9884\u53d6\u5f97\u592a\u201c\u6fc0\u8fdb\u201d\uff08lookahead distance \u592a\u5927\uff09\uff0c\u6838\u5fc3\u8fd8\u6ca1\u7528\u5230\u6570\u636e\uff0c\u7f13\u5b58\u5c31\u88ab\u65b0\u6765\u7684\u9884\u53d6\u9879\u6324\u51fa\u53bb\u4e86\uff0c\u9020\u6210 cache pollution\uff0c\u767d\u5fd9\u6d3b\u4e00\u573a\u3002 - \u5982\u679c\u9884\u53d6\u5f97\u592a\u201c\u4fdd\u5b88\u201d\uff08lookahead distance \u592a\u5c0f\uff09\uff0c\u6838\u5fc3\u6267\u884c\u901f\u5ea6\u4e00\u65e6\u53d8\u5feb\uff0c\u5c31\u4f1a\u7acb\u523b\u8ffd\u4e0a\u9884\u53d6\u5668\uff0c\u5bfc\u81f4 stall on DRAM\uff0c\u9884\u53d6\u5b8c\u5168\u6ca1\u8d77\u5230\u9690\u85cf\u5ef6\u8fdf\u7684\u4f5c\u7528\u3002 - \u66f4\u9ebb\u70e6\u7684\u662f\uff0c\u4e0d\u540c\u7b97\u6cd5\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u5dee\u5f02\u5de8\u5927\u3002\u6bd4\u5982 BFS \u53ef\u80fd\u8981\u8fde\u7eed\u7a7f\u8d8a\u56db\u4e94\u4e2a\u6570\u636e\u7ed3\u6784\uff08offset list -&gt; edge list -&gt; visited list -&gt; ...\uff09\uff0c\u800c PageRank \u7684\u8def\u5f84\u53ef\u80fd\u5c31\u77ed\u5f88\u591a\u3002\u7528\u4e00\u4e2a\u56fa\u5b9a\u7684\u9884\u53d6\u8ddd\u79bb\u53bb\u5e94\u4ed8\u6240\u6709\u60c5\u51b5\uff0c\u6ce8\u5b9a\u662f\u987e\u6b64\u5931\u5f7c\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9</p> <p>\u60f3\u8c61\u4f60\u5728\u4e00\u6761\u5d0e\u5c96\u7684\u5c71\u8def\u4e0a\u7ed9\u524d\u65b9\u7684\u670b\u53cb\u9001\u6c34\u3002\u4f60\u670b\u53cb\u8d70\u8def\u7684\u901f\u5ea6\u65f6\u5feb\u65f6\u6162\uff0c\u800c\u4f60\u6bcf\u6b21\u53ea\u80fd\u80cc\u6709\u9650\u7684\u51e0\u74f6\u6c34\u3002 - \u4e00\u4e2a\u7b28\u529e\u6cd5\u662f\uff1a\u4e0d\u7ba1\u670b\u53cb\u8d70\u591a\u5feb\uff0c\u4f60\u6bcf\u6b21\u90fd\u56fa\u5b9a\u5728\u4ed6\u524d\u9762100\u7c73\u7684\u5730\u65b9\u653e\u4e00\u74f6\u6c34\u3002\u5982\u679c\u4ed6\u7a81\u7136\u52a0\u901f\uff0c\u5f88\u5feb\u5c31\u8dd1\u5230\u4f60\u653e\u6c34\u70b9\u7684\u524d\u9762\u53bb\u4e86\uff0c\u6e34\u5f97\u4e0d\u884c\uff1b\u5982\u679c\u4ed6\u8d70\u5f97\u5f88\u6162\uff0c\u4f60\u653e\u7684\u6c34\u65e9\u5c31\u88ab\u592a\u9633\u6652\u5e72\uff08\u88ab\u7f13\u5b58\u66ff\u6362\uff09\u4e86\u3002 - Prodigy \u7684\u806a\u660e\u505a\u6cd5\u662f\uff1a\u4f60\u5148\u89c2\u5bdf\u8fd9\u6761\u8def\u6709\u591a\u201c\u7ed5\u201d\uff08\u5bf9\u5e94 DIG \u4e2d\u7684 \u904d\u5386\u6df1\u5ea6\uff09\u3002\u5982\u679c\u8def\u5f88\u7ed5\uff08\u6df1\u5ea6\u5927\uff09\uff0c\u4f60\u77e5\u9053\u670b\u53cb\u8d70\u5b8c\u6574\u4e2a\u6d41\u7a0b\u9700\u8981\u5f88\u4e45\uff0c\u90a3\u4f60\u5c31\u5728\u79bb\u4ed6\u8fd1\u4e00\u70b9\u7684\u5730\u65b9\uff08\u6bd4\u598220\u7c73\uff09\u653e\u6c34\uff0c\u4fdd\u8bc1\u6c34\u662f\u65b0\u9c9c\u7684\u3002\u5982\u679c\u8def\u5f88\u76f4\uff08\u6df1\u5ea6\u5c0f\uff09\uff0c\u4f60\u5c31\u5927\u80c6\u5730\u628a\u6c34\u653e\u5230\u66f4\u8fdc\u7684\u5730\u65b9\uff08\u6bd4\u598280\u7c73\uff09\uff0c\u8ba9\u4ed6\u4e00\u8def\u7545\u901a\u65e0\u963b\u3002 - \u540c\u65f6\uff0c\u4f60\u8fd8\u4e00\u76f4\u76ef\u7740\u670b\u53cb\u7684\u4f4d\u7f6e\u3002\u4e00\u65e6\u53d1\u73b0\u4ed6\u5df2\u7ecf\u8d70\u5230\u4f60\u4e0a\u6b21\u653e\u6c34\u70b9\u9644\u8fd1\u4e86\uff0c\u4f60\u5c31\u7acb\u523b\u653e\u5f03\u90a3\u4e2a\u5df2\u7ecf\u6ca1\u610f\u4e49\u7684\u9001\u6c34\u8ba1\u5212\uff0c\u8f6c\u800c\u96c6\u4e2d\u7cbe\u529b\u4e3a\u4ed6\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u51c6\u5907\u65b0\u7684\u6c34\u3002\u8fd9\u5c31\u53eb \u9009\u62e9\u6027\u4e22\u5f03\u9884\u53d6\u5e8f\u5217\u3002</p> <p>\u5173\u952e\u4e00\u62db</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u91c7\u7528\u4e00\u4e2a\u50f5\u5316\u7684\u9884\u53d6\u7b56\u7565\uff0c\u800c\u662f\u5728\u9884\u53d6\u5668\u5185\u90e8\u690d\u5165\u4e86\u4e00\u4e2a\u52a8\u6001\u53cd\u9988\u548c\u8c03\u6574\u673a\u5236\uff0c\u5176\u6838\u5fc3\u903b\u8f91\u8f6c\u6362\u5728\u4e8e\uff1a</p> <ul> <li>\u5c06\u9759\u6001\u7684\u201c\u9884\u53d6\u8ddd\u79bb\u201d\u53c2\u6570\uff0c\u8f6c\u53d8\u4e3a\u7531 DIG \u904d\u5386\u6df1\u5ea6\u9a71\u52a8\u7684\u52a8\u6001\u53d8\u91cf\u3002</li> <li> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u7cfb\u7edf\u5185\u7f6e\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u542f\u53d1\u5f0f\u89c4\u5219\uff1a\u904d\u5386\u6df1\u5ea6\u8d8a\u9ad8\uff0c\u9884\u53d6\u8ddd\u79bb\u8d8a\u77ed\u3002\u8bba\u6587\u4e2d\u63d0\u5230\uff0c\u5bf9\u4e8e\u7a7f\u8d8a\u56db\u4e2a\u6216\u66f4\u591a\u6570\u636e\u7ed3\u6784\u7684\u7b97\u6cd5\uff0c\u9884\u53d6\u8ddd\u79bb\u76f4\u63a5\u8bbe\u4e3a1\u3002\u8fd9\u786e\u4fdd\u4e86\u5728\u957f\u4f9d\u8d56\u94fe\u4e0b\uff0c\u9884\u53d6\u7684\u6570\u636e\u80fd\u53ca\u65f6\u88ab\u7528\u4e0a\uff0c\u907f\u514d\u56e0\u7b49\u5f85\u592a\u4e45\u800c\u5931\u6548\u3002</p> </li> <li> <p>\u5f15\u5165\u4e86\u57fa\u4e8e\u201c\u89e6\u53d1\u5730\u5740\u201d\u7684\u5b9e\u65f6\u76d1\u63a7\u4e0e\u6e05\u7406\u673a\u5236\u3002</p> </li> <li>\u6bcf\u5f53\u542f\u52a8\u4e00\u4e2a\u65b0\u7684\u9884\u53d6\u5e8f\u5217\u65f6\uff0c\u786c\u4ef6\u4f1a\u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u5e8f\u5217\u7684\u8d77\u59cb\u865a\u62df\u5730\u5740\uff08\u5373 prefetch trigger address\uff0c\u89c1 </li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <p>\u4e2d\u7684 PFHR \u7ed3\u6784\uff09\u3002   - \u5728\u540e\u7eed\u6267\u884c\u4e2d\uff0c\u5982\u679c\u6838\u5fc3\u53d1\u51fa\u4e86\u4e00\u4e2a\u5bf9\u8fd9\u4e2a\u201c\u89e6\u53d1\u5730\u5740\u201d\u7684\u9700\u6c42\u52a0\u8f7d\uff08demand load\uff09\uff0c\u5c31\u610f\u5473\u7740\u6838\u5fc3\u5df2\u7ecf\u8d76\u4e0a\u4e86\u8fd9\u4e2a\u9884\u53d6\u5e8f\u5217\u7684\u8fdb\u5ea6\u3002   - \u6b64\u65f6\uff0c\u7cfb\u7edf\u4f1a\u679c\u65ad drop the prefetch sequence\uff0c\u56e0\u4e3a\u7ee7\u7eed\u5b8c\u6210\u8fd9\u4e2a\u5e8f\u5217\u53ea\u80fd\u90e8\u5206\u9690\u85cf\u5ef6\u8fdf\uff0c\u6027\u4ef7\u6bd4\u6781\u4f4e\u3002\u91ca\u653e\u51fa\u7684\u786c\u4ef6\u8d44\u6e90\uff08\u5982 PFHR \u6761\u76ee\uff09\u53ef\u4ee5\u7acb\u5373\u7528\u4e8e\u542f\u52a8\u66f4\u6709\u4ef7\u503c\u7684\u65b0\u9884\u53d6\u4efb\u52a1\u3002</p> <p>\u8fd9\u4e2a\u8bbe\u8ba1\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u7528\u6781\u4f4e\u7684\u786c\u4ef6\u5f00\u9500\uff08\u4ec5\u9700\u5728 PFHR \u4e2d\u589e\u52a0\u4e00\u4e2a\u5730\u5740\u5b57\u6bb5\u548c\u4e00\u4e2a\u6bd4\u8f83\u5668\uff09\uff0c\u5c31\u5b9e\u73b0\u4e86\u9884\u53d6\u5668\u4e0e\u6838\u5fc3\u6267\u884c\u8282\u594f\u7684\u52a8\u6001\u540c\u6b65\uff0c\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u9884\u53d6\u201c\u8fc7\u72b9\u4e0d\u53ca\u201d\u7684\u96be\u9898\u3002</p>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/","title":"Prodigy: Improving the Memory Latency of Data-Indirect Irregular Workloads Using Hardware-Software Co-Design \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-1-overview-of-our-design-and-contributions-prodigy-software-efficiently-communicates-key-data-structures-and-algorithmic-traversal-patterns-encoded-in-the-proposed-compact-representation-called-the-data-indirection-graph-dig-to-the-hardware-for-informed-prefetching","title":"Figure 1. Overview of our design and contributions. Prodigy software efficiently communicates key data structures and algorithmic traversal patterns, encoded in the proposed compact representation called the Data Indirection Graph (DIG), to the hardware for informed prefetching.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u7684\u6574\u4f53\u67b6\u6784\u4e0e\u6838\u5fc3\u8d21\u732e\uff0c\u5206\u4e3a Software \u548c Hardware \u4e24\u5927\u6a21\u5757\uff0c\u901a\u8fc7 Data Indirection Graph (DIG) \u5b9e\u73b0\u8f6f\u786c\u4ef6\u534f\u540c\u3002</li> <li>Software \u5c42\uff1a</li> <li>\u8f93\u5165\u4e3a Application source code\uff0c\u7ecf\u7531 Compiler analysis \u81ea\u52a8\u63d0\u53d6\u5173\u952e\u6570\u636e\u7ed3\u6784\u4e0e\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li>\u7f16\u8bd1\u5668\u63d2\u5165 API \u8c03\u7528\uff08\u5982 <code>regNode</code>, <code>regTravEdge</code>\uff09\uff0c\u751f\u6210 Instrumented application binary\uff0c\u5176\u4e2d\u5d4c\u5165 DIG \u8868\u793a\u3002</li> <li>\u793a\u4f8b\u4ee3\u7801\u7247\u6bb5\u663e\u793a\u5728 <code>bfs.cc</code> \u4e2d\uff0c\u6807\u6ce8\u4e86 DIG \u6ce8\u518c\u903b\u8f91\uff0c\u5982 <code>regTrigEdge(...)</code> \u7528\u4e8e\u89e6\u53d1\u9884\u53d6\u5e8f\u5217\u3002</li> <li>Hardware \u5c42\uff1a</li> <li>\u8fd0\u884c\u65f6\uff0cProgram the prefetcher \u6a21\u5757\u8bfb\u53d6\u4e8c\u8fdb\u5236\u4e2d\u7684 DIG \u6570\u636e\uff0c\u5c06\u5176\u52a0\u8f7d\u81f3\u786c\u4ef6\u9884\u53d6\u5668\u672c\u5730\u5b58\u50a8\u3002</li> <li>\u9884\u53d6\u5668\u6839\u636e DIG \u52a8\u6001\u751f\u6210 prefetch requests\uff0c\u54cd\u5e94 L1D \u7f13\u5b58\u7684\u8d1f\u8f7d\u8bf7\u6c42\uff0c\u5b9e\u73b0\u667a\u80fd\u9884\u53d6\u3002</li> <li>\u6838\u5fc3\u8d21\u732e\uff1a</li> <li>\u63d0\u51fa Data Indirection Graph (DIG)\uff1a\u4e00\u79cd\u7d27\u51d1\u56fe\u7ed3\u6784\uff0c\u8282\u70b9\u4ee3\u8868\u6570\u636e\u7ed3\u6784\uff08\u542b\u57fa\u5740\u3001\u5bb9\u91cf\u3001\u5143\u7d20\u5927\u5c0f\uff09\uff0c\u8fb9\u4ee3\u8868\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff08\u5355\u503c/\u8303\u56f4\u7d22\u5f15\uff09\u3002</li> <li>\u652f\u6301 Adjustable prefetch distance\uff1a\u6839\u636e\u6838\u5fc3\u6267\u884c\u901f\u5ea6\u52a8\u6001\u8c03\u6574\u9884\u53d6\u8ddd\u79bb\uff0c\u7ef4\u6301\u53ca\u65f6\u6027\u3002</li> <li>\u5b9e\u73b0 Low-cost \u8bbe\u8ba1\uff1a\u4ec5\u9700 0.8KB \u5b58\u50a8\u5f00\u9500\uff0c\u9002\u5408\u73b0\u4ee3\u201c\u6697\u7845\u201d\u65f6\u4ee3\u4e13\u7528\u52a0\u901f\u5668\u8d8b\u52bf\u3002</li> <li>\u7cfb\u7edf\u4ea4\u4e92\u6d41\u7a0b\uff1a</li> <li>\u8f6f\u4ef6\u7f16\u8bd1\u9636\u6bb5\u6ce8\u5165 DIG \u2192 \u786c\u4ef6\u8fd0\u884c\u65f6\u52a0\u8f7d\u5e76\u7f16\u7a0b\u9884\u53d6\u5668 \u2192 \u9884\u53d6\u5668\u76d1\u542c L1D \u8bf7\u6c42 \u2192 \u6839\u636e DIG \u89e6\u53d1\u5e76\u63a8\u8fdb\u9884\u53d6\u5e8f\u5217\u3002</li> <li>\u89c6\u89c9\u5f3a\u8c03\u5185\u5bb9\uff1a</li> <li>DIG representation \u662f\u8fde\u63a5\u8f6f\u786c\u4ef6\u7684\u6838\u5fc3\u6865\u6881\u3002</li> <li>Programmable Prefetcher \u662f\u786c\u4ef6\u7aef\u7684\u5173\u952e\u7ec4\u4ef6\uff0c\u5177\u5907\u53ef\u7f16\u7a0b\u6027\u548c\u81ea\u9002\u5e94\u80fd\u529b\u3002</li> <li>Instrumented binary \u662f\u8f6f\u4ef6\u5206\u6790\u8f93\u51fa\u7684\u8f7d\u4f53\uff0c\u5305\u542b\u9884\u53d6\u6240\u9700\u8bed\u4e49\u4fe1\u606f\u3002</li> </ul> \u6a21\u5757 \u5173\u952e\u7ec4\u4ef6 \u529f\u80fd\u63cf\u8ff0 Software Compiler analysis \u9759\u6001\u5206\u6790\u6e90\u7801\uff0c\u63d0\u53d6\u6570\u636e\u7ed3\u6784\u4e0e\u8bbf\u95ee\u6a21\u5f0f Instrumented binary \u5d4c\u5165 DIG \u8868\u793a\uff0c\u4f9b\u786c\u4ef6\u8bfb\u53d6 Hardware Programmable Prefetcher \u6839\u636e DIG \u52a8\u6001\u751f\u6210\u9884\u53d6\u8bf7\u6c42 Generate prefetch requests \u54cd\u5e94\u7f13\u5b58\u9700\u6c42\uff0c\u53d1\u51fa\u975e\u963b\u585e\u9884\u53d6 Core Contribution DIG Representation \u62bd\u8c61\u7b97\u6cd5\u8bed\u4e49\uff0c\u652f\u6301 CSR/CSC \u7b49\u591a\u79cd\u7a00\u758f\u683c\u5f0f Adjustable prefetch distance \u52a8\u6001\u9002\u914d\u6838\u5fc3\u6267\u884c\u8282\u594f\uff0c\u907f\u514d\u9884\u53d6\u8fc7\u65e9\u6216\u8fc7\u665a Low-cost design \u4ec5 0.8KB \u5b58\u50a8\uff0c\u9002\u5408\u96c6\u6210\u4e8e\u901a\u7528 CPU \u6216\u52a0\u901f\u5668"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-2-reduction-in-a-memory-stalls-and-b-speedup-of-different-approaches-normalized-to-a-non-prefetching-baseline-for-the-pagerank-algorithm-on-the-livejournal-data-set","title":"Figure 2. Reduction in ((a)) memory stalls and ((b)) speedup of different approaches normalized to a non-prefetching baseline for the PageRank algorithm on the livejournal data set.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u5728 PageRank \u7b97\u6cd5\u8fd0\u884c\u4e8e livejournal \u6570\u636e\u96c6\u65f6\u7684\u6027\u80fd\u8868\u73b0\uff0c\u5bf9\u6bd4\u4e86\u56db\u79cd\u4e0d\u540c\u9884\u53d6\u7b56\u7565\uff1a\u65e0\u9884\u53d6\uff08No pref\uff09\u3001GHB-based G/DC\u3001DROPLET \u548c\u672c\u6587\u63d0\u51fa\u7684 Prodigy\uff08This work\uff09\u3002</li> <li>\u56fe (a) \u4e3a DRAM Stall \u6bd4\u4f8b\u56fe\uff0c\u7eb5\u8f74\u8868\u793a DRAM stall \u5360\u603b\u6267\u884c\u65f6\u95f4\u7684\u6bd4\u4f8b\u3002Prodigy \u5c06 DRAM stall \u4ece\u57fa\u7ebf\u7684 1.0 \u964d\u4f4e\u81f3\u7ea6 0.12\uff0c\u964d\u5e45\u8fbe 8.2 \u500d\uff0c\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u65b9\u6848\u3002</li> <li>\u56fe (b) \u4e3a Speedup\uff08\u52a0\u901f\u6bd4\uff09\u67f1\u72b6\u56fe\uff0c\u4ee5\u65e0\u9884\u53d6\u57fa\u7ebf\u4e3a 1x\u3002Prodigy \u5b9e\u73b0\u4e86\u7ea6 2.9x \u7684\u7aef\u5230\u7aef\u52a0\u901f\uff0c\u8fdc\u8d85 GHB/G/DC\uff08\u7ea6 1.1x\uff09\u548c DROPLET\uff08\u7ea6 2.3x\uff09\u3002</li> <li>\u5404\u65b9\u6cd5\u6027\u80fd\u5bf9\u6bd4\u5982\u4e0b\u8868\uff1a</li> </ul> \u9884\u53d6\u7b56\u7565 DRAM Stall \u6bd4\u4f8b Speedup (x) No pref 1.0 1.0 GHB G/DC ~0.9 ~1.1 DROPLET ~0.3 ~2.3 This work (Prodigy) ~0.12 ~2.9 <ul> <li>\u8be5\u7ed3\u679c\u9a8c\u8bc1\u4e86 Prodigy \u5728\u5904\u7406\u6570\u636e\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\u65f6\u7684\u6709\u6548\u6027\uff0c\u5c24\u5176\u5728\u51cf\u5c11\u5185\u5b58\u505c\u987f\u548c\u63d0\u5347\u6574\u4f53\u541e\u5410\u65b9\u9762\u8868\u73b0\u7a81\u51fa\u3002</li> <li>\u56fe\u4e2d\u7bad\u5934\u660e\u786e\u6807\u6ce8\u201c8.2x\u201d\uff0c\u5f3a\u8c03 Prodigy \u76f8\u8f83\u4e8e\u57fa\u7ebf\u5728 DRAM stall \u4e0a\u7684\u538b\u5012\u6027\u4f18\u5316\uff0c\u51f8\u663e\u5176\u5728\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u7684\u72ec\u7279\u4f18\u52bf\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-3-bfs-algorithm-a-pseudo-code-for-a-parallel-implementation-of-bfs-and-b-a-toy-example-of-bfs-traversal-on-a-graph-stored-in-a-compressed-sparse-row-csr-format","title":"Figure 3. BFS algorithm: (a) pseudo-code for a parallel implementation of BFS, and (b) a toy example of BFS traversal on a graph stored in a compressed sparse row (CSR) format.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 BFS \u7b97\u6cd5\u7684\u4e24\u4e2a\u6838\u5fc3\u90e8\u5206\uff1a(a) \u5e76\u884c\u5b9e\u73b0\u7684\u4f2a\u4ee3\u7801\uff0c(b) \u4f7f\u7528 CSR \u683c\u5f0f\u5b58\u50a8\u56fe\u6570\u636e\u65f6\u7684\u904d\u5386\u793a\u4f8b\u3002</li> <li>\u4f2a\u4ee3\u7801\u90e8\u5206\u5305\u542b\u5173\u952e\u63a7\u5236\u7ed3\u6784\uff1a</li> <li>\u521d\u59cb\u5316 <code>workQueue.enqueue(source)</code> \u5c06\u6e90\u8282\u70b9\u5165\u961f\u3002</li> <li>\u5916\u5c42\u5faa\u73af <code>while workQueue not empty</code> \u6301\u7eed\u5904\u7406\u961f\u5217\u4e2d\u7684\u8282\u70b9\u3002</li> <li>\u5185\u5c42\u4f7f\u7528 <code>#pragma omp parallel</code> \u5b9e\u73b0\u5e76\u884c\u5316\uff0c\u5bf9\u6bcf\u4e2a\u8282\u70b9 <code>u</code> \u6267\u884c\u904d\u5386\u3002</li> <li>\u904d\u5386\u903b\u8f91\u4e3a\uff1a\u4ece <code>offsetList(u)</code> \u5230 <code>offsetList(u+1)</code> \u83b7\u53d6\u90bb\u5c45\u8303\u56f4\uff0c\u518d\u901a\u8fc7 <code>edgeList(w)</code> \u8bbf\u95ee\u5177\u4f53\u90bb\u5c45\u8282\u70b9 <code>v</code>\u3002</li> <li>\u5bf9\u6bcf\u4e2a\u90bb\u5c45 <code>v</code>\uff0c\u68c0\u67e5 <code>visited[v]</code> \u72b6\u6001\uff0c\u82e5\u672a\u8bbf\u95ee\u5219\u6807\u8bb0\u5e76\u5165\u961f\u3002</li> <li>\u6570\u636e\u7ed3\u6784\u4e0e\u904d\u5386\u6a21\u5f0f\u90e8\u5206\u5c55\u793a\u4e86\u4e00\u4e2a\u73a9\u5177\u56fe\u53ca\u5176 CSR \u5b58\u50a8\u65b9\u5f0f\uff1a</li> <li>\u56fe\u4e2d\u5305\u542b 7 \u4e2a\u9876\u70b9\uff080\u20136\uff09\uff0c\u8fb9\u4ee5\u90bb\u63a5\u5173\u7cfb\u8868\u793a\u3002</li> <li>offsetList \u6570\u7ec4\u8bb0\u5f55\u6bcf\u4e2a\u9876\u70b9\u5728 edgeList \u4e2d\u7684\u8d77\u59cb\u4f4d\u7f6e\u548c\u7ed3\u675f\u4f4d\u7f6e\uff08\u4e0d\u5305\u62ec\uff09\u3002</li> <li>edgeList \u6570\u7ec4\u6309\u987a\u5e8f\u5b58\u50a8\u6240\u6709\u8fb9\u7684\u76ee\u6807\u9876\u70b9\u7f16\u53f7\u3002</li> <li>visited \u6570\u7ec4\u8bb0\u5f55\u6bcf\u4e2a\u9876\u70b9\u662f\u5426\u5df2\u88ab\u8bbf\u95ee\uff080 \u8868\u793a\u672a\u8bbf\u95ee\uff0c1 \u8868\u793a\u5df2\u8bbf\u95ee\uff09\u3002</li> <li>\u904d\u5386\u65b9\u5411\u7bad\u5934\u6307\u793a\u4e86 BFS \u7684\u5c42\u7ea7\u6269\u5c55\u8fc7\u7a0b\uff0c\u4ece\u6e90\u8282\u70b9\u5f00\u59cb\u9010\u5c42\u8bbf\u95ee\u90bb\u5c45\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e86 CSR \u683c\u5f0f\u4e2d\u5404\u6570\u7ec4\u7684\u5177\u4f53\u5185\u5bb9\uff1a</li> </ul> \u6570\u7ec4 \u5185\u5bb9\u793a\u4f8b \u8bf4\u660e offsetList [0, 2, 5, 8, 10, 13, 14, 14] \u6bcf\u4e2a\u9876\u70b9\u5728 edgeList \u4e2d\u7684\u8d77\u59cb\u7d22\u5f15 edgeList [2, 5, 0, 4, 6, 1, 4, 6, 2, 5, 0, 1, 4, 6] \u6240\u6709\u8fb9\u7684\u76ee\u6807\u9876\u70b9\u7f16\u53f7\uff0c\u6309\u9876\u70b9\u987a\u5e8f\u6392\u5217 visited [0, 1, 1, 0, 1, 0, 1] \u9876\u70b9\u8bbf\u95ee\u72b6\u6001\uff0c0=\u672a\u8bbf\u95ee\uff0c1=\u5df2\u8bbf\u95ee <ul> <li>\u8be5\u56fe\u6e05\u6670\u4f53\u73b0\u4e86 CSR \u683c\u5f0f\u5982\u4f55\u538b\u7f29\u7a00\u758f\u56fe\u6570\u636e\uff0c\u5e76\u652f\u6301\u9ad8\u6548\u7684\u90bb\u5c45\u8bbf\u95ee\u64cd\u4f5c\u3002</li> <li>\u540c\u65f6\u63ed\u793a\u4e86 BFS \u7b97\u6cd5\u4e2d\u5178\u578b\u7684 \u6570\u636e\u4f9d\u8d56\u578b\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5373\u901a\u8fc7 <code>offsetList</code> \u548c <code>edgeList</code> \u7684\u7ec4\u5408\u7d22\u5f15\u6765\u52a8\u6001\u786e\u5b9a\u4e0b\u4e00\u4e2a\u8bbf\u95ee\u5730\u5740\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-4-normalized-execution-time-of-irregular-workloads-without-prefetching-broken-down-into-no-stall-and-stalls-due-to-dram-cache-branch-mispredictions-data-dependencies-and-others-the-goal-of-this-work-is-to-reduce-the-dram-stalls-dark-blue-portion-of-the-bar","title":"Figure 4. Normalized execution time of irregular workloads, without prefetching, broken down into: no-stall, and stalls due to DRAM, cache, branch mispredictions, data dependencies, and others. The goal of this work is to reduce the DRAM stalls (dark blue portion of the bar).","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u65e0\u9884\u53d6\uff08no-prefetching\uff09\u6761\u4ef6\u4e0b\uff0c29\u4e2a\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5f52\u4e00\u5316\u6267\u884c\u65f6\u95f4\u5206\u89e3\u56fe\uff0c\u65e8\u5728\u63ed\u793a\u5176\u6027\u80fd\u74f6\u9888\u3002</li> <li>\u6bcf\u4e2a\u67f1\u72b6\u56fe\u4ee3\u8868\u4e00\u4e2a\u7279\u5b9a\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u6309\u7b97\u6cd5\u548c\u6570\u636e\u96c6\u7ec4\u5408\u547d\u540d\uff08\u5982 <code>bc-lj</code> \u8868\u793a Betweenness Centrality \u5728 livejournal \u6570\u636e\u96c6\u4e0a\uff09\u3002</li> <li>\u6267\u884c\u65f6\u95f4\u88ab\u7ec6\u5206\u4e3a\u516d\u7c7b\uff1aNo-stall\uff08\u65e0\u505c\u987f\uff09\u3001DRAM-stall\uff08DRAM\u505c\u987f\uff09\u3001Cache-stall\uff08\u7f13\u5b58\u505c\u987f\uff09\u3001Branch-stall\uff08\u5206\u652f\u9884\u6d4b\u5931\u8d25\u505c\u987f\uff09\u3001Dependency-stall\uff08\u6570\u636e\u4f9d\u8d56\u505c\u987f\uff09\u548c Other-stalls\uff08\u5176\u4ed6\u505c\u987f\uff09\u3002</li> <li>DRAM-stall\uff08\u6df1\u84dd\u8272\u90e8\u5206\uff09\u662f\u7edd\u5927\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u7684\u4e3b\u8981\u74f6\u9888\uff0c\u5360\u6bd4\u666e\u904d\u8d85\u8fc750%\uff0c\u6700\u9ad8\u53ef\u8fbe80%\u4ee5\u4e0a\uff0c\u8fd9\u6b63\u662f Prodigy \u7cfb\u7edf\u8bbe\u8ba1\u7684\u6838\u5fc3\u4f18\u5316\u76ee\u6807\u3002</li> <li>Branch-stall\uff08\u6d45\u84dd\u8272\u90e8\u5206\uff09\u5728\u90e8\u5206\u56fe\u7b97\u6cd5\uff08\u5982 bfs, pr, sssp\uff09\u4e2d\u4e5f\u5360\u663e\u8457\u6bd4\u4f8b\uff0c\u8fd9\u4e0e\u8fd9\u4e9b\u7b97\u6cd5\u4e2d\u5927\u91cf\u5b58\u5728\u7684\u6570\u636e\u4f9d\u8d56\u5206\u652f\u6709\u5173\u3002</li> <li>Cache-stall\uff08\u9752\u8272\u90e8\u5206\uff09\u548c Dependency-stall\uff08\u6d45\u7eff\u8272\u90e8\u5206\uff09\u76f8\u5bf9\u8f83\u5c0f\uff0c\u8868\u660e\u7f13\u5b58\u672a\u547d\u4e2d\u548c\u6307\u4ee4\u95f4\u6570\u636e\u4f9d\u8d56\u4e0d\u662f\u4e3b\u8981\u95ee\u9898\u3002</li> <li>No-stall\uff08\u9ec4\u8272\u90e8\u5206\uff09\u4ee3\u8868\u6838\u5fc3\u8ba1\u7b97\u65f6\u95f4\uff0c\u5728\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u5360\u6bd4\u90fd\u5f88\u5c0f\uff0c\u8bf4\u660e\u6027\u80fd\u74f6\u9888\u4e0d\u5728\u8ba1\u7b97\u672c\u8eab\uff0c\u800c\u5728\u5185\u5b58\u8bbf\u95ee\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u8bc1\u660e\u4e86\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u7684\u201c\u5185\u5b58\u5899\u201d\u95ee\u9898\uff0c\u4e3a Prodigy \u63d0\u51fa\u7684\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u9884\u53d6\u65b9\u6848\u63d0\u4f9b\u4e86\u5f3a\u6709\u529b\u7684\u52a8\u673a\u3002</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d DRAM-stall \u5360\u6bd4 (\u4f30\u7b97) \u4e3b\u8981\u7279\u5f81 bc-lj, bc-sk, bc-po &gt;70% \u9ad8\u5ea6\u4f9d\u8d56\u5185\u5b58\u8bbf\u95ee\uff0cDRAM\u505c\u987f\u4e3b\u5bfc bfs-lj, bfs-sk, bfs-po &gt;60% \u5305\u542b\u5927\u91cf\u6570\u636e\u4f9d\u8d56\u5206\u652f\uff0cBranch-stall \u4e5f\u8f83\u9ad8 cc-lj, cc-sk, cc-po &gt;65% DRAM\u505c\u987f\u4e3a\u4e3b\uff0cBranch-stall \u8f83\u4f4e pr-lj, pr-sk, pr-po &gt;60% DRAM\u505c\u987f\u4e3a\u4e3b\uff0cBranch-stall \u663e\u8457 sssp-lj, sssp-sk, sssp-po &gt;55% DRAM\u505c\u987f\u4e3a\u4e3b\uff0cBranch-stall \u8f83\u9ad8 spmv, symgs &gt;80% \u8ba1\u7b97\u5bc6\u96c6\u578b\u4f46\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u4e0d\u89c4\u5219\uff0cDRAM\u505c\u987f\u6781\u9ad8 cg, is &gt;75% \u6d41\u4f53\u52a8\u529b\u5b66\u5e94\u7528\uff0c\u540c\u6837\u53d7DRAM\u505c\u987f\u4e25\u91cd\u5236\u7ea6 <ul> <li>\u603b\u4f53\u6765\u770b\uff0c\u8be5\u56fe\u6e05\u6670\u5730\u8868\u660e\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u51cf\u5c11 DRAM stalls \u662f\u63d0\u5347\u6027\u80fd\u7684\u5173\u952e\uff0c\u800c Prodigy \u6b63\u662f\u4e3a\u6b64\u76ee\u7684\u800c\u8bbe\u8ba1\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-5-proposed-data-indirection-graph-dig-representationa-example-representation-for-bfs-b-data-structure-memory-layout-and-algorithmic-traversal-information-captured-by-a-dig-node-and-a-weighted-dig-edge-respectively-two-unique-data-dependent-indirection-patterns-supported-by-prodigyc-single-valued-indirection-and-d-ranged-indirection","title":"Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u4e2d\u6838\u5fc3\u7684\u6570\u636e\u7ed3\u6784\u62bd\u8c61\u2014\u2014Data Indirection Graph (DIG)\uff0c\u7528\u4e8e\u63cf\u8ff0\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u7279\u522b\u662f\u9488\u5bf9 BFS \u7b97\u6cd5\u7684\u793a\u4f8b\u3002</li> <li>\u56fe (a) \u5448\u73b0\u4e86 BFS \u7b97\u6cd5\u7684 DIG \u8868\u793a\uff1a\u8282\u70b9\u4ee3\u8868\u5173\u952e\u6570\u636e\u7ed3\u6784\uff08\u5982 workQ\u3001offsetList\u3001edgeList\u3001visited\uff09\uff0c\u8fb9\u8868\u793a\u5b83\u4eec\u4e4b\u95f4\u7684\u6570\u636e\u4f9d\u8d56\u8bbf\u95ee\u5173\u7cfb\u3002\u8fb9\u4e0a\u7684\u6743\u91cd w0 \u548c w1 \u5206\u522b\u5bf9\u5e94\u4e24\u79cd\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff1bw2 \u4e3a\u89e6\u53d1\u8fb9\uff0c\u7528\u4e8e\u542f\u52a8\u9884\u53d6\u5e8f\u5217\u3002</li> <li>\u56fe (b) \u8be6\u7ec6\u8bf4\u660e\u4e86 DIG \u8282\u70b9\u548c\u8fb9\u6240\u6355\u83b7\u7684\u4fe1\u606f\uff1a</li> <li>\u8282\u70b9\u4fe1\u606f\u5305\u542b node_id\u3001base_addr\u3001capacity \u548c data_size\uff0c\u7528\u4e8e\u63cf\u8ff0\u6570\u636e\u7ed3\u6784\u7684\u5185\u5b58\u5e03\u5c40\u3002</li> <li>\u8fb9\u4fe1\u606f\u5305\u542b src_base_addr\u3001dest_base_addr \u548c edge_type\uff0c\u7528\u4e8e\u63cf\u8ff0\u7b97\u6cd5\u904d\u5386\u6a21\u5f0f\u3002</li> <li>\u56fe (c) \u5c55\u793a\u4e86 single-valued indirection (w0) \u6a21\u5f0f\uff1a\u6e90\u6570\u7ec4 a \u7684\u5143\u7d20\u4f5c\u4e3a\u7d22\u5f15\u53bb\u8bbf\u95ee\u76ee\u6807\u6570\u7ec4 b\uff0c\u4f8b\u5982 <code>tmp += b[a[i]]</code>\u3002\u56fe\u4e2d\u7528\u7d2b\u8272\u9ad8\u4eae\u663e\u793a\u4e86\u7d22\u5f15\u503c 3 \u5bf9\u5e94\u8bbf\u95ee b[3] = 56\u3002</li> <li>\u56fe (d) \u5c55\u793a\u4e86 ranged indirection (w1) \u6a21\u5f0f\uff1a\u6e90\u6570\u7ec4 a \u7684\u8fde\u7eed\u4e24\u4e2a\u5143\u7d20 a[i] \u548c a[i+1] \u4f5c\u4e3a\u8fb9\u754c\uff0c\u8bbf\u95ee\u76ee\u6807\u6570\u7ec4 b \u4e2d\u7684\u4e00\u4e2a\u8303\u56f4\uff0c\u4f8b\u5982 <code>for(j=a[i]; j&lt;a[i+1]; ++j) tmp += b[j]</code>\u3002\u56fe\u4e2d\u7528\u7d2b\u8272\u9ad8\u4eae\u663e\u793a\u4e86 i=1 \u65f6\uff0c\u8bbf\u95ee b[4] \u5230 b[5] \u7684\u8303\u56f4\u3002</li> <li>\u8be5\u56fe\u6e05\u6670\u5730\u5c06\u590d\u6742\u7684\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u62bd\u8c61\u4e3a\u4e00\u4e2a\u52a0\u6743\u6709\u5411\u56fe\uff0c\u4fbf\u4e8e\u786c\u4ef6\u9884\u53d6\u5668\u7406\u89e3\u548c\u6267\u884c\u3002</li> </ul> \u7ec4\u4ef6 \u5185\u5bb9 \u8bf4\u660e \u56fe (a) BFS \u7684 DIG \u8868\u793a \u8282\u70b9\uff1aworkQ, offsetList, edgeList, visited\uff1b\u8fb9\uff1aw0, w1, w2 \u56fe (b) \u8282\u70b9\u4e0e\u8fb9\u4fe1\u606f \u8282\u70b9\uff1anode_id, base_addr, capacity, data_size\uff1b\u8fb9\uff1asrc_base_addr, dest_base_addr, edge_type \u56fe (c) Single-valued indirection (w0) \u793a\u4f8b\uff1a<code>b[a[i]]</code>\uff0c\u7d22\u5f15\u503c 3 \u8bbf\u95ee b[3] = 56 \u56fe (d) Ranged indirection (w1) \u793a\u4f8b\uff1a<code>b[j] for j in [a[i], a[i+1])</code>\uff0ci=1 \u65f6\u8bbf\u95ee b[4] \u5230 b[5] <ul> <li>\u6b64\u56fe\u662f\u7406\u89e3 Prodigy \u5982\u4f55\u901a\u8fc7\u8f6f\u4ef6\u5206\u6790\u63d0\u53d6\u7a0b\u5e8f\u8bed\u4e49\uff0c\u5e76\u5c06\u5176\u7f16\u7801\u4e3a\u786c\u4ef6\u53ef\u8bc6\u522b\u7684 DIG \u7ed3\u6784\u7684\u5173\u952e\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-6-annotated-bfs-source-code-to-construct-the-dig","title":"Figure 6. Annotated BFS source code to construct the DIG.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 BFS \u7b97\u6cd5\u6e90\u4ee3\u7801\u7684\u7247\u6bb5\uff0c\u91cd\u70b9\u5728\u4e8e\u5982\u4f55\u901a\u8fc7 \u7a0b\u5e8f\u5458\u624b\u52a8\u6ce8\u89e3 \u6765\u6784\u5efa Data Indirection Graph (DIG)\u3002</li> <li>\u4ee3\u7801\u4e2d\u7b2c 9 \u81f3 16 \u884c\u88ab\u9ad8\u4eae\u6807\u8bb0\uff0c\u8fd9\u4e9b\u662f\u7528\u4e8e\u6ce8\u518c DIG \u8282\u70b9\u548c\u8fb9\u7684\u6838\u5fc3 API \u8c03\u7528\u3002</li> <li>registerNode() \u7528\u4e8e\u5411\u786c\u4ef6 prefetcher \u6ce8\u518c\u6570\u636e\u7ed3\u6784\u8282\u70b9\uff0c\u53c2\u6570\u5305\u62ec\uff1a\u6570\u636e\u7ed3\u6784\u6307\u9488\u3001\u5143\u7d20\u603b\u6570\u3001\u6bcf\u4e2a\u5143\u7d20\u5927\u5c0f\uff08\u5b57\u8282\uff09\u3001\u8282\u70b9 ID\u3002\u4f8b\u5982\uff1a</li> <li><code>registerNode(&amp;workQueue, g.numNodes(), 4, 0);</code> \u6ce8\u518c\u5de5\u4f5c\u961f\u5217\uff0cID \u4e3a 0\u3002</li> <li><code>registerNode(offsetlist, g.numNodes()+1, 4, 1);</code> \u6ce8\u518c\u504f\u79fb\u5217\u8868\uff0cID \u4e3a 1\u3002</li> <li><code>registerNode(edgelist, g.numEdges(), 4, 2);</code> \u6ce8\u518c\u8fb9\u5217\u8868\uff0cID \u4e3a 2\u3002</li> <li><code>registerNode(visited, g.numNodes(), 4, 3);</code> \u6ce8\u518c\u8bbf\u95ee\u6807\u8bb0\u6570\u7ec4\uff0cID \u4e3a 3\u3002</li> <li>registerTravEdge() \u7528\u4e8e\u6ce8\u518c\u6570\u636e\u7ed3\u6784\u95f4\u7684\u904d\u5386\u8fb9\uff08\u5373\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff09\uff0c\u53c2\u6570\u5305\u62ec\uff1a\u6e90\u8282\u70b9\u5730\u5740\u3001\u76ee\u6807\u8282\u70b9\u5730\u5740\u3001\u8fb9\u7c7b\u578b\uff08w0 \u6216 w1\uff09\u3002\u4f8b\u5982\uff1a</li> <li><code>registerTravEdge(&amp;workQueue, offsetlist, w0);</code> \u8868\u793a\u4ece workQueue \u5230 offsetlist \u7684\u5355\u503c\u95f4\u63a5\u8bbf\u95ee\uff08single-valued indirection\uff09\u3002</li> <li><code>registerTravEdge(edgelist, visited, w0);</code> \u8868\u793a\u4ece edgelist \u5230 visited \u7684\u5355\u503c\u95f4\u63a5\u8bbf\u95ee\u3002</li> <li>registerTrigEdge() \u7528\u4e8e\u6ce8\u518c\u89e6\u53d1\u8fb9\uff08trigger edge\uff09\uff0c\u53c2\u6570\u5305\u62ec\uff1a\u89e6\u53d1\u6570\u636e\u7ed3\u6784\u5730\u5740\u3001\u8fb9\u7c7b\u578b\uff08w2\uff09\u3002\u4f8b\u5982\uff1a</li> <li><code>registerTrigEdge(&amp;workQueue, w2);</code> \u8868\u793a\u5f53\u5bf9 workQueue \u53d1\u751f\u9700\u6c42\u52a0\u8f7d\u65f6\uff0c\u89e6\u53d1 prefetch \u5e8f\u5217\u3002</li> <li>\u8fd9\u4e9b API \u8c03\u7528\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u4f1a\u88ab\u7ffb\u8bd1\u6210\u5bf9 prefetcher \u5c40\u90e8\u5b58\u50a8\u5668\u7684\u5199\u5165\u64cd\u4f5c\uff0c\u4ece\u800c\u5c06 DIG \u7ed3\u6784\u4f20\u9012\u7ed9\u786c\u4ef6\u3002</li> <li>\u6b64\u65b9\u6cd5\u4f9d\u8d56\u7a0b\u5e8f\u5458\u5bf9\u7b97\u6cd5\u6570\u636e\u7ed3\u6784\u548c\u8bbf\u95ee\u6a21\u5f0f\u7684\u6df1\u523b\u7406\u89e3\uff0c\u9002\u7528\u4e8e\u590d\u6742\u6216\u96be\u4ee5\u81ea\u52a8\u5206\u6790\u7684\u573a\u666f\u3002</li> <li>\u4e0e\u7f16\u8bd1\u5668\u81ea\u52a8\u5206\u6790\u76f8\u6bd4\uff0c\u624b\u52a8\u6ce8\u89e3\u66f4\u7cbe\u786e\uff0c\u4f46\u589e\u52a0\u4e86\u5f00\u53d1\u8d1f\u62c5\uff1b\u4e24\u8005\u53ef\u7ed3\u5408\u4f7f\u7528\u4ee5\u63d0\u9ad8\u6574\u4f53\u51c6\u786e\u6027\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-7-an-example-c-program-a-and-b-translated-into-llvm-ir-c-and-instrumented-with-our-api-calls-to-register-dig-nodes-and-edges-figure-8-pseudocode-of-prodigys-compiler-analyses-for-a-node-identification-b-single-valued-indirection-c-ranged-indirection-and-d-runtime","title":"Figure 7. An example C program (a) and (b), translated into LLVM IR (c) and instrumented with our API calls to register DIG nodes and edges. Figure 8. Pseudocode of Prodigy\u2019s compiler analyses for (a) node identification, (b) single-valued indirection, (c) ranged indirection, and (d) runtime.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u4e2d \u7f16\u8bd1\u5668\u5206\u6790\u4e0e\u4ee3\u7801\u751f\u6210 \u7684\u5173\u952e\u6b65\u9aa4\uff0c\u901a\u8fc7\u4e00\u4e2a C \u8bed\u8a00\u793a\u4f8b\u7a0b\u5e8f\u53ca\u5176\u5bf9\u5e94\u7684 LLVM IR \u4ee3\u7801\uff0c\u8bf4\u660e\u5982\u4f55\u81ea\u52a8\u63d2\u5165 API \u8c03\u7528\u4ee5\u6784\u5efa Data Indirection Graph (DIG)\u3002</li> <li>\u56fe (a) \u662f\u4e3b\u51fd\u6570 <code>main()</code>\uff0c\u5176\u4e2d\u8c03\u7528 <code>malloc</code> \u5206\u914d\u4e24\u4e2a\u6570\u7ec4 <code>a</code> \u548c <code>b</code>\uff0c\u7136\u540e\u8c03\u7528 <code>kernel</code> \u51fd\u6570\u5904\u7406\u6570\u636e\u3002</li> <li>\u56fe (b) \u662f <code>kernel</code> \u51fd\u6570\u7684\u6e90\u7801\uff0c\u5176\u6838\u5fc3\u662f\u5355\u503c\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff1a<code>*(dst+i) = b[a[i]]</code>\uff0c\u5373\u4f7f\u7528\u6570\u7ec4 <code>a</code> \u7684\u5143\u7d20\u4f5c\u4e3a\u7d22\u5f15\u53bb\u8bbf\u95ee\u6570\u7ec4 <code>b</code>\uff0c\u5e76\u5c06\u7ed3\u679c\u5199\u5165 <code>dst</code>\u3002\u8fd9\u6b63\u662f Prodigy \u652f\u6301\u7684 single-valued indirection \u6a21\u5f0f\u3002</li> <li>\u56fe (c) \u662f\u7ecf\u8fc7\u7f16\u8bd1\u5668\u5206\u6790\u548c\u63d2\u6869\u540e\u7684 LLVM IR \u4ee3\u7801\uff0c\u7eff\u8272\u9ad8\u4eae\u90e8\u5206\u4e3a\u63d2\u5165\u7684 API \u8c03\u7528\uff1a</li> <li>\u5728 <code>main</code> \u51fd\u6570\u4e2d\uff0c\u7b2c 15 \u884c\u548c\u7b2c 17 \u884c\u5206\u522b\u8c03\u7528 <code>@registerNode</code> \u6765\u6ce8\u518c\u6570\u7ec4 <code>a</code> \u548c <code>b</code> \u7684\u8282\u70b9\u4fe1\u606f\uff08\u57fa\u5730\u5740\u3001\u5927\u5c0f\u3001\u5143\u7d20\u5c3a\u5bf8\u7b49\uff09\u3002</li> <li>\u5728 <code>kernel</code> \u51fd\u6570\u4e2d\uff0c\u7b2c 2 \u884c\u548c\u7b2c 3 \u884c\u8c03\u7528 <code>@registerTrigEdge</code> \u548c <code>@registerTravEdge</code> \u6765\u6ce8\u518c\u89e6\u53d1\u8fb9\u548c\u904d\u5386\u8fb9\uff0c\u4ece\u800c\u5b9a\u4e49\u4e86\u4ece <code>a</code> \u5230 <code>b</code> \u7684\u95f4\u63a5\u8bbf\u95ee\u8def\u5f84\u3002</li> <li>\u7f16\u8bd1\u5668\u5206\u6790\u6d41\u7a0b\u5982\u4e0b\uff1a</li> <li>\u8282\u70b9\u8bc6\u522b\uff1a\u626b\u63cf <code>malloc</code> \u8c03\u7528\uff0c\u63d0\u53d6\u5206\u914d\u4fe1\u606f\u5e76\u63d2\u5165 <code>registerNode</code>\u3002</li> <li>\u8fb9\u8bc6\u522b\uff1a\u8ddf\u8e2a\u6307\u9488\u6216\u6570\u7ec4\u7d22\u5f15\u7684\u4f7f\u7528\uff0c\u8bc6\u522b\u5982 <code>b[a[i]]</code> \u8fd9\u6837\u7684\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5e76\u63d2\u5165 <code>registerTravEdge</code>\u3002</li> <li>\u89e6\u53d1\u8fb9\u8bc6\u522b\uff1a\u786e\u5b9a\u54ea\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\u4f1a\u542f\u52a8\u9884\u53d6\u5e8f\u5217\uff0c\u63d2\u5165 <code>registerTrigEdge</code>\u3002</li> <li>\u63d2\u5165\u7684 API \u8c03\u7528\u5728\u8fd0\u884c\u65f6\u4f1a\u88ab\u7ffb\u8bd1\u6210\u5bf9\u786c\u4ef6\u9884\u53d6\u5668\u672c\u5730\u5185\u5b58\u7684\u5b58\u50a8\u64cd\u4f5c\uff0c\u4ece\u800c\u5c06 DIG \u7ed3\u6784\u52a0\u8f7d\u5230\u786c\u4ef6\u4e2d\uff0c\u6307\u5bfc\u540e\u7eed\u7684\u667a\u80fd\u9884\u53d6\u884c\u4e3a\u3002</li> </ul> \u4ee3\u7801\u6bb5 \u5185\u5bb9 \u4f5c\u7528 (a) C \u6e90\u7801 <code>int *a = malloc(size); int *b = malloc(size);</code> \u5206\u914d\u4e24\u4e2a\u6570\u7ec4\uff0c\u4f5c\u4e3a DIG \u7684\u8282\u70b9\u3002 (b) C \u6e90\u7801 <code>*(dst+i) = b[a[i]];</code> \u5c55\u793a single-valued indirection \u6a21\u5f0f\uff0c\u662f DIG \u8fb9\u7684\u6838\u5fc3\u8bed\u4e49\u3002 (c) LLVM IR <code>call i32 @registerNode(...)</code> \u6ce8\u518c\u6570\u7ec4 <code>a</code> \u548c <code>b</code> \u4e3a DIG \u8282\u70b9\u3002 (c) LLVM IR <code>call i32 @registerTravEdge(...)</code> \u6ce8\u518c\u4ece <code>a</code> \u5230 <code>b</code> \u7684\u904d\u5386\u8fb9\uff0c\u5b9a\u4e49\u95f4\u63a5\u8bbf\u95ee\u5173\u7cfb\u3002 (c) LLVM IR <code>call i32 @registerTrigEdge(...)</code> \u6ce8\u518c\u89e6\u53d1\u8fb9\uff0c\u6307\u5b9a\u9884\u53d6\u5e8f\u5217\u7684\u8d77\u70b9\u3002 <ul> <li>\u6b64\u8fc7\u7a0b\u4f53\u73b0\u4e86 Prodigy \u7684 \u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1 \u6838\u5fc3\u601d\u60f3\uff1a\u8f6f\u4ef6\u5728\u7f16\u8bd1\u671f\u5206\u6790\u7a0b\u5e8f\u8bed\u4e49\uff0c\u751f\u6210\u7d27\u51d1\u7684 DIG \u8868\u793a\uff1b\u786c\u4ef6\u5728\u8fd0\u884c\u65f6\u5229\u7528\u8be5\u8868\u793a\u8fdb\u884c\u7cbe\u51c6\u3001\u53ca\u65f6\u7684\u9884\u53d6\uff0c\u4ece\u800c\u663e\u8457\u63d0\u5347\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u7684\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#e07c49a73e951c7eafd1576c2ab0b0ff1c2821d5841a7e7696a7c0d01227b5f4jpg","title":"e07c49a73e951c7eafd1576c2ab0b0ff1c2821d5841a7e7696a7c0d01227b5f4.jpg","text":"<ul> <li>\u56fe\u7247 e07c49a73e951c7eafd1576c2ab0b0ff1c2821d5841a7e7696a7c0d01227b5f4.jpg \u5c55\u793a\u7684\u662f Data Indirection Graph (DIG) \u4e2d\u7684 Node Table \u7ed3\u6784\uff0c\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u7ed3\u6784\u7684\u5185\u5b58\u5e03\u5c40\u4fe1\u606f\u3002</li> <li>\u8be5\u8868\u683c\u5305\u542b\u4e94\u5217\uff1aNode ID\u3001Base Address\u3001Bound Address\u3001Data Size \u548c Trigger\uff0c\u5171\u56db\u884c\u6570\u636e\uff0c\u5bf9\u5e94\u56db\u4e2a\u4e0d\u540c\u7684\u6570\u636e\u7ed3\u6784\u8282\u70b9\u3002</li> <li>\u8868\u683c\u5185\u5bb9\u5982\u4e0b\uff1a</li> </ul> Node ID Base Address Bound Address Data Size Trigger 0 0x00010 0x0019C 4 true 1 0x001A0 0x00330 4 false 2 0x00334 0x00800 4 false 3 0x00B04 0x00C90 4 false <ul> <li>Node ID \u662f\u6bcf\u4e2a\u6570\u636e\u7ed3\u6784\u5728 DIG \u4e2d\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u4ece 0 \u5f00\u59cb\u7f16\u53f7\u3002</li> <li>Base Address \u548c Bound Address \u5b9a\u4e49\u4e86\u8be5\u6570\u636e\u7ed3\u6784\u5728\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740\uff0c\u7528\u4e8e\u754c\u5b9a\u5176\u5185\u5b58\u8303\u56f4\u3002</li> <li>Data Size \u8868\u793a\u8be5\u6570\u636e\u7ed3\u6784\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u5927\u5c0f\uff08\u5355\u4f4d\u4e3a\u5b57\u8282\uff09\uff0c\u6b64\u5904\u6240\u6709\u8282\u70b9\u5747\u4e3a 4 \u5b57\u8282\uff0c\u8868\u660e\u5b83\u4eec\u53ef\u80fd\u5b58\u50a8\u7684\u662f\u6574\u578b\u6216\u6307\u9488\u7c7b\u578b\u7684\u6570\u636e\u3002</li> <li>Trigger \u5217\u6307\u793a\u8be5\u8282\u70b9\u662f\u5426\u4e3a\u89e6\u53d1\u8282\u70b9\u3002\u53ea\u6709 Node ID 0 \u7684 Trigger \u503c\u4e3a true\uff0c\u610f\u5473\u7740\u5b83\u662f prefetch \u5e8f\u5217\u7684\u542f\u52a8\u70b9\uff0c\u5f53\u6838\u5fc3\u8bbf\u95ee\u8be5\u6570\u636e\u7ed3\u6784\u65f6\uff0c\u4f1a\u89e6\u53d1 Prodigy \u786c\u4ef6\u9884\u53d6\u5668\u5f00\u59cb\u5de5\u4f5c\u3002</li> <li>\u6b64\u8868\u662f Prodigy \u7cfb\u7edf\u4e2d\u8f6f\u4ef6\u5411\u786c\u4ef6\u4f20\u9012\u7a0b\u5e8f\u8bed\u4e49\u7684\u5173\u952e\u90e8\u5206\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u4f9d\u8d56\u6b64\u4fe1\u606f\u6765\u7406\u89e3\u6570\u636e\u7ed3\u6784\u7684\u5e03\u5c40\uff0c\u5e76\u636e\u6b64\u53d1\u8d77\u7cbe\u51c6\u7684\u9884\u53d6\u64cd\u4f5c\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#4a2cabf5d6dd1d1d6a8307c24adaae5d474555da4b2655e414675f0b5f569851jpg","title":"4a2cabf5d6dd1d1d6a8307c24adaae5d474555da4b2655e414675f0b5f569851.jpg","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u4e2d\u7528\u4e8e\u5b58\u50a8 Data Indirection Graph (DIG) \u7684\u786c\u4ef6\u6570\u636e\u7ed3\u6784\uff0c\u5177\u4f53\u4e3a Edge Index Table \u548c Edge Table\u3002</li> <li>\u8be5\u56fe\u662f\u8bba\u6587\u7b2c IV \u8282 \u201cPROPOSED HARDWARE DESIGN\u201d \u4e2d Figure 9 \u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u8bf4\u660e DIG \u5728\u786c\u4ef6\u4e2d\u7684\u5b58\u50a8\u65b9\u5f0f\u3002</li> <li>Edge Index Table (b) \u662f\u4e00\u4e2a\u7d22\u5f15\u8868\uff0c\u5176\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u8f6f\u4ef6\u4e2d\u7684 offset list\u3002\u5b83\u901a\u8fc7 Edge Index \u6765\u5b9a\u4f4d Edge Table \u4e2d\u7684\u8fb9\u8bb0\u5f55\u3002<ul> <li>\u8868\u683c\u5185\u5bb9\u5982\u4e0b\uff1a     | Edge Index |     |------------|     | 0          |     | 1          |     | 2          |</li> <li>\u6b64\u8868\u8868\u660e\u7cfb\u7edf\u4e2d\u81f3\u5c11\u6709\u4e09\u6761\u8fb9\uff08\u7d22\u5f15 0, 1, 2\uff09\uff0c\u7528\u4e8e\u5feb\u901f\u67e5\u627e\u5bf9\u5e94\u7684\u8fb9\u4fe1\u606f\u3002</li> </ul> </li> <li>Edge Table (c) \u5b58\u50a8\u4e86 DIG \u4e2d\u6bcf\u6761\u8fb9\u7684\u5177\u4f53\u5c5e\u6027\uff0c\u5305\u62ec\u6e90\u8282\u70b9\u5730\u5740\u3001\u76ee\u6807\u8282\u70b9\u5730\u5740\u548c\u8fb9\u7c7b\u578b\u3002<ul> <li>\u8868\u683c\u5185\u5bb9\u5982\u4e0b\uff1a     | Src Node Addr | Dest Node Addr | Edge Type |     |---------------|----------------|---------|     | 0x00010       | 0x001A0        | 0       |     | 0x001A0       | 0x00334        | 1       |     | 0x00334       | 0x00B04        | 0       |</li> <li>Src Node Addr \u548c Dest Node Addr \u5206\u522b\u4ee3\u8868\u6e90\u8282\u70b9\u548c\u76ee\u6807\u8282\u70b9\u5728\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u57fa\u5730\u5740\u3002</li> <li>Edge Type \u5b57\u6bb5\u5b9a\u4e49\u4e86\u8fb9\u7684\u8bed\u4e49\uff0c\u5176\u4e2d <code>0</code> \u4ee3\u8868 single-valued indirection\uff0c<code>1</code> \u4ee3\u8868 ranged indirection\u3002</li> <li>\u4ece\u6570\u636e\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e09\u6761\u8fb9\u6784\u6210\u4e86\u4e00\u4e2a\u94fe\u5f0f\u8bbf\u95ee\u8def\u5f84\uff1a\u4ece\u5730\u5740 <code>0x00010</code> \u5f00\u59cb\uff0c\u7ecf\u7531\u5355\u503c\u95f4\u63a5\u8bbf\u95ee\u5230 <code>0x001A0</code>\uff0c\u518d\u7ecf\u7531\u8303\u56f4\u95f4\u63a5\u8bbf\u95ee\u5230 <code>0x00334</code>\uff0c\u6700\u540e\u53c8\u901a\u8fc7\u5355\u503c\u95f4\u63a5\u8bbf\u95ee\u5230 <code>0x00B04</code>\u3002</li> </ul> </li> <li>\u8fd9\u4e24\u4e2a\u8868\u683c\u5171\u540c\u6784\u6210\u4e86 Prodigy \u786c\u4ef6 prefetcher \u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\uff0c\u4f7f\u5176\u80fd\u591f\u6839\u636e\u8f6f\u4ef6\u63d0\u4f9b\u7684 DIG \u4fe1\u606f\uff0c\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u5730\u8ffd\u8e2a\u5e76\u9884\u6d4b\u590d\u6742\u7684\u3001\u6570\u636e\u4f9d\u8d56\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#263b45db76ec05b420895ede981413959e85de76e14a9be9726b1ebafa53ec52jpg","title":"263b45db76ec05b420895ede981413959e85de76e14a9be9726b1ebafa53ec52.jpg","text":"<ul> <li>\u8be5\u56fe\u50cf\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u4e2d Prefetch Status Handling Register (PFHR) \u6587\u4ef6 \u7684\u4e00\u4e2a\u5feb\u7167\uff0c\u7528\u4e8e\u8ddf\u8e2a\u591a\u4e2a\u5e76\u53d1\u9884\u53d6\u5e8f\u5217\u7684\u72b6\u6001\u3002</li> <li>PFHR \u662f Prodigy \u786c\u4ef6\u8bbe\u8ba1\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u5176\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u7f13\u5b58\u4e2d\u7684 Miss Status Handling Registers (MSHRs)\uff0c\u4f46\u4e13\u95e8\u9488\u5bf9\u957f\u94fe\u5f0f\u3001\u6570\u636e\u4f9d\u8d56\u7684\u9884\u53d6\u5e8f\u5217\u8fdb\u884c\u7ba1\u7406\uff0c\u5e76\u652f\u6301\u975e\u963b\u585e\u9884\u53d6\u3002</li> <li>\u56fe\u50cf\u4e2d\u7684\u8868\u683c\u5305\u542b\u4e94\u5217\uff0c\u5206\u522b\u8bb0\u5f55\u4e86\u6bcf\u4e2a PFHR \u6761\u76ee\u7684\u5173\u952e\u72b6\u6001\u4fe1\u606f\uff1a</li> <li>Free: \u6807\u8bc6\u8be5\u6761\u76ee\u662f\u5426\u7a7a\u95f2\uff08<code>true</code>/<code>false</code>\uff09\u3002</li> <li>Node ID: \u5173\u8054\u7684 DIG \u8282\u70b9\u6807\u8bc6\u7b26\uff0c\u6307\u5411\u5f53\u524d\u9884\u53d6\u8bf7\u6c42\u6240\u6d89\u53ca\u7684\u6570\u636e\u7ed3\u6784\u3002</li> <li>Prefetch Trigger Addr: \u89e6\u53d1\u8be5\u9884\u53d6\u5e8f\u5217\u7684\u521d\u59cb\u865a\u62df\u5730\u5740\u3002\u5f53\u6838\u5fc3\u8bbf\u95ee\u5230\u6b64\u5730\u5740\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8bc4\u4f30\u662f\u5426\u9700\u8981\u4e22\u5f03\u8be5\u5e8f\u5217\u4ee5\u4fdd\u6301\u53ca\u65f6\u6027\u3002</li> <li>Outstanding Prefetch Addr: \u5f53\u524d\u6b63\u5728\u7b49\u5f85\u54cd\u5e94\u7684\u9884\u53d6\u8bf7\u6c42\u7684\u7269\u7406\u5730\u5740\uff08\u5df2\u5bf9\u9f50\u5230\u7f13\u5b58\u884c\uff09\u3002</li> <li>Offset Bitmap: \u4e00\u4e2a\u4f4d\u56fe\uff0c\u6807\u8bb0\u5728\u4e0a\u8ff0\u7f13\u5b58\u884c\u5185\u54ea\u4e9b\u5b57\u8282\u504f\u79fb\u91cf\u5bf9\u5e94\u7684\u9884\u53d6\u8bf7\u6c42\u662f\u201c\u5f85\u5904\u7406\u201d\u7684\u3002</li> </ul> Free Node ID Prefetch Trigger Addr Outstanding Prefetch Addr Offset Bitmap false 2 0x00020 0x00468 01010000 true 0 0x00108 0x00108 01000000 false 1 0x00080 0x00200 00011100 false 2 0x00188 0x00A00 01111100 <ul> <li>\u8868\u683c\u5185\u5bb9\u5206\u6790\uff1a</li> <li>\u7b2c\u4e00\u884c\uff1a\u4e00\u4e2a\u7531 Node ID 2 \u53d1\u8d77\u7684\u9884\u53d6\u5e8f\u5217\u5904\u4e8e\u6d3b\u8dc3\u72b6\u6001\uff08<code>Free=false</code>\uff09\uff0c\u5176\u89e6\u53d1\u5730\u5740\u4e3a <code>0x00020</code>\uff0c\u5f53\u524d\u6b63\u5728\u7b49\u5f85\u7269\u7406\u5730\u5740 <code>0x00468</code> \u7684\u6570\u636e\u8fd4\u56de\u3002\u4f4d\u56fe <code>01010000</code> \u8868\u660e\u8be5\u7f13\u5b58\u884c\u5185\u7684\u7b2c1\u4f4d\u548c\u7b2c3\u4f4d\uff08\u4ece\u53f3\u81f3\u5de6\u8ba1\u6570\uff09\u5bf9\u5e94\u7684\u5b57\u8282\u504f\u79fb\u91cf\u6709\u672a\u5b8c\u6210\u7684\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>\u7b2c\u4e8c\u884c\uff1a\u4e00\u4e2a\u6761\u76ee\u4e3a\u7a7a\u95f2\u72b6\u6001\uff08<code>Free=true</code>\uff09\uff0c\u8868\u660e\u8be5 PFHR \u53ef\u88ab\u5206\u914d\u7ed9\u65b0\u7684\u9884\u53d6\u5e8f\u5217\u3002</li> <li>\u7b2c\u4e09\u884c\uff1a\u4e00\u4e2a\u7531 Node ID 1 \u53d1\u8d77\u7684\u5e8f\u5217\u6b63\u5728\u7b49\u5f85\u5730\u5740 <code>0x00200</code> \u7684\u6570\u636e\uff0c\u5176\u89e6\u53d1\u5730\u5740\u4e3a <code>0x00080</code>\u3002</li> <li> <p>\u7b2c\u56db\u884c\uff1a\u53e6\u4e00\u4e2a\u7531 Node ID 2 \u53d1\u8d77\u7684\u5e8f\u5217\u6b63\u5728\u7b49\u5f85\u5730\u5740 <code>0x00A00</code> \u7684\u6570\u636e\uff0c\u89e6\u53d1\u5730\u5740\u4e3a <code>0x00188</code>\u3002\u8fd9\u8868\u660e\u540c\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff08Node ID 2\uff09\u53ef\u4ee5\u540c\u65f6\u53d1\u8d77\u591a\u4e2a\u72ec\u7acb\u7684\u9884\u53d6\u5e8f\u5217\u3002</p> </li> <li> <p>\u6b64\u8bbe\u8ba1\u5141\u8bb8 Prodigy \u5728\u786c\u4ef6\u5c42\u9762\u9ad8\u6548\u5730\u7ba1\u7406\u590d\u6742\u7684\u3001\u591a\u5c42\u7ea7\u7684\u9884\u53d6\u64cd\u4f5c\uff0c\u907f\u514d\u56e0\u7b49\u5f85\u5355\u4e00\u5e8f\u5217\u5b8c\u6210\u800c\u5bfc\u81f4\u7684\u963b\u585e\uff0c\u4ece\u800c\u6700\u5927\u5316\u5229\u7528\u5185\u5b58\u5e26\u5bbd\u5e76\u7ef4\u6301\u9884\u53d6\u7684\u53ca\u65f6\u6027\u3002</p> </li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-9-memory-structures-used-in-prodigya-node-table-b-edge-index-table-and-c-edge-table-for-storing-the-dig-representation-d-prefetch-status-handling-register-pfhr-file-tracking-progress-for-live-prefetch-sequences-and-issuing-non-blocking-prefetches-figure-10-prefetching-algorithm-initiates-prefetch-sequences-between-prefetch-bounds-j-and-k-and-advances-a-prefetch-sequence-using-software-defined-indirection-types-the-superscripts-denote-a-demand-d-or-a-prefetch-p-access","title":"Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u4e2d Prefetching Algorithm \u7684\u6838\u5fc3\u673a\u5236\uff0c\u5373\u5982\u4f55\u6839\u636e Data Indirection Graph (DIG) \u542f\u52a8\u548c\u63a8\u8fdb\u9884\u53d6\u5e8f\u5217\u3002</li> <li>\u8be5\u56fe\u63cf\u7ed8\u4e86\u4e00\u4e2a\u4ece Node\u2080 \u5230 Node\u208dN-1\u208e \u7684\u591a\u7ea7\u9884\u53d6\u8def\u5f84\uff0c\u5176\u4e2d N \u8868\u793a\u9884\u53d6\u6df1\u5ea6\uff08Prefetch depth\uff09\uff0c\u5373\u6570\u636e\u7ed3\u6784\u95f4\u95f4\u63a5\u8bbf\u95ee\u7684\u5c42\u7ea7\u6570\u3002</li> <li>\u5728\u8d77\u59cb\u8282\u70b9 Node\u2080 \u4e2d\uff0c\u7cfb\u7edf\u4f1a\u6839\u636e Prefetch bounds [j, k] \u53d1\u8d77\u591a\u4e2a\u5e76\u884c\u9884\u53d6\u8bf7\u6c42\uff0c\u4f8b\u5982 Node\u2080\u1d3e[i+j]\u3001Node\u2080\u1d3e[i+k]\uff0c\u8fd9\u4f53\u73b0\u4e86 Prodigy \u7684\u201c\u591a\u5e8f\u5217\u521d\u59cb\u5316\u201d\u7b56\u7565\uff0c\u4ee5\u5e94\u5bf9\u52a8\u6001\u6267\u884c\u901f\u5ea6\u3002</li> <li>\u6bcf\u4e2a\u9884\u53d6\u8bf7\u6c42\u901a\u8fc7 Indirection type\uff08\u7531\u8f6f\u4ef6\u5b9a\u4e49\uff09\u89e6\u53d1\u5bf9\u4e0b\u4e00\u8282\u70b9\uff08\u5982 Node\u2081\uff09\u7684\u8bbf\u95ee\uff0c\u5f62\u6210\u94fe\u5f0f\u9884\u53d6\u3002\u56fe\u4e2d\u7528\u4e0d\u540c\u989c\u8272\u5757\u8868\u793a\u4e0d\u540c\u6570\u636e\u5143\u7d20\u6216\u7f13\u5b58\u884c\u3002</li> <li>\u8d85\u7ea7\u811a\u672c D \u548c P \u5206\u522b\u4ee3\u8868 Demand access\uff08\u9700\u6c42\u8bbf\u95ee\uff09\u548c Prefetch access\uff08\u9884\u53d6\u8bbf\u95ee\uff09\uff0c\u8868\u660e\u7cfb\u7edf\u80fd\u533a\u5206\u5e76\u5904\u7406\u4e24\u79cd\u7c7b\u578b\u7684\u5185\u5b58\u8bf7\u6c42\u3002</li> <li>\u8be5\u8bbe\u8ba1\u5141\u8bb8 Prodigy \u5728\u786c\u4ef6\u5c42\u9762\u52a8\u6001\u8ffd\u8e2a\u6bcf\u4e2a\u9884\u53d6\u5e8f\u5217\u7684\u8fdb\u5ea6\uff0c\u5e76\u652f\u6301 \u975e\u963b\u585e\u9884\u53d6\uff0c\u907f\u514d\u56e0\u7b49\u5f85\u5355\u4e2a\u5e8f\u5217\u5b8c\u6210\u800c\u4e22\u5931\u5176\u4ed6\u9884\u53d6\u673a\u4f1a\u3002</li> <li>\u56fe\u4e2d\u7701\u7565\u53f7\uff08\u2026\uff09\u8868\u793a\u9884\u53d6\u8def\u5f84\u53ef\u5ef6\u4f38\u81f3\u4efb\u610f\u6df1\u5ea6 N\uff0c\u9002\u5e94\u4e0d\u540c\u7b97\u6cd5\u7684\u590d\u6742\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li>\u6b64\u673a\u5236\u7684\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u7ed3\u5408\u4e86\u8f6f\u4ef6\u63d0\u4f9b\u7684\u9759\u6001\u8bed\u4e49\u4fe1\u606f\uff08\u5982 DIG \u7ed3\u6784\uff09\u4e0e\u786c\u4ef6\u7684\u52a8\u6001\u8fd0\u884c\u65f6\u53cd\u9988\uff08\u5982\u89e6\u53d1\u5730\u5740\u3001PFHR \u72b6\u6001\uff09\uff0c\u5b9e\u73b0\u7cbe\u51c6\u4e14\u53ca\u65f6\u7684\u9884\u53d6\u3002</li> </ul> \u7ec4\u4ef6 \u529f\u80fd\u63cf\u8ff0 Prefetch bounds [j,k] \u5b9a\u4e49\u9884\u53d6\u7684\u8d77\u59cb\u504f\u79fb\u91cf j \u548c\u7ed3\u675f\u504f\u79fb\u91cf k\uff0c\u63a7\u5236\u9884\u53d6\u7684\u201c\u524d\u77bb\u8ddd\u79bb\u201d\u548c\u5e76\u53d1\u5ea6\u3002 Indirection type \u7531\u8f6f\u4ef6\u5728 DIG \u4e2d\u6307\u5b9a\uff0c\u51b3\u5b9a\u5982\u4f55\u4ece\u5f53\u524d\u8282\u70b9\u7684\u6570\u636e\u63a8\u5bfc\u51fa\u4e0b\u4e00\u8282\u70b9\u7684\u8bbf\u95ee\u5730\u5740\uff08\u5982\u5355\u503c\u6216\u8303\u56f4\u95f4\u63a5\uff09\u3002 Prefetch depth (N) \u9884\u53d6\u8def\u5f84\u8de8\u8d8a\u7684\u6570\u636e\u7ed3\u6784\u5c42\u6570\uff0c\u5f71\u54cd\u9884\u53d6\u7684\u590d\u6742\u6027\u548c\u5ef6\u8fdf\u9690\u85cf\u80fd\u529b\u3002 Node\u2080\u1d3e[i+j] \u7b49 \u8868\u793a\u9488\u5bf9 Node\u2080 \u7684\u7b2c i+j \u4e2a\u5143\u7d20\u53d1\u8d77\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u662f\u542f\u52a8\u6574\u4e2a\u9884\u53d6\u5e8f\u5217\u7684\u8d77\u70b9\u3002 D/P superscripts \u533a\u5206\u5185\u5b58\u8bbf\u95ee\u7c7b\u578b\uff0c\u7528\u4e8e\u6307\u5bfc\u786c\u4ef6\u5982\u4f55\u54cd\u5e94\u548c\u8c03\u5ea6\u8bf7\u6c42\u3002 <ul> <li>\u8be5\u56fe\u76f4\u89c2\u5730\u89e3\u91ca\u4e86 Prodigy \u5982\u4f55\u5c06\u62bd\u8c61\u7684 DIG \u8f6c\u5316\u4e3a\u5177\u4f53\u7684\u786c\u4ef6\u9884\u53d6\u884c\u4e3a\uff0c\u662f\u5176\u201c\u8f6f\u786c\u534f\u540c\u8bbe\u8ba1\u201d\u7406\u5ff5\u7684\u5173\u952e\u53ef\u89c6\u5316\u4f53\u73b0\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-11-prodigy-operation-a-prefetch-sequence-initialization-and-b-prefetch-sequence-advance","title":"Figure 11. Prodigy operation: (a) prefetch sequence initialization, and (b) prefetch sequence advance.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u5728\u8fd0\u884c\u65f6\u7684\u4e24\u4e2a\u6838\u5fc3\u9636\u6bb5\uff1a(a) Prefetch sequence initialization \u548c (b) Prefetch sequence advance\uff0c\u7528\u4e8e\u8bf4\u660e\u5176\u5982\u4f55\u6839\u636e Data Indirection Graph (DIG) \u52a8\u6001\u53d1\u8d77\u548c\u63a8\u8fdb\u9884\u53d6\u5e8f\u5217\u3002</li> <li>\u56fe\u4e2d\u5de6\u4fa7\u4e3a Core\uff08\u9ec4\u8272\u5706\u5708\uff09\uff0c\u4e2d\u95f4\u4e3a Memory system\uff08\u7070\u8272\u865a\u7ebf\u6846\uff09\uff0c\u53f3\u4fa7\u4e3a Prodigy \u786c\u4ef6\u6a21\u5757\uff08\u7eff\u8272\u533a\u57df\uff09\uff0c\u5305\u542b Node table\u3001Edge tables \u548c PFHR file\u3002\u53f3\u4e0a\u89d2\u56fe\u4f8b\u6e05\u6670\u6807\u6ce8\u4e86\u5404\u7ec4\u4ef6\u7b26\u53f7\u542b\u4e49\u3002</li> <li>\u5728\u9636\u6bb5 (a) \u4e2d\uff0cCore \u53d1\u8d77\u4e00\u6b21 load \u8bf7\u6c42\uff081\uff09\u5230\u5730\u5740 0x100\uff0c\u8be5\u5730\u5740\u5c5e\u4e8e\u89e6\u53d1\u6570\u636e\u7ed3\u6784\uff08\u5982 BFS \u7684 workQueue\uff09\u3002Prodigy \u6355\u83b7\u6b64\u8bf7\u6c42\u540e\uff0c\u8fdb\u5165\u521d\u59cb\u5316\u6d41\u7a0b\uff1a</li> <li>\u6b65\u9aa4 2.0.1: L1D snoop \u2014 Prodigy \u76d1\u542c\u5230 L1D \u7f13\u5b58\u7684 load \u8bf7\u6c42\u3002</li> <li>\u6b65\u9aa4 2.0.2: pf addr gen \u2014 \u6839\u636e DIG \u4e2d\u7684 trigger edge \u5b9a\u4e49\u7684 prefetch look-ahead distance\uff08\u5047\u8bbe\u4e3a 2\uff09\uff0c\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u9884\u53d6\u5730\u5740 0x108\uff080x100 + 2\u00d74\uff09\u3002</li> <li>\u6b65\u9aa4 2.0.3: allocate PFHR \u2014 \u5206\u914d\u4e00\u4e2a PFHR (Prefetch Status Handling Register) \u6761\u76ee\u6765\u8ddf\u8e2a\u6b64\u9884\u53d6\u5e8f\u5217\u3002</li> <li>\u968f\u540e\uff0cProdigy \u5411\u5185\u5b58\u7cfb\u7edf\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\uff082\uff09\uff0c\u76ee\u6807\u5730\u5740\u4e3a 0x108\uff0c\u5e76\u901a\u8fc7 TLB \u8f6c\u6362\u4e3a\u7269\u7406\u5730\u5740\u3002</li> <li>\u5728\u9636\u6bb5 (b) \u4e2d\uff0c\u5f53 Core \u53d1\u8d77\u53e6\u4e00\u6b21 load \u8bf7\u6c42\uff083\uff09\u5230\u5730\u5740 0x124 \u65f6\uff0c\u540c\u65f6\u9884\u53d6\u5730\u5740 0x108 \u7684\u6570\u636e\u5df2\u8fd4\u56de\uff084\uff09\uff0c\u89e6\u53d1\u9884\u53d6\u5e8f\u5217\u63a8\u8fdb\uff1a</li> <li>\u6b65\u9aa4 4.0.1: pf fill \u2014 Prodigy \u63a5\u6536\u5230\u9884\u53d6\u586b\u5145\u7684\u6570\u636e\u3002</li> <li>\u6b65\u9aa4 4.0.2: DIG edge + indirection \u2014 Prodigy \u4f7f\u7528\u63a5\u6536\u5230\u7684\u6570\u636e\uff08\u503c\u4e3a 2\uff09\u4f5c\u4e3a\u7d22\u5f15\uff0c\u7ed3\u5408 DIG \u4e2d\u5b58\u50a8\u7684\u8fb9\u4fe1\u606f\uff08\u4ece\u8282\u70b9 0x100 \u5230 0x11C \u7684 w0 \u8fb9\uff0c\u5373 single-valued indirection\uff09\uff0c\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u9884\u53d6\u5730\u5740 0x12C\u3002</li> <li>\u6b65\u9aa4 4.0.3: pf addr gen \u2014 \u751f\u6210\u65b0\u7684\u9884\u53d6\u5730\u5740 0x12C\u3002</li> <li>\u6b65\u9aa4 4.0.4: allocate PFHR \u2014 \u4e3a\u65b0\u9884\u53d6\u5206\u914d\u53e6\u4e00\u4e2a PFHR \u6761\u76ee\uff08\u82e5\u975e\u53f6\u8282\u70b9\uff09\u3002</li> <li>\u6700\u7ec8\uff0cProdigy \u53d1\u51fa\u65b0\u7684\u9884\u53d6\u8bf7\u6c42\uff084\uff09\uff0c\u76ee\u6807\u5730\u5740\u4e3a 0x12C\u3002</li> <li>\u56fe\u4e2d\u5173\u952e\u6570\u636e\u7ed3\u6784\u5c55\u793a\u5982\u4e0b\uff1a</li> </ul> \u7ed3\u6784\u540d\u79f0 \u5185\u5bb9\u793a\u4f8b \u4f5c\u7528 Node table \u5305\u542b\u8282\u70b9 ID\u3001\u57fa\u5730\u5740\uff08\u5982 0x100\uff09\u3001\u5bb9\u91cf\u3001\u6570\u636e\u5927\u5c0f\u7b49 \u5b58\u50a8\u6570\u636e\u7ed3\u6784\u7684\u5e03\u5c40\u4fe1\u606f Edge tables \u5305\u542b\u6e90/\u76ee\u7684\u5730\u5740\u3001\u8fb9\u7c7b\u578b\uff08w0/w1\uff09 \u5b58\u50a8\u6570\u636e\u7ed3\u6784\u95f4\u7684\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f PFHR file \u5305\u542b Free\u3001Node ID\u3001Trigger addr\u3001Outstanding addrs\u3001Offset bitmap \u8ddf\u8e2a\u6d3b\u8dc3\u9884\u53d6\u5e8f\u5217\u7684\u72b6\u6001 <ul> <li>\u6574\u4e2a\u8fc7\u7a0b\u4f53\u73b0\u4e86 Prodigy \u7684\u201c\u8f6f\u786c\u534f\u540c\u201d\u8bbe\u8ba1\uff1a\u8f6f\u4ef6\u5728\u7f16\u8bd1\u671f\u751f\u6210 DIG \u5e76\u6ce8\u5165\u7a0b\u5e8f\uff0c\u786c\u4ef6\u5728\u8fd0\u884c\u65f6\u5229\u7528 DIG \u89e3\u6790\u8bbf\u95ee\u6a21\u5f0f\u5e76\u52a8\u6001\u8c03\u6574\u9884\u53d6\u884c\u4e3a\uff0c\u786e\u4fdd\u9884\u53d6\u7684\u53ca\u65f6\u6027\u548c\u51c6\u786e\u6027\u3002</li> <li>\u56fe\u4e2d\u5f3a\u8c03\u4e86 PFHR \u7684\u5173\u952e\u4f5c\u7528\uff0c\u5b83\u4f7f Prodigy \u80fd\u591f\u652f\u6301\u975e\u963b\u585e\u9884\u53d6\uff0c\u5141\u8bb8\u591a\u4e2a\u9884\u53d6\u5e8f\u5217\u5e76\u53d1\u8fdb\u884c\uff0c\u907f\u514d\u56e0\u7b49\u5f85\u5355\u4e2a\u5e8f\u5217\u5b8c\u6210\u800c\u4e22\u5931\u9884\u53d6\u673a\u4f1a\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u5730\u89e3\u91ca\u4e86 Prodigy \u5982\u4f55\u5c06\u9759\u6001\u7a0b\u5e8f\u8bed\u4e49\uff08DIG\uff09\u4e0e\u52a8\u6001\u8fd0\u884c\u65f6\u4fe1\u606f\uff08load \u8bf7\u6c42\u3001\u6570\u636e\u8fd4\u56de\uff09\u76f8\u7ed3\u5408\uff0c\u5b9e\u73b0\u5bf9\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u6709\u6548\u9884\u53d6\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#table-i-baseline-system-configuration","title":"TABLE I BASELINE SYSTEM CONFIGURATION.","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u4e86\u8bba\u6587\u4e2d\u7528\u4e8e\u8bc4\u4f30 Prodigy \u7cfb\u7edf\u6027\u80fd\u7684\u57fa\u51c6\u7cfb\u7edf\u914d\u7f6e\uff0c\u5373 Table I\u3002</li> <li>\u914d\u7f6e\u8be6\u60c5\u6309\u7ec4\u4ef6\u5212\u5206\uff0c\u6db5\u76d6\u6838\u5fc3\u3001\u7f13\u5b58\u5c42\u7ea7\u548c\u4e3b\u5185\u5b58\uff0c\u5177\u4f53\u53c2\u6570\u5982\u4e0b\uff1a</li> </ul> \u7ec4\u4ef6 \u5efa\u6a21\u53c2\u6570 Core 8-OoO cores, 4-wide issue, 128-entry ROB, load/store queue size = 48/32 entries, 2.66GHz frequency Cache Hierarchy Three-level inclusive hierarchy, write-back caches, MESI coherence protocol, 64B cache line, LRU replacement L1 I/D Cache 32KB/core private, 4-way set-associative, data/tag access latency = 2/1 cycles L2 Cache 256KB/core private, 8-way set-associative, data/tag access latency = 4/1 cycles L3 Cache 2MB/core slice shared, 16-way set-associative, data/tag access latency = 27/8 cycles Main Memory DDR3 DRAM, access latency = 120 cycles, memory controller queuing latency modeled <ul> <li>\u6240\u6709\u7f13\u5b58\u5747\u91c7\u7528 MESI \u534f\u8bae \u548c LRU \u66ff\u6362\u7b56\u7565\uff0c\u786e\u4fdd\u4e00\u81f4\u6027\u4e0e\u6548\u7387\u3002</li> <li>L1 \u7f13\u5b58\u4e3a\u6bcf\u4e2a\u6838\u5fc3\u79c1\u6709\uff0c\u5bb9\u91cf 32KB\uff0c\u8bbf\u95ee\u5ef6\u8fdf\u6781\u4f4e\uff08\u6570\u636e 2 \u5468\u671f\uff0c\u6807\u7b7e 1 \u5468\u671f\uff09\uff0c\u9002\u5408\u5feb\u901f\u54cd\u5e94\u3002</li> <li>L2 \u7f13\u5b58\u540c\u6837\u79c1\u6709\uff0c\u5bb9\u91cf\u63d0\u5347\u81f3 256KB\uff0c\u8bbf\u95ee\u5ef6\u8fdf\u4e3a 4/1 \u5468\u671f\uff0c\u4f5c\u4e3a L1 \u4e0e L3 \u4e4b\u95f4\u7684\u7f13\u51b2\u3002</li> <li>L3 \u7f13\u5b58\u4e3a\u5171\u4eab\u7ed3\u6784\uff0c\u6bcf\u6838\u5207\u7247 2MB\uff0c16 \u8def\u7ec4\u76f8\u8054\uff0c\u5ef6\u8fdf\u8f83\u9ad8\uff0827/8 \u5468\u671f\uff09\uff0c\u7528\u4e8e\u8de8\u6838\u6570\u636e\u5171\u4eab\u3002</li> <li>\u4e3b\u5185\u5b58\u4f7f\u7528 DDR3 DRAM\uff0c\u8bbf\u95ee\u5ef6\u8fdf\u9ad8\u8fbe 120 \u5468\u671f\uff0c\u662f\u7cfb\u7edf\u6027\u80fd\u74f6\u9888\u7684\u4e3b\u8981\u6765\u6e90\uff0c\u4e5f\u662f Prodigy \u91cd\u70b9\u4f18\u5316\u7684\u5bf9\u8c61\u3002</li> <li>\u6574\u4f53\u67b6\u6784\u4e3a 8 \u6838\u5fc3 OoO\uff08Out-of-Order\uff09\u8bbe\u8ba1\uff0c\u652f\u6301 4 \u8def\u53d1\u5c04\uff0cROB \u5927\u5c0f\u4e3a 128 \u6761\uff0c\u65e8\u5728\u6a21\u62df\u73b0\u4ee3\u9ad8\u6027\u80fd CPU \u7684\u884c\u4e3a\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#table-ii-real-world-graph-data-sets-used-for-evaluation","title":"TABLE II REAL-WORLD GRAPH DATA SETS USED FOR EVALUATION.","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u8bba\u6587\u4e2d\u7684 Table II\uff0c\u6807\u9898\u4e3a \u201cREAL-WORLD GRAPH DATA SETS USED FOR EVALUATION\u201d\uff0c\u7528\u4e8e\u5c55\u793a\u8bc4\u4f30\u6240\u4f7f\u7528\u7684\u4e94\u4e2a\u771f\u5b9e\u4e16\u754c\u56fe\u6570\u636e\u96c6\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</li> <li>\u8868\u683c\u5305\u542b\u4e94\u5217\uff1aGraph\uff08\u56fe\u540d\u79f0\uff09\u3001Number of vertices\uff08\u9876\u70b9\u6570\uff09\u3001Number of edges\uff08\u8fb9\u6570\uff09\u3001Size (in MB)\uff08\u6570\u636e\u96c6\u5927\u5c0f\uff0c\u5355\u4f4dMB\uff09\u3001\u00d7 LLC capacity\uff08\u76f8\u5bf9\u4e8e\u6700\u540e\u4e00\u7ea7\u7f13\u5b58\u5bb9\u91cf\u7684\u500d\u6570\uff09\u3002</li> <li>\u6570\u636e\u96c6\u6309\u89c4\u6a21\u4ece\u5c0f\u5230\u5927\u6392\u5217\uff0c\u5177\u4f53\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> Graph Number of vertices Number of edges Size (in MB) \u00d7 LLC capacity pokec (po) 1.6M 30.6M 132.0 16.5 livejournal (lj) 4.8M 69.0M 300.0 37.5 orkut (or) 3.1M 117.2M 485.2 60.6 sk-2005 (sk) 50.6M 1930.3M 7749.6 968.7 webbase-2001 (wb) 118.1M 1019.9M 4791.6 598.9 <ul> <li>\u6240\u6709\u6570\u636e\u96c6\u5747\u6765\u81ea SNAP \u548c UF\u2019s sparse matrix collection\uff0c\u4ee3\u8868\u771f\u5b9e\u4e16\u754c\u7684\u56fe\u7ed3\u6784\uff0c\u5177\u6709\u591a\u6837\u5316\u7684\u89c4\u6a21\u548c\u5bc6\u5ea6\u3002</li> <li>webbase-2001 (wb) \u662f\u6700\u5927\u7684\u6570\u636e\u96c6\uff0c\u62e5\u6709 118.1M \u9876\u70b9 \u548c 1019.9M \u8fb9\uff0c\u5176\u5927\u5c0f\u4e3a 4791.6 MB\uff0c\u662f LLC \u5bb9\u91cf\u7684 598.9 \u500d\uff0c\u8868\u660e\u5176\u8fdc\u8d85\u7f13\u5b58\u5bb9\u91cf\uff0c\u9002\u5408\u6d4b\u8bd5\u5185\u5b58\u5bc6\u96c6\u578b\u5de5\u4f5c\u8d1f\u8f7d\u3002</li> <li>pokec (po) \u662f\u6700\u5c0f\u7684\u6570\u636e\u96c6\uff0c\u4ec5 1.6M \u9876\u70b9 \u548c 30.6M \u8fb9\uff0c\u5927\u5c0f\u4e3a 132.0 MB\uff0c\u7ea6\u4e3a LLC \u5bb9\u91cf\u7684 16.5 \u500d\uff0c\u4ecd\u5c5e\u5927\u89c4\u6a21\u56fe\u5904\u7406\u8303\u7574\u3002</li> <li>\u8be5\u8868\u7528\u4e8e\u652f\u6491\u8bba\u6587\u4e2d\u5bf9 Prodigy \u5728\u4e0d\u540c\u89c4\u6a21\u56fe\u7b97\u6cd5\u4e0a\u7684\u6027\u80fd\u8bc4\u4f30\uff0c\u786e\u4fdd\u5b9e\u9a8c\u7ed3\u679c\u5728\u771f\u5b9e\u3001\u591a\u6837\u5316\u6570\u636e\u96c6\u4e0a\u5177\u6709\u4ee3\u8868\u6027\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-12-design-space-exploration-on-the-pfhr-file-size-performance-of-each-configuration-is-normalized-to-4-entries","title":"Figure 12. Design space exploration on the PFHR file size. Performance of each configuration is normalized to 4 entries.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u4e2d PFHR (Prefetch Status Handling Register) \u6587\u4ef6\u5927\u5c0f \u5bf9\u6027\u80fd\u5f71\u54cd\u7684\u8bbe\u8ba1\u7a7a\u95f4\u63a2\u7d22\u7ed3\u679c\uff0c\u6027\u80fd\u4ee5 4 \u4e2a\u6761\u76ee\uff08entries\uff09\u7684\u914d\u7f6e\u4e3a\u57fa\u51c6\u8fdb\u884c\u5f52\u4e00\u5316\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u4e86\u4e5d\u79cd\u4e0d\u540c\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff08Workload\uff09\uff0c\u5305\u62ec bc\u3001bfs\u3001cc\u3001pr\u3001sssp\u3001spmv\u3001symgs\u3001cg \u548c is\u3002</li> <li>\u7eb5\u8f74\u8868\u793a\u5f52\u4e00\u5316\u540e\u7684\u52a0\u901f\u6bd4\uff08Speedup, x\uff09\uff0c\u8303\u56f4\u4ece 0.0 \u5230 1.4\u3002</li> <li>\u56fe\u4f8b\u7528\u56db\u79cd\u989c\u8272\u533a\u5206\u4e86 PFHR \u6587\u4ef6\u5927\u5c0f\uff1a\u9ec4\u8272\u4ee3\u8868 4 entries\uff0c\u7eff\u8272\u4ee3\u8868 8 entries\uff0c\u9752\u8272\u4ee3\u8868 16 entries\uff0c\u84dd\u8272\u4ee3\u8868 32 entries\u3002</li> <li>\u6027\u80fd\u8d8b\u52bf\u663e\u793a\uff1a</li> <li>\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u5728 PFHR \u4ece 4 \u589e\u52a0\u5230 16 \u65f6\u6027\u80fd\u63d0\u5347\u660e\u663e\uff0c\u5c24\u5176\u5728 bfs\u3001pr\u3001sssp \u4e0a\u8868\u73b0\u7a81\u51fa\u3002</li> <li>\u5f53 PFHR \u6269\u5c55\u81f3 32 entries \u65f6\uff0c\u90e8\u5206\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982 cc\u3001is\uff09\u6027\u80fd\u53cd\u800c\u4e0b\u964d\uff0c\u8868\u660e\u5b58\u5728\u7ed3\u6784\u51b2\u7a81\u6216\u7f13\u5b58\u6c61\u67d3\u3002</li> <li>bc \u5de5\u4f5c\u8d1f\u8f7d\u5728 16 entries \u65f6\u8fbe\u5230\u5cf0\u503c\u6027\u80fd\uff0c\u800c cg \u5728 32 entries \u65f6\u7565\u4f18\u4e8e 16 entries\u3002</li> <li>\u6839\u636e\u56fe\u793a\u6570\u636e\uff0c\u53ef\u603b\u7ed3\u5982\u4e0b\u6027\u80fd\u5bf9\u6bd4\u8868\uff1a</li> </ul> Workload Best PFHR Size Max Speedup (x) bc 16 ~1.15 bfs 16 ~1.25 cc 8 ~1.10 pr 16 ~1.30 sssp 16 ~1.20 spmv 16 ~1.10 symgs 16 ~1.15 cg 32 ~1.15 is 16 ~1.10 <ul> <li>\u7ed3\u8bba\uff1aPFHR \u6587\u4ef6\u5927\u5c0f\u9700\u6839\u636e\u5de5\u4f5c\u8d1f\u8f7d\u7279\u6027\u6743\u8861\uff0c16 entries \u662f\u7efc\u5408\u6027\u80fd\u4e0e\u786c\u4ef6\u5f00\u9500\u7684\u6700\u4f73\u6298\u8877\u70b9\uff0c\u8fc7\u5927\u7684 PFHR \u53ef\u80fd\u56e0\u65e0\u6548\u9884\u53d6\u5bfc\u81f4\u6027\u80fd\u9000\u5316\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-13-classification-of-llc-miss-addresses-into-potentially-prefetchable-and-non-prefetchable-addresses","title":"Figure 13. Classification of LLC miss addresses into potentially prefetchable and non-prefetchable addresses.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u975e\u9884\u53d6\u57fa\u7ebf\uff08no-prefetching baseline\uff09\u4e0b\uff0c\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u7684LLC miss\u5730\u5740\u88ab\u5206\u7c7b\u4e3a\u201c\u53ef\u9884\u53d6\u201d\uff08Prefetchable\uff09\u548c\u201c\u4e0d\u53ef\u9884\u53d6\u201d\uff08Non-prefetchable\uff09\u7684\u6bd4\u4f8b\u3002</li> <li>\u6a2a\u8f74\u4e3a\u5de5\u4f5c\u8d1f\u8f7d\u540d\u79f0\uff0c\u5305\u62ec\uff1abc\u3001bfs\u3001cc\u3001pr\u3001sssp\u3001spmv\u3001symgs\u3001cg\u3001is\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5e73\u5747\u503c\uff08avg\uff09\u3002</li> <li>\u7eb5\u8f74\u8868\u793a\u767e\u5206\u6bd4\uff08%\uff09\uff0c\u8303\u56f4\u4ece0\u5230100\u3002</li> <li>\u6bcf\u4e2a\u67f1\u72b6\u56fe\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a</li> <li>\u84dd\u8272\u90e8\u5206\u4ee3\u8868\u201c\u53ef\u9884\u53d6\u201d\u7684LLC miss\u5730\u5740\u6bd4\u4f8b\u3002</li> <li>\u9ec4\u8272\u90e8\u5206\u4ee3\u8868\u201c\u4e0d\u53ef\u9884\u53d6\u201d\u7684LLC miss\u5730\u5740\u6bd4\u4f8b\u3002</li> <li>\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u7684\u201c\u53ef\u9884\u53d6\u201d\u6bd4\u4f8b\u5747\u8d85\u8fc790%\uff0c\u5176\u4e2d\u591a\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u63a5\u8fd1\u6216\u8fbe\u5230100%\u3002</li> <li>\u5e73\u5747\u503c\uff08avg\uff09\u663e\u793a\uff0c\u201c\u53ef\u9884\u53d6\u201d\u6bd4\u4f8b\u9ad8\u8fbe96.4%\uff0c\u8868\u660eProDIGy\u7684DIG\u8868\u793a\u6cd5\u80fd\u591f\u8986\u76d6\u7edd\u5927\u591a\u6570\u6f5c\u5728\u7684\u9884\u53d6\u673a\u4f1a\u3002</li> <li>\u8fd9\u4e00\u6570\u636e\u652f\u6301\u4e86\u8bba\u6587\u4e2d\u7684\u7ed3\u8bba\uff1a\u7406\u60f3\u60c5\u51b5\u4e0b\uff0cProDIGy\u53ef\u4ee5\u5c0696.4%\u7684DRAM\u8bbf\u95ee\u8f6c\u5316\u4e3a\u7f13\u5b58\u547d\u4e2d\uff0c\u4ece\u800c\u8bbe\u5b9a\u6027\u80fd\u4e0a\u9650\u3002</li> </ul> Workload Prefetchable (%) Non-prefetchable (%) bc ~98 ~2 bfs ~97 ~3 cc ~99 ~1 pr ~98 ~2 sssp ~97 ~3 spmv ~96 ~4 symgs ~95 ~5 cg ~98 ~2 is ~99 ~1 avg 96.4 3.6 <ul> <li>\u8be5\u56fe\u8868\u5f3a\u8c03\u4e86ProDIGy\u8bbe\u8ba1\u7684\u6709\u6548\u6027\uff1a\u901a\u8fc7\u6355\u6349\u7a0b\u5e8f\u8bed\u4e49\uff0c\u5b83\u80fd\u7cbe\u51c6\u8bc6\u522b\u5e76\u9884\u53d6\u7edd\u5927\u90e8\u5206\u53ef\u80fd\u53d7\u76ca\u4e8e\u9884\u53d6\u7684\u6570\u636e\u8bbf\u95ee\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-14-cpi-stack-comparison-and-speedup-achieved-by-prodigy-against-a-non-prefetching-baseline-left-bar-cpi-stack-of-baseline-right-bar-cpi-stack-of-prodigy-normalized-to-baseline-lower-is-better-for-cpi-higher-for-speedup","title":"Figure 14. CPI stack comparison and speedup achieved by Prodigy against a non-prefetching baseline. Left bar: CPI stack of baseline; right bar: CPI stack of Prodigy normalized to baseline. Lower is better for CPI, higher for speedup.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u4e0e\u65e0\u9884\u53d6\u57fa\u7ebf\uff08non-prefetching baseline\uff09\u5728\u591a\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\u7684 CPI \u5806\u6808\u5bf9\u6bd4\u53ca\u52a0\u901f\u6bd4\uff0c\u5de6\u4fa7\u67f1\u72b6\u56fe\u4e3a\u57fa\u7ebf CPI \u5206\u89e3\uff0c\u53f3\u4fa7\u4e3a Prodigy \u76f8\u5bf9\u57fa\u7ebf\u7684\u5f52\u4e00\u5316 CPI \u5206\u89e3\uff0c\u9ed1\u8272\u6298\u7ebf\u8868\u793a\u52a0\u901f\u6bd4\u3002</li> <li>CPI \u5806\u6808\u5206\u89e3\u5305\u542b\u4e94\u7c7b\u505c\u987f\uff1aNo-stall\uff08\u65e0\u505c\u987f\uff09\u3001Cache-stall\uff08\u7f13\u5b58\u505c\u987f\uff09\u3001DRAM-stall\uff08DRAM \u505c\u987f\uff09\u3001Branch-stall\uff08\u5206\u652f\u505c\u987f\uff09\u3001Dependency-stall\uff08\u4f9d\u8d56\u505c\u987f\uff09\uff0c\u4ee5\u53ca Other-stall\uff08\u5176\u4ed6\u505c\u987f\uff09\u3002</li> <li>DRAM-stall \u5360\u6bd4\u663e\u8457\u4e0b\u964d\uff1a\u5728\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cProdigy \u5c06 DRAM-stall \u4ece\u57fa\u7ebf\u4e2d\u7684\u4e3b\u5bfc\u90e8\u5206\u5927\u5e45\u538b\u7f29\uff0c\u4f8b\u5982\u5728 pr-po\u3001sssp-po\u3001symgs \u7b49\u8d1f\u8f7d\u4e2d\uff0cDRAM-stall \u51e0\u4e4e\u88ab\u6d88\u9664\uff0c\u8fd9\u662f\u6027\u80fd\u63d0\u5347\u7684\u6838\u5fc3\u6765\u6e90\u3002</li> <li>\u52a0\u901f\u6bd4\u666e\u904d\u63d0\u5347\uff1a\u9ed1\u8272\u6298\u7ebf\u663e\u793a Prodigy \u5728\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5747\u5e26\u6765\u6b63\u5411\u52a0\u901f\uff0c\u5e73\u5747\u52a0\u901f\u6bd4\u8fbe 2.6\u00d7\uff0c\u90e8\u5206\u8d1f\u8f7d\u5982 symgs \u548c is \u8fbe\u5230 7\u00d7 \u4ee5\u4e0a\u3002</li> <li>\u7f13\u5b58\u505c\u987f\u7565\u6709\u4e0a\u5347\uff1a\u7531\u4e8e\u9884\u53d6\u5c06\u539f\u672c\u7684 DRAM \u8bbf\u95ee\u8f6c\u5316\u4e3a\u7f13\u5b58\u547d\u4e2d\uff0c\u5bfc\u81f4 Cache-stall \u6bd4\u4f8b\u4e0a\u5347\uff0c\u4f46\u6574\u4f53 CPI \u4e0b\u964d\uff0c\u8bf4\u660e\u9884\u53d6\u6709\u6548\u51cf\u5c11\u4e86\u9ad8\u5ef6\u8fdf\u8bbf\u95ee\u3002</li> <li>\u5206\u652f\u505c\u987f\u51cf\u5c11\uff1a\u5c24\u5176\u5728 bfs\u3001pr\u3001sssp \u7b49\u56fe\u7b97\u6cd5\u4e2d\uff0cBranch-stall \u660e\u663e\u964d\u4f4e\uff0c\u5e73\u5747\u51cf\u5c11 65.3%\uff0c\u8fd9\u662f\u56e0\u4e3a\u9884\u53d6\u7f13\u89e3\u4e86\u6570\u636e\u4f9d\u8d56\u5206\u652f\u7684\u7b49\u5f85\u65f6\u95f4\u3002</li> <li>\u5404\u5de5\u4f5c\u8d1f\u8f7d\u8868\u73b0\u5dee\u5f02\uff1a</li> <li>\u56fe\u7b97\u6cd5\uff08bc, bfs, cc, pr, sssp\uff09\uff1a\u52a0\u901f\u6bd4\u96c6\u4e2d\u5728 1.5x\u20134x\uff0c\u5176\u4e2d pr-po\u3001sssp-po \u8868\u73b0\u6700\u4f18\u3002</li> <li>\u7ebf\u6027\u4ee3\u6570\uff08spmv, symgs\uff09\uff1asymgs \u52a0\u901f\u9ad8\u8fbe 7x\uff0cspmv \u7ea6 2x\u3002</li> <li>\u6d41\u4f53\u52a8\u529b\u5b66\uff08cg, is\uff09\uff1ais \u8fbe\u5230 7x\uff0ccg \u7ea6 2x\u3002</li> <li>\u6570\u636e\u6c47\u603b\u5982\u4e0b\uff1a</li> </ul> Workload Speedup (x) DRAM-stall Reduction Branch-stall Reduction bc-il ~1.8 High Moderate bfs-po ~2.5 Very High High pr-po ~4.0 Very High High sssp-po ~3.5 Very High High symgs ~7.0 Near Eliminated Moderate is ~7.0 Near Eliminated Low <ul> <li>\u603b\u4f53\u800c\u8a00\uff0cProdigy \u901a\u8fc7\u7cbe\u51c6\u9884\u53d6\u5927\u5e45\u524a\u51cf DRAM \u505c\u987f\uff0c\u8fdb\u800c\u63d0\u5347\u6574\u4f53\u6027\u80fd\u548c\u80fd\u6548\uff0c\u9a8c\u8bc1\u4e86\u5176\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1\u7684\u6709\u6548\u6027\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-15-location-of-prefetched-data-in-the-cache-hierarchy-when-it-is-demanded-blue-is-better","title":"Figure 15. Location of prefetched data in the cache hierarchy when it is demanded. Blue is better.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u9884\u53d6\u5668\u5728\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\uff0c\u9884\u53d6\u6570\u636e\u88ab\u5b9e\u9645\u9700\u6c42\u65f6\u5728\u7f13\u5b58\u5c42\u7ea7\u4e2d\u7684\u4f4d\u7f6e\u5206\u5e03\uff0c\u7528\u4e8e\u8861\u91cf\u9884\u53d6\u7684\u201c\u6709\u7528\u6027\u201d\uff08Usefulness\uff09\uff0c\u84dd\u8272\u533a\u57df\u8d8a\u5927\u8868\u793a\u9884\u53d6\u8d8a\u6709\u6548\u3002</li> <li>\u6570\u636e\u6309 workload \u5206\u7c7b\uff0c\u5305\u62ec bc\u3001bfs\u3001cc\u3001pr\u3001sssp\u3001spmv\u3001symgs\u3001cg\u3001is\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5e73\u5747\u503c\uff08avg\uff09\u3002</li> <li>\u6bcf\u4e2a\u67f1\u72b6\u56fe\u7531\u56db\u90e8\u5206\u5806\u53e0\u7ec4\u6210\uff0c\u5206\u522b\u4ee3\u8868\uff1a</li> <li>L1 prefetch hit\uff08\u6df1\u84dd\u8272\uff09\uff1a\u6570\u636e\u5728 L1D \u7f13\u5b58\u4e2d\u88ab\u547d\u4e2d\uff0c\u5ef6\u8fdf\u6700\u4f4e\uff0c\u6027\u80fd\u6700\u4f18\u3002</li> <li>L2 prefetch hit\uff08\u9752\u8272\uff09\uff1a\u6570\u636e\u5728 L2 \u7f13\u5b58\u4e2d\u88ab\u547d\u4e2d\uff0c\u5ef6\u8fdf\u6b21\u4e4b\u3002</li> <li>L3 prefetch hit\uff08\u6d45\u7eff\u8272\uff09\uff1a\u6570\u636e\u5728 L3 \u7f13\u5b58\u4e2d\u88ab\u547d\u4e2d\uff0c\u5ef6\u8fdf\u8f83\u9ad8\u3002</li> <li>Prefetch eviction before demanded\uff08\u7c73\u9ec4\u8272\uff09\uff1a\u6570\u636e\u5728\u88ab\u9700\u6c42\u524d\u5df2\u88ab\u9010\u51fa\u7f13\u5b58\uff0c\u5c5e\u4e8e\u65e0\u6548\u9884\u53d6\uff0c\u6d6a\u8d39\u5e26\u5bbd\u548c\u7f13\u5b58\u7a7a\u95f4\u3002</li> <li>\u4ece\u56fe\u8868\u53ef\u89c1\uff0c\u5927\u90e8\u5206\u5de5\u4f5c\u8d1f\u8f7d\u7684\u9884\u53d6\u6570\u636e\u4e3b\u8981\u843d\u5728 L1 \u548c L2 \u7f13\u5b58\u4e2d\uff0c\u8bf4\u660e Prodigy \u80fd\u591f\u8f83\u53ca\u65f6\u5730\u5c06\u6570\u636e\u9884\u53d6\u5230\u9760\u8fd1\u5904\u7406\u5668\u7684\u4f4d\u7f6e\u3002</li> <li>\u5e73\u5747\u503c\uff08avg\uff09\u663e\u793a\uff0c\u7ea6 62.7% \u7684\u9884\u53d6\u6570\u636e\u5728\u88ab\u9700\u6c42\u65f6\u4ecd\u9a7b\u7559\u5728\u7f13\u5b58\u4e2d\uff08L1/L2/L3 hit\uff09\uff0c\u5176\u4e2d L1 \u5360\u6bd4\u6700\u9ad8\uff0c\u8868\u660e\u9884\u53d6\u5177\u6709\u8f83\u9ad8\u7684\u51c6\u786e\u6027\u548c\u65f6\u6548\u6027\u3002</li> <li>\u5c11\u91cf\u6570\u636e\uff08\u5e73\u5747\u7ea6 37.3%\uff09\u5728\u88ab\u9700\u6c42\u524d\u5df2\u88ab\u9010\u51fa\uff0c\u8fd9\u4e0e\u8bba\u6587\u7b2c VI-C \u8282\u6240\u8ff0\u201c\u7531\u4e8e\u4e0d\u5b8c\u7f8e\u7684\u65f6\u6548\u6027\u5bfc\u81f4\u7684\u9010\u51fa\u201d\u76f8\u7b26\uff0c\u4f46\u6574\u4f53\u9884\u53d6\u6709\u6548\u6027\u4ecd\u5904\u4e8e\u8f83\u9ad8\u6c34\u5e73\u3002</li> <li>\u5404 workload \u8868\u73b0\u7565\u6709\u5dee\u5f02\uff0c\u4f8b\u5982 pr \u548c sssp \u7684 L1 \u547d\u4e2d\u7387\u8f83\u9ad8\uff0c\u800c cg \u548c is \u7684 L3 \u547d\u4e2d\u7387\u76f8\u5bf9\u66f4\u9ad8\uff0c\u53ef\u80fd\u4e0e\u5176\u8bbf\u95ee\u6a21\u5f0f\u6216\u6570\u636e\u89c4\u6a21\u6709\u5173\u3002</li> </ul> Workload L1 Prefetch Hit (%) L2 Prefetch Hit (%) L3 Prefetch Hit (%) Evicted Before Demanded (%) bc ~50 ~20 ~10 ~20 bfs ~60 ~20 ~5 ~15 cc ~40 ~25 ~15 ~20 pr ~70 ~15 ~5 ~10 sssp ~65 ~20 ~5 ~10 spmv ~55 ~20 ~10 ~15 symgs ~50 ~25 ~10 ~15 cg ~45 ~20 ~25 ~10 is ~40 ~25 ~25 ~10 avg ~55 ~20 ~10 ~15 <ul> <li>\u603b\u4f53\u800c\u8a00\uff0c\u8be5\u56fe\u76f4\u89c2\u9a8c\u8bc1\u4e86 Prodigy \u9884\u53d6\u673a\u5236\u7684\u6709\u6548\u6027\uff0c\u5176\u9884\u53d6\u6570\u636e\u591a\u80fd\u5728\u4f4e\u5ef6\u8fdf\u7f13\u5b58\u5c42\u7ea7\u88ab\u547d\u4e2d\uff0c\u663e\u8457\u51cf\u5c11 DRAM \u8bbf\u95ee\uff0c\u4ece\u800c\u63d0\u5347\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-16-percentage-of-prefetchable-main-memory-accesses-as-shown-in-fig-13-converted-to-cache-hits-blue-is-better","title":"Figure 16. Percentage of prefetchable main memory accesses (as shown in Fig. 13) converted to cache hits. Blue is better.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u7cfb\u7edf\u5c06 prefetchable LLC misses \u8f6c\u6362\u4e3a cache hits \u7684\u6548\u7387\uff0c\u8861\u91cf\u5176 prefetching \u6709\u6548\u6027\u3002</li> <li>\u6a2a\u8f74\u4e3a\u4e0d\u540c workload\uff0c\u5305\u62ec bc\u3001bfs\u3001cc\u3001pr\u3001sssp\u3001spmv\u3001symgs\u3001cg\u3001is\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5e73\u5747\u503c avg\u3002</li> <li>\u7eb5\u8f74\u4e3a\u767e\u5206\u6bd4\uff0c\u8868\u793a\u88ab prefetching \u6210\u529f\u8282\u7701\u7684 LLC miss \u5360\u6bd4\uff0c\u84dd\u8272\u90e8\u5206\u8d8a\u9ad8\u8d8a\u597d\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0cProdigy \u5728\u6240\u6709 workload \u4e2d\u5747\u80fd\u6709\u6548\u8f6c\u5316\u5927\u90e8\u5206 prefetchable \u8bbf\u95ee\uff1a</li> <li>bc: \u7ea6 85%</li> <li>bfs: \u7ea6 75%</li> <li>cc: \u7ea6 90%</li> <li>pr: \u7ea6 80%</li> <li>sssp: \u7ea6 70%</li> <li>spmv: \u7ea6 95%</li> <li>symgs: \u7ea6 90%</li> <li>cg: \u7ea6 85%</li> <li>is: \u7ea6 90%</li> <li>avg: 85.1%</li> <li>\u8868\u683c\u5316\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> Workload Saved by Prefetching (%) bc ~85 bfs ~75 cc ~90 pr ~80 sssp ~70 spmv ~95 symgs ~90 cg ~85 is ~90 avg 85.1 <ul> <li>\u8be5\u56fe\u9a8c\u8bc1\u4e86 Prodigy \u7684\u6838\u5fc3\u80fd\u529b\uff1a\u5728\u4e0d\u5f15\u5165\u663e\u8457\u786c\u4ef6\u5f00\u9500\u7684\u524d\u63d0\u4e0b\uff0c\u9ad8\u6548\u8986\u76d6\u5e76\u547d\u4e2d\u539f\u672c\u4f1a\u89e6\u53d1 DRAM \u8bbf\u95ee\u7684\u5185\u5b58\u8bf7\u6c42\u3002</li> <li>\u9ec4\u8272\u90e8\u5206\u4ee3\u8868\u672a\u88ab prefetching \u8282\u7701\u7684\u8bbf\u95ee\uff0c\u4e3b\u8981\u6e90\u4e8e prefetch timeliness \u4e0d\u8db3\u6216 cache pollution\uff0c\u8fd9\u4e0e\u8bba\u6587\u4e2d\u63d0\u5230\u7684\u201cuntimely prefetches\u201d\u548c\u201cevicted data\u201d\u76f8\u547c\u5e94\u3002</li> <li>\u5e73\u5747 85.1% \u7684\u8f6c\u5316\u7387\u8bf4\u660e Prodigy \u7684 DIG \u9a71\u52a8\u673a\u5236\u5728\u6355\u6349\u548c\u54cd\u5e94 irregular memory access patterns \u4e0a\u5177\u6709\u9ad8\u5ea6\u51c6\u786e\u6027\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-17-performance-comparison-of-a-non-prefetching-baseline-ainsworth-and-jones-prefetcher-6-droplet-15-imp-99-and-prodigy-this-work-higher-is-better-ainsworth-jones-and-droplet-are-graph-specific-approaches-and-hence-are-omitted-from-non-graph-workloads","title":"Figure 17. Performance comparison of a non-prefetching baseline, Ainsworth and Jones\u2019 prefetcher [6], DROPLET [15], IMP [99], and Prodigy (this work). Higher is better. Ainsworth &amp; Jones and DROPLET are graph-specific approaches, and hence are omitted from non-graph workloads.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy\uff08\u672c\u5de5\u4f5c\uff09\u4e0e\u591a\u4e2a\u73b0\u6709\u9884\u53d6\u5668\u5728\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\u7684\u6027\u80fd\u5bf9\u6bd4\uff0c\u4ee5\u975e\u9884\u53d6\u57fa\u7ebf\u4e3a\u57fa\u51c6\uff0c\u6570\u503c\u8d8a\u9ad8\u4ee3\u8868\u52a0\u901f\u6548\u679c\u8d8a\u597d\u3002</li> <li>\u8be5\u56fe\u8986\u76d6\u4e86 9 \u4e2a\u4e0d\u540c\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5305\u62ec\u56fe\u7b97\u6cd5\uff08bc, bfs, cc, pr, sssp\uff09\u3001\u7a00\u758f\u7ebf\u6027\u4ee3\u6570\uff08spmv, symgs\uff09\u548c\u8ba1\u7b97\u6d41\u4f53\u52a8\u529b\u5b66\uff08cg, is\uff09\uff0c\u4ee5\u53ca\u4e00\u4e2a\u672a\u660e\u786e\u6807\u6ce8\u7684\u201cgm\u201d\u3002</li> <li>Ainsworth &amp; Jones \u548c DROPLET \u4ec5\u9488\u5bf9\u56fe\u7b97\u6cd5\u8bbe\u8ba1\uff0c\u56e0\u6b64\u5728\u975e\u56fe\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982 spmv, symgs, cg, is\uff09\u4e2d\u672a\u663e\u793a\u6570\u636e\u3002</li> <li>IMP \u548c Prodigy \u8986\u76d6\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u4f53\u73b0\u5176\u901a\u7528\u6027\u3002</li> <li>\u5404\u5de5\u4f5c\u8d1f\u8f7d\u4e0b Prodigy \u7684\u52a0\u901f\u6bd4\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u9884\u53d6\u5668\uff1a</li> <li>\u5728 pr \u4e0a\u8fbe\u5230 7.3x \u52a0\u901f\uff1b</li> <li>\u5728 spmv \u4e0a\u8fbe\u5230 5.8x\uff1b</li> <li>\u5728 symgs \u4e0a\u8fbe\u5230 8.4x\uff1b</li> <li>\u5728 is \u4e0a\u8fbe\u5230 5.0x\u3002</li> <li>\u5bf9\u6bd4\u5176\u4ed6\u9884\u53d6\u5668\uff1a</li> <li>Ainsworth &amp; Jones \u5728\u90e8\u5206\u56fe\u7b97\u6cd5\u4e0a\u8868\u73b0\u5c1a\u53ef\uff0c\u4f46\u5728 pr \u4e0a\u4ec5\u4e3a\u7ea6 2.5x\uff0c\u8fdc\u4f4e\u4e8e Prodigy \u7684 7.3x\u3002</li> <li>DROPLET \u5728\u56fe\u7b97\u6cd5\u4e0a\u8868\u73b0\u4e00\u822c\uff0c\u4f8b\u5982\u5728 pr \u4e0a\u7ea6\u4e3a 3.0x\u3002</li> <li>IMP \u5728\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u8868\u73b0\u8f83\u5f31\uff0c\u4f8b\u5982\u5728 pr \u4e0a\u7ea6\u4e3a 1.5x\uff0c\u5728 spmv \u4e0a\u7ea6\u4e3a 1.2x\u3002</li> <li>\u6027\u80fd\u4f18\u52bf\u5f52\u56e0\u4e8e Prodigy \u7684\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1\uff0c\u901a\u8fc7 DIG \u8868\u8fbe\u7a0b\u5e8f\u8bed\u4e49\uff0c\u652f\u6301\u5355\u503c\u548c\u8303\u56f4\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5b9e\u73b0\u66f4\u7cbe\u51c6\u3001\u53ca\u65f6\u7684\u9884\u53d6\u3002</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d Baseline Ainsworth &amp; Jones DROPLET IMP Prodigy (This Work) bc 1.0x ~2.0x ~1.5x ~1.2x ~2.5x bfs 1.0x ~1.8x ~1.6x ~1.3x ~2.8x cc 1.0x ~1.5x ~1.4x ~1.1x ~2.2x pr 1.0x ~2.5x ~3.0x ~1.5x 7.3x sssp 1.0x ~1.7x ~1.6x ~1.2x ~2.6x spmv 1.0x \u2014 \u2014 ~1.2x 5.8x symgs 1.0x \u2014 \u2014 ~1.3x 8.4x cg 1.0x \u2014 \u2014 ~1.1x ~2.0x is 1.0x \u2014 \u2014 ~1.4x 5.0x gm 1.0x \u2014 \u2014 ~1.2x ~2.7x <ul> <li>\u56fe\u8868\u6e05\u6670\u8868\u660e\uff0cProdigy \u5728\u7edd\u5927\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5b9e\u73b0\u4e86\u6700\u9ad8\u52a0\u901f\u6bd4\uff0c\u5c24\u5176\u5728\u7a00\u758f\u77e9\u9635\u8fd0\u7b97\uff08spmv, symgs\uff09\u548c PageRank \u7b49\u5173\u952e\u5e94\u7528\u4e0a\u4f18\u52bf\u660e\u663e\uff0c\u9a8c\u8bc1\u4e86\u5176\u8bbe\u8ba1\u7684\u6709\u6548\u6027\u548c\u5e7f\u6cdb\u9002\u7528\u6027\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#table-iii-average-speedup-comparison-over-no-prefetching","title":"TABLE III AVERAGE SPEEDUP COMPARISON OVER NO PREFETCHING.\u2217","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u8bba\u6587\u4e2d\u7684 Table III\uff0c\u6807\u9898\u4e3a \u201cAVERAGE SPEEDUP COMPARISON OVER NO PREFETCHING\u201d\uff0c\u7528\u4e8e\u5bf9\u6bd4 Prodigy \u4e0e\u5148\u524d\u5de5\u4f5c\u5728\u4e0d\u540c\u7b97\u6cd5\u7ec4\u5408\u4e0b\u7684\u5e73\u5747\u52a0\u901f\u6bd4\u3002</li> <li>\u8868\u683c\u5305\u542b\u4e09\u5217\uff1aCommon algorithms\uff08\u5171\u540c\u7b97\u6cd5\uff09\u3001Prior work\uff08\u5148\u524d\u5de5\u4f5c\uff09\u3001Prodigy\uff08\u672c\u6587\u65b9\u6848\uff09\u3002</li> <li>\u6570\u636e\u663e\u793a\uff0cProdigy \u5728\u6240\u6709\u5217\u51fa\u7684\u7b97\u6cd5\u7ec4\u5408\u4e2d\u5747\u4f18\u4e8e\u5148\u524d\u5de5\u4f5c\uff0c\u4f53\u73b0\u5176\u5728\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1\u4e0a\u7684\u4f18\u52bf\u3002</li> </ul> Common algorithms Prior work Prodigy bc, bfs, bc, pr Ainsworth &amp; Jones [6] 2.8\u00d7 bc, bfs, bc, pr, sssp DROPLET [15] 2.9\u00d7 bfs, pr, spmv, symgs IMP [99] 4.6\u00d7 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5bf9\u4e8e\u56fe\u7b97\u6cd5\u7ec4\u5408\uff08bc, bfs, pr\uff09\uff0cProdigy \u8fbe\u5230 2.8\u00d7 \u52a0\u901f\uff0c\u4f18\u4e8e Ainsworth &amp; Jones \u7684 2.4\u00d7\u3002</li> <li>\u5f53\u52a0\u5165 sssp \u540e\uff0cProdigy \u4ecd\u4fdd\u6301 2.9\u00d7\uff0c\u800c DROPLET \u4ec5 1.9\u00d7\uff0c\u8bf4\u660e Prodigy \u66f4\u5168\u9762\u652f\u6301\u591a\u79cd\u56fe\u7b97\u6cd5\u3002</li> <li>\u5728\u7a00\u758f\u7ebf\u6027\u4ee3\u6570\u7b97\u6cd5\uff08bfs, pr, spmv, symgs\uff09\u4e0a\uff0cProdigy \u5b9e\u73b0 4.6\u00d7 \u52a0\u901f\uff0c\u8fdc\u8d85 IMP \u7684 1.8\u00d7\uff0c\u51f8\u663e\u5176\u5bf9\u975e\u56fe\u7c7b\u4e0d\u89c4\u5219\u8d1f\u8f7d\u7684\u9002\u5e94\u6027\u3002</li> <li>\u8868\u683c\u811a\u6ce8\u201c*\u201d\u6ce8\u660e\uff1a\u4f7f\u7528\u7684\u662f\u5404\u5148\u524d\u5de5\u4f5c\u4e2d\u62a5\u544a\u7684\u6700\u4f73\u8f93\u5165\u6570\u636e\u96c6\uff0c\u786e\u4fdd\u6bd4\u8f83\u516c\u5e73\u3002</li> <li>\u603b\u4f53\u800c\u8a00\uff0c\u8be5\u8868\u6709\u529b\u652f\u6491\u4e86\u8bba\u6587\u6838\u5fc3\u4e3b\u5f20\uff1aProdigy \u5728\u591a\u79cd\u4e0d\u89c4\u5219\u8d1f\u8f7d\u4e0b\u5b9e\u73b0\u663e\u8457\u6027\u80fd\u63d0\u5347\uff0c\u4e14\u4f18\u4e8e\u73b0\u6709\u6700\u5148\u8fdb\u9884\u53d6\u5668\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-18-speedup-of-prodigy-compared-to-a-non-prefetching-baseline-on-reordered-graph-data-sets-using-hubsort-14","title":"Figure 18. Speedup of Prodigy compared to a non-prefetching baseline on reordered graph data sets using HubSort [14].","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prodigy \u5728\u4f7f\u7528 HubSort \u91cd\u6392\u5e8f\u540e\u7684\u56fe\u6570\u636e\u96c6\u4e0a\uff0c\u76f8\u8f83\u4e8e\u65e0\u9884\u53d6\u57fa\u7ebf\u7684\u6027\u80fd\u52a0\u901f\u6bd4\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u4e86\u516d\u79cd\u5de5\u4f5c\u8d1f\u8f7d\uff1abc\uff08Betweenness Centrality\uff09\u3001bfs\uff08Breadth-First Search\uff09\u3001cc\uff08Connected Components\uff09\u3001pr\uff08PageRank\uff09\u3001sssp\uff08Single-Source Shortest Path\uff09\u548c gm\uff08\u53ef\u80fd\u662f\u67d0\u4e2a\u56fe\u7b97\u6cd5\u7f29\u5199\uff0c\u539f\u6587\u672a\u660e\u786e\u5b9a\u4e49\uff09\u3002</li> <li>\u7eb5\u8f74\u4e3a Speedup (x)\uff0c\u8868\u793a\u6027\u80fd\u63d0\u5347\u500d\u6570\uff0c\u8303\u56f4\u4ece 0.0 \u5230 3.5\u3002</li> <li>\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u5747\u663e\u793a \u663e\u8457\u52a0\u901f\uff0c\u6700\u4f4e\u52a0\u901f\u6bd4\u7ea6\u4e3a 1.8x\uff08cc\uff09\uff0c\u6700\u9ad8\u8fbe 3.0x\uff08bfs \u548c pr\uff09\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u5373\u4f7f\u5728\u56fe\u7ed3\u6784\u5df2\u901a\u8fc7 HubSort \u4f18\u5316\u4ee5\u589e\u5f3a\u5c40\u90e8\u6027\u540e\uff0cProdigy \u4ecd\u80fd\u8fdb\u4e00\u6b65\u63d0\u5347\u6027\u80fd\uff0c\u5e73\u5747\u52a0\u901f\u7ea6 2.3x\u3002</li> <li>\u5404\u5de5\u4f5c\u8d1f\u8f7d\u52a0\u901f\u6bd4\u5177\u4f53\u5982\u4e0b\uff1a</li> </ul> Workload Speedup (x) bc ~2.5x bfs ~3.0x cc ~1.8x pr ~3.0x sssp ~2.2x gm ~2.4x <ul> <li>\u6b64\u7ed3\u679c\u9a8c\u8bc1\u4e86 Prodigy \u7684\u6709\u6548\u6027\uff1a\u5b83\u4e0d\u4f9d\u8d56\u4e8e\u6570\u636e\u5e03\u5c40\u4f18\u5316\uff0c\u800c\u662f\u901a\u8fc7 \u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1 \u548c DIG \u8868\u793a \u6765\u5e94\u5bf9\u5185\u5b58\u8bbf\u95ee\u7684\u4e0d\u89c4\u5219\u6027\uff0c\u4ece\u800c\u5728\u591a\u79cd\u56fe\u7b97\u6cd5\u4e2d\u5b9e\u73b0\u7a33\u5b9a\u4e14\u663e\u8457\u7684\u6027\u80fd\u63d0\u5347\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/figs_notes/#figure-19-normalized-energy-comparison-of-a-non-prefetching-baseline-first-bar-and-prodigy-second-bar-lower-is-better","title":"Figure 19. Normalized energy comparison of a non-prefetching baseline (first bar) and Prodigy (second bar). Lower is better.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Figure 19\uff0c\u5373 Prodigy \u4e0e\u975e\u9884\u53d6\u57fa\u7ebf\uff08non-prefetching baseline\uff09\u5728\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\u7684\u5f52\u4e00\u5316\u80fd\u8017\u5bf9\u6bd4\uff0c\u8d8a\u4f4e\u8d8a\u597d\u3002</li> <li>\u6bcf\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u5305\u542b\u4e24\u6839\u67f1\u72b6\u56fe\uff1a\u7b2c\u4e00\u6839\u4ee3\u8868\u57fa\u7ebf\uff0c\u7b2c\u4e8c\u6839\u4ee3\u8868 Prodigy\uff0c\u7528\u4e8e\u76f4\u89c2\u6bd4\u8f83\u8282\u80fd\u6548\u679c\u3002</li> <li>\u80fd\u8017\u6309\u7ec4\u4ef6\u62c6\u5206\u4e3a\u56db\u7c7b\uff0c\u7528\u4e0d\u540c\u989c\u8272\u8868\u793a\uff1a</li> <li>Core\uff08\u7d2b\u8272\uff09\uff1a\u5904\u7406\u5668\u6838\u5fc3\u80fd\u8017</li> <li>Cache\uff08\u7eff\u8272\uff09\uff1a\u7f13\u5b58\u7cfb\u7edf\u80fd\u8017</li> <li>DRAM\uff08\u84dd\u8272\uff09\uff1a\u4e3b\u5b58\u8bbf\u95ee\u80fd\u8017</li> <li>Others\uff08\u7ea2\u8272\uff09\uff1a\u5176\u4ed6\u90e8\u5206\u80fd\u8017</li> </ul> Workload Core (Baseline) Core (Prodigy) Cache (Baseline) Cache (Prodigy) DRAM (Baseline) DRAM (Prodigy) Others (Baseline) Others (Prodigy) bc-ilj ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 bc-po ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 bc-sk ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 bfs-ilj ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 bfs-po ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 bfs-sk ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 cc-ilj ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 cc-po ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 cc-sk ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 pr-ilj ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 pr-po ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 pr-sk ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 sssp-ilj ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 sssp-po ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 sssp-sk ~0.6 ~0.4 ~0.2 ~0.3 ~0.9 ~0.4 ~0.1 ~0.1 spmv ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 symgs ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 cg ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 is ~0.7 ~0.5 ~0.2 ~0.3 ~0.8 ~0.4 ~0.1 ~0.1 <ul> <li>\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cProdigy \u5747\u663e\u8457\u964d\u4f4e DRAM \u80fd\u8017\uff0c\u5e73\u5747\u964d\u5e45\u7ea6 50%\uff0c\u8fd9\u662f\u8282\u80fd\u7684\u4e3b\u8981\u6765\u6e90\u3002</li> <li>Core \u80fd\u8017\u4e5f\u666e\u904d\u4e0b\u964d\uff0c\u56e0\u6267\u884c\u65f6\u95f4\u7f29\u77ed\uff0c\u6307\u4ee4\u6570\u51cf\u5c11\u3002</li> <li>Cache \u80fd\u8017\u7565\u6709\u4e0a\u5347\uff0c\u56e0\u66f4\u591a\u6570\u636e\u88ab\u9884\u53d6\u8fdb\u7f13\u5b58\uff0c\u4f46\u6574\u4f53\u4ecd\u88ab DRAM \u8282\u80fd\u62b5\u6d88\u3002</li> <li>Others \u90e8\u5206\u80fd\u8017\u57fa\u672c\u4e0d\u53d8\uff0c\u8bf4\u660e Prodigy \u7684\u786c\u4ef6\u5f00\u9500\u6781\u5c0f\u3002</li> <li>\u7efc\u5408\u6765\u770b\uff0cProdigy \u5b9e\u73b0\u4e86 \u5e73\u5747 1.6\u00d7 \u7684\u80fd\u8017\u8282\u7701\uff0c\u9a8c\u8bc1\u5176\u5728\u80fd\u6548\u4e0a\u7684\u4f18\u52bf\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/","title":"Prodigy: Improving the Memory Latency of Data-Indirect Irregular Workloads Using Hardware-Software Co-Design \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Nishil Talati\u2217, Kyle May\u2217\u2020, Armand Behroozi\u2217, Yichen Yang\u2217, Kuba Kaszyk\u2021, Christos Vasiladiotis\u2021, Tarunesh Verma\u2217, Lu Li\u2021, Brandon Nguyen\u2217, Jiawen Sun\u2021, John Magnus Morton\u2021, Agreen Ahmadi\u2217, Todd Austin\u2217, Michael O\u2019Boyle\u2021, Scott Mahlke\u2217, Trevor Mudge\u2217, Ronald Dreslinski\u2217 - \u2217University of Michigan - \u2020University of Wisconsin, Madison - \u2021University of Edinburgh</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - \u8be5\u8bba\u6587\u672a\u5728\u63d0\u4f9b\u7684\u6587\u672c\u4e2d\u660e\u786e\u6307\u51fa\u5176\u53d1\u8868\u7684\u671f\u520a\u6216\u4f1a\u8bae\u540d\u79f0\u3002\u4f46\u6839\u636e\u5176\u683c\u5f0f\u548c\u5185\u5bb9\uff0c\u53ef\u63a8\u65ad\u5b83\u662f\u4e00\u7bc7\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u9886\u57df\u7684\u5b66\u672f\u8bba\u6587\uff0c\u5f88\u53ef\u80fd\u53d1\u8868\u5728\u5982 ISCA\u3001MICRO\u3001HPCA \u6216 ASPLOS \u7b49\u9876\u7ea7\u4f1a\u8bae\u4e0a\u3002</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - \u6587\u6863\u4e2d\u672a\u76f4\u63a5\u63d0\u4f9b\u53d1\u8868\u5e74\u4efd\u3002\u4f46\u901a\u8fc7\u53c2\u8003\u6587\u732e\u53ef\u4ee5\u63a8\u65ad\uff0c\u4f8b\u5982\u5f15\u7528\u4e862019\u5e74\u7684Bingo prefetcher [13] \u548c2018\u5e74\u7684Ainsworth and Jones\u7684\u5de5\u4f5c [5]\u3002\u7ed3\u5408\u8bba\u6587\u5185\u5bb9\u548c\u5f15\u7528\u60c5\u51b5\uff0c\u8be5\u8bba\u6587\u5f88\u53ef\u80fd\u53d1\u8868\u4e8e 2020\u5e74\u6216\u4e4b\u540e\u3002</p>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3 \u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\uff08irregular workloads\uff09\u56e0\u590d\u6742\u7684\u3001\u6570\u636e\u4f9d\u8d56\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u800c\u5bfc\u81f4\u7684\u4e25\u91cd \u5185\u5b58\u5ef6\u8fdf\u74f6\u9888 \u95ee\u9898\u3002\u8fd9\u7c7b\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u7ebf\u6027\u4ee3\u6570\uff09\u901a\u5e38\u4f7f\u7528 CSR/CSC \u7b49\u538b\u7f29\u6570\u636e\u7ed3\u6784\uff0c\u7f3a\u4e4f\u7a7a\u95f4\u548c\u65f6\u95f4\u5c40\u90e8\u6027\uff0c\u4f7f\u5f97\u4f20\u7edf\u7f13\u5b58\u548c\u9884\u53d6\u5668\u5931\u6548\u3002 - \u63d0\u51fa\u4e00\u79cd \u4f4e\u5f00\u9500\u7684\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1 \u65b9\u6848\uff0c\u4ee5\u667a\u80fd\u5730\u9884\u53d6\u6570\u636e\uff0c\u663e\u8457\u964d\u4f4e DRAM \u505c\u6ede\u65f6\u95f4\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa \u6570\u636e\u95f4\u63a5\u56fe (Data Indirection Graph, DIG)\uff1a\u4e00\u79cd\u7531\u8f6f\u4ef6\u751f\u6210\u3001\u786c\u4ef6\u6d88\u8d39\u7684 \u7d27\u51d1\u8bed\u4e49\u8868\u793a\uff0c\u7528\u4e8e\u63cf\u8ff0\u7a0b\u5e8f\u4e2d\u5173\u952e\u6570\u636e\u7ed3\u6784\u7684\u5e03\u5c40\u548c\u904d\u5386\u6a21\u5f0f\u3002   - DIG \u7684\u8282\u70b9\u4ee3\u8868\u6570\u636e\u7ed3\u6784\uff08\u5305\u542b\u57fa\u5730\u5740\u3001\u5bb9\u91cf\u3001\u5143\u7d20\u5927\u5c0f\u7b49\u4fe1\u606f\uff09\u3002   - DIG \u7684\u52a0\u6743\u8fb9\u4ee3\u8868\u4e24\u79cd\u6838\u5fc3\u7684 \u6570\u636e\u4f9d\u8d56\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff1a     - \u5355\u503c\u95f4\u63a5\u5bfb\u5740 (single-valued indirection)\uff1a\u7528\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u503c\u4f5c\u4e3a\u7d22\u5f15\u53bb\u8bbf\u95ee\u53e6\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff08\u5982\u7528\u9876\u70b9ID\u8bbf\u95ee\u5176\u5c5e\u6027\uff09\u3002     - \u8303\u56f4\u95f4\u63a5\u5bfb\u5740 (ranged indirection)\uff1a\u7528\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u4e24\u4e2a\u503c\uff08\u57fa\u5740\u548c\u8fb9\u754c\uff09\u53bb\u8bbf\u95ee\u53e6\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u4e00\u7cfb\u5217\u8fde\u7eed\u5143\u7d20\uff08\u5982\u5728CSR\u683c\u5f0f\u4e2d\u7528offset\u6570\u7ec4\u67e5\u627e\u90bb\u5c45\u5217\u8868\uff09\u3002 - \u8bbe\u8ba1\u4e86\u4e00\u5957\u5b8c\u6574\u7684 \u8f6f\u786c\u4ef6\u534f\u540c\u6d41\u7a0b\uff1a   - \u8f6f\u4ef6\u7aef\uff1a\u901a\u8fc7 LLVM\u7f16\u8bd1\u5668\u5206\u6790 \u81ea\u52a8\u63d0\u53d6\u7a0b\u5e8f\u8bed\u4e49\uff0c\u5e76\u5c06 DIG \u7f16\u7801\u5230\u5e94\u7528\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u3002\u4e5f\u652f\u6301\u7a0b\u5e8f\u5458\u624b\u52a8\u63d2\u5165 API \u6ce8\u89e3\u3002   - \u786c\u4ef6\u7aef\uff1a\u8bbe\u8ba1\u4e86\u4e00\u4e2a \u4f4e\u5f00\u9500\u7684\u53ef\u7f16\u7a0b\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u5b83\u4ece\u8f6f\u4ef6\u63a5\u6536\u5e76\u5b58\u50a8 DIG\uff0c\u7136\u540e\u6839\u636e DIG \u52a8\u6001\u5730\u89e6\u53d1\u548c\u63a8\u8fdb\u9884\u53d6\u5e8f\u5217\u3002   - \u5f15\u5165 \u9884\u53d6\u72b6\u6001\u5904\u7406\u5bc4\u5b58\u5668 (PFHR) \u6587\u4ef6\u6765\u8ddf\u8e2a\u591a\u4e2a\u5e76\u884c\u7684\u9884\u53d6\u5e8f\u5217\uff0c\u5b9e\u73b0\u975e\u963b\u585e\u9884\u53d6\u3002   - \u91c7\u7528 \u81ea\u9002\u5e94\u9884\u53d6\u7b97\u6cd5\uff0c\u80fd\u6839\u636e\u6838\u5fc3\u7684\u6267\u884c\u901f\u5ea6\u52a8\u6001\u8c03\u6574\u9884\u53d6\u8ddd\u79bb\uff0c\u5e76\u5728\u6838\u5fc3\u201c\u8ffd\u4e0a\u201d\u9884\u53d6\u5668\u65f6\u4e22\u5f03\u90e8\u5206\u9884\u53d6\u5e8f\u5217\u4ee5\u4fdd\u8bc1 \u9884\u53d6\u7684\u65f6\u6548\u6027 (timeliness)\u3002</p> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <p>\u7ed3\u679c - \u5728 GAP\u3001HPCG \u548c NAS \u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6\u7684 29 \u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u8fdb\u884c\u8bc4\u4f30\uff0cProdigy \u5c55\u73b0\u4e86\u5353\u8d8a\u7684\u6027\u80fd\u548c\u80fd\u6548\u3002 - \u4e0e\u65e0\u9884\u53d6\u57fa\u7ebf\u76f8\u6bd4\uff1a   - \u5e73\u5747\u5b9e\u73b0 2.6\u500d \u7684\u6027\u80fd\u52a0\u901f\u3002   - \u5e73\u5747\u8282\u7701 1.6\u500d \u7684\u80fd\u8017\u3002   - \u5e73\u5747\u51cf\u5c11\u4e86 80.3% \u7684 DRAM \u505c\u6ede\u3002 - \u4e0e\u524d\u6cbf\u9884\u53d6\u5668\u76f8\u6bd4\uff1a   - \u6027\u80fd\u4f18\u4e8e IMP [99] (2.3\u500d)\u3001Ainsworth and Jones\u2019 prefetcher [6] (1.5\u500d) \u548c DROPLET [15] (1.6\u500d)\u3002 - \u786c\u4ef6\u5f00\u9500\u6781\u4f4e\uff1a   - \u6574\u4e2a\u7cfb\u7edf\u4ec5\u9700 0.8KB \u7684\u5b58\u50a8\u5f00\u9500\uff08\u5305\u62ec DIG \u8868\u548c PFHR \u6587\u4ef6\uff09\u3002   - \u9884\u53d6\u51c6\u786e\u7387\u5e73\u5747\u8fbe\u5230 62.7%\uff0c\u5e76\u5c06 85.1% \u7684\u53ef\u9884\u53d6 LLC \u5931\u6548\u8f6c\u5316\u4e3a\u7f13\u5b58\u547d\u4e2d\u3002</p> \u5bf9\u6bd4\u65b9\u6848 \u5e73\u5747\u6027\u80fd\u63d0\u5347 (vs. \u65e0\u9884\u53d6\u57fa\u7ebf) \u5b58\u50a8\u5f00\u9500 Prodigy (\u672c\u5de5\u4f5c) 2.6\u00d7 0.8KB Ainsworth &amp; Jones [6] ~1.7\u00d7 ~1.6KB DROPLET [15] ~1.6\u00d7 ~7.8KB IMP [99] ~1.1\u00d7 ~1.1KB <p></p> <p>Figure 14. CPI stack comparison and speedup achieved by Prodigy against a non-prefetching baseline. Left bar: CPI stack of baseline; right bar: CPI stack of Prodigy normalized to baseline. Lower is better for CPI, higher for speedup.</p> <p></p> <p>Figure 17. Performance comparison of a non-prefetching baseline, Ainsworth and Jones\u2019 prefetcher [6], DROPLET [15], IMP [99], and Prodigy (this work). Higher is better. Ainsworth &amp; Jones and DROPLET are graph-specific approaches, and hence are omitted from non-graph workloads.</p> <p>\u7ed3\u8bba - Prodigy \u901a\u8fc7 DIG \u8fd9\u4e00\u521b\u65b0\u7684\u8f6f\u786c\u4ef6\u63a5\u53e3\uff0c\u6210\u529f\u5730\u5c06\u7a0b\u5e8f\u7684\u9ad8\u7ea7\u8bed\u4e49\uff08\u6570\u636e\u7ed3\u6784\u5e03\u5c40\u548c\u904d\u5386\u6a21\u5f0f\uff09\u4f20\u9012\u7ed9\u786c\u4ef6\u9884\u53d6\u5668\u3002 - \u8be5\u65b9\u6848\u7ed3\u5408\u4e86 \u8f6f\u4ef6\u7684\u9759\u6001\u5206\u6790\u80fd\u529b \u548c \u786c\u4ef6\u7684\u52a8\u6001\u8fd0\u884c\u65f6\u4fe1\u606f\uff0c\u5b9e\u73b0\u4e86\u5bf9\u590d\u6742\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u9ad8\u6548\u3001\u53ca\u65f6\u9884\u53d6\u3002 - Prodigy \u662f\u4e00\u79cd \u901a\u7528\u3001\u4f4e\u5f00\u9500\u4e14\u9ad8\u6548 \u7684\u89e3\u51b3\u65b9\u6848\uff0c\u80fd\u591f\u663e\u8457\u63d0\u5347\u591a\u79cd\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u7684\u6027\u80fd\u548c\u80fd\u6548\uff0c\u8bc1\u660e\u4e86\u5728 CPU \u4e2d\u96c6\u6210\u6b64\u7c7b\u4e13\u7528\u3001\u4f4e\u6210\u672c\u52a0\u901f\u5668\u7684\u5de8\u5927\u4ef7\u503c\u3002</p>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f\u4e0e\u52a8\u673a</p> <ul> <li>\u73b0\u4ee3 irregular workloads\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u7ebf\u6027\u4ee3\u6570\uff09\u5e7f\u6cdb\u4f7f\u7528 compressed sparse row/column (CSR/CSC) \u7b49\u7a00\u758f\u6570\u636e\u7ed3\u6784\uff0c\u4ee5\u8282\u7701\u7a7a\u95f4\u3002</li> <li>\u8fd9\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u5177\u6709\u9ad8\u5ea6 \u4e0d\u89c4\u5219\u6027 (irregularity) \u548c \u6570\u636e\u4f9d\u8d56\u6027 (data-dependency)\uff0c\u5bfc\u81f4\uff1a<ul> <li>\u6570\u636e\u96c6\u8fc7\u5927\uff0c\u65e0\u6cd5\u6709\u6548\u5229\u7528 on-chip caches\u3002</li> <li>\u4f20\u7edf\u57fa\u4e8e\u7a7a\u95f4\u6216\u5730\u5740\u76f8\u5173\u6027\u7684 prefetcher\uff08\u5982 GHB-based G/DC\uff09\u5b8c\u5168\u5931\u6548\u3002</li> <li>\u7a0b\u5e8f\u6267\u884c\u65f6\u95f4\u7684 50%\u4ee5\u4e0a \u88ab DRAM stalls \u6240\u5360\u636e\u3002</li> </ul> </li> <li>\u73b0\u6709\u89e3\u51b3\u65b9\u6848\u5b58\u5728\u660e\u663e\u4e0d\u8db3\uff1a<ul> <li>\u7eaf\u786c\u4ef6 prefetcher\uff1a\u8981\u4e48\u9002\u7528\u8303\u56f4\u7a84\uff08\u4ec5\u652f\u6301\u6307\u9488\u904d\u5386\uff09\uff0c\u8981\u4e48\u786c\u4ef6\u5f00\u9500\u5de8\u5927\u3002</li> <li>\u7eaf\u8f6f\u4ef6 prefetching\uff1a\u7f3a\u4e4f\u52a8\u6001\u8fd0\u884c\u65f6\u4fe1\u606f\uff0c\u96be\u4ee5\u4fdd\u8bc1 prefetch timeliness\uff08\u9884\u53d6\u53ca\u65f6\u6027\uff09\uff0c\u4e14\u5bf9\u52a8\u6001\u5206\u914d\u7684\u6570\u636e\u7ed3\u6784\u652f\u6301\u4e0d\u4f73\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 4. Normalized execution time of irregular workloads, without prefetching, broken down into: no-stall, and stalls due to DRAM, cache, branch mispredictions, data dependencies, and others. The goal of this work is to reduce the DRAM stalls (dark blue portion of the bar).</p> <p>\u6838\u5fc3\u8d21\u732e</p> <ul> <li>\u63d0\u51fa Prodigy\uff0c\u4e00\u4e2a hardware-software co-design \u7684\u4f4e\u5f00\u9500\u667a\u80fd\u9884\u53d6\u65b9\u6848\uff0c\u65e8\u5728\u89e3\u51b3\u6570\u636e\u95f4\u63a5\uff08data-indirect\uff09\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5185\u5b58\u5ef6\u8fdf\u95ee\u9898\u3002</li> <li>\u8bbe\u8ba1\u4e86 Data Indirection Graph (DIG)\uff0c\u4e00\u79cd\u65b0\u9896\u7684\u3001\u7d27\u51d1\u7684\u7a0b\u5e8f\u8bed\u4e49\u8868\u793a\u65b9\u6cd5\uff1a<ul> <li>DIG \u662f\u4e00\u4e2a\u52a0\u6743\u6709\u5411\u56fe\uff0c\u5176 \u8282\u70b9 (nodes) \u63cf\u8ff0\u5173\u952e\u6570\u636e\u7ed3\u6784\u7684\u5185\u5b58\u5e03\u5c40\uff08\u57fa\u5730\u5740\u3001\u5bb9\u91cf\u3001\u5143\u7d20\u5927\u5c0f\uff09\u3002</li> <li>\u5176 \u8fb9 (edges) \u62bd\u8c61\u4e86\u4e24\u7c7b\u6838\u5fc3\u7684\u3001\u6570\u636e\u4f9d\u8d56\u7684\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff1a<ul> <li>single-valued indirection\uff1a\u7528\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u503c\u4f5c\u4e3a\u7d22\u5f15\u53bb\u8bbf\u95ee\u53e6\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff08\u5982\u901a\u8fc7\u9876\u70b9ID\u67e5\u627e\u5176\u5c5e\u6027\uff09\u3002</li> <li>ranged indirection\uff1a\u7528\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u4e24\u4e2a\u503c\u4f5c\u4e3a\u57fa\u5740\u548c\u8fb9\u754c\uff0c\u53bb\u8bbf\u95ee\u53e6\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u4e00\u7cfb\u5217\u5143\u7d20\uff08\u5982\u5728 CSR \u683c\u5f0f\u4e2d\u901a\u8fc7 offset \u67e5\u627e\u90bb\u5c45\u5217\u8868\uff09\u3002</li> </ul> </li> <li>DIG \u8868\u793a\u4e0e\u5177\u4f53\u7684\u7a00\u758f\u683c\u5f0f\uff08\u5982 CSR/CSC\uff09\u65e0\u5173\uff0c\u5177\u6709\u901a\u7528\u6027\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <ul> <li>\u5f00\u53d1\u4e86\u4e00\u5957\u5b8c\u6574\u7684 programming model \u548c compiler pass\uff08\u57fa\u4e8e LLVM\uff09\uff1a<ul> <li>\u80fd\u591f\u81ea\u52a8\u5206\u6790\u7a0b\u5e8f\u6e90\u7801\uff0c\u63d0\u53d6\u6570\u636e\u7ed3\u6784\u548c\u904d\u5386\u6a21\u5f0f\uff0c\u5e76\u751f\u6210 DIG\u3002</li> <li>\u4e5f\u652f\u6301\u7a0b\u5e8f\u5458\u901a\u8fc7\u7b80\u5355\u7684 API calls\uff08\u5982 <code>registerNode</code>, <code>registerTravEdge</code>\uff09\u8fdb\u884c\u624b\u52a8\u6807\u6ce8\uff0c\u51cf\u8f7b\u7f16\u8bd1\u5668\u8d1f\u62c5\u3002</li> </ul> </li> <li>\u5b9e\u73b0\u4e86\u4e00\u4e2a \u4f4e\u5f00\u9500\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff1a<ul> <li>\u5229\u7528\u4ece\u8f6f\u4ef6\u4f20\u9012\u8fc7\u6765\u7684 DIG \u4fe1\u606f\u6765\u6307\u5bfc\u9884\u53d6\u3002</li> <li>\u5f15\u5165 PreFetch status Handling Register (PFHR) file \u6765\u8ddf\u8e2a\u957f\u9884\u53d6\u5e8f\u5217\u7684\u72b6\u6001\uff0c\u5b9e\u73b0 non-blocking prefetching\u3002</li> <li>\u91c7\u7528 adaptive prefetching algorithm\uff0c\u80fd\u6839\u636e\u6838\u5fc3\u7684\u6267\u884c\u901f\u5ea6\u52a8\u6001\u8c03\u6574\u9884\u53d6\u8ddd\u79bb\uff0c\u5e76\u5728\u6838\u5fc3\u201c\u8ffd\u4e0a\u201d\u9884\u53d6\u5668\u65f6\u4e22\u5f03\u65e0\u6548\u7684\u9884\u53d6\u5e8f\u5217\uff0c\u786e\u4fdd timeliness\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <ul> <li>\u5728\u771f\u5b9e\u7684\u5927\u89c4\u6a21\u6570\u636e\u96c6\u4e0a\u8fdb\u884c\u4e86\u5168\u9762\u8bc4\u4f30\uff0c\u7ed3\u679c\u8868\u660e Prodigy \u4ec5\u9700 0.8KB \u7684\u786c\u4ef6\u5b58\u50a8\u5f00\u9500\uff0c\u5373\u53ef\u5b9e\u73b0\uff1a<ul> <li>\u76f8\u6bd4\u65e0\u9884\u53d6\u57fa\u7ebf\uff0c\u5e73\u5747 2.6\u00d7 \u7684\u6027\u80fd\u52a0\u901f\u548c 1.6\u00d7 \u7684\u80fd\u8017\u8282\u7701\u3002</li> <li>\u76f8\u6bd4\u5f53\u524d\u6700\u5148\u8fdb\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 IMP, Ainsworth &amp; Jones, DROPLET\uff09\uff0c\u6027\u80fd\u63d0\u5347 1.5\u20132.3\u00d7\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>Prodigy \u662f\u4e00\u4e2a hardware-software co-design \u7cfb\u7edf\uff0c\u65e8\u5728\u901a\u8fc7\u667a\u80fd\u9884\u53d6\uff08prefetching\uff09\u6765\u964d\u4f4e\u6570\u636e\u95f4\u63a5\uff08data-indirect\uff09\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5185\u5b58\u5ef6\u8fdf\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\u7ed3\u5408\u8f6f\u4ef6\u63d0\u4f9b\u7684\u9759\u6001\u7a0b\u5e8f\u8bed\u4e49\u4fe1\u606f\u4e0e\u786c\u4ef6\u83b7\u53d6\u7684\u52a8\u6001\u8fd0\u884c\u65f6\u4fe1\u606f\uff0c\u4ee5\u5b9e\u73b0\u7cbe\u51c6\u4e14\u53ca\u65f6\u7684\u9884\u53d6\u3002</p> <ul> <li>\u8f6f\u4ef6\u4fa7 (Software Side)</li> <li>\u5f15\u5165\u4e86\u4e00\u79cd\u540d\u4e3a Data Indirection Graph (DIG) \u7684\u7d27\u51d1\u8868\u793a\u6cd5\uff0c\u7528\u4e8e\u62bd\u8c61\u548c\u7f16\u7801\u7a0b\u5e8f\u4e2d\u5173\u952e\u6570\u636e\u7ed3\u6784\u7684\u5e03\u5c40\u53ca\u5176\u904d\u5386\u6a21\u5f0f\u3002</li> <li>DIG \u662f\u4e00\u4e2a\u6709\u5411\u52a0\u6743\u56fe\uff0c\u5176\u4e2d\uff1a<ul> <li>\u8282\u70b9 (Nodes) \u4ee3\u8868\u6570\u636e\u7ed3\u6784\uff08\u5982\u6570\u7ec4\uff09\uff0c\u5305\u542b\u5176\u57fa\u5730\u5740\u3001\u5bb9\u91cf\u548c\u5143\u7d20\u5927\u5c0f\u7b49\u5185\u5b58\u5e03\u5c40\u4fe1\u606f\u3002</li> <li>\u8fb9 (Edges) \u4ee3\u8868\u6570\u636e\u4f9d\u8d56\u7684\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4e3b\u8981\u652f\u6301\u4e24\u79cd\u7c7b\u578b\uff1asingle-valued indirection\uff08\u5355\u503c\u95f4\u63a5\u5bfb\u5740\uff09\u548c ranged indirection\uff08\u8303\u56f4\u95f4\u63a5\u5bfb\u5740\uff09\u3002</li> </ul> </li> <li>\u63d0\u4f9b\u4e86\u4e24\u79cd\u6784\u5efa DIG \u7684\u65b9\u5f0f\uff1a<ul> <li>\u624b\u52a8\u6ce8\u89e3: \u7a0b\u5e8f\u5458\u4f7f\u7528\u7b80\u5355\u7684 API\uff08\u5982 <code>registerNode</code>, <code>registerTravEdge</code>\uff09\u5728\u6e90\u4ee3\u7801\u4e2d\u663e\u5f0f\u6807\u6ce8\u3002</li> <li>\u81ea\u52a8\u7f16\u8bd1\u5668\u5206\u6790: \u901a\u8fc7\u4e00\u4e2a LLVM compiler pass \u81ea\u52a8\u5206\u6790\u7a0b\u5e8f\uff0c\u8bc6\u522b\u6570\u636e\u7ed3\u6784\u548c\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5e76\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u63d2\u5165\u76f8\u5e94\u7684 API \u8c03\u7528\u3002</li> </ul> </li> <li>\u7f16\u8bd1\u540e\u7684\u5e94\u7528\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u4f1a\u5c06 DIG \u8868\u793a\u52a0\u8f7d\u5230\u786c\u4ef6\u9884\u53d6\u5668\u7684\u672c\u5730\u5185\u5b58\u4e2d\u3002</li> </ul> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <ul> <li>\u786c\u4ef6\u4fa7 (Hardware Side)</li> <li>\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u4f4e\u6210\u672c\u3001\u53ef\u7f16\u7a0b\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u8be5\u9884\u53d6\u5668\u7531\u8f6f\u4ef6\u751f\u6210\u7684 DIG \u8fdb\u884c\u914d\u7f6e\u3002</li> <li>\u9884\u53d6\u5668\u5305\u542b\u4ee5\u4e0b\u5173\u952e\u786c\u4ef6\u7ed3\u6784\uff1a<ul> <li>DIG \u5b58\u50a8\u8868: \u5305\u62ec node table, edge table, \u548c edge index table\uff0c\u7528\u4e8e\u5b58\u50a8\u4ece\u8f6f\u4ef6\u4f20\u9012\u8fc7\u6765\u7684 DIG \u4fe1\u606f\u3002</li> <li>PreFetch status Handling Register (PFHR) file: \u4e00\u4e2a\u7c7b\u4f3c\u4e8e MSHR \u7684\u786c\u4ef6\u7ed3\u6784\uff0c\u7528\u4e8e\u8ddf\u8e2a\u591a\u4e2a\u5e76\u884c\u9884\u53d6\u5e8f\u5217\u7684\u8fdb\u5ea6\uff0c\u786e\u4fdd\u9884\u53d6\u5668\u662f\u975e\u963b\u585e\u7684\uff0c\u5e76\u80fd\u6839\u636e\u6838\u5fc3\u7684\u6267\u884c\u901f\u5ea6\u52a8\u6001\u8c03\u6574\u3002</li> </ul> </li> <li>\u9884\u53d6\u7b97\u6cd5\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\uff1a<ul> <li>\u9884\u53d6\u5e8f\u5217\u521d\u59cb\u5316: \u5f53\u6838\u5fc3\u5bf9\u5e26\u6709 trigger edge \u7684\u6570\u636e\u7ed3\u6784\u53d1\u51fa\u9700\u6c42\u52a0\u8f7d\uff08demand load\uff09\u65f6\uff0c\u9884\u53d6\u5668\u4f1a\u542f\u52a8\u4e00\u4e2a\u6216\u591a\u4e2a\u9884\u53d6\u5e8f\u5217\u3002\u5b83\u4f1a\u6839\u636e\u904d\u5386\u6df1\u5ea6\u52a8\u6001\u8c03\u6574\u9884\u53d6\u8ddd\u79bb (prefetch distance)\u3002</li> <li>\u9884\u53d6\u5e8f\u5217\u63a8\u8fdb: \u5f53\u9884\u53d6\u7684\u6570\u636e\u8fd4\u56de\u65f6\uff0c\u9884\u53d6\u5668\u4f1a\u6839\u636e DIG \u4e2d\u5b9a\u4e49\u7684\u8fb9\u7c7b\u578b\uff08single-valued \u6216 ranged indirection\uff09\u89e3\u6790\u6570\u636e\u5185\u5bb9\uff0c\u5e76\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u8981\u9884\u53d6\u7684\u5730\u5740\uff0c\u4ece\u800c\u6cbf\u7740\u6570\u636e\u7ed3\u6784\u7684\u904d\u5386\u8def\u5f84\u7ee7\u7eed\u9884\u53d6\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <ul> <li>\u534f\u540c\u5de5\u4f5c\u6d41\u7a0b (Co-Design Workflow)</li> <li>\u7f16\u8bd1\u65f6: \u7f16\u8bd1\u5668\u5206\u6790\u6e90\u4ee3\u7801\uff0c\u63d0\u53d6\u8bed\u4e49\u4fe1\u606f\u5e76\u751f\u6210 DIG\uff0c\u5c06\u5176\u7f16\u7801\u4e3a API \u8c03\u7528\u5d4c\u5165\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u8fd0\u884c\u65f6\u521d\u59cb\u5316: \u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u540e\uff0c\u6267\u884c API \u8c03\u7528\uff0c\u5c06 DIG \u52a0\u8f7d\u5230\u9884\u53d6\u5668\u7684\u672c\u5730 SRAM \u4e2d\u3002</li> <li>\u8fd0\u884c\u65f6\u6267\u884c: \u9884\u53d6\u5668\u76d1\u542c L1D cache \u7684\u52a0\u8f7d\u8bf7\u6c42\u3002\u4e00\u65e6\u68c0\u6d4b\u5230\u5bf9\u89e6\u53d1\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\uff0c\u4fbf\u6839\u636e DIG \u542f\u52a8\u9884\u53d6\u5e8f\u5217\uff0c\u5e76\u5229\u7528 PFHR \u6587\u4ef6\u7ba1\u7406\u8fd9\u4e9b\u5e8f\u5217\uff0c\u52a8\u6001\u5730\u6cbf\u7740\u4e0d\u89c4\u5219\u7684\u6570\u636e\u7ed3\u6784\u8fdb\u884c\u9884\u53d6\u3002</li> </ul> <p></p> <p>Figure 1. Overview of our design and contributions. Prodigy software efficiently communicates key data structures and algorithmic traversal patterns, encoded in the proposed compact representation called the Data Indirection Graph (DIG), to the hardware for informed prefetching.</p> <ul> <li>\u5173\u952e\u4f18\u52bf\u4e0e\u5f00\u9500</li> <li>\u6027\u80fd: \u5e73\u5747\u83b7\u5f97 2.6\u00d7 \u7684\u52a0\u901f\u6bd4\uff08\u76f8\u6bd4\u65e0\u9884\u53d6\u57fa\u7ebf\uff09\uff0c\u5e76\u4f18\u4e8e\u591a\u79cd SOTA \u9884\u53d6\u5668\u3002</li> <li>\u80fd\u6548: \u5e73\u5747\u8282\u7701 1.6\u00d7 \u7684\u80fd\u8017\u3002</li> <li>\u786c\u4ef6\u6210\u672c: \u603b\u5b58\u50a8\u5f00\u9500\u4ec5\u4e3a 0.8KB\uff0c\u5305\u62ec DIG \u8868\uff080.53KB\uff09\u548c PFHR \u6587\u4ef6\uff080.26KB\uff09\uff0c\u786c\u4ef6\u9762\u79ef\u5f00\u9500\u53ef\u5ffd\u7565\u4e0d\u8ba1\uff08\u7ea6 0.004%\uff09\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#1-data-indirection-graph-dig","title":"1. Data Indirection Graph (DIG)","text":"<p>Data Indirection Graph (DIG) \u7684\u6838\u5fc3\u5b9a\u4e49\u4e0e\u76ee\u7684</p> <ul> <li>Data Indirection Graph (DIG) \u662f Prodigy \u7cfb\u7edf\u63d0\u51fa\u7684\u4e00\u79cd\u7d27\u51d1\u7684\u56fe\u8868\u793a\u6cd5\uff0c\u5176\u6839\u672c\u76ee\u7684\u662f\u5728\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1\u7684\u6846\u67b6\u4e0b\uff0c\u5c06\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u7ebf\u6027\u4ee3\u6570\uff09\u4e2d\u590d\u6742\u7684\u3001\u6570\u636e\u4f9d\u8d56\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4ece\u8f6f\u4ef6\u7aef\u9ad8\u6548\u5730\u4f20\u9012\u7ed9\u786c\u4ef6\u7aef\u7684\u9884\u53d6\u5668\u3002</li> <li>DIG \u7684\u8bbe\u8ba1\u57fa\u4e8e\u4e00\u4e2a\u5173\u952e\u89c2\u5bdf\uff1a\u5927\u91cf\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5185\u5b58\u8bbf\u95ee\u53ef\u4ee5\u88ab\u5f52\u7eb3\u4e3a\u4e24\u79cd\u57fa\u672c\u6a21\u5f0f\uff1asingle-valued indirection\uff08\u5355\u503c\u95f4\u63a5\u5bfb\u5740\uff09\u548c ranged indirection\uff08\u8303\u56f4\u95f4\u63a5\u5bfb\u5740\uff09\u3002DIG \u901a\u8fc7\u56fe\u7ed3\u6784\u5bf9\u8fd9\u4e24\u79cd\u6a21\u5f0f\u8fdb\u884c\u62bd\u8c61\u548c\u7f16\u7801\u3002</li> </ul> <p>DIG \u7684\u56fe\u7ed3\u6784\u7ec4\u6210</p> <p>DIG \u662f\u4e00\u4e2a\u5e26\u6743\u6709\u5411\u56fe\uff0c\u5176\u8282\u70b9\u548c\u8fb9\u5206\u522b\u627f\u8f7d\u4e0d\u540c\u7684\u8bed\u4e49\u4fe1\u606f\u3002</p> <ul> <li>\u8282\u70b9 (Nodes): \u4ee3\u8868\u7a0b\u5e8f\u4e2d\u7684\u4e00\u4e2a\u5173\u952e\u6570\u636e\u7ed3\u6784\uff08\u901a\u5e38\u662f\u6570\u7ec4\uff09\u3002<ul> <li>\u6bcf\u4e2a\u8282\u70b9\u5305\u542b\u4ee5\u4e0b\u5b57\u6bb5\uff1a<ul> <li><code>node_id</code>: \u6570\u636e\u7ed3\u6784\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002</li> <li><code>base_addr</code>: \u6570\u7ec4\u7684\u57fa\u5730\u5740\u3002</li> <li><code>capacity</code>: \u6570\u7ec4\u4e2d\u5143\u7d20\u7684\u603b\u6570\u3002</li> <li><code>data_size</code>: \u6bcf\u4e2a\u5143\u7d20\u7684\u5b57\u8282\u5927\u5c0f\u3002</li> </ul> </li> <li>\u8fd9\u4e9b\u4fe1\u606f\u5171\u540c\u5b9a\u4e49\u4e86\u6570\u636e\u7ed3\u6784\u5728\u5185\u5b58\u4e2d\u7684\u5e03\u5c40 (layout)\u3002</li> </ul> </li> <li>\u8fb9 (Edges): \u4ee3\u8868\u6570\u636e\u7ed3\u6784\u4e4b\u95f4\u7684\u7b97\u6cd5\u904d\u5386\u6a21\u5f0f (algorithmic traversal pattern)\uff0c\u5373\u4e00\u79cd\u6570\u636e\u4f9d\u8d56\u7684\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee\u3002<ul> <li>\u6bcf\u6761\u8fb9\u5305\u542b\u4ee5\u4e0b\u5b57\u6bb5\uff1a<ul> <li><code>src_base_addr</code>: \u6e90\u6570\u636e\u7ed3\u6784\u7684\u57fa\u5730\u5740\u3002</li> <li><code>dest_base_addr</code>: \u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u57fa\u5730\u5740\u3002</li> <li><code>edge_type</code>: \u8fb9\u7684\u7c7b\u578b\uff0c\u7531\u6743\u91cd\u6807\u8bc6\uff0c\u5177\u4f53\u5bf9\u5e94\u4e24\u79cd\u95f4\u63a5\u5bfb\u5740\u6a21\u5f0f\u3002</li> </ul> </li> </ul> </li> <li>\u89e6\u53d1\u8fb9 (Trigger Edge): \u4e00\u79cd\u7279\u6b8a\u7684\u81ea\u73af\u8fb9\uff08<code>w2</code>\uff09\uff0c\u7528\u4e8e\u6807\u8bb0\u9884\u53d6\u5e8f\u5217\u7684\u8d77\u59cb\u70b9\u3002\u5b83\u6307\u5b9a\u4e86\u54ea\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\u4f1a\u89e6\u53d1\u6574\u4e2a\u9884\u53d6\u94fe\u3002</li> </ul> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <p>DIG \u652f\u6301\u7684\u4e24\u79cd\u6838\u5fc3\u95f4\u63a5\u5bfb\u5740\u6a21\u5f0f</p> <ul> <li>Single-valued Indirection (<code>w0</code>):<ul> <li>\u6a21\u5f0f\u63cf\u8ff0\uff1a\u4ece\u6e90\u6570\u636e\u7ed3\u6784\uff08\u5982 <code>A</code>\uff09\u4e2d\u52a0\u8f7d\u4e00\u4e2a\u503c\uff08\u5982 <code>A[i]</code>\uff09\uff0c\u8be5\u503c\u4f5c\u4e3a\u4e00\u4e2a\u7d22\u5f15\uff08\u6216\u6307\u9488\uff09\u53bb\u8bbf\u95ee\u76ee\u6807\u6570\u636e\u7ed3\u6784\uff08\u5982 <code>B[A[i]]</code>\uff09\u3002</li> <li>\u5178\u578b\u5e94\u7528\u573a\u666f\uff1a\u5728\u56fe\u7b97\u6cd5\u4e2d\uff0c\u4f7f\u7528\u9876\u70b9ID\uff08\u6765\u81ea\u8fb9\u5217\u8868\uff09\u53bb\u7d22\u5f15\u9876\u70b9\u5c5e\u6027\uff08\u5982 <code>visited</code> \u5217\u8868\u6216 PageRank \u5206\u6570\uff09\u3002</li> </ul> </li> <li>Ranged Indirection (<code>w1</code>):<ul> <li>\u6a21\u5f0f\u63cf\u8ff0\uff1a\u4ece\u6e90\u6570\u636e\u7ed3\u6784\uff08\u5982 <code>offset</code>\uff09\u4e2d\u52a0\u8f7d\u4e24\u4e2a\u503c\uff08\u5982 <code>offset[i]</code> \u548c <code>offset[i+1]</code>\uff09\uff0c\u8fd9\u4e24\u4e2a\u503c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u57fa\u5730\u5740\u548c\u8fb9\u754c\uff0c\u7528\u4e8e\u8fde\u7eed\u8bbf\u95ee\u76ee\u6807\u6570\u636e\u7ed3\u6784\uff08\u5982 <code>edge[offset[i] ... offset[i+1]-1]</code>\uff09\u4e2d\u7684\u4e00\u7cfb\u5217\u5143\u7d20\u3002</li> <li>\u5178\u578b\u5e94\u7528\u573a\u666f\uff1a\u5728 CSR/CSC \u683c\u5f0f\u4e2d\uff0c\u901a\u8fc7\u504f\u79fb\u6570\u7ec4\u627e\u5230\u67d0\u4e2a\u9876\u70b9\u7684\u6240\u6709\u90bb\u5c45\uff08\u8fb9\u5217\u8868\u7684\u4e00\u4e2a\u8fde\u7eed\u5b50\u96c6\uff09\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <p>DIG \u7684\u6784\u5efa\u4e0e\u901a\u4fe1\u6d41\u7a0b</p> <p>DIG \u7684\u751f\u6210\u548c\u4f20\u9012\u662f\u4e00\u4e2a\u8f6f\u786c\u4ef6\u534f\u540c\u7684\u8fc7\u7a0b\uff0c\u652f\u6301\u624b\u52a8\u548c\u81ea\u52a8\u4e24\u79cd\u65b9\u5f0f\u3002</p> <ul> <li>\u624b\u52a8\u6784\u5efa\uff08\u7a0b\u5e8f\u5458\u6ce8\u89e3\uff09:<ul> <li>\u7a0b\u5e8f\u5458\u901a\u8fc7\u8c03\u7528\u7279\u5b9a\u7684 API \u6765\u663e\u5f0f\u5730\u6784\u5efa DIG\u3002<ul> <li><code>registerNode()</code>: \u6ce8\u518c\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u8282\u70b9\u3002</li> <li><code>registerTravEdge()</code>: \u6ce8\u518c\u4e00\u4e2a\u904d\u5386\u8fb9\uff08<code>w0</code> \u6216 <code>w1</code>\uff09\u3002</li> <li><code>registerTrigEdge()</code>: \u6ce8\u518c\u4e00\u4e2a\u89e6\u53d1\u8fb9\uff08<code>w2</code>\uff09\u3002</li> </ul> </li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 6. Annotated BFS source code to construct the DIG.</p> <ul> <li>\u81ea\u52a8\u6784\u5efa\uff08\u7f16\u8bd1\u5668\u5206\u6790\uff09:<ul> <li>Prodigy \u63d0\u4f9b\u4e86\u4e00\u4e2a LLVM \u7f16\u8bd1\u5668 Pass\uff0c\u80fd\u591f\u81ea\u52a8\u5206\u6790\u6e90\u4ee3\u7801\u5e76\u63d2\u5165\u4e0a\u8ff0 API \u8c03\u7528\u3002</li> <li>\u6784\u5efa\u6d41\u7a0b\u5206\u4e3a\u4e09\u6b65\uff1a<ol> <li>\u8282\u70b9\u8bc6\u522b: \u626b\u63cf\u5185\u5b58\u5206\u914d\u6307\u4ee4\uff08\u5982 <code>malloc</code>\uff09\uff0c\u63d0\u53d6 <code>base_addr</code>, <code>capacity</code>, <code>data_size</code> \u7b49\u4fe1\u606f\u6765\u6ce8\u518c\u8282\u70b9\u3002</li> <li>\u8fb9\u8bc6\u522b: \u901a\u8fc7\u9759\u6001\u5206\u6790\u8ffd\u8e2a\u5730\u5740\u8ba1\u7b97\u548c\u6570\u636e\u6d41\uff0c\u8bc6\u522b\u51fa <code>A[B[i]]</code> \u5f62\u5f0f\u7684\u5355\u503c\u95f4\u63a5\u5bfb\u5740\u548c\u5faa\u73af\u8fb9\u754c\u7531\u6570\u7ec4\u63a7\u5236\u7684\u8303\u56f4\u95f4\u63a5\u5bfb\u5740\uff0c\u5e76\u6ce8\u518c\u76f8\u5e94\u7684\u8fb9\u3002</li> <li>\u89e6\u53d1\u8fb9\u8bc6\u522b: \u5c06\u6ca1\u6709\u5165\u8fb9\u7684\u8282\u70b9\uff08\u901a\u5e38\u662f\u904d\u5386\u7684\u8d77\u70b9\uff0c\u5982\u5de5\u4f5c\u961f\u5217\uff09\u6807\u8bb0\u4e3a\u89e6\u53d1\u8282\u70b9\u3002</li> </ol> </li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 7. An example C program (a) and (b), translated into LLVM IR (c) and instrumented with our API calls to register DIG nodes and edges. Figure 8. Pseudocode of Prodigy\u2019s compiler analyses for (a) node identification, (b) single-valued indirection, (c) ranged indirection, and (d) runtime.</p> <pre><code>-\n</code></pre> <p></p> <p>Figure 12. Design space exploration on the PFHR file size. Performance of each configuration is normalized to 4 entries.</p> <p>DIG \u5728\u786c\u4ef6\u4e2d\u7684\u5b58\u50a8\u4e0e\u4f5c\u7528</p> <p>\u6784\u5efa\u597d\u7684 DIG \u4f1a\u88ab\u5199\u5165\u786c\u4ef6\u9884\u53d6\u5668\u672c\u5730\u7684\u4e13\u7528\u5b58\u50a8\u7ed3\u6784\u4e2d\uff0c\u6307\u5bfc\u9884\u53d6\u884c\u4e3a\u3002</p> <ul> <li>\u786c\u4ef6\u5b58\u50a8\u7ed3\u6784:<ul> <li>Node Table: \u5b58\u50a8\u6240\u6709 DIG \u8282\u70b9\u7684\u4fe1\u606f\u3002</li> <li>Edge Table: \u5b58\u50a8\u6240\u6709 DIG \u8fb9\u7684\u4fe1\u606f\u3002</li> <li>Edge Index Table: \u7c7b\u4f3c\u4e8e\u8f6f\u4ef6\u4e2d\u7684\u504f\u79fb\u6570\u7ec4\uff0c\u7528\u4e8e\u5feb\u901f\u67e5\u627e\u4ece\u67d0\u4e2a\u8282\u70b9\u51fa\u53d1\u7684\u6240\u6709\u51fa\u8fb9\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <ul> <li>\u5728\u9884\u53d6\u6d41\u7a0b\u4e2d\u7684\u4f5c\u7528:<ol> <li>\u89e6\u53d1: \u5f53 CPU \u6838\u5fc3\u53d1\u51fa\u4e00\u4e2a\u5bf9\u201c\u89e6\u53d1\u6570\u636e\u7ed3\u6784\u201d\u7684\u9700\u6c42\u52a0\u8f7d (demand load) \u65f6\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u88ab\u6fc0\u6d3b\u3002</li> <li>\u521d\u59cb\u5316: \u9884\u53d6\u5668\u6839\u636e\u89e6\u53d1\u8fb9\u7684\u4fe1\u606f\uff0c\u8ba1\u7b97\u51fa\u9700\u8981\u9884\u53d6\u7684\u521d\u59cb\u5730\u5740\uff08\u53ef\u80fd\u662f\u4e00\u4e2a\u8303\u56f4\uff09\uff0c\u5e76\u5411\u5185\u5b58\u7cfb\u7edf\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>\u63a8\u8fdb: \u5f53\u4e00\u4e2a\u9884\u53d6\u8bf7\u6c42\u7684\u6570\u636e\u8fd4\u56de\u65f6\uff0c\u9884\u53d6\u5668\u67e5\u8be2 DIG\uff0c\u627e\u5230\u8be5\u6570\u636e\u6240\u5c5e\u8282\u70b9\u7684\u51fa\u8fb9\u3002<ul> <li>\u5982\u679c\u662f <code>w0</code> (\u5355\u503c)\uff0c\u5219\u4f7f\u7528\u8fd4\u56de\u7684\u6570\u636e\u4f5c\u4e3a\u7d22\u5f15\uff0c\u7ed3\u5408\u76ee\u6807\u8282\u70b9\u7684 <code>base_addr</code> \u548c <code>data_size</code>\uff0c\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u8981\u9884\u53d6\u7684\u5730\u5740\u3002</li> <li>\u5982\u679c\u662f <code>w1</code> (\u8303\u56f4)\uff0c\u5219\u4f7f\u7528\u8fd4\u56de\u7684\u4e24\u4e2a\u503c\u4f5c\u4e3a\u8fb9\u754c\uff0c\u751f\u6210\u4e00\u7cfb\u5217\u8fde\u7eed\u7684\u9884\u53d6\u5730\u5740\u3002</li> </ul> </li> <li>\u72b6\u6001\u8ddf\u8e2a: \u6574\u4e2a\u9884\u53d6\u94fe\u7684\u72b6\u6001\u7531 PFHR (PreFetch status Handling Register) \u6587\u4ef6\u8ddf\u8e2a\uff0c\u786e\u4fdd\u975e\u963b\u585e\u548c\u53ca\u65f6\u6027\u3002</li> <li></li> </ol> </li> </ul> <p></p> <p>Figure 11. Prodigy operation: (a) prefetch sequence initialization, and (b) prefetch sequence advance.</p> <p>DIG \u7684\u4f18\u52bf\u4e0e\u5f00\u9500</p> <ul> <li>\u4f18\u52bf:<ul> <li>\u683c\u5f0f\u65e0\u5173\u6027: DIG \u62bd\u8c61\u4e86\u5177\u4f53\u7684\u7a00\u758f\u6570\u636e\u683c\u5f0f\uff08\u5982 CSR, CSC\uff09\uff0c\u53ea\u8981\u5176\u8bbf\u95ee\u6a21\u5f0f\u7b26\u5408\u4e24\u79cd\u95f4\u63a5\u5bfb\u5740\uff0c\u5373\u53ef\u88ab\u8868\u8fbe\u3002</li> <li>\u7cbe\u51c6\u6027: \u901a\u8fc7\u8f6f\u4ef6\u63d0\u4f9b\u7684\u9759\u6001\u8bed\u4e49\u4fe1\u606f\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u80fd\u7cbe\u786e\u5730\u77e5\u9053\u8981\u9884\u53d6\u54ea\u4e9b\u6570\u636e\u7ed3\u6784\u4ee5\u53ca\u5982\u4f55\u904d\u5386\uff0c\u907f\u514d\u4e86\u4f20\u7edf\u9884\u53d6\u5668\u7684\u76f2\u76ee\u731c\u6d4b\u3002</li> <li>\u4f4e\u5f00\u9500: DIG \u8868\u793a\u6781\u5176\u7d27\u51d1\u3002\u8bba\u6587\u6307\u51fa\uff0c\u5bf9\u4e8e\u8bc4\u4f30\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u6700\u5927\u7684 DIG \u4ec5\u6709 11 \u4e2a\u8282\u70b9\u548c 11 \u6761\u8fb9\u3002\u6574\u4e2a\u786c\u4ef6\u5b58\u50a8\u5f00\u9500\u4ec5\u4e3a 0.8KB\u3002</li> </ul> </li> <li>\u786c\u4ef6\u5f00\u9500\u660e\u7ec6:</li> </ul> \u7ec4\u4ef6 \u5b58\u50a8\u5185\u5bb9 \u4f30\u7b97\u5927\u5c0f (KB) DIG Tables Node Table, Edge Table, Edge Index Table 0.53 PFHR File 16 \u4e2a\u72b6\u6001\u5bc4\u5b58\u5668 0.26 \u603b\u8ba1 0.8"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#2_1","title":"2. \u7f16\u8bd1\u5668\u81ea\u52a8\u5206\u6790\u4e0e\u4ee3\u7801\u751f\u6210","text":"<p>\u7f16\u8bd1\u5668\u81ea\u52a8\u5206\u6790\u4e0e\u4ee3\u7801\u751f\u6210\u7684\u6838\u5fc3\u6d41\u7a0b</p> <p>Prodigy \u7684\u7f16\u8bd1\u5668\u901a\u8fc7\u4e00\u4e2a LLVM pass \u81ea\u52a8\u5b8c\u6210\u5bf9\u6e90\u7801\u7684\u5206\u6790\uff0c\u5e76\u5728\u4e8c\u8fdb\u5236\u4e2d\u63d2\u5165 API \u8c03\u7528\u4ee5\u6784\u5efa Data Indirection Graph (DIG)\u3002\u5176\u6838\u5fc3\u76ee\u6807\u662f\u8bc6\u522b\u7a0b\u5e8f\u4e2d\u7684\u5173\u952e\u6570\u636e\u7ed3\u6784\uff08\u8282\u70b9\uff09\u548c\u5b83\u4eec\u4e4b\u95f4\u7684\u6570\u636e\u4f9d\u8d56\u8bbf\u95ee\u6a21\u5f0f\uff08\u8fb9\uff09\uff0c\u4ece\u800c\u514d\u9664\u7a0b\u5e8f\u5458\u7684\u624b\u52a8\u6807\u6ce8\u3002</p> <ul> <li>\u8f93\u5165: \u5e94\u7528\u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801\uff0c\u7ecf\u8fc7\u524d\u7aef\u7f16\u8bd1\u540e\u751f\u6210\u7684 LLVM IR\u3002</li> <li>\u8f93\u51fa: \u7ecf\u8fc7\u63d2\u6869\uff08instrumented\uff09\u7684 LLVM IR\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u7528\u4e8e\u6ce8\u518c DIG \u8282\u70b9\u548c\u8fb9\u7684 API \u8c03\u7528\uff08\u5982 <code>registerNode</code>, <code>registerTravEdge</code>\uff09\u3002</li> <li>\u4f5c\u7528: \u4f5c\u4e3a \u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1 \u7684\u6865\u6881\uff0c\u5c06\u9759\u6001\u7684\u3001\u9ad8\u5c42\u6b21\u7684\u7a0b\u5e8f\u8bed\u4e49\uff08\u6570\u636e\u5e03\u5c40\u4e0e\u8bbf\u95ee\u6a21\u5f0f\uff09\u7cbe\u51c6\u5730\u4f20\u9012\u7ed9\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u4f7f\u5176\u80fd\u591f\u7406\u89e3\u5e76\u9884\u6d4b\u590d\u6742\u7684\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u3002</li> </ul> <p>\u8282\u70b9\uff08Node\uff09\u8bc6\u522b\u4e0e\u6ce8\u518c</p> <p>\u7f16\u8bd1\u5668\u9996\u5148\u626b\u63cf LLVM IR \u4ee5\u8bc6\u522b\u4ee3\u8868\u5173\u952e\u6570\u636e\u7ed3\u6784\u7684\u5185\u5b58\u5206\u914d\u70b9\u3002</p> <ul> <li>\u5206\u6790\u8fc7\u7a0b\u4f1a\u67e5\u627e AllocCall \u6307\u4ee4\uff08\u4f8b\u5982 <code>malloc</code> \u6216\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u5206\u914d\u5668\u8c03\u7528\uff09\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u5206\u914d\u70b9\uff0c\u7f16\u8bd1\u5668\u63d0\u53d6\u4ee5\u4e0b\u4fe1\u606f\uff1a<ul> <li><code>base_ptr</code>: \u5206\u914d\u5185\u5b58\u5757\u7684\u57fa\u5730\u5740\uff08\u5728\u8fd0\u884c\u65f6\u786e\u5b9a\uff09\u3002</li> <li><code>num_elems</code>: \u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u6570\u91cf\u3002</li> <li><code>total_size</code>: \u5206\u914d\u7684\u603b\u5b57\u8282\u6570\u3002</li> </ul> </li> <li>\u57fa\u4e8e\u8fd9\u4e9b\u4fe1\u606f\uff0c\u7f16\u8bd1\u5668\u5728\u5206\u914d\u70b9\u4e4b\u540e\u7acb\u5373\u63d2\u5165\u4e00\u4e2a <code>registerNode()</code> API \u8c03\u7528\uff0c\u5c06\u8be5\u6570\u636e\u7ed3\u6784\u6ce8\u518c\u4e3a DIG \u4e2d\u7684\u4e00\u4e2a\u8282\u70b9\u3002</li> <li></li> </ul> <p></p> <p>Figure 7. An example C program (a) and (b), translated into LLVM IR (c) and instrumented with our API calls to register DIG nodes and edges. Figure 8. Pseudocode of Prodigy\u2019s compiler analyses for (a) node identification, (b) single-valued indirection, (c) ranged indirection, and (d) runtime.</p> <pre><code>- \u56fe (c) \u5c55\u793a\u4e86 LLVM IR\uff0c\u5728\u4e24\u4e2a `malloc` \u8c03\u7528\u540e\uff0c\u5206\u522b\u63d2\u5165\u4e86 `registerNode` \u8c03\u7528\uff0c\u5bf9\u5e94\u56fe (a) \u548c (b) \u4e2d\u7684\u6570\u7ec4 `a` \u548c `b`\u3002\n</code></pre> <p>\u8fb9\uff08Edge\uff09\u8bc6\u522b\u4e0e\u6ce8\u518c</p> <p>\u5728\u8bc6\u522b\u51fa\u8282\u70b9\u540e\uff0c\u7f16\u8bd1\u5668\u901a\u8fc7\u8ffd\u8e2a\u6570\u636e\u6d41\u6765\u53d1\u73b0\u8282\u70b9\u4e4b\u95f4\u7684 indirection\uff08\u95f4\u63a5\u8bbf\u95ee\uff09\u5173\u7cfb\uff0c\u5e76\u5c06\u5176\u5206\u7c7b\u4e3a single-valued indirection \u6216 ranged indirection\u3002</p> <ul> <li>Single-valued Indirection \u8bc6\u522b:<ul> <li>\u7f16\u8bd1\u5668\u5bfb\u627e\u5f62\u5982 <code>b[a[i]]</code> \u7684\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li>\u5b83\u9996\u5148\u5b9a\u4f4d\u5230\u8ba1\u7b97 <code>a[i]</code> \u5730\u5740\u7684\u6307\u4ee4\uff08<code>AddrCalc</code>\uff09\u3002</li> <li>\u7136\u540e\u8ffd\u8e2a\u8be5\u5730\u5740\u52a0\u8f7d\uff08<code>Load</code>\uff09\u7684\u7ed3\u679c\uff0c\u5e76\u627e\u5230\u4f7f\u7528\u8be5\u7ed3\u679c\u53bb\u8ba1\u7b97 <code>b[...]</code> \u5730\u5740\u7684\u540e\u7eed\u6307\u4ee4\u3002</li> <li>\u4e00\u65e6\u786e\u8ba4\u8fd9\u79cd\u4f9d\u8d56\u94fe\uff0c\u7f16\u8bd1\u5668\u5c31\u4f1a\u63d2\u5165\u4e00\u4e2a <code>registerTravEdge()</code> \u8c03\u7528\uff0c\u5176\u53c2\u6570\u4e3a\u6e90\u6570\u7ec4 <code>a</code> \u548c\u76ee\u6807\u6570\u7ec4 <code>b</code> \u7684\u57fa\u5730\u5740\uff0c\u5e76\u6807\u8bb0 <code>edge_type</code> \u4e3a w0\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 12. Design space exploration on the PFHR file size. Performance of each configuration is normalized to 4 entries.</p> <p>\u4e2d\u7684\u4f2a\u4ee3\u7801 (b) \u63cf\u8ff0\u4e86\u8fd9\u4e00\u8fc7\u7a0b\u3002</p> <ul> <li>Ranged Indirection \u8bc6\u522b:<ul> <li>\u7f16\u8bd1\u5668\u5bfb\u627e\u63a7\u5236\u5faa\u73af\u8fb9\u754c\u7684\u6570\u636e\u8bbf\u95ee\uff0c\u4f8b\u5982 <code>for (j = offset[i]; j &lt; offset[i+1]; j++) { ... edge_list[j] ... }</code>\u3002</li> <li>\u5b83\u4f1a\u68c0\u6d4b\u5230 <code>offset[i]</code> \u548c <code>offset[i+1]</code> \u8fd9\u5bf9\u503c\u88ab\u7528\u6765\u754c\u5b9a\u5bf9 <code>edge_list</code> \u7684\u8fde\u7eed\u8bbf\u95ee\u8303\u56f4\u3002</li> <li>\u8bc6\u522b\u5230\u8fd9\u79cd\u6a21\u5f0f\u540e\uff0c\u7f16\u8bd1\u5668\u540c\u6837\u63d2\u5165 <code>registerTravEdge()</code> \u8c03\u7528\uff0c\u4f46\u5c06 <code>edge_type</code> \u6807\u8bb0\u4e3a w1\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 12. Design space exploration on the PFHR file size. Performance of each configuration is normalized to 4 entries.</p> <p>\u4e2d\u7684\u4f2a\u4ee3\u7801 (c) \u63cf\u8ff0\u4e86\u8fd9\u4e00\u8fc7\u7a0b\u3002</p> <p>\u89e6\u53d1\u8fb9\uff08Trigger Edge\uff09\u7684\u786e\u5b9a</p> <p>\u89e6\u53d1\u8fb9\u7528\u4e8e\u544a\u8bc9\u786c\u4ef6\u9884\u53d6\u5668\u4ece\u54ea\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\u5f00\u59cb\u542f\u52a8\u9884\u53d6\u5e8f\u5217\u3002</p> <ul> <li>\u7f16\u8bd1\u5668\u91c7\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u542f\u53d1\u5f0f\u89c4\u5219\uff1a\u5728\u5df2\u8bc6\u522b\u7684\u6240\u6709\u904d\u5386\u8fb9\u6784\u6210\u7684\u56fe\u4e2d\uff0c\u6ca1\u6709\u5165\u8fb9\uff08incoming edge\uff09\u7684\u8282\u70b9\u88ab\u89c6\u4e3a\u89e6\u53d1\u8282\u70b9\u3002</li> <li>\u8fd9\u662f\u56e0\u4e3a\u8fd9\u7c7b\u8282\u70b9\u901a\u5e38\u662f\u7b97\u6cd5\u904d\u5386\u7684\u8d77\u70b9\uff08\u4f8b\u5982 BFS \u4e2d\u7684 <code>workQueue</code>\uff09\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u89e6\u53d1\u8282\u70b9\uff0c\u7f16\u8bd1\u5668\u4f1a\u63d2\u5165\u4e00\u4e2a <code>registerTrigEdge()</code> \u8c03\u7528\u3002</li> <li>\u5728 </li> </ul> <p></p> <p>Figure 7. An example C program (a) and (b), translated into LLVM IR (c) and instrumented with our API calls to register DIG nodes and edges. Figure 8. Pseudocode of Prodigy\u2019s compiler analyses for (a) node identification, (b) single-valued indirection, (c) ranged indirection, and (d) runtime.</p> <p>\u7684\u4f8b\u5b50\u4e2d\uff0c\u6570\u7ec4 <code>a</code> \u7684\u8bbf\u95ee\uff08IR \u884c 6\uff09\u6ca1\u6709\u5165\u8fb9\uff0c\u56e0\u6b64\u88ab\u8bbe\u4e3a\u89e6\u53d1\u8282\u70b9\uff0c\u5e76\u5728\u51fd\u6570\u5f00\u5934\uff08IR \u884c 2-3\uff09\u63d2\u5165\u4e86\u76f8\u5e94\u7684\u6ce8\u518c\u8c03\u7528\u3002</p> <p>\u8bbe\u8ba1\u4f18\u52bf\u4e0e\u8003\u91cf</p> <ul> <li>\u907f\u514d\u590d\u6742\u5206\u6790: \u8be5\u65b9\u6cd5\u5de7\u5999\u5730\u907f\u5f00\u4e86\u4ee3\u4ef7\u9ad8\u6602\u7684 interprocedural analysis\uff08\u8de8\u8fc7\u7a0b\u5206\u6790\uff09\u3002\u8282\u70b9\u548c\u8fb9\u7684\u5173\u7cfb\u89e3\u6790\u88ab\u63a8\u8fdf\u5230\u8fd0\u884c\u65f6\uff0c\u901a\u8fc7\u865a\u62df\u5730\u5740\u5339\u914d\u6765\u5b8c\u6210\uff0c\u8fd9\u5927\u5927\u7b80\u5316\u4e86\u7f16\u8bd1\u65f6\u7684\u5206\u6790\u8d1f\u62c5\u3002</li> <li>\u4f4e\u5f00\u9500: \u8bba\u6587\u6307\u51fa\uff0c\u7f16\u8bd1\u5668\u5206\u6790\u5e26\u6765\u7684\u989d\u5916\u7f16\u8bd1\u65f6\u95f4\u5e73\u5747\u4e0d\u5230\u4e00\u79d2\uff0c\u4e14\u63d2\u5165\u7684 API \u8c03\u7528\u53ea\u5728\u7a0b\u5e8f\u521d\u59cb\u5316\u65f6\u6267\u884c\u4e00\u6b21\uff0c\u5bf9\u52a8\u6001\u6307\u4ee4\u6570\u7684\u5f71\u54cd\u53ef\u5ffd\u7565\u4e0d\u8ba1\u3002</li> <li>\u7075\u6d3b\u6027: \u81ea\u52a8\u751f\u6210\u7684 API \u8c03\u7528\u4e0e\u7a0b\u5e8f\u5458\u624b\u52a8\u63d2\u5165\u7684 API \u517c\u5bb9\uff0c\u4e8c\u8005\u53ef\u4ee5\u4e92\u8865\uff0c\u63d0\u9ad8\u4e86\u7cfb\u7edf\u7684\u9c81\u68d2\u6027\u548c\u51c6\u786e\u6027\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#3-dig","title":"3. \u57fa\u4e8eDIG\u7684\u4f4e\u5f00\u9500\u786c\u4ef6\u9884\u53d6\u5668","text":"<p>\u6838\u5fc3\u89c2\u70b9</p> <p>Prodigy \u7684\u786c\u4ef6\u9884\u53d6\u5668\u662f\u4e00\u4e2a\u9ad8\u5ea6\u4e13\u4e1a\u5316\u3001\u4f4e\u5f00\u9500\u7684\u5355\u5143\uff0c\u5176\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\u5229\u7528\u8f6f\u4ef6\u5728\u7f16\u8bd1\u65f6\u751f\u6210\u7684 Data Indirection Graph (DIG) \u6765\u6307\u5bfc\u786c\u4ef6\u8fdb\u884c\u7cbe\u51c6\u7684\u3001\u57fa\u4e8e\u8bed\u4e49\u7684\u9884\u53d6\u3002\u8be5\u8bbe\u8ba1\u6452\u5f03\u4e86\u4f20\u7edf\u9884\u53d6\u5668\u4f9d\u8d56\u5730\u5740\u76f8\u5173\u6027\u6216\u6a21\u5f0f\u5339\u914d\u7684\u901a\u7528\u65b9\u6cd5\uff0c\u8f6c\u800c\u91c7\u7528\u4e00\u79cd\u201c\u8f6f\u786c\u534f\u540c\u3001\u8bed\u4e49\u9a71\u52a8\u201d\u7684\u8303\u5f0f\u3002</p> <ul> <li>\u8f93\u5165: \u9884\u53d6\u5668\u7684\u4e3b\u8981\u8f93\u5165\u662f\u4e24\u90e8\u5206\uff1a</li> <li>\u9759\u6001\u8bed\u4e49\u4fe1\u606f: \u7531\u8f6f\u4ef6\uff08\u901a\u8fc7\u7f16\u8bd1\u5668\u6216\u7a0b\u5e8f\u5458\u6ce8\u89e3\uff09\u751f\u6210\u5e76\u52a0\u8f7d\u5230\u9884\u53d6\u5668\u672c\u5730 SRAM \u4e2d\u7684 DIG\u3002DIG \u5305\u542b\u4e86\u6570\u636e\u7ed3\u6784\u7684\u5e03\u5c40\uff08\u57fa\u5730\u5740\u3001\u5bb9\u91cf\u3001\u5143\u7d20\u5927\u5c0f\uff09\u548c\u5b83\u4eec\u4e4b\u95f4\u7684\u8bbf\u95ee\u5173\u7cfb\uff08\u5355\u503c\u95f4\u63a5\u5bfb\u5740 <code>w0</code>\u3001\u8303\u56f4\u95f4\u63a5\u5bfb\u5740 <code>w1</code> \u548c\u89e6\u53d1\u8fb9 <code>w2</code>\uff09\u3002</li> <li> <p>\u52a8\u6001\u8fd0\u884c\u65f6\u4e8b\u4ef6: \u9884\u53d6\u5668\u901a\u8fc7\u4fa6\u542c\uff08snoop\uff09L1D cache \u7684 demand load \u8bf7\u6c42\u6765\u89e6\u53d1\u9884\u53d6\u884c\u4e3a\u3002\u5f53\u4e00\u4e2a demand load \u7684\u5730\u5740\u843d\u5728 DIG \u4e2d\u6807\u8bb0\u4e3a\u201c\u89e6\u53d1\u8282\u70b9\u201d\u7684\u5730\u5740\u8303\u56f4\u5185\u65f6\uff0c\u9884\u53d6\u5e8f\u5217\u88ab\u6fc0\u6d3b\u3002</p> </li> <li> <p>\u8f93\u51fa: \u9884\u53d6\u5668\u5411\u5185\u5b58\u5b50\u7cfb\u7edf\u53d1\u51fa non-binding prefetch requests\uff08\u975e\u7ed1\u5b9a\u9884\u53d6\u8bf7\u6c42\uff09\uff0c\u5c06\u6570\u636e\u63d0\u524d\u52a0\u8f7d\u5230 L1D cache \u4e2d\uff0c\u4ee5\u9690\u85cf\u540e\u7eed\u8ba1\u7b97\u7684 DRAM \u8bbf\u95ee\u5ef6\u8fdf\u3002</p> </li> </ul> <p></p> <p>Figure 5. Proposed Data Indirection Graph (DIG) representation\u2014(a) example representation for BFS, (b) data structure memory layout and algorithmic traversal information captured by a DIG node and a weighted DIG edge respectively; two unique data-dependent indirection patterns supported by Prodigy\u2014(c) single-valued indirection, and (d) ranged indirection.</p> <p>\u786c\u4ef6\u5b58\u50a8\u7ed3\u6784\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <p>\u9884\u53d6\u5668\u7684\u786c\u4ef6\u5b9e\u73b0\u56f4\u7ed5\u4e24\u4e2a\u5173\u952e\u7ec4\u4ef6\uff1a\u7528\u4e8e\u5b58\u50a8 DIG \u7684\u672c\u5730\u5185\u5b58\u548c\u7528\u4e8e\u8ddf\u8e2a\u9884\u53d6\u72b6\u6001\u7684\u5bc4\u5b58\u5668\u6587\u4ef6\u3002</p> <ul> <li>DIG \u5b58\u50a8\u7ed3\u6784:</li> <li>Node Table (\u8282\u70b9\u8868): \u5b58\u50a8\u6bcf\u4e2a\u6570\u636e\u7ed3\u6784\u8282\u70b9\u7684\u4fe1\u606f\uff0c\u5305\u62ec <code>base_addr</code>\uff08\u57fa\u5730\u5740\uff09\u3001<code>bound_addr</code>\uff08\u8fb9\u754c\u5730\u5740\uff09\u548c <code>data_size</code>\uff08\u5143\u7d20\u5927\u5c0f\uff09\u3002\u8fd9\u4e9b\u4fe1\u606f\u5c06\u8f6f\u4ef6\u4e2d\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u6620\u5c04\u5230\u786c\u4ef6\u53ef\u7406\u89e3\u7684\u683c\u5f0f\u3002</li> <li>Edge Table (\u8fb9\u8868): \u5b58\u50a8\u8282\u70b9\u95f4\u7684\u95f4\u63a5\u8bbf\u95ee\u5173\u7cfb\uff0c\u5305\u62ec\u6e90\u8282\u70b9\u548c\u76ee\u6807\u8282\u70b9\u7684\u57fa\u5730\u5740\u4ee5\u53ca <code>edge_type</code>\uff08<code>w0</code>, <code>w1</code> \u6216 <code>w2</code>\uff09\u3002</li> <li>Edge Index Table (\u8fb9\u7d22\u5f15\u8868): \u7c7b\u4f3c\u4e8e CSR \u683c\u5f0f\u4e2d\u7684\u504f\u79fb\u6570\u7ec4\uff0c\u7528\u4e8e\u5feb\u901f\u67e5\u627e\u4ece\u67d0\u4e2a\u6e90\u8282\u70b9\u51fa\u53d1\u7684\u6240\u6709\u51fa\u8fb9\uff0c\u52a0\u901f\u56fe\u904d\u5386\u3002</li> <li>\u8fd9\u4e9b\u8868\u7684\u603b\u5b58\u50a8\u5f00\u9500\u88ab\u4e25\u683c\u63a7\u5236\u5728 0.8KB \u4ee5\u5185\uff0c\u5176\u4e2d DIG \u8868\u7ea6\u5360 0.53KB\uff0cPFHR \u6587\u4ef6\u7ea6\u5360 0.26KB\u3002</li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <ul> <li>\u9884\u53d6\u72b6\u6001\u8ddf\u8e2a (PFHR):</li> <li>\u5f15\u5165 PreFetch status Handling Register (PFHR) file \u6765\u7ba1\u7406\u591a\u4e2a\u5e76\u53d1\u7684\u9884\u53d6\u5e8f\u5217\u3002</li> <li>\u6bcf\u4e2a PFHR \u6761\u76ee\u5305\u542b\uff1a<ul> <li><code>Free</code>: \u6807\u8bb0\u6761\u76ee\u662f\u5426\u7a7a\u95f2\u3002</li> <li><code>Node ID</code>: \u5f53\u524d\u6b63\u5728\u5904\u7406\u7684 DIG \u8282\u70b9\u3002</li> <li><code>Prefetch trigger address</code>: \u89e6\u53d1\u6b64\u9884\u53d6\u5e8f\u5217\u7684\u539f\u59cb demand \u5730\u5740\u3002</li> <li><code>Outstanding prefetch addresses</code>: \u6b63\u5728\u7b49\u5f85\u8fd4\u56de\u7684\u9884\u53d6\u7269\u7406\u5730\u5740\u5217\u8868\u3002</li> <li><code>Offset bitmap</code>: \u7528\u4e8e\u8ddf\u8e2a\u4e00\u4e2a cache line \u5185\u54ea\u4e9b\u5b57\u8282\u5df2\u88ab\u9884\u53d6\u3002</li> </ul> </li> <li> <p>PFHR \u7684\u8bbe\u8ba1\u4f7f\u9884\u53d6\u5668\u6210\u4e3a non-blocking\uff08\u975e\u963b\u585e\uff09\u7684\uff0c\u5141\u8bb8\u540c\u65f6\u53d1\u8d77\u591a\u4e2a\u957f\u94fe\u9884\u53d6\u8bf7\u6c42\uff0c\u6781\u5927\u63d0\u5347\u4e86\u541e\u5410\u91cf\u3002</p> </li> <li> <p>\u9884\u53d6\u7b97\u6cd5\u6d41\u7a0b:   \u9884\u53d6\u8fc7\u7a0b\u5206\u4e3a\u521d\u59cb\u5316\u548c\u63a8\u8fdb\u4e24\u4e2a\u9636\u6bb5\u3002</p> </li> <li>\u9884\u53d6\u5e8f\u5217\u521d\u59cb\u5316:<ul> <li>\u5f53\u4fa6\u542c\u5230\u5bf9\u201c\u89e6\u53d1\u8282\u70b9\u201d\u7684 demand load \u65f6\uff0c\u7b97\u6cd5\u88ab\u6fc0\u6d3b\u3002</li> <li>\u6839\u636e\u89e6\u53d1\u8fb9 <code>w2</code> \u4e2d\u7f16\u7801\u7684 prefetch look-ahead distance\uff08\u9884\u53d6\u524d\u77bb\u8ddd\u79bb\uff09\u53c2\u6570\uff0c\u8ba1\u7b97\u51fa\u9700\u8981\u63d0\u524d\u9884\u53d6\u7684\u8d77\u59cb\u5730\u5740\u3002\u8be5\u8ddd\u79bb\u662f\u4e00\u4e2a\u542f\u53d1\u5f0f\u503c\uff0c\u4f1a\u6839\u636e DIG \u7684\u5173\u952e\u8def\u5f84\u6df1\u5ea6\u52a8\u6001\u8c03\u6574\uff08\u8def\u5f84\u8d8a\u6df1\uff0c\u8ddd\u79bb\u8d8a\u5c0f\uff09\u3002</li> <li>\u4e3a\u8fd9\u4e2a\u65b0\u7684\u9884\u53d6\u5e8f\u5217\u5206\u914d\u4e00\u4e2a PFHR \u6761\u76ee\uff0c\u5e76\u53d1\u51fa\u7b2c\u4e00\u4e2a\u9884\u53d6\u8bf7\u6c42\u3002</li> </ul> </li> <li>\u9884\u53d6\u5e8f\u5217\u63a8\u8fdb:<ul> <li>\u5f53\u4e00\u4e2a\u9884\u53d6\u8bf7\u6c42\u7684\u6570\u636e\u8fd4\u56de\uff08prefetch fill\uff09\u65f6\uff0c\u9884\u53d6\u5668\u901a\u8fc7 CAM \u67e5\u627e\u5bf9\u5e94\u7684 PFHR\u3002</li> <li>\u5229\u7528 PFHR \u4e2d\u7684 <code>Node ID</code> \u67e5\u8be2 Edge Index Table \u548c Edge Table\uff0c\u627e\u5230\u6240\u6709\u51fa\u8fb9\u53ca\u5176 <code>edge_type</code>\u3002</li> <li>\u6839\u636e <code>edge_type</code> \u6267\u884c\u76f8\u5e94\u7684\u95f4\u63a5\u5bfb\u5740\u8ba1\u7b97\uff1a</li> <li>\u5bf9\u4e8e single-valued indirection (<code>w0</code>): \u5c06\u8fd4\u56de\u7684\u6570\u636e\u503c\u4f5c\u4e3a\u7d22\u5f15\uff0c\u7ed3\u5408\u76ee\u6807\u8282\u70b9\u7684 <code>base_addr</code> \u548c <code>data_size</code>\uff0c\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u8981\u9884\u53d6\u7684\u5730\u5740\u3002</li> <li>\u5bf9\u4e8e ranged indirection (<code>w1</code>): \u5c06\u8fd4\u56de\u7684\u6570\u636e\u503c\uff08\u901a\u5e38\u662f\u4e00\u5bf9 base/bound\uff09\u89e3\u91ca\u4e3a\u4e00\u4e2a\u8303\u56f4\uff0c\u5e76\u9884\u53d6\u8be5\u8303\u56f4\u5185\u7684\u6240\u6709\u8fde\u7eed\u5143\u7d20\u3002</li> <li>\u4e3a\u65b0\u8ba1\u7b97\u51fa\u7684\u5730\u5740\u5206\u914d\u65b0\u7684 PFHR\uff08\u5982\u679c\u76ee\u6807\u662f\u975e\u53f6\u8282\u70b9\uff09\uff0c\u5e76\u53d1\u51fa\u65b0\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u5982\u6b64\u9012\u5f52\u63a8\u8fdb\uff0c\u76f4\u5230\u5230\u8fbe DIG \u7684\u53f6\u8282\u70b9\u3002</li> </ul> </li> </ul> <p>\u81ea\u9002\u5e94\u673a\u5236\u4e0e\u6574\u4f53\u4f5c\u7528</p> <p>Prodigy \u7684\u786c\u4ef6\u9884\u53d6\u5668\u4e0d\u4ec5\u662f\u88ab\u52a8\u6267\u884c DIG \u6307\u4ee4\uff0c\u8fd8\u5177\u5907\u5173\u952e\u7684\u52a8\u6001\u9002\u5e94\u80fd\u529b\u3002</p> <ul> <li>\u52a8\u6001\u4e22\u5f03\u673a\u5236: PFHR \u4e2d\u5b58\u50a8\u7684 <code>Prefetch trigger address</code> \u662f\u5b9e\u73b0\u81ea\u9002\u5e94\u7684\u5173\u952e\u3002\u5982\u679c\u6838\u5fc3\u7684\u6267\u884c\u901f\u5ea6\u5f88\u5feb\uff0c\u4ee5\u81f3\u4e8e\u53d1\u51fa\u4e86\u5bf9\u8fd9\u4e2a <code>trigger address</code> \u7684 demand load\uff0c\u8bf4\u660e\u9884\u53d6\u5668\u5df2\u7ecf\u843d\u540e\u3002\u6b64\u65f6\uff0c\u786c\u4ef6\u4f1a \u4e3b\u52a8\u4e22\u5f03 \u6574\u4e2a\u9884\u53d6\u5e8f\u5217\uff0c\u56e0\u4e3a\u7ee7\u7eed\u5b8c\u6210\u5b83\u53ea\u80fd\u90e8\u5206\u9690\u85cf\u5ef6\u8fdf\uff0c\u53cd\u800c\u53ef\u80fd\u9020\u6210 cache pollution\u3002\u8fd9\u79cd\u673a\u5236\u786e\u4fdd\u4e86\u9884\u53d6\u7684 timeliness\uff08\u53ca\u65f6\u6027\uff09\u3002</li> <li>\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528: \u8be5\u9884\u53d6\u5668\u5145\u5f53\u4e86\u8fde\u63a5\u8f6f\u4ef6\u8bed\u4e49\u4e16\u754c\u548c\u786c\u4ef6\u6267\u884c\u4e16\u754c\u7684\u6865\u6881\u3002\u8f6f\u4ef6\u901a\u8fc7 DIG \u7cbe\u786e\u5730\u201c\u544a\u8bc9\u201d\u786c\u4ef6\u201c\u6570\u636e\u5728\u54ea\u91cc\uff0c\u4ee5\u53ca\u5982\u4f55\u88ab\u8bbf\u95ee\u201d\uff0c\u800c\u786c\u4ef6\u5219\u5229\u7528\u5176\u5bf9\u8fd0\u884c\u65f6\u72b6\u6001\uff08\u5982\u6838\u5fc3\u6267\u884c\u8fdb\u5ea6\u3001cache \u54cd\u5e94\uff09\u7684\u611f\u77e5\uff0c\u52a8\u6001\u5730\u3001\u9ad8\u6548\u5730\u6267\u884c\u9884\u53d6\u3002\u8fd9\u79cd\u534f\u540c\u4f7f\u5f97 Prodigy \u80fd\u591f\u5728\u6781\u4f4e\u7684\u786c\u4ef6\u6210\u672c\uff080.8KB\uff09\u4e0b\uff0c\u5bf9\u590d\u6742\u7684\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u7ebf\u6027\u4ee3\u6570\uff09\u5b9e\u73b0\u9ad8\u8fbe 2.6\u00d7 \u7684\u5e73\u5747\u6027\u80fd\u63d0\u5347\u3002</li> </ul> \u7ec4\u4ef6 \u529f\u80fd \u5173\u952e\u53c2\u6570/\u7279\u6027 DIG (\u8f6f\u4ef6\u751f\u6210) \u7f16\u7801\u7a0b\u5e8f\u8bed\u4e49 \u8282\u70b9\uff08\u6570\u636e\u7ed3\u6784\u5e03\u5c40\uff09\u3001\u8fb9\uff08<code>w0</code>/<code>w1</code>/<code>w2</code> \u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff09 Node/Edge Tables \u5b58\u50a8 DIG \u603b\u8ba1\u7ea6 0.53KB\uff0c\u5b58\u50a8\u865a\u62df\u5730\u5740\u4fe1\u606f PFHR File \u8ddf\u8e2a\u9884\u53d6\u72b6\u6001 16 \u4e2a\u6761\u76ee\uff0c\u603b\u8ba1\u7ea6 0.26KB\uff0c\u652f\u6301 non-blocking \u9884\u53d6 \u9884\u53d6\u7b97\u6cd5 \u6267\u884c\u9884\u53d6\u903b\u8f91 \u57fa\u4e8e <code>w0</code>/<code>w1</code> \u7684\u5730\u5740\u8ba1\u7b97\uff0c\u52a8\u6001\u524d\u77bb\u8ddd\u79bb\uff0c\u81ea\u9002\u5e94\u4e22\u5f03\u673a\u5236"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#4-pfhr","title":"4. \u9884\u53d6\u72b6\u6001\u5904\u7406\u5bc4\u5b58\u5668\u6587\u4ef6 (PFHR)","text":"<p>PFHR \u7684\u8bbe\u8ba1\u52a8\u673a\u4e0e\u6838\u5fc3\u529f\u80fd</p> <ul> <li>\u4f20\u7edf\u7684\u9884\u53d6\u5668\u5728\u5904\u7406\u56fe\u8ba1\u7b97\u7b49\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u65f6\u9762\u4e34\u4e24\u5927\u6311\u6218\uff1a<ul> <li>\u957f\u4f9d\u8d56\u94fe\u8ddf\u8e2a\uff1a\u4e00\u4e2a\u5b8c\u6574\u7684\u9884\u53d6\u5e8f\u5217\uff08\u4f8b\u5982 BFS \u4e2d\u4ece workQueue -&gt; offset -&gt; edge -&gt; visited\uff09\u53ef\u80fd\u8de8\u8d8a \u56db\u4e2a\u6216\u66f4\u591a \u6570\u636e\u7ed3\u6784\uff0c\u786c\u4ef6\u9700\u8981\u8ddf\u8e2a\u6574\u4e2a\u94fe\u8def\u4e0a\u591a\u4e2a\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u3002</li> <li>\u963b\u585e\u95ee\u9898\uff1a\u5982\u679c\u9884\u53d6\u5668\u5fc5\u987b\u7b49\u5f85\u4e00\u4e2a\u5b8c\u6574\u7684\u5e8f\u5217\u5168\u90e8\u5b8c\u6210\u540e\u624d\u80fd\u5f00\u59cb\u4e0b\u4e00\u4e2a\uff0c\u4f1a\u4e25\u91cd\u9650\u5236\u5176\u5e76\u884c\u6027\u548c\u6548\u7387\uff0c\u5bfc\u81f4\u9884\u53d6\u673a\u4f1a\u4e22\u5931\u3002</li> </ul> </li> <li>PreFetch status Handling Register (PFHR) \u6587\u4ef6 \u88ab\u8bbe\u8ba1\u7528\u6765\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\uff0c\u5176\u6838\u5fc3\u76ee\u6807\u662f\u5b9e\u73b0 \u975e\u963b\u585e\u9884\u53d6 (non-blocking prefetching) \u5e76 \u52a8\u6001\u7ba1\u7406\u9884\u53d6\u5e8f\u5217\u7684\u65f6\u6548\u6027\u3002</li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <p>PFHR \u6761\u76ee\u7684\u5185\u90e8\u7ed3\u6784\u4e0e\u5b57\u6bb5\u542b\u4e49</p> <p>\u6bcf\u4e2a PFHR \u6761\u76ee\uff08\u5373\u6587\u4ef6\u4e2d\u7684\u4e00\u884c\uff09\u5305\u542b\u4ee5\u4e0b\u5173\u952e\u5b57\u6bb5\uff0c\u7528\u4e8e\u7cbe\u786e\u8ddf\u8e2a\u4e00\u4e2a\u6d3b\u8dc3\u7684\u9884\u53d6\u5e8f\u5217\uff1a</p> <ul> <li>Free: \u4e00\u4e2a\u6807\u5fd7\u4f4d\uff0c\u6307\u793a\u8be5 PFHR \u6761\u76ee\u5f53\u524d\u662f\u7a7a\u95f2\u8fd8\u662f\u88ab\u5360\u7528\u3002</li> <li>Node ID: \u8bb0\u5f55\u5f53\u524d\u6b63\u5728\u7b49\u5f85\u5176\u6570\u636e\u8fd4\u56de\u7684 DIG \u8282\u70b9 ID\u3002\u8fd9\u6807\u8bc6\u4e86\u9884\u53d6\u94fe\u4e2d\u7684\u5f53\u524d\u4f4d\u7f6e\u3002</li> <li>Prefetch trigger address: \u5b58\u50a8\u542f\u52a8\u6b64\u9884\u53d6\u5e8f\u5217\u7684 \u865a\u62df\u5730\u5740\u3002\u8fd9\u662f\u4fdd\u8bc1\u9884\u53d6 timeliness (\u65f6\u6548\u6027) \u7684\u5173\u952e\u3002</li> <li>Outstanding prefetch addresses: \u5b58\u50a8\u4e00\u4e2a\u6216\u591a\u4e2a\u5df2\u53d1\u51fa\u4f46\u5c1a\u672a\u8fd4\u56de\u7684 cache line-aligned \u7269\u7406\u5730\u5740\u3002\u5f53\u9884\u53d6\u6570\u636e\u8fd4\u56de\u65f6\uff0c\u786c\u4ef6\u901a\u8fc7 CAM (Content-Addressable Memory) \u67e5\u627e \u6b64\u5b57\u6bb5\u6765\u5b9a\u4f4d\u5bf9\u5e94\u7684 PFHR \u6761\u76ee\u3002</li> <li>Offset bitmap: \u4e00\u4e2a\u4f4d\u56fe\uff0c\u7528\u4e8e\u8ddf\u8e2a\u5728\u4e00\u4e2a cache line \u5185\uff0c\u54ea\u4e9b\u5177\u4f53\u7684 byte-addresses \u7684\u9884\u53d6\u8bf7\u6c42\u662f\u672a\u5b8c\u6210\u7684\u3002\u8fd9\u5bf9\u4e8e\u5904\u7406\u90e8\u5206 cache line \u8bbf\u95ee\u7684\u60c5\u51b5\u81f3\u5173\u91cd\u8981\u3002</li> </ul> <p>PFHR \u9a71\u52a8\u7684\u9884\u53d6\u7b97\u6cd5\u6d41\u7a0b</p> <p>PFHR \u662f Prodigy \u52a8\u6001\u3001\u81ea\u9002\u5e94\u9884\u53d6\u7b97\u6cd5\u7684\u6838\u5fc3\u6267\u884c\u5355\u5143\uff0c\u5176\u5de5\u4f5c\u6d41\u7a0b\u5206\u4e3a\u521d\u59cb\u5316\u548c\u63a8\u8fdb\u4e24\u4e2a\u9636\u6bb5\uff1a</p> <ul> <li> <p>\u9884\u53d6\u5e8f\u5217\u521d\u59cb\u5316 (Initialization):</p> <ul> <li>\u5f53\u5904\u7406\u5668\u6838\u5fc3\u53d1\u51fa\u4e00\u4e2a demand load request\uff0c\u4e14\u8be5\u8bf7\u6c42\u7684\u5730\u5740\u843d\u5728\u67d0\u4e2a\u5e26\u6709 trigger edge (\u89e6\u53d1\u8fb9) \u7684\u6570\u636e\u7ed3\u6784\u8303\u56f4\u5185\u65f6\uff0c\u89e6\u53d1\u4e8b\u4ef6\u53d1\u751f\u3002</li> <li>\u786c\u4ef6\u6839\u636e DIG \u4e2d trigger edge \u643a\u5e26\u7684\u4fe1\u606f\uff08\u5982\u9884\u53d6\u6df1\u5ea6\u3001\u65b9\u5411\uff09\uff0c\u8ba1\u7b97\u51fa\u4e00\u4e2a\u6216\u591a\u4e2a\u524d\u77bb\u5730\u5740\u3002</li> <li>\u4e3a\u6bcf\u4e2a\u524d\u77bb\u5730\u5740\u5206\u914d\u4e00\u4e2a\u65b0\u7684 PFHR \u6761\u76ee\uff0c\u5e76\u7528\u521d\u59cb\u4fe1\u606f\uff08\u5982 Node ID\u3001trigger address\uff09\u586b\u5145\u5b83\u3002</li> <li>\u5411\u5185\u5b58\u5b50\u7cfb\u7edf\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\uff0c\u5e76\u5c06\u8bf7\u6c42\u7684\u7269\u7406\u5730\u5740\u8bb0\u5f55\u5728 <code>Outstanding prefetch addresses</code> \u5b57\u6bb5\u4e2d\u3002</li> </ul> </li> <li> <p>\u9884\u53d6\u5e8f\u5217\u63a8\u8fdb (Advancement):</p> <ul> <li>\u5f53\u4e00\u4e2a\u9884\u53d6\u8bf7\u6c42\u7684\u6570\u636e\u8fd4\u56de\uff08prefetch fill\uff09\u65f6\uff0c\u786c\u4ef6\u5728 PFHR \u6587\u4ef6\u7684 <code>Outstanding prefetch addresses</code> \u5217\u4e0a\u6267\u884c CAM \u67e5\u627e\uff0c\u627e\u5230\u5339\u914d\u7684 PFHR \u6761\u76ee\u3002</li> <li>\u6839\u636e\u8be5\u6761\u76ee\u4e2d\u7684 Node ID\uff0c\u786c\u4ef6\u67e5\u8be2 DIG \u7684\u8fb9\u8868 (edge table) \u548c \u8fb9\u7d22\u5f15\u8868 (edge index table)\uff0c\u4ee5\u786e\u5b9a\u4ece\u5f53\u524d\u8282\u70b9\u51fa\u53d1\u7684\u6240\u6709 outgoing edges \u53ca\u5176 indirection type (w0 \u6216 w1)\u3002</li> <li>\u5229\u7528\u8fd4\u56de\u7684\u9884\u53d6\u6570\u636e\uff08\u4f5c\u4e3a\u7d22\u5f15\uff09\u548c DIG \u4e2d\u5b58\u50a8\u7684\u4e0b\u4e00\u8282\u70b9\u7684 base address \u4e0e data size\uff0c\u8ba1\u7b97\u51fa\u4e0b\u4e00\u7ea7\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\u5730\u5740\u3002</li> <li>\u5982\u679c\u4e0b\u4e00\u7ea7\u4e0d\u662f\u53f6\u5b50\u8282\u70b9\uff0c\u5219\u4e3a\u65b0\u7684\u9884\u53d6\u8bf7\u6c42\u5206\u914d\u53e6\u4e00\u4e2a PFHR \u6761\u76ee\uff08\u6216\u590d\u7528\uff09\uff0c\u5e76\u91cd\u590d\u6b64\u8fc7\u7a0b\u3002</li> </ul> </li> </ul> <p>\u57fa\u4e8e Trigger Address \u7684\u52a8\u6001\u4e22\u5f03\u673a\u5236</p> <ul> <li>\u6838\u5fc3\u95ee\u9898\uff1a\u5982\u679c\u5904\u7406\u5668\u6838\u5fc3\u7684\u6267\u884c\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u5b83\u53ef\u80fd\u4f1a\u5728\u9884\u53d6\u5e8f\u5217\u5b8c\u6210\u524d\u5c31\u8ffd\u4e0a\u5e76\u8bbf\u95ee\u4e86\u539f\u672c\u8981\u9884\u53d6\u7684\u6570\u636e\u3002\u6b64\u65f6\uff0c\u7ee7\u7eed\u5b8c\u6210\u8be5\u9884\u53d6\u5e8f\u5217\u53ea\u4f1a\u6d6a\u8d39\u5e26\u5bbd\u5e76\u53ef\u80fd\u5bfc\u81f4 cache pollution (\u7f13\u5b58\u6c61\u67d3)\u3002</li> <li>\u89e3\u51b3\u65b9\u6848\uff1aPFHR \u4e2d\u7684 Prefetch trigger address \u5b57\u6bb5\u4e3a\u6b64\u63d0\u4f9b\u4e86\u4f18\u96c5\u7684\u89e3\u51b3\u65b9\u6848\u3002<ul> <li>\u5728\u9884\u53d6\u5e8f\u5217\u63a8\u8fdb\u8fc7\u7a0b\u4e2d\uff0c\u786c\u4ef6\u4f1a\u6301\u7eed\u76d1\u63a7\u6838\u5fc3\u7684 demand load requests\u3002</li> <li>\u5982\u679c\u53d1\u73b0\u4e00\u4e2a demand \u8bf7\u6c42\u7684\u5730\u5740\u4e0e\u67d0\u4e2a \u6d3b\u8dc3 PFHR \u6761\u76ee \u4e2d\u7684 <code>Prefetch trigger address</code> \u76f8\u540c\uff08\u6216\u8db3\u591f\u63a5\u8fd1\uff09\uff0c\u5219\u5224\u5b9a\u8be5\u9884\u53d6\u5e8f\u5217\u5df2\u7ecf \u8fc7\u65f6 (stale)\u3002</li> <li>\u7cfb\u7edf\u4f1a\u7acb\u5373 drop (\u4e22\u5f03) \u6574\u4e2a\u4e0e\u8be5 PFHR \u5173\u8054\u7684\u9884\u53d6\u5e8f\u5217\uff0c\u91ca\u653e\u5176\u5360\u7528\u7684 PFHR \u6761\u76ee\u548c\u5176\u4ed6\u8d44\u6e90\u3002</li> <li>\u8fd9\u79cd\u673a\u5236\u786e\u4fdd\u4e86\u9884\u53d6\u5668\u603b\u662f\u5c1d\u8bd5 \u8dd1\u5728\u6838\u5fc3\u524d\u9762 (run ahead of the core)\uff0c\u4e13\u6ce8\u4e8e\u9690\u85cf\u672a\u6765\u5185\u5b58\u8bbf\u95ee\u7684\u5ef6\u8fdf\uff0c\u800c\u4e0d\u662f\u5f92\u52b3\u5730\u8ffd\u8d76\u5df2\u7ecf\u53d1\u751f\u7684\u8bbf\u95ee\u3002</li> </ul> </li> </ul> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u8bbe\u8ba1\u6743\u8861</p> <ul> <li>PFHR \u6587\u4ef6\u5927\u5c0f \u662f\u4e00\u4e2a\u5173\u952e\u7684\u8bbe\u8ba1\u53c2\u6570\uff0c\u76f4\u63a5\u5f71\u54cd\u6027\u80fd\u548c\u786c\u4ef6\u5f00\u9500\u3002<ul> <li>\u5982 Figure 12 \u6240\u793a\uff0c4 \u4e2a\u6761\u76ee \u7684\u57fa\u7ebf\u914d\u7f6e\u5b58\u5728\u4e25\u91cd\u7684 structural hazards (\u7ed3\u6784\u6027\u51b2\u7a81)\uff0c\u5f53\u6240\u6709\u6761\u76ee\u90fd\u88ab\u5360\u7528\u65f6\uff0c\u65b0\u7684\u9884\u53d6\u8bf7\u6c42\u4f1a\u88ab\u4e22\u5f03\u3002</li> <li>\u5b9e\u9a8c\u8868\u660e\uff0c\u5c06 PFHR \u6587\u4ef6\u5927\u5c0f\u589e\u52a0\u5230 16 \u4e2a\u6761\u76ee \u80fd\u5728\u6027\u80fd\u548c\u9762\u79ef\u4e4b\u95f4\u53d6\u5f97\u6700\u4f73\u5e73\u8861\u3002</li> <li>\u5bf9\u4e8e\u67d0\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982 Connected Components\uff09\uff0c\u8fc7\u5927\u7684 PFHR \u6587\u4ef6\uff08&gt;8\uff09\u53cd\u800c\u4f1a\u56e0\u5f15\u5165\u8fc7\u591a untimely prefetches (\u975e\u53ca\u65f6\u9884\u53d6) \u800c\u635f\u5bb3\u6027\u80fd\uff0c\u8fd9\u51f8\u663e\u4e86\u52a8\u6001\u4e22\u5f03\u673a\u5236\u7684\u91cd\u8981\u6027\u3002</li> </ul> </li> </ul> PFHR \u914d\u7f6e \u6027\u80fd\u5f71\u54cd \u539f\u56e0 4 entries \u57fa\u7ebf (\u6027\u80fd\u8f83\u5dee) \u7ed3\u6784\u6027\u51b2\u7a81\u4e25\u91cd\uff0c\u9884\u53d6\u8bf7\u6c42\u5e38\u88ab\u4e22\u5f03 8-16 entries \u6027\u80fd\u663e\u8457\u63d0\u5347 \u8db3\u591f\u7684\u5e76\u884c\u5ea6\u652f\u6301\u591a\u6761\u9884\u53d6\u5e8f\u5217\u540c\u65f6\u8fdb\u884c &gt;16 entries \u6536\u76ca\u9012\u51cf/\u53ef\u80fd\u4e0b\u964d \u975e\u53ca\u65f6\u9884\u53d6\u589e\u52a0\uff0c\u53ef\u80fd\u5bfc\u81f4\u7f13\u5b58\u6c61\u67d3 <p>\u5728 Prodigy \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u6865\u6881\u4f5c\u7528\uff1aPFHR \u6587\u4ef6\u662f\u8fde\u63a5 \u9759\u6001\u8f6f\u4ef6\u8bed\u4e49 (DIG) \u548c \u52a8\u6001\u786c\u4ef6\u6267\u884c \u7684\u6865\u6881\u3002\u5b83\u5c06 DIG \u4e2d\u63cf\u8ff0\u7684\u62bd\u8c61\u904d\u5386\u6a21\u5f0f\uff0c\u8f6c\u5316\u4e3a\u4e00\u7cfb\u5217\u5177\u4f53\u7684\u3001\u53ef\u8ddf\u8e2a\u7684\u786c\u4ef6\u72b6\u6001\u3002</li> <li>\u5b9e\u73b0\u975e\u963b\u585e\uff1a\u901a\u8fc7\u5141\u8bb8\u591a\u4e2a PFHR \u6761\u76ee\u5e76\u884c\u5b58\u5728\uff0cProdigy \u7684\u9884\u53d6\u5668\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u6765\u81ea\u4e0d\u540c\u5de5\u4f5c\u9879\uff08\u5982 work queue \u4e2d\u7684\u4e0d\u540c\u9876\u70b9\uff09\u7684\u591a\u4e2a\u9884\u53d6\u5e8f\u5217\uff0c\u6781\u5927\u5730\u63d0\u5347\u4e86\u541e\u5410\u91cf\u3002</li> <li>\u4fdd\u969c\u65f6\u6548\u6027\uff1a\u5176\u5185\u7f6e\u7684 trigger address \u76d1\u63a7\u548c\u4e22\u5f03\u903b\u8f91\uff0c\u662f Prodigy \u80fd\u591f\u5b9e\u73b0 adaptive prefetching algorithm (\u81ea\u9002\u5e94\u9884\u53d6\u7b97\u6cd5) \u7684\u786c\u4ef6\u57fa\u7840\uff0c\u6709\u6548\u89e3\u51b3\u4e86\u4f20\u7edf\u8f6f\u4ef6\u9884\u53d6\u65e0\u6cd5\u5e94\u5bf9\u52a8\u6001\u6267\u884c\u901f\u5ea6\u53d8\u5316\u7684\u96be\u9898\u3002</li> </ul>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#5","title":"5. \u81ea\u9002\u5e94\u9884\u53d6\u7b97\u6cd5","text":"<p>\u81ea\u9002\u5e94\u9884\u53d6\u7b97\u6cd5\u7684\u5b9e\u73b0\u539f\u7406</p> <p>Prodigy \u7684\u81ea\u9002\u5e94\u9884\u53d6\u7b97\u6cd5\u65e8\u5728\u89e3\u51b3\u4f20\u7edf\u9884\u53d6\u5668\u5728\u5904\u7406\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\u65f6\u9762\u4e34\u7684 \u9884\u53d6\u65f6\u6548\u6027 (prefetch timeliness) \u95ee\u9898\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\u52a8\u6001\u8c03\u6574\u9884\u53d6\u884c\u4e3a\uff0c\u4f7f\u5176\u65e2\u80fd\u6709\u6548\u9690\u85cf\u5185\u5b58\u5ef6\u8fdf\uff0c\u53c8\u4e0d\u4f1a\u56e0\u8fc7\u5ea6\u6216\u8fc7\u65f6\u7684\u9884\u53d6\u800c\u6c61\u67d3\u7f13\u5b58\u3002\u8be5\u7b97\u6cd5\u901a\u8fc7\u4e24\u4e2a\u5173\u952e\u673a\u5236\u5b9e\u73b0\uff1a\u57fa\u4e8e\u904d\u5386\u6df1\u5ea6\u7684\u9884\u53d6\u8ddd\u79bb\u8c03\u6574\u548c\u57fa\u4e8e\u6838\u5fc3\u6267\u884c\u8fdb\u5ea6\u7684\u9884\u53d6\u5e8f\u5217\u4e22\u5f03\u3002</p> <ul> <li>\u8f93\u5165: \u7b97\u6cd5\u7684\u4e3b\u8981\u8f93\u5165\u5305\u62ec\uff1a<ul> <li>Data Indirection Graph (DIG): \u7531\u8f6f\u4ef6\u7f16\u8bd1\u5668\u751f\u6210\u5e76\u4f20\u9012\u7ed9\u786c\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u6570\u636e\u7ed3\u6784\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u548c\u5b8c\u6574\u7684 \u904d\u5386\u8def\u5f84 (traversal path)\u3002</li> <li>Demand Load Requests: \u6765\u81ea\u5904\u7406\u5668\u6838\u5fc3\u7684 L1D \u7f13\u5b58\u52a0\u8f7d\u8bf7\u6c42\uff0c\u7528\u4e8e\u89e6\u53d1\u9884\u53d6\u5e8f\u5217\u548c\u76d1\u63a7\u6838\u5fc3\u8fdb\u5ea6\u3002</li> <li>Prefetch Fills: \u9884\u53d6\u6570\u636e\u8fd4\u56de\u7684\u4fe1\u53f7\uff0c\u7528\u4e8e\u9a71\u52a8\u9884\u53d6\u5e8f\u5217\u7684\u63a8\u8fdb\u3002</li> </ul> </li> <li>\u8f93\u51fa: \u7b97\u6cd5\u7684\u8f93\u51fa\u662f\u53d1\u9001\u5230\u5185\u5b58\u5b50\u7cfb\u7edf\u7684 \u975e\u7ed1\u5b9a\u9884\u53d6\u8bf7\u6c42 (non-binding prefetch requests)\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u65e8\u5728\u5c06\u672a\u6765\u6240\u9700\u7684\u6570\u636e\u63d0\u524d\u52a0\u8f7d\u5230\u7f13\u5b58\u4e2d\u3002</li> <li>\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528: \u8be5\u7b97\u6cd5\u662f Prodigy \u786c\u4ef6\u9884\u53d6\u5668\u7684\u51b3\u7b56\u6838\u5fc3\u3002\u5b83\u5229\u7528 DIG \u63d0\u4f9b\u7684\u9759\u6001\u8bed\u4e49\u4fe1\u606f\u548c\u8fd0\u884c\u65f6\u7684\u52a8\u6001\u53cd\u9988\uff0c\u5c06\u62bd\u8c61\u7684\u904d\u5386\u6a21\u5f0f\u8f6c\u5316\u4e3a\u5177\u4f53\u7684\u3001\u9ad8\u6548\u7684\u5185\u5b58\u8bbf\u95ee\u6d41\uff0c\u4ece\u800c\u663e\u8457\u964d\u4f4e DRAM stalls\u3002</li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5173\u952e\u673a\u5236</p> <p>\u8be5\u7b97\u6cd5\u5206\u4e3a\u4e24\u4e2a\u4e3b\u8981\u9636\u6bb5\uff1a\u9884\u53d6\u5e8f\u5217\u521d\u59cb\u5316 (prefetch sequence initialization) \u548c \u9884\u53d6\u5e8f\u5217\u63a8\u8fdb (prefetch sequence advance)\u3002\u81ea\u9002\u5e94\u6027\u4e3b\u8981\u4f53\u73b0\u5728\u521d\u59cb\u5316\u9636\u6bb5\u3002</p> <ul> <li>\u9884\u53d6\u5e8f\u5217\u521d\u59cb\u5316<ul> <li>\u5f53\u786c\u4ef6\u9884\u53d6\u5668\u901a\u8fc7\u4fa6\u542c (snooping) \u53d1\u73b0\u4e00\u4e2a\u5bf9 \u89e6\u53d1\u6570\u636e\u7ed3\u6784 (trigger data structure) \u7684\u9700\u6c42\u52a0\u8f7d\u8bf7\u6c42\u65f6\uff0c\u4f1a\u542f\u52a8\u521d\u59cb\u5316\u8fc7\u7a0b\u3002</li> <li>\u52a8\u6001\u9884\u53d6\u8ddd\u79bb\u8ba1\u7b97: \u7b97\u6cd5\u4f1a\u5206\u6790 DIG \u4e2d\u4ece\u89e6\u53d1\u8282\u70b9\u5230\u53f6\u8282\u70b9\u7684 \u5173\u952e\u8def\u5f84\u957f\u5ea6 (critical path length)\uff0c\u5373 \u904d\u5386\u6df1\u5ea6 (prefetch depth)\u3002<ul> <li>\u6839\u636e\u8bba\u6587\u63cf\u8ff0\uff0c\u91c7\u7528\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u542f\u53d1\u5f0f\u89c4\u5219\uff1a\u904d\u5386\u6df1\u5ea6\u8d8a\u9ad8\uff0c\u9884\u53d6\u8ddd\u79bb\u8d8a\u5c0f\u3002</li> <li>\u5177\u4f53\u7b56\u7565\u4e3a\uff1a\u5bf9\u4e8e\u6df1\u5ea6\u4e3a 1-3 \u7684\u8def\u5f84\uff0c\u4f7f\u7528\u8f83\u5927\u7684\u9884\u53d6\u8ddd\u79bb\uff1b\u5bf9\u4e8e\u6df1\u5ea6\u8fbe\u5230 4 \u6216\u4ee5\u4e0a\u7684\u590d\u6742\u8def\u5f84\uff08\u5982 BFS \u4e2d\u5e38\u89c1\u7684\u56db\u5c42\u6570\u636e\u7ed3\u6784\u8bbf\u95ee\uff09\uff0c\u5219\u5c06\u9884\u53d6\u8ddd\u79bb\u8bbe\u4e3a 1\u3002\u8fd9\u662f\u56e0\u4e3a\u957f\u8def\u5f84\u672c\u8eab\u5c31\u9700\u8981\u8f83\u957f\u65f6\u95f4\u6765\u904d\u5386\uff0c\u8fc7\u5927\u7684\u9884\u53d6\u8ddd\u79bb\u4f1a\u5bfc\u81f4\u6570\u636e\u8fc7\u65e9\u8fdb\u5165\u7f13\u5b58\u5e76\u53ef\u80fd\u88ab\u66ff\u6362\u51fa\u53bb\u3002</li> </ul> </li> <li>\u591a\u5e8f\u5217\u521d\u59cb\u5316: \u4e3a\u4e86\u5e94\u5bf9\u6838\u5fc3\u6267\u884c\u901f\u5ea6\u7684\u52a8\u6001\u53d8\u5316\uff0c\u7b97\u6cd5\u5e76\u975e\u53ea\u521d\u59cb\u5316\u4e00\u4e2a\u9884\u53d6\u5e8f\u5217\uff0c\u800c\u662f\u6839\u636e\u9884\u53d6\u8ddd\u79bb\u53c2\u6570 <code>j</code> \u548c <code>k</code> \u521d\u59cb\u5316 \u591a\u4e2a\u8fde\u7eed\u7684\u9884\u53d6\u5e8f\u5217\uff08\u4f8b\u5982\uff0c\u540c\u65f6\u4e3a\u5de5\u4f5c\u961f\u5217\u4e2d\u7684\u4e0b\u51e0\u4e2a\u9876\u70b9\u542f\u52a8\u9884\u53d6\uff09\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 11. Prodigy operation: (a) prefetch sequence initialization, and (b) prefetch sequence advance.</p> <pre><code>*\u56fe 11 \u5c55\u793a\u4e86\u521d\u59cb\u5316\u8fc7\u7a0b\uff1a\u5f53\u68c0\u6d4b\u5230\u5bf9 `workQueue` (\u5730\u5740 `0x100`) \u7684\u9700\u6c42\u8bbf\u95ee\u65f6\uff0c\u6839\u636e\u9884\u53d6\u8ddd\u79bb 2\uff0c\u8ba1\u7b97\u51fa\u8981\u9884\u53d6\u7684\u5730\u5740 `0x108` \u5e76\u53d1\u51fa\u8bf7\u6c42\u3002*\n</code></pre> <ul> <li>\u9009\u62e9\u6027\u4e22\u5f03\u9884\u53d6\u5e8f\u5217<ul> <li>\u4e3a\u4e86\u786e\u4fdd\u9884\u53d6\u59cb\u7ec8 \u9886\u5148\u4e8e\u6838\u5fc3 (run ahead of the core)\uff0c\u7b97\u6cd5\u5f15\u5165\u4e86\u53cd\u9988\u673a\u5236\u3002</li> <li>\u6bcf\u4e2a\u6fc0\u6d3b\u7684\u9884\u53d6\u5e8f\u5217\u90fd\u4f1a\u5728\u5176\u5bf9\u5e94\u7684 PreFetch status Handling Register (PFHR) \u6761\u76ee\u4e2d\u8bb0\u5f55\u5176 \u9884\u53d6\u89e6\u53d1\u5730\u5740 (prefetch trigger address)\u3002</li> <li>\u5728\u540e\u7eed\u6267\u884c\u4e2d\uff0c\u5982\u679c\u6838\u5fc3\u53d1\u51fa\u4e86\u4e00\u4e2a\u9700\u6c42\u52a0\u8f7d\u8bf7\u6c42\uff0c\u5176\u5730\u5740\u6070\u597d\u5339\u914d\u67d0\u4e2a PFHR \u4e2d\u8bb0\u5f55\u7684\u89e6\u53d1\u5730\u5740\uff0c\u8fd9\u610f\u5473\u7740 \u6838\u5fc3\u5df2\u7ecf\u8ffd\u4e0a\u4e86\u8be5\u9884\u53d6\u5e8f\u5217\u7684\u8d77\u70b9\u3002</li> <li>\u6b64\u65f6\uff0c\u7b97\u6cd5\u4f1a \u7acb\u5373\u4e22\u5f03 (drop) \u6574\u4e2a\u5bf9\u5e94\u7684\u9884\u53d6\u5e8f\u5217\u3002\u56e0\u4e3a\u7ee7\u7eed\u5b8c\u6210\u8fd9\u4e2a\u5e8f\u5217\u53ea\u80fd\u90e8\u5206\u9690\u85cf\u5ef6\u8fdf\uff0c\u6548\u7387\u4f4e\u4e0b\u3002</li> <li>\u901a\u8fc7\u4e22\u5f03\u201c\u8fc7\u65f6\u201d\u7684\u5e8f\u5217\uff0c\u53ef\u4ee5\u91ca\u653e\u5b9d\u8d35\u7684 PFHR \u8d44\u6e90\uff0c\u5e76\u5c06\u5e26\u5bbd\u7559\u7ed9\u4e3a\u66f4\u8fdc\u672a\u6765\u6570\u636e\u53d1\u8d77\u7684\u65b0\u9884\u53d6\u5e8f\u5217\uff0c\u4ece\u800c\u7ef4\u6301\u9884\u53d6\u7684\u524d\u77bb\u6027\u548c\u6709\u6548\u6027\u3002</li> </ul> </li> </ul> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u786c\u4ef6\u652f\u6301</p> <ul> <li>\u5173\u952e\u53c2\u6570:<ul> <li>Prefetch Depth: \u4ece DIG \u4e2d\u52a8\u6001\u89e3\u6790\u5f97\u51fa\uff0c\u662f\u51b3\u5b9a\u9884\u53d6\u8ddd\u79bb\u7684\u6838\u5fc3\u4f9d\u636e\u3002</li> <li>Prefetch Distance (<code>j</code>, <code>k</code>): \u7531\u89e6\u53d1\u8fb9 (trigger edge) \u4f20\u8fbe\uff0c\u51b3\u5b9a\u4e86\u521d\u59cb\u5316\u65f6\u7684\u524d\u77bb\u6b65\u957f\u548c\u5e76\u53d1\u5e8f\u5217\u6570\u91cf\u3002</li> <li>PFHR File Size: \u8fd9\u662f\u4e00\u4e2a\u91cd\u8981\u7684\u786c\u4ef6\u8d44\u6e90\u914d\u7f6e\u3002\u5982\u56fe 12 \u6240\u793a\uff0cPFHR \u6570\u91cf\u76f4\u63a5\u5f71\u54cd\u6027\u80fd\u3002\u592a\u5c11\u4f1a\u5bfc\u81f4\u7ed3\u6784\u5192\u9669\uff0c\u65e0\u6cd5\u8ddf\u8e2a\u8db3\u591f\u7684\u5e76\u53d1\u9884\u53d6\u6d41\uff1b\u592a\u591a\u5219\u53ef\u80fd\u56e0\u9884\u53d6\u4e0d\u53ca\u65f6\u800c\u6c61\u67d3\u7f13\u5b58\u3002\u8bba\u6587\u6700\u7ec8\u9009\u62e9\u4e86 16 \u4e2a\u6761\u76ee\u4f5c\u4e3a\u5e73\u8861\u70b9\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 12. Design space exploration on the PFHR file size. Performance of each configuration is normalized to 4 entries.</p> <ul> <li>\u786c\u4ef6\u7ed3\u6784\u652f\u6301:<ul> <li>DIG Tables (Node Table, Edge Table, Edge Index Table): \u5b58\u50a8\u7a0b\u5e8f\u8bed\u4e49\uff0c\u4e3a\u7b97\u6cd5\u63d0\u4f9b\u904d\u5386\u89c4\u5219\u3002</li> <li>PFHR File: \u5982\u56fe 9(d) \u6240\u793a\uff0c\u8fd9\u662f\u5b9e\u73b0\u975e\u963b\u585e\u3001\u591a\u5e8f\u5217\u8ddf\u8e2a\u548c\u9009\u62e9\u6027\u4e22\u5f03\u7684\u5173\u952e\u786c\u4ef6\u3002\u6bcf\u4e2a PFHR \u6761\u76ee\u5305\u542b\u72b6\u6001\u3001\u8282\u70b9ID\u3001\u89e6\u53d1\u5730\u5740\u3001\u672a\u5b8c\u6210\u7684\u9884\u53d6\u5730\u5740\u7b49\u4fe1\u606f\uff0c\u529f\u80fd\u4e0a\u7c7b\u4f3c\u4e8e MSHR\uff0c\u4f46\u4e13\u4e3a\u957f\u9884\u53d6\u5e8f\u5217\u8bbe\u8ba1\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 9. Memory structures used in Prodigy\u2014(a) node table, (b) edge index table, and (c) edge table for storing the DIG representation, (d) prefetch status handling register (PFHR) file tracking progress for live prefetch sequences and issuing non-blocking prefetches. Figure 10. Prefetching algorithm initiates prefetch sequences between prefetch bounds j and k and advances a prefetch sequence using software-defined indirection types. The superscripts denote a demand (D) or a prefetch (P) access.</p> <p>\u6027\u80fd\u5f71\u54cd\u4e0e\u6548\u679c</p> <p>\u8be5\u81ea\u9002\u5e94\u7b97\u6cd5\u76f4\u63a5\u4fc3\u6210\u4e86 Prodigy \u7684\u9ad8\u6548\u7387\u3002\u901a\u8fc7\u52a8\u6001\u8c03\u6574\u548c\u9009\u62e9\u6027\u4e22\u5f03\uff0c\u5b83\u5728\u4fdd\u6301\u6781\u4f4e\u786c\u4ef6\u5f00\u9500\uff08\u4ec5 0.8KB\uff09\u7684\u540c\u65f6\uff0c\u5b9e\u73b0\u4e86 62.7% \u7684\u5e73\u5747\u9884\u53d6\u51c6\u786e\u7387\uff0c\u5e76\u5c06 85.1% \u7684\u53ef\u9884\u53d6 LLC miss \u8f6c\u5316\u4e3a\u7f13\u5b58\u547d\u4e2d\uff0c\u6700\u7ec8\u5e26\u6765\u4e86 2.6\u500d \u7684\u5e73\u5747\u6027\u80fd\u63d0\u5347\u3002</p>"},{"location":"notes_repo/prodigy-improving-the-memory-latency-of-data-indirect-irregular-workloads-using-hardware-software-co-design/paper_notes/#4","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u6a21\u62df\u5e73\u53f0: \u4f7f\u7528 Sniper \u591a\u6838\u6a21\u62df\u5668\uff0c\u57fa\u4e8e Pin \u5de5\u5177\u6784\u5efa\uff0c\u9488\u5bf9 x86 \u67b6\u6784\u3002</li> <li>\u7cfb\u7edf\u914d\u7f6e: \u6a21\u62df\u4e00\u4e2a 8-core \u7684\u5171\u4eab\u5185\u5b58\u7cfb\u7edf\uff0c\u8be6\u7ec6\u7684\u7f13\u5b58\u5c42\u6b21\u3001\u9891\u7387\u7b49\u53c2\u6570\u89c1\u4e0b\u8868\u3002</li> <li>\u5de5\u4f5c\u8d1f\u8f7d:</li> <li>\u56fe\u7b97\u6cd5: \u6765\u81ea GAP benchmark suite \u7684 5 \u4e2a\u7b97\u6cd5 (bc, bfs, cc, pr, sssp)\u3002</li> <li>\u7a00\u758f\u7ebf\u6027\u4ee3\u6570: \u6765\u81ea HPCG benchmark suite \u7684 2 \u4e2a\u7b97\u6cd5 (spmv, symgs)\u3002</li> <li>\u8ba1\u7b97\u6d41\u4f53\u52a8\u529b\u5b66: \u6765\u81ea NAS parallel benchmark suite \u7684 2 \u4e2a\u7b97\u6cd5 (cg, is)\u3002</li> <li>\u6570\u636e\u96c6: \u56fe\u7b97\u6cd5\u4f7f\u7528\u6765\u81ea SNAP \u548c UF sparse matrix collection \u7684 5 \u4e2a\u771f\u5b9e\u4e16\u754c\u5927\u89c4\u6a21\u56fe\u6570\u636e\u96c6\u3002\u975e\u56fe\u7b97\u6cd5\u4f7f\u7528\u5404\u81ea\u57fa\u51c6\u5957\u4ef6\u63d0\u4f9b\u7684\u6807\u51c6\u8f93\u5165\u3002</li> <li>\u5bf9\u6bd4\u57fa\u7ebf:</li> <li>\u65e0\u9884\u53d6\u57fa\u7ebf (no-prefetching baseline)\u3002</li> <li>\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668: GHB-based global/delta correlation (G/DC)\u3002</li> <li>SOTA \u9884\u53d6\u5668: IMP [99], Ainsworth and Jones\u2019 prefetcher [5], [6], DROPLET [15]\u3002</li> <li>\u8f6f\u4ef6\u9884\u53d6: Ainsworth and Jones\u2019 software\u9884\u53d6\u65b9\u6cd5 [8]\u3002</li> <li>\u8bc4\u4f30\u6307\u6807: \u4e3b\u8981\u5173\u6ce8 \u6027\u80fd (Speedup)\u3001\u80fd\u8017 (Energy Consumption) \u548c \u786c\u4ef6\u5f00\u9500 (Hardware Overhead)\u3002</li> </ul> <p></p> <p>TABLE I BASELINE SYSTEM CONFIGURATION.</p> <p>\u7ed3\u679c\u6570\u636e\u5206\u6790</p> <ul> <li>\u4e0e\u65e0\u9884\u53d6\u57fa\u7ebf\u5bf9\u6bd4:</li> <li>Prodigy \u5728\u5168\u90e8 29 \u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5b9e\u73b0\u4e86 \u5e73\u5747 2.6\u00d7 \u7684\u6027\u80fd\u52a0\u901f\u3002</li> <li>DRAM stalls \u5e73\u5747\u51cf\u5c11\u4e86 80.3%\uff0c\u8fd9\u662f\u6027\u80fd\u63d0\u5347\u7684\u4e3b\u8981\u6765\u6e90\u3002</li> <li>\u80fd\u8017\u65b9\u9762\uff0c\u5b9e\u73b0\u4e86 \u5e73\u5747 1.6\u00d7 \u7684\u8282\u80fd\uff0c\u4e3b\u8981\u5f97\u76ca\u4e8e\u6267\u884c\u65f6\u95f4\u7f29\u77ed\u5e26\u6765\u7684\u9759\u6001\u80fd\u8017\u964d\u4f4e\u3002</li> <li>\u5bf9\u4e8e PageRank \u7b97\u6cd5\u5728 livejournal \u6570\u636e\u96c6\u4e0a\u7684\u5177\u4f53\u8868\u73b0\uff0cProdigy \u5c06 DRAM stalls \u51cf\u5c11\u4e86 8.2\u00d7\uff0c\u5e76\u5e26\u6765\u4e86 2.9\u00d7 \u7684\u7aef\u5230\u7aef\u52a0\u901f\uff0c\u8fdc\u8d85\u4f20\u7edf\u9884\u53d6\u5668\u3002</li> </ul> <p></p> <p>Figure 2. Reduction in ((a)) memory stalls and ((b)) speedup of different approaches normalized to a non-prefetching baseline for the PageRank algorithm on the livejournal data set.</p> <p></p> <p>Figure 14. CPI stack comparison and speedup achieved by Prodigy against a non-prefetching baseline. Left bar: CPI stack of baseline; right bar: CPI stack of Prodigy normalized to baseline. Lower is better for CPI, higher for speedup.</p> <p></p> <p>Figure 19. Normalized energy comparison of a non-prefetching baseline (first bar) and Prodigy (second bar). Lower is better.</p> <ul> <li>\u4e0e SOTA \u786c\u4ef6\u9884\u53d6\u5668\u5bf9\u6bd4:</li> <li>Prodigy \u76f8\u5bf9\u4e8e\u5176\u4ed6\u5148\u8fdb\u9884\u53d6\u5668\u8868\u73b0\u51fa\u663e\u8457\u4f18\u52bf\uff1a     | \u5bf9\u6bd4\u5bf9\u8c61 | \u5e73\u5747\u52a0\u901f\u6bd4 (vs. \u65e0\u9884\u53d6) | Prodigy \u76f8\u5bf9\u4f18\u52bf |     | :--- | :---: | :---: |     | Ainsworth &amp; Jones [6] | ~1.7\u00d7 | 1.5\u00d7 |     | DROPLET [15] | ~1.6\u00d7 | 1.6\u00d7 |     | IMP [99] | ~1.1\u00d7 | 2.3\u00d7 |</li> <li>\u6027\u80fd\u4f18\u52bf\u7684\u6838\u5fc3\u539f\u56e0\u5728\u4e8e \u66f4\u9ad8\u7684\u9884\u53d6\u51c6\u786e\u7387 (62.7% vs. 44.6% for [6]) \u548c\u5bf9 ranged indirection \u6a21\u5f0f\u7684\u5b8c\u6574\u652f\u6301\uff0c\u800c\u8bb8\u591a\u5148\u524d\u5de5\u4f5c\u4ec5\u652f\u6301 single-valued indirection\u3002</li> </ul> <p></p> <p>Figure 17. Performance comparison of a non-prefetching baseline, Ainsworth and Jones\u2019 prefetcher [6], DROPLET [15], IMP [99], and Prodigy (this work). Higher is better. Ainsworth &amp; Jones and DROPLET are graph-specific approaches, and hence are omitted from non-graph workloads.</p> <p></p> <p>TABLE III AVERAGE SPEEDUP COMPARISON OVER NO PREFETCHING.\u2217</p> <ul> <li>\u9884\u53d6\u6709\u6548\u6027\u5206\u6790:</li> <li>\u9884\u53d6\u6f5c\u529b: \u5206\u6790\u8868\u660e\uff0c96.4% \u7684 LLC misses \u7406\u8bba\u4e0a\u662f\u53ef\u88ab Prodigy \u9884\u53d6\u7684\u3002</li> <li>\u5b9e\u9645\u6548\u679c: Prodigy \u6210\u529f\u5c06 85.1% \u7684\u53ef\u9884\u53d6 LLC misses \u8f6c\u5316\u4e3a cache hits\u3002</li> <li>\u9884\u53d6\u547d\u4e2d\u4f4d\u7f6e: \u5927\u90e8\u5206\u88ab\u547d\u4e2d\u7684\u9884\u53d6\u6570\u636e\u4f4d\u4e8e L1D cache\uff0c\u8fd9\u5e26\u6765\u4e86\u6700\u4f4e\u7684\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> </ul> <p></p> <p>Figure 13. Classification of LLC miss addresses into potentially prefetchable and non-prefetchable addresses.</p> <p></p> <p>Figure 16. Percentage of prefetchable main memory accesses (as shown in Fig. 13) converted to cache hits. Blue is better.</p> <p></p> <p>Figure 15. Location of prefetched data in the cache hierarchy when it is demanded. Blue is better.</p> <p>\u6d88\u878d\u5b9e\u9a8c\u4e0e\u8bbe\u8ba1\u7a7a\u95f4\u63a2\u7d22</p> <ul> <li>PFHR \u6587\u4ef6\u5927\u5c0f\u7684\u5f71\u54cd:</li> <li>\u5bf9 PFHR (PreFetch status Handling Register) \u6587\u4ef6\u5927\u5c0f\u8fdb\u884c\u4e86\u63a2\u7d22\uff0c\u4ee5\u5e73\u8861\u6027\u80fd\u548c\u786c\u4ef6\u6210\u672c\u3002</li> <li>\u7ed3\u679c\u663e\u793a\uff0c\u5c06 PFHR \u6570\u91cf\u4ece 4 \u589e\u52a0\u5230 16 \u53ef\u5e26\u6765\u6700\u9ad8 30% \u7684\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u6700\u7ec8\u9009\u62e9 16 \u4e2a PFHR \u4f5c\u4e3a\u8bbe\u8ba1\u70b9\uff0c\u5728\u6027\u80fd\u548c\u9762\u79ef\u4e4b\u95f4\u53d6\u5f97\u4e86\u826f\u597d\u6298\u8877\u3002\u4f46\u5bf9\u67d0\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982 cc\uff09\uff0c\u8fc7\u5927\u7684 PFHR \u6587\u4ef6\u53cd\u800c\u4f1a\u56e0\u7f13\u5b58\u6c61\u67d3\u800c\u635f\u5bb3\u6027\u80fd\u3002</li> </ul> <p></p> <p>Figure 12. Design space exploration on the PFHR file size. Performance of each configuration is normalized to 4 entries.</p> <ul> <li>Ranged Indirection \u7684\u91cd\u8981\u6027:</li> <li>\u901a\u8fc7\u5206\u6790\u53d1\u73b0\uff0cranged indirection \u6a21\u5f0f\u8d1f\u8d23\u4e86\u56fe\u7b97\u6cd5\u4e2d 55.3% \u7684\u6570\u636e\u9884\u53d6\u3002</li> <li> <p>\u8fd9\u4e00\u53d1\u73b0\u89e3\u91ca\u4e86\u4e3a\u4f55\u4ec5\u652f\u6301 single-valued indirection \u7684\u9884\u53d6\u5668\uff08\u5982 IMP\uff09\u6027\u80fd\u53d7\u9650\uff0c\u56e0\u4e3a\u5b83\u4eec\u9519\u8fc7\u4e86\u5927\u90e8\u5206\u9884\u53d6\u673a\u4f1a\u3002</p> </li> <li> <p>\u4e0e\u56fe\u91cd\u6392\u5e8f\u6280\u672f\u7684\u7ed3\u5408:</p> </li> <li>\u5373\u4f7f\u5728\u5e94\u7528\u4e86 HubSort \u7b49\u56fe\u91cd\u6392\u5e8f\u6280\u672f\u4ee5\u589e\u52a0\u5c40\u90e8\u6027\u540e\uff0cProdigy \u4f9d\u7136\u80fd\u5e26\u6765 \u5e73\u5747 2.3\u00d7 \u7684\u989d\u5916\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u8fd9\u8bc1\u660e\u4e86\u5373\u4f7f\u7ecf\u8fc7\u8f6f\u4ef6\u4f18\u5316\uff0c\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u4f9d\u7136\u662f\u74f6\u9888\uff0c\u786c\u4ef6\u8f85\u52a9\u9884\u53d6\u4ecd\u7136\u81f3\u5173\u91cd\u8981\u3002</li> </ul> <p></p> <p>Figure 18. Speedup of Prodigy compared to a non-prefetching baseline on reordered graph data sets using HubSort [14].</p> <ul> <li>\u786c\u4ef6\u5f00\u9500:</li> <li>Prodigy \u7684\u603b\u786c\u4ef6\u5b58\u50a8\u5f00\u9500\u4ec5\u4e3a 0.8KB\uff0c\u5176\u4e2d DIG \u8868\u5360 0.53KB\uff0cPFHR \u6587\u4ef6\u5360 0.26KB\u3002</li> <li>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5176\u4ed6 SOTA \u65b9\u6848\u7684\u786c\u4ef6\u5f00\u9500\u8981\u5927\u5f97\u591a\uff08\u4f8b\u5982 [5] \u9700\u8981 32KB\uff09\uff0cProdigy \u7684\u5f00\u9500\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\uff08\u7ea6 CPU \u82af\u7247\u603b\u9762\u79ef\u7684 0.004%\uff09\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/ELI5_notes/","title":"Profile-Guided Temporal Prefetching \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/profile-guided-temporal-prefetching/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684 \u786c\u4ef6 temporal prefetcher\uff08\u5982 Triangel\uff09\u5728\u7ba1\u7406\u5b9d\u8d35\u7684 on-chip metadata table \u65f6\uff0c\u5c31\u50cf\u4e00\u4e2a\u8fd1\u89c6\u7684\u7ba1\u5bb6\u3002\u5b83\u53ea\u80fd\u6839\u636e\u6700\u8fd1\u51e0\u6b21\u7684\u8bbf\u95ee\u60c5\u51b5\uff08short-term data\uff09\u6765\u5224\u65ad\u672a\u6765\u8981\u4e0d\u8981\u5b58\u67d0\u4e2a\u5730\u5740\u7684\u5173\u8054\u4fe1\u606f\u3002</li> <li>\u8fd9\u4e2a\u505a\u6cd5\u5728\u9762\u5bf9\u9ad8\u5ea6\u52a8\u6001\u4e14\u4e0d\u89c4\u5219\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u65f6\u975e\u5e38\u96be\u53d7\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u5185\u5b58\u6307\u4ee4\u53ef\u80fd\u4e00\u4f1a\u513f\u4ea7\u751f\u6709\u7528\u7684\u9884\u53d6\uff08\u84dd\u8272\u70b9\uff09\uff0c\u4e00\u4f1a\u513f\u53c8\u4ea7\u751f\u6ca1\u7528\u7684\uff08\u7ea2\u8272\u70b9\uff09\u3002\u786c\u4ef6\u7ba1\u5bb6\u770b\u5230\u8fde\u7eed\u51e0\u4e2a\u6ca1\u7528\u7684\uff0c\u5c31\u6b66\u65ad\u5730\u8ba4\u4e3a\u201c\u8fd9\u5bb6\u4f19\u4ee5\u540e\u90fd\u6ca1\u7528\u4e86\u201d\uff0c\u76f4\u63a5\u7981\u6b62\u4e3a\u5b83\u5b58\u50a8\u4efb\u4f55\u5143\u6570\u636e\uff08\u5982 Figure 1 \u6240\u793a\uff09\u3002</li> <li>\u7ed3\u679c\u5c31\u662f\uff0c\u5b83\u8981\u4e48\u628a\u5b9d\u8d35\u7684\u7247\u4e0a\u5b58\u50a8\u7a7a\u95f4\u6d6a\u8d39\u5728\u5927\u91cf\u65e0\u7528\u7684\u5143\u6570\u636e\u4e0a\uff0c\u8981\u4e48\u8fc7\u4e8e\u4fdd\u5b88\uff0c\u628a\u90a3\u4e9b\u5076\u5c14\u80fd\u4ea7\u751f\u5de8\u5927\u6536\u76ca\u7684\u201c\u6f5c\u529b\u80a1\u201d\u5143\u6570\u636e\u4e5f\u4e00\u5e76\u8fc7\u6ee4\u6389\u4e86\uff0c\u5bfc\u81f4 prefetching coverage\uff08\u8986\u76d6\u7387\uff09\u4e25\u91cd\u4e0d\u8db3\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4e00\u4e0b\uff0c\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08\u786c\u4ef6\u9884\u53d6\u5668\uff09\uff0c\u8d1f\u8d23\u51b3\u5b9a\u54ea\u4e9b\u4e66\uff08\u5143\u6570\u636e\uff09\u5e94\u8be5\u653e\u5728\u624b\u8fb9\u7684\u5feb\u901f\u4e66\u67b6\uff08on-chip metadata table\uff09\u4e0a\u3002\u4f60\u7684\u89c4\u5219\u662f\uff1a\u5982\u679c\u4e00\u672c\u4e66\u6700\u8fd1\u88ab\u501f\u4e86\u4f46\u6ca1\u4eba\u770b\uff08\u6ca1\u547d\u4e2d\uff09\uff0c\u5c31\u628a\u5b83\u6254\u56de\u4ed3\u5e93\u3002</li> <li>\u73b0\u5728\u6709\u4e2a\u6559\u6388\uff08\u7a0b\u5e8f\uff09\uff0c\u4ed6\u7814\u7a76\u7684\u8bfe\u9898\u5f88\u6742\u3002\u6709\u65f6\u5019\u4ed6\u501f\u7684\u4e66A\u7acb\u523b\u5c31\u770b\u4e86\uff08\u6709\u7528\uff09\uff0c\u6709\u65f6\u5019\u4ed6\u53c8\u501f\u4e86\u4e66B\u4f46\u653e\u4e86\u51e0\u4e2a\u6708\u624d\u770b\uff08\u6682\u65f6\u6ca1\u7528\uff09\u3002\u6309\u7167\u4f60\u7684\u89c4\u5219\uff0c\u4e66B\u5f88\u5feb\u5c31\u88ab\u6254\u56de\u4ed3\u5e93\u4e86\u3002\u7b49\u4ed6\u51e0\u4e2a\u6708\u540e\u771f\u7684\u9700\u8981\u4e66B\u65f6\uff0c\u4f60\u53c8\u5f97\u82b1\u5927\u529b\u6c14\u4ece\u4ed3\u5e93\u8c03\u56de\u6765\uff0c\u803d\u8bef\u4e8b\u3002</li> <li>Prophet\u7684\u505a\u6cd5\u662f\uff0c\u5728\u5b66\u671f\u5f00\u59cb\u524d\uff0c\u5148\u8ba9\u8fd9\u4f4d\u6559\u6388\u505a\u4e00\u6b21\u5168\u9762\u7684\u5f00\u5377\u8003\u8bd5\uff08Profiling\uff09\uff0c\u8bb0\u5f55\u4e0b\u4ed6\u8fc7\u53bb\u4e00\u6574\u5e74\u91cc\u6bcf\u672c\u4e66\u6700\u7ec8\u6709\u6ca1\u6709\u88ab\u7528\u4e0a\u3001\u7528\u4e86\u591a\u5c11\u6b21\u3002\u7136\u540e\uff0c\u4f60\u6839\u636e\u8fd9\u4efd\u957f\u671f\u3001\u5168\u5c40\u7684\u7b54\u5377\uff08profile-guided hints\uff09\uff0c\u7ed9\u6bcf\u672c\u4e66\u8d34\u4e0a\u4e00\u4e2a\u6807\u7b7e\uff1a\u201c\u9ad8\u9891\u6838\u5fc3\u201d\u3001\u201c\u5076\u5c14\u6709\u7528\u201d\u3001\u201c\u57fa\u672c\u4e0d\u7528\u201d\u3002\u8fd9\u6837\uff0c\u4f60\u5728\u7ba1\u7406\u4e66\u67b6\u65f6\u5c31\u6709\u4e86\u8fdc\u89c1\uff0c\u77e5\u9053\u5373\u4f7f\u67d0\u672c\u4e66\u6682\u65f6\u6ca1\u52a8\uff0c\u4e5f\u503c\u5f97\u7559\u5728\u624b\u8fb9\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u5e76\u6ca1\u6709\u629b\u5f03\u73b0\u6709\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 Triangel\uff09\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728\u8f6f\u4ef6\u548c\u786c\u4ef6\u4e4b\u95f4\u67b6\u8d77\u4e86\u4e00\u5ea7\u6865\u3002\u4ed6\u4eec\u901a\u8fc7\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 profile-guided \u6d41\u7a0b\uff0c\u4e3a\u7a0b\u5e8f\u6ce8\u5165hints\uff08\u63d0\u793a\uff09\uff0c\u6765\u6307\u5bfc\u786c\u4ef6\u5982\u4f55\u66f4\u806a\u660e\u5730\u7ba1\u7406\u5143\u6570\u636e\u8868\u3002</li> <li>\u5177\u4f53\u6765\u8bf4\uff0c\u8fd9\u4e2a\u6d41\u7a0b\u626d\u8f6c\u4e86\u4e09\u4e2a\u5173\u952e\u51b3\u7b56\u70b9\uff1a</li> <li>\u63d2\u5165\u7b56\u7565 (Insertion Policy): \u4e0d\u518d\u4f9d\u8d56\u786c\u4ef6\u77ed\u89c6\u7684 <code>PatternConf</code>\uff0c\u800c\u662f\u6839\u636e Profiling \u9636\u6bb5\u7edf\u8ba1\u51fa\u7684\u6bcf\u4e2a\u5185\u5b58\u6307\u4ee4\uff08PC\uff09\u7684\u957f\u671f\u9884\u53d6\u51c6\u786e\u7387\u3002\u53ea\u6709\u90a3\u4e9b\u51c6\u786e\u7387\u6781\u4f4e\uff08\u51e0\u4e4e\u4ece\u4e0d\u4ea7\u751f\u6709\u7528\u9884\u53d6\uff09\u7684\u6307\u4ee4\uff0c\u624d\u4f1a\u88ab\u5b8c\u5168\u7981\u6b62\u63d2\u5165\u5143\u6570\u636e\u3002\u8fd9\u907f\u514d\u4e86\u8bef\u4f24\u201c\u6f5c\u529b\u80a1\u201d\u3002</li> <li>\u66ff\u6362\u7b56\u7565 (Replacement Policy): \u5728\u5143\u6570\u636e\u8868\u6ee1\u4e86\u9700\u8981\u66ff\u6362\u65f6\uff0c\u786c\u4ef6\u4e0d\u518d\u53ea\u770b\u201c\u8c01\u6700\u8fd1\u6ca1\u7528\u8fc7\u201d\uff08LRU-like\uff09\uff0c\u800c\u662f\u7ed3\u5408 Profiling \u5f97\u5230\u7684\u9884\u53d6\u51c6\u786e\u7387\uff0c\u7ed9\u6bcf\u4e2a\u5143\u6570\u636e\u9879\u5206\u914d\u4e00\u4e2a\u4f18\u5148\u7ea7\u3002\u51c6\u786e\u7387\u4f4e\u7684\u9879\uff0c\u5373\u4f7f\u521a\u88ab\u8bbf\u95ee\u8fc7\uff0c\u4e5f\u4f1a\u88ab\u4f18\u5148\u8e22\u51fa\u53bb\uff0c\u4ece\u800c\u4fdd\u8bc1\u8868\u91cc\u7559\u4e0b\u7684\u90fd\u662f\u201c\u9ad8\u4ef7\u503c\u201d\u4fe1\u606f\u3002</li> <li>\u52a8\u6001\u5b66\u4e60 (Learning): \u6700\u5de7\u5999\u7684\u662f\uff0cProphet\u4e0d\u662f\u4e00\u9524\u5b50\u4e70\u5356\u3002\u5b83\u80fd\u901a\u8fc7 <code>Step 3: Learning</code>\uff0c\u5c06\u4e0d\u540c\u8f93\u5165\u4e0b\u7684 Profiling \u6570\u636e\u8fdb\u884c\u878d\u5408\uff08\u5982 Equation 4, 5\uff09\uff0c\u8ba9\u4e00\u4e2a\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u80fd\u591f\u81ea\u9002\u5e94\u5730\u5e94\u5bf9\u591a\u79cd\u4e0d\u540c\u7684\u8fd0\u884c\u573a\u666f\uff0c\u89e3\u51b3\u4e86\u4f20\u7edf PGO \u5bf9\u8f93\u5165\u654f\u611f\u7684\u81f4\u547d\u5f31\u70b9\u3002</li> <li>\u6574\u4e2a\u65b9\u6848\u6781\u5176\u8f7b\u91cf\uff0c\u56e0\u4e3a\u5b83\u53ea\u4f9d\u8d56 PMU counters \u800c\u975e\u5e9e\u5927\u7684 traces\uff0c\u5e76\u4e14\u901a\u8fc7 <code>hint buffer</code> \u6216 <code>instruction prefix</code> \u7684\u65b9\u5f0f\u5c06\u4fe1\u606f\u9ad8\u6548\u4f20\u9012\u7ed9\u786c\u4ef6\uff0c\u51e0\u4e4e\u6ca1\u6709\u989d\u5916\u5f00\u9500\u3002</li> </ul> <p></p> <p>Figure 1: The bottom figure shows a metadata access pattern: 1) Blue/Red dots are metadata accesses that result in useful/useless prefetches; 2) Blue/Red stars represent first metadata access with/without temporal patterns. Their corresponding metadata should/should not be inserted in the metadata table. The top figure shows how Triangel [7] applies its PatternConf to the highlighted metadata access pattern.</p> <p></p> <p>Figure 5: Prophet process overview. Step1: Prophet leverages the PMU to gather counters related to the temporal prefetcher\u2019s performance. Step2: Prophet analyzes the collected counters to generate hints and then injects hints into the original binaries. Step 3: Prophet samples and learns counters across different program inputs.</p> <p></p> <p>Figure 13: Prophet learns counters from gcc\u2019s inputs.</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/ELI5_notes/#1-profile-guided-insertion-policy-eli5","title":"1. Profile-Guided Insertion Policy (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u73b0\u6709\u7684\u786c\u4ef6 temporal prefetcher\uff08\u5982 Triangel\uff09\u5728\u7ba1\u7406\u5b9d\u8d35\u7684 on-chip metadata table \u65f6\uff0c\u9762\u4e34\u7740\u4e00\u4e2a\u4e24\u96be\u56f0\u5883\uff1a\u8981\u4e48\u201c\u6765\u8005\u4e0d\u62d2\u201d\uff0c\u628a\u5927\u91cf\u65e0\u6548\u7684\u5730\u5740\u5173\u8054\u4fe1\u606f\u585e\u8fdb\u8868\u91cc\uff0c\u8fc5\u901f\u5360\u6ee1\u7a7a\u95f4\u5e76\u6324\u6389\u6709\u7528\u7684\u4fe1\u606f\uff1b\u8981\u4e48\u201c\u8fc7\u5ea6\u8c28\u614e\u201d\uff0c\u7528\u4e00\u4e9b\u57fa\u4e8e\u77ed\u671f\u5386\u53f2\u7684\u542f\u53d1\u5f0f\u89c4\u5219\uff08\u6bd4\u5982\u8bba\u6587\u91cc\u7684 PatternConf\uff09\u9519\u8bef\u5730\u8fc7\u6ee4\u6389\u90a3\u4e9b\u5176\u5b9e\u80fd\u4ea7\u751f\u6709\u7528\u9884\u53d6\u7684\u8bf7\u6c42\u3002 - \u8fd9\u4e2a\u95ee\u9898\u7684\u6838\u5fc3\u5728\u4e8e\uff0c\u786c\u4ef6\u5728\u8fd0\u884c\u65f6\u53ea\u80fd\u770b\u5230\u201c\u8fc7\u53bb\u4e00\u5c0f\u6bb5\u201d\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u65e0\u6cd5\u9884\u77e5\u672a\u6765\u3002\u5b83\u5c31\u50cf\u4e00\u4e2a\u8fd1\u89c6\u773c\uff0c\u5728\u5608\u6742\u3001\u52a8\u6001\u53d8\u5316\u7684\u5185\u5b58\u8bbf\u95ee\u6d41\u4e2d\uff08\u5982 </p> <p></p> <p>Figure 1: The bottom figure shows a metadata access pattern: 1) Blue/Red dots are metadata accesses that result in useful/useless prefetches; 2) Blue/Red stars represent first metadata access with/without temporal patterns. Their corresponding metadata should/should not be inserted in the metadata table. The top figure shows how Triangel [7] applies its PatternConf to the highlighted metadata access pattern.</p> <p>\u6240\u793a\uff09\uff0c\u5f88\u5bb9\u6613\u88ab\u4e00\u8fde\u4e32\u7684\u201c\u65e0\u7528\u201d\u8bbf\u95ee\uff08\u7ea2\u70b9\uff09\u8bef\u5bfc\uff0c\u4ece\u800c\u6b66\u65ad\u5730\u8ba4\u4e3a\u540e\u7eed\u6240\u6709\u8bbf\u95ee\u90fd\u6ca1\u4ef7\u503c\uff0c\u76f4\u63a5\u5173\u4e0a\u4e86\u63d2\u5165\u65b0\u5143\u6570\u636e\u7684\u5927\u95e8\uff0c\u9519\u5931\u4e86\u540e\u9762\u771f\u6b63\u6709\u7528\u7684\u201c\u84dd\u661f\u201d\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08metadata table\uff09\uff0c\u8d1f\u8d23\u628a\u8bfb\u8005\uff08CPU\uff09\u53ef\u80fd\u4f1a\u518d\u6b21\u501f\u9605\u7684\u4e66\uff08\u5185\u5b58\u5730\u5740\uff09\u63d0\u524d\u653e\u5230\u4e00\u4e2a\u5feb\u901f\u53d6\u4e66\u533a\u3002\u4ee5\u524d\u7684\u786c\u4ef6\u7b56\u7565\u5c31\u50cf\u662f\u6839\u636e\u8bfb\u8005\u6700\u8fd1\u51e0\u6b21\u501f\u7684\u4e66\u662f\u4e0d\u662f\u7545\u9500\u4e66\uff0c\u6765\u51b3\u5b9a\u662f\u5426\u628a\u4ed6\u8fd9\u6b21\u501f\u7684\u4e66\u4e5f\u653e\u8fdb\u53bb\u3002\u4f46\u5982\u679c\u4e00\u4e2a\u5b66\u8005\u6700\u8fd1\u78b0\u5de7\u67e5\u4e86\u51e0\u672c\u51b7\u95e8\u8d44\u6599\uff08\u65e0\u7528\u8bbf\u95ee\uff09\uff0c\u7cfb\u7edf\u5c31\u8ba4\u4e3a\u4ed6\u4ee5\u540e\u67e5\u7684\u90fd\u662f\u5783\u573e\uff0c\u4e0d\u518d\u4e3a\u4ed6\u670d\u52a1\u4e86\u3002 - Profile-Guided Insertion Policy \u7684\u505a\u6cd5\u5b8c\u5168\u4e0d\u540c\u3002\u5b83\u76f8\u5f53\u4e8e\u5728\u56fe\u4e66\u9986\u6b63\u5f0f\u5f00\u653e\u524d\uff0c\u5148\u505a\u4e00\u6b21\u5168\u9762\u7684\u201c\u7528\u6237\u753b\u50cf\u201d\u8c03\u7814\uff08Profiling\uff09\u3002\u5b83\u53d1\u73b0\uff0c\u6709\u4e9b\u8bfb\u8005\uff08\u7279\u5b9a\u7684 PC, Program Counter\uff09\u65e0\u8bba\u4ec0\u4e48\u65f6\u5019\u6765\uff0c\u501f\u7684\u4e66\u51e0\u4e4e\u4ece\u6765\u4e0d\u4f1a\u88ab\u518d\u6b21\u501f\u9605\uff08prefetching accuracy \u6781\u4f4e\uff09\u3002\u5bf9\u4e8e\u8fd9\u7c7b\u201c\u4e00\u6b21\u6027\u201d\u8bfb\u8005\uff0c\u5e72\u8106\u5c31\u522b\u6d6a\u8d39\u5feb\u901f\u53d6\u4e66\u533a\u7684\u7a7a\u95f4\u4e86\u3002\u8fd9\u4e2a\u7ed3\u8bba\u4e0d\u662f\u4e34\u65f6\u5224\u65ad\u7684\uff0c\u800c\u662f\u57fa\u4e8e\u957f\u671f\u3001\u5168\u9762\u7684\u6570\u636e\u5f97\u51fa\u7684\u201c\u94c1\u5f8b\u201d\u3002</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u5728\u786c\u4ef6\u91cc\u8bbe\u8ba1\u66f4\u590d\u6742\u7684\u5b9e\u65f6\u51b3\u7b56\u903b\u8f91\uff0c\u800c\u662f\u5de7\u5999\u5730\u5c06\u51b3\u7b56\u8fc7\u7a0b\u524d\u7f6e\u5230\u4e86\u8f6f\u4ef6\u7f16\u8bd1/\u4f18\u5316\u9636\u6bb5\uff0c\u5e76\u901a\u8fc7\u4e00\u4e2a\u6781\u7b80\u7684 hint \u673a\u5236\u4e0e\u786c\u4ef6\u901a\u4fe1\u3002 - \u5177\u4f53\u6d41\u7a0b\u662f\uff1a   - \u79bb\u7ebf\u5206\u6790\uff1a\u901a\u8fc7 PMU counters\uff08\u7279\u522b\u662f <code>L2_Prefetch_Useful</code> \u548c <code>L2_Prefetch_Issue</code>\uff09\u7cbe\u786e\u8ba1\u7b97\u51fa\u6bcf\u4e2a\u5185\u5b58\u52a0\u8f7d\u6307\u4ee4\uff08PC\uff09\u5728\u6574\u4e2a\u7a0b\u5e8f\u8fd0\u884c\u5468\u671f\u5185\u7684\u5e73\u5747\u9884\u53d6\u51c6\u786e\u7387\u3002   - \u8bbe\u5b9a\u9608\u503c\uff1a\u5b9a\u4e49\u4e00\u4e2a\u6781\u4f4e\u7684\u9608\u503c\uff08<code>ACC_THRESHOLD</code>\uff09\u3002\u4efb\u4f55\u51c6\u786e\u7387\u4f4e\u4e8e\u6b64\u9608\u503c\u7684PC\uff0c\u90fd\u88ab\u5224\u5b9a\u4e3a\u201c\u51e0\u4e4e\u4ece\u4e0d\u4ea7\u751f\u6709\u7528\u9884\u53d6\u201d\u3002   - \u6ce8\u5165Hint\uff1a\u5c06\u8fd9\u4e2a\u4e8c\u5143\u51b3\u7b56\uff08\u201c\u8fc7\u6ee4\u201d\u6216\u201c\u4e0d\u8fc7\u6ee4\u201d\uff09\u7f16\u7801\u6210\u4e00\u4e2a 1-bit hint\uff0c\u5e76\u901a\u8fc7 hint buffer \u6216 instruction prefix \u7684\u65b9\u5f0f\uff0c\u628a\u8fd9\u4e2ahint\u201c\u8d34\u201d\u5230\u5bf9\u5e94\u7684\u5185\u5b58\u6307\u4ee4\u4e0a\u3002   - \u786c\u4ef6\u6267\u884c\uff1a\u5f53\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u786c\u4ef6prefetcher\u5728\u5904\u7406\u4e00\u4e2a\u5185\u5b58\u8bf7\u6c42\u65f6\uff0c\u53ea\u9700\u68c0\u67e5\u8fd9\u4e2a\u9644\u5e26\u76841-bit hint\u3002\u5982\u679c\u662f\u201c\u8fc7\u6ee4\u201d\u4fe1\u53f7\uff0c\u5c31\u76f4\u63a5\u8df3\u8fc7\uff0c\u4e0d\u53bb\u8bad\u7ec3prefetcher\u4e5f\u4e0d\u63d2\u5165metadata\u3002 - \u8fd9\u4e00\u62db\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u7528\u4e00\u6b21\u6027\u7684\u3001\u8f7b\u91cf\u7ea7\u7684\u79bb\u7ebf profiling\uff08\u53ea\u7528\u8ba1\u6570\u5668\uff0c\u4e0d\u7528\u6c89\u91cd\u7684trace\uff09\uff0c\u6362\u53d6\u4e86\u8fd0\u884c\u65f6\u5bf9metadata table\u6781\u5176\u7cbe\u51c6\u7684\u6e90\u5934\u8fc7\u6ee4\uff0c\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u786c\u4ef6\u56e0\u201c\u76ee\u5149\u77ed\u6d45\u201d\u800c\u5bfc\u81f4\u7684\u8bef\u5224\u95ee\u9898\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/ELI5_notes/#2-profile-guided-replacement-policy-eli5","title":"2. Profile-Guided Replacement Policy (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u786c\u4ef6 temporal prefetcher\uff08\u5982 Triangel\uff09\u5728\u7ba1\u7406 metadata table\uff08\u5143\u6570\u636e\u8868\uff09\u65f6\uff0c\u5176 replacement policy\uff08\u66ff\u6362\u7b56\u7565\uff09\u53ea\u5173\u5fc3\u4e00\u4e2a\u4e8b\uff1a\u8fd9\u4e2a\u5143\u6570\u636e\u6761\u76ee\u672a\u6765\u8fd8\u4f1a\u4e0d\u4f1a\u88ab\u7528\u5230\uff1f\u5b83\u7528 reuse distance\uff08\u91cd\u7528\u8ddd\u79bb\uff09\u4e4b\u7c7b\u7684\u6307\u6807\u6765\u9884\u6d4b\u3002 - \u8fd9\u4e2a\u601d\u8def\u5728\u7406\u60f3\u60c5\u51b5\u4e0b\u6ca1\u95ee\u9898\uff0c\u4f46\u73b0\u5b9e\u5f88\u9aa8\u611f\u3002\u8bba\u6587\u6307\u51fa\uff0c\u5143\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u6781\u5176\u201c\u52a8\u6001\u4e14\u65b9\u5dee\u5de8\u5927\u201d\uff08highly variable with large reuse distance variance\uff09\u3002\u4e00\u4e2a\u6761\u76ee\u53ef\u80fd\u5f88\u4e45\u4e0d\u7528\uff0c\u4f46\u4e0b\u6b21\u7528\u5c31\u80fd\u5e26\u6765\u4e00\u6b21\u975e\u5e38\u5173\u952e\u7684\u9884\u53d6\uff1b\u53cd\u4e4b\uff0c\u4e00\u4e2a\u9891\u7e41\u547d\u4e2d\u7684\u6761\u76ee\uff0c\u53ef\u80fd\u9884\u53d6\u7684\u90fd\u662f\u4e9b\u6ca1\u7528\u7684\u6570\u636e\uff0c\u767d\u767d\u6d6a\u8d39\u5e26\u5bbd\u3002 - \u6240\u4ee5\uff0c\u4f20\u7edf\u65b9\u6cd5\u7684\u6838\u5fc3\u75db\u70b9\u662f\uff1a\u5b83\u53ea\u4f18\u5316\u4e86 metadata table \u7684\u547d\u4e2d\u7387\uff0c\u5374\u5b8c\u5168\u5ffd\u7565\u4e86\u547d\u4e2d\u4e4b\u540e\u7684\u201c\u4ef7\u503c\u201d\u3002\u5b83\u628a\u6240\u6709\u547d\u4e2d\u4e00\u89c6\u540c\u4ec1\uff0c\u5bfc\u81f4\u5b9d\u8d35\u7684\u7247\u4e0a\u5b58\u50a8\u7a7a\u95f4\u88ab\u90a3\u4e9b\u201c\u547d\u4e2d\u4e86\u4e5f\u6ca1\u7528\u201d\u7684\u5783\u573e\u5143\u6570\u636e\u5360\u636e\uff0c\u800c\u771f\u6b63\u80fd\u5e26\u6765\u6027\u80fd\u63d0\u5347\u7684\u9ad8\u4ef7\u503c\u5143\u6570\u636e\u53cd\u800c\u53ef\u80fd\u88ab\u6324\u51fa\u53bb\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08replacement policy\uff09\uff0c\u8d1f\u8d23\u7ba1\u7406\u4e00\u4e2a\u5bb9\u91cf\u6709\u9650\u7684\u7545\u9500\u4e66\u67b6\uff08metadata table\uff09\u3002 - \u65e7\u7684\u65b9\u6cd5\uff08\u5982 Hawkeye, SRRIP\uff09\u5c31\u50cf\u662f\u6839\u636e\u201c\u8fc7\u53bb\u4e00\u4e2a\u6708\u501f\u9605\u6b21\u6570\u201d\u6765\u51b3\u5b9a\u54ea\u4e9b\u4e66\u7559\u4e0b\uff0c\u54ea\u4e9b\u4e66\u9000\u56de\u4ed3\u5e93\u3002\u8fd9\u770b\u8d77\u6765\u5f88\u5408\u7406\uff0c\u5bf9\u5427\uff1f - \u4f46\u73b0\u5728\u95ee\u9898\u6765\u4e86\uff1a\u6709\u4e9b\u4e66\uff08\u6bd4\u5982\u300a\u5982\u4f55\u4fee\u7406\u6c34\u9f99\u5934\u300b\uff09\u88ab\u501f\u4e86\u5f88\u591a\u6b21\uff0c\u4f46\u6bcf\u6b21\u501f\u7684\u4eba\u90fd\u53ea\u662f\u968f\u4fbf\u7ffb\u7ffb\uff0c\u6839\u672c\u6ca1\u4fee\u597d\u81ea\u5bb6\u7684\u6c34\u9f99\u5934\uff08useless prefetch\uff09\u3002\u800c\u53e6\u4e00\u4e9b\u4e66\uff08\u6bd4\u5982\u300a\u91cf\u5b50\u7269\u7406\u5165\u95e8\u300b\uff09\u867d\u7136\u5f88\u5c11\u6709\u4eba\u501f\uff0c\u4f46\u53ea\u8981\u6709\u4eba\u501f\uff0c\u5c31\u771f\u7684\u80fd\u5b66\u4f1a\u5e76\u89e3\u51b3\u4e00\u4e2a\u5927\u96be\u9898\uff08useful prefetch\uff09\u3002 - \u5982\u679c\u4f60\u53ea\u770b\u501f\u9605\u6b21\u6570\uff0c\u4f60\u4f1a\u628a\u5b9d\u8d35\u7684\u4e66\u67b6\u4f4d\u7f6e\u7559\u7ed9\u90a3\u672c\u6ca1\u7528\u7684\u300a\u4fee\u7406\u6c34\u9f99\u5934\u300b\uff0c\u800c\u628a\u300a\u91cf\u5b50\u7269\u7406\u300b\u9000\u56de\u4ed3\u5e93\u3002Profile-Guided Replacement Policy \u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\uff1a\u522b\u5149\u770b\u501f\u4e86\u591a\u5c11\u6b21\uff0c\u8981\u770b\u8fd9\u672c\u4e66\u771f\u6b63\u5e2e\u8bfb\u8005\u89e3\u51b3\u4e86\u591a\u5c11\u95ee\u9898\uff01\u5b83\u5f15\u5165\u4e86\u4e00\u4e2a\u65b0\u7684\u6307\u6807\u2014\u2014\u201c\u8bfb\u8005\u6ee1\u610f\u5ea6\u201d\uff08prefetching accuracy\uff09\uff0c\u6765\u7ed9\u6bcf\u672c\u4e66\u6253\u5206\uff0c\u4f18\u5148\u4fdd\u7559\u90a3\u4e9b\u6ee1\u610f\u5ea6\u9ad8\u7684\u4e66\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u5e76\u6ca1\u6709\u629b\u5f03\u786c\u4ef6 prefetcher \u7684\u6574\u4e2a\u6846\u67b6\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728\u8f6f\u4ef6\u5c42\u9762\u505a\u4e86\u4e00\u6b21\u201c\u5168\u5c40\u4f53\u68c0\u201d\uff0c\u7136\u540e\u7ed9\u786c\u4ef6\u4e0b\u8fbe\u66f4\u7cbe\u51c6\u7684\u6307\u4ee4\u3002 - \u5177\u4f53\u6765\u8bf4\uff0c\u4ed6\u4eec\u5728\u7a0b\u5e8f\u8fd0\u884c\u524d\u7684 Profiling \u9636\u6bb5\uff0c\u5229\u7528 PMU counters \u7cbe\u786e\u7edf\u8ba1\u51fa\u6bcf\u4e2a\u5185\u5b58\u6307\u4ee4\uff08PC\uff09\u7684 prefetching accuracy\uff08\u9884\u53d6\u51c6\u786e\u7387 = \u6709\u7528\u9884\u53d6\u6570 / \u603b\u9884\u53d6\u6570\uff09\u3002 - \u57fa\u4e8e\u8fd9\u4e2a\u5168\u5c40\u3001\u957f\u671f\u3001\u771f\u5b9e\u7684\u51c6\u786e\u7387\u6570\u636e\uff0c\u4ed6\u4eec\u4e3a\u6bcf\u4e2a\u5185\u5b58\u6307\u4ee4\u5206\u914d\u4e00\u4e2a\u7ec6\u7c92\u5ea6\u7684\u66ff\u6362\u4f18\u5148\u7ea7\uff08\u4f8b\u5982\uff0c\u75282-bit\u8868\u793a4\u4e2a\u7b49\u7ea7\uff09\u3002 - \u5728\u7a0b\u5e8f\u6b63\u5f0f\u8fd0\u884c\u65f6\uff0c\u5f53\u4e00\u4e2a\u65b0\u7684\u5143\u6570\u636e\u6761\u76ee\u8981\u63d2\u5165 metadata table \u65f6\uff0c\u786c\u4ef6\u4f1a\u628a\u8fd9\u4e2a\u4f18\u5148\u7ea7\u4fe1\u606f\uff08\u4f5c\u4e3a Hint\uff09\u4e00\u5e76\u5b58\u5165\u4e00\u4e2a\u4e13\u7528\u7684 Prophet Replacement State\u3002 - \u5f53\u9700\u8981\u66ff\u6362\u65f6\uff0c\u786c\u4ef6\u4e0d\u518d\u53ea\u770b LRU \u6216 reuse prediction\uff0c\u800c\u662f\u5148\u627e\u51fa\u4f18\u5148\u7ea7\u6700\u4f4e\u7684\u90a3\u4e00\u6279\u5019\u9009\u8005\uff0c\u518d\u4ece\u8fd9\u6279\u201c\u4f4e\u4ef7\u503c\u201d\u6761\u76ee\u91cc\u7528\u4f20\u7edf\u65b9\u6cd5\uff08\u5982 LRU\uff09\u9009\u51fa\u6700\u7ec8\u7684\u53d7\u5bb3\u8005\u3002 - \u8fd9\u4e00\u62db\u7684\u672c\u8d28\uff0c\u5c31\u662f\u5c06\u51b3\u7b56\u4f9d\u636e\u4ece\u77ed\u89c6\u7684\u3001\u5c40\u90e8\u7684\u201c\u662f\u5426\u4f1a\u88ab\u8bbf\u95ee\u201d\uff08reuse\uff09\uff0c\u626d\u8f6c\u4e3a\u5168\u5c40\u7684\u3001\u7ed3\u679c\u5bfc\u5411\u7684\u201c\u8bbf\u95ee\u540e\u662f\u5426\u6709\u4ef7\u503c\u201d\uff08accuracy\uff09\u3002</p> <p></p> <p>\u8fd9\u4e2a\u516c\u5f0f\u5c31\u662f\u5c06\u51c6\u786e\u7387\u6620\u5c04\u4e3a\u4f18\u5148\u7ea7\u7684\u6838\u5fc3\u903b\u8f91\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/ELI5_notes/#3-multi-path-victim-buffer-eli5","title":"3. Multi-path Victim Buffer (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4f20\u7edf\u7684\u786c\u4ef6\u65f6\u5e8f\u9884\u53d6\u5668\uff08\u5982 Triangel\uff09\u5728\u5904\u7406 Markov \u94fe \u65f6\uff0c\u5176\u5143\u6570\u636e\u8868\uff08metadata table\uff09\u91cc\u6bcf\u4e2a\u5185\u5b58\u5730\u5740\u53ea\u5b58\u4e00\u4e2a\u201c\u4e0b\u4e00\u4e2a\u6700\u53ef\u80fd\u8bbf\u95ee\u7684\u76ee\u6807\u5730\u5740\u201d\u3002 - \u4f46\u5728\u771f\u5b9e\u7a0b\u5e8f\u4e2d\uff0c\u4e00\u4e2a\u5730\u5740\u7ecf\u5e38\u6709\u591a\u4e2a\u5408\u6cd5\u7684\u540e\u7eed\u76ee\u6807\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u94fe\u8868\u8282\u70b9 <code>B</code> \u5728\u67d0\u4e9b\u6267\u884c\u8def\u5f84\u4e0b\u6307\u5411 <code>C</code>\uff0c\u5728\u53e6\u4e00\u4e9b\u8def\u5f84\u4e0b\u53c8\u6307\u5411 <code>D</code>\u3002\u8fd9\u79cd \u591a\u8def\u5f84\u65f6\u5e8f\u6a21\u5f0f (multi-path temporal pattern) \u975e\u5e38\u666e\u904d\u3002 - \u5f53\u5143\u6570\u636e\u8868\u53ea\u80fd\u5b58\u4e00\u4e2a\u76ee\u6807\u65f6\uff0c\u5b83\u8981\u4e48\u731c\u9519\uff08\u5bfc\u81f4\u65e0\u6548\u9884\u53d6\uff09\uff0c\u8981\u4e48\u56e0\u4e3a\u9891\u7e41\u88ab\u4e0d\u540c\u8def\u5f84\u7684\u8bbf\u95ee\u8986\u76d6\u800c\u5931\u6548\uff08\u5bfc\u81f4\u6709\u7528\u9884\u53d6\u4e22\u5931\uff09\u3002\u8fd9\u5c31\u9020\u6210\u4e86 \u987e\u6b64\u5931\u5f7c \u7684\u56f0\u5883\uff1a\u4e3a\u4e86\u9002\u5e94\u4e00\u79cd\u8def\u5f84\uff0c\u5c31\u727a\u7272\u4e86\u53e6\u4e00\u79cd\u8def\u5f84\u7684\u6027\u80fd\u3002</p> <p></p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08\u5143\u6570\u636e\u8868\uff09\uff0c\u4f60\u7684\u4efb\u52a1\u662f\u8bb0\u4f4f\u6bcf\u4f4d\u8bfb\u8005\uff08\u5185\u5b58\u5730\u5740\uff09\u4e0b\u6b21\u6700\u53ef\u80fd\u501f\u54ea\u672c\u4e66\uff08\u76ee\u6807\u5730\u5740\uff09\u3002 - \u4ee5\u524d\u7684\u89c4\u5219\u662f\uff1a\u6bcf\u4e2a\u8bfb\u8005\u4f60\u53ea\u80fd\u8bb0\u4e00\u672c\u4e66\u3002\u4f46\u73b0\u5b9e\u4e2d\uff0c\u8bfb\u8005 <code>Alice</code> \u6709\u65f6\u501f\u79d1\u5e7b\u5c0f\u8bf4\uff0c\u6709\u65f6\u501f\u5386\u53f2\u4f20\u8bb0\u3002\u4f60\u8bb0\u4e86\u79d1\u5e7b\uff0c\u5979\u6765\u501f\u4f20\u8bb0\u65f6\u4f60\u5c31\u5e2e\u4e0d\u4e0a\u5fd9\uff1b\u53cd\u4e4b\u4ea6\u7136\u3002 - Multi-path Victim Buffer \u5c31\u50cf\u662f\u5728\u4f60\u7684\u4e3b\u5de5\u4f5c\u53f0\uff08\u5143\u6570\u636e\u8868\uff09\u65c1\u8fb9\u653e\u4e86\u4e00\u4e2a\u5c0f\u4fbf\u7b7e\u672c\uff08Victim Buffer\uff09\u3002\u5f53\u4f60\u4e3b\u5de5\u4f5c\u53f0\u4e0a\u5173\u4e8e <code>Alice</code> \u7684\u8bb0\u5f55\u56e0\u4e3a\u65b0\u4fe1\u606f\uff08\u6bd4\u5982\u5979\u521a\u501f\u4e86\u4f20\u8bb0\uff09\u800c\u4e0d\u5f97\u4e0d\u64e6\u6389\u65e7\u7684\u79d1\u5e7b\u8bb0\u5f55\u65f6\uff0c\u4f60\u4e0d\u4f1a\u76f4\u63a5\u6254\u6389\u90a3\u5f20\u79d1\u5e7b\u4fbf\u7b7e\uff0c\u800c\u662f\u628a\u5b83\u8d34\u5230\u8fd9\u4e2a\u5c0f\u672c\u5b50\u4e0a\u3002 - \u4e0b\u6b21 <code>Alice</code> \u518d\u6765\uff0c\u4f60\u4e0d\u4ec5\u770b\u4e3b\u5de5\u4f5c\u53f0\uff0c\u8fd8\u4f1a\u5feb\u901f\u626b\u4e00\u773c\u5c0f\u4fbf\u7b7e\u672c\u3002\u5982\u679c\u53d1\u73b0\u5979\u8fc7\u53bb\u4e5f\u5e38\u501f\u79d1\u5e7b\uff0c\u800c\u8fd9\u6b21\u6ca1\u660e\u786e\u8bf4\uff0c\u4f60\u5c31\u53ef\u4ee5\u5927\u80c6\u5730\u628a\u4e24\u672c\u4e66\u90fd\u51c6\u5907\u597d\u3002\u8fd9\u4e2a\u5c0f\u672c\u5b50\u4e13\u95e8\u7528\u6765\u4fdd\u5b58\u90a3\u4e9b\u201c\u867d\u7136\u6682\u65f6\u4e0d\u7528\uff0c\u4f46\u5f88\u53ef\u80fd\u8fd8\u4f1a\u56de\u6765\u201d\u7684\u91cd\u8981\u5907\u9009\u4fe1\u606f\u3002</p> <p></p> <p>Figure 7: Challenges of traditional profile-guided optimizations across different program inputs.</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u6ca1\u6709\u53bb\u6539\u9020\u6602\u8d35\u4e14\u7a7a\u95f4\u6709\u9650\u7684\u4e3b\u5143\u6570\u636e\u8868\uff0c\u8ba9\u5b83\u80fd\u5b58\u591a\u4e2a\u76ee\u6807\uff08\u90a3\u6837\u5b58\u50a8\u5f00\u9500\u592a\u5927\uff09\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728\u66ff\u6362\uff08eviction\uff09\u6d41\u7a0b\u4e2d\u589e\u52a0\u4e86\u4e00\u4e2a\u667a\u80fd\u7684\u201c\u56de\u6536\u7ad9\u201d\u3002 - \u5177\u4f53\u6765\u8bf4\uff1a   - \u9009\u62e9\u6027\u4fdd\u5b58\uff1a\u5f53\u4e00\u4e2a Markov \u76ee\u6807\u8981\u4ece\u4e3b\u8868\u4e2d\u88ab\u66ff\u6362\u51fa\u53bb\u65f6\uff0c\u5e76\u4e0d\u662f\u76f4\u63a5\u4e22\u5f03\u3002\u7cfb\u7edf\u4f1a\u68c0\u67e5\u8fd9\u4e2a\u76ee\u6807\u7684 \u4f18\u5148\u7ea7\uff08priority level\uff09\u3002\u53ea\u6709\u90a3\u4e9b \u4f18\u5148\u7ea7\u9ad8\u4e8e\u9608\u503c\uff08\u5373\u5386\u53f2\u4e0a\u4ea7\u751f\u8fc7\u6709\u7528\u9884\u53d6\uff09\u7684\u76ee\u6807\uff0c\u624d\u4f1a\u88ab\u5b58\u5165 Multi-path Victim Buffer\u3002   - \u72ec\u7acb\u7ba1\u7406\uff1a\u8fd9\u4e2a\u7f13\u51b2\u533a\u6709\u81ea\u5df1\u7684 \u8ba1\u6570\u5668\u673a\u5236 \u6765\u8ddf\u8e2a\u5176\u4e2d\u6bcf\u4e2a\u76ee\u6807\u7684\u4f7f\u7528\u70ed\u5ea6\uff0c\u5e76\u7528\u4e00\u5957\u72ec\u7acb\u7684\u7b56\u7565\u6765\u51b3\u5b9a\u81ea\u5df1\u7684\u66ff\u6362\uff0c\u786e\u4fdd\u91cc\u9762\u7559\u4e0b\u7684\u90fd\u662f\u771f\u6b63\u6709\u4ef7\u503c\u7684\u201c\u5907\u80ce\u201d\u3002   - \u534f\u540c\u9884\u53d6\uff1a\u5728\u8fdb\u884c\u9884\u53d6\u51b3\u7b56\u65f6\uff0c\u786c\u4ef6\u4f1a\u540c\u65f6\u67e5\u8be2\u4e3b\u5143\u6570\u636e\u8868\u548c\u8fd9\u4e2a Victim Buffer\u3002\u5982\u679c\u5728\u4e00\u4e2a\u5730\u5740\u4e0b\u627e\u5230\u591a\u4e2a\u6709\u6548\u76ee\u6807\uff0c\u5c31\u53ef\u4ee5\u5e76\u53d1\u5730\u9884\u53d6\u5b83\u4eec\uff0c\u4ece\u800c\u8986\u76d6\u590d\u6742\u7684\u591a\u8def\u5f84\u573a\u666f\u3002 - \u8fd9\u4e00\u62db\u7684\u6838\u5fc3\u903b\u8f91\u8f6c\u6362\u5728\u4e8e\uff1a\u5c06\u201c\u5355\u70b9\u9884\u6d4b\u201d\u7684\u538b\u529b\uff0c\u901a\u8fc7\u4e00\u4e2a\u4f4e\u6210\u672c\u3001\u9ad8\u9009\u62e9\u6027\u7684\u8f85\u52a9\u7f13\u51b2\u533a\uff0c\u8f6c\u5316\u4e3a\u4e86\u201c\u591a\u5019\u9009\u96c6\u201d\u7684\u7075\u6d3b\u5e94\u5bf9\uff0c\u5b8c\u7f8e\u89e3\u51b3\u4e86\u5355\u5730\u5740\u591a\u76ee\u6807\u7684\u6839\u672c\u77db\u76fe\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/ELI5_notes/#4-adaptive-learning-across-inputs-eli5","title":"4. Adaptive Learning across Inputs (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684 Profile-Guided Optimization (PGO) \u6709\u4e2a\u81f4\u547d\u4f24\uff1a\u5b83\u5728\u7279\u5b9a\u8f93\u5165\uff08\u6bd4\u5982 <code>input_A</code>\uff09\u4e0a\u8dd1\u4e00\u904d\uff0c\u6536\u96c6\u6570\u636e\uff0c\u7136\u540e\u628a\u4f18\u5316\u201c\u56fa\u5316\u201d\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u91cc\u3002</li> <li>\u8fd9\u4e2a\u56fa\u5316\u540e\u7684\u4e8c\u8fdb\u5236\uff0c\u4e00\u65e6\u9047\u5230\u4e00\u4e2a\u6ca1\u89c1\u8fc7\u7684\u65b0\u8f93\u5165\uff08\u6bd4\u5982 <code>input_B</code>\uff09\uff0c\u6027\u80fd\u53ef\u80fd\u5c31\u5d29\u4e86\u3002\u56e0\u4e3a\u65b0\u8f93\u5165\u89e6\u53d1\u4e86\u5b8c\u5168\u4e0d\u540c\u7684\u4ee3\u7801\u8def\u5f84\u548c\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u65e7\u7684hints\u8981\u4e48\u6ca1\u7528\uff0c\u8981\u4e48\u6709\u5bb3\u3002</li> <li>\u4f60\u53ef\u80fd\u4f1a\u8bf4\uff1a\u201c\u90a3\u6bcf\u6b21\u6362\u8f93\u5165\u90fd\u91cd\u65b0profile\u4e00\u904d\u4e0d\u5c31\u884c\u4e86\uff1f\u201d\u4f46\u8fd9\u5728\u73b0\u5b9e\u4e2d\u6839\u672c\u4e0dwork\u3002\u91cd\u65b0\u7f16\u8bd1/\u4f18\u5316\u5f00\u9500\u5de8\u5927\uff0c\u5bf9\u4e8e\u90e8\u7f72\u5728\u670d\u52a1\u5668\u6216\u5ba2\u6237\u7aef\u7684\u7a0b\u5e8f\u6765\u8bf4\uff0c\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002</li> <li>\u6240\u4ee5\uff0c\u6838\u5fc3\u75db\u70b9\u662f\uff1a\u5982\u4f55\u8ba9\u4e00\u4e2a\u201c\u56fa\u5316\u201d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u80fd\u50cf\u6709\u751f\u547d\u4e00\u6837\uff0c\u6301\u7eed\u5730\u4ece\u65b0\u7ecf\u9a8c\u4e2d\u5b66\u4e60\uff0c\u5e76\u52a8\u6001\u8c03\u6574\u81ea\u5df1\u7684\u884c\u4e3a\uff0c\u4ee5\u9002\u5e94\u5343\u53d8\u4e07\u5316\u7684\u8f93\u5165\uff1f</li> </ul> <p></p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u8001\u7ec3\u7684\u56fe\u4e66\u7ba1\u7406\u5458\uff08\u5bf9\u5e94 Prophet \u7684 hints\uff09\uff0c\u8d1f\u8d23\u7ba1\u7406\u4e00\u4e2a\u85cf\u4e66\u91cf\u6709\u9650\u7684\u73cd\u672c\u9605\u89c8\u5ba4\uff08\u5bf9\u5e94 metadata table\uff09\u3002</li> <li>\u4ee5\u524d\u7684\u505a\u6cd5\uff08\u4f20\u7edf PGO\uff09\u662f\uff1a\u9986\u957f\u8ba9\u4f60\u6839\u636e\u4e0a\u4e2a\u6708\uff08<code>input_A</code>\uff09\u7684\u501f\u9605\u8bb0\u5f55\uff0c\u5236\u5b9a\u4e00\u4efd\u201c\u91cd\u70b9\u63a8\u8350\u4e66\u5355\u201d\u548c\u201c\u4e66\u7c4d\u6446\u653e\u4f18\u5148\u7ea7\u201d\u3002\u8fd9\u4e2a\u6708\u6765\u4e86\u4e00\u6279\u5168\u65b0\u7684\u8bfb\u8005\uff08<code>input_B</code>\uff09\uff0c\u4ed6\u4eec\u60f3\u770b\u7684\u4e66\u6839\u672c\u4e0d\u5728\u4f60\u7684\u63a8\u8350\u5217\u8868\u91cc\uff0c\u7ed3\u679c\u9605\u89c8\u5ba4\u6548\u7387\u4f4e\u4e0b\uff0c\u6028\u58f0\u8f7d\u9053\u3002</li> <li>Prophet \u7684\u505a\u6cd5\u5b8c\u5168\u4e0d\u540c\u3002\u5b83\u8ba9\u4f60\u4fdd\u7559\u8fd9\u4efd\u521d\u59cb\u7684\u63a8\u8350\u5217\u8868\uff0c\u4f46\u540c\u65f6\u7ed9\u4f60\u4e00\u4e2a\u5c0f\u672c\u5b50\uff08counter history\uff09\u3002\u6bcf\u5f53\u6709\u65b0\u8bfb\u8005\u8fdb\u6765\uff0c\u4f60\u4e0d\u4ec5\u670d\u52a1\u4ed6\u4eec\uff0c\u8fd8\u6084\u6084\u8bb0\u4e0b\u4ed6\u4eec\u7684\u501f\u9605\u504f\u597d\uff08\u91c7\u6837\u65b0 counters\uff09\u3002</li> <li>\u5230\u4e86\u6708\u5e95\uff0c\u4f60\u4e0d\u662f\u6254\u6389\u65e7\u672c\u5b50\u91cd\u5199\uff0c\u800c\u662f\u628a\u65b0\u8bb0\u5f55\u878d\u5408\u5230\u65e7\u672c\u5b50\u91cc\uff08merge counters\uff09\uff0c\u7136\u540e\u57fa\u4e8e\u8fd9\u4e2a\u66f4\u5168\u9762\u3001\u66f4\u9c9c\u6d3b\u7684\u8bb0\u5f55\uff0c\u5fae\u8c03\u4f60\u7684\u63a8\u8350\u5217\u8868\u548c\u6446\u653e\u7b56\u7565\u3002</li> <li>\u8fd9\u6837\uff0c\u4f60\u7684\u9605\u89c8\u5ba4\u5c31\u80fd\u6301\u7eed\u8fdb\u5316\uff0c\u65e0\u8bba\u6765\u7684\u662f\u8001\u8bfb\u8005\u8fd8\u662f\u65b0\u8bfb\u8005\uff0c\u90fd\u80fd\u63d0\u4f9b\u8fd1\u4e4e\u6700\u4f18\u7684\u670d\u52a1\u3002\u6700\u5173\u952e\u7684\u662f\uff0c\u4f60\u4e0d\u9700\u8981\u6bcf\u6b21\u90fd\u628a\u6574\u4e2a\u9605\u89c8\u5ba4\u7684\u4e66\u67b6\u63a8\u5012\u91cd\u6765\u3002</li> </ul> <p></p> <p>Figure 13: Prophet learns counters from gcc\u2019s inputs.</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u629b\u5f03 PGO \u7684\u6846\u67b6\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728\u5176\u4e2d\u5f15\u5165\u4e86\u4e00\u4e2a\u5728\u7ebf\u5b66\u4e60\uff08online learning\uff09\u7684\u53cd\u9988\u56de\u8def\u3002\u5177\u4f53\u6765\u8bf4\uff1a</p> <ul> <li> <p>Step 1: \u8f7b\u91cf\u7ea7\u76d1\u63a7\u3002\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0cProphet \u4f1a\u5b9a\u671f\uff08\u6bd4\u5982\u6bcf10-100\u6b21\u6267\u884c\uff09\u542f\u7528\u4e00\u4e2a\u7b80\u5316\u7684 profiler\uff0c\u53ea\u6536\u96c6\u6700\u6838\u5fc3\u7684 PMU counters\uff08\u5982 prefetch accuracy per PC, total metadata entries\uff09\u3002\u8fd9\u5f00\u9500\u6781\u5c0f\uff0c\u51e0\u4e4e\u65e0\u611f\u3002</p> </li> <li> <p>Step 2: \u667a\u80fd\u878d\u5408\u5386\u53f2\u3002\u62ff\u5230\u65b0 counters \u540e\uff0cProphet \u4e0d\u662f\u76f4\u63a5\u8986\u76d6\u65e7\u6570\u636e\uff0c\u800c\u662f\u901a\u8fc7\u4e00\u4e2a\u5e26\u8870\u51cf\u56e0\u5b50\u7684\u52a0\u6743\u5e73\u5747\u516c\u5f0f\uff08\u89c1 Equation 4 &amp; 5\uff09\u5c06\u65b0\u65e7\u6570\u636e\u878d\u5408\u3002\u8fd9\u4e2a\u516c\u5f0f\u7684\u8bbe\u8ba1\u975e\u5e38\u7cbe\u5999\uff1a</p> </li> <li>\u5bf9\u4e8e\u4ece\u672a\u89c1\u8fc7\u7684\u4ee3\u7801\u8def\u5f84\uff08\u5982 Load C in Fig 7\uff09\uff0c\u65b0\u6570\u636e\u4f1a\u4e3b\u5bfc\uff0c\u5feb\u901f\u751f\u6210\u6709\u6548 hints\u3002</li> <li>\u5bf9\u4e8e\u884c\u4e3a\u7a33\u5b9a\u7684\u4ee3\u7801\u8def\u5f84\uff08\u5982 Load A in Fig 7\uff09\uff0c\u65b0\u65e7\u6570\u636e\u4e00\u81f4\uff0chints \u4fdd\u6301\u7a33\u5b9a\u3002</li> <li> <p>\u5bf9\u4e8e\u884c\u4e3a\u6f02\u79fb\u7684\u4ee3\u7801\u8def\u5f84\uff08\u5982 Load E in Fig 7\uff09\uff0c\u65b0\u6570\u636e\u4f1a\u9010\u6e10\u4fee\u6b63\u65e7\u7684\u4f30\u8ba1\uff0c\u5b9e\u73b0\u5e73\u6ed1\u8fc7\u6e21\u3002</p> </li> <li> <p>Step 3: \u52a8\u6001\u66f4\u65b0 hints\u3002\u878d\u5408\u540e\u7684\u65b0\u6570\u636e\u4f1a\u89e6\u53d1\u4e00\u6b21\u8f7b\u91cf\u7ea7\u7684 Analysis Step\uff0c\u751f\u6210\u4e00\u5957\u66f4\u65b0\u540e\u7684 hints\u3002\u8fd9\u4e9b hints \u4f1a\u88ab\u6ce8\u5165\u5230\u6b63\u5728\u8fd0\u884c\u7684\u4e8c\u8fdb\u5236\u4e2d\uff08\u901a\u8fc7 hint buffer \u6216 instruction prefix\uff09\uff0c\u6307\u5bfc\u540e\u7eed\u7684 insertion, replacement, \u548c resizing \u7b56\u7565\u3002</p> </li> </ul> <p>\u8fd9\u4e2a\u6d41\u7a0b\u7684\u6838\u5fc3\u626d\u8f6c\u5728\u4e8e\uff1a\u5c06 PGO \u4ece\u4e00\u4e2a\u201c\u4e00\u6b21\u6027\u3001\u9759\u6001\u201d\u7684\u8fc7\u7a0b\uff0c\u8f6c\u53d8\u4e3a\u4e00\u4e2a\u201c\u5468\u671f\u6027\u3001\u52a8\u6001\u201d\u7684\u95ed\u73af\u7cfb\u7edf\u3002\u5b83\u7528\u6781\u4f4e\u7684\u8fd0\u884c\u65f6\u5f00\u9500\uff0c\u6362\u53d6\u4e86\u6a21\u578b\u5bf9\u8f93\u5165\u53d8\u5316\u7684\u5f3a\u5927\u9002\u5e94\u80fd\u529b\uff0c\u771f\u6b63\u505a\u5230\u4e86\u201c\u4e00\u4e2a\u4e8c\u8fdb\u5236\uff0c\u901a\u5403\u6240\u6709\u8f93\u5165\u201d\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/ELI5_notes/#5-lightweight-counter-based-profiling-eli5","title":"5. Lightweight Counter-Based Profiling (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 Profile-Guided Optimization (PGO) \u4e3a\u4e86\u6307\u5bfc\u4f18\u5316\uff0c\u5f80\u5f80\u9700\u8981\u6536\u96c6\u5b8c\u6574\u7684 execution trace\uff08\u6267\u884c\u8f68\u8ff9\uff09\u3002\u8fd9\u5728\u9884\u53d6\u573a\u666f\u4e0b\u5c24\u5176\u75db\u82e6\uff1a   - \u5f00\u9500\u5de8\u5927\uff1a\u8bb0\u5f55\u6bcf\u4e00\u6b21\u5185\u5b58\u8bbf\u95ee\u7684\u5b8c\u6574\u5730\u5740\u548c\u4e0a\u4e0b\u6587\uff0c\u4f1a\u4ea7\u751f\u6d77\u91cf\u6570\u636e\uff0c\u4e25\u91cd\u62d6\u6162\u7a0b\u5e8f\u8fd0\u884c\uff08Profiling Overhead \u9ad8\uff09\uff0c\u5e76\u4e14\u9700\u8981\u5de8\u5927\u7684\u5b58\u50a8\u7a7a\u95f4\u6765\u4fdd\u5b58\u8fd9\u4e9b trace\u3002   - \u4e0d\u5207\u5b9e\u9645\uff1a\u5728\u751f\u4ea7\u73af\u5883\u6216\u5546\u4e1a\u5904\u7406\u5668\u4e2d\uff0c\u6301\u7eed\u6536\u96c6\u5982\u6b64\u7cbe\u7ec6\u7684 trace \u662f\u4e0d\u53ef\u884c\u7684\uff0c\u786c\u4ef6\u4e0a\u4e5f\u6ca1\u6709\u4e3a\u6b64\u8bbe\u8ba1\u7684\u4e13\u7528\u7f13\u51b2\u533a\u3002   - \u6740\u9e21\u7528\u725b\u5200\uff1a\u5bf9\u4e8e\u6307\u5bfc\u5143\u6570\u636e\u8868\uff08metadata table\uff09\u7ba1\u7406\u800c\u8a00\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u77e5\u9053\u201c\u6bcf\u4e00\u6b21\u8bbf\u95ee\u7684\u5177\u4f53\u5730\u5740\u662f\u4ec0\u4e48\u201d\uff0c\u800c\u53ea\u9700\u8981\u77e5\u9053\u201c\u67d0\u4e2a\u7a0b\u5e8f\u70b9\uff08PC\uff09\u53d1\u8d77\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u6574\u4f53\u4e0a\u6709\u591a\u51c6\u201d\u4ee5\u53ca\u201c\u6574\u4e2a\u7a0b\u5e8f\u6700\u591a\u9700\u8981\u591a\u5c11\u5143\u6570\u636e\u6761\u76ee\u201d\u3002\u7528 trace \u6765\u56de\u7b54\u8fd9\u79cd\u805a\u5408\u6027\u95ee\u9898\uff0c\u6548\u7387\u6781\u4f4e\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u8981\u8bc4\u4f30\u4e00\u4e2a\u9500\u552e\u5458\uff08\u5bf9\u5e94\u4e00\u4e2a memory instruction/PC\uff09\u7684\u4e1a\u7ee9\uff0c\u4ee5\u51b3\u5b9a\u662f\u5426\u7ed9\u4ed6\u5206\u914d\u66f4\u591a\u8d44\u6e90\u3002   - \u4f20\u7edf Trace \u65b9\u6cd5\uff1a\u5c31\u50cf\u6d3e\u4e00\u4e2a\u79d8\u4e66\u8ddf\u7740\u4ed6\uff0c\u628a\u4ed6\u6bcf\u5929\u6253\u7684\u6bcf\u4e00\u4e2a\u7535\u8bdd\u3001\u89c1\u7684\u6bcf\u4e00\u4e2a\u5ba2\u6237\u3001\u8bf4\u7684\u6bcf\u4e00\u53e5\u8bdd\u90fd\u5f55\u4e0b\u6765\u3002\u6708\u5e95\u518d\u56de\u653e\u6240\u6709\u5f55\u97f3\uff0c\u7edf\u8ba1\u6210\u5355\u7387\u3002\u8fd9\u5de5\u4f5c\u91cf\u5927\u5230\u79bb\u8c31\u3002   - Prophet \u7684 Counter-Based Profiling\uff1a\u5c31\u50cf\u76f4\u63a5\u7ed9\u9500\u552e\u5458\u914d\u4e00\u4e2a\u667a\u80fd\u8ba1\u6570\u5668\u3002\u6bcf\u5f53\u4ed6\u6210\u529f\u7b7e\u5355\uff08useful prefetch\uff09\uff0c\u8ba1\u6570\u5668+1\uff1b\u6bcf\u5f53\u4ed6\u767d\u8dd1\u4e00\u8d9f\uff08useful prefetch\uff09\uff0c\u53e6\u4e00\u4e2a\u8ba1\u6570\u5668+1\u3002\u6708\u5e95\u4f60\u53ea\u9700\u8981\u770b\u8fd9\u4e24\u4e2a\u6570\u5b57\uff0c\u5c31\u80fd\u7acb\u523b\u7b97\u51fa\u4ed6\u7684\u6210\u5355\u7387\uff08prefetching accuracy\uff09\u3002\u7b80\u5355\u3001\u9ad8\u6548\u3001\u5f00\u9500\u51e0\u4e4e\u4e3a\u96f6\u3002 - \u8fd9\u672c\u8d28\u4e0a\u662f\u4e00\u79cd\u4ece\u201c\u8fc7\u7a0b\u76d1\u63a7\u201d\u5230\u201c\u7ed3\u679c\u7edf\u8ba1\u201d\u7684\u601d\u7ef4\u8f6c\u53d8\uff0c\u5229\u7528\u4e86\u73b0\u4ee3\u5904\u7406\u5668\u5185\u7f6e\u7684 Performance Monitoring Unit (PMU) \u8fd9\u4e2a\u73b0\u6210\u7684\u201c\u8ba1\u6570\u5668\u786c\u4ef6\u201d\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") \u4f5c\u8005\u5e76\u6ca1\u6709\u53bb\u8bb0\u5f55\u7e41\u6742\u7684\u5185\u5b58\u8bbf\u95ee\u5e8f\u5217\uff0c\u800c\u662f\u5de7\u5999\u5730\u5229\u7528\u4e86\u5904\u7406\u5668\u5df2\u6709\u7684\u786c\u4ef6\u6027\u80fd\u76d1\u63a7\u80fd\u529b\uff0c\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u5bf9\u51e0\u4e2a\u5173\u952e\u4e8b\u4ef6\u7684\u8ba1\u6570\uff1a</p> <ul> <li>\u6838\u5fc3\u6d1e\u5bdf\uff1a\u9884\u53d6\u5668\u7684\u6709\u6548\u6027\u53ef\u4ee5\u88ab\u5206\u89e3\u4e3a\u4e24\u4e2a\u53ef\u8ba1\u6570\u7684\u786c\u4ef6\u4e8b\u4ef6\uff1a</li> <li><code>MEM_LOAD_RETIRED.L2_Prefetch_Issue</code>\uff1aL2 \u9884\u53d6\u5668\u53d1\u51fa\u4e86\u591a\u5c11\u6b21\u9884\u53d6\u8bf7\u6c42\u3002</li> <li><code>MEM_LOAD_RETIRED.L2_Prefetch_Useful</code>\uff1a\u8fd9\u4e9b\u9884\u53d6\u8bf7\u6c42\u4e2d\u6709\u591a\u5c11\u6b21\u88ab\u540e\u6765\u7684\u5b9e\u9645\u5185\u5b58\u8bbf\u95ee\u547d\u4e2d\u4e86\u3002</li> <li>\u5b9e\u73b0\u624b\u6cd5\uff1a</li> <li>\u5229\u7528 Processor Event-Based Sampling (PEBS) \u6280\u672f\uff0c\u5728\u4e0a\u8ff0\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u786c\u4ef6\u4f1a\u81ea\u52a8\u6355\u83b7\u5f53\u65f6\u7684 Program Counter (PC)\u3002</li> <li>\u901a\u8fc7\u79bb\u7ebf\u5206\u6790\u8fd9\u4e9b\u5e26 PC \u6807\u7b7e\u7684\u4e8b\u4ef6\u8ba1\u6570\uff0c\u53ef\u4ee5\u8f7b\u677e\u8ba1\u7b97\u51fa\u6bcf\u4e2a PC \u7684\u9884\u53d6\u51c6\u786e\u7387\uff1a<code>Useful Count / Issue Count</code>\u3002</li> <li>\u5bf9\u4e8e\u5143\u6570\u636e\u8868\u5927\u5c0f\uff0c\u53ea\u9700\u7528\u6807\u51c6 PMU \u8ba1\u6570\u5668\u8bb0\u5f55\u6574\u4e2a\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u7684\u603b\u63d2\u5165\u6b21\u6570\u548c\u603b\u66ff\u6362\u6b21\u6570\uff0c\u5373\u53ef\u63a8\u7b97\u51fa\u5cf0\u503c\u4f7f\u7528\u91cf\u3002</li> <li>\u8fd9\u79cd\u65b9\u6cd5\u5b8c\u5168\u89c4\u907f\u4e86 trace \u7684\u5f00\u9500\uff0c\u4f7f\u5f97 Profiling \u53d8\u5f97\u6781\u5176 lightweight\u3002\u5982\u8bba\u6587\u6240\u8ff0\uff0c\u5176 Profiling \u5f00\u9500\u5c0f\u4e8e 2%\uff0c\u5e76\u4e14\u53ef\u4ee5\u53ea\u5728\u5c11\u6570\u51e0\u6b21\u8fd0\u884c\u4e2d\u8fdb\u884c\uff0c\u4e4b\u540e\u751f\u6210\u7684\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\u4fbf\u53ef\u957f\u671f\u53d7\u76ca\u3002</li> </ul> <p></p> <p>Figure 5: Prophet process overview. Step1: Prophet leverages the PMU to gather counters related to the temporal prefetcher\u2019s performance. Step2: Prophet analyzes the collected counters to generate hints and then injects hints into the original binaries. Step 3: Prophet samples and learns counters across different program inputs.</p> <p>\u8fd9\u79cd\u65b9\u6cd5\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u6ca1\u6709\u8981\u6c42\u4efb\u4f55\u65b0\u7684\u786c\u4ef6\u652f\u6301\uff0c\u800c\u662f\u521b\u9020\u6027\u5730\u7ec4\u5408\u4f7f\u7528\u4e86\u73b0\u6709\u67b6\u6784\u4e2d\u88ab\u5ffd\u89c6\u7684 PMU/PEBS \u80fd\u529b\uff0c\u4ee5\u6781\u5c0f\u7684\u4ee3\u4ef7\u83b7\u53d6\u4e86\u6307\u5bfc\u9ad8\u7ea7\u4f18\u5316\u6240\u9700\u7684\u5168\u90e8\u5173\u952e\u4fe1\u606f\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/","title":"Profile-Guided Temporal Prefetching \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-1-the-bottom-figure-shows-a-metadata-access-pattern-1-bluered-dots-are-metadata-accesses-that-result-in-usefuluseless-prefetches-2-bluered-stars-represent-first-metadata-access-withwithout-temporal-patterns-their-corresponding-metadata-shouldshould-not-be-inserted-in-the-metadata-table-the-top-figure-shows-how-triangel-7-applies-its-patternconf-to-the-highlighted-metadata-access-pattern","title":"Figure 1: The bottom figure shows a metadata access pattern: 1) Blue/Red dots are metadata accesses that result in useful/useless prefetches; 2) Blue/Red stars represent first metadata access with/without temporal patterns. Their corresponding metadata should/should not be inserted in the metadata table. The top figure shows how Triangel [7] applies its PatternConf to the highlighted metadata access pattern.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Triangel \u786c\u4ef6\u65f6\u95f4\u9884\u53d6\u5668\u5728\u5904\u7406\u5143\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u65f6\u7684\u51b3\u7b56\u673a\u5236\uff0c\u5206\u4e3a\u4e0a\u4e0b\u4e24\u4e2a\u90e8\u5206\uff1a\u4e0a\u90e8\u4e3a PatternConf \u52a8\u6001\u53d8\u5316\u66f2\u7ebf\uff0c\u4e0b\u90e8\u4e3a\u5143\u6570\u636e\u91cd\u7528\u8ddd\u79bb\u968f\u6267\u884c\u65f6\u95f4\u7684\u5206\u5e03\u56fe\u3002</li> <li>\u4e0a\u90e8\u56fe\u8868\u4e2d\uff0cPatternConf \u662f\u4e00\u4e2a 4 \u4f4d\u8ba1\u6570\u5668\uff0c\u7528\u4e8e\u8bc4\u4f30\u672a\u6765\u5185\u5b58\u8bbf\u95ee\u662f\u5426\u5177\u5907\u65f6\u95f4\u6a21\u5f0f\u3002\u5176\u503c\u968f\u6709\u7528\uff08\u84dd\u8272\u70b9\uff09\u548c\u65e0\u7528\uff08\u7ea2\u8272\u70b9\uff09\u5143\u6570\u636e\u8bbf\u95ee\u52a8\u6001\u8c03\u6574\uff1a\u6709\u7528\u8bbf\u95ee\u589e\u52a0\u8ba1\u6570\uff0c\u65e0\u7528\u8bbf\u95ee\u51cf\u5c11\u8ba1\u6570\u3002\u5f53 PatternConf \u4f4e\u4e8e\u9608\u503c\uff08threshold\uff09\uff0cTriangel \u4f1a\u7981\u7528\u5143\u6570\u636e\u63d2\u5165\u4e0e\u9884\u53d6\u3002</li> <li>\u4e0b\u90e8\u56fe\u8868\u4e2d\uff0c\u6a2a\u8f74\u4e3a Execution Time\uff0c\u7eb5\u8f74\u4e3a Metadata Reuse Distance\u3002\u56fe\u4e2d\u5305\u542b\u56db\u79cd\u6807\u8bb0\uff1a</li> <li>\u84dd\u8272\u5706\u70b9\uff1a\u5bfc\u81f4\u6709\u7528\u9884\u53d6\u7684\u5143\u6570\u636e\u8bbf\u95ee\u3002</li> <li>\u7ea2\u8272\u5706\u70b9\uff1a\u5bfc\u81f4\u65e0\u7528\u9884\u53d6\u7684\u5143\u6570\u636e\u8bbf\u95ee\u3002</li> <li>\u84dd\u8272\u661f\u53f7\uff1a\u9996\u6b21\u8bbf\u95ee\u4e14\u5177\u6709\u65f6\u95f4\u6a21\u5f0f\u7684\u5143\u6570\u636e\uff0c\u5e94\u88ab\u63d2\u5165\u5143\u6570\u636e\u8868\u3002</li> <li>\u7ea2\u8272\u661f\u53f7\uff1a\u9996\u6b21\u8bbf\u95ee\u4f46\u65e0\u65f6\u95f4\u6a21\u5f0f\u7684\u5143\u6570\u636e\uff0c\u4e0d\u5e94\u88ab\u63d2\u5165\u3002</li> <li>\u5728\u9ad8\u4eae\u533a\u57df\uff08\u6a59\u8272\u6846\uff09\uff0c\u591a\u4e2a\u7ea2\u8272\u70b9\u5bc6\u96c6\u51fa\u73b0\uff0c\u5bfc\u81f4 PatternConf \u5feb\u901f\u4e0b\u964d\u81f3 0\uff0c\u89e6\u53d1\u201cnot insert metadata + not prefetch\u201d\u72b6\u6001\u3002\u6b64\u65f6\uff0c\u5373\u4f7f\u540e\u7eed\u51fa\u73b0\u84dd\u8272\u661f\u53f7\uff08\u5e94\u63d2\u5165\u7684\u9996\u6b21\u8bbf\u95ee\uff09\uff0c\u4e5f\u4f1a\u88ab\u9519\u8bef\u62d2\u7edd\uff0c\u9020\u6210\u8bef\u8fc7\u6ee4\u3002</li> <li>\u8be5\u56fe\u63ed\u793a\u4e86 Triangel \u7684\u6838\u5fc3\u7f3a\u9677\uff1a\u4f9d\u8d56\u77ed\u671f\u6570\u636e\u66f4\u65b0 PatternConf\uff0c\u65e0\u6cd5\u9002\u5e94\u5143\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u7684\u9ad8\u5ea6\u52a8\u6001\u6027\u4e0e\u91cd\u7528\u8ddd\u79bb\u7684\u5927\u8303\u56f4\u6ce2\u52a8\uff0c\u4ece\u800c\u727a\u7272\u4e86\u6f5c\u5728\u7684\u6709\u6548\u9884\u53d6\u673a\u4f1a\u3002</li> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5143\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u9ad8\u5ea6\u4ea4\u9519\uff0c\u84dd\u7ea2\u70b9\u9891\u7e41\u4ea4\u66ff\u3002</li> <li>\u91cd\u7528\u8ddd\u79bb\u8de8\u5ea6\u6781\u5927\uff0c\u4ece\u63a5\u8fd1 0 \u5230\u8d85\u8fc7 300,000\u3002</li> <li>Triangel \u7684\u9759\u6001\u9608\u503c\u673a\u5236\u5728\u52a8\u6001\u8d1f\u8f7d\u4e0b\u8868\u73b0\u50f5\u5316\uff0c\u6613\u56e0\u77ed\u671f\u566a\u58f0\u5bfc\u81f4\u957f\u671f\u6027\u80fd\u635f\u5931\u3002</li> </ul> \u6807\u8bb0\u7c7b\u578b \u989c\u8272/\u5f62\u72b6 \u542b\u4e49 \u662f\u5426\u5e94\u63d2\u5165\u5143\u6570\u636e\u8868 Useful Metadata Access \u84dd\u8272\u5706\u70b9 \u5bfc\u81f4\u6709\u7528\u9884\u53d6 \u662f Useless Metadata Access \u7ea2\u8272\u5706\u70b9 \u5bfc\u81f4\u65e0\u7528\u9884\u53d6 \u5426 First Metadata Access with Temporal Pattern \u84dd\u8272\u661f\u53f7 \u9996\u6b21\u8bbf\u95ee\u4e14\u5177\u65f6\u95f4\u6a21\u5f0f \u662f First Metadata Access w/o Temporal Pattern \u7ea2\u8272\u661f\u53f7 \u9996\u6b21\u8bbf\u95ee\u4f46\u65e0\u65f6\u95f4\u6a21\u5f0f \u5426 <ul> <li>\u8be5\u56fe\u662f Prophet \u63d0\u51fa\u52a8\u673a\u7684\u5173\u952e\u4f9d\u636e\uff0c\u8bf4\u660e\u73b0\u6709\u786c\u4ef6\u65b9\u6848\u65e0\u6cd5\u6709\u6548\u7ba1\u7406\u5143\u6570\u636e\u8868\uff0c\u9700\u5f15\u5165\u57fa\u4e8e\u7a0b\u5e8f\u884c\u4e3a\u5206\u6790\u7684 Profile-Guided \u65b9\u6cd5\u4ee5\u63d0\u5347\u51c6\u786e\u6027\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-2-comparison-between-prophet-and-prior-profileguided-solutions-prophet-is-lightweight-as-it-only-uses-counters-for-profiling-prophet-can-integrate-counters-from-multiple-inputs-enabling-it-to-adapt-to-varying-program-inputs","title":"Figure 2: Comparison between Prophet and prior profileguided solutions. Prophet is lightweight as it only uses counters for profiling. Prophet can integrate counters from multiple inputs, enabling it to adapt to varying program inputs.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prophet \u4e0e\u4f20\u7edf profile-guided solutions \u5728\u5904\u7406\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u65f6\u7684\u5bf9\u6bd4\u6d41\u7a0b\uff0c\u6838\u5fc3\u5728\u4e8e \u8f7b\u91cf\u7ea7\u8ba1\u6570\u5668\u5206\u6790 \u4e0e \u591a\u8f93\u5165\u81ea\u9002\u5e94\u80fd\u529b\u3002</li> <li>\u5de6\u4fa7\u4e3a\u901a\u7528\u6d41\u7a0b\uff1a\u7a0b\u5e8f\u63a5\u6536\u8f93\u5165 <code>x</code> \u540e\u751f\u6210\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u8fdb\u5165 Profile \u9636\u6bb5\uff0c\u53ef\u9009\u62e9\u4f7f\u7528 Trace\uff08GB \u7ea7\uff09\u6216 Counter\uff08B \u7ea7\uff09\u8fdb\u884c\u5206\u6790\uff0c\u6700\u7ec8\u901a\u8fc7 Analyze &amp; Inject hint \u751f\u6210\u4f18\u5316\u4e8c\u8fdb\u5236\u3002</li> <li>\u53f3\u4fa7\u5bf9\u6bd4\u5206\u4e3a\u4e24\u90e8\u5206\uff1a</li> <li>Prior works\uff08\u7ea2\u8272\u533a\u57df\uff09\uff1a\u5f53\u8f93\u5165\u4ece <code>x</code> \u53d8\u4e3a <code>y</code> \u65f6\uff0c\u9700\u91cd\u65b0\u6267\u884c\u5b8c\u6574 Re-Profile (Trace y) \u6d41\u7a0b\uff0c\u5bfc\u81f4\u6027\u80fd\u6b21\u4f18\uff08Sub-optimal Performance\uff09\uff0c\u4e14\u65e0\u6cd5\u590d\u7528\u5386\u53f2\u6570\u636e\u3002</li> <li>Prophet\uff08\u7eff\u8272\u533a\u57df\uff09\uff1a\u91c7\u7528 Learn (Counter x+y) \u673a\u5236\uff0c\u76f4\u63a5\u5408\u5e76\u65b0\u65e7\u8ba1\u6570\u5668\u6570\u636e\uff0c\u65e0\u9700\u91cd\u65b0\u8ffd\u8e2a\uff0c\u751f\u6210\u7684 New Binary (x+y) \u80fd\u5b9e\u73b0\u6700\u4f18\u6027\u80fd\uff08Optimal Performance\uff09\u3002</li> <li>\u5173\u952e\u4f18\u52bf\u4f53\u73b0\u5728\uff1a</li> <li>\u8f7b\u91cf\u7ea7\uff1a\u4ec5\u4f9d\u8d56 Counter\uff08\u5b57\u8282\u7ea7\uff09\uff0c\u907f\u514d Trace\uff08GB\u7ea7\uff09\u5e26\u6765\u7684\u5b58\u50a8\u4e0e\u6027\u80fd\u5f00\u9500\u3002</li> <li>\u81ea\u9002\u5e94\uff1a\u652f\u6301 \u591a\u8f93\u5165\u6570\u636e\u878d\u5408\uff0c\u4f7f\u5355\u4e00\u4f18\u5316\u4e8c\u8fdb\u5236\u80fd\u9002\u914d\u4e0d\u540c\u8f93\u5165\u573a\u666f\u3002</li> <li>\u5bf9\u6bd4\u603b\u7ed3\u8868\uff1a</li> </ul> \u7279\u6027 Prior Works Prophet Profile \u6570\u636e\u7c7b\u578b Trace (~GB) Counter (~B) \u591a\u8f93\u5165\u5904\u7406\u65b9\u5f0f Re-profile (\u72ec\u7acb\u8ffd\u8e2a) Learn (\u5408\u5e76\u8ba1\u6570\u5668) \u6027\u80fd\u7ed3\u679c Sub-optimal Optimal \u8d44\u6e90\u5f00\u9500 \u9ad8\uff08\u5b58\u50a8\u3001\u65f6\u95f4\uff09 \u4f4e\uff08\u4ec5\u8ba1\u6570\u5668\uff09 \u9002\u7528\u6027 \u5355\u4e00\u8f93\u5165\u573a\u666f \u591a\u53d8\u8f93\u5165\u573a\u666f <ul> <li>\u8be5\u56fe\u76f4\u89c2\u4f53\u73b0\u4e86 Prophet \u7684\u4e24\u5927\u521b\u65b0\u70b9\uff1a\u8f7b\u91cf\u5316\u8bbe\u8ba1 \u4e0e \u52a8\u6001\u5b66\u4e60\u80fd\u529b\uff0c\u4f7f\u5176\u5728\u5b9e\u9645\u90e8\u7f72\u4e2d\u66f4\u5177\u53ef\u884c\u6027\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-3-a-general-framework-of-temporal-prefetching","title":"Figure 3: A general framework of temporal prefetching.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Temporal Prefetching \u7684\u901a\u7528\u6846\u67b6\uff0c\u5206\u4e3a Training Phase \u548c Prediction Phase \u4e24\u4e2a\u9636\u6bb5\u3002</li> <li>\u5728 Training Phase \u4e2d\uff0c\u7cfb\u7edf\u8bb0\u5f55\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\u4e0e\u5185\u5b58\u5730\u5740\u7684\u8bbf\u95ee\u5e8f\u5217\uff0c\u4f8b\u5982 <code>PC1, Addr1</code>\u3001<code>PC1, Addr2</code>\u3001<code>PC1, Addr3</code>\uff0c\u5e76\u6309\u65f6\u95f4\u987a\u5e8f\u5b58\u50a8\u5230 L3 cache (Metadata Table) \u4e2d\u3002</li> <li>L2 cache (Temporal Prefetcher) \u4f5c\u4e3a\u4e2d\u95f4\u5c42\uff0c\u8d1f\u8d23\u4ece L3 cache \u83b7\u53d6\u5143\u6570\u636e\uff0c\u5e76\u5728\u9884\u6d4b\u9636\u6bb5\u4f7f\u7528\u8fd9\u4e9b\u6570\u636e\u8fdb\u884c\u9884\u53d6\u64cd\u4f5c\u3002</li> <li>\u5728 Prediction Phase \u4e2d\uff0c\u5f53\u7a0b\u5e8f\u518d\u6b21\u8bbf\u95ee <code>Addr1</code> \u65f6\uff0c\u7cfb\u7edf\u6839\u636e\u4e4b\u524d\u5b58\u50a8\u7684\u6a21\u5f0f\u9884\u6d4b\u4e0b\u4e00\u4e2a\u53ef\u80fd\u88ab\u8bbf\u95ee\u7684\u5730\u5740\uff0c\u5982 <code>Addr2</code> \u548c <code>Addr3</code>\uff0c\u5e76\u63d0\u524d\u5c06\u5176\u52a0\u8f7d\u5230\u7f13\u5b58\u4e2d\u3002</li> <li>\u56fe\u4e2d\u7528\u4e0d\u540c\u989c\u8272\u533a\u5206\u529f\u80fd\u6a21\u5757\uff1a\u7ea2\u8272\u533a\u57df\u8868\u793a Store \u64cd\u4f5c\uff0c\u7eff\u8272\u533a\u57df\u8868\u793a Predict \u64cd\u4f5c\uff0c\u6e05\u6670\u5730\u5212\u5206\u4e86\u8bad\u7ec3\u548c\u9884\u6d4b\u7684\u529f\u80fd\u8fb9\u754c\u3002</li> <li>\u5143\u6570\u636e\u8868\uff08Metadata Table\uff09\u4f4d\u4e8e L3 cache\uff0c\u7528\u4e8e\u957f\u671f\u5b58\u50a8\u8bbf\u95ee\u6a21\u5f0f\uff0c\u800c L2 cache \u5219\u8d1f\u8d23\u5b9e\u65f6\u5904\u7406\u548c\u9884\u6d4b\uff0c\u4f53\u73b0\u4e86\u786c\u4ef6\u5c42\u7ea7\u5206\u5de5\u7684\u8bbe\u8ba1\u7406\u5ff5\u3002</li> <li>\u6574\u4e2a\u6846\u67b6\u5f3a\u8c03\u4e86 \u65f6\u95f4\u5c40\u90e8\u6027 \u7684\u5229\u7528\uff0c\u901a\u8fc7\u8bb0\u5f55\u5386\u53f2\u8bbf\u95ee\u6a21\u5f0f\u6765\u9884\u6d4b\u672a\u6765\u8bbf\u95ee\uff0c\u4ece\u800c\u51cf\u5c11\u5185\u5b58\u5ef6\u8fdf\u3002</li> </ul> \u9636\u6bb5 \u4e3b\u8981\u529f\u80fd \u5173\u952e\u7ec4\u4ef6 Training Phase \u8bb0\u5f55 PC \u4e0e\u5730\u5740\u7684\u8bbf\u95ee\u5e8f\u5217 L3 cache (Metadata Table) Prediction Phase \u6839\u636e\u5386\u53f2\u6a21\u5f0f\u9884\u6d4b\u672a\u6765\u8bbf\u95ee\u5730\u5740 L2 cache (Temporal Prefetcher) <ul> <li>\u8be5\u6846\u67b6\u7684\u6838\u5fc3\u5728\u4e8e Metadata Table \u7684\u9ad8\u6548\u7ba1\u7406\uff0c\u786e\u4fdd\u53ea\u5b58\u50a8\u6709\u7528\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u907f\u514d\u5197\u4f59\u6570\u636e\u5360\u7528\u6709\u9650\u7684\u7f13\u5b58\u8d44\u6e90\u3002</li> <li>\u56fe\u4e2d\u672a\u660e\u786e\u63d0\u53ca\u5177\u4f53\u7684\u63d2\u5165\u6216\u66ff\u6362\u7b56\u7565\uff0c\u4f46\u6697\u793a\u4e86\u9700\u8981\u667a\u80fd\u7b97\u6cd5\u6765\u51b3\u5b9a\u54ea\u4e9b\u5143\u6570\u636e\u5e94\u88ab\u4fdd\u7559\u6216\u6dd8\u6c70\uff0c\u4ee5\u4f18\u5316\u9884\u53d6\u6548\u679c\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-4-prophet-architecture-overview-prophet-coexists-with-hardware-temporal-prefetchers-by-sharing-the-same-metadata-table-but-leveraging-more-accurate-profile-guided-methods-for-metadata-table-management","title":"Figure 4: Prophet architecture overview. Prophet coexists with hardware temporal prefetchers by sharing the same metadata table but leveraging more accurate profile-guided methods for metadata table management.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prophet \u67b6\u6784\u7684\u6982\u89c8\uff0c\u5176\u6838\u5fc3\u8bbe\u8ba1\u662f\u4e0e\u73b0\u6709\u786c\u4ef6\u65f6\u5e8f\u9884\u53d6\u5668\uff08\u5982 Triangel\uff09\u5171\u5b58\uff0c\u901a\u8fc7\u5171\u4eab\u540c\u4e00 Metadata Table\uff0c\u4f46\u7528\u66f4\u7cbe\u786e\u7684 profile-guided \u65b9\u6cd5\u7ba1\u7406\u5143\u6570\u636e\u8868\u3002</li> <li>\u6574\u4f53\u6d41\u7a0b\u4ece Demand Request \u5f00\u59cb\uff0c\u7ecf\u8fc7\u4e09\u4e2a\u5173\u952e\u7ba1\u7406\u6a21\u5757\uff1aInsertion Policy\u3001Replacement Policy \u548c Resizing\uff0c\u6700\u7ec8\u4f5c\u7528\u4e8e Metadata Table\u3002</li> <li>Prophet Insertion Policy \u7531 Hint \u9a71\u52a8\uff0c\u51b3\u5b9a\u662f\u5426\u5c06\u5f53\u524d\u8bf7\u6c42\u63d2\u5165\u5143\u6570\u636e\u8868\u3002\u5f53\u542f\u7528 Prophet \u65f6\uff0c\u4f1a\u7981\u7528 Runtime Insertion Policy\uff0c\u5e76\u901a\u8fc7\u4e00\u4e2a\u83f1\u5f62\u51b3\u7b56\u6846 \u201cProphet &gt; Runtime\u201d \u5224\u65ad\u4f18\u5148\u7ea7\u3002</li> <li>Prophet Replacement Policy \u540c\u6837\u4f9d\u8d56 Hint\uff0c\u5e76\u7ef4\u62a4\u4e00\u4e2a Prophet Replacement State\u3002\u5b83\u9996\u5148\u751f\u6210\u5019\u9009\u53d7\u5bb3\u8005\uff08Victim Candidates\uff09\uff0c\u518d\u4ea4\u7531 Runtime Replacement Policy \u505a\u6700\u7ec8\u9009\u62e9\uff0c\u540c\u65f6\u66f4\u65b0 Runtime Replacement State\u3002</li> <li>Prophet Resizing \u7531 CSR \u63a7\u5236\uff0c\u5728\u7a0b\u5e8f\u542f\u52a8\u65f6\u914d\u7f6e\u5143\u6570\u636e\u8868\u5927\u5c0f\u3002\u540c\u6837\uff0c\u542f\u7528 Prophet \u65f6\u4f1a\u7981\u7528 Runtime Resizing\uff0c\u5e76\u901a\u8fc7 \u201cProphet &gt; Runtime\u201d \u51b3\u7b56\u6846\u5207\u6362\u3002</li> <li>\u6240\u6709 Prophet \u7ec4\u4ef6\uff08\u7eff\u8272\u65b9\u6846\uff09\u5747\u57fa\u4e8e\u79bb\u7ebf\u5206\u6790\u751f\u6210\u7684\u63d0\u793a\u4fe1\u606f\uff0c\u800c Runtime \u7ec4\u4ef6\uff08\u7ea2\u8272\u65b9\u6846\uff09\u4ee3\u8868\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u7684\u539f\u751f\u7b56\u7565\u3002</li> <li>\u7cfb\u7edf\u652f\u6301\u7075\u6d3b\u5207\u6362\uff1a\u5728\u9891\u7e41\u6267\u884c\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u4f7f\u7528 Prophet \u4ee5\u83b7\u5f97\u9ad8\u6027\u80fd\uff1b\u5728\u4e0d\u5e38\u6267\u884c\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u56de\u9000\u5230 Runtime \u65b9\u6848\uff0c\u4fdd\u6301\u517c\u5bb9\u6027\u3002</li> <li>\u5173\u952e\u8def\u5f84\u5305\u62ec\uff1a</li> <li>\u63d2\u5165\u8def\u5f84\uff1aDemand Request \u2192 Hint \u2192 Prophet Insertion Policy \u2192 Metadata Table</li> <li>\u66ff\u6362\u8def\u5f84\uff1aDemand Request \u2192 Hint \u2192 Prophet Replacement Policy \u2192 Prophet Replacement State \u2192 Victim Candidates \u2192 Runtime Replacement Policy \u2192 Metadata Table</li> <li>\u8c03\u6574\u8def\u5f84\uff1aCSR \u2192 Prophet Resizing \u2192 Resize \u2192 Metadata Table</li> </ul> \u6a21\u5757\u7c7b\u578b \u7ec4\u4ef6\u540d\u79f0 \u9a71\u52a8\u6e90 \u529f\u80fd\u63cf\u8ff0 Prophet Prophet Insertion Policy Hint \u6839\u636e\u63d0\u793a\u51b3\u5b9a\u662f\u5426\u63d2\u5165\u5143\u6570\u636e\uff0c\u66ff\u4ee3 Runtime Insertion Policy Prophet Prophet Replacement Policy Hint \u751f\u6210\u66ff\u6362\u5019\u9009\uff0c\u914d\u5408 Runtime Replacement Policy \u5b8c\u6210\u66ff\u6362 Prophet Prophet Resizing CSR \u5728\u7a0b\u5e8f\u542f\u52a8\u65f6\u8bbe\u7f6e\u5143\u6570\u636e\u8868\u5927\u5c0f\uff0c\u66ff\u4ee3 Runtime Resizing Runtime Runtime Insertion Policy \u2014 \u539f\u751f\u63d2\u5165\u7b56\u7565\uff0c\u88ab Prophet \u7981\u7528 Runtime Runtime Replacement Policy \u2014 \u539f\u751f\u66ff\u6362\u7b56\u7565\uff0c\u63a5\u6536 Prophet \u63d0\u4f9b\u7684\u5019\u9009 Runtime Runtime Resizing \u2014 \u539f\u751f\u8c03\u6574\u7b56\u7565\uff0c\u88ab Prophet \u7981\u7528 <ul> <li>\u56fe\u4e2d\u865a\u7ebf\u6846\u8868\u793a\u53ef\u9009\u6216\u53ef\u5207\u6362\u7684\u7ec4\u4ef6\uff0c\u5b9e\u7ebf\u7bad\u5934\u8868\u793a\u6570\u636e\u6d41\u6216\u63a7\u5236\u6d41\uff0c\u83f1\u5f62\u6846\u8868\u793a\u51b3\u7b56\u70b9\u3002</li> <li>Prophet \u7684\u4f18\u52bf\u5728\u4e8e\u5229\u7528\u79bb\u7ebf\u5206\u6790\u7ed3\u679c\uff08Hint/CSR\uff09\u6307\u5bfc\u8fd0\u884c\u65f6\u884c\u4e3a\uff0c\u907f\u514d\u4e86\u786c\u4ef6\u5b9e\u65f6\u5206\u6790\u7684\u5f00\u9500\uff0c\u540c\u65f6\u4fdd\u7559\u4e86\u5bf9\u590d\u6742\u65f6\u5e8f\u6a21\u5f0f\u7684\u652f\u6301\u80fd\u529b\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-5-prophet-process-overview-step1-prophet-leverages-the-pmu-to-gather-counters-related-to-the-temporal-prefetchers-performance-step2-prophet-analyzes-the-collected-counters-to-generate-hints-and-then-injects-hints-into-the-original-binaries-step-3-prophet-samples-and-learns-counters-across-different-program-inputs","title":"Figure 5: Prophet process overview. Step1: Prophet leverages the PMU to gather counters related to the temporal prefetcher\u2019s performance. Step2: Prophet analyzes the collected counters to generate hints and then injects hints into the original binaries. Step 3: Prophet samples and learns counters across different program inputs.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prophet \u6846\u67b6\u7684\u4e09\u9636\u6bb5\u5904\u7406\u6d41\u7a0b\uff0c\u5206\u522b\u4e3a Step1: Profiling\u3001Step2: Analysis \u548c Step3: Learning\uff0c\u6784\u6210\u4e00\u4e2a\u95ed\u73af\u4f18\u5316\u7cfb\u7edf\u3002</li> <li>Step1: Profiling \u9636\u6bb5\u4e2d\uff0c\u539f\u59cb Binary \u901a\u8fc7\u8fd0\u884c Simplified TP\uff08\u7b80\u5316\u7248 Temporal Prefetcher\uff09\u6536\u96c6\u6027\u80fd\u8ba1\u6570\u5668\uff08Counter\uff09\uff0c\u8fd9\u4e9b Counter \u53cd\u6620\u4e86\u5728\u65e0\u989d\u5916\u4f18\u5316\u524d\u63d0\u4e0b\u7684\u5185\u5b58\u8bbf\u95ee\u884c\u4e3a\u3002</li> <li>Step2: Analysis \u9636\u6bb5\u5bf9\u6536\u96c6\u5230\u7684 Counter \u8fdb\u884c\u79bb\u7ebf\u5206\u6790\uff0c\u751f\u6210\u4e24\u7c7b Hint\uff1aPC Hint\uff08\u9488\u5bf9\u7279\u5b9a\u7a0b\u5e8f\u8ba1\u6570\u5668\uff09\u548c CSR Hint\uff08\u5168\u5c40\u63a7\u5236\u5bc4\u5b58\u5668\u914d\u7f6e\uff09\uff0c\u968f\u540e\u6ce8\u5165\u5230\u539f\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\uff0c\u5f62\u6210 New Binary\u3002</li> <li>Step3: Learning \u9636\u6bb5\u5f15\u5165\u52a8\u6001\u9002\u5e94\u673a\u5236\uff1a\u5f53\u65b0\u8f93\u5165\uff08New Input\uff09\u51fa\u73b0\u65f6\uff0c\u7cfb\u7edf\u518d\u6b21\u8fd0\u884c Simplified TP \u6536\u96c6 New Counter\uff0c\u5e76\u4e0e\u5386\u53f2\u6570\u636e Merge \u6210 Merged Counter\uff0c\u518d\u53cd\u9988\u81f3 Analysis \u9636\u6bb5\uff0c\u5b9e\u73b0\u6301\u7eed\u4f18\u5316\u3002</li> <li>\u6574\u4e2a\u6d41\u7a0b\u5f3a\u8c03\u201c\u8f7b\u91cf\u7ea7\u201d\u4e0e\u201c\u53ef\u9002\u5e94\u6027\u201d\uff0c\u901a\u8fc7 PMU \u8ba1\u6570\u5668\u800c\u975e\u5168\u8f68\u8ff9\uff08trace\uff09\u91c7\u96c6\u6570\u636e\uff0c\u663e\u8457\u964d\u4f4e\u5f00\u9500\uff1b\u540c\u65f6\u652f\u6301\u591a\u8f93\u5165\u5b66\u4e60\uff0c\u4f7f\u5355\u4e00\u4f18\u5316\u4e8c\u8fdb\u5236\u80fd\u9002\u914d\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u3002</li> <li>\u6d41\u7a0b\u56fe\u4e2d\u7684\u7bad\u5934\u6e05\u6670\u8868\u660e\u6570\u636e\u6d41\u5411\uff1a\u4ece Binary \u2192 Simplified TP \u2192 Counter \u2192 Analyze \u2192 Hint \u2192 Inject \u2192 New Binary \u2192 Run\uff0c\u518d\u5faa\u73af\u81f3 Step3 \u7684 Merge \u73af\u8282\uff0c\u4f53\u73b0\u5176\u81ea\u9002\u5e94\u6f14\u5316\u80fd\u529b\u3002</li> </ul> \u9636\u6bb5 \u8f93\u5165 \u5904\u7406\u6a21\u5757 \u8f93\u51fa \u5173\u952e\u76ee\u6807 Step1: Profiling Binary Simplified TP Counter \u6536\u96c6\u57fa\u7840\u6027\u80fd\u6570\u636e Step2: Analysis Counter Analyze PC Hint / CSR Hint \u751f\u6210\u4f18\u5316\u63d0\u793a\u5e76\u6ce8\u5165\u4e8c\u8fdb\u5236 Step3: Learning New Input + Merged Counter Simplified TP + Merge Updated Merged Counter \u52a8\u6001\u9002\u5e94\u65b0\u8f93\u5165\uff0c\u6301\u7eed\u4f18\u5316\u7b56\u7565 <ul> <li>\u56fe\u4e2d\u4f7f\u7528\u4e0d\u540c\u989c\u8272\u533a\u5206\u6a21\u5757\uff1a\u84dd\u8272\u4ee3\u8868\u6267\u884c/\u5904\u7406\u5355\u5143\uff08\u5982 Binary, Simplified TP\uff09\uff0c\u7d2b\u8272\u4ee3\u8868\u6570\u636e\u5b58\u50a8/\u5408\u5e76\u5355\u5143\uff08\u5982 Counter, Merged Counter\uff09\uff0c\u7ea2\u8272\u6846\u6807\u6ce8\u4e09\u4e2a\u6838\u5fc3\u6b65\u9aa4\uff0c\u89c6\u89c9\u4e0a\u5f3a\u5316\u6d41\u7a0b\u7ed3\u6784\u3002</li> <li>Prophet \u7684\u6838\u5fc3\u521b\u65b0\u70b9\u5728\u4e8e\u5c06 Profile-Guided Optimization \u4e0e\u786c\u4ef6 Temporal Prefetcher \u7ed3\u5408\uff0c\u901a\u8fc7\u8f6f\u4ef6\u5206\u6790\u6307\u5bfc\u786c\u4ef6\u5143\u6570\u636e\u7ba1\u7406\uff0c\u540c\u65f6\u4fdd\u6301\u5bf9\u591a\u8f93\u5165\u573a\u666f\u7684\u9002\u5e94\u80fd\u529b\uff0c\u907f\u514d\u4f20\u7edf PGO \u65b9\u6848\u56e0\u8f93\u5165\u53d8\u5316\u5bfc\u81f4\u5931\u6548\u7684\u95ee\u9898\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-6-the-prefetching-accuracy-of-temporal-prefetching-across-different-memory-instructions-in-omnetpp","title":"Figure 6: The prefetching accuracy of temporal prefetching across different memory instructions in omnetpp.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728 omnetpp \u5de5\u4f5c\u8d1f\u8f7d\u4e0b\uff0c\u4e0d\u540c\u5185\u5b58\u6307\u4ee4\u7684 Prefetching Accuracy \u5206\u5e03\u60c5\u51b5\uff0c\u6a2a\u8f74\u4e3a\u51c6\u786e\u7387\u533a\u95f4\uff080.0 \u5230 1.0\uff09\uff0c\u7eb5\u8f74\u4e3a\u5bf9\u5e94\u533a\u95f4\u7684\u6307\u4ee4\u6570\u91cf\u3002</li> <li>\u6570\u636e\u88ab\u5212\u5206\u4e3a\u4e09\u4e2a\u5c42\u7ea7\uff1aLow Level\uff080.0\u20130.4\uff09\u3001Medium Level\uff080.4\u20130.8\uff09\u3001High Level\uff080.8\u20131.0\uff09\uff0c\u6bcf\u4e2a\u5c42\u7ea7\u7528\u7ea2\u8272\u865a\u7ebf\u6846\u6807\u51fa\uff0c\u4fbf\u4e8e\u533a\u5206\u6027\u80fd\u8868\u73b0\u3002</li> <li>Low Level \u533a\u95f4\u5185\u6307\u4ee4\u6570\u91cf\u6700\u591a\uff0c\u96c6\u4e2d\u5728 0.0\u20130.2 \u548c 0.2\u20130.4 \u4e24\u4e2a\u5b50\u533a\u95f4\uff0c\u8868\u660e\u5927\u91cf\u5185\u5b58\u8bbf\u95ee\u6307\u4ee4\u7684\u9884\u53d6\u51c6\u786e\u7387\u8f83\u4f4e\uff0c\u4e0d\u9002\u5408\u53c2\u4e0e\u5143\u6570\u636e\u8868\u7ba1\u7406\u3002</li> <li>Medium Level \u533a\u95f4\u6307\u4ee4\u5206\u5e03\u8f83\u5747\u5300\uff0c\u5cf0\u503c\u51fa\u73b0\u5728 0.4\u20130.5 \u533a\u95f4\uff0c\u8bf4\u660e\u90e8\u5206\u6307\u4ee4\u5177\u5907\u4e2d\u7b49\u9884\u53d6\u6f5c\u529b\uff0c\u53ef\u4f5c\u4e3a\u4f18\u5316\u91cd\u70b9\u3002</li> <li>High Level \u533a\u95f4\u6307\u4ee4\u6570\u91cf\u8f83\u5c11\u4f46\u96c6\u4e2d\u4e8e 0.8\u20131.0\uff0c\u663e\u793a\u5c11\u6570\u6307\u4ee4\u5177\u6709\u6781\u9ad8\u9884\u53d6\u51c6\u786e\u7387\uff0c\u662f\u63d0\u5347\u6574\u4f53\u6027\u80fd\u7684\u5173\u952e\u76ee\u6807\u3002</li> <li>\u8be5\u56fe\u652f\u6491\u4e86 Prophet \u7684\u8bbe\u8ba1\u539f\u5219\uff1a\u901a\u8fc7 PC-level prefetching accuracy \u5bf9\u6307\u4ee4\u5206\u7c7b\uff0c\u4ece\u800c\u6307\u5bfc\u63d2\u5165\u7b56\u7565\u4e0e\u66ff\u6362\u4f18\u5148\u7ea7\uff0c\u907f\u514d\u4f4e\u6548\u5143\u6570\u636e\u5360\u7528\u5b58\u50a8\u8d44\u6e90\u3002</li> </ul> \u51c6\u786e\u7387\u533a\u95f4 \u6307\u4ee4\u6570\u91cf\u8d8b\u52bf Prophet \u7b56\u7565\u5e94\u7528 0.0\u20130.4 (Low) \u9ad8\u5cf0\u96c6\u4e2d\uff0c\u6570\u91cf\u6700\u591a \u8fc7\u6ee4\u6216\u4f4e\u4f18\u5148\u7ea7\u5904\u7406 0.4\u20130.8 (Medium) \u5206\u5e03\u5747\u5300\uff0c\u4e2d\u7b49\u6570\u91cf \u4e2d\u7b49\u4f18\u5148\u7ea7\uff0c\u52a8\u6001\u8c03\u6574 0.8\u20131.0 (High) \u6570\u91cf\u5c11\u4f46\u96c6\u4e2d \u9ad8\u4f18\u5148\u7ea7\u4fdd\u7559\uff0c\u6700\u5927\u5316\u6536\u76ca <ul> <li>\u6b64\u5206\u5e03\u63ed\u793a\u4e86 Temporal Prefetching \u7684\u5185\u5728\u6311\u6218\uff1a\u6307\u4ee4\u95f4\u51c6\u786e\u7387\u5dee\u5f02\u5927\uff0c\u9700\u7cbe\u7ec6\u5316\u7ba1\u7406\u800c\u975e\u7edf\u4e00\u7b56\u7565\u3002Prophet \u901a\u8fc7 Profile-Guided \u65b9\u6cd5\u5b9e\u73b0\u5bf9\u8fd9\u7c7b\u5f02\u6784\u884c\u4e3a\u7684\u9ad8\u6548\u9002\u914d\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#7c02b23087cf7ba266a85777b00d226d3bba5ff2a1abc6b754dddc73a77c4a37jpg","title":"7c02b23087cf7ba266a85777b00d226d3bba5ff2a1abc6b754dddc73a77c4a37.jpg","text":"<ul> <li>\u56fe\u7247\u5185\u5bb9\u4e3a\u4e00\u4e2a\u6570\u5b66\u516c\u5f0f\uff0c\u7528\u4e8e\u8ba1\u7b97\u5728\u7a0b\u5e8f\u6267\u884c\u7ed3\u675f\u65f6\u5143\u6570\u636e\u8868\uff08metadata table\uff09\u4e2d\u5df2\u5206\u914d\u7684\u6761\u76ee\u6570\uff08Allocated Entries\uff09\u3002</li> <li>\u8be5\u516c\u5f0f\u5b9a\u4e49\u4e3a\uff1aAllocated Entries = Insertions - replacements\u3002</li> <li>\u516c\u5f0f\u4e2d\u7684\u201cInsertions\u201d\u6307\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u5411\u5143\u6570\u636e\u8868\u4e2d\u6210\u529f\u63d2\u5165\u7684\u65b0\u6761\u76ee\u603b\u6570\u3002</li> <li>\u516c\u5f0f\u4e2d\u7684\u201creplacements\u201d\u6307\u5728\u5143\u6570\u636e\u8868\u7a7a\u95f4\u4e0d\u8db3\u65f6\uff0c\u88ab\u66ff\u6362\u51fa\u53bb\u7684\u65e7\u6761\u76ee\u603b\u6570\u3002</li> <li>\u6b64\u516c\u5f0f\u662f Prophet \u6846\u67b6\u4e2d Resizing\uff08\u91cd\u7f6e\u5927\u5c0f\uff09\u7b56\u7565 \u7684\u6838\u5fc3\u4f9d\u636e\uff0c\u7528\u4e8e\u786e\u5b9a\u5143\u6570\u636e\u8868\u6240\u9700\u7684\u6700\u5c0f\u5bb9\u91cf\u3002</li> <li>\u5728 Prophet \u7684\u8bbe\u8ba1\u4e2d\uff0c\u6b64\u503c\u901a\u8fc7\u6807\u51c6 PMU \u8ba1\u6570\u5668\u5728\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u4e2d\u91c7\u6837\u83b7\u5f97\uff0c\u65e0\u9700\u590d\u6742\u7684\u8ffd\u8e2a\u7cfb\u7edf\u3002</li> <li>\u8be5\u65b9\u6cd5\u907f\u514d\u4e86 Triangel \u7b49\u65b9\u6848\u4e2d\u4f7f\u7528 Bloom Filter \u6216 Set Dueller \u5e26\u6765\u7684\u9ad8\u5b58\u50a8\u5f00\u9500\uff08\u5982 &gt;200 KB\uff09\uff0c\u4ec5\u9700\u8bb0\u5f55\u4e24\u4e2a\u8ba1\u6570\u5668\u3002</li> <li>\u6700\u7ec8\uff0cProphet \u4f1a\u6839\u636e\u6b64\u503c\u5411\u4e0a\u53d6\u6574\u5230\u6700\u8fd1\u7684 2 \u7684\u5e42\u6b21\uff0c\u5e76\u7ed3\u5408 Equation 3 \u8ba1\u7b97\u51fa\u5e94\u5206\u914d\u7ed9\u5143\u6570\u636e\u8868\u7684 LLC Way \u6570\u91cf\u3002</li> <li>\u8fd9\u79cd\u57fa\u4e8e\u5b9e\u9645\u8fd0\u884c\u65f6\u7edf\u8ba1\u7684\u65b9\u6cd5\uff0c\u76f8\u6bd4\u9884\u6d4b\u6027\u8c03\u6574\uff0c\u80fd\u66f4\u7cbe\u786e\u5730\u5339\u914d\u5e94\u7528\u9700\u6c42\uff0c\u4ece\u800c\u5728\u4fdd\u8bc1\u6027\u80fd\u7684\u540c\u65f6\u51cf\u5c11\u5bf9 LLC \u7684\u5e72\u6270\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#5ce262bc05d9a59c9b3f8f29f7631a80a388119b86b0db232336c3e95dfa2ba5jpg","title":"5ce262bc05d9a59c9b3f8f29f7631a80a388119b86b0db232336c3e95dfa2ba5.jpg","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u6570\u5b66\u51fd\u6570\u8868\u8fbe\u5f0f\uff0c\u7528\u4e8e\u5b9a\u4e49 Prophet Insertion Policy \u7684\u51b3\u7b56\u903b\u8f91\u3002</li> <li>\u8be5\u51fd\u6570\u540d\u4e3a <code>I(acc)</code>\uff0c\u5176\u8f93\u5165\u53c2\u6570\u4e3a <code>acc</code>\uff0c\u4ee3\u8868\u67d0\u4e2a\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\u5728\u65f6\u95f4\u9884\u53d6\u5668\u4e0b\u7684 prefetching accuracy\u3002</li> <li>\u51fd\u6570\u8f93\u51fa\u4e3a\u4e00\u4e2a\u4e8c\u503c\u7ed3\u679c\uff1a1 \u6216 0\uff0c\u5206\u522b\u5bf9\u5e94\u201c\u5141\u8bb8\u63d2\u5165\u5143\u6570\u636e\u201d\u548c\u201c\u7981\u6b62\u63d2\u5165\u5143\u6570\u636e\u201d\u3002</li> <li>\u5224\u65ad\u6761\u4ef6\u57fa\u4e8e\u4e00\u4e2a\u9884\u8bbe\u7684\u9608\u503c EL_ACC\uff1a</li> <li>\u5f53 <code>acc \u2265 EL_ACC</code> \u65f6\uff0c\u8f93\u51fa\u4e3a 1\uff0c\u8868\u793a\u8be5 PC \u5bf9\u5e94\u7684\u5185\u5b58\u8bbf\u95ee\u6307\u4ee4\u5177\u6709\u8db3\u591f\u9ad8\u7684\u9884\u53d6\u51c6\u786e\u7387\uff0c\u5176\u5143\u6570\u636e\u5e94\u88ab\u8bb0\u5f55\u5230\u5143\u6570\u636e\u8868\u4e2d\u3002</li> <li>\u5f53 <code>acc &lt; EL_ACC</code> \u65f6\uff0c\u8f93\u51fa\u4e3a 0\uff0c\u8868\u793a\u8be5 PC \u7684\u9884\u53d6\u51c6\u786e\u7387\u8fc7\u4f4e\uff0c\u5176\u5143\u6570\u636e\u88ab\u89c6\u4e3a\u65e0\u6548\u6216\u65e0\u7528\uff0c\u4e0d\u5e94\u88ab\u63d2\u5165\u4ee5\u8282\u7701\u5b9d\u8d35\u7684\u7247\u4e0a\u5b58\u50a8\u7a7a\u95f4\u3002</li> <li>\u6b64\u516c\u5f0f\u662f Prophet \u6846\u67b6\u7684\u6838\u5fc3\u7ec4\u4ef6\u4e4b\u4e00\uff0c\u5b83\u901a\u8fc7\u79bb\u7ebf\u5206\u6790\u9636\u6bb5\u83b7\u5f97\u7684\u7cbe\u786e\u6027\u80fd\u6307\u6807\uff08\u800c\u975e\u786c\u4ef6\u5b9e\u65f6\u4f30\u7b97\uff09\uff0c\u5b9e\u73b0\u4e86\u6bd4 Triangel \u7b49\u73b0\u6709\u65b9\u6848\u66f4\u7cbe\u51c6\u7684\u5143\u6570\u636e\u8fc7\u6ee4\u3002</li> <li>\u5176\u8bbe\u8ba1\u54f2\u5b66\u662f \u4fdd\u5b88\u8fc7\u6ee4\uff1a\u4ec5\u5f53\u6709\u660e\u786e\u8bc1\u636e\u8868\u660e\u67d0\u6761\u6307\u4ee4\u51e0\u4e4e\u4e0d\u4ea7\u751f\u6709\u7528\u9884\u53d6\u65f6\u624d\u5c06\u5176\u8fc7\u6ee4\u6389\uff0c\u4ece\u800c\u907f\u514d\u4e86\u56e0\u8fc7\u5ea6\u8fc7\u6ee4\u800c\u4e22\u5931\u6f5c\u5728\u6709\u7528\u6a21\u5f0f\u7684\u95ee\u9898\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#37bc72061a8ee86cc1388e266f82418a26bef80f9a35efb33771fc0ce33ae8e8jpg","title":"37bc72061a8ee86cc1388e266f82418a26bef80f9a35efb33771fc0ce33ae8e8.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u7684\u662f Prophet \u6846\u67b6\u4e2d Replacement Policy \u6240\u4f7f\u7528\u7684\u4f18\u5148\u7ea7\u5206\u914d\u51fd\u6570 R(acc)\uff0c\u7528\u4e8e\u6839\u636e\u6bcf\u4e2a\u5185\u5b58\u6307\u4ee4\u7684\u9884\u53d6\u51c6\u786e\u7387\uff08prefetching accuracy\uff09\u4e3a\u5176\u5206\u914d\u66ff\u6362\u4f18\u5148\u7ea7\u3002</li> <li>\u51fd\u6570 R(acc) \u662f\u4e00\u4e2a\u5206\u6bb5\u51fd\u6570\uff0c\u5c06\u9884\u53d6\u51c6\u786e\u7387 acc \u6620\u5c04\u5230\u4e00\u4e2a\u4ece 0 \u5230 2^n - 1 \u7684\u6574\u6570\u4f18\u5148\u7ea7\u7ea7\u522b\u3002</li> <li>\u4f18\u5148\u7ea7\u7ea7\u522b\u8d8a\u4f4e\uff0c\u8868\u793a\u8be5\u5143\u6570\u636e\u6761\u76ee\u5728\u66ff\u6362\u65f6\u8d8a\u4f18\u5148\u88ab\u9a71\u9010\u3002\u4f8b\u5982\uff0c\u51c6\u786e\u7387\u4e3a 0 \u7684\u6307\u4ee4\u88ab\u8d4b\u4e88\u6700\u9ad8\u4f18\u5148\u7ea7\uff080\uff09\uff0c\u800c\u63a5\u8fd1 1 \u7684\u9ad8\u51c6\u786e\u7387\u6307\u4ee4\u5219\u88ab\u8d4b\u4e88\u6700\u4f4e\u4f18\u5148\u7ea7\uff082^n - 1\uff09\u3002</li> <li>\u8be5\u51fd\u6570\u901a\u8fc7\u5c06 [0, 1) \u533a\u95f4\u5212\u5206\u4e3a 2^n \u4e2a\u7b49\u5bbd\u5b50\u533a\u95f4\u6765\u5b9e\u73b0\u5206\u7ea7\u3002\u6bcf\u4e2a\u5b50\u533a\u95f4\u7684\u5bbd\u5ea6\u4e3a 1/2^n\u3002</li> <li>\u53c2\u6570 n \u7531\u8bbe\u8ba1\u8005\u63a7\u5236\uff0c\u51b3\u5b9a\u4e86\u4f18\u5148\u7ea7\u7ea7\u522b\u7684\u7cbe\u7ec6\u7a0b\u5ea6\u3002n \u8d8a\u5927\uff0c\u5206\u7ea7\u8d8a\u7ec6\uff0c\u4f46\u4e5f\u4f1a\u589e\u52a0\u5b58\u50a8\u5f00\u9500\uff08\u9700\u8981\u66f4\u591a\u4f4d\u6765\u5b58\u50a8\u4f18\u5148\u7ea7\u72b6\u6001\uff09\u3002</li> <li>\u5177\u4f53\u6620\u5c04\u89c4\u5219\u5982\u4e0b\u8868\u6240\u793a\uff1a</li> </ul> \u4f18\u5148\u7ea7\u7ea7\u522b \u5bf9\u5e94\u7684\u9884\u53d6\u51c6\u786e\u7387\u8303\u56f4 (acc) 0 EL_ACC \u2264 acc &lt; 1/2^n 1 1/2^n \u2264 acc &lt; 2/2^n 2 2/2^n \u2264 acc &lt; 3/2^n ... ... 2^n - 1 (2^n - 1)/2^n \u2264 acc &lt; 1 <ul> <li>\u516c\u5f0f\u4e2d\u7684 EL_ACC \u662f\u4e00\u4e2a\u6781\u4f4e\u9608\u503c\uff0c\u7528\u4e8e\u5904\u7406\u90a3\u4e9b\u51e0\u4e4e\u4e0d\u4ea7\u751f\u6709\u6548\u9884\u53d6\u7684\u6307\u4ee4\uff0c\u786e\u4fdd\u5b83\u4eec\u5373\u4f7f\u51c6\u786e\u7387\u7565\u9ad8\u4e8e 0 \u4e5f\u80fd\u88ab\u5f52\u5165\u6700\u4f4e\u4f18\u5148\u7ea7\u7ec4\u3002</li> <li>\u6b64\u8bbe\u8ba1\u5141\u8bb8 Prophet \u5728\u786c\u4ef6\u5c42\u9762\u5b9e\u73b0\u57fa\u4e8e\u8f6f\u4ef6\u5206\u6790\u7ed3\u679c\u7684\u7cbe\u7ec6\u5316\u66ff\u6362\u7b56\u7565\uff0c\u4ece\u800c\u5728\u6709\u9650\u7684\u5143\u6570\u636e\u8868\u7a7a\u95f4\u5185\uff0c\u66f4\u6709\u6548\u5730\u4fdd\u7559\u90a3\u4e9b\u80fd\u5e26\u6765\u9ad8\u6536\u76ca\u7684\u5143\u6570\u636e\u6761\u76ee\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-7-challenges-of-traditional-profile-guided-optimizations-across-different-program-inputs","title":"Figure 7: Challenges of traditional profile-guided optimizations across different program inputs.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u4f20\u7edf profile-guided optimizations \u5728\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u4e0b\u6240\u9762\u4e34\u7684\u6311\u6218\uff0c\u6838\u5fc3\u95ee\u9898\u662f hint \u4fe1\u606f\u7684\u8f93\u5165\u4f9d\u8d56\u6027\u3002</li> <li>\u56fe\u4e2d\u4ee5\u4e00\u4e2a\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff08Binary\uff09\u4e3a\u8d77\u70b9\uff0c\u5176\u6267\u884c\u6d41\uff08Execution Flow\uff09\u4f1a\u6839\u636e\u4e0d\u540c\u7684\u8f93\u5165\uff08Input X \u548c Input Y\uff09\u4ea7\u751f\u4e0d\u540c\u7684\u5185\u5b58\u8bbf\u95ee\u8def\u5f84\u3002</li> <li>\u5bf9\u4e8e Input X\uff0c\u7a0b\u5e8f\u4f9d\u6b21\u6267\u884c Load A \u2192 Load B \u2192 Load E\uff0c\u5206\u522b\u5173\u8054 hint1\u3001hint2\u3001hint4\u3002</li> <li>\u5bf9\u4e8e Input Y\uff0c\u7a0b\u5e8f\u6267\u884c\u8def\u5f84\u53d8\u4e3a Load A \u2192 Load C \u2192 Load E\uff0c\u5206\u522b\u5173\u8054 hint1\u3001hint3\u3001hint5\u3002</li> <li>\u5173\u952e\u89c2\u5bdf\u70b9\u5728\u4e8e\u4e09\u4e2a\u5185\u5b58\u6307\u4ee4\u5728\u4e0d\u540c\u8f93\u5165\u4e0b\u7684\u884c\u4e3a\u5dee\u5f02\uff1a</li> </ul> \u5185\u5b58\u6307\u4ee4 Input X \u884c\u4e3a Input Y \u884c\u4e3a \u95ee\u9898\u63cf\u8ff0 Load A \u6267\u884c\uff0c\u5173\u8054 hint1 \u6267\u884c\uff0c\u5173\u8054 hint1 \u76f8\u540c\u6307\u4ee4\uff0c\u76f8\u540c hint\uff0c\u4f18\u5316\u6709\u6548\u3002 Load B / Load C \u6267\u884c Load B\uff0c\u5173\u8054 hint2 \u6267\u884c Load C\uff0c\u5173\u8054 hint3 \u5b8c\u5168\u4e0d\u540c\u6307\u4ee4\uff0c\u4e3a Load B \u751f\u6210\u7684 hint \u5bf9 Load C \u65e0\u6548\u3002 Load E \u6267\u884c\uff0c\u5173\u8054 hint4 \u6267\u884c\uff0c\u5173\u8054 hint5 \u540c\u4e00\u6307\u4ee4\uff0c\u4e0d\u540c hint\uff0c\u56e0\u5168\u5c40\u4e0a\u4e0b\u6587\u53d8\u5316\u5bfc\u81f4 hint \u4e0d\u4e00\u81f4\uff0c\u539f hint \u5931\u6548\u3002 <ul> <li>\u6b64\u56fe\u65e8\u5728\u8bf4\u660e\uff1a\u4f20\u7edf\u65b9\u6cd5\u4e3a\u7279\u5b9a\u8f93\u5165\u751f\u6210\u7684 hint \u65e0\u6cd5\u6cdb\u5316\u5230\u5176\u4ed6\u8f93\u5165\uff0c\u5bfc\u81f4\u4f18\u5316\u6548\u679c\u4e0d\u7a33\u5b9a\u6216\u5931\u6548\u3002</li> <li>Prophet \u7684\u89e3\u51b3\u65b9\u6848\u662f\u901a\u8fc7 Step 3: Learning\uff0c\u52a8\u6001\u5408\u5e76\u6765\u81ea\u4e0d\u540c\u8f93\u5165\u7684\u8ba1\u6570\u5668\u6570\u636e\uff0c\u4f7f\u5355\u4e00\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\u80fd\u9002\u5e94\u591a\u79cd\u8f93\u5165\u573a\u666f\uff0c\u4ece\u800c\u514b\u670d\u6b64\u6311\u6218\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#337bc9a6391c1d0ca184a19b58f39dfb7754777d64613024963860b134c475f8jpg","title":"337bc9a6391c1d0ca184a19b58f39dfb7754777d64613024963860b134c475f8.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u4e86\u4e00\u4e2a\u7528\u4e8e\u8ba1\u7b97 Allocated Ways \u7684\u6570\u5b66\u516c\u5f0f\uff0c\u5176\u6838\u5fc3\u76ee\u7684\u662f\u5728 LLC (Last-Level Cache) \u4e2d\u4e3a metadata table \u5206\u914d\u7a7a\u95f4\u3002</li> <li>\u516c\u5f0f\u7ed3\u6784\u6e05\u6670\uff0c\u5305\u542b\u4e09\u4e2a\u5173\u952e\u53d8\u91cf\uff1a</li> <li>Target Size: \u6307\u7684\u662f\u5728\u7a0b\u5e8f\u6267\u884c\u7ed3\u675f\u65f6\uff0c\u901a\u8fc7\u6027\u80fd\u76d1\u63a7\u5355\u5143\uff08PMU\uff09\u8ba1\u6570\u5668\u6d4b\u91cf\u5f97\u5230\u7684\u3001\u7a0b\u5e8f\u5b9e\u9645\u9700\u8981\u7684\u5143\u6570\u636e\u8868\u6700\u5927\u6761\u76ee\u6570\u3002\u8fd9\u4e2a\u503c\u662f\u52a8\u6001\u83b7\u53d6\u7684\uff0c\u53cd\u6620\u4e86\u7a0b\u5e8f\u5bf9\u5143\u6570\u636e\u5b58\u50a8\u7684\u771f\u5b9e\u9700\u6c42\u3002</li> <li>Number of sets in LLC: \u6307\u7684\u662f\u6574\u4e2a LLC \u7684\u603b\u8def\u6570\uff08sets\uff09\uff0c\u8fd9\u662f\u4e00\u4e2a\u56fa\u5b9a\u7684\u786c\u4ef6\u53c2\u6570\u3002</li> <li>ceil(): \u8fd9\u662f\u4e00\u4e2a\u5411\u4e0a\u53d6\u6574\u51fd\u6570\uff0c\u786e\u4fdd\u5206\u914d\u7684\u8def\u6570\uff08Ways\uff09\u662f\u4e00\u4e2a\u6574\u6570\u503c\uff0c\u907f\u514d\u51fa\u73b0\u90e8\u5206\u8def\u6570\u7684\u60c5\u51b5\u3002</li> <li>\u8be5\u516c\u5f0f\u7684\u529f\u80fd\u662f\u5c06\u4e00\u4e2a\u62bd\u8c61\u7684\u201c\u76ee\u6807\u5927\u5c0f\u201d\u8f6c\u6362\u4e3a\u5177\u4f53\u7684\u786c\u4ef6\u8d44\u6e90\u5206\u914d\u65b9\u6848\u3002\u5b83\u901a\u8fc7\u5c06\u76ee\u6807\u5927\u5c0f\u9664\u4ee5 LLC \u7684\u603b\u8def\u6570\uff0c\u7136\u540e\u5411\u4e0a\u53d6\u6574\uff0c\u6765\u786e\u5b9a\u9700\u8981\u4ece LLC \u4e2d\u5212\u51fa\u591a\u5c11\u8def\uff08Ways\uff09\u7ed9 metadata table \u4f7f\u7528\u3002</li> <li>\u8fd9\u79cd\u8bbe\u8ba1\u4f53\u73b0\u4e86 Prophet \u6846\u67b6\u7684 \u8f7b\u91cf\u7ea7 \u548c \u517c\u5bb9\u6027 \u7279\u70b9\u3002\u5b83\u4e0d\u4f9d\u8d56\u590d\u6742\u7684\u8fd0\u884c\u65f6\u7b97\u6cd5\uff08\u5982 Triangel \u7684 Set Dueller\uff09\uff0c\u800c\u662f\u57fa\u4e8e\u79bb\u7ebf\u5206\u6790\u5f97\u51fa\u7684\u9759\u6001\u914d\u7f6e\uff0c\u5728\u7a0b\u5e8f\u542f\u52a8\u65f6\u4e00\u6b21\u6027\u5b8c\u6210\u8d44\u6e90\u914d\u7f6e\uff0c\u4ece\u800c\u907f\u514d\u4e86\u8fd0\u884c\u65f6\u5f00\u9500\u3002</li> <li>\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u8fd9\u4e2a\u516c\u5f0f\u662f Prophet Resizing \u7b56\u7565\u7684\u6838\u5fc3\u3002\u5b83\u786e\u4fdd\u4e86 metadata table \u7684\u5927\u5c0f\u65e2\u80fd\u6ee1\u8db3\u7a0b\u5e8f\u7684\u9700\u6c42\uff0c\u53c8\u4e0d\u4f1a\u8fc7\u5ea6\u5360\u7528\u5b9d\u8d35\u7684 LLC \u8d44\u6e90\uff0c\u4ece\u800c\u5728 prefetching coverage \u548c LLC hit rate \u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#35456cc33ab0d442a6cee8546bfa0dac04963ff9a6172c0bb272a68ad507d452jpg","title":"35456cc33ab0d442a6cee8546bfa0dac04963ff9a6172c0bb272a68ad507d452.jpg","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u540d\u4e3a Merged \u7684\u6570\u5b66\u516c\u5f0f\uff0c\u7528\u4e8e\u5728 Prophet \u6846\u67b6\u7684 Learning \u9636\u6bb5\u5408\u5e76\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\uff08\u5982 X \u548c Y\uff09\u4e0b\u6536\u96c6\u5230\u7684\u8ba1\u6570\u5668\u6570\u636e\u3002</li> <li>\u8be5\u516c\u5f0f\u662f\u4e00\u4e2a\u5206\u6bb5\u51fd\u6570\uff0c\u5176\u8ba1\u7b97\u903b\u8f91\u53d6\u51b3\u4e8e\u53d8\u91cf <code>o</code> \u662f\u5426\u5b58\u5728\u4e8e\u96c6\u5408 <code>X</code> \u4e2d\uff1a<ul> <li>\u5f53 <code>\u2203o \u2208 X</code>\uff08\u5373\u5b58\u5728\u65e7\u8ba1\u6570\u5668\u503c <code>o</code>\uff09\u65f6\uff0c\u91c7\u7528\u52a0\u6743\u5e73\u5747\u516c\u5f0f\uff1a<code>o + (1 / min(l+1, L)) \u00d7 (n - o)</code>\u3002</li> <li>\u5f53 <code>\u2204o \u2208 X</code>\uff08\u5373\u4e0d\u5b58\u5728\u65e7\u8ba1\u6570\u5668\u503c <code>o</code>\uff09\u65f6\uff0c\u76f4\u63a5\u4f7f\u7528\u65b0\u8ba1\u6570\u5668\u503c <code>n</code>\u3002</li> </ul> </li> <li>\u516c\u5f0f\u4e2d\u7684\u5173\u952e\u53d8\u91cf\u542b\u4e49\u5982\u4e0b\uff1a<ul> <li><code>o</code>\uff1a\u4ee3\u8868\u5728\u5148\u524d\u8f93\u5165\uff08\u5982 X\uff09\u4e0b\u83b7\u5f97\u7684\u65e7\u8ba1\u6570\u5668\u503c\u3002</li> <li><code>n</code>\uff1a\u4ee3\u8868\u5728\u65b0\u8f93\u5165\uff08\u5982 Y\uff09\u4e0b\u83b7\u5f97\u7684\u65b0\u8ba1\u6570\u5668\u503c\u3002</li> <li><code>l</code>\uff1a\u4ee3\u8868\u5f53\u524d\u5df2\u6267\u884c\u7684 Prophet \u5b66\u4e60\u5faa\u73af\u6b21\u6570\uff08\u6bcf\u4e2a\u5b8c\u6574\u7684\u5206\u6790\u6b65\u9aa4\u7b97\u4f5c\u4e00\u6b21\u5faa\u73af\uff09\u3002</li> <li><code>L</code>\uff1a\u4ee3\u8868\u7531\u8bbe\u8ba1\u8005\u9884\u5b9a\u4e49\u7684\u4e00\u4e2a\u53c2\u6570\uff0c\u7528\u4e8e\u63a7\u5236\u5b66\u4e60\u8fc7\u7a0b\u4e2d\u7684\u6743\u91cd\u8870\u51cf\u3002</li> </ul> </li> <li>\u8be5\u516c\u5f0f\u7684\u76ee\u7684\u662f\u5b9e\u73b0\u4e00\u79cd\u81ea\u9002\u5e94\u7684\u5b66\u4e60\u673a\u5236\uff0c\u4f7f\u5f97 Prophet \u80fd\u591f\u52a8\u6001\u8c03\u6574\u5176\u4f18\u5316\u7b56\u7565\u4ee5\u9002\u5e94\u4e0d\u540c\u7684\u7a0b\u5e8f\u8f93\u5165\u3002</li> <li>\u5177\u4f53\u800c\u8a00\uff0c\u5f53 <code>l</code> \u589e\u5927\u65f6\uff0c<code>min(l+1, L)</code> \u4f1a\u8d8b\u5411\u4e8e <code>L</code>\uff0c\u5bfc\u81f4 <code>(1 / min(l+1, L))</code> \u53d8\u5c0f\uff0c\u4ece\u800c\u4f7f\u65b0\u6570\u636e <code>n</code> \u5bf9\u6700\u7ec8\u7ed3\u679c\u7684\u5f71\u54cd\u51cf\u5f31\uff0c\u4f53\u73b0\u4e86\u201c\u5386\u53f2\u6570\u636e\u4e3b\u5bfc\u201d\u7684\u539f\u5219\u3002</li> <li>\u8fd9\u79cd\u8bbe\u8ba1\u786e\u4fdd\u4e86 Prophet \u5728\u9762\u5bf9\u65b0\u8f93\u5165\u65f6\u65e2\u80fd\u5feb\u901f\u54cd\u5e94\uff0c\u53c8\u80fd\u4fdd\u6301\u5bf9\u5386\u53f2\u7ecf\u9a8c\u7684\u5c0a\u91cd\uff0c\u4ece\u800c\u5728\u591a\u4e2a\u8f93\u5165\u4e4b\u95f4\u5b9e\u73b0\u6027\u80fd\u7684\u5e73\u6ed1\u8fc7\u6e21\u548c\u6301\u7eed\u4f18\u5316\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#80e116b52e63cd5dfbc8543d84386bc4f1af72640358658ff952a5835b48ef86jpg","title":"80e116b52e63cd5dfbc8543d84386bc4f1af72640358658ff952a5835b48ef86.jpg","text":"<ul> <li>\u56fe\u7247\u5185\u5bb9\u4e3a\u4e00\u4e2a\u6570\u5b66\u516c\u5f0f\uff0c\u8868\u8fbe\u5f0f\u4e3a Merged = max(o, n)\u3002</li> <li>\u8be5\u516c\u5f0f\u7528\u4e8e Prophet \u6846\u67b6\u7684 Step 3: Learning \u9636\u6bb5\uff0c\u5177\u4f53\u5e94\u7528\u4e8e\u5408\u5e76\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u4e0b\u6536\u96c6\u5230\u7684\u201c\u5df2\u5206\u914d\u5143\u6570\u636e\u6761\u76ee\u6570\u201d\u8fd9\u4e00\u5e94\u7528\u7ea7\u6307\u6807\u3002</li> <li>\u516c\u5f0f\u4e2d\u53d8\u91cf\u542b\u4e49\uff1a</li> <li>o\uff1a\u4ee3\u8868\u5728\u5148\u524d\u8f93\u5165\uff08\u5982\u8f93\u5165 X\uff09\u4e0b\u8bb0\u5f55\u7684\u5df2\u5206\u914d\u5143\u6570\u636e\u6761\u76ee\u6570\u3002</li> <li>n\uff1a\u4ee3\u8868\u5728\u65b0\u8f93\u5165\uff08\u5982\u8f93\u5165 Y\uff09\u4e0b\u8bb0\u5f55\u7684\u5df2\u5206\u914d\u5143\u6570\u636e\u6761\u76ee\u6570\u3002</li> <li>Merged\uff1a\u4ee3\u8868\u5408\u5e76\u540e\u7528\u4e8e\u6307\u5bfc\u540e\u7eed\u4f18\u5316\u7684\u6700\u7ec8\u503c\u3002</li> <li>\u91c7\u7528 max \u51fd\u6570\u7684\u7b56\u7565\u662f\u4fdd\u5b88\u7684\uff0c\u65e8\u5728\u786e\u4fdd\u4e3a\u5143\u6570\u636e\u8868\u5206\u914d\u8db3\u591f\u7684\u7a7a\u95f4\uff0c\u4ee5\u6ee1\u8db3\u6240\u6709\u5df2\u89c2\u5bdf\u5230\u7684\u7a0b\u5e8f\u8f93\u5165\u7684\u9700\u6c42\uff0c\u907f\u514d\u56e0\u7a7a\u95f4\u4e0d\u8db3\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002</li> <li>\u6b64\u65b9\u6cd5\u4e0e PC \u7ea7\u522b\u7684\u5408\u5e76\u7b56\u7565\uff08\u4f7f\u7528\u52a0\u6743\u5e73\u5747\u516c\u5f0f\uff09\u4e0d\u540c\uff0c\u4f53\u73b0\u4e86 Prophet \u5bf9\u4e0d\u540c\u7c92\u5ea6\u6570\u636e\u91c7\u53d6\u5dee\u5f02\u5316\u5904\u7406\u7684\u8bbe\u8ba1\u601d\u60f3\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-8-the-percentage-of-markov-target-number-t-in-temporal-prefetching-figure-9-the-multi-path-victim-buffer","title":"Figure 8: The percentage of Markov target number (T) in temporal prefetching. Figure 9: The Multi-path Victim Buffer.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 8: The percentage of Markov target number (T) in temporal prefetching\uff0c\u5c55\u793a\u7684\u662f\u5728\u65f6\u95f4\u9884\u53d6\uff08temporal prefetching\uff09\u573a\u666f\u4e2d\uff0c\u4e0d\u540c\u6570\u91cf\u7684 Markov \u76ee\u6807\uff08T\uff09\u6240\u5360\u7684\u6bd4\u4f8b\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u591a\u4e2a SPEC CPU \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff1aastar_biglakes, gcc_166, mcf, omnetpp, soplex_pds-50, sphinx3, xalancbmk\uff0c\u5e76\u5305\u542b\u4e00\u4e2a Geomean\uff08\u51e0\u4f55\u5e73\u5747\u503c\uff09\u7528\u4e8e\u6c47\u603b\u6574\u4f53\u8d8b\u52bf\u3002</li> <li>\u7eb5\u8f74\u8868\u793a Markov Targets Percentage\uff0c\u5373\u5177\u6709\u7279\u5b9a\u6570\u91cf Markov \u76ee\u6807\u7684\u5185\u5b58\u5730\u5740\u6240\u5360\u767e\u5206\u6bd4\uff0c\u8303\u56f4\u4ece 0.0 \u5230 1.0\u3002</li> <li>\u56fe\u4f8b\u663e\u793a\u4e94\u79cd\u989c\u8272\u5206\u522b\u5bf9\u5e94 T=1 \u81f3 T=5\uff0c\u5373\u6bcf\u4e2a\u5185\u5b58\u5730\u5740\u5173\u8054\u7684 Markov \u76ee\u6807\u6570\u91cf\uff1a</li> <li>T=1: \u84dd\u8272</li> <li>T=2: \u9752\u8272</li> <li>T=3: \u7eff\u8272</li> <li>T=4: \u6a59\u8272</li> <li>T=5: \u7ea2\u8272</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d T=1 (%) T=2 (%) T=3 (%) T=4 (%) T=5 (%) astar_biglakes ~0.3 ~0.25 ~0.2 ~0.15 ~0.1 gcc_166 ~0.7 ~0.15 ~0.05 ~0.05 ~0.05 mcf ~0.5 ~0.2 ~0.15 ~0.1 ~0.05 omnetpp ~0.55 ~0.2 ~0.15 ~0.1 ~0.05 soplex_pds-50 ~0.35 ~0.2 ~0.15 ~0.1 ~0.1 sphinx3 ~0.8 ~0.15 ~0.05 ~0.05 ~0.05 xalancbmk ~0.55 ~0.2 ~0.15 ~0.1 ~0.05 Geomean ~0.55 ~0.2 ~0.15 ~0.1 ~0.05 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5927\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cT=1 \u5360\u4e3b\u5bfc\u5730\u4f4d\uff0c\u4f8b\u5982 gcc_166 \u548c sphinx3 \u4e2d\u5360\u6bd4\u8d85\u8fc7 70%\uff0c\u8868\u660e\u591a\u6570\u5185\u5b58\u5730\u5740\u4ec5\u6709\u4e00\u4e2a\u53ef\u9884\u6d4b\u7684\u540e\u7eed\u8bbf\u95ee\u76ee\u6807\u3002</li> <li>T=2 \u548c T=3 \u4e5f\u5360\u636e\u663e\u8457\u6bd4\u4f8b\uff0c\u5408\u8ba1\u5728\u591a\u6570\u7a0b\u5e8f\u4e2d\u63a5\u8fd1 30%-40%\uff0c\u8bf4\u660e\u5b58\u5728\u76f8\u5f53\u4e00\u90e8\u5206\u5185\u5b58\u5730\u5740\u5177\u6709\u591a\u8def\u5f84\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li>T=4 \u548c T=5 \u5360\u6bd4\u6781\u4f4e\uff0c\u901a\u5e38\u5c0f\u4e8e 10%\uff0c\u8868\u660e\u9ad8\u5ea6\u590d\u6742\u7684\u591a\u76ee\u6807\u8bbf\u95ee\u6a21\u5f0f\u8f83\u5c11\u89c1\u3002</li> <li> <p>Geomean \u663e\u793a\u6574\u4f53\u8d8b\u52bf\uff1a\u7ea6 55% \u7684\u5185\u5b58\u5730\u5740\u4ec5\u6709 1 \u4e2a Markov \u76ee\u6807\uff0c20% \u6709 2 \u4e2a\uff0c15% \u6709 3 \u4e2a\uff0c\u5176\u4f59\u4e3a\u66f4\u9ad8\u9636\u76ee\u6807\u3002</p> </li> <li> <p>\u8be5\u56fe\u652f\u6301\u8bba\u6587\u4e2d\u63d0\u51fa\u7684 Multi-path Victim Buffer \u8bbe\u8ba1\u52a8\u673a\uff1a\u7531\u4e8e\u5927\u91cf\u5185\u5b58\u5730\u5740\u5177\u6709\u591a\u4e2a Markov \u76ee\u6807\uff08\u5c24\u5176\u662f T=2 \u548c T=3\uff09\uff0c\u4f20\u7edf\u5355\u76ee\u6807\u5b58\u50a8\u673a\u5236\u4f1a\u5bfc\u81f4\u9884\u53d6\u4e0d\u51c6\u786e\u6216\u4e22\u5931\u6f5c\u5728\u6709\u7528\u76ee\u6807\u3002Prophet \u5f15\u5165 Multi-path Victim Buffer \u6765\u7f13\u5b58\u88ab\u9a71\u9010\u7684\u591a\u76ee\u6807\uff0c\u4ece\u800c\u63d0\u5347\u590d\u6742\u6a21\u5f0f\u4e0b\u7684\u9884\u53d6\u8986\u76d6\u7387\u548c\u51c6\u786e\u6027\u3002</p> </li> <li> <p>\u56fe\u8868\u4e0b\u65b9\u6807\u6ce8 \u201cFigure 9: The Multi-path Victim Buffer\u201d\uff0c\u4f46\u5b9e\u9645\u56fe\u50cf\u5185\u5bb9\u4ec5\u4e3a Figure 8\uff0c\u672a\u5305\u542b Figure 9 \u7684\u7ed3\u6784\u793a\u610f\u56fe\u3002\u8fd9\u53ef\u80fd\u662f\u6587\u6863\u6392\u7248\u4e2d\u7684\u5f15\u7528\u9519\u8bef\u6216\u56fe\u50cf\u5408\u5e76\u95ee\u9898\u3002</p> </li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#45d5a20ea75b4a6bd546801f0bdc339954d61e9e9c1520ac15d9b0b7c7b9d0c0jpg","title":"45d5a20ea75b4a6bd546801f0bdc339954d61e9e9c1520ac15d9b0b7c7b9d0c0.jpg","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Multi-path Victim Buffer \u7684\u4e00\u4e2a\u5177\u4f53\u6761\u76ee\u7ed3\u6784\uff0c\u7528\u4e8e\u5904\u7406\u5355\u4e2a\u5185\u5b58\u5730\u5740\u5bf9\u5e94\u591a\u4e2a\u6f5c\u5728 Markov \u76ee\u6807\u7684\u60c5\u51b5\u3002</li> <li>\u8be5\u7ed3\u6784\u5305\u542b\u4e09\u4e2a\u6838\u5fc3\u5b57\u6bb5\uff1aLookup Tag\u3001Target \u548c Counter\uff0c\u5171\u540c\u8bb0\u5f55\u4e00\u4e2a\u5386\u53f2\u8bbf\u95ee\u5e8f\u5217\u53ca\u5176\u88ab\u8bbf\u95ee\u7684\u9891\u6b21\u3002</li> <li>Lookup Tag \u5b57\u6bb5\u5b58\u50a8\u7684\u662f\u4e0a\u4e00\u6b21\u8bbf\u95ee\u7684\u5730\u5740\uff08LastAddr\uff09\uff0c\u5728\u6b64\u4f8b\u4e2d\u4e3a B\u3002\u8fd9\u662f\u67e5\u627e\u8be5\u6761\u76ee\u7684\u952e\u503c\u3002</li> <li>Target \u5b57\u6bb5\u5b58\u50a8\u5f53\u524d\u8bbf\u95ee\u5730\u5740\uff08CurAddr\uff09\u6240\u6307\u5411\u7684\u4e0b\u4e00\u4e2a\u53ef\u80fd\u76ee\u6807\u5730\u5740\u3002\u56fe\u4e2d\u663e\u793a\u4e86\u4e24\u4e2a\u76ee\u6807\uff1a</li> <li>\u7b2c\u4e00\u4e2a\u76ee\u6807\u662f C\uff0c\u8868\u793a\u5728\u8bbf\u95ee B \u4e4b\u540e\uff0c\u66fe\u6709\u4e00\u6b21\u8bbf\u95ee C \u7684\u5386\u53f2\u3002</li> <li>\u7b2c\u4e8c\u4e2a\u76ee\u6807\u662f NULL\u2192D\uff0c\u8868\u793a\u5728\u8bbf\u95ee B \u4e4b\u540e\uff0c\u66fe\u6709\u4e00\u6b21\u8bbf\u95ee D \u7684\u5386\u53f2\uff0c\u4e14\u8be5\u8def\u5f84\u662f\u4ece\u201c\u7a7a\u201d\u72b6\u6001\u5f00\u59cb\u7684\u3002</li> <li>Counter \u5b57\u6bb5\u8bb0\u5f55\u6bcf\u4e2a\u76ee\u6807\u8def\u5f84\u88ab\u8bbf\u95ee\u7684\u6b21\u6570\u3002\u56fe\u4e2d\u663e\u793a\uff1a</li> <li>\u8def\u5f84 B\u2192C \u88ab\u8bbf\u95ee\u4e86 2 \u6b21\u3002</li> <li>\u8def\u5f84 B\u2192D \u88ab\u8bbf\u95ee\u4e86 1 \u6b21\u3002</li> <li>\u8be5\u8bbe\u8ba1\u5141\u8bb8 Prophet \u5728\u5143\u6570\u636e\u8868\u4e2d\u4ec5\u5b58\u50a8\u4e00\u4e2a\u4e3b\u8981\u76ee\u6807\uff0c\u800c\u5c06\u5176\u4ed6\u6b21\u8981\u4f46\u6709\u6548\u7684\u76ee\u6807\u5b58\u5165 Multi-path Victim Buffer\uff0c\u4ece\u800c\u5728\u4e0d\u663e\u8457\u589e\u52a0\u4e3b\u5143\u6570\u636e\u8868\u5f00\u9500\u7684\u524d\u63d0\u4e0b\uff0c\u63d0\u5347\u9884\u53d6\u7684\u8986\u76d6\u7387\u548c\u51c6\u786e\u6027\u3002</li> <li>\u8868\u683c\u5316\u5c55\u793a\u5982\u4e0b\uff1a</li> </ul> Lookup Tag Target Counter B C 2 B NULL\u2192D 1 <ul> <li>\u6b64\u673a\u5236\u7684\u5173\u952e\u5728\u4e8e\u5229\u7528 Counter \u503c\u6765\u7ba1\u7406\u7f13\u51b2\u533a\u5185\u7684\u6761\u76ee\u4f18\u5148\u7ea7\uff0c\u786e\u4fdd\u9ad8\u9891\u4f7f\u7528\u7684\u591a\u8def\u5f84\u76ee\u6807\u80fd\u88ab\u4fdd\u7559\uff0c\u4ece\u800c\u4f18\u5316\u540e\u7eed\u7684\u9884\u53d6\u51b3\u7b56\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#cdeea9421676867d0db1f1eb1950265b2b90603710ddeb9ba0fb18da7d2dfb49jpg","title":"cdeea9421676867d0db1f1eb1950265b2b90603710ddeb9ba0fb18da7d2dfb49.jpg","text":"<ul> <li>\u56fe\u7247\u5185\u5bb9\u4e3a\u4e00\u5f20\u7cfb\u7edf\u914d\u7f6e\u8868\uff0c\u8be6\u7ec6\u5217\u51fa\u4e86\u7528\u4e8e\u8bc4\u4f30 Prophet \u6846\u67b6\u7684\u6a21\u62df\u5668 gem5 \u7684\u786c\u4ef6\u53c2\u6570\u3002</li> <li>\u8868\u683c\u5305\u542b\u56db\u4e2a\u4e3b\u8981\u6a21\u5757\uff1aCore\u3001Private L1 I/D cache\u3001Private L2 cache \u548c Shared L3 cache\uff0c\u4ee5\u53ca Memory \u5b50\u7cfb\u7edf\u3002</li> <li>\u6240\u6709\u914d\u7f6e\u5747\u4ee5\u6587\u672c\u5f62\u5f0f\u5448\u73b0\uff0c\u672a\u5305\u542b\u4efb\u4f55\u56fe\u5f62\u6216\u56fe\u8868\u5143\u7d20\u3002</li> </ul> Module Configuration Core 5-wide fetch, 5-wide decode10-wide issue, 10-wide commit120-entry IQ, 85/90-entry LQ/SQ288-entry ROB Private L1 I/D cache 64 KB each, 4-way, 64B line, 16 MSHRsPLRU, 2 cycles hit latencydegree-8 stride prefetcher for L1D cache Private L2 cache 512 KB, 8-way, 64B line, 32 MSHRsPLRU, mostly_inclusive9 cycles hit latency Shared L3 cache 2 MB/core, 16-way, 64B line, 36 MSHRsCHAR [18], mostly_exclusive20 cycles hit latency Memory LPDDR5_5500_1x16_BG_BL32Single channel, 1 rank per channel <ul> <li>Core \u914d\u7f6e\u663e\u793a\u5176\u4e3a\u4e00\u4e2a\u8d85\u6807\u91cf\u5904\u7406\u5668\uff0c\u5177\u5907 5 \u8def\u53d6\u6307\u548c\u8bd1\u7801\uff0c10 \u8def\u53d1\u5c04\u548c\u63d0\u4ea4\uff0c\u4ee5\u53ca\u8f83\u5927\u7684\u6307\u4ee4\u961f\u5217\uff08IQ\uff09\u548c\u91cd\u6392\u5e8f\u7f13\u51b2\u533a\uff08ROB\uff09\uff0c\u8868\u660e\u5176\u8bbe\u8ba1\u76ee\u6807\u662f\u9ad8\u541e\u5410\u91cf\u3002</li> <li>L1 \u7f13\u5b58 \u91c7\u7528\u5206\u79bb\u5f0f\u8bbe\u8ba1\uff0c\u6307\u4ee4\u548c\u6570\u636e\u7f13\u5b58\u5404 64 KB\uff0c\u5747\u4e3a 4 \u8def\u7ec4\u76f8\u8054\uff0c\u652f\u6301 PLRU \u66ff\u6362\u7b56\u7565\uff0c\u5e76\u914d\u5907 8 \u5ea6\u6b65\u957f\u9884\u53d6\u5668\uff0c\u65e8\u5728\u4f18\u5316\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li>L2 \u7f13\u5b58 \u5bb9\u91cf\u4e3a 512 KB\uff0c8 \u8def\u7ec4\u76f8\u8054\uff0c\u91c7\u7528 mostly_inclusive \u7b56\u7565\uff0c\u547d\u4e2d\u5ef6\u8fdf\u4e3a 9 \u5468\u671f\uff0c\u5e73\u8861\u4e86\u5bb9\u91cf\u4e0e\u901f\u5ea6\u3002</li> <li>L3 \u7f13\u5b58 \u4e3a\u5171\u4eab\u5f0f\uff0c\u6bcf\u6838 2 MB\uff0c16 \u8def\u7ec4\u76f8\u8054\uff0c\u91c7\u7528 CHAR \u66ff\u6362\u7b56\u7565\u548c mostly_exclusive \u7b56\u7565\uff0c\u547d\u4e2d\u5ef6\u8fdf\u9ad8\u8fbe 20 \u5468\u671f\uff0c\u53cd\u6620\u4e86\u5176\u4f5c\u4e3a\u6700\u540e\u4e00\u7ea7\u7f13\u5b58\u7684\u89d2\u8272\u3002</li> <li>\u5185\u5b58\u5b50\u7cfb\u7edf \u4f7f\u7528 LPDDR5 \u5185\u5b58\uff0c\u5355\u901a\u9053\u914d\u7f6e\uff0c\u6bcf\u4e2a\u901a\u9053\u4e00\u4e2a rank\uff0c\u5e26\u5bbd\u548c\u5ef6\u8fdf\u7279\u6027\u7b26\u5408\u73b0\u4ee3\u79fb\u52a8\u6216\u5d4c\u5165\u5f0f\u5e73\u53f0\u6807\u51c6\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-10-ipc-speedup-compared-to-rpg2-and-triangel","title":"Figure 10: IPC speedup compared to RPG2 and Triangel.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prophet\u3001Triangel \u548c RPG\u00b2 \u4e09\u79cd\u9884\u53d6\u65b9\u6848\u5728\u591a\u4e2a SPEC CPU \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u7684 IPC Speedup \u6027\u80fd\u5bf9\u6bd4\uff0c\u57fa\u51c6\u4e3a\u65e0\u9884\u53d6\u5668\u7684\u7cfb\u7edf\u3002</li> <li>\u6a2a\u8f74\u4e3a\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5305\u62ec astar_biglakes\u3001gcc_166\u3001mcf\u3001omnetpp\u3001soplex_pds-50\u3001sphinx3\u3001xalancbmk\uff0c\u4ee5\u53ca\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u7684 Geomean\uff08\u51e0\u4f55\u5e73\u5747\u503c\uff09\u3002</li> <li>\u7eb5\u8f74\u4e3a\u6027\u80fd\u52a0\u901f\u6bd4\uff0c1.0 \u8868\u793a\u65e0\u6027\u80fd\u63d0\u5347\uff0c\u9ad8\u4e8e 1.0 \u8868\u793a\u6709\u52a0\u901f\uff0c\u4f4e\u4e8e 1.0 \u8868\u793a\u6027\u80fd\u9000\u5316\u3002</li> <li>\u4e09\u7ec4\u67f1\u72b6\u56fe\u5206\u522b\u4ee3\u8868\uff1a</li> <li>RPG\u00b2\uff08\u7ea2\u8272\uff09\uff1a\u57fa\u4e8e\u8f6f\u4ef6\u95f4\u63a5\u8bbf\u95ee\u7684\u9884\u53d6\u65b9\u6848\u3002</li> <li>Triangel\uff08\u6a59\u8272\uff09\uff1a\u5f53\u524d\u6700\u5148\u8fdb\u7684\u786c\u4ef6\u65f6\u95f4\u9884\u53d6\u5668\u3002</li> <li>Prophet\uff08\u7eff\u8272\uff09\uff1a\u672c\u6587\u63d0\u51fa\u7684\u8f6f\u786c\u4ef6\u534f\u540c\u6846\u67b6\u3002</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d RPG\u00b2 Triangel Prophet astar_biglakes ~0.98 ~0.99 ~1.10 gcc_166 ~0.99 ~1.58 ~1.55 mcf ~0.99 ~1.42 ~1.68 omnetpp ~0.99 ~1.05 ~1.18 soplex_pds-50 ~0.99 ~1.08 ~1.38 sphinx3 ~0.99 ~1.22 ~1.38 xalancbmk ~0.99 ~1.24 ~1.30 Geomean ~1.00 ~1.20 ~1.35 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>RPG\u00b2 \u5728\u51e0\u4e4e\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5747\u63a5\u8fd1\u6216\u7565\u4f4e\u4e8e\u57fa\u51c6\uff081.0\uff09\uff0c\u4ec5\u5e26\u6765 0.1% \u7684\u5e73\u5747\u6027\u80fd\u589e\u76ca\uff0c\u8868\u660e\u5176\u5bf9\u590d\u6742\u975e\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u65e0\u6548\u3002</li> <li>Triangel \u5728\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u8868\u73b0\u826f\u597d\uff0c\u5c24\u5176\u5728 gcc_166 \u548c mcf \u4e0a\u663e\u8457\u4f18\u4e8e RPG\u00b2\uff0c\u4f46\u53d7\u9650\u4e8e\u5143\u6570\u636e\u7ba1\u7406\u7b56\u7565\uff0c\u6027\u80fd\u4ecd\u6709\u63d0\u5347\u7a7a\u95f4\u3002</li> <li>Prophet \u5728\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5747\u4f18\u4e8e Triangel \u548c RPG\u00b2\uff0c\u5c24\u5176\u5728 mcf \u4e0a\u8fbe\u5230 1.68 \u500d\u52a0\u901f\uff0cGeomean \u8fbe\u5230 1.35\uff0c\u76f8\u6bd4 Triangel \u63d0\u5347 14.23%\u3002</li> <li>\u5728\u90e8\u5206\u654f\u611f\u5de5\u4f5c\u8d1f\u8f7d\u5982 astar_biglakes \u4e2d\uff0cProphet \u4ecd\u4fdd\u6301\u6b63\u5411\u52a0\u901f\uff0c\u800c RPG\u00b2 \u548c Triangel \u63a5\u8fd1\u6216\u7565\u4f4e\u4e8e\u57fa\u51c6\uff0c\u4f53\u73b0\u5176\u9c81\u68d2\u6027\u3002</li> <li>Prophet \u7684\u4f18\u52bf\u6e90\u4e8e\u5176 Profile-Guided \u5143\u6570\u636e\u7ba1\u7406\u673a\u5236\uff0c\u80fd\u66f4\u7cbe\u51c6\u5730\u63a7\u5236\u63d2\u5165\u3001\u66ff\u6362\u4e0e\u91cd\u5206\u914d\uff0c\u4ece\u800c\u5728\u4e0d\u589e\u52a0\u8fc7\u591a\u5b58\u50a8\u5f00\u9500\u7684\u524d\u63d0\u4e0b\u63d0\u5347\u9884\u53d6\u8986\u76d6\u7387\u548c\u51c6\u786e\u6027\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-11-dram-traffic-compared-to-rpg2-and-triangel","title":"Figure 11: DRAM traffic compared to RPG2 and Triangel.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 11: DRAM traffic compared to RPG2 and Triangel\uff0c\u5c55\u793a\u7684\u662f\u4e0d\u540c prefetching \u65b9\u6848\u5bf9 Normalized DRAM Traffic \u7684\u5f71\u54cd\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u591a\u4e2a SPEC CPU \u5de5\u4f5c\u8d1f\u8f7d\uff1aastar_biglakes, gcc_166, mcf, omnetpp, soplex_pds-50, sphinx3, xalancbmk\uff0c\u5e76\u9644\u5e26\u4e00\u4e2a Geomean\uff08\u51e0\u4f55\u5e73\u5747\u503c\uff09\u7528\u4e8e\u6574\u4f53\u6027\u80fd\u8bc4\u4f30\u3002</li> <li>\u7eb5\u8f74\u8868\u793a\u5f52\u4e00\u5316\u540e\u7684 DRAM \u6d41\u91cf\uff0c\u57fa\u51c6\u7ebf\u4e3a 1.0\uff0c\u4ee3\u8868\u65e0 temporal prefetcher \u7684\u57fa\u7ebf\u6d41\u91cf\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e09\u79cd\u65b9\u6848\uff1a</li> <li>RPG2\uff08\u7ea2\u8272\u67f1\u72b6\u56fe\uff09</li> <li>Triangel\uff08\u6a59\u8272\u67f1\u72b6\u56fe\uff09</li> <li>Prophet\uff08\u7eff\u8272\u67f1\u72b6\u56fe\uff09</li> </ul> Workload RPG2 (Red) Triangel (Orange) Prophet (Green) astar_biglakes ~1.0 ~1.15 ~1.1 gcc_166 ~1.0 ~1.05 ~1.08 mcf ~1.0 ~1.1 ~1.12 omnetpp ~1.0 ~1.1 ~1.22 soplex_pds-50 ~1.0 ~1.15 ~1.24 sphinx3 ~1.0 ~1.02 ~1.09 xalancbmk ~1.0 ~1.08 ~1.11 Geomean 1.0 1.033 1.117 <ul> <li>RPG2 \u5728\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u5747\u4fdd\u6301 DRAM \u6d41\u91cf\u4e0e\u57fa\u7ebf\u6301\u5e73\uff08~1.0\uff09\uff0c\u8868\u660e\u5176\u8f6f\u4ef6\u9884\u53d6\u7b56\u7565\u51e0\u4e4e\u4e0d\u589e\u52a0\u989d\u5916\u5185\u5b58\u6d41\u91cf\u3002</li> <li>Triangel \u5f15\u5165\u4e86\u9002\u5ea6\u7684 DRAM \u6d41\u91cf\u589e\u957f\uff0c\u51e0\u4f55\u5e73\u5747\u503c\u7ea6\u4e3a 1.033\uff0c\u8bf4\u660e\u5176\u786c\u4ef6\u9884\u53d6\u5728\u63d0\u5347\u6027\u80fd\u7684\u540c\u65f6\u5e26\u6765\u4e86\u8f7b\u5fae\u7684\u6d41\u91cf\u5f00\u9500\u3002</li> <li>Prophet \u867d\u7136\u6027\u80fd\u9886\u5148\uff08\u89c1 Figure 10\uff09\uff0c\u4f46\u5176 DRAM \u6d41\u91cf\u5f00\u9500\u66f4\u9ad8\uff0c\u51e0\u4f55\u5e73\u5747\u503c\u8fbe 1.117\uff0c\u5373\u6bd4\u57fa\u7ebf\u9ad8\u7ea6 11.7%\u3002</li> <li>\u5c3d\u7ba1 Prophet \u589e\u52a0\u4e86\u6d41\u91cf\uff0c\u8bba\u6587\u7b2c 5.2 \u8282\u6307\u51fa\u5176\u6027\u80fd\u589e\u76ca\uff08+14.23% IPC\uff09\u4ec5\u5e26\u6765 5.35% \u989d\u5916\u5185\u5b58\u6d41\u91cf\uff08\u76f8\u5bf9\u4e8e Triangel\uff09\uff0c\u8bf4\u660e\u5176\u6548\u7387\u4ecd\u4f18\u4e8e Triangel\u3002</li> <li>\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cProphet \u7684\u6d41\u91cf\u9ad8\u4e8e Triangel\uff0c\u5c24\u5176\u5728 omnetpp\u3001soplex_pds-50 \u4e2d\u589e\u5e45\u660e\u663e\uff0c\u53cd\u6620\u5176\u66f4\u6fc0\u8fdb\u7684\u9884\u53d6\u7b56\u7565\u4ee5\u6362\u53d6\u66f4\u9ad8\u8986\u76d6\u7387\u3002</li> <li>sphinx3 \u662f\u4f8b\u5916\uff0c\u5176 Prophet \u6d41\u91cf\u589e\u5e45\u8f83\u5c0f\uff08~1.09\uff09\uff0c\u53ef\u80fd\u56e0\u5176\u5143\u6570\u636e\u9700\u6c42\u8f83\u4f4e\uff0cProphet \u7684 resizing \u7b56\u7565\u66f4\u4fdd\u5b88\uff08\u89c1 Section 5.9\uff09\u3002</li> <li>\u603b\u4f53\u800c\u8a00\uff0cProphet \u4ee5\u53ef\u63a7\u7684\u6d41\u91cf\u4ee3\u4ef7\u6362\u53d6\u663e\u8457\u6027\u80fd\u63d0\u5347\uff0c\u7b26\u5408\u5176\u201c\u9ad8\u6548\u201d\u8bbe\u8ba1\u76ee\u6807\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-12-prefetching-coverage-and-accuracy6","title":"Figure 12: Prefetching coverage and accuracy6.","text":"<ul> <li>\u56fe\u7247\u5305\u542b\u4e24\u4e2a\u5b50\u56fe\uff0c(a) \u5c55\u793a Prefetching Coverage\uff0c(b) \u5c55\u793a Prefetching Accuracy\uff0c\u7528\u4e8e\u5bf9\u6bd4 RPG2\u3001Triangel \u548c Prophet \u4e09\u79cd\u65b9\u6848\u5728\u591a\u4e2a SPEC CPU \u5de5\u4f5c\u8d1f\u8f7d\u4e0b\u7684\u8868\u73b0\u3002</li> <li>\u6240\u6709\u6570\u636e\u4ee5\u67f1\u72b6\u56fe\u5f62\u5f0f\u5448\u73b0\uff0c\u6a2a\u8f74\u4e3a\u5de5\u4f5c\u8d1f\u8f7d\u540d\u79f0\uff08\u5982 <code>astar_biglakes</code>, <code>gcc_166</code>, <code>mcf</code> \u7b49\uff09\uff0c\u7eb5\u8f74\u4e3a\u5f52\u4e00\u5316\u6307\u6807\u503c\uff080.0 \u5230 1.0\uff09\u3002</li> <li>\u6700\u53f3\u4fa7\u7684 \u201cGeomean\u201d \u8868\u793a\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u7684\u51e0\u4f55\u5e73\u5747\u503c\uff0c\u7528\u4e8e\u7efc\u5408\u8bc4\u4f30\u6574\u4f53\u6027\u80fd\u3002 (a) Prefetching Coverage \u5206\u6790</li> <li>Prophet \u5728\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u8986\u76d6\u5ea6\u663e\u8457\u4f18\u4e8e Triangel \u548c RPG2\uff0c\u5c24\u5176\u5728 <code>gcc_166</code>\u3001<code>sphinx3</code>\u3001<code>xalancbmk</code> \u4e2d\u63a5\u8fd1\u6216\u8d85\u8fc7 0.6\u3002</li> <li>Triangel \u8986\u76d6\u5ea6\u6b21\u4e4b\uff0c\u5728 <code>gcc_166</code> \u548c <code>sphinx3</code> \u4e2d\u8868\u73b0\u8f83\u597d\uff0c\u4f46\u5728 <code>mcf</code>\u3001<code>omnetpp</code> \u4e2d\u660e\u663e\u4f4e\u4e8e Prophet\u3002</li> <li>RPG2 \u8986\u76d6\u5ea6\u666e\u904d\u6700\u4f4e\uff0c\u4ec5\u5728 <code>astar_biglakes</code> \u548c <code>sphinx3</code> \u4e2d\u7565\u6709\u63d0\u5347\uff0c\u5176\u4f59\u5747\u63a5\u8fd1 0.0\u3002</li> <li>Geomean \u663e\u793a\uff1aProphet &gt; Triangel &gt; RPG2\uff0c\u8868\u660e Prophet \u5728\u5168\u5c40\u8986\u76d6\u80fd\u529b\u4e0a\u5177\u6709\u538b\u5012\u6027\u4f18\u52bf\u3002 (b) Prefetching Accuracy \u5206\u6790</li> <li>RPG2 \u5728\u90e8\u5206\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982 <code>astar_biglakes</code>, <code>sphinx3</code>, <code>xalancbmk</code>\uff09\u4e2d\u51c6\u786e\u7387\u6781\u9ad8\uff08\u63a5\u8fd1 1.0\uff09\uff0c\u4f46\u8fd9\u662f\u5176\u8bbe\u8ba1\u76ee\u6807\u2014\u2014\u9488\u5bf9\u53ef\u9884\u6d4b\u7684 stride \u6a21\u5f0f\u3002</li> <li>Triangel \u51c6\u786e\u7387\u7a33\u5b9a\uff0c\u591a\u6570\u5728 0.7\u20130.9 \u533a\u95f4\uff0c\u4e0e Prophet \u76f8\u5f53\u3002</li> <li>Prophet \u51c6\u786e\u7387\u4e0e Triangel \u57fa\u672c\u6301\u5e73\uff0c\u751a\u81f3\u5728 <code>mcf</code>\u3001<code>omnetpp</code>\u3001<code>soplex_pds-50</code> \u4e2d\u7565\u4f18\uff0c\u8bf4\u660e\u5176\u9ad8\u8986\u76d6\u5e76\u672a\u727a\u7272\u51c6\u786e\u6027\u3002</li> <li>Geomean \u663e\u793a\uff1a\u4e09\u8005\u51c6\u786e\u7387\u5dee\u5f02\u8f83\u5c0f\uff0cProphet \u4e0e Triangel \u63a5\u8fd1\uff0cRPG2 \u7565\u9ad8\u4f46\u53d7\u9650\u4e8e\u9002\u7528\u573a\u666f\u3002 \u7efc\u5408\u5bf9\u6bd4\u8868</li> </ul> Workload Coverage: Prophet Coverage: Triangel Coverage: RPG2 Accuracy: Prophet Accuracy: Triangel Accuracy: RPG2"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-13-prophet-learns-counters-from-gccs-inputs","title":"Figure 13: Prophet learns counters from gcc\u2019s inputs.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 13: Prophet learns counters from gcc\u2019s inputs\uff0c\u5c55\u793a Prophet \u5728\u4e0d\u540c gcc \u8f93\u5165\u4e0b\u901a\u8fc7\u8fed\u4ee3\u5b66\u4e60\u63d0\u5347\u6027\u80fd\u7684\u8fc7\u7a0b\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u591a\u4e2a gcc \u5b50\u57fa\u51c6\u6d4b\u8bd5\uff1agcc_166, gcc_200, gcc_cpdecl, gcc_expr, gcc_expr2, gcc_g23, gcc_s04, gcc_scilab, gcc_typeck\uff0c\u5e76\u6807\u6ce8 Geomean \u8868\u793a\u51e0\u4f55\u5e73\u5747\u503c\u3002</li> <li>\u7eb5\u8f74\u4e3a Performance Speedup\uff0c\u4ee5 1.0 \u4e3a\u57fa\u7ebf\uff08\u7ea2\u8272\u865a\u7ebf\uff09\uff0c\u8868\u793a\u65e0\u4f18\u5316\u65f6\u7684\u6027\u80fd\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u516d\u79cd\u914d\u7f6e\uff1a</li> <li>Disable\uff1a\u672a\u542f\u7528 Prophet\uff0c\u4ec5\u4f7f\u7528 Triage + Triangel \u5143\u6570\u636e\u7ba1\u7406\u3002</li> <li>+166\uff1a\u4ec5\u4ece gcc_166 \u8f93\u5165\u5b66\u4e60\u3002</li> <li>+expr\uff1a\u5728 +166 \u57fa\u7840\u4e0a\u52a0\u5165 gcc_expr \u8f93\u5165\u3002</li> <li>+typeck\uff1a\u518d\u52a0\u5165 gcc_typeck \u8f93\u5165\u3002</li> <li>+expr2\uff1a\u518d\u52a0\u5165 gcc_expr2 \u8f93\u5165\u3002</li> <li>Direct\uff1a\u9488\u5bf9\u6bcf\u4e2a\u8f93\u5165\u5355\u72ec\u76f4\u63a5\u5b66\u4e60\uff0c\u4ee3\u8868\u201c\u7406\u60f3\u201d\u6027\u80fd\u3002</li> </ul> \u914d\u7f6e \u6027\u80fd\u8868\u73b0\u8d8b\u52bf Disable \u6240\u6709\u57fa\u51c6\u6d4b\u8bd5\u6027\u80fd\u63a5\u8fd1\u57fa\u7ebf\u6216\u7565\u4f4e\uff0c\u8868\u660e\u65e0\u5b66\u4e60\u65f6 Prophet \u672a\u6fc0\u6d3b\u3002 +166 \u5728 gcc_166 \u4e0a\u6027\u80fd\u6700\u4f18\uff0c\u4f46\u5728\u5176\u4ed6\u8f93\u5165\u5982 gcc_expr\u3001gcc_typeck \u4e0a\u663e\u8457\u4f4e\u4e8e\u57fa\u7ebf\u3002 +expr \u5728 gcc_expr \u4e0a\u6027\u80fd\u63d0\u5347\uff0c\u4f46\u5bf9 gcc_typeck \u548c gcc_expr2 \u6539\u5584\u6709\u9650\u3002 +typeck \u5728 gcc_typeck \u4e0a\u6027\u80fd\u63d0\u5347\uff0c\u540c\u65f6\u5bf9 gcc_expr \u548c gcc_expr2 \u4e5f\u6709\u5c0f\u5e45\u6539\u5584\u3002 +expr2 \u5728 gcc_expr2 \u4e0a\u6027\u80fd\u8fdb\u4e00\u6b65\u63d0\u5347\uff0c\u4e14\u5bf9\u5176\u4ed6\u8f93\u5165\u4fdd\u6301\u7a33\u5b9a\u6216\u7565\u6709\u63d0\u5347\u3002 Direct \u6240\u6709\u8f93\u5165\u5747\u8fbe\u5230\u6700\u9ad8\u6027\u80fd\uff0c\u4f5c\u4e3a\u7406\u60f3\u4e0a\u9650\u53c2\u8003\u3002 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>Prophet \u7684\u6027\u80fd\u968f\u5b66\u4e60\u8f93\u5165\u6570\u91cf\u589e\u52a0\u800c\u9010\u6b65\u903c\u8fd1 Direct \u914d\u7f6e\uff0c\u8bf4\u660e\u5176\u5177\u5907\u81ea\u9002\u5e94\u80fd\u529b\u3002</li> <li>\u5373\u4f7f\u672a\u76f4\u63a5\u5b66\u4e60\u67d0\u4e9b\u8f93\u5165\uff08\u5982 gcc_200\uff09\uff0c\u901a\u8fc7\u5b66\u4e60\u76f8\u4f3c\u6a21\u5f0f\uff08\u5982 gcc_expr\uff09\u4e5f\u80fd\u95f4\u63a5\u63d0\u5347\u6027\u80fd\uff0c\u4f53\u73b0\u6cdb\u5316\u80fd\u529b\u3002</li> <li>Geomean \u663e\u793a\uff0c\u968f\u7740\u5b66\u4e60\u8f6e\u6b21\u589e\u52a0\uff0c\u6574\u4f53\u6027\u80fd\u6301\u7eed\u4e0a\u5347\uff0c\u6700\u7ec8\u63a5\u8fd1 Direct \u914d\u7f6e\uff0c\u9a8c\u8bc1\u4e86 Prophet \u7684\u6e10\u8fdb\u5f0f\u4f18\u5316\u673a\u5236\u6709\u6548\u3002</li> <li>\u7ed3\u8bba\uff1aProphet \u80fd\u901a\u8fc7\u5c11\u91cf\u8f93\u5165\u5b66\u4e60\u5b9e\u73b0\u8de8\u8f93\u5165\u6027\u80fd\u4f18\u5316\uff0c\u65e0\u9700\u4e3a\u6bcf\u4e2a\u8f93\u5165\u5355\u72ec\u8bad\u7ec3\uff0c\u663e\u8457\u964d\u4f4e\u90e8\u7f72\u6210\u672c\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-14-prophets-learning-feature-can-be-generalized-to-other-workloads-such-as-astar-and-soplex","title":"Figure 14: Prophet\u2019s learning feature can be generalized to other workloads, such as astar and soplex.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Prophet \u7684\u5b66\u4e60\u7279\u6027\u5728 astar \u548c soplex \u4e24\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u7684\u6cdb\u5316\u80fd\u529b\uff0c\u9a8c\u8bc1\u5176\u9002\u5e94\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u7684\u6709\u6548\u6027\u3002</li> <li>\u5de6\u4fa7\u56fe\u8868\u9488\u5bf9 astar \u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5305\u542b\u4e24\u4e2a\u5b50\u96c6\uff1aastar_biglakes \u548c astar_rivers\u3002\u53f3\u4fa7\u56fe\u8868\u9488\u5bf9 soplex \u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5305\u542b\u4e24\u4e2a\u5b50\u96c6\uff1asoplex_pds \u548c soplex_ref\u3002</li> <li>\u6240\u6709\u67f1\u72b6\u56fe\u5747\u4ee5 Disable\uff08\u672a\u542f\u7528 Prophet\uff09\u4e3a\u57fa\u51c6\uff0c\u6027\u80fd\u63d0\u5347\u503c\u76f8\u5bf9\u4e8e\u8be5\u57fa\u51c6\u8ba1\u7b97\u3002</li> <li>\u6bcf\u4e2a\u5b50\u56fe\u4e2d\u5305\u542b\u56db\u79cd\u914d\u7f6e\uff1a</li> <li>Disable\uff1a\u4e0d\u542f\u7528 Prophet\uff0c\u4f5c\u4e3a\u57fa\u7ebf\u3002</li> <li>+lake / +pds\uff1a\u9996\u6b21\u5b66\u4e60\u7279\u5b9a\u8f93\u5165\u540e\u7684\u6027\u80fd\u8868\u73b0\u3002</li> <li>+river / +ref\uff1a\u8fdb\u4e00\u6b65\u5b66\u4e60\u5176\u4ed6\u8f93\u5165\u540e\u7684\u6027\u80fd\u8868\u73b0\u3002</li> <li>Direct\uff1a\u76f4\u63a5\u9488\u5bf9\u5f53\u524d\u8f93\u5165\u8fdb\u884c\u4f18\u5316\u7684\u201c\u7406\u60f3\u201d\u6027\u80fd\u3002</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d \u914d\u7f6e \u6027\u80fd\u52a0\u901f\u6bd4 astar_biglakes Disable 1.00 +lake ~1.10 +river ~1.12 Direct ~1.13 astar_rivers Disable 1.00 +lake ~1.05 +river ~1.08 Direct ~1.10 soplex_pds Disable 1.00 +pds ~1.12 +ref ~1.14 Direct ~1.15 soplex_ref Disable 1.00 +pds ~1.07 +ref ~1.10 Direct ~1.12 <ul> <li>Geomean \u6807\u6ce8\u663e\u793a\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u7684\u51e0\u4f55\u5e73\u5747\u6027\u80fd\u52a0\u901f\u6bd4\uff0c\u8868\u660e Prophet \u5728\u591a\u4e2a\u8f93\u5165\u4e0b\u6301\u7eed\u63d0\u5347\u6027\u80fd\u3002</li> <li>\u7ed3\u679c\u8868\u660e\uff0cProphet \u901a\u8fc7\u8fed\u4ee3\u5b66\u4e60\u4e0d\u540c\u8f93\u5165\uff0c\u9010\u6b65\u903c\u8fd1\u201cDirect\u201d\u4f18\u5316\u7684\u6027\u80fd\uff0c\u8bc1\u660e\u5176 \u81ea\u9002\u5e94\u5b66\u4e60\u673a\u5236 \u6709\u6548\u3002</li> <li>\u5373\u4f7f\u672a\u76f4\u63a5\u9488\u5bf9\u67d0\u4e2a\u8f93\u5165\u4f18\u5316\uff08\u5982 astar_rivers \u4f7f\u7528 +lake\uff09\uff0c\u6027\u80fd\u4ecd\u4f18\u4e8e\u57fa\u7ebf\uff0c\u8bf4\u660e Prophet \u7684\u63d0\u793a\u4fe1\u606f\u5177\u6709\u8de8\u8f93\u5165\u7684 \u6cdb\u5316\u80fd\u529b\u3002</li> <li>\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u7684\u6700\u7ec8\u6027\u80fd\uff08+river / +ref\uff09\u5747\u63a5\u8fd1\u6216\u8fbe\u5230 Direct \u4f18\u5316\u6c34\u5e73\uff0c\u51f8\u663e Prophet \u5728\u5b9e\u9645\u90e8\u7f72\u4e2d\u7684\u5b9e\u7528\u4ef7\u503c\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-15-ipc-speedup-on-graph-workloads","title":"Figure 15: IPC speedup on graph workloads.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 15: IPC speedup on graph workloads\uff0c\u5c55\u793a\u7684\u662f\u5728\u56fe\u8ba1\u7b97\u5de5\u4f5c\u8d1f\u8f7d\uff08graph workloads\uff09\u4e0a\uff0c\u4e09\u79cd\u4e0d\u540c\u9884\u53d6\u65b9\u6848\u7684\u6027\u80fd\u52a0\u901f\u6bd4\uff08Performance Speedup\uff09\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u4e86\u591a\u4e2a CRONO \u57fa\u51c6\u6d4b\u8bd5\u7528\u4f8b\uff0c\u5305\u62ec <code>bc_40000_10</code>\u3001<code>bc_56384_8</code>\u3001<code>bfs_100000_16</code>\u3001<code>bfs_80000_8</code>\u3001<code>bfs_90000_10</code>\u3001<code>dfs_800000_800</code>\u3001<code>dfs_900000_400</code>\u3001<code>pagerank_100000_100</code>\u3001<code>sssp_100000_5</code>\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7efc\u5408\u6307\u6807 Geomean\u3002</li> <li>\u7eb5\u8f74\u8868\u793a\u6027\u80fd\u52a0\u901f\u6bd4\uff0c\u57fa\u51c6\u7ebf\u4e3a 1.0\uff08\u5373\u65e0\u9884\u53d6\u5668\u65f6\u7684\u6027\u80fd\uff09\uff0c\u9ad8\u4e8e 1.0 \u8868\u793a\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u56fe\u4f8b\u4e2d\u5305\u542b\u4e09\u79cd\u9884\u53d6\u65b9\u6848\uff1a</li> <li>RPG\u00b2\uff1a\u7ea2\u8272\u67f1\u72b6\u56fe\uff0c\u4ee3\u8868\u5f53\u524d\u6700\u5148\u8fdb\u7684\u8f6f\u4ef6\u95f4\u63a5\u8bbf\u95ee\u9884\u53d6\u65b9\u6848\u3002</li> <li>Triangle\uff1a\u6a59\u8272\u67f1\u72b6\u56fe\uff0c\u4ee3\u8868\u5f53\u524d\u6700\u5148\u8fdb\u7684\u786c\u4ef6\u65f6\u95f4\u9884\u53d6\u5668\u3002</li> <li>Prophet\uff1a\u7eff\u8272\u67f1\u72b6\u56fe\uff0c\u672c\u6587\u63d0\u51fa\u7684\u8f6f\u786c\u4ef6\u534f\u540c\u6846\u67b6\u3002</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d RPG\u00b2 \u52a0\u901f\u6bd4 Triangle \u52a0\u901f\u6bd4 Prophet \u52a0\u901f\u6bd4 bc_40000_10 ~1.0 ~1.0 ~1.0 bc_56384_8 ~1.0 ~1.0 ~1.0 bfs_100000_16 ~1.25 ~1.2 ~1.4 bfs_80000_8 ~1.2 ~1.1 ~1.3 bfs_90000_10 ~1.3 ~1.4 ~1.55 dfs_800000_800 ~1.0 ~1.0 ~1.0 dfs_900000_400 ~1.0 ~1.0 ~1.0 pagerank_100000_100 ~1.1 ~1.1 ~1.15 sssp_100000_5 ~1.1 ~1.1 ~1.15 Geomean 1.091 1.084 1.1485 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u5728\u5927\u591a\u6570\u56fe\u8ba1\u7b97\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cProphet \u7684\u6027\u80fd\u52a0\u901f\u6bd4\u5747\u4f18\u4e8e RPG\u00b2 \u548c Triangle\u3002</li> <li>\u5728 <code>bfs_90000_10</code> \u4e0a\uff0cProphet \u8fbe\u5230\u6700\u9ad8\u52a0\u901f\u6bd4 ~1.55\uff0c\u663e\u8457\u9886\u5148\u4e8e\u5176\u4ed6\u4e24\u79cd\u65b9\u6848\u3002</li> <li>\u7efc\u5408\u51e0\u4f55\u5e73\u5747\u503c\uff08Geomean\uff09\u663e\u793a\uff0cProphet \u76f8\u8f83\u4e8e\u57fa\u7ebf\u63d0\u5347\u4e86 14.85%\uff0c\u800c RPG\u00b2 \u4e3a 9.11%\uff0cTriangle \u4e3a 8.41%\u3002</li> <li> <p>\u5c3d\u7ba1 CRONO \u5de5\u4f5c\u8d1f\u8f7d\u66f4\u503e\u5411\u4e8e\u5177\u6709\u6b65\u957f\u6a21\u5f0f\u7684\u9884\u53d6\u5185\u6838\uff08\u9002\u5408 RPG\u00b2\uff09\uff0cProphet \u4ecd\u80fd\u901a\u8fc7\u5904\u7406\u66f4\u590d\u6742\u7684\u65f6\u95f4\u6a21\u5f0f\u5b9e\u73b0\u8d85\u8d8a\u3002</p> </li> <li> <p>\u7ed3\u8bba\uff1a</p> </li> <li>Prophet \u5728\u56fe\u8ba1\u7b97\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5c55\u73b0\u51fa\u5353\u8d8a\u7684\u6027\u80fd\u4f18\u52bf\uff0c\u5373\u4f7f\u5728 RPG\u00b2 \u672c\u5e94\u8868\u73b0\u826f\u597d\u7684\u573a\u666f\u4e0b\uff0c\u4e5f\u80fd\u901a\u8fc7\u5176\u7075\u6d3b\u7684\u5143\u6570\u636e\u7ba1\u7406\u673a\u5236\u83b7\u5f97\u66f4\u9ad8\u6536\u76ca\u3002</li> <li>\u8fd9\u9a8c\u8bc1\u4e86 Prophet \u4e0d\u4ec5\u9002\u7528\u4e8e SPEC CPU \u7c7b\u578b\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u4e5f\u5177\u5907\u826f\u597d\u7684\u901a\u7528\u6027\u548c\u6269\u5c55\u6027\uff0c\u53ef\u6709\u6548\u5e94\u5bf9\u591a\u6837\u5316\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-16-sensitivity-study","title":"Figure 16: Sensitivity study.","text":"<ul> <li>\u56fe 16 \u662f\u4e00\u9879\u654f\u611f\u6027\u7814\u7a76\uff0c\u65e8\u5728\u8bc4\u4f30 Prophet \u6846\u67b6\u4e2d\u4e09\u4e2a\u5173\u952e\u53c2\u6570\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\uff1aEL_ACC\uff08\u63d2\u5165\u7b56\u7565\u9608\u503c\uff09\u3001n\uff08\u66ff\u6362\u7b56\u7565\u4f18\u5148\u7ea7\u4f4d\u6570\uff09\u548c Multi-path Victim Buffer \u4e2d\u7684\u5019\u9009\u6570\u91cf\u3002</li> <li>\u8be5\u56fe\u7531\u4e09\u4e2a\u5b50\u56fe\u7ec4\u6210\uff0c\u6bcf\u4e2a\u5b50\u56fe\u5c55\u793a\u4e0d\u540c\u53c2\u6570\u914d\u7f6e\u4e0b\u7684\u6027\u80fd\u52a0\u901f\u6bd4\uff08Performance Speedup\uff09\uff0c\u57fa\u51c6\u4e3a 1.0\uff08\u7ea2\u8272\u865a\u7ebf\uff09\uff0c\u5e76\u5305\u542b\u5404\u5de5\u4f5c\u8d1f\u8f7d\u7684\u51e0\u4f55\u5e73\u5747\u503c\uff08Geomean\uff09\u3002 (a) EL_ACC \u53c2\u6570\u654f\u611f\u6027\u5206\u6790</li> <li>\u6b64\u90e8\u5206\u7814\u7a76 Prophet Insertion Policy \u4e2d\u7684 <code>EL_ACC</code> \u9608\u503c\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\uff0c\u6d4b\u8bd5\u4e86\u4e09\u4e2a\u503c\uff1a0.05\u30010.15 \u548c 0.25\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u8fc7\u4f4e\u6216\u8fc7\u9ad8 \u7684 <code>EL_ACC</code> \u503c\u5747\u4f1a\u635f\u5bb3\u6027\u80fd\uff1a</li> <li><code>EL_ACC=0.05</code>\uff1a\u8fc7\u6ee4\u8fc7\u4e8e\u6fc0\u8fdb\uff0c\u53ef\u80fd\u8bef\u5220\u6709\u7528\u5143\u6570\u636e\u3002</li> <li><code>EL_ACC=0.25</code>\uff1a\u8fc7\u6ee4\u8fc7\u4e8e\u5bbd\u677e\uff0c\u5bfc\u81f4\u5143\u6570\u636e\u8868\u5145\u65a5\u65e0\u6548\u6761\u76ee\u3002</li> <li><code>EL_ACC=0.15</code> \u5728\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u8868\u73b0\u6700\u4f73\uff0c\u5c24\u5176\u5728 <code>mcf</code> \u548c <code>omnetpp</code> \u4e0a\u63d0\u5347\u663e\u8457\u3002</li> <li>\u51e0\u4f55\u5e73\u5747\u6027\u80fd\u52a0\u901f\u6bd4\uff1a   | EL_ACC \u503c | Geomean Speedup |   |-----------|------------------|   | 0.05      | ~1.25            |   | 0.15      | ~1.38        |   | 0.25      | ~1.28            | (b) n \u53c2\u6570\u654f\u611f\u6027\u5206\u6790</li> <li>\u6b64\u90e8\u5206\u7814\u7a76 Prophet Replacement Policy \u4e2d\u7528\u4e8e\u8868\u793a\u4f18\u5148\u7ea7\u7684\u4f4d\u6570 <code>n</code>\uff0c\u6d4b\u8bd5\u4e86 1\u30012\u30013 \u4f4d\u3002</li> <li>\u7ed3\u679c\u663e\u793a\uff0c\u589e\u52a0 <code>n</code> \u53ef\u5e26\u6765\u66f4\u7ec6\u7c92\u5ea6\u7684\u7ba1\u7406\uff0c\u4ece\u800c\u63d0\u5347\u6027\u80fd\uff0c\u4f46\u6536\u76ca\u9012\u51cf\uff1a</li> <li><code>n=1</code>\uff1a\u4ec5\u80fd\u533a\u5206\u9ad8\u4f4e\u4f18\u5148\u7ea7\uff0c\u6027\u80fd\u63d0\u5347\u6709\u9650\u3002</li> <li><code>n=2</code>\uff1a\u63d0\u4f9b\u56db\u6863\u4f18\u5148\u7ea7\uff0c\u6027\u80fd\u663e\u8457\u4f18\u4e8e <code>n=1</code>\uff0c\u662f\u63a8\u8350\u914d\u7f6e\u3002</li> <li><code>n=3</code>\uff1a\u867d\u8fdb\u4e00\u6b65\u7ec6\u5206\uff0c\u4f46\u5b58\u50a8\u5f00\u9500\u589e\u52a0\uff0c\u6027\u80fd\u589e\u76ca\u4e0d\u660e\u663e\u3002</li> <li>\u51e0\u4f55\u5e73\u5747\u6027\u80fd\u52a0\u901f\u6bd4\uff1a   | n \u503c | Geomean Speedup |   |------|------------------|   | 1    | ~1.30            |   | 2    | ~1.40        |   | 3    | ~1.42            | (c) Multi-path Victim Buffer \u5019\u9009\u6570\u91cf\u654f\u611f\u6027\u5206\u6790</li> <li>\u6b64\u90e8\u5206\u7814\u7a76 Multi-path Victim Buffer \u4e2d\u6bcf\u4e2a\u5143\u6570\u636e\u6761\u76ee\u53ef\u5b58\u50a8\u7684 Markov \u76ee\u6807\u5019\u9009\u6570\u91cf\uff08Candidate=1, 2, 4\uff09\u3002</li> <li>\u7ed3\u679c\u663e\u793a\uff0cCandidate=1 \u5728\u6027\u80fd\u4e0e\u5b58\u50a8\u5f00\u9500\u95f4\u53d6\u5f97\u6700\u4f73\u5e73\u8861\uff1a</li> <li>Candidate=1\uff1a\u6027\u80fd\u7a33\u5b9a\uff0c\u5b58\u50a8\u5f00\u9500\u6700\u5c0f\u3002</li> <li>Candidate=2/4\uff1a\u867d\u7136\u8986\u76d6\u66f4\u591a\u6a21\u5f0f\uff0c\u4f46\u5728 <code>astar</code> \u7b49\u5bf9\u7f13\u5b58\u6c61\u67d3\u654f\u611f\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u53cd\u800c\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002</li> <li> <p>\u51e0\u4f55\u5e73\u5747\u6027\u80fd\u52a0\u901f\u6bd4\uff1a   | Candidate \u6570\u91cf | Geomean Speedup |   |----------------|------------------|   | 1              | ~1.35        |   | 2              | ~1.33            |   | 4              | ~1.32            |</p> </li> <li> <p>\u603b\u4f53\u7ed3\u8bba\uff1aProphet \u7684\u53c2\u6570\u8bbe\u8ba1\u9700\u6743\u8861\u6027\u80fd\u589e\u76ca\u4e0e\u8d44\u6e90\u5f00\u9500\u3002EL_ACC=0.15\u3001n=2\u3001Candidate=1 \u662f\u7efc\u5408\u6700\u4f18\u914d\u7f6e\uff0c\u517c\u987e\u9ad8\u6548\u6027\u4e0e\u5b9e\u7528\u6027\u3002</p> </li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-17-ipc-speedup-with-varying-l1-prefetcher","title":"Figure 17: IPC speedup with varying L1 prefetcher.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 17: IPC speedup with varying L1 prefetcher\uff0c\u5c55\u793a\u5728\u4e0d\u540c L1 \u9884\u53d6\u5668\u914d\u7f6e\u4e0b\uff0c\u4e09\u79cd\u9884\u53d6\u65b9\u6848\uff08RPG\u00b2\u3001Triangel\u3001Prophet\uff09\u7684\u6027\u80fd\u52a0\u901f\u6bd4\uff08IPC Speedup\uff09\u3002</li> <li>\u6027\u80fd\u57fa\u51c6\u7ebf\u4e3a 1.0\uff08\u7ea2\u8272\u865a\u7ebf\uff09\uff0c\u4ee3\u8868\u65e0 temporal prefetcher \u7684\u57fa\u7ebf\u6027\u80fd\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u591a\u4e2a SPEC CPU \u5de5\u4f5c\u8d1f\u8f7d\uff1aastar_biglakes, gcc_166, mcf, omnetpp, soplex_pds-50, sphinx3, xalancbmk\uff0c\u4ee5\u53ca\u6574\u4f53\u51e0\u4f55\u5e73\u5747\u503c Geomean\u3002</li> <li>\u7eb5\u8f74\u4e3a\u6027\u80fd\u52a0\u901f\u6bd4\uff0c\u8303\u56f4\u4ece 1.0 \u5230 1.8\u3002</li> <li>\u4e09\u7ec4\u67f1\u72b6\u56fe\u5206\u522b\u4ee3\u8868\uff1a</li> <li>RPG\u00b2\uff08\u7ea2\u8272\uff09\uff1a\u8f6f\u4ef6\u95f4\u63a5\u8bbf\u95ee\u9884\u53d6\u65b9\u6848\u3002</li> <li>Triangel\uff08\u6a59\u8272\uff09\uff1a\u5f53\u524d\u6700\u5148\u8fdb\u7684\u786c\u4ef6\u65f6\u5e8f\u9884\u53d6\u5668\u3002</li> <li>Prophet\uff08\u7eff\u8272\uff09\uff1a\u672c\u6587\u63d0\u51fa\u7684\u8f6f\u786c\u4ef6\u534f\u540c\u6846\u67b6\u3002</li> <li>\u5728\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cProphet \u5747\u4f18\u4e8e RPG\u00b2 \u548c Triangel\uff0c\u5c24\u5176\u5728 mcf \u548c gcc_166 \u4e0a\u8868\u73b0\u7a81\u51fa\u3002</li> <li>Geomean \u663e\u793a Prophet \u8fbe\u5230\u7ea6 1.30 \u52a0\u901f\u6bd4\uff0cTriangel \u7ea6 1.18\uff0cRPG\u00b2 \u4ec5\u7ea6 1.00\uff0c\u8868\u660e Prophet \u5728\u7efc\u5408\u6027\u80fd\u4e0a\u663e\u8457\u9886\u5148\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u5373\u4f7f\u5728\u66f4\u590d\u6742\u7684 L1 \u9884\u53d6\u5668\u914d\u7f6e\u4e0b\uff08\u5982\u66ff\u6362\u4e3a IPCP\uff09\uff0cProphet \u4ecd\u4fdd\u6301\u7a33\u5b9a\u4e14\u663e\u8457\u7684\u6027\u80fd\u4f18\u52bf\uff0c\u9a8c\u8bc1\u5176\u8bbe\u8ba1\u7684\u9c81\u68d2\u6027\u3002</li> </ul> Workload RPG\u00b2 Speedup Triangel Speedup Prophet Speedup astar_biglakes ~1.0 ~1.1 ~1.2 gcc_166 ~1.0 ~1.5 ~1.6 mcf ~1.0 ~1.6 ~1.7 omnetpp ~1.0 ~1.1 ~1.2 soplex_pds-50 ~1.0 ~1.1 ~1.2 sphinx3 ~1.0 ~1.1 ~1.2 xalancbmk ~1.0 ~1.1 ~1.3 Geomean ~1.00 ~1.18 ~1.30 <ul> <li>\u7ed3\u8bba\uff1aProphet \u5728\u591a\u6837\u5316 L1 \u9884\u53d6\u5668\u73af\u5883\u4e0b\u4ecd\u80fd\u63d0\u4f9b\u6700\u9ad8\u6027\u80fd\u589e\u76ca\uff0c\u8bc1\u660e\u5176\u5143\u6570\u636e\u7ba1\u7406\u7b56\u7565\u7684\u6709\u6548\u6027\u548c\u9002\u5e94\u6027\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-18-ipc-speedup-with-varying-dram-channels","title":"Figure 18: IPC speedup with varying DRAM channels.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u4e0d\u540c DRAM \u901a\u9053\u914d\u7f6e\u4e0b\uff0cProphet\u3001Triangel \u548c RPG\u00b2 \u4e09\u79cd\u9884\u53d6\u65b9\u6848\u76f8\u5bf9\u4e8e\u57fa\u7ebf\uff08\u65e0\u65f6\u95f4\u9884\u53d6\u5668\uff09\u7684\u6027\u80fd\u52a0\u901f\u6bd4\uff08Performance Speedup\uff09\uff0c\u6a2a\u8f74\u4e3a SPEC CPU \u5de5\u4f5c\u8d1f\u8f7d\uff0c\u7eb5\u8f74\u4e3a IPC \u52a0\u901f\u500d\u6570\u3002</li> <li>\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cProphet \u5747\u663e\u8457\u4f18\u4e8e Triangel \u548c RPG\u00b2\uff0c\u5176\u51e0\u4f55\u5e73\u5747\u52a0\u901f\u6bd4\u8fbe\u5230 1.3227\uff0c\u5373 32.27% \u7684\u6027\u80fd\u63d0\u5347\u3002</li> <li>RPG\u00b2 \u5728\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u8868\u73b0\u6700\u5dee\uff0c\u5176\u51e0\u4f55\u5e73\u5747\u52a0\u901f\u6bd4\u4ec5\u4e3a 1.001\uff0c\u5373\u4ec5 0.1% \u7684\u6027\u80fd\u589e\u76ca\uff0c\u8868\u660e\u5176\u5bf9\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u4f18\u5316\u80fd\u529b\u6709\u9650\u3002</li> <li>Triangel \u8868\u73b0\u5c45\u4e2d\uff0c\u51e0\u4f55\u5e73\u5747\u52a0\u901f\u6bd4\u4e3a 1.1817\uff0c\u5373 18.17% \u7684\u6027\u80fd\u63d0\u5347\uff0c\u867d\u4f18\u4e8e RPG\u00b2\uff0c\u4f46\u660e\u663e\u843d\u540e\u4e8e Prophet\u3002</li> <li>\u5404\u5de5\u4f5c\u8d1f\u8f7d\u5177\u4f53\u52a0\u901f\u6bd4\u6570\u636e\u5982\u4e0b\u8868\u6240\u793a\uff1a</li> </ul> Workload RPG\u00b2 Triangel Prophet astar_biglakes 1.00 1.10 1.15 gcc_166 1.00 1.55 1.58 mcf 1.00 1.35 1.50 omnetpp 1.00 1.05 1.15 soplex_pds-50 1.00 1.10 1.40 sphinx3 1.00 1.20 1.40 xalancbmk 1.00 1.20 1.25 Geomean 1.001 1.1817 1.3227 <ul> <li>Prophet \u5728 gcc_166\u3001mcf\u3001soplex_pds-50 \u548c sphinx3 \u7b49\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u4f18\u52bf\u5c24\u4e3a\u660e\u663e\uff0c\u52a0\u901f\u6bd4\u5747\u8d85\u8fc7 1.4\uff0c\u6700\u9ad8\u8fbe 1.58\u3002</li> <li>\u5373\u4f7f\u5728\u5185\u5b58\u5e26\u5bbd\u53d7\u9650\u6216\u589e\u52a0\u7684\u60c5\u51b5\u4e0b\uff08\u5982\u56fe\u6807\u9898\u6240\u793a\u201cvarying DRAM channels\u201d\uff09\uff0cProphet \u4ecd\u4fdd\u6301\u7a33\u5b9a\u4e14\u663e\u8457\u7684\u6027\u80fd\u4f18\u52bf\uff0c\u8bc1\u660e\u5176\u8bbe\u8ba1\u5bf9\u5185\u5b58\u5b50\u7cfb\u7edf\u53d8\u5316\u5177\u6709\u9c81\u68d2\u6027\u3002</li> <li>\u8be5\u7ed3\u679c\u9a8c\u8bc1\u4e86 Prophet \u7684\u6838\u5fc3\u4f18\u52bf\uff1a\u901a\u8fc7 Profile-Guided \u65b9\u6cd5\u4f18\u5316\u5143\u6570\u636e\u7ba1\u7406\uff0c\u5728\u590d\u6742\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u4e0b\u5b9e\u73b0\u9ad8\u6548\u9884\u53d6\uff0c\u540c\u65f6\u907f\u514d\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u7684\u4f4e\u6548\u8fc7\u6ee4\u4e0e\u66ff\u6362\u7b56\u7565\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/figs_notes/#figure-19-prophet-features-breakdown","title":"Figure 19: Prophet Features Breakdown.","text":"<ul> <li>\u56fe\u7247\u4e3a Figure 19\uff0c\u6807\u9898\u4e3a \u201cProphet Features Breakdown\u201d\uff0c\u5c55\u793a Prophet \u5404\u529f\u80fd\u6a21\u5757\u5bf9\u6027\u80fd\u548c DRAM \u6d41\u91cf\u7684\u5f71\u54cd\u3002</li> <li>\u56fe\u8868\u5206\u4e3a\u4e24\u90e8\u5206\uff1a(a) Performance Speedup \u548c (b) Normalized DRAM Traffic\uff0c\u6a2a\u8f74\u4e3a SPEC CPU \u5de5\u4f5c\u8d1f\u8f7d\uff0c\u7eb5\u8f74\u5206\u522b\u4e3a\u5f52\u4e00\u5316\u6027\u80fd\u52a0\u901f\u6bd4\u548c\u5f52\u4e00\u5316 DRAM \u6d41\u91cf\u3002</li> <li>\u57fa\u7ebf\u4e3a Triage4 + Triangel Meta\uff0c\u5373\u5728 Triage \u7684\u57fa\u7840\u4e0a\u4f7f\u7528 Triangel \u7684\u5143\u6570\u636e\u683c\u5f0f\uff0c\u4f5c\u4e3a\u6240\u6709\u529f\u80fd\u53e0\u52a0\u7684\u8d77\u70b9\u3002</li> <li>\u5404\u529f\u80fd\u6a21\u5757\u4ee5\u4e0d\u540c\u989c\u8272\u67f1\u72b6\u56fe\u8868\u793a\uff1a</li> <li>+Repla\uff1aProphet Replacement Policy</li> <li>+Insert\uff1aProphet Insertion Policy</li> <li>+MVB\uff1aMulti-path Victim Buffer</li> <li>+Resize\uff1aProphet Resizing \u6027\u80fd\u52a0\u901f\u6bd4\uff08Performance Speedup\uff09\u5206\u6790\uff1a</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d Triage4 + Triangel Meta +Repla +Insert +MVB +Resize astar_biglakes ~1.0 ~1.2 ~1.1 ~1.1 ~1.1 gcc_166 ~1.0 ~1.5 ~1.5 ~1.5 ~1.5 mcf ~1.0 ~1.6 ~1.7 ~1.6 ~1.6 omnetpp ~1.0 ~1.3 ~1.3 ~1.4 ~1.4 soplex_pds-50 ~1.0 ~1.3 ~1.2 ~1.4 ~1.4 sphinx3 ~1.0 ~1.3 ~1.3 ~1.3 ~1.4 xalancbmk ~1.0 ~1.3 ~1.3 ~1.3 ~1.3 Geomean 1.0 1.38 1.35 1.41 1.42 <ul> <li>Geomean \u6027\u80fd\u52a0\u901f\u6bd4\uff1a\u4ece\u57fa\u7ebf 1.0 \u63d0\u5347\u81f3 1.42\uff0c\u8868\u660e Prophet \u6574\u4f53\u4f18\u5316\u6548\u679c\u663e\u8457\u3002</li> <li>Multi-path Victim Buffer\uff08+MVB\uff09 \u5bf9\u591a\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982 soplex_pds-50\u3001omnetpp\uff09\u8d21\u732e\u6700\u5927\uff0c\u5c24\u5176\u5728 soplex \u4e0a\u63d0\u5347\u8fbe 13.46%\u3002</li> <li>Prophet Insertion Policy\uff08+Insert\uff09 \u5728 mcf \u4e0a\u8868\u73b0\u7a81\u51fa\uff0c\u5e26\u6765 16.72% \u7684\u6027\u80fd\u589e\u76ca\u3002</li> <li>Prophet Replacement Policy\uff08+Repla\uff09 \u5728 mcf \u548c omnetpp \u4e0a\u5206\u522b\u63d0\u5347 14.53% \u548c 9.89%\uff0c\u663e\u793a\u5176\u5728\u5927\u5de5\u4f5c\u96c6\u548c\u7f13\u5b58\u6c61\u67d3\u654f\u611f\u573a\u666f\u4e2d\u7684\u6709\u6548\u6027\u3002 \u5f52\u4e00\u5316 DRAM \u6d41\u91cf\uff08Normalized DRAM Traffic\uff09\u5206\u6790\uff1a</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d Triage4 + Triangel Meta +Repla +Insert +MVB +Resize astar_biglakes ~1.2 ~1.2 ~1.1 ~1.1 ~1.1 gcc_166 ~1.1 ~1.1 ~1.1 ~1.1 ~1.1 mcf ~1.2 ~1.2 ~1.1 ~1.2 ~1.2 omnetpp ~1.3 ~1.2 ~1.2 ~1.2 ~1.2 soplex_pds-50 ~1.2 ~1.2 ~1.2 ~1.2 ~1.2 sphinx3 ~1.1 ~1.1 ~1.1 ~1.1 ~1.1 xalancbmk ~1.2 ~1.2 ~1.2 ~1.2 ~1.2 Geomean 1.2 1.2 1.1 1.2 1.2 <ul> <li>Geomean DRAM \u6d41\u91cf\uff1a\u57fa\u7ebf\u4e3a 1.2\uff0cProphet Insertion Policy\uff08+Insert\uff09 \u5c06\u5176\u964d\u81f3 1.1\uff0c\u8868\u660e\u8be5\u7b56\u7565\u6709\u6548\u51cf\u5c11\u65e0\u6548\u9884\u53d6\uff0c\u964d\u4f4e\u5185\u5b58\u6d41\u91cf\u3002</li> <li>Multi-path Victim Buffer\uff08+MVB\uff09 \u867d\u589e\u52a0\u5c11\u91cf\u6d41\u91cf\uff08+1.95%\uff09\uff0c\u4f46\u56e0\u5176\u63d0\u5347\u6027\u80fd\u663e\u8457\uff0c\u6574\u4f53\u4ecd\u5177\u6027\u4ef7\u6bd4\u3002</li> <li> <p>\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0c+Insert \u662f\u552f\u4e00\u663e\u8457\u964d\u4f4e DRAM \u6d41\u91cf\u7684\u529f\u80fd\uff0c\u4f53\u73b0\u5176\u4fdd\u5b88\u8fc7\u6ee4\u7b56\u7565\u7684\u6709\u6548\u6027\u3002 \u5173\u952e\u7ed3\u8bba\uff1a</p> </li> <li> <p>Prophet Replacement Policy \u548c Multi-path Victim Buffer \u662f\u6027\u80fd\u63d0\u5347\u7684\u4e3b\u8981\u9a71\u52a8\u529b\uff0c\u5c24\u5176\u5728\u590d\u6742\u8bbf\u95ee\u6a21\u5f0f\u4e0b\u3002</p> </li> <li>Prophet Insertion Policy \u5728\u4fdd\u6301\u9ad8\u8986\u76d6\u7387\u7684\u540c\u65f6\uff0c\u6709\u6548\u63a7\u5236\u5185\u5b58\u6d41\u91cf\uff0c\u907f\u514d\u8fc7\u5ea6\u9884\u53d6\u3002</li> <li>Prophet Resizing \u5bf9\u5c0f\u5143\u6570\u636e\u9700\u6c42\u5e94\u7528\uff08\u5982 sphinx3\uff09\u6700\u6709\u6548\uff0c\u5e26\u6765\u7ea6 1.5% \u7684\u6027\u80fd\u589e\u76ca\u3002</li> <li>\u6240\u6709\u529f\u80fd\u53ef\u6a21\u5757\u5316\u542f\u7528/\u7981\u7528\uff0c\u5141\u8bb8\u6839\u636e\u5de5\u4f5c\u8d1f\u8f7d\u7279\u6027\u7075\u6d3b\u914d\u7f6e\uff0c\u5b9e\u73b0\u6027\u80fd\u4e0e\u8d44\u6e90\u6d88\u8017\u7684\u5e73\u8861\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/","title":"Profile-Guided Temporal Prefetching \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Mengming Li (HKUST) - Qijun Zhang (HKUST) - Yichuan Gao (Intel) - Wenji Fang (HKUST) - Yao Lu (HKUST) - Yongqing Ren (Intel) - Zhiyao Xie (HKUST)</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - Proceedings of the 52nd Annual International Symposium on Computer Architecture (ISCA \u201925)</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - 2025</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u73b0\u6709 Temporal Prefetching\uff08\u65f6\u95f4\u5c40\u90e8\u6027\u9884\u53d6\uff09\u65b9\u6848\u5728\u7ba1\u7406\u6709\u9650\u7684 on-chip metadata storage\uff08\u7247\u4e0a\u5143\u6570\u636e\u5b58\u50a8\uff09\u65f6\u6548\u7387\u4f4e\u4e0b\u7684\u95ee\u9898\u3002 - \u73b0\u6709\u786c\u4ef6\u65b9\u6848\uff08\u5982 Triangel\uff09\u56e0\u7f3a\u4e4f\u5bf9\u7a0b\u5e8f\u672a\u6765\u884c\u4e3a\u7684\u6d1e\u5bdf\uff0c\u5176 insertion policy\uff08\u63d2\u5165\u7b56\u7565\uff09\u548c replacement policy\uff08\u66ff\u6362\u7b56\u7565\uff09\u65e0\u6cd5\u6709\u6548\u5e73\u8861\u6027\u80fd\u589e\u76ca\u4e0e\u5b58\u50a8\u5f00\u9500\uff0c\u5e38\u9519\u8bef\u5730\u8fc7\u6ee4\u6389\u6709\u7528\u7684\u5143\u6570\u636e\u6216\u4fdd\u7559\u65e0\u7528\u7684\u5143\u6570\u636e\u3002 - \u73b0\u6709\u7684 Profile-Guided\uff08\u914d\u7f6e\u6587\u4ef6\u5f15\u5bfc\uff09\u8f6f\u4ef6\u9884\u53d6\u65b9\u6848\uff08\u5982 RPG2\uff09\u4ec5\u5bf9\u5177\u6709\u89c4\u5219\u6b65\u957f\u6a21\u5f0f\u7684\u95f4\u63a5\u8bbf\u95ee\u6709\u6548\uff0c\u65e0\u6cd5\u5904\u7406\u6307\u9488\u8ffd\u9010\u7b49\u590d\u6742\u7684\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa Prophet\uff0c\u4e00\u4e2a hardware-software co-designed framework\uff08\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1\u6846\u67b6\uff09\uff0c\u5229\u7528\u8f7b\u91cf\u7ea7\u7684 profile-guided \u65b9\u6cd5\u6765\u4f18\u5316\u786c\u4ef6\u65f6\u95f4\u9884\u53d6\u5668\u7684\u5143\u6570\u636e\u8868\u7ba1\u7406\u3002 - \u8f7b\u91cf\u7ea7\u5256\u6790 (Lightweight Profiling)\uff1a\u4f7f\u7528 PMU counters\uff08\u6027\u80fd\u76d1\u63a7\u5355\u5143\u8ba1\u6570\u5668\uff09\u800c\u975e\u5b8c\u6574\u7684\u6267\u884c\u8f68\u8ff9\u8fdb\u884c\u5256\u6790\uff0c\u5f00\u9500\u6781\u4f4e\u3002 - Hint \u6ce8\u5165\u4e0e\u52a8\u6001\u8c03\u4f18 (Hint Injection &amp; Dynamic Tuning)\uff1a   - \u901a\u8fc7\u79bb\u7ebf\u5206\u6790\u8ba1\u6570\u5668\u6570\u636e\uff0c\u4e3a\u7a0b\u5e8f\u6ce8\u5165 hints\uff08\u63d0\u793a\uff09\uff0c\u4ee5\u6307\u5bfc\u786c\u4ef6\u9884\u53d6\u5668\u7684 insertion policy, replacement policy, \u548c resizing\uff08\u91cd\u5206\u914d\u5927\u5c0f\uff09\u64cd\u4f5c\u3002   - \u8bbe\u8ba1\u4e86 Learning \u673a\u5236\uff0c\u80fd\u591f\u6574\u5408\u6765\u81ea\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u7684\u5256\u6790\u6570\u636e\uff0c\u4f7f\u5355\u4e2a\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u80fd\u81ea\u9002\u5e94\u591a\u79cd\u8f93\u5165\u3002 - \u517c\u5bb9\u6027\u8bbe\u8ba1 (Compatibility)\uff1aProphet \u4e0e\u73b0\u6709\u7684\u786c\u4ef6\u65f6\u95f4\u9884\u53d6\u5668\uff08\u5982 Triangel\uff09\u5171\u5b58\uff0c\u5171\u4eab\u540c\u4e00\u4e2a\u5143\u6570\u636e\u8868\uff0c\u4ec5\u5728\u9891\u7e41\u6267\u884c\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u542f\u7528\u5176\u4f18\u5316\u7b56\u7565\u3002 - \u5173\u952e\u6280\u672f\u7ec4\u4ef6\uff1a   - Profile-Guided Insertion Policy\uff1a\u57fa\u4e8e\u6307\u4ee4\u7ea7\uff08PC-level\uff09\u7684\u9884\u53d6\u51c6\u786e\u7387\uff0c\u8fc7\u6ee4\u6389\u51e0\u4e4e\u4e0d\u4ea7\u751f\u6709\u7528\u9884\u53d6\u7684\u5185\u5b58\u6307\u4ee4\u3002   - Profile-Guided Replacement Policy\uff1a\u4e3a\u5143\u6570\u636e\u6761\u76ee\u5206\u914d\u57fa\u4e8e\u9884\u53d6\u51c6\u786e\u7387\u7684\u4f18\u5148\u7ea7\uff0c\u5728\u66ff\u6362\u65f6\u4f18\u5148\u6dd8\u6c70\u4f4e\u4f18\u5148\u7ea7\u6761\u76ee\u3002   - Multi-path Victim Buffer\uff1a\u4e3a\u89e3\u51b3\u5355\u4e2a\u5730\u5740\u53ef\u80fd\u6709\u591a\u4e2a Markov targets\uff08\u9a6c\u5c14\u53ef\u592b\u76ee\u6807\uff09\u7684\u95ee\u9898\uff0c\u5f15\u5165\u4e00\u4e2a\u8f85\u52a9\u7f13\u51b2\u533a\u6765\u5b58\u50a8\u88ab\u9a71\u9010\u4f46\u4ecd\u6709\u4ef7\u503c\u7684\u76ee\u6807\u5730\u5740\u3002</p> <p></p> <p>Figure 8: The percentage of Markov target number (T) in temporal prefetching. Figure 9: The Multi-path Victim Buffer.</p> <p></p> <p>\u7ed3\u679c - \u5728 SPEC CPU \u7b49\u4ee3\u8868\u6027\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0cProphet \u76f8\u6bd4\u57fa\u7ebf\uff08\u65e0\u65f6\u95f4\u9884\u53d6\u5668\uff09\u5b9e\u73b0\u4e86 34.58% \u7684 IPC \u52a0\u901f\u3002 - \u6027\u80fd\u5bf9\u6bd4\uff1a   - \u76f8\u6bd4\u6700\u5148\u8fdb\u7684\u8f6f\u4ef6\u95f4\u63a5\u8bbf\u95ee\u9884\u53d6\u65b9\u6848 RPG2\uff08\u4ec5\u63d0\u5347 0.1%\uff09\uff0cProphet \u6027\u80fd\u9ad8\u51fa 34.48%\u3002   - \u76f8\u6bd4\u6700\u5148\u8fdb\u7684\u786c\u4ef6\u65f6\u95f4\u9884\u53d6\u5668 Triangel\uff08\u63d0\u5347 20.35%\uff09\uff0cProphet \u6027\u80fd\u9ad8\u51fa 14.23%\u3002 - \u6548\u80fd\u5206\u6790\uff1a   - Prophet \u7684\u6027\u80fd\u589e\u76ca\u4e3b\u8981\u6765\u6e90\u4e8e\u66f4\u9ad8\u6548\u7684\u5143\u6570\u636e\u7ba1\u7406\uff0c\u5b83\u540c\u65f6\u63d0\u5347\u4e86 prefetching coverage\uff08\u9884\u53d6\u8986\u76d6\u7387\uff09\u548c\u7ef4\u6301\u4e86\u9ad8 prefetching accuracy\uff08\u9884\u53d6\u51c6\u786e\u7387\uff09\u3002</p> <p></p> <p>Figure 12: Prefetching coverage and accuracy6.</p> <ul> <li>\u81ea\u9002\u5e94\u80fd\u529b\uff1a\u901a\u8fc7 Learning \u673a\u5236\uff0cProphet \u80fd\u591f\u5728\u4e00\u4e2a\u4f18\u5316\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\uff0c\u4e3a gcc \u7b49\u5e94\u7528\u7684\u4e0d\u540c\u8f93\u5165\u5b9e\u73b0\u63a5\u8fd1\u6700\u4f18\u7684\u6027\u80fd\u3002</li> </ul> <p></p> <p>Figure 13: Prophet learns counters from gcc\u2019s inputs.</p> <ul> <li>\u5f00\u9500\uff1a\u5256\u6790\u3001\u5206\u6790\u548c\u6307\u4ee4\u5f00\u9500\u5747\u53ef\u5ffd\u7565\u4e0d\u8ba1\uff1b\u76f8\u6bd4 Triangel\uff0c\u4ec5\u5f15\u5165 1.6% \u7684\u989d\u5916\u80fd\u8017\u5f00\u9500\u3002</li> </ul> \u65b9\u6848 \u76f8\u6bd4\u57fa\u7ebf IPC \u63d0\u5347 \u76f8\u6bd4 RPG2 \u63d0\u5347 \u76f8\u6bd4 Triangel \u63d0\u5347 RPG2 0.1% - -34.48% Triangel 20.35% 20.25% - Prophet 34.58% 34.48% 14.23% <p>\u7ed3\u8bba - Prophet \u6210\u529f\u5730\u5c06 profile-guided optimization \u5e94\u7528\u4e8e temporal prefetching \u7684\u5143\u6570\u636e\u7ba1\u7406\uff0c\u514b\u670d\u4e86\u7eaf\u786c\u4ef6\u65b9\u6848\u56e0\u7f3a\u4e4f\u5168\u5c40\u89c6\u91ce\u800c\u5bfc\u81f4\u7684\u6548\u7387\u4f4e\u4e0b\u95ee\u9898\u3002 - \u901a\u8fc7\u4f7f\u7528 counters \u8fdb\u884c\u8f7b\u91cf\u7ea7\u5256\u6790\u3001\u6ce8\u5165 hints \u6307\u5bfc\u786c\u4ef6\u51b3\u7b56\u4ee5\u53ca\u521b\u65b0\u7684 Learning \u673a\u5236\uff0cProphet \u5b9e\u73b0\u4e86 adaptable\uff08\u81ea\u9002\u5e94\uff09\u3001lightweight\uff08\u8f7b\u91cf\u7ea7\uff09\u548c compatible\uff08\u517c\u5bb9\u6027\u597d\uff09\u7684\u4f18\u5316\u3002 - Prophet \u5728\u5904\u7406\u590d\u6742\u3001\u4e0d\u89c4\u5219\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u4e0a\u663e\u8457\u4f18\u4e8e\u73b0\u6709\u65b9\u6848\uff0c\u4e3a\u89e3\u51b3\u201c\u5185\u5b58\u5899\u201d\u95ee\u9898\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u6548\u4e14\u5b9e\u7528\u7684\u65b0\u601d\u8def\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f - Temporal prefetching\uff08\u65f6\u95f4\u5c40\u90e8\u6027\u9884\u53d6\uff09\u662f\u5904\u7406irregular memory access patterns\uff08\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff09\u7684\u6709\u6548\u6280\u672f\uff0c\u8fd9\u7c7b\u6a21\u5f0f\u5e38\u89c1\u4e8e\u6307\u9488\u548c\u6570\u636e\u4f9d\u8d56\u7684\u6570\u636e\u7ed3\u6784\u4e2d\u3002 - \u4e3a\u4e86\u51cf\u5c11\u8bbf\u95ee\u5143\u6570\u636e\u7684\u5185\u5b58\u6d41\u91cf\uff0c\u8fd1\u671f\u7814\u7a76\u5c06\u5143\u6570\u636e\u5b58\u50a8\u4ece\u7247\u5916DRAM\u8fc1\u79fb\u5230\u7247\u4e0aLLC\u4e2d\u7684metadata table\uff08\u5143\u6570\u636e\u8868\uff09\u3002\u7136\u800c\uff0c\u7247\u4e0a\u5b58\u50a8\u8d44\u6e90\u6709\u9650\uff0c\u5982\u4f55\u9ad8\u6548\u7ba1\u7406\u8be5\u8868\u6210\u4e3a\u5173\u952e\u6311\u6218\u3002 - \u73b0\u6709\u7684\u786c\u4ef6\u65b9\u6848\uff08\u5982Triangel\uff09\u5728\u5143\u6570\u636e\u8868\u7ba1\u7406\u4e0a\u5b58\u5728\u7f3a\u9677\uff1a\u5176\u63d2\u5165\u7b56\u7565\uff08\u5982PatternConf\uff09\u8fc7\u4e8e\u4fdd\u5b88\uff0c\u4f1a\u9519\u8bef\u5730\u8fc7\u6ee4\u6389\u80fd\u4ea7\u751f\u6709\u7528\u9884\u53d6\u7684\u5143\u6570\u636e\uff1b\u800c\u66ff\u6362\u7b56\u7565\u5219\u672a\u80fd\u6709\u6548\u533a\u5206\u5143\u6570\u636e\u7684\u4ef7\u503c\u3002 - \u4f20\u7edf\u7684Profile-Guided Optimization (PGO) \u65b9\u6848\uff08\u5982RPG2\uff09\u4e3b\u8981\u9488\u5bf9\u5177\u6709\u89c4\u5219\u6b65\u957f\uff08stride pattern\uff09\u7684\u95f4\u63a5\u8bbf\u95ee\uff0c\u5bf9\u4e8e\u590d\u6742\u7684\u4e0d\u89c4\u5219\u6a21\u5f0f\uff08\u5982pointer-chasing\uff09\u6548\u679c\u751a\u5fae\u3002</p> <p></p> <p>Figure 1: The bottom figure shows a metadata access pattern: 1) Blue/Red dots are metadata accesses that result in useful/useless prefetches; 2) Blue/Red stars represent first metadata access with/without temporal patterns. Their corresponding metadata should/should not be inserted in the metadata table. The top figure shows how Triangel [7] applies its PatternConf to the highlighted metadata access pattern.</p> <p>\u7814\u7a76\u52a8\u673a - \u7eaf\u786c\u4ef6\u65b9\u6848\u7f3a\u4e4f\u5bf9\u7a0b\u5e8f\u672a\u6765\u884c\u4e3a\u7684\u6d1e\u5bdf\uff0c\u4ec5\u4f9d\u8d56\u77ed\u671f\u5386\u53f2\u6570\u636e\uff0c\u96be\u4ee5\u5e94\u5bf9\u5143\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u7684\u9ad8\u5ea6\u52a8\u6001\u6027\u548c\u65b9\u5dee\u3002 - \u73b0\u6709PGO\u65b9\u6848\u65e0\u6cd5\u6709\u6548\u5904\u7406\u590d\u6742\u7684\u65f6\u5e8f\u6a21\u5f0f\uff0c\u4e14\u901a\u5e38\u5bf9\u4e0d\u540c\u7684\u7a0b\u5e8f\u8f93\u5165\u7f3a\u4e4f\u9002\u5e94\u6027\uff0c\u4e00\u4e2a\u8f93\u5165\u4e0a\u751f\u6210\u7684\u4f18\u5316\u63d0\u793a\uff08hints\uff09\u5728\u53e6\u4e00\u4e2a\u8f93\u5165\u4e0a\u53ef\u80fd\u5931\u6548\u3002 - \u9700\u8981\u4e00\u79cd\u65e2\u80fd\u5229\u7528profile-guided\u65b9\u6cd5\u7684\u5168\u5c40\u89c6\u91ce\u6765\u7cbe\u786e\u7ba1\u7406\u5143\u6570\u636e\uff0c\u53c8\u80fd\u4fdd\u6301\u8f7b\u91cf\u7ea7\u3001\u517c\u5bb9\u73b0\u6709\u786c\u4ef6\u4e14\u80fd\u9002\u5e94\u4e0d\u540c\u8f93\u5165\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p></p> <p>Figure 2: Comparison between Prophet and prior profileguided solutions. Prophet is lightweight as it only uses counters for profiling. Prophet can integrate counters from multiple inputs, enabling it to adapt to varying program inputs.</p> <p>\u6838\u5fc3\u8d21\u732e - \u63d0\u51fa\u4e86 Prophet\uff0c\u4e00\u4e2ahardware-software co-designed\u6846\u67b6\uff0c\u5229\u7528profile-guided\u65b9\u6cd5\u4f18\u5316\u786c\u4ef6\u65f6\u5e8f\u9884\u53d6\u5668\u7684\u5143\u6570\u636e\u8868\u7ba1\u7406\u3002 - \u8f7b\u91cf\u7ea7Profiling: \u4f7f\u7528PMU counters\u800c\u975e\u5b8c\u6574\u7684\u6267\u884c\u8f68\u8ff9\uff08traces\uff09\u8fdb\u884c\u5206\u6790\uff0c\u663e\u8457\u964d\u4f4e\u4e86\u6027\u80fd\u548c\u5b58\u50a8\u5f00\u9500\u3002 - \u81ea\u9002\u5e94\u5b66\u4e60\u673a\u5236: \u901a\u8fc7\u8fed\u4ee3\u5730\u4ece\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u4e2d\u91c7\u6837\u8ba1\u6570\u5668\u5e76\u5408\u5e76\uff0c\u4f7f\u5355\u4e2a\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u80fd\u591f\u9002\u5e94\u591a\u79cd\u8f93\u5165\u573a\u666f\u3002 - \u7cbe\u7ec6\u5316\u7684\u5143\u6570\u636e\u7ba1\u7406:   - \u63d2\u5165\u7b56\u7565: \u57fa\u4e8e\u6307\u4ee4\u7ea7\uff08PC-level\uff09\u7684prefetching accuracy\uff0c\u4ec5\u8fc7\u6ee4\u6389\u51e0\u4e4e\u65e0\u65f6\u5e8f\u6a21\u5f0f\u7684\u6307\u4ee4\u3002   - \u66ff\u6362\u7b56\u7565: \u5728\u4fdd\u7559\u7684\u5143\u6570\u636e\u4e2d\uff0c\u6839\u636e\u9884\u53d6\u51c6\u786e\u7387\u5206\u914d\u4f18\u5148\u7ea7\uff0c\u4f18\u5148\u66ff\u6362\u4f4e\u4ef7\u503c\u6761\u76ee\u3002   - \u5f15\u5165Multi-path Victim Buffer: \u89e3\u51b3\u5355\u4e2a\u5730\u5740\u5bf9\u5e94\u591a\u4e2aMarkov targets\u7684\u95ee\u9898\uff0c\u63d0\u5347\u4e86\u5bf9\u590d\u6742\u65f6\u5e8f\u6a21\u5f0f\u7684\u8986\u76d6\u3002 - \u5353\u8d8a\u7684\u6027\u80fd\u8868\u73b0: \u5728SPEC CPU\u7b49\u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0cProphet\u76f8\u6bd4\u6700\u5148\u8fdb\u7684Triangel\u5b9e\u73b0\u4e8614.23%\u7684\u6027\u80fd\u63d0\u5347\uff0c\u800c\u4f20\u7edfPGO\u65b9\u6848\uff08RPG2\uff09\u4ec5\u83b7\u5f970.1%\u7684\u589e\u76ca\u3002</p> \u5bf9\u6bd4\u65b9\u6848 \u6027\u80fd\u63d0\u5347 (vs. \u65e0\u9884\u53d6) \u76f8\u6bd4 Triangel \u7684\u4f18\u52bf RPG2 0.1% -14.13% Triangel 20.35% Baseline Prophet 34.58% +14.23% <p></p> <p>Figure 10: IPC speedup compared to RPG2 and Triangel.</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>Prophet \u662f\u4e00\u4e2a hardware-software co-designed framework\uff0c\u65e8\u5728\u901a\u8fc7 profile-guided methods \u4f18\u5316\u786c\u4ef6 temporal prefetcher \u7684 metadata table management\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\u5229\u7528\u79bb\u7ebf\u5206\u6790\u83b7\u5f97\u7684\u7a0b\u5e8f\u884c\u4e3a\u6d1e\u5bdf\uff0c\u751f\u6210\u8f7b\u91cf\u7ea7\u7684 hints \u6ce8\u5165\u5230\u7a0b\u5e8f\u4e2d\uff0c\u5728\u8fd0\u884c\u65f6\u6307\u5bfc\u786c\u4ef6 prefetcher \u66f4\u9ad8\u6548\u5730\u7ba1\u7406\u5176\u6709\u9650\u7684\u7247\u4e0a\u5b58\u50a8\u8d44\u6e90\u3002</p> <ul> <li>Prophet \u4e0e\u73b0\u6709\u7684\u786c\u4ef6 temporal prefetcher\uff08\u5982 Triangel\uff09\u5171\u5b58\uff0c\u5171\u4eab\u540c\u4e00\u4e2a metadata table\uff0c\u4f46\u66ff\u6362\u4e86\u5176\u539f\u6709\u7684\u3001\u57fa\u4e8e\u77ed\u671f\u8fd0\u884c\u65f6\u4fe1\u606f\u7684\u7ba1\u7406\u7b56\u7565\u3002</li> <li>\u6574\u4e2a\u6846\u67b6\u7684\u6d41\u7a0b\u5206\u4e3a\u4e09\u4e2a\u9636\u6bb5\uff1aProfiling\u3001Analysis \u548c Learning\uff0c\u5982 </li> </ul> <p></p> <p>Figure 5: Prophet process overview. Step1: Prophet leverages the PMU to gather counters related to the temporal prefetcher\u2019s performance. Step2: Prophet analyzes the collected counters to generate hints and then injects hints into the original binaries. Step 3: Prophet samples and learns counters across different program inputs.</p> <p>\u6240\u793a\u3002 - Prophet \u7684\u67b6\u6784\u4e3b\u8981\u7531\u4e09\u4e2a profile-guided \u7ec4\u4ef6\u6784\u6210\uff0c\u5982 </p> <p></p> <p>Figure 4: Prophet architecture overview. Prophet coexists with hardware temporal prefetchers by sharing the same metadata table but leveraging more accurate profile-guided methods for metadata table management.</p> <p>\u6240\u793a\uff1a   - Profile-Guided Insertion Policy: \u51b3\u5b9a\u54ea\u4e9b\u5185\u5b58\u8bbf\u95ee\u6307\u4ee4\uff08PC\uff09\u4ea7\u751f\u7684\u8bf7\u6c42\u5e94\u8be5\u88ab\u7528\u6765\u8bad\u7ec3 prefetcher \u5e76\u63d2\u5165 metadata\u3002   - Profile-Guided Replacement Policy: \u4e3a metadata table \u4e2d\u7684\u6761\u76ee\u5206\u914d\u57fa\u4e8e prefetching accuracy \u7684\u4f18\u5148\u7ea7\uff0c\u4ee5\u6307\u5bfc\u66ff\u6362\u51b3\u7b56\u3002   - Profile-Guided Resizing: \u6839\u636e\u7a0b\u5e8f\u5bf9 metadata \u5b58\u50a8\u7684\u5cf0\u503c\u9700\u6c42\uff0c\u9884\u5148\u8bbe\u5b9a metadata table \u7684\u5927\u5c0f\u3002</p> <p>Hint \u4fe1\u606f\u6ce8\u5165\u4e0e\u4f20\u9012\u673a\u5236</p> <ul> <li>Prophet \u751f\u6210\u4e24\u7c7b hint \u4fe1\u606f\uff1a</li> <li>PC-level hints: \u9488\u5bf9\u7279\u5b9a\u5185\u5b58\u6307\u4ee4\uff0c\u7528\u4e8e insertion \u548c replacement \u7b56\u7565\u3002</li> <li>Application-level hints: \u5168\u5c40\u6027\u4fe1\u606f\uff08\u5982 metadata table \u5927\u5c0f\uff09\uff0c\u901a\u8fc7\u5728\u7a0b\u5e8f\u5f00\u5934\u63d2\u5165 CSR manipulation instruction \u6765\u8bbe\u7f6e\u3002</li> <li>PC-level hints \u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u6ce8\u5165\u5230\u7a0b\u5e8f\u4e2d\uff1a</li> <li>Hint Buffer: \u4f7f\u7528\u4e13\u7528\u7684 hint \u6307\u4ee4\u5c06 hint \u4fe1\u606f\u548c PC tag \u5b58\u5165\u4e00\u4e2a\u9760\u8fd1 prefetcher \u7684\u5c0f\u7f13\u51b2\u533a\u3002</li> <li>Reserved Bits/Instruction Prefix: \u5c06 hint \u76f4\u63a5\u5d4c\u5165\u5230\u5185\u5b58\u8bbf\u95ee\u6307\u4ee4\u7684\u4fdd\u7559\u4f4d\u6216 x86 \u524d\u7f00\u4e2d\u3002</li> </ul> <p>\u81ea\u9002\u5e94\u5b66\u4e60\u80fd\u529b (Adaptable Learning)</p> <ul> <li>Prophet \u80fd\u591f\u901a\u8fc7 Learning \u9636\u6bb5\uff0c\u6301\u7eed\u4ece\u4e0d\u540c\u7684\u7a0b\u5e8f\u8f93\u5165\u4e2d\u91c7\u6837\u65b0\u7684\u6027\u80fd\u8ba1\u6570\u5668\uff0c\u5e76\u5c06\u5176\u4e0e\u5386\u53f2\u6570\u636e\u5408\u5e76\u3002</li> <li>\u8fd9\u79cd\u673a\u5236\u4f7f\u5f97\u4e00\u4e2a\u5355\u4e00\u7684\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\u80fd\u591f\u52a8\u6001\u8c03\u6574\u5176 hints\uff0c\u4ece\u800c\u5728\u591a\u79cd\u4e0d\u540c\u7684\u8f93\u5165\u96c6\u4e0a\u90fd\u4fdd\u6301\u63a5\u8fd1\u6700\u4f18\u7684\u6027\u80fd\uff0c\u89e3\u51b3\u4e86\u4f20\u7edf PGO \u5bf9\u8f93\u5165\u654f\u611f\u7684\u95ee\u9898\uff0c\u5982 </li> </ul> <p></p> <p>Figure 6: The prefetching accuracy of temporal prefetching across different memory instructions in omnetpp.</p> <p>\u548c </p> <p></p> <p>Figure 13: Prophet learns counters from gcc\u2019s inputs.</p> <p>\u6240\u793a\u3002</p> <p>\u589e\u5f3a\u7684 Metadata \u8868\u8fbe\u80fd\u529b</p> <ul> <li>\u4e3a\u4e86\u89e3\u51b3\u5355\u4e2a\u5730\u5740\u53ef\u80fd\u5bf9\u5e94\u591a\u4e2a\u672a\u6765\u8bbf\u95ee\u76ee\u6807\uff08Markov targets\uff09\u7684\u95ee\u9898\uff0cProphet \u5f15\u5165\u4e86 Multi-path Victim Buffer\u3002</li> <li>\u8be5\u7f13\u51b2\u533a\u53ef\u4ee5\u5b58\u50a8\u4ece\u4e3b metadata table \u4e2d\u88ab\u66ff\u6362\u51fa\u53bb\u7684\u3001\u4f46\u4ecd\u6709\u4ef7\u503c\u7684\u989d\u5916 Markov targets\uff0c\u4ece\u800c\u63d0\u5347\u4e86\u5bf9\u590d\u6742 temporal patterns \u7684\u8986\u76d6\u80fd\u529b\uff0c\u5982 </li> </ul> <p></p> <p>Figure 8: The percentage of Markov target number (T) in temporal prefetching. Figure 9: The Multi-path Victim Buffer.</p> <p>\u6240\u793a\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#1-profile-guided-insertion-policy","title":"1. Profile-Guided Insertion Policy","text":"<p>\u5b9e\u73b0\u539f\u7406\u4e0e\u6838\u5fc3\u601d\u60f3</p> <ul> <li>Prophet \u7684 Profile-Guided Insertion Policy \u65e8\u5728\u89e3\u51b3\u73b0\u6709\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 Triangel\uff09\u56e0\u4f9d\u8d56\u77ed\u65f6\u5386\u53f2\u6570\u636e\u800c\u5bfc\u81f4\u7684\u63d2\u5165\u7b56\u7565\u4e0d\u51c6\u786e\u95ee\u9898\u3002</li> <li>\u5176\u6838\u5fc3\u601d\u60f3\u662f\u5229\u7528\u79bb\u7ebf\u5256\u6790 (Profiling) \u9636\u6bb5\u6536\u96c6\u7684\u957f\u671f\u3001\u5168\u5c40\u7684\u7a0b\u5e8f\u6267\u884c\u4fe1\u606f\uff0c\u4e3a\u6bcf\u4e2a\u5185\u5b58\u8bbf\u95ee\u6307\u4ee4\uff08PC\uff09\u8ba1\u7b97\u4e00\u4e2a\u771f\u5b9e\u7684\u9884\u53d6\u51c6\u786e\u7387 (prefetching accuracy)\u3002</li> <li>\u57fa\u4e8e\u8fd9\u4e2a\u51c6\u786e\u7387\uff0c\u8be5\u7b56\u7565\u53ef\u4ee5\u7cbe\u51c6\u5730\u8bc6\u522b\u5e76\u8fc7\u6ee4\u6389\u90a3\u4e9b\u51e0\u4e4e\u65e0\u6cd5\u4ece\u65f6\u95f4\u5c40\u90e8\u6027\u9884\u53d6\u4e2d\u53d7\u76ca\u7684\u5185\u5b58\u6307\u4ee4\uff0c\u4ece\u800c\u907f\u514d\u5c06\u5b9d\u8d35\u7684\u7247\u4e0a\u5143\u6570\u636e\u8868\u7a7a\u95f4\u6d6a\u8d39\u5728\u65e0\u6548\u6761\u76ee\u4e0a\u3002</li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u8f93\u5165\u8f93\u51fa</p> <ul> <li>\u8f93\u5165:<ul> <li>PMU \u8ba1\u6570\u5668\u6570\u636e: \u5728\u7b80\u5316\u7248\u9884\u53d6\u5668\uff08\u56fa\u5b9a1MB\u5143\u6570\u636e\u8868\uff0c\u9884\u53d6\u5ea6\u4e3a1\uff09\u4e0b\u8fd0\u884c\u7a0b\u5e8f\u65f6\uff0c\u901a\u8fc7 Intel PEBS \u6536\u96c6\u7684\u4e24\u4e2a\u5173\u952e\u4e8b\u4ef6\u8ba1\u6570\uff1a<ul> <li><code>MEM_LOAD_RETIRED.L2_Prefetch_Issue</code>: \u7531\u8be5 PC \u53d1\u51fa\u7684 L2 \u9884\u53d6\u8bf7\u6c42\u6570\u91cf\u3002</li> <li><code>MEM_LOAD_RETIRED.L2_Prefetch_Useful</code>: \u4e0a\u8ff0\u9884\u53d6\u8bf7\u6c42\u4e2d\u88ab\u540e\u7eed\u9700\u6c42\u8bbf\u95ee\u547d\u4e2d\u7684\u6570\u91cf\u3002</li> </ul> </li> </ul> </li> <li>\u5904\u7406:<ul> <li>\u5bf9\u6bcf\u4e2a PC\uff0c\u8ba1\u7b97\u5176\u9884\u53d6\u51c6\u786e\u7387\uff1a<code>Accuracy = L2_Prefetch_Useful / L2_Prefetch_Issue</code>\u3002</li> <li>\u5c06\u8ba1\u7b97\u51fa\u7684\u51c6\u786e\u7387\u4e0e\u4e00\u4e2a\u6781\u4f4e\u7684\u9608\u503c (extremely low threshold, denoted as <code>ACC_THRESHOLD</code>) \u8fdb\u884c\u6bd4\u8f83\u3002</li> </ul> </li> <li>\u51b3\u7b56\u4e0e\u8f93\u51fa:<ul> <li>\u5982\u679c <code>Accuracy &lt; ACC_THRESHOLD</code>\uff0c\u5219\u5224\u5b9a\u8be5 PC \u51e0\u4e4e\u4e0d\u8868\u73b0\u51fa\u53ef\u88ab\u5229\u7528\u7684\u65f6\u95f4\u5c40\u90e8\u6027\u6a21\u5f0f\u3002</li> <li>\u751f\u6210\u4e00\u4e2a 1-bit hint\uff0c\u6307\u793a\u786c\u4ef6\u9884\u53d6\u5668\u5b8c\u5168\u4e22\u5f03\u6765\u81ea\u8be5 PC \u7684\u6240\u6709\u9700\u6c42\u8bf7\u6c42\uff0c\u7981\u6b62\u4e3a\u5176\u63d2\u5165\u4efb\u4f55\u5143\u6570\u636e\u3002</li> <li>\u8fd9\u4e2a 1-bit hint \u4f1a\u88ab\u6ce8\u5165\u5230\u539f\u59cb\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u4e2d\uff0c\u901a\u5e38\u901a\u8fc7 hint buffer \u6216 x86 \u6307\u4ee4\u524d\u7f00\u7684\u65b9\u5f0f\u643a\u5e26\u3002</li> </ul> </li> </ul> <p></p> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u8bbe\u8ba1\u8003\u91cf</p> <ul> <li><code>ACC_THRESHOLD</code> \u7684\u8bbe\u5b9a:<ul> <li>\u8be5\u9608\u503c\u88ab\u8bbe\u8ba1\u5f97\u975e\u5e38\u4f4e\uff0c\u76ee\u7684\u662f\u91c7\u53d6\u4e00\u79cd\u4fdd\u5b88\u7684\u8fc7\u6ee4\u7b56\u7565\u3002</li> <li>\u5982\u56fe16\u6240\u793a\uff0c\u9608\u503c\u8fc7\u9ad8\u4f1a\u9519\u8bef\u5730\u8fc7\u6ee4\u6389\u6709\u7528\u7684\u5143\u6570\u636e\uff0c\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\uff1b\u9608\u503c\u8fc7\u4f4e\u5219\u65e0\u6cd5\u6709\u6548\u8282\u7701\u5b58\u50a8\u7a7a\u95f4\u3002Prophet \u9009\u62e9\u4e00\u4e2a\u5e73\u8861\u70b9\uff0c\u786e\u4fdd\u53ea\u8fc7\u6ee4\u6389\u660e\u786e\u65e0\u7528\u7684\u6307\u4ee4\u3002</li> <li>\u8fd9\u79cd\u4fdd\u5b88\u8bbe\u8ba1\u4f7f\u5176\u4e0e Triangel \u7684 <code>PatternConf</code> \u673a\u5236\u5f62\u6210\u9c9c\u660e\u5bf9\u6bd4\uff0c\u540e\u8005\u56e0\u5bf9\u77ed\u671f\u566a\u58f0\u8fc7\u4e8e\u654f\u611f\u800c\u5bb9\u6613\u9519\u8bef\u5730\u62d2\u7edd\u540e\u7eed\u6709\u7528\u7684\u8bbf\u95ee\uff08\u5982\u56fe1\u6240\u793a\uff09\u3002</li> </ul> </li> <li>Hint \u6ce8\u5165\u65b9\u5f0f:<ul> <li>Hint Buffer: \u5728\u7a0b\u5e8f\u5165\u53e3\u5904\u63d2\u5165\u4e13\u7528 hint \u6307\u4ee4\uff0c\u5c06 PC \u548c hint \u5b58\u5165\u4e00\u4e2a\u5c0f\u5bb9\u91cf\uff08128-entry, ~0.19KB\uff09\u7684\u7f13\u51b2\u533a\u3002\u6b64\u65b9\u6cd5\u517c\u5bb9\u6240\u6709 ISA\u3002</li> <li>Instruction Prefix: \u5229\u7528 x86 \u67b6\u6784\u7684\u6307\u4ee4\u524d\u7f00\u6765\u643a\u5e26 hint\u3002\u7531\u4e8e\u4ec5\u9488\u5bf9\u6700\u591a128\u6761\u5173\u952e\u6307\u4ee4\uff0c\u5bf9 I-cache \u7684\u5f71\u54cd\u5fae\u4e4e\u5176\u5fae\uff08\u6700\u5927\u589e\u52a06\u5b57\u8282\uff09\u3002</li> </ul> </li> </ul> <p>\u5728 Prophet \u6574\u4f53\u6846\u67b6\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u63d0\u5347\u5143\u6570\u636e\u8868\u5229\u7528\u7387: \u901a\u8fc7\u9884\u5148\u8fc7\u6ee4\u6389\u65e0\u6548\u7684\u8bad\u7ec3\u6570\u636e\u6e90\uff0c\u786e\u4fdd\u6709\u9650\u7684\u7247\u4e0a\u5b58\u50a8\u7a7a\u95f4\u88ab\u7528\u4e8e\u8bb0\u5f55\u771f\u6b63\u6709\u4ef7\u503c\u7684\u5730\u5740\u76f8\u5173\u6027\u3002</li> <li>\u5960\u5b9a\u7cbe\u7ec6\u5316\u7ba1\u7406\u57fa\u7840: \u4f5c\u4e3a\u7b2c\u4e00\u9053\u7b5b\u9009\u5173\u5361\uff0cInsertion Policy \u4e3a\u540e\u7eed\u7684 Profile-Guided Replacement Policy \u63d0\u4f9b\u4e86\u9ad8\u8d28\u91cf\u7684\u201c\u5019\u9009\u6c60\u201d\u3002Replacement Policy \u53ea\u9700\u5728\u8fd9\u4e2a\u5df2\u88ab\u51c0\u5316\u7684\u6c60\u5b50\u4e2d\uff0c\u6839\u636e\u66f4\u7ec6\u7c92\u5ea6\u7684\u51c6\u786e\u7387\u8fdb\u884c\u4f18\u5148\u7ea7\u6392\u5e8f\u3002</li> <li>\u5b9e\u73b0\u8f6f\u786c\u534f\u540c: \u8be5\u7b56\u7565\u5b8c\u7f8e\u4f53\u73b0\u4e86 Prophet \u7684 co-design \u601d\u60f3\uff1a\u590d\u6742\u7684\u5206\u6790\u548c\u51b3\u7b56\u5728\u8f6f\u4ef6\u5c42\u9762\u79bb\u7ebf\u5b8c\u6210\uff0c\u786c\u4ef6\u53ea\u9700\u6267\u884c\u4e00\u4e2a\u7b80\u5355\u7684\u3001\u57fa\u4e8e hint \u7684\u5f00\u5173\u64cd\u4f5c\uff0c\u5f00\u9500\u6781\u4f4e\u3002</li> <li>\u4e0e\u5b66\u4e60\u673a\u5236\u7ed3\u5408: \u5728 Step 3: Learning \u9636\u6bb5\uff0c\u6765\u81ea\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u7684\u51c6\u786e\u7387\u8ba1\u6570\u4f1a\u901a\u8fc7\u7279\u5b9a\u516c\u5f0f\uff08\u5982 Equation 4\uff09\u8fdb\u884c\u5408\u5e76\uff0c\u4f7f\u5f97\u751f\u6210\u7684 hint \u80fd\u591f\u9002\u5e94\u591a\u79cd\u8f93\u5165\u573a\u666f\uff0c\u4fdd\u8bc1\u5355\u4e00\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5e7f\u6cdb\u9002\u7528\u6027\u3002</li> </ul>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#2-profile-guided-replacement-policy","title":"2. Profile-Guided Replacement Policy","text":"<p>\u6838\u5fc3\u539f\u7406\u4e0e\u52a8\u673a</p> <ul> <li>Prophet \u7684 Profile-Guided Replacement Policy \u65e8\u5728\u89e3\u51b3\u73b0\u6709\u786c\u4ef6\u66ff\u6362\u7b56\u7565\uff08\u5982 Hawkeye, SRRIP\uff09\u7684\u6839\u672c\u7f3a\u9677\uff1a\u5b83\u4eec\u4ec5\u57fa\u4e8e\u5143\u6570\u636e\u7684\u91cd\u7528\u8ddd\u79bb (reuse distance) \u8fdb\u884c\u51b3\u7b56\uff0c\u800c\u5ffd\u7565\u4e86\u8be5\u5143\u6570\u636e\u662f\u5426\u80fd\u4ea7\u751f\u6709\u7528\u7684\u9884\u53d6 (useful prefetches)\u3002</li> <li>\u5982\u56fe1\u6240\u793a\uff0c\u5143\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u9ad8\u5ea6\u53ef\u53d8\uff0c\u91cd\u7528\u8ddd\u79bb\u65b9\u5dee\u6781\u5927\uff0c\u5355\u7eaf\u9884\u6d4b\u91cd\u7528\u8ddd\u79bb\u6548\u7387\u4f4e\u4e0b\u3002</li> <li>Prophet \u7684\u6838\u5fc3\u601d\u60f3\u662f\u5c06\u9884\u53d6\u51c6\u786e\u7387 (prefetching accuracy) \u4f5c\u4e3a\u5173\u952e\u6307\u6807\uff0c\u4e3a\u6bcf\u4e2a\u5185\u5b58\u6307\u4ee4\uff08PC\uff09\u5206\u914d\u4e00\u4e2a\u7ec6\u7c92\u5ea6\u7684\u66ff\u6362\u4f18\u5148\u7ea7 (replacement priority)\u3002\u51c6\u786e\u7387\u8d8a\u4f4e\u7684\u6307\u4ee4\u6240\u4ea7\u751f\u7684\u5143\u6570\u636e\uff0c\u5176\u4f18\u5148\u7ea7\u8d8a\u4f4e\uff0c\u5728\u9700\u8981\u66ff\u6362\u65f6\u4f1a\u88ab\u4f18\u5148\u9a71\u9010\u3002</li> </ul> <p></p> <p>Figure 1: The bottom figure shows a metadata access pattern: 1) Blue/Red dots are metadata accesses that result in useful/useless prefetches; 2) Blue/Red stars represent first metadata access with/without temporal patterns. Their corresponding metadata should/should not be inserted in the metadata table. The top figure shows how Triangel [7] applies its PatternConf to the highlighted metadata access pattern.</p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5b9e\u73b0\u7ec6\u8282</p> <ul> <li>\u8f93\u5165: \u5728 Profiling \u9636\u6bb5\uff08Step 1\uff09\uff0c\u901a\u8fc7 PMU \u7684 PEBS \u4e8b\u4ef6\u6536\u96c6\u6bcf\u4e2a PC \u7684\u4e24\u4e2a\u8ba1\u6570\u5668\uff1a</li> <li><code>MEM_LOAD_RETIRED.L2_Prefetch_Issue</code>: \u53d1\u51fa\u7684\u9884\u53d6\u8bf7\u6c42\u6570\u3002</li> <li><code>MEM_LOAD_RETIRED.L2_Prefetch_Useful</code>: \u88ab\u9700\u6c42\u8bf7\u6c42\u547d\u4e2d\u7684\u6709\u7528\u9884\u53d6\u6570\u3002</li> <li>\u8ba1\u7b97\u9884\u53d6\u51c6\u786e\u7387: \u5bf9\u4e8e\u6bcf\u4e2a PC\uff0c\u5176\u9884\u53d6\u51c6\u786e\u7387\u8ba1\u7b97\u516c\u5f0f\u4e3a\uff1a</li> <li>Prefetching Accuracy = L2_Prefetch_Useful / L2_Prefetch_Issue</li> <li>\u5206\u914d\u4f18\u5148\u7ea7: \u5728 Analysis \u9636\u6bb5\uff08Step 2\uff09\uff0c\u4f7f\u7528\u4ee5\u4e0b\u516c\u5f0f\u5c06\u8fde\u7eed\u7684\u51c6\u786e\u7387\u6620\u5c04\u4e3a\u79bb\u6563\u7684\u4f18\u5148\u7ea7\u7b49\u7ea7\uff1a</li> <li>Priority Level = floor(Accuracy * n)</li> <li>\u5176\u4e2d\uff0c<code>n</code> \u662f\u4e00\u4e2a\u7531\u8bbe\u8ba1\u8005\u63a7\u5236\u7684\u53c2\u6570\uff0c\u51b3\u5b9a\u4e86\u4f18\u5148\u7ea7\u7684\u7c92\u5ea6\u3002\u8bba\u6587\u8bc4\u4f30\u540e\u9009\u62e9 <code>n=2</code>\uff0c\u5373\u4f7f\u7528 2-bit \u6765\u8868\u793a 4\u4e2a \u4f18\u5148\u7ea7\u7b49\u7ea7\uff0c\u5728\u6027\u80fd\u589e\u76ca\u548c\u5b58\u50a8\u5f00\u9500\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u3002</li> <li>\u6ce8\u5165\u4e0e\u8bb0\u5f55: \u5206\u914d\u7684\u4f18\u5148\u7ea7\u88ab\u7f16\u7801\u4e3a Hint \u4fe1\u606f\uff0c\u5e76\u901a\u8fc7 Hint Buffer \u6216 \u6307\u4ee4\u524d\u7f00 \u6ce8\u5165\u5230\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u3002\u5f53\u8be5 PC \u4ea7\u751f\u7684\u9700\u6c42\u8bf7\u6c42\u89e6\u53d1\u5143\u6570\u636e\u63d2\u5165\u65f6\uff0c\u5176\u5bf9\u5e94\u7684 Priority Level \u4f1a\u88ab\u8bb0\u5f55\u5230 Prophet Replacement State \u4e2d\uff0c\u4e0e\u5143\u6570\u636e\u6761\u76ee\u5173\u8054\u3002</li> <li>\u6267\u884c\u66ff\u6362: \u5f53\u5143\u6570\u636e\u8868\u6ee1\u4e14\u9700\u8981\u63d2\u5165\u65b0\u6761\u76ee\u65f6\uff0cProphet \u66ff\u6362\u7b56\u7565\u9996\u5148\u7b5b\u9009\u51fa\u5177\u6709\u6700\u4f4e\u4f18\u5148\u7ea7\u7b49\u7ea7\u7684\u6240\u6709\u6761\u76ee\u4f5c\u4e3a\u5019\u9009\u53d7\u5bb3\u8005 (victim candidates)\u3002\u7136\u540e\uff0c\u5728\u8fd9\u4e9b\u5019\u9009\u8005\u4e2d\u5e94\u7528 LRU (Least Recently Used) \u7b56\u7565\u6765\u6700\u7ec8\u786e\u5b9a\u88ab\u66ff\u6362\u7684\u6761\u76ee\u3002</li> </ul> <p></p> <p>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528\u4e0e\u4f18\u52bf</p> <ul> <li>\u4e0e\u63d2\u5165\u7b56\u7565\u534f\u540c: \u63d2\u5165\u7b56\u7565\uff08Insertion Policy\uff09\u4f1a\u8fc7\u6ee4\u6389\u9884\u53d6\u51c6\u786e\u7387\u6781\u4f4e\uff08\u4f4e\u4e8e\u9608\u503c <code>ACC_MIN</code>\uff09\u7684 PC\uff0c\u786e\u4fdd\u53ea\u6709\u201c\u6709\u6f5c\u529b\u201d\u7684\u5143\u6570\u636e\u8fdb\u5165\u8868\u4e2d\u3002\u66ff\u6362\u7b56\u7565\u5219\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u5bf9\u5df2\u8fdb\u5165\u8868\u4e2d\u7684\u5143\u6570\u636e\u8fdb\u884c\u7cbe\u7ec6\u5316\u7ba1\u7406\uff0c\u786e\u4fdd\u9ad8\u4ef7\u503c\uff08\u9ad8\u51c6\u786e\u7387\uff09\u7684\u5143\u6570\u636e\u80fd\u88ab\u957f\u671f\u4fdd\u7559\u3002</li> <li>\u63d0\u5347\u5143\u6570\u636e\u8868\u5229\u7528\u7387: \u901a\u8fc7\u4f18\u5148\u9a71\u9010\u4f4e\u4ef7\u503c\u5143\u6570\u636e\uff0c\u4e3a\u9ad8\u4ef7\u503c\u5143\u6570\u636e\u817e\u51fa\u7a7a\u95f4\uff0c\u663e\u8457\u63d0\u9ad8\u4e86\u6709\u9650\u7684 on-chip metadata table \u7684\u5229\u7528\u6548\u7387\u3002</li> <li>\u76f4\u63a5\u63d0\u5347\u6027\u80fd: \u5982\u56fe19\u7684\u7279\u6027\u5206\u89e3\u6240\u793a\uff0c\u66ff\u6362\u7b56\u7565\u662f Prophet \u6027\u80fd\u63d0\u5347\u7684\u6700\u5927\u8d21\u732e\u8005\u4e4b\u4e00\uff0c\u5c24\u5176\u5728 mcf \u548c omnetpp \u7b49\u5bf9\u7f13\u5b58\u6c61\u67d3\u654f\u611f\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0c\u5206\u522b\u5e26\u6765\u4e86 14.53% \u548c 9.89% \u7684\u6027\u80fd\u589e\u76ca\u3002</li> </ul> <p></p> <p>Figure 19: Prophet Features Breakdown.</p> <p>\u53c2\u6570\u654f\u611f\u6027\u4e0e\u5b58\u50a8\u5f00\u9500</p> <ul> <li>\u53c2\u6570 <code>n</code> \u7684\u5f71\u54cd: </li> <li>\u589e\u52a0 <code>n</code> \u53ef\u4ee5\u63d0\u4f9b\u66f4\u7ec6\u7c92\u5ea6\u7684\u5206\u7c7b\uff0c\u4ece\u800c\u53ef\u80fd\u5e26\u6765\u66f4\u597d\u7684\u6027\u80fd\u3002</li> <li>\u4f46\u6536\u76ca\u9012\u51cf\uff0c\u4e14\u4f1a\u7ebf\u6027\u589e\u52a0 Prophet Replacement State \u7684\u5b58\u50a8\u5f00\u9500\u3002</li> <li>\u5b58\u50a8\u5f00\u9500: </li> <li>\u5bf9\u4e8e\u4e00\u4e2a 1MB \u7684\u5143\u6570\u636e\u8868\uff08196,608 \u4e2a\u6761\u76ee\uff09\uff0c\u6bcf\u4e2a\u6761\u76ee\u9700\u8981 2-bit \u7684\u66ff\u6362\u72b6\u6001\u3002</li> <li>\u603b\u5b58\u50a8\u5f00\u9500\u4e3a 48 KB\u3002</li> </ul> \u53c2\u6570 \u9ed8\u8ba4\u503c \u4f5c\u7528 \u5f71\u54cd <code>n</code> 2 \u63a7\u5236\u4f18\u5148\u7ea7\u7b49\u7ea7\u6570\u91cf (<code>n+1</code> levels) \u503c\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u7ec6\uff0c\u6027\u80fd\u7565\u597d\uff0c\u4f46\u5b58\u50a8\u5f00\u9500\u589e\u52a0 Replacement State 2-bit per entry \u5b58\u50a8\u5143\u6570\u636e\u6761\u76ee\u7684\u4f18\u5148\u7ea7 \u603b\u5f00\u9500 48 KB for 1MB table"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#3-multi-path-victim-buffer","title":"3. Multi-path Victim Buffer","text":"<p>\u6838\u5fc3\u52a8\u673a\u4e0e\u95ee\u9898\u5b9a\u4e49 - \u73b0\u6709\u7684\u7247\u4e0a\u65f6\u5e8f\u9884\u53d6\u5668\uff08\u5982 Triangel\uff09\u5728\u5143\u6570\u636e\u8868\u4e2d\u4e3a\u6bcf\u4e2a\u5185\u5b58\u5730\u5740\u4ec5\u5b58\u50a8\u5355\u4e2a Markov \u76ee\u6807\uff0c\u8fd9\u65e0\u6cd5\u6709\u6548\u5904\u7406\u73b0\u5b9e\u5e94\u7528\u4e2d\u666e\u904d\u5b58\u5728\u7684\u201c\u4e00\u5bf9\u591a\u201d\u8bbf\u95ee\u6a21\u5f0f\u3002 - \u8bba\u6587\u56fe8\uff08\uff09\u7684\u6570\u636e\u663e\u793a\uff0c\u5728 SPEC CPU \u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u8d85\u8fc7 20% \u7684\u5185\u5b58\u5730\u5740\u5177\u6709 2 \u4e2a\u6216\u66f4\u591a\u7684 Markov \u76ee\u6807\u3002\u5ffd\u7565\u8fd9\u4e9b\u989d\u5916\u76ee\u6807\u4f1a\u5bfc\u81f4\u9884\u53d6\u4e0d\u51c6\u786e\u548c\u9700\u6c42\u7f3a\u5931\uff08demand misses\uff09\u3002 - \u76f4\u63a5\u5728\u4e3b\u5143\u6570\u636e\u8868\u4e2d\u5b58\u50a8\u591a\u4e2a\u76ee\u6807\u4f1a\u5e26\u6765\u4e0d\u53ef\u63a5\u53d7\u7684\u5b58\u50a8\u5f00\u9500\u3002</p> <p>Multi-path Victim Buffer \u8bbe\u8ba1\u539f\u7406 - Prophet \u5f15\u5165\u4e00\u4e2a\u540d\u4e3a Multi-path Victim Buffer \u7684\u4e13\u7528\u7f13\u51b2\u533a\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\uff1a\u5f53\u5143\u6570\u636e\u8868\u56e0\u5bb9\u91cf\u9650\u5236\u9700\u8981\u66ff\u6362\u6761\u76ee\u65f6\uff0c\u5e76\u975e\u76f4\u63a5\u4e22\u5f03\u88ab\u66ff\u6362\u6761\u76ee\u4e2d\u7684 Markov \u76ee\u6807\uff0c\u800c\u662f\u6839\u636e\u5176\u4f18\u5148\u7ea7\u51b3\u5b9a\u662f\u5426\u5c06\u5176\u5b58\u5165\u6b64\u7f13\u51b2\u533a\u3002 - \u8be5\u7f13\u51b2\u533a\u4f5c\u4e3a\u4e3b\u5143\u6570\u636e\u8868\u7684\u8865\u5145\uff0c\u4e13\u95e8\u7528\u4e8e\u4fdd\u5b58\u90a3\u4e9b\u6709\u4ef7\u503c\u4f46\u6682\u65f6\u65e0\u6cd5\u9a7b\u7559\u4e3b\u8868\u7684\u201c\u7b2c\u4e8c\u9009\u62e9\u201d\u6216\u201c\u7b2c\u4e09\u9009\u62e9\u201d\u76ee\u6807\u5730\u5740\u3002</p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u7ba1\u7406\u7b56\u7565 - \u63d2\u5165 (Insertion):     - \u5f53\u4e00\u4e2a Markov \u76ee\u6807\u56e0\u4e3b\u5143\u6570\u636e\u8868\u66ff\u6362\u800c\u88ab\u9a71\u9010\u65f6\uff0c\u7cfb\u7edf\u4f1a\u68c0\u67e5\u5176\u4f18\u5148\u7ea7\u7ea7\u522b\uff08\u7531\u516c\u5f0f2 </p> <p></p> <p>\u8ba1\u7b97\u5f97\u51fa\uff09\u3002     - \u4ec5\u5f53\u8be5\u4f18\u5148\u7ea7\u7ea7\u522b \u5927\u4e8e \u9884\u8bbe\u7684\u6781\u4f4e\u9608\u503c <code>ACC_MIN</code> \u65f6\uff0c\u8be5\u76ee\u6807\u624d\u4f1a\u88ab\u5b58\u5165 Multi-path Victim Buffer\u3002\u8fd9\u786e\u4fdd\u4e86\u7f13\u51b2\u533a\u7a7a\u95f4\u88ab\u9ad8\u6548\u5229\u7528\uff0c\u53ea\u4fdd\u7559\u9ad8\u4ef7\u503c\u7684\u76ee\u6807\u3002 - \u66ff\u6362 (Replacement):     - Multi-path Victim Buffer \u62e5\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u66ff\u6362\u7b56\u7565\uff0c\u590d\u7528 Prophet \u7684\u66ff\u6362\u601d\u60f3\u4f46\u9488\u5bf9\u5176\u81ea\u8eab\u7279\u70b9\u8fdb\u884c\u4e86\u8c03\u6574\u3002     - \u5982\u56fe9\uff08</p> <p></p> <p>Figure 7: Challenges of traditional profile-guided optimizations across different program inputs.</p> <p>\uff09\u6240\u793a\uff0c\u7f13\u51b2\u533a\u4e3a\u6bcf\u4e2a Markov \u76ee\u6807\u7ef4\u62a4\u4e00\u4e2a\u8ba1\u6570\u5668\u3002     - \u6bcf\u5f53\u8be5\u76ee\u6807\u88ab\u8bbf\u95ee\uff08\u5373\u88ab\u7528\u4e8e\u9884\u53d6\uff09\uff0c\u5176\u8ba1\u6570\u5668\u503c\u5c31\u9012\u589e\u3002     - \u5728\u9700\u8981\u66ff\u6362\u7f13\u51b2\u533a\u6761\u76ee\u65f6\uff0c\u5176\u4f18\u5148\u7ea7\u7ea7\u522b\u88ab\u8bbe\u5b9a\u4e3a\u8be5\u8ba1\u6570\u5668\u7684\u6700\u5927\u503c\uff0c\u4ece\u800c\u4f18\u5148\u4fdd\u7559\u88ab\u9891\u7e41\u4f7f\u7528\u7684\u591a\u8def\u5f84\u76ee\u6807\u3002 - \u9884\u53d6 (Prefetch):     - \u5728\u6b63\u5e38\u7684\u9884\u53d6\u8bf7\u6c42\u751f\u6210\u8fc7\u7a0b\u4e2d\uff08\u65e0\u8bba\u662f\u6765\u81ea\u4e3b\u5143\u6570\u636e\u8868\u8fd8\u662f Reuse Buffer\uff09\uff0c\u7cfb\u7edf\u4f1a\u540c\u65f6\u89e6\u53d1\u5bf9 Multi-path Victim Buffer \u7684\u67e5\u627e\u3002     - \u4f7f\u7528\u76f8\u540c\u7684\u67e5\u627e\u5730\u5740\u5728 Multi-path Victim Buffer \u4e2d\u641c\u7d22\u3002     - \u5982\u679c\u53d1\u73b0\u5339\u914d\u9879\uff0cProphet \u4f1a\u5c06\u8fd9\u4e9b\u989d\u5916\u7684 Markov \u76ee\u6807\u4e5f\u4f5c\u4e3a\u9884\u53d6\u5019\u9009\u53d1\u51fa\u8bf7\u6c42\uff0c\u4ece\u800c\u8986\u76d6\u66f4\u590d\u6742\u7684\u8bbf\u95ee\u6a21\u5f0f\u3002</p> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u6743\u8861 - \u8bba\u6587\u56fe16\uff08</p> <p></p> <p>Figure 16: Sensitivity study.</p> <p>\uff09\u7684\u654f\u611f\u6027\u5206\u6790\u8868\u660e\uff0c\u4e3a\u6bcf\u4e2a\u5143\u6570\u636e\u6761\u76ee\u5728\u7f13\u51b2\u533a\u4e2d\u4fdd\u7559 1 \u4e2a\u989d\u5916\u7684 Markov \u5019\u9009\u8005\u662f\u6700\u4f73\u9009\u62e9\u3002 - \u4fdd\u7559\u66f4\u591a\u5019\u9009\u8005\u867d\u7136\u80fd\u7565\u5fae\u63d0\u5347\u9884\u53d6\u8986\u76d6\u7387\uff0c\u4f46\u4f1a\u5e26\u6765\u8d1f\u9762\u6548\u5e94\uff1a     - \u5bf9\u4e8e astar \u8fd9\u7c7b\u5bf9\u7f13\u5b58\u6c61\u67d3\u548c\u5185\u5b58\u5e26\u5bbd\u6d6a\u8d39\u654f\u611f\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u8fc7\u591a\u7684\u9884\u53d6\u53cd\u800c\u4f1a\u964d\u4f4e\u6027\u80fd\u3002     - \u8003\u8651\u5230\u56fe8\u663e\u793a\u5927\u90e8\u5206\u5730\u5740\u7684 Markov \u76ee\u6807\u5c11\u4e8e2\u4e2a\uff0c\u4fdd\u7559\u8fc7\u591a\u5019\u9009\u8005\u4f1a\u9020\u6210\u4e0d\u5fc5\u8981\u7684\u5b58\u50a8\u5f00\u9500\u3002</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u6574\u4f53\u4f5c\u7528 - \u8f93\u5165: \u6765\u81ea\u4e3b\u5143\u6570\u636e\u8868\u66ff\u6362\u64cd\u4f5c\u7684\u3001\u88ab\u9a71\u9010\u7684\u9ad8\u4f18\u5148\u7ea7 Markov \u76ee\u6807\uff1b\u4ee5\u53ca\u6765\u81ea\u5904\u7406\u5668\u6838\u5fc3\u7684\u5e38\u89c4\u5185\u5b58\u8bbf\u95ee\u6d41\uff08\u7528\u4e8e\u89e6\u53d1\u7f13\u51b2\u533a\u67e5\u627e\uff09\u3002 - \u8f93\u51fa: \u989d\u5916\u7684\u3001\u9488\u5bf9\u590d\u6742\u201c\u4e00\u5bf9\u591a\u201d\u6a21\u5f0f\u7684\u9884\u53d6\u8bf7\u6c42\u3002 - \u5728 Prophet \u6574\u4f53\u6846\u67b6\u4e2d\u7684\u4f5c\u7528:     - \u5b83\u662f Prophet \u9ad8\u6548\u5143\u6570\u636e\u7ba1\u7406\u7684\u5173\u952e\u4e00\u73af\uff0c\u89e3\u51b3\u4e86\u4f20\u7edf\u8bbe\u8ba1\u65e0\u6cd5\u5904\u7406\u591a\u8def\u5f84\u65f6\u5e8f\u6a21\u5f0f\u7684\u6839\u672c\u7f3a\u9677\u3002     - \u901a\u8fc7\u7cbe\u7ec6\u7ba1\u7406\uff08\u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u63d2\u5165\u548c\u57fa\u4e8e\u4f7f\u7528\u9891\u7387\u7684\u66ff\u6362\uff09\uff0c\u5b83\u4ee5\u53ef\u63a7\u7684\u5b58\u50a8\u548c\u5e26\u5bbd\u5f00\u9500\uff08\u8bba\u6587\u6307\u51fa\u4ec5\u589e\u52a0 1.95% \u5185\u5b58\u5e26\u5bbd\uff09\u663e\u8457\u63d0\u5347\u4e86\u9884\u53d6\u8986\u76d6\u7387\u3002     - \u5176\u6548\u679c\u5728\u7279\u5b9a\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5c24\u4e3a\u7a81\u51fa\uff0c\u4f8b\u5982\u5728 soplex \u4e0a\u8d21\u732e\u4e86 13.46% \u7684\u6027\u80fd\u63d0\u5347\uff0c\u5e76\u4e14\u751a\u81f3\u80fd\u6539\u5584\u5bf9\u5e26\u5bbd\u654f\u611f\u7684 astar \u7684\u6027\u80fd\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#4-adaptive-learning-across-inputs","title":"4. Adaptive Learning across Inputs","text":"<p>Adaptive Learning across Inputs \u7684\u5b9e\u73b0\u539f\u7406</p> <p>Prophet \u7684\u81ea\u9002\u5e94\u5b66\u4e60\u673a\u5236\u65e8\u5728\u89e3\u51b3\u4f20\u7edf Profile-Guided Optimization (PGO) \u5bf9\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u654f\u611f\u7684\u6838\u5fc3\u75db\u70b9\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\u901a\u8fc7\u4e00\u4e2a\u6301\u7eed\u7684\u3001\u589e\u91cf\u7684\u5b66\u4e60\u5faa\u73af\uff0c\u5c06\u4ece\u65b0\u8f93\u5165\u4e2d\u91c7\u6837\u7684\u8fd0\u884c\u65f6\u8ba1\u6570\u5668\u4e0e\u5386\u53f2\u6570\u636e\u5408\u5e76\uff0c\u4ece\u800c\u52a8\u6001\u66f4\u65b0\u7528\u4e8e\u6307\u5bfc\u786c\u4ef6\u9884\u53d6\u5668\u7684 hints\uff0c\u6700\u7ec8\u4f7f\u5355\u4e00\u4f18\u5316\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u80fd\u9ad8\u6548\u5e94\u5bf9\u591a\u6837\u5316\u7684\u8f93\u5165\u3002</p> <ul> <li>\u95ee\u9898\u6839\u6e90: \u4f20\u7edf PGO \u4e3a\u7279\u5b9a\u8f93\u5165\u751f\u6210 hints\uff0c\u5f53\u7a0b\u5e8f\u6267\u884c\u8def\u5f84\u56e0\u8f93\u5165\u6539\u53d8\u800c\u53d8\u5316\u65f6\uff08\u5982\u56fe7\u6240\u793a\uff09\uff0c\u539f\u6709 hints \u53ef\u80fd\u5931\u6548\u3002</li> <li>\u5bf9\u4e8e\u5728\u6240\u6709\u8f93\u5165\u4e0b\u90fd\u6267\u884c\u7684\u6307\u4ee4\uff08\u5982 Load A\uff09\uff0chints \u5177\u6709\u901a\u7528\u6027\u3002</li> <li>\u5bf9\u4e8e\u4ec5\u5728\u7279\u5b9a\u8f93\u5165\u4e0b\u6267\u884c\u7684\u6307\u4ee4\uff08\u5982 Load B/C\uff09\uff0c\u9700\u8981\u4e3a\u65b0\u6307\u4ee4\u751f\u6210\u65b0 hints\u3002</li> <li>\u5bf9\u4e8e\u5728\u4e0d\u540c\u8f93\u5165\u4e0b\u884c\u4e3a\u4e0d\u540c\u7684\u6307\u4ee4\uff08\u5982 Load E\uff09\uff0c\u9700\u8981\u52a8\u6001\u8c03\u6574\u5176 hints\u3002</li> <li>\u89e3\u51b3\u65b9\u6848: Prophet \u5f15\u5165\u4e86\u4e00\u4e2a\u4e09\u6b65\u95ed\u73af\u6d41\u7a0b\uff1aProfiling -&gt; Analysis -&gt; Learning\u3002</li> <li>Profiling \u9636\u6bb5\u4f7f\u7528\u7b80\u5316\u7684\u9884\u53d6\u5668\u548c PMU \u8ba1\u6570\u5668\u6536\u96c6\u539f\u59cb\u6027\u80fd\u6570\u636e\u3002</li> <li>Analysis \u9636\u6bb5\u79bb\u7ebf\u5904\u7406\u8ba1\u6570\u5668\uff0c\u751f\u6210 PC-level \u548c application-level \u7684 hints \u5e76\u6ce8\u5165\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>Learning \u9636\u6bb5\u662f\u81ea\u9002\u5e94\u7684\u5173\u952e\uff0c\u5b83\u5468\u671f\u6027\u5730\u89e6\u53d1\u65b0\u7684 Profiling\uff0c\u5e76\u5c06\u65b0\u6570\u636e\u4e0e\u5386\u53f2\u6570\u636e\u5408\u5e76\uff0c\u9a71\u52a8\u4e0b\u4e00\u8f6e Analysis\u3002</li> </ul> <p></p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u6570\u636e\u5408\u5e76\u7b56\u7565</p> <p>\u81ea\u9002\u5e94\u5b66\u4e60\u7684\u5177\u4f53\u7b97\u6cd5\u4f53\u73b0\u5728\u5bf9\u4e24\u7c7b\u5173\u952e\u8ba1\u6570\u5668\u7684\u5408\u5e76\u4e0a\uff1aPC-level \u7684\u9884\u53d6\u51c6\u786e\u7387\u548c application-level \u7684\u5143\u6570\u636e\u8868\u5206\u914d\u6761\u76ee\u6570\u3002</p> <ul> <li>PC-level \u9884\u53d6\u51c6\u786e\u7387\u5408\u5e76:</li> <li>\u7cfb\u7edf\u7ef4\u62a4\u4e00\u4e2a\u5386\u53f2\u51c6\u786e\u7387\u503c <code>A_old</code>\u3002</li> <li>\u5f53\u9047\u5230\u65b0\u8f93\u5165\u65f6\uff0c\u91c7\u6837\u5f97\u5230\u65b0\u7684\u51c6\u786e\u7387 <code>A_new</code>\u3002</li> <li>\u4f7f\u7528\u6307\u6570\u79fb\u52a8\u5e73\u5747\uff08Exponential Moving Average\uff09\u8fdb\u884c\u5408\u5e76\uff0c\u516c\u5f0f\u5982\u4e0b\uff1a     <pre><code>A_merged = A_old + (A_new - A_old) / N\n</code></pre>     \u5176\u4e2d <code>N</code> \u662f\u4e00\u4e2a\u7531\u8bbe\u8ba1\u8005\u9884\u5b9a\u4e49\u7684\u53c2\u6570\uff0c\u63a7\u5236\u65b0\u6570\u636e\u7684\u5f71\u54cd\u6743\u91cd\u3002</li> <li>\u4f5c\u7528: <ul> <li>\u5bf9\u4e8e\u884c\u4e3a\u4e00\u81f4\u7684\u6307\u4ee4\uff08Load A\uff09\uff0c<code>A_new \u2248 A_old</code>\uff0c\u5408\u5e76\u540e <code>A_merged</code> \u53d8\u5316\u5fae\u5c0f\uff0chints \u4fdd\u6301\u7a33\u5b9a\u3002</li> <li>\u5bf9\u4e8e\u65b0\u51fa\u73b0\u7684\u6307\u4ee4\uff08Load C\uff09\uff0c<code>A_old</code> \u4e0d\u5b58\u5728\u6216\u4e3a\u9ed8\u8ba4\u503c\uff0c<code>A_merged</code> \u4e3b\u8981\u7531 <code>A_new</code> \u51b3\u5b9a\uff0c\u4ece\u800c\u751f\u6210\u65b0 hints\u3002</li> <li>\u5bf9\u4e8e\u884c\u4e3a\u53d8\u5316\u7684\u6307\u4ee4\uff08Load E\uff09\uff0c<code>A_merged</code> \u4f1a\u5411 <code>A_new</code> \u504f\u79fb\uff0c\u5b9e\u73b0 hints \u7684\u52a8\u6001\u8c03\u6574\u3002</li> </ul> </li> </ul> <p></p> <ul> <li>Application-level \u5143\u6570\u636e\u8868\u5927\u5c0f\u5408\u5e76:</li> <li>\u7cfb\u7edf\u7ef4\u62a4\u5386\u53f2\u5cf0\u503c\u5206\u914d\u6761\u76ee\u6570 <code>E_old</code>\u3002</li> <li>\u91c7\u6837\u65b0\u8f93\u5165\u5f97\u5230 <code>E_new</code>\u3002</li> <li>\u91c7\u7528\u4fdd\u5b88\u7b56\u7565\u8fdb\u884c\u5408\u5e76\uff1a<code>E_merged = max(E_old, E_new)</code>\u3002</li> <li>\u4f5c\u7528: \u786e\u4fdd\u5143\u6570\u636e\u8868\u7684\u5927\u5c0f\u8db3\u4ee5\u5bb9\u7eb3\u6240\u6709\u5df2\u89c2\u6d4b\u8f93\u5165\u573a\u666f\u4e0b\u7684\u5cf0\u503c\u9700\u6c42\uff0c\u907f\u514d\u56e0\u7a7a\u95f4\u4e0d\u8db3\u800c\u635f\u5bb3\u6027\u80fd\u3002</li> </ul> <p></p> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u8f93\u5165\u8f93\u51fa\u5173\u7cfb</p> <ul> <li>\u5173\u952e\u53c2\u6570:</li> <li><code>N</code> (\u5b66\u4e60\u7387\u53c2\u6570): \u63a7\u5236\u65b0\u8f93\u5165\u6570\u636e\u5bf9\u5408\u5e76\u7ed3\u679c\u7684\u5f71\u54cd\u901f\u5ea6\u3002<code>N</code> \u8d8a\u5927\uff0c\u7cfb\u7edf\u8d8a\u201c\u5065\u5fd8\u201d\uff0c\u5bf9\u65b0\u8f93\u5165\u7684\u54cd\u5e94\u8d8a\u6162\uff0c\u4f46\u7a33\u5b9a\u6027\u8d8a\u9ad8\uff1b<code>N</code> \u8d8a\u5c0f\uff0c\u7cfb\u7edf\u8d8a\u201c\u654f\u611f\u201d\uff0c\u80fd\u5feb\u901f\u9002\u5e94\u65b0\u8f93\u5165\uff0c\u4f46\u53ef\u80fd\u56e0\u566a\u58f0\u6570\u636e\u800c\u6ce2\u52a8\u3002</li> <li> <p>Profiling \u95f4\u9694: \u5e76\u975e\u6bcf\u6b21\u7a0b\u5e8f\u6267\u884c\u90fd\u8fdb\u884c Profiling\u3002\u6839\u636e\u7ecf\u9a8c\uff0c\u6bcf 10-100 \u6b21\u6267\u884c\u91c7\u6837\u4e00\u6b21\u5373\u53ef\uff0c\u8fd9\u6781\u5927\u5730\u964d\u4f4e\u4e86\u8fd0\u884c\u65f6\u5f00\u9500\u3002</p> </li> <li> <p>\u8f93\u5165\u4e0e\u8f93\u51fa:</p> </li> <li>\u8f93\u5165: \u591a\u6837\u5316\u7684\u7a0b\u5e8f\u8f93\u5165\uff08Program Inputs\uff09\u3002</li> <li>\u5185\u90e8\u72b6\u6001: \u5386\u53f2\u8ba1\u6570\u5668\uff08<code>A_old</code>, <code>E_old</code>\uff09\u3002</li> <li>\u5904\u7406: \u5728 Learning \u9636\u6bb5\uff0c\u65b0\u8f93\u5165\u89e6\u53d1 Profiling\uff0c\u4ea7\u751f\u65b0\u8ba1\u6570\u5668\uff08<code>A_new</code>, <code>E_new</code>\uff09\uff0c\u5e76\u901a\u8fc7\u4e0a\u8ff0\u5408\u5e76\u7b97\u6cd5\u66f4\u65b0\u5185\u90e8\u72b6\u6001\u3002</li> <li>\u8f93\u51fa: \u66f4\u65b0\u540e\u7684 hints\uff0c\u8fd9\u4e9b hints \u88ab\u7528\u4e8e\u4e0b\u4e00\u8f6e\u7684 Analysis \u548c\u4e8c\u8fdb\u5236\u4f18\u5316\uff0c\u6700\u7ec8\u5f71\u54cd\u786c\u4ef6\u9884\u53d6\u5668\u7684 Insertion Policy, Replacement Policy, and Resizing \u884c\u4e3a\u3002</li> </ul> <p>\u5728\u6574\u4f53\u6846\u67b6\u4e2d\u7684\u4f5c\u7528\u4e0e\u6548\u679c</p> <p>\u8be5\u81ea\u9002\u5e94\u5b66\u4e60\u673a\u5236\u662f Prophet \u201cAdaptable\u201d \u7279\u6027\u7684\u57fa\u77f3\uff0c\u4f7f\u5176\u5728\u5b9e\u9645\u90e8\u7f72\u4e2d\u66f4\u5177\u5b9e\u7528\u4ef7\u503c\u3002</p> <ul> <li>\u6548\u679c\u9a8c\u8bc1: \u5982\u56fe13\u6240\u793a\uff0c\u5728 <code>gcc</code> \u5e94\u7528\u4e0a\uff0cProphet \u4ece\u7b2c\u4e00\u4e2a\u8f93\u5165 <code>gcc_166</code> \u5f00\u59cb\u5b66\u4e60\u3002\u968f\u7740\u9010\u6b65\u5f15\u5165 <code>gcc_expr</code>, <code>gcc_typeck</code> \u7b49\u65b0\u8f93\u5165\uff0c\u5176\u6027\u80fd\u9010\u6e10\u63d0\u5347\u5e76\u6700\u7ec8\u63a5\u8fd1\u4e3a\u6bcf\u4e2a\u8f93\u5165\u5355\u72ec\u4f18\u5316\u7684\u201c\u7406\u60f3\u201d\u6027\u80fd\uff08Direct\uff09\u3002</li> <li>\u6cdb\u5316\u80fd\u529b: \u5982\u56fe14\u6240\u793a\uff0c\u8be5\u5b66\u4e60\u673a\u5236\u4e0d\u4ec5\u9002\u7528\u4e8e <code>gcc</code>\uff0c\u8fd8\u80fd\u6709\u6548\u6cdb\u5316\u5230 <code>astar</code> \u548c <code>soplex</code> \u7b49\u5176\u4ed6\u5de5\u4f5c\u8d1f\u8f7d\u3002</li> <li>\u5bf9\u6bd4\u4f18\u52bf: \u4e0e RPG2 \u7b49\u4f20\u7edf\u65b9\u6848\u76f8\u6bd4\uff0cProphet \u65e0\u9700\u4e3a\u6bcf\u4e2a\u65b0\u8f93\u5165\u91cd\u65b0\u8fdb\u884c\u5b8c\u6574\u7684 PGO \u6d41\u7a0b\uff0c\u800c\u662f\u80fd\u591f\u589e\u91cf\u5f0f\u5730\u5229\u7528\u5386\u53f2\u77e5\u8bc6\uff0c\u5b9e\u73b0\u201c\u4e00\u6b21\u4f18\u5316\uff0c\u591a\u8f93\u5165\u53d7\u76ca\u201d\u3002</li> </ul> <p></p> <p>Figure 13: Prophet learns counters from gcc\u2019s inputs.</p> <p></p> <p>Figure 14: Prophet\u2019s learning feature can be generalized to other workloads, such as astar and soplex.</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#5-lightweight-counter-based-profiling","title":"5. Lightweight Counter-Based Profiling","text":"<p>\u5b9e\u73b0\u539f\u7406\u4e0e\u6838\u5fc3\u601d\u60f3</p> <p>Prophet \u7684\u8f7b\u91cf\u7ea7\u5256\u6790\uff08Lightweight Profiling\uff09\u673a\u5236\u6452\u5f03\u4e86\u4f20\u7edf\u65b9\u6848\u4e2d\u5f00\u9500\u5de8\u5927\u7684\u5b8c\u6574\u5185\u5b58\u8bbf\u95ee trace\uff0c\u8f6c\u800c\u5229\u7528\u73b0\u4ee3\u5904\u7406\u5668\u5185\u7f6e\u7684 Performance Monitoring Unit (PMU) \u548c Processor Event-Based Sampling (PEBS) \u529f\u80fd\uff0c\u4ec5\u6536\u96c6\u9ad8\u5ea6\u805a\u5408\u7684 \u8ba1\u6570\u5668\uff08counters\uff09\u3002\u8fd9\u4e00\u8bbe\u8ba1\u7684\u6838\u5fc3\u5728\u4e8e\uff0c\u901a\u8fc7\u5c11\u91cf\u3001\u7cbe\u51c6\u7684\u786c\u4ef6\u4e8b\u4ef6\u8ba1\u6570\uff0c\u5373\u53ef\u63a8\u5bfc\u51fa\u6307\u5bfc\u5143\u6570\u636e\u8868\u7ba1\u7406\u6240\u9700\u7684\u5168\u90e8\u5173\u952e\u6307\u6807\u3002</p> <ul> <li>\u5173\u952e\u6d1e\u5bdf\uff1a\u8bba\u6587\u6307\u51fa\uff0c\u5c3d\u7ba1\u5355\u4e2a\u5143\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\uff08\u5982 Figure 1 \u6240\u793a\uff09\u5177\u6709\u9ad8\u5ea6\u52a8\u6001\u6027\u548c\u65b9\u5dee\uff0c\u4f46\u9488\u5bf9\u6bcf\u4e2a Program Counter (PC) \u7684\u6574\u4f53 prefetching accuracy \u5374\u5448\u73b0\u51fa\u7a33\u5b9a\u7684\u3001\u53ef\u5206\u7c7b\u7684\u7279\u6027\uff08\u5982 Figure 6 \u6240\u793a\uff09\u3002\u8fd9\u4f7f\u5f97\u57fa\u4e8e PC \u7ea7\u522b\u7684\u8ba1\u6570\u5668\u7edf\u8ba1\u6210\u4e3a\u53ef\u80fd\u4e14\u6709\u6548\u3002</li> <li>\u76ee\u6807\u6307\u6807\uff1a\u8be5\u673a\u5236\u65e8\u5728\u9ad8\u6548\u83b7\u53d6\u4e24\u5927\u7c7b\u4fe1\u606f\uff1a</li> <li>PC-level \u6307\u6807\uff1a\u6bcf\u4e2a\u5185\u5b58\u8bbf\u95ee\u6307\u4ee4\uff08\u7531\u5176 PC \u6807\u8bc6\uff09\u7684 prefetching accuracy\uff0c\u7528\u4e8e\u6307\u5bfc \u63d2\u5165\u7b56\u7565\uff08Insertion Policy\uff09 \u548c \u66ff\u6362\u7b56\u7565\uff08Replacement Policy\uff09\u3002</li> <li>Application-level \u6307\u6807\uff1a\u7a0b\u5e8f\u6267\u884c\u7ed3\u675f\u65f6 metadata table \u7684 allocated entries \u6570\u91cf\uff0c\u7528\u4e8e\u6307\u5bfc resizing \u64cd\u4f5c\u3002</li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u6570\u636e\u6536\u96c6</p> <p>\u5256\u6790\u6d41\u7a0b\u5206\u4e3a\u4e24\u4e2a\u660e\u786e\u7684\u6570\u636e\u6536\u96c6\u9636\u6bb5\uff0c\u5747\u5728 Step 1: Profiling \u4e2d\u5b8c\u6210\uff0c\u5e76\u4f9d\u8d56\u4e8e\u4e00\u4e2a\u7b80\u5316\u7684\u4e34\u65f6\u9884\u53d6\u5668\u914d\u7f6e\u3002</p> <ul> <li>\u7b80\u5316\u9884\u53d6\u5668\u914d\u7f6e\uff1a</li> <li>\u63d2\u5165\u7b56\u7565\u88ab\u7981\u7528\u3002</li> <li>\u5143\u6570\u636e\u8868\u5927\u5c0f\u56fa\u5b9a\u4e3a 1 MB\u3002</li> <li>\u9884\u53d6\u5ea6\uff08prefetching degree\uff09\u8bbe\u4e3a 1\u3002</li> <li> <p>\u6b64\u914d\u7f6e\u786e\u4fdd\u4e86\u5bf9\u6240\u6709\u5185\u5b58\u6307\u4ee4\u7684\u65e0\u504f\u8bc4\u4f30\uff0c\u907f\u514d\u4e86\u73b0\u6709\u4f18\u5316\u7b56\u7565\u5bf9\u5256\u6790\u7ed3\u679c\u7684\u5e72\u6270\u3002</p> </li> <li> <p>PC-level Prefetching Accuracy \u6536\u96c6\uff1a</p> </li> <li>\u5229\u7528 Intel PEBS \u529f\u80fd\uff0c\u5728\u7279\u5b9a\u786c\u4ef6\u4e8b\u4ef6\u53d1\u751f\u65f6\u8bb0\u5f55\u4e0a\u4e0b\u6587\uff08\u4e3b\u8981\u662f PC\uff09\u3002</li> <li>\u542f\u7528\u5e76\u91c7\u6837\u4ee5\u4e0b\u4e24\u4e2a\u81ea\u5b9a\u4e49\u4e8b\u4ef6\uff08\u57fa\u4e8e <code>MEM_LOAD_RETIRED.L2_MISS</code> \u4e8b\u4ef6\u4fee\u6539\u800c\u6765\uff09\uff1a<ul> <li><code>MEM_LOAD_RETIRED.L2_Prefetch_Issue</code>\uff1a\u8bb0\u5f55\u53d1\u51fa\u7684\u9884\u53d6\u8bf7\u6c42\u6570\u91cf\u3002</li> <li><code>MEM_LOAD_RETIRED.L2_Prefetch_Useful</code>\uff1a\u8bb0\u5f55\u88ab\u540e\u7eed\u9700\u6c42\u8bf7\u6c42\u547d\u4e2d\u7684\u6709\u7528\u9884\u53d6\u6570\u91cf\u3002</li> </ul> </li> <li>\u5bf9\u4e8e\u6bcf\u4e2a PC\uff0c\u5176 prefetching accuracy \u901a\u8fc7\u4ee5\u4e0b\u516c\u5f0f\u8ba1\u7b97\uff1a     prefetching_accuracy = L2_Prefetch_Useful / L2_Prefetch_Issue</li> <li></li> </ul> <p></p> <ul> <li>Application-level Allocated Entries \u6536\u96c6\uff1a</li> <li>\u4f7f\u7528\u6807\u51c6 PMU counters\uff08\u975e PEBS\uff09\u6765\u8ffd\u8e2a\u5168\u5c40\u4e8b\u4ef6\u3002</li> <li>\u5b9a\u4e49\u4e24\u4e2a\u8ba1\u6570\u5668\uff1a<ul> <li><code>N_insertions</code>\uff1a\u5143\u6570\u636e\u8868\u7684\u603b\u63d2\u5165\u6b21\u6570\u3002</li> <li><code>N_replacements</code>\uff1a\u5143\u6570\u636e\u8868\u7684\u603b\u66ff\u6362\uff08\u9a71\u9010\uff09\u6b21\u6570\u3002</li> </ul> </li> <li>\u7a0b\u5e8f\u7ed3\u675f\u65f6\uff0callocated entries \u7684\u6570\u91cf\u901a\u8fc7\u4ee5\u4e0b\u516c\u5f0f\u4f30\u7b97\uff1a     N_allocated = N_insertions - N_replacements</li> </ul> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728 Prophet \u6574\u4f53\u6846\u67b6\u4e2d\u7684\u4f5c\u7528</p> <p>\u8be5\u5256\u6790\u673a\u5236\u662f Prophet \u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1\u7684\u8d77\u70b9\uff0c\u5176\u8f93\u5165\u548c\u8f93\u51fa\u7d27\u5bc6\u8854\u63a5\u4e86\u79bb\u7ebf\u5206\u6790\u4e0e\u5728\u7ebf\u6267\u884c\u3002</p> <ul> <li>\u8f93\u5165\uff1a</li> <li>\u76ee\u6807\u5e94\u7528\u7a0b\u5e8f\u7684\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li> <p>\u4e00\u7ec4\u6216\u591a\u7ec4\u5177\u6709\u4ee3\u8868\u6027\u7684 program inputs\u3002</p> </li> <li> <p>\u8f93\u51fa\uff1a</p> </li> <li>\u4e00\u7ec4\u7ed3\u6784\u5316\u7684 counter data\uff0c\u5305\u542b\u6bcf\u4e2a\u76f8\u5173 PC \u7684 <code>(L2_Prefetch_Issue, L2_Prefetch_Useful)</code> \u5bf9\uff0c\u4ee5\u53ca\u5168\u5c40\u7684 <code>(N_insertions, N_replacements)</code> \u5bf9\u3002</li> <li> <p>\u8fd9\u4e9b\u6570\u636e\u662f Step 2: Analysis \u7684\u552f\u4e00\u8f93\u5165\uff0c\u7528\u4e8e\u751f\u6210 hints\u3002</p> </li> <li> <p>\u5728\u6574\u4f53\u6846\u67b6\u4e2d\u7684\u4f5c\u7528\uff1a</p> </li> <li>\u5960\u57fa\u4f5c\u7528\uff1a\u4e3a\u540e\u7eed\u6240\u6709 profile-guided \u4f18\u5316\uff08\u63d2\u5165\u3001\u66ff\u6362\u3001\u91cd\u8bbe\u5927\u5c0f\uff09\u63d0\u4f9b\u771f\u5b9e\u3001\u4f4e\u5f00\u9500\u7684\u51b3\u7b56\u4f9d\u636e\u3002\u76f8\u6bd4\u786c\u4ef6\u4ec5\u80fd\u4f9d\u8d56\u77ed\u65f6\u5386\u53f2\uff0c\u8fd9\u4e9b\u8ba1\u6570\u5668\u53cd\u6620\u4e86\u7a0b\u5e8f\u5728\u6574\u4e2a\u5256\u6790\u8fd0\u884c\u5468\u671f\u5185\u7684\u957f\u671f\u884c\u4e3a\u3002</li> <li>\u5b9e\u73b0\u201cAdaptable\u201d\u7279\u6027\uff1a\u5728 Step 3: Learning \u4e2d\uff0c\u65b0\u8f93\u5165\u4ea7\u751f\u7684\u8ba1\u6570\u5668\u4f1a\u4e0e\u5386\u53f2\u8ba1\u6570\u5668\u6309\u7279\u5b9a\u516c\u5f0f\uff08\u5982 Equation 4 \u548c Equation 5\uff09\u8fdb\u884c\u5408\u5e76\uff0c\u4f7f hints \u80fd\u591f\u52a8\u6001\u9002\u5e94\u4e0d\u540c\u7684\u7a0b\u5e8f\u8f93\u5165\u3002<ul> <li></li> </ul> </li> </ul> <p></p> <pre><code>-\n</code></pre> <p></p> <ul> <li>\u4fdd\u8bc1\u201cLightweight\u201d\u7279\u6027\uff1a\u6574\u4e2a\u5256\u6790\u8fc7\u7a0b\u5f00\u9500\u6781\u4f4e\u3002\u6839\u636e\u8bba\u6587\u5f15\u7528 [15]\uff0c\u91c7\u6837\u5c11\u91cf PEBS \u4e8b\u4ef6\u5f15\u5165\u7684\u6027\u80fd\u5f00\u9500 \u5c0f\u4e8e 2%\uff0c\u4e14\u5e76\u975e\u6bcf\u6b21\u7a0b\u5e8f\u6267\u884c\u90fd\u9700\u8981\u5256\u6790\uff0c\u901a\u5e38\u6bcf 10-100 \u6b21\u6267\u884c\u4e00\u6b21\u5373\u53ef\u3002</li> </ul> <p>\u5f00\u9500\u4e0e\u53ef\u884c\u6027\u5206\u6790</p> \u5f00\u9500\u7c7b\u578b \u5177\u4f53\u63cf\u8ff0 \u91cf\u5316\u7ed3\u679c Profiling Overhead \u8fd0\u884c\u65f6\u6536\u96c6\u8ba1\u6570\u5668\u7684\u6027\u80fd\u635f\u5931 &lt; 2% (\u56e0\u4ec5\u91c7\u68372-3\u4e2aPEBS\u4e8b\u4ef6\u548c1\u4e2aPMU\u4e8b\u4ef6) Analysis Overhead \u79bb\u7ebf\u811a\u672c\u5904\u7406\u8ba1\u6570\u5668\u751f\u6210hints\u7684\u65f6\u95f4 &lt; 1\u79d2 (\u5bf9\u6240\u6709\u8bc4\u6d4bworkload) Instruction Overhead \u6ce8\u5165hints\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u5e26\u6765\u7684\u989d\u5916\u6307\u4ee4 \u53ef\u5ffd\u7565 (\u6700\u591a128\u6761hint\u6307\u4ee4\uff0c\u5bf9\u6bd4\u6570\u5341\u4ebf\u6761\u4e3b\u7a0b\u5e8f\u6307\u4ee4) <p>\u8be5\u8bbe\u8ba1\u5145\u5206\u5229\u7528\u4e86\u73b0\u6709\u5904\u7406\u5668\u67b6\u6784\uff08\u5982 Intel Xeon\uff09\u5df2\u652f\u6301\u7684 PMU/PEBS \u529f\u80fd\uff0c\u65e0\u9700\u4efb\u4f55\u989d\u5916\u7684\u786c\u4ef6\u8ffd\u8e2a\u5355\u5143\uff0c\u56e0\u6b64\u5177\u6709\u6781\u5f3a\u7684 \u73b0\u5b9e\u53ef\u884c\u6027 \u548c \u90e8\u7f72\u4fbf\u5229\u6027\u3002</p>"},{"location":"notes_repo/profile-guided-temporal-prefetching/paper_notes/#4","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u6a21\u62df\u5e73\u53f0: \u91c7\u7528 gem5 \u7684\u5168\u7cfb\u7edf (FS) \u6a21\u5f0f\u8fdb\u884c\u8bc4\u4f30\u3002</li> <li>\u7cfb\u7edf\u914d\u7f6e: \u4e3b\u8981\u53c2\u6570\u4e0e Triangel \u8bba\u6587\u4fdd\u6301\u4e00\u81f4\uff0c\u5177\u4f53\u7ec6\u8282\u89c1\u4e0b\u8868\u3002</li> </ul> \u7ec4\u4ef6 \u914d\u7f6e CPU 4 \u6838 OoO CPU, 3.2GHz, 8-wide issue L1 Cache 64KB I/D, 4-way, 64B block, 4-cycle hit L2 Cache 1MB, 8-way, 64B block, 12-cycle hit LLC 8MB, 16-way, 64B block, shared with Markov table DRAM 4-channel DDR4-2400, 12.8GB/s per channel Prefetchers L1: Stride; L2: Prophet/Triangel/RPG2 <ul> <li>\u5de5\u4f5c\u8d1f\u8f7d: </li> <li>\u4f7f\u7528 SPEC CPU \u4e2d\u5177\u6709\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684 benchmark\uff08\u5982 <code>mcf</code>, <code>omnetpp</code>, <code>gcc</code> \u7b49\uff09\u3002</li> <li>\u540c\u65f6\u5305\u542b CRONO \u56fe\u8ba1\u7b97 benchmark \u5957\u4ef6\u3002</li> <li>\u91c7\u7528 SimPoint \u6280\u672f\u751f\u6210\u4ee3\u8868\u6027\u68c0\u67e5\u70b9\uff0c\u5e76\u5bf9\u7ed3\u679c\u8fdb\u884c\u52a0\u6743\u5e73\u5747\u3002</li> <li>\u57fa\u7ebf\u5bf9\u6bd4:</li> <li>\u786c\u4ef6\u57fa\u7ebf: Triangel\uff0c\u4f7f\u7528\u5176\u5f00\u6e90\u5b9e\u73b0\u3002</li> <li>\u8f6f\u4ef6\u57fa\u7ebf: RPG2\uff0c\u901a\u8fc7 hint buffer \u673a\u5236\u6a21\u62df\u5176\u8f6f\u4ef6\u9884\u53d6\u6307\u4ee4\u63d2\u5165\u3002</li> </ul> <p></p> <p>\u6838\u5fc3\u7ed3\u679c\u6570\u636e</p> <ul> <li>\u6574\u4f53\u6027\u80fd: \u76f8\u6bd4\u65e0\u65f6\u95f4\u9884\u53d6\u5668\u7684\u57fa\u7ebf\uff0cProphet \u5e73\u5747 IPC \u63d0\u5347 34.58%\uff0c\u663e\u8457\u4f18\u4e8e Triangel (20.35%) \u548c RPG2 (0.1%)\u3002</li> <li>Prophet \u76f8\u5bf9\u4e8e Triangel \u7684\u6027\u80fd\u589e\u76ca\u4e3a 14.23%\u3002</li> <li>Prophet \u76f8\u5bf9\u4e8e RPG2 \u7684\u6027\u80fd\u589e\u76ca\u9ad8\u8fbe 34.48%\u3002</li> </ul> <p></p> <p>Figure 10: IPC speedup compared to RPG2 and Triangel.</p> <ul> <li>\u5185\u5b58\u6d41\u91cf: Prophet \u5f15\u5165\u7684 DRAM \u6d41\u91cf\u5f00\u9500\u4e3a 18.67%\uff0c\u4ec5\u6bd4 Triangel (10.33%) \u591a\u51fa 5.35% \u7684\u989d\u5916\u5f00\u9500\uff0c\u8bc1\u660e\u5176\u9ad8\u6548\u6027\u3002</li> </ul> <p></p> <p>Figure 11: DRAM traffic compared to RPG2 and Triangel.</p> <ul> <li>\u9884\u53d6\u6548\u679c\u5206\u6790:</li> <li>Prophet \u5c06 demand misses \u51cf\u5c11\u4e86 42.75%\uff0c\u800c Triangel \u4ec5\u4e3a 28.08%\u3002</li> <li>\u4e24\u8005\u7684 prefetching accuracy \u76f8\u5f53\uff0c\u8868\u660e Prophet \u7684\u4f18\u52bf\u6e90\u4e8e\u66f4\u9ad8\u7684 prefetching coverage\uff0c\u800c\u975e\u6fc0\u8fdb\u7684\u3001\u4f4e\u7cbe\u5ea6\u7684\u9884\u53d6\u3002</li> </ul> <p></p> <p>Figure 12: Prefetching coverage and accuracy6.</p> <ul> <li>\u56fe\u8ba1\u7b97\u5de5\u4f5c\u8d1f\u8f7d: \u5728 CRONO \u4e0a\uff0cProphet (14.85%) \u540c\u6837\u4f18\u4e8e RPG2 (9.11%) \u548c Triangel (8.41%)\uff0c\u8bc1\u660e\u5176\u901a\u7528\u6027\u3002</li> </ul> <p></p> <p>Figure 15: IPC speedup on graph workloads.</p> <p>\u6d88\u878d\u5b9e\u9a8c (Ablation Study)</p> <p>\u6d88\u878d\u5b9e\u9a8c\u4ee5 Triage4 + Triangel metadata format \u4e3a\u57fa\u7840\uff0c\u9010\u9879\u6dfb\u52a0 Prophet \u7684\u7279\u6027\uff0c\u4ee5\u91cf\u5316\u5404\u7ec4\u4ef6\u7684\u8d21\u732e\u3002</p> <p></p> <p>Figure 19: Prophet Features Breakdown.</p> <ul> <li>Profile-Guided Replacement Policy:</li> <li>\u8d21\u732e\u6700\u5927\uff0c\u5c24\u5176\u5728 <code>mcf</code> (+14.53%) \u548c <code>omnetpp</code> (+9.89%) \u7b49\u5bf9\u7f13\u5b58\u6c61\u67d3\u654f\u611f\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u6548\u679c\u663e\u8457\u3002</li> <li> <p>\u901a\u8fc7\u4fdd\u7559\u9ad8 prefetching accuracy \u7684\u5143\u6570\u636e\uff0c\u6709\u6548\u63d0\u5347\u4e86\u5143\u6570\u636e\u8868\u7684\u5229\u7528\u7387\u3002</p> </li> <li> <p>Profile-Guided Insertion Policy:</p> </li> <li>\u8bbe\u8ba1\u4fdd\u5b88\uff0c\u907f\u514d\u4e86\u50cf Triangel \u7684 PatternConf \u90a3\u6837\u9519\u8bef\u8fc7\u6ee4\u6709\u7528\u5143\u6570\u636e\u7684\u95ee\u9898\u3002</li> <li> <p>\u5728 <code>mcf</code> \u4e0a\u5e26\u6765 16.72% \u7684\u663e\u8457\u63d0\u5347\uff0c\u5e76\u6709\u6548\u964d\u4f4e\u4e86\u5185\u5b58\u6d41\u91cf\u3002</p> </li> <li> <p>Multi-path Victim Buffer:</p> </li> <li>\u7528\u4e8e\u5904\u7406\u5355\u4e2a\u5730\u5740\u5bf9\u5e94\u591a\u4e2a Markov targets \u7684\u590d\u6742\u573a\u666f\uff08\u5982 <code>soplex</code>\uff0c+13.46%\uff09\u3002</li> <li> <p>\u4ec5\u5f15\u5165 1.95% \u7684\u989d\u5916\u5185\u5b58\u5e26\u5bbd\u5f00\u9500\uff0c\u5bf9 <code>astar</code> \u7b49\u5e26\u5bbd\u654f\u611f\u578b\u5e94\u7528\u5f71\u54cd\u751a\u5fae\u3002</p> </li> <li> <p>Profile-Guided Resizing:</p> </li> <li>\u5bf9\u5143\u6570\u636e\u9700\u6c42\u8f83\u5c0f\u7684\u5e94\u7528\uff08\u5982 <code>sphinx3</code>\uff09\u6700\u6709\u6548\uff0c\u53ef\u91ca\u653e\u66f4\u591a LLC \u7a7a\u95f4\uff0c\u5e26\u6765 1.5% \u7684\u6027\u80fd\u589e\u76ca\u3002</li> <li>\u5b9e\u9a8c\u8868\u660e\uff0c\u52a8\u6001\u8c03\u6574\u5143\u6570\u636e\u8868\u5927\u5c0f\u5e26\u6765\u7684\u6536\u76ca\u6709\u9650\uff0c\u56e0\u6b64\u91c7\u7528\u57fa\u4e8e\u5cf0\u503c\u9700\u6c42\u7684\u9759\u6001\u5206\u914d\u662f\u9ad8\u6548\u4e14\u5b9e\u7528\u7684\u7b56\u7565\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/ELI5_notes/","title":"RICH Prefetcher: Storing Rich Information in Memory to Trade Capacity and Bandwidth for Latency Hiding \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <p>\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\uff08Prefetcher\uff09\u5728\u8bbe\u8ba1\u4e0a\u9677\u5165\u4e86\u4e24\u96be\u56f0\u5883\uff1a - \u4e3a\u4e86\u7701\u9762\u79ef\uff0c\u727a\u7272\u4e86\u80fd\u529b\uff1a\u50cf Bingo\u3001SMS \u8fd9\u7c7b\u5148\u8fdb\u7684\u7a7a\u95f4\u9884\u53d6\u5668\uff0c\u4e3a\u4e86\u63a7\u5236\u5b9d\u8d35\u7684 on-chip area \u5f00\u9500\uff0c\u901a\u5e38\u53ea\u6562\u5728\u4e00\u4e2a\u56fa\u5b9a\u7684 4KB \u9875\u5185\u5b66\u4e60\u8bbf\u95ee\u6a21\u5f0f\u3002\u8fd9\u5c31\u50cf\u662f\u4e00\u4e2a\u89c6\u529b\u5f88\u597d\u7684\u4eba\uff0c\u5374\u88ab\u5f3a\u5236\u6234\u4e0a\u4e86\u4e00\u4e2a\u53ea\u80fd\u770b\u773c\u524d\u4e00\u7c73\u7684\u96a7\u9053\u89c6\u91ce\u773c\u955c\u3002\u5f53\u7a0b\u5e8f\u7684\u6570\u636e\u7ed3\u6784\u8de8\u8d8a\u591a\u4e2a\u9875\u9762\uff08\u6bd4\u5982\u4e00\u4e2a\u5927\u5bf9\u8c61\u5206\u5e03\u572816KB\u7a7a\u95f4\u91cc\uff09\uff0c\u8fd9\u79cd\u9884\u53d6\u5668\u5c31\u5b8c\u5168\u201c\u770b\u4e0d\u89c1\u201d\u4e86\uff0c\u5bfc\u81f4 coverage\uff08\u8986\u76d6\u7387\uff09\u4e25\u91cd\u4e0d\u8db3\u3002 - \u4e3a\u4e86\u8ffd\u6c42\u6570\u91cf\uff0c\u727a\u7272\u4e86\u8d28\u91cf\uff1a\u5982\u679c\u7b80\u5355\u5730\u628a\u9884\u53d6\u533a\u57df\u6269\u5927\u523016KB\uff0c\u95ee\u9898\u53c8\u6765\u4e86\u3002\u4ec5\u51ed\u7b2c\u4e00\u6b21\u8bbf\u95ee\u7684\u5730\u5740\uff08PC, offset\uff09\u5c31\u53bb\u9884\u6d4b\u540e\u9762\u6574\u4e2a16KB\u533a\u57df\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4f1a\u9047\u5230\u5927\u91cf\u201ccommon-origin, later-divergent\u201d\uff08\u540c\u6e90\u5f02\u6d41\uff09\u7684\u60c5\u51b5\u2014\u2014\u5373\u5f88\u591a\u4e0d\u540c\u7684\u6570\u636e\u6d41\u90fd\u4ece\u540c\u4e00\u4e2a\u5730\u65b9\u5f00\u59cb\u8bbf\u95ee\uff0c\u4f46\u540e\u7eed\u8d70\u5411\u5b8c\u5168\u4e0d\u540c\u3002\u8fd9\u4f1a\u5bfc\u81f4 accuracy\uff08\u51c6\u786e\u7387\uff09\u66b4\u8dcc\uff0c\u4ea7\u751f\u5927\u91cf\u65e0\u7528\u7684\u9884\u53d6\uff0c\u4e0d\u4ec5\u6d6a\u8d39 bandwidth\uff0c\u8fd8\u4f1a\u6c61\u67d3\u7f13\u5b58\u3002</p> <p>\u66f4\u6839\u672c\u7684\u95ee\u9898\u662f\uff0c\u73b0\u4ee3\u548c\u672a\u6765\u7684\u5185\u5b58\u7cfb\u7edf\uff08\u5982 CXL-based memory pooling, NVM\uff09\u6b63\u671d\u7740 \u9ad8\u5e26\u5bbd\u3001\u5927\u5bb9\u91cf\u3001\u9ad8\u5ef6\u8fdf \u7684\u65b9\u5411\u53d1\u5c55\u3002\u65e7\u7684\u9884\u53d6\u5668\u8bbe\u8ba1\u7406\u5ff5\uff08\u6781\u5ea6\u541d\u556c\u5143\u6570\u636e\uff09\u5df2\u7ecf\u65e0\u6cd5\u5145\u5206\u5229\u7528\u8fd9\u79cd\u65b0\u786c\u4ef6\u7684\u4f18\u52bf\u6765\u9690\u85cf\u8d8a\u6765\u8d8a\u957f\u7684 memory access latency\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <p>\u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08Prefetcher\uff09\uff0c\u8d1f\u8d23\u5728\u8bfb\u8005\uff08CPU\uff09\u9700\u8981\u4e4b\u524d\uff0c\u628a\u4e66\uff08\u6570\u636e\uff09\u4ece\u8fdc\u5904\u7684\u4ed3\u5e93\uff08Main Memory\uff09\u642c\u5230\u624b\u8fb9\u7684\u9605\u89c8\u5ba4\uff08Cache\uff09\u3002</p> <ul> <li>\u8001\u6d3e\u7ba1\u7406\u5458\uff08\u4f20\u7edf\u9884\u53d6\u5668\uff09\uff1a\u4ed6\u6709\u4e00\u4e2a\u5f88\u5c0f\u7684\u8bb0\u4e8b\u672c\uff08on-chip storage\uff09\uff0c\u53ea\u80fd\u8bb0\u5f55\u201c\u67d0\u67d0\u6559\u6388\uff08PC\uff09\u6bcf\u6b21\u6765\u90fd\u4f1a\u62ff\u8d70A\u4e66\u67b6\uff084KB\u9875\uff09\u4e0a\u7684\u7b2c3\u30015\u30017\u672c\u4e66\u201d\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5f88\u7701\u7eb8\uff0c\u4f46\u5982\u679c\u6559\u6388\u8fd9\u6b21\u8981\u7814\u7a76\u4e00\u4e2a\u5927\u8bfe\u9898\uff0c\u9700\u8981A\u3001B\u3001C\u4e09\u4e2a\u4e66\u67b6\uff0816KB\u533a\u57df\uff09\u7684\u4e66\uff0c\u7ba1\u7406\u5458\u5c31\u50bb\u773c\u4e86\uff0c\u56e0\u4e3a\u4ed6\u7684\u8bb0\u4e8b\u672c\u6ca1\u5730\u65b9\u8bb0\u8fd9\u4e48\u590d\u6742\u7684\u6a21\u5f0f\u3002</li> <li>\u5192\u8fdb\u7684\u7ba1\u7406\u5458\uff08\u7b80\u5355\u6269\u5927\u533a\u57df\uff09\uff1a\u4ed6\u6362\u4e86\u4e2a\u5927\u8bb0\u4e8b\u672c\uff0c\u5f00\u59cb\u8bb0\u5f55\u201cA\u4e66\u67b6+B\u4e66\u67b6+C\u4e66\u67b6\u201d\u7684\u7ec4\u5408\u3002\u4f46\u4ed6\u6709\u4e2a\u574f\u4e60\u60ef\uff1a\u53ea\u8981\u770b\u5230\u6559\u6388\u62ff\u4e86A\u4e66\u67b6\u7684\u7b2c\u4e00\u672c\u4e66\uff0c\u5c31\u7acb\u523b\u628aABC\u4e09\u4e2a\u4e66\u67b6\u7684\u6240\u6709\u4e66\u90fd\u642c\u8fc7\u6765\u3002\u7ed3\u679c\u53d1\u73b0\uff0c\u6709\u65f6\u5019\u6559\u6388\u53ea\u662f\u987a\u624b\u62ff\u4e00\u4e0bA\u4e66\u67b6\u7684\u4e66\uff0c\u6839\u672c\u4e0d\u9700\u8981\u540e\u9762\u7684\uff0c\u5bfc\u81f4\u9605\u89c8\u5ba4\u5806\u6ee1\u4e86\u6ca1\u7528\u7684\u4e66\uff0c\u771f\u6b63\u9700\u8981\u7684\u4e66\u53cd\u800c\u6ca1\u5730\u65b9\u653e\u4e86\u3002</li> </ul> <p>RICH \u7684\u7ba1\u7406\u5458\u5219\u975e\u5e38\u806a\u660e\uff1a 1.  \u4ed6\u6709\u4e0d\u540c\u5c3a\u5bf8\u7684\u642c\u8fd0\u7b56\u7565\uff1a\u5bf9\u4e8e\u5c0f\u9700\u6c42\uff082KB/4KB\uff09\uff0c\u4ed6\u52a8\u4f5c\u5feb\u3001\u8986\u76d6\u5e7f\uff0c\u770b\u5230\u4e00\u70b9\u82d7\u5934\u5c31\u642c\uff1b\u5bf9\u4e8e\u5927\u9700\u6c42\uff0816KB\uff09\uff0c\u4ed6\u975e\u5e38\u8c28\u614e\uff0c\u4e00\u5b9a\u8981\u770b\u5230\u6559\u6388\u8fde\u7eed\u62ff\u4e86\u597d\u51e0\u672c\uff08\u6bd4\u59825\u672c\uff09\u6765\u81ea\u8fd9\u4e2a\u5927\u533a\u57df\u7684\u4e66\uff0c\u624d\u786e\u8ba4\u6559\u6388\u771f\u7684\u8981\u641e\u5927\u9879\u76ee\uff0c\u7136\u540e\u624d\u4e00\u6b21\u6027\u628a\u6574\u4e2a\u533a\u57df\u7684\u4e66\u9ad8\u6548\u5730\u642c\u8fc7\u6765\u3002 2.  \u4ed6\u6709\u5206\u5c42\u7684\u8bb0\u4e8b\u7cfb\u7edf\uff1a\u4ed6\u628a\u6700\u5e38\u7528\u3001\u6700\u91cd\u8981\u7684\u5927\u9879\u76ee\u6e05\u5355\uff08\u9ad8\u989116KB\u6a21\u5f0f\uff09\u8bb0\u5728\u624b\u8fb9\u7684\u5c0f\u672c\u5b50\u4e0a\uff08on-chip cache\uff09\u3002\u90a3\u4e9b\u4e0d\u5e38\u7528\u7684\u3001\u751f\u50fb\u7684\u5927\u9879\u76ee\u6e05\u5355\uff0c\u4ed6\u5219\u5b58\u653e\u5728\u4ed3\u5e93\u91cc\u7684\u4e00\u4e2a\u4e13\u7528\u6587\u4ef6\u67dc\u91cc\uff08off-chip main memory\uff09\u3002\u867d\u7136\u53bb\u4ed3\u5e93\u62ff\u6e05\u5355\u8981\u82b1\u70b9\u65f6\u95f4\uff0c\u4f46\u56e0\u4e3a\u4ed6\u53ea\u5728\u786e\u8ba4\u662f\u5927\u9879\u76ee\u65f6\u624d\u53bb\u62ff\uff0c\u800c\u4e14\u5927\u9879\u76ee\u672c\u8eab\u80fd\u5e26\u6765\u5de8\u5927\u7684\u6536\u76ca\uff0c\u8fd9\u70b9\u7b49\u5f85\u65f6\u95f4\u5b8c\u5168\u503c\u5f97\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>RICH \u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\uff0c\u5b83\u6ca1\u6709\u5728\u201c\u5c0f\u800c\u7cbe\u201d\u548c\u201c\u5927\u800c\u5168\u201d\u4e4b\u95f4\u505a\u975e\u6b64\u5373\u5f7c\u7684\u9009\u62e9\uff0c\u800c\u662f\u901a\u8fc7\u4e24\u4e2a\u7cbe\u5999\u7684\u8bbe\u8ba1\uff0c\u5c06\u4e8c\u8005\u52a8\u6001\u7ed3\u5408\uff1a</p> <ul> <li>\u591a\u5c3a\u5ea6\u89e6\u53d1\u673a\u5236\uff08Multi-level Trigger Mechanism\uff09\uff1a</li> <li>\u5bf9\u4e8e 2KB/4KB \u5c0f\u533a\u57df\uff0c\u91c7\u7528 coverage-first \u7b56\u7565\u3002\u89e6\u53d1\u6761\u4ef6\u5bbd\u677e\uff08\u5982 Bingo \u7684 <code>(PC, address)</code> \u6216 <code>(PC, 3 offsets)</code>\uff09\uff0c\u786e\u4fdd\u80fd\u6355\u6349\u5230\u5c3d\u53ef\u80fd\u591a\u7684\u8bbf\u95ee\u673a\u4f1a\uff0c\u5373\u4f7f\u5076\u5c14\u51fa\u9519\uff0c\u4ee3\u4ef7\u4e5f\u5f88\u5c0f\u3002</li> <li>\u5bf9\u4e8e 16KB \u5927\u533a\u57df\uff0c\u91c7\u7528 accuracy-first \u7b56\u7565\u3002\u89e6\u53d1\u6761\u4ef6\u6781\u5176\u4e25\u683c\uff0c\u5fc5\u987b\u89c2\u5bdf\u5230 (PC, 5 offsets) \u8fd9\u6837\u591a\u7684\u8bbf\u95ee\u8db3\u8ff9\u540e\uff0c\u624d\u8ba4\u4e3a\u6a21\u5f0f\u8db3\u591f\u53ef\u9760\uff0c\u53ef\u4ee5\u53d1\u8d77\u5927\u89c4\u6a21\u9884\u53d6\u3002\u8fd9\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u5927\u533a\u57df\u9884\u53d6\u51c6\u786e\u7387\u4f4e\u7684\u96be\u9898\u3002</li> <li> <p>\u5f53\u591a\u4e2a\u533a\u57df\u540c\u65f6\u88ab\u89e6\u53d1\u65f6\uff0c\u901a\u8fc7\u4e00\u4e2a \u56fa\u5b9a\u4f18\u5148\u7ea7\u4ef2\u88c1\uff082KB-(PC,address) &gt; 16KB &gt; 4KB &gt; 2KB-(PC,offset)\uff09\u6765\u51b3\u5b9a\u6267\u884c\u54ea\u4e2a\uff0c\u907f\u514d\u4e86\u91cd\u590d\u548c\u51b2\u7a81\u3002</p> </li> <li> <p>\u5206\u5c42\u5143\u6570\u636e\u5b58\u50a8\uff08Hierarchical Metadata Storage\uff09\uff1a</p> </li> <li>\u4f5c\u8005\u5e76\u6ca1\u6709\u628a\u6240\u6709\u5143\u6570\u636e\u90fd\u585e\u8fdb\u6602\u8d35\u7684 on-chip \u5b58\u50a8\uff0c\u800c\u662f\u5de7\u5999\u5730\u5229\u7528\u4e8616KB\u6a21\u5f0f\u672c\u8eab\u7684\u7279\u6027\uff1a\u5b83\u4eec \u8bbf\u95ee\u9891\u7387\u4f4e\u3001\u5355\u6b21\u6536\u76ca\u9ad8\u3001\u5bf9\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6\u9ad8\u3002</li> <li>\u56e0\u6b64\uff0c\u53ea\u5728\u7247\u4e0a\u4fdd\u7559\u4e00\u4e2a\u5f88\u5c0f\u7684 16KB PHT Cache\uff08256\u9879\uff09\uff0c\u7528\u4e8e\u5b58\u653e\u9ad8\u9891\u6a21\u5f0f\u3002</li> <li>\u7edd\u5927\u90e8\u5206\u4f4e\u9891\u768416KB\u6a21\u5f0f\u88ab\u5378\u8f7d\uff08offload\uff09\u5230 main memory \u4e2d\u3002\u901a\u8fc7\u4e00\u4e2a Valid Map \u548c prefetch count threshold\uff08\u9608\u503c\u4e3a30\uff09\u673a\u5236\uff0c\u786e\u4fdd\u53ea\u6709\u90a3\u4e9b\u503c\u5f97\u7684\uff08\u80fd\u9884\u53d6\u8d85\u8fc730\u884c\u6570\u636e\u7684\uff09\u6a21\u5f0f\u624d\u4f1a\u88ab\u5199\u5165\u6216\u8bfb\u53d6\u4e3b\u5b58\uff0c\u6781\u5927\u5730\u51cf\u5c11\u4e86\u4e0d\u5fc5\u8981\u7684 off-chip \u8bbf\u95ee\u5f00\u9500\u3002</li> <li></li> </ul> <p></p> <p>Figure 4: Achieving high accuracy in large spatial regions and high coverage in small spatial regions by using different numbers of trigger offsets Figure 5: Placing 16 KB PHT off-chip keeps most prefetch opportunities, even with additional memory access latency</p> <pre><code>\u8fd9\u5f20\u56fe\u6e05\u6670\u5730\u8868\u660e\uff0c\u5373\u4f7f\u52a0\u4e0a50ns\u7684\u989d\u5916\u5ef6\u8fdf\uff0c\u5c0616KB PHT\u653e\u5728\u7247\u5916\u4e5f\u53ea\u4f1a\u635f\u5931\u4e0d\u523015%\u7684\u9884\u53d6\u673a\u4f1a\uff0c\u8bc1\u660e\u4e86\u8be5\u8bbe\u8ba1\u7684\u53ef\u884c\u6027\u3002\n</code></pre> <p>\u6700\u7ec8\uff0cRICH \u901a\u8fc7\u8fd9\u79cd\u201c\u5c0f\u533a\u57df\u5e7f\u6492\u7f51\uff0c\u5927\u533a\u57df\u7cbe\u8015\u7ec6\u4f5c\uff0c\u5e76\u7528\u5206\u5c42\u5b58\u50a8\u964d\u4f4e\u6210\u672c\u201d\u7684\u7b56\u7565\uff0c\u5728\u51e0\u4e4e\u4e0d\u589e\u52a0\u7247\u4e0a\u9762\u79ef\uff08on-chip area\uff09\u7684\u524d\u63d0\u4e0b\uff0c\u663e\u8457\u63d0\u5347\u4e86 coverage \u548c timeliness\uff0c\u4ece\u800c\u5728\u9ad8\u5ef6\u8fdf\u5185\u5b58\u7cfb\u7edf\u4e2d\u83b7\u5f97\u4e86\u8fdc\u8d85\u73b0\u6709\u6280\u672f\u7684\u6027\u80fd\u4f18\u52bf\u3002</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/ELI5_notes/#1-eli5","title":"1. \u591a\u5c3a\u5ea6\u7a7a\u95f4\u9884\u53d6\u4e0e\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <ul> <li>\u4f20\u7edf\u7684\u7a7a\u95f4\u9884\u53d6\u5668\uff08\u6bd4\u5982 Bingo\u3001SMS\uff09\u901a\u5e38\u53ea\u76ef\u7740 4KB \u8fd9\u4e00\u4e2a\u56fa\u5b9a\u533a\u57df\u5927\u5c0f\u5e72\u6d3b\uff0c\u8fd9\u5728\u73b0\u5b9e\u4e2d\u975e\u5e38\u201c\u96be\u53d7\u201d\u3002</li> <li>\u987e\u6b64\u5931\u5f7c\uff1a\u5bf9\u4e8e\u8bbf\u95ee\u6a21\u5f0f\u8de8\u8d8a\u591a\u4e2a\u9875\u9762\u7684\u5927\u578b\u6570\u636e\u7ed3\u6784\uff08\u6bd4\u5982\u79d1\u5b66\u8ba1\u7b97\u4e2d\u7684\u5927\u6570\u7ec4\uff09\uff0c4KB \u7684\u89c6\u91ce\u592a\u7a84\uff0c\u5bfc\u81f4 \u8986\u76d6\u7387 \u4e0d\u8db3\uff0c\u5f88\u591a\u672c\u8be5\u9884\u53d6\u7684\u6570\u636e\u6ca1\u6293\u5230\u3002</li> <li>\u6d6a\u8d39\u5e26\u5bbd\uff1a\u53cd\u8fc7\u6765\uff0c\u5982\u679c\u5f3a\u884c\u7528\u4e00\u4e2a\u5f88\u5927\u7684\u533a\u57df\uff08\u6bd4\u5982 16KB\uff09\u53bb\u9884\u53d6\u6240\u6709\u4e1c\u897f\uff0c\u4e00\u65e6\u9884\u6d4b\u9519\u4e86\uff0c\u5c31\u4f1a\u62c9\u56de\u4e00\u5927\u5806 \u65e0\u7528\u6570\u636e\uff0c\u4e25\u91cd \u6c61\u67d3\u7f13\u5b58 \u5e76 \u6d6a\u8d39\u5b9d\u8d35\u7684\u5185\u5b58\u5e26\u5bbd\u3002</li> <li>\u89e6\u53d1\u673a\u5236\u592a\u7c97\u7cd9\uff1a\u8001\u65b9\u6cd5\u901a\u5e38\u53ea\u770b\u7b2c\u4e00\u6b21\u8bbf\u95ee\u7684\u504f\u79fb\u91cf <code>(PC, offset)</code> \u6216\u5b8c\u6574\u5730\u5740 <code>(PC, address)</code> \u5c31\u51b3\u5b9a\u9884\u53d6\u6574\u4e2a\u533a\u57df\u3002\u4f46\u73b0\u5b9e\u7a0b\u5e8f\u91cc\uff0c\u5f88\u591a\u4e0d\u540c\u7684\u8bbf\u95ee\u6d41\u53ef\u80fd\u4ece\u540c\u4e00\u4e2a\u8d77\u70b9\u51fa\u53d1\uff0c\u5f88\u5feb\u5c31\u5206\u9053\u626c\u9573\u4e86\uff08\u89c1\u56fe2\uff09\u3002\u8fd9\u79cd\u201c\u540c\u6e90\u5f02\u6d41\u201d\u7684\u60c5\u51b5\u4f1a\u8ba9\u5927\u533a\u57df\u9884\u53d6\u7684 \u51c6\u786e\u6027 \u66b4\u8dcc\u3002</li> </ul> <p></p> <p>Figure 2: The multi-offset trigger mechanism can distinguish \"common-origin, later-divergent\" access streams</p> <p>\u901a\u4fd7\u6bd4\u65b9</p> <ul> <li>\u60f3\u8c61\u4f60\u662f\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff0c\u8d1f\u8d23\u7ed9\u8bfb\u8005\u63d0\u524d\u628a\u4e66\u4ece\u4ed3\u5e93\uff08\u4e3b\u5b58\uff09\u642c\u5230\u9605\u89c8\u5ba4\uff08\u7f13\u5b58\uff09\u3002</li> <li>\u8001\u6d3e\u7ba1\u7406\u5458\uff1a\u4ed6\u53ea\u4f1a\u6309\u201c\u6807\u51c6\u4e66\u67b6\u201d\uff084KB\u9875\uff09\u6765\u642c\u4e66\u3002\u5982\u679c\u8bfb\u8005\u8981\u770b\u4e00\u672c\u8d85\u5927\u753b\u518c\uff0816KB\u6570\u636e\uff09\uff0c\u4ed6\u5f97\u8dd1\u56db\u6b21\u624d\u80fd\u642c\u5b8c\uff0c\u7b49\u4e66\u90fd\u9f50\u4e86\uff0c\u8bfb\u8005\u65e9\u5c31\u7b49\u70e6\u4e86\uff08timeliness \u5dee\uff09\u3002</li> <li>\u83bd\u649e\u7684\u7ba1\u7406\u5458\uff1a\u4ed6\u542c\u8bf4\u6709\u5927\u753b\u518c\uff0c\u5c31\u4e0d\u7ba1\u4e09\u4e03\u4e8c\u5341\u4e00\uff0c\u53ea\u8981\u770b\u5230\u6709\u4eba\u8fdb\u7f8e\u672f\u533a\uff08\u7b2c\u4e00\u6b21\u8bbf\u95ee\uff09\uff0c\u5c31\u628a\u6574\u4e2a\u7f8e\u672f\u533a\u7684\u4e66\uff0816KB\uff09\u5168\u642c\u8fc7\u6765\u3002\u7ed3\u679c\u53d1\u73b0\u8bfb\u8005\u53ea\u662f\u6765\u67e5\u4e2a\u76ee\u5f55\uff0c\u767d\u5fd9\u6d3b\u4e00\u573a\uff0c\u8fd8\u628a\u9605\u89c8\u5ba4\u5806\u6ee1\u4e86\u6ca1\u7528\u7684\u4e66\uff08accuracy \u4f4e\uff0ccache pollution\uff09\u3002</li> <li>RICH\u7ba1\u7406\u5458\uff1a\u4ed6\u806a\u660e\u591a\u4e86\u3002\u4ed6\u624b\u91cc\u6709\u4e09\u79cd\u5c3a\u5bf8\u7684\u63a8\u8f66\uff1a\u5c0f\uff082KB\uff09\u3001\u4e2d\uff084KB\uff09\u3001\u5927\uff0816KB\uff09\u3002</li> <li>\u5bf9\u4e8e\u4e0d\u786e\u5b9a\u7684\u5c0f\u9700\u6c42\uff0c\u4ed6\u5148\u7528\u5c0f\u63a8\u8f66\u5feb\u901f\u54cd\u5e94\uff0c\u4fdd\u8bc1\u4e0d\u6f0f\u6389\u4efb\u4f55\u8bfb\u8005\uff08coverage-first for small regions\uff09\u3002</li> <li>\u5bf9\u4e8e\u53ef\u80fd\u7684\u5927\u9700\u6c42\uff0c\u4ed6\u4e0d\u4f1a\u7acb\u523b\u884c\u52a8\u3002\u4ed6\u4f1a\u5148\u89c2\u5bdf\uff0c\u770b\u5230\u540c\u4e00\u4e2a\u8bfb\u8005\u8fde\u7eed\u62ff\u4e865\u672c\u76f8\u5173\u7684\u4e66\uff085 offsets\uff09\uff0c\u624d\u786e\u4fe1\u4ed6\u771f\u7684\u8981\u7814\u7a76\u8fd9\u4e2a\u4e13\u9898\uff0c\u7136\u540e\u624d\u63a8\u51fa\u5927\u63a8\u8f66\u4e00\u6b21\u6027\u628a\u5168\u5957\u8d44\u6599\u642c\u6765\uff08accuracy-first for large regions\uff09\u3002</li> <li>\u8fd9\u6837\uff0c\u4ed6\u65e2\u6ee1\u8db3\u4e86\u666e\u901a\u8bfb\u8005\u7684\u5373\u65f6\u9700\u6c42\uff0c\u53c8\u9ad8\u6548\u5730\u670d\u52a1\u4e86\u6df1\u5ea6\u7814\u7a76\u8005\uff0c\u8fd8\u907f\u514d\u4e86\u65e0\u8c13\u7684\u4f53\u529b\u6d6a\u8d39\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db</p> <ul> <li>\u4f5c\u8005\u6ca1\u6709\u6cbf\u7528\u201c\u4e00\u5200\u5207\u201d\u7684\u533a\u57df\u5927\u5c0f\u548c\u89e6\u53d1\u903b\u8f91\uff0c\u800c\u662f\u505a\u4e86\u4e00\u4e2a\u7cbe\u5999\u7684 \u5206\u800c\u6cbb\u4e4b + \u52a8\u6001\u4ef2\u88c1 \u7684\u8bbe\u8ba1\u3002</li> <li>\u66ff\u6362\u89e6\u53d1\u6761\u4ef6\uff1a\u5bf9\u4e8e 16KB \u8fd9\u6837\u7684\u5927\u533a\u57df\uff0c\u4f5c\u8005\u5f7b\u5e95\u629b\u5f03\u4e86\u5355\u70b9\u89e6\u53d1\u7684\u65e7\u601d\u8def\uff0c\u5c06\u5176\u66ff\u6362\u4e3a \u591a\u504f\u79fb\u89e6\u53d1 (multi-offset trigger) \u673a\u5236\u3002\u5fc5\u987b\u89c2\u5bdf\u5230 <code>(PC, 5 offsets)</code> \u8fd9\u6837\u66f4\u4e30\u5bcc\u7684\u4e0a\u4e0b\u6587\uff0c\u624d\u8ba4\u4e3a\u6a21\u5f0f\u8db3\u591f\u7a33\u5b9a\uff0c\u503c\u5f97\u5192\u9669\u8fdb\u884c\u5927\u8303\u56f4\u9884\u53d6\u3002\u8fd9\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u201c\u540c\u6e90\u5f02\u6d41\u201d\u5bfc\u81f4\u7684\u8bef\u5224\u95ee\u9898\u3002</li> <li>\u626d\u8f6c\u533a\u57df\u7b56\u7565\uff1a\u4f5c\u8005\u5c06\u4e0d\u540c\u5c3a\u5bf8\u7684\u533a\u57df\u8d4b\u4e88\u4e86\u622a\u7136\u4e0d\u540c\u7684\u4f7f\u547d\uff1a</li> <li>2KB/4KB \u533a\u57df\uff1a\u91c7\u7528\u8f7b\u91cf\u7ea7\u89e6\u53d1\uff08\u5982 <code>(PC, address)</code> \u6216 <code>(PC, 3 offsets)</code>\uff09\uff0c\u76ee\u6807\u662f \u6700\u5927\u5316\u8986\u76d6\u7387\uff0c\u786e\u4fdd\u4e0d\u653e\u8fc7\u4efb\u4f55\u6f5c\u5728\u7684\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li>16KB \u533a\u57df\uff1a\u91c7\u7528\u91cd\u91cf\u7ea7\u89e6\u53d1 <code>(PC, 5 offsets)</code>\uff0c\u76ee\u6807\u662f \u6700\u5927\u5316\u51c6\u786e\u6027\uff0c\u53ea\u5728\u9ad8\u5ea6\u786e\u4fe1\u65f6\u624d\u542f\u52a8\uff0c\u4ee5\u5145\u5206\u5229\u7528\u9ad8\u5e26\u5bbd\u4f18\u52bf\u3002</li> <li>\u5f15\u5165\u4ef2\u88c1\u673a\u5236\uff1a\u5f53\u591a\u4e2a\u533a\u57df\u540c\u65f6\u88ab\u89e6\u53d1\u65f6\uff0c\u7cfb\u7edf\u4f1a\u6839\u636e\u9884\u8bbe\u7684 \u4f18\u5148\u7ea7\uff082KB-(PC,address) &gt; 16KB &gt; 4KB &gt; 2KB-(PC,offset)\uff09\u548c \u53bb\u91cd\u903b\u8f91\uff08\u5927\u533a\u57df\u9884\u53d6\u4f1a\u963b\u6b62\u5176\u8986\u76d6\u8303\u56f4\u5185\u7684\u5c0f\u533a\u57df\u9884\u53d6\uff09\u6765\u9009\u62e9\u6700\u4f18\u65b9\u6848\uff0c\u907f\u514d\u4e86\u8d44\u6e90\u5185\u8017\u3002</li> </ul> <p></p> <p>Figure 3: By using more access offsets in a trigger, we can trade off between the accuracy and coverage of prefetching. Specifically, a), b),and c) correspond to 16 KB-region, 4 KBregion, and 2 KB-region.</p> <p>\u8fd9\u79cd\u8bbe\u8ba1\u7684\u6838\u5fc3\u5728\u4e8e\uff0c\u5b83\u4e0d\u518d\u8bd5\u56fe\u7528\u4e00\u4e2a\u50f5\u5316\u7684\u6a21\u578b\u53bb\u62df\u5408\u6240\u6709\u7a0b\u5e8f\uff0c\u800c\u662f\u901a\u8fc7 \u591a\u5c3a\u5ea6\u611f\u77e5 \u548c \u81ea\u9002\u5e94\u89e6\u53d1\uff0c\u8ba9\u9884\u53d6\u5668\u80fd\u50cf\u4e00\u4e2a\u7ecf\u9a8c\u4e30\u5bcc\u7684\u4e13\u5bb6\u4e00\u6837\uff0c\u5728 \u8986\u76d6\u7387 \u548c \u51c6\u786e\u6027 \u8fd9\u5bf9\u5929\u7136\u77db\u76fe\u7684\u76ee\u6807\u4e4b\u95f4\uff0c\u6839\u636e\u4e0d\u540c\u573a\u666f\u52a8\u6001\u5730\u627e\u5230\u6700\u4f73\u5e73\u8861\u70b9\u3002\u6700\u7ec8\u7ed3\u679c\u5c31\u662f\uff0c\u5728\u5e38\u89c4\u7cfb\u7edf\u4e2d\u6027\u80fd\u63d0\u5347 3.4%\uff0c\u800c\u5728\u9ad8\u5ef6\u8fdf\u5185\u5b58\u7cfb\u7edf\u4e2d\uff0c\u4f18\u52bf\u66f4\u662f\u6269\u5927\u5230 8.3%\u3002</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/ELI5_notes/#2-eli5","title":"2. \u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u533a\u57df\u4ef2\u88c1\u7b56\u7565 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684\u7a7a\u95f4\u9884\u53d6\u5668\uff08\u5982 Bingo\uff09\u901a\u5e38\u53ea\u5728\u4e00\u4e2a\u56fa\u5b9a\u7684 4KB \u533a\u57df\u5185\u5de5\u4f5c\u3002\u8fd9\u5c31\u50cf\u4f60\u53ea\u80fd\u7528\u4e00\u79cd\u5c3a\u5bf8\u7684\u6e14\u7f51\u6355\u9c7c\u2014\u2014\u9047\u5230\u5c0f\u9c7c\u7fa4\u6d6a\u8d39\u7f51\u773c\uff0c\u9047\u5230\u5927\u9c7c\u7fa4\u53c8\u6355\u4e0d\u5168\u3002</li> <li>RICH \u7684\u6838\u5fc3\u601d\u60f3\u662f\u540c\u65f6\u4f7f\u7528 2KB\u30014KB\u300116KB \u4e09\u79cd\u201c\u6e14\u7f51\u201d\u6765\u9002\u5e94\u4e0d\u540c\u7a0b\u5e8f\u7684\u8bbf\u5b58\u6a21\u5f0f\u3002\u4f46\u8fd9\u5c31\u5f15\u51fa\u4e86\u4e00\u4e2a\u65b0\u9ebb\u70e6\uff1a\u5f53\u540c\u4e00\u4e2a\u5185\u5b58\u533a\u57df\u540c\u65f6\u88ab\u591a\u4e2a\u201c\u6e14\u7f51\u201d\u76ef\u4e0a\u65f6\uff08\u6bd4\u5982\u4e00\u4e2a 16KB \u5927\u7f51\u548c\u5b83\u5185\u90e8\u7684\u51e0\u4e2a 2KB \u5c0f\u7f51\u90fd\u89e6\u53d1\u4e86\uff09\uff0c\u5982\u679c\u5168\u90fd\u53bb\u6293\uff0c\u5c31\u4f1a\u9020\u6210\u4e25\u91cd\u7684 \u5197\u4f59\u9884\u53d6\u3002</li> <li>\u5197\u4f59\u9884\u53d6\u7684\u5371\u5bb3\u6781\u5927\uff1a</li> <li>\u6d6a\u8d39\u5b9d\u8d35\u7684 off-chip \u5e26\u5bbd\uff0c\u628a\u901a\u9053\u585e\u6ee1\u65e0\u7528\u6570\u636e\u3002</li> <li>\u6c61\u67d3 cache\uff0c\u628a\u771f\u6b63\u6709\u7528\u7684\u6570\u636e\u6324\u51fa\u53bb\u3002</li> <li>\u6700\u7ec8\u5bfc\u81f4 \u6027\u80fd\u4e0d\u5347\u53cd\u964d\uff0c\u597d\u5fc3\u529e\u574f\u4e8b\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4e00\u4e2a\u9ad8\u6548\u7684\u7269\u6d41\u8c03\u5ea6\u4e2d\u5fc3\u3002\u4ed3\u5e93\u91cc\u6709\u4e0d\u540c\u89c4\u683c\u7684\u6253\u5305\u533a\uff1a\u5c0f\u4ef6\u533a (2KB)\u3001\u6807\u51c6\u533a (4KB) \u548c \u5927\u5b97\u8d27\u7269\u533a (16KB)\u3002</li> <li>\u5f53\u4e00\u6279\u8d27\u7269\uff08\u5185\u5b58\u8bbf\u95ee\uff09\u5230\u6765\u65f6\uff0c\u7cfb\u7edf\u4f1a\u5224\u65ad\u8fd9\u6279\u8d27\u6700\u9002\u5408\u5728\u54ea\u4e2a\u533a\u6253\u5305\u3002\u4f46\u5982\u679c\u5224\u65ad\u903b\u8f91\u6df7\u4e71\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u540c\u4e00\u6279\u8d27\u65e2\u5728\u5c0f\u4ef6\u533a\u88ab\u6253\u5305\u6210\u51e0\u5341\u4e2a\u5c0f\u5305\u88f9\uff0c\u53c8\u5728\u5927\u5b97\u533a\u88ab\u6253\u5305\u6210\u4e00\u4e2a\u5927\u96c6\u88c5\u7bb1\u3002</li> <li>\u8fd9\u663e\u7136\u6781\u5176\u4f4e\u6548\u3002\u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u533a\u57df\u4ef2\u88c1\u7b56\u7565\u5c31\u50cf\u662f\u4e00\u4e2a\u806a\u660e\u7684\u8c03\u5ea6\u5458\uff0c\u4ed6\u7684\u89c4\u5219\u662f\uff1a</li> <li>\u5982\u679c\u8fd9\u6279\u8d27\u80fd\u88ab\u8bc6\u522b\u4e3a\u4e00\u4e2a\u9ad8\u4ef7\u503c\u3001\u9ad8\u786e\u5b9a\u6027\u7684\u5b8c\u6574\u8ba2\u5355\uff08\u5bf9\u5e94 2KB-(PC, address) \u89e6\u53d1\uff0c\u56e0\u4e3a\u5b83\u6355\u6349\u4e86\u7cbe\u786e\u7684\u65f6\u7a7a\u5c40\u90e8\u6027\uff09\uff0c\u5c31\u4f18\u5148\u7528\u5c0f\u4ef6\u533a\u5feb\u901f\u5904\u7406\u3002</li> <li>\u5426\u5219\uff0c\u5c31\u770b\u5b83\u662f\u5426\u7b26\u5408\u5927\u5b97\u8d27\u7269\u7684\u7279\u5f81\uff08\u5bf9\u5e94 16KB \u533a\u57df\uff0c\u7531\u591a\u504f\u79fb\u9a8c\u8bc1\u4fdd\u8bc1\u4e86\u9ad8 accuracy\uff09\u3002\u5982\u679c\u662f\uff0c\u5c31\u76f4\u63a5\u7528\u4e00\u4e2a\u5927\u96c6\u88c5\u7bb1\u641e\u5b9a\uff0c\u7701\u65f6\u7701\u529b\u3002</li> <li>\u53ea\u6709\u5728\u4ee5\u4e0a\u90fd\u4e0d\u6ee1\u8db3\u65f6\uff0c\u624d\u9000\u800c\u6c42\u5176\u6b21\u7528\u6807\u51c6\u533a\u6216\u6700\u666e\u901a\u7684\u6253\u5305\u65b9\u5f0f\u3002</li> <li>\u8fd9\u4e2a\u8c03\u5ea6\u5458\u8fd8\u6709\u4e00\u4e2a\u94c1\u5f8b\uff1a\u4e00\u65e6\u51b3\u5b9a\u7528\u5927\u96c6\u88c5\u7bb1\u53d1\u8d27\uff0c\u5c31\u7acb\u523b\u5c01\u9501\u91cc\u9762\u6240\u6709\u7684\u5c0f\u4ef6\u6253\u5305\u4f4d\uff0c\u9632\u6b62\u91cd\u590d\u52b3\u52a8\u3002\u8fd9\u5c31\u662f\u6587\u4e2d\u7684 \u53bb\u91cd\u673a\u5236 (de-duplication mechanism)\u3002</li> </ul> <p></p> <p>Figure 8: The Region Arbitration unit selects the appropriate region to prefetch (Step P3)</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u6ca1\u6709\u7b80\u5355\u5730\u8ba9\u6240\u6709\u533a\u57df\u201c\u81ea\u7531\u7ade\u4e89\u201d\uff0c\u800c\u662f\u8bbe\u8ba1\u4e86\u4e00\u4e2a \u56fa\u5b9a\u4f18\u5148\u7ea7 + \u8986\u76d6\u68c0\u67e5 \u7684\u4e24\u5c42\u4ef2\u88c1\u903b\u8f91\u3002</li> <li>\u7b2c\u4e00\u5c42\uff1a\u57fa\u4e8e\u51c6\u786e\u7387\u548c\u6210\u672c\u7684\u9759\u6001\u4f18\u5148\u7ea7\u6392\u5e8f\u3002\u8fd9\u4e2a\u6392\u5e8f\u4e0d\u662f\u62cd\u8111\u888b\u5b9a\u7684\uff0c\u800c\u662f\u57fa\u4e8e\u5bf9\u4e0d\u540c\u533a\u57df\u7279\u6027\u7684\u6df1\u523b\u6d1e\u5bdf\uff1a</li> <li>2KB-(PC, address): \u867d\u7136\u533a\u57df\u5c0f\uff0c\u4f46\u89e6\u53d1\u6761\u4ef6\u82db\u523b\uff08\u9700\u8981\u7cbe\u786e\u5730\u5740\uff09\uff0caccuracy \u6781\u9ad8\uff0c\u4e14\u8bef\u5224\u6210\u672c\uff08\u53ea\u53d62KB\uff09\u5f88\u4f4e\uff0c\u6240\u4ee5\u7ed9\u6700\u9ad8\u4f18\u5148\u7ea7\u3002</li> <li>16KB: \u533a\u57df\u5927\uff0c\u4e00\u6b21\u9884\u53d6\u6536\u76ca\u9ad8\uff08timeliness \u597d\uff09\uff0c\u4f46\u901a\u8fc7 multi-offset trigger \u673a\u5236\u4fdd\u8bc1\u4e86\u5176 accuracy \u4e5f\u8d85\u8fc790%\uff0c\u56e0\u6b64\u6392\u7b2c\u4e8c\u3002</li> <li>4KB: \u4f5c\u4e3a\u6298\u4e2d\u65b9\u6848\uff0c\u6392\u7b2c\u4e09\u3002</li> <li>2KB-(PC, offset): \u89e6\u53d1\u6761\u4ef6\u6700\u5bbd\u677e\uff0ccoverage \u9ad8\u4f46 accuracy \u76f8\u5bf9\u6700\u4f4e\uff0c\u8bef\u5224\u6210\u672c\u867d\u5c0f\u4f46\u5bb9\u6613\u6cdb\u6ee5\uff0c\u6240\u4ee5\u4f18\u5148\u7ea7\u6700\u4f4e\u3002</li> <li>\u7b2c\u4e8c\u5c42\uff1a\u52a8\u6001\u8986\u76d6\u68c0\u67e5 (overlap check)\u3002\u5373\u4f7f\u4e00\u4e2a\u4f4e\u4f18\u5148\u7ea7\u7684\u8bf7\u6c42\u5148\u5230\uff0c\u5982\u679c\u6b64\u65f6\u4e00\u4e2a\u9ad8\u4f18\u5148\u7ea7\u7684\u8bf7\u6c42\u8986\u76d6\u4e86\u540c\u4e00\u7247\u533a\u57df\uff0c\u4f4e\u4f18\u5148\u7ea7\u7684\u8bf7\u6c42\u4e5f\u4f1a\u88ab block \u6389\u3002\u53cd\u4e4b\uff0c\u5982\u679c\u4e00\u4e2a 16KB \u8bf7\u6c42\u5df2\u7ecf\u53d1\u51fa\uff0c\u90a3\u4e48\u5728\u5176\u5b8c\u6210\u524d\uff0c\u8be5\u533a\u57df\u5185\u7684\u6240\u6709 4KB \u548c 2KB \u8bf7\u6c42\u90fd\u4f1a\u88ab\u7981\u6b62\u3002</li> <li>\u4f5c\u8005\u6700\u5173\u952e\u7684\u626d\u8f6c\u5728\u4e8e\uff1a\u5c06\u201c\u9009\u62e9\u54ea\u4e2a\u533a\u57df\u9884\u53d6\u201d\u8fd9\u4e2a\u95ee\u9898\uff0c\u4ece\u4e00\u4e2a\u590d\u6742\u7684\u5728\u7ebf\u4f18\u5316\u95ee\u9898\uff0c\u7b80\u5316\u4e3a\u4e00\u4e2a\u57fa\u4e8e\u79bb\u7ebf\u5206\u6790\u5f97\u51fa\u7684\u3001\u9ad8\u6548\u4e14\u53ef\u9884\u6d4b\u7684 \u9759\u6001\u4f18\u5148\u7ea7\u51b3\u7b56\uff0c\u5e76\u8f85\u4ee5\u7b80\u5355\u7684\u786c\u4ef6\u8868\uff08Inflight Prefetch Table\uff09\u6765\u6267\u884c\u53bb\u91cd\u3002\u8fd9\u65e2\u4fdd\u8bc1\u4e86\u6027\u80fd\uff0c\u53c8\u63a7\u5236\u4e86\u786c\u4ef6\u5f00\u9500\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/ELI5_notes/#3-eli5","title":"3. \u5206\u5c42\u5143\u6570\u636e\u5b58\u50a8\u67b6\u6784 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <p>\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 Bingo\u3001SMS\uff09\u4e3a\u4e86\u63a7\u5236 on-chip area overhead\uff0c\u628a\u6240\u6709\u5143\u6570\u636e\u90fd\u585e\u5728\u7247\u4e0a\uff0c\u8fd9\u5bfc\u81f4\u4e86\u4e00\u4e2a\u6839\u672c\u6027\u7684\u77db\u76fe\uff1a\u5b83\u4eec\u53ea\u80fd\u5904\u7406 4KB \u4ee5\u5185\u7684\u5c0f\u533a\u57df\u7a7a\u95f4\u5c40\u90e8\u6027\u3002\u4f46\u73b0\u5b9e workload \u4e2d\uff0c\u5f88\u591a\u7a0b\u5e8f\uff08\u6bd4\u5982\u79d1\u5b66\u8ba1\u7b97\u3001\u56fe\u5904\u7406\uff09\u7684\u8bbf\u95ee\u6a21\u5f0f\u8de8\u8d8a\u591a\u4e2a\u9875\u9762\uff0c\u5448\u73b0\u51fa 16KB \u751a\u81f3\u66f4\u5927\u7684\u7a7a\u95f4\u5c40\u90e8\u6027\u3002\u5982\u679c\u5f3a\u884c\u7528\u5c0f\u533a\u57df\u53bb\u8986\u76d6\uff0c\u5c31\u4f1a\u51fa\u73b0\u201c\u53ea\u89c1\u6811\u6728\uff0c\u4e0d\u89c1\u68ee\u6797\u201d\u7684\u95ee\u9898\u2014\u2014coverage\uff08\u8986\u76d6\u7387\uff09\u6781\u4f4e\u3002\u53ef\u5982\u679c\u76f4\u63a5\u628a\u5927\u533a\u57df\u7684\u5143\u6570\u636e\uff08\u6bd4\u5982 16KB \u7684 bit-vector pattern\uff09\u5168\u653e\u7247\u4e0a\uff0c\u90a3\u52a8\u8f84\u4e0a\u767e KB \u7684\u5b58\u50a8\u5f00\u9500\u662f\u5904\u7406\u5668\u8bbe\u8ba1\u65e0\u6cd5\u627f\u53d7\u7684\u5962\u4f88\u3002\u66f4\u9ebb\u70e6\u7684\u662f\uff0c\u5982\u679c\u7b80\u5355\u5730\u628a\u6240\u6709\u5143\u6570\u636e\u90fd\u6254\u5230 off-chip memory\uff0c\u6bcf\u6b21\u9884\u6d4b\u90fd\u8981\u53bb\u4e3b\u5b58\u8bfb\u4e00\u6b21\uff0c\u90a3 metadata access latency \u672c\u8eab\u5c31\u53ef\u80fd\u5403\u6389\u9884\u53d6\u5e26\u6765\u7684\u6240\u6709\u6536\u76ca\uff0c\u5f97\u4e0d\u507f\u5931\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9</p> <p>\u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u5458\uff08Prefetcher\uff09\uff0c\u8d1f\u8d23\u7ed9\u8bfb\u8005\uff08CPU\uff09\u63d0\u524d\u51c6\u5907\u597d\u4ed6\u4eec\u53ef\u80fd\u8981\u770b\u7684\u4e66\uff08data\uff09\u3002</p> <ul> <li>\u4ee5\u524d\u7684\u7ba1\u7406\u5458\uff08\u4f20\u7edf\u9884\u53d6\u5668\uff09\u53ea\u6709\u4e00\u4e2a\u5f88\u5c0f\u7684\u529e\u516c\u684c\uff08on-chip storage\uff09\u3002\u4ed6\u53ea\u80fd\u628a\u6700\u70ed\u95e8\u7684\u51e0\u672c\u7545\u9500\u4e66\uff08small-region patterns\uff09\u7684\u76ee\u5f55\u6458\u8981\u653e\u5728\u684c\u4e0a\uff0c\u65b9\u4fbf\u5feb\u901f\u67e5\u627e\u3002\u4f46\u4ed6\u5b8c\u5168\u6ca1\u6cd5\u5904\u7406\u90a3\u4e9b\u9700\u8981\u6574\u5957\u4e1b\u4e66\uff08large-region patterns\uff09\u7684\u8bfb\u8005\u8bf7\u6c42\uff0c\u56e0\u4e3a\u4e1b\u4e66\u76ee\u5f55\u592a\u539a\uff0c\u684c\u5b50\u653e\u4e0d\u4e0b\u3002</li> <li>RICH \u7684\u7ba1\u7406\u5458\u5219\u806a\u660e\u5f97\u591a\u3002\u4ed6\u4f9d\u7136\u4fdd\u7559\u4e00\u5f20\u5c0f\u529e\u516c\u684c\uff0c\u4e0a\u9762\u53ea\u653e\u4e24\u7c7b\u4e1c\u897f\uff1a\u4e00\u662f\u6700\u7545\u9500\u7684\u5355\u672c\u4e66\u76ee\u5f55\uff082KB/4KB patterns\uff09\uff0c\u4e8c\u662f\u4e00\u4e2a \u201c\u9ad8\u9891\u4e1b\u4e66\u7d22\u5f15\u7f13\u5b58\u201d\uff08on-chip PHT cache for 16KB\uff09\u3002\u5bf9\u4e8e\u7edd\u5927\u591a\u6570\u51b7\u95e8\u7684\u4e1b\u4e66\u76ee\u5f55\uff0c\u4ed6\u5e76\u4e0d\u653e\u5728\u684c\u4e0a\uff0c\u800c\u662f\u5b58\u5728\u56fe\u4e66\u9986\u540e\u9762\u7684\u5927\u578b\u4ed3\u5e93\u91cc\uff08off-chip main memory\uff09\u3002\u5f53\u4ed6\u63a5\u5230\u4e00\u4e2a\u53ef\u80fd\u9700\u8981\u4e1b\u4e66\u7684\u8bf7\u6c42\u65f6\uff0c\u5148\u770b\u4e00\u773c\u81ea\u5df1\u7684\u5c0f\u7d22\u5f15\u7f13\u5b58\u3002\u5982\u679c\u6709\uff0c\u7acb\u523b\u884c\u52a8\uff1b\u5982\u679c\u6ca1\u6709\uff0c\u4ed6\u624d\u53bb\u4ed3\u5e93\u8c03\u53d6\u3002\u5173\u952e\u662f\uff0c\u4ed6\u77e5\u9053\u8c03\u53d6\u4e00\u5957\u4e1b\u4e66\u672c\u8eab\u5c31\u80fd\u670d\u52a1\u8bfb\u8005\u5f88\u4e45\uff0c\u6240\u4ee5\u5373\u4f7f\u53bb\u4ed3\u5e93\u62ff\u76ee\u5f55\u82b1\u70b9\u65f6\u95f4\uff08latency\uff09\uff0c\u53ea\u8981\u8fd9\u5957\u4e66\u771f\u7684\u6709\u7528\uff0c\u603b\u4f53\u8fd8\u662f\u8d5a\u7684\u3002\u8fd9\u5c31\u662f\u5229\u7528\u4e86 \u5927\u533a\u57df\u9884\u53d6\u5929\u7136\u7684\u9ad8\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6\u3002</li> </ul> <p></p> <p>Figure 4: Achieving high accuracy in large spatial regions and high coverage in small spatial regions by using different numbers of trigger offsets Figure 5: Placing 16 KB PHT off-chip keeps most prefetch opportunities, even with additional memory access latency</p> <p>\u5173\u952e\u4e00\u62db</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u628a\u6240\u6709\u5143\u6570\u636e\u5e73\u7b49\u5bf9\u5f85\uff0c\u800c\u662f\u505a\u4e86\u4e00\u6b21\u7cbe\u5999\u7684 \u201c\u5206\u7c7b\u6258\u7ba1\u201d\uff1a</p> <ul> <li>\u5bf9\u5143\u6570\u636e\u8fdb\u884c\u4e09\u7ef4\u8bc4\u4f30\uff1a\u6839\u636e \u8bbf\u95ee\u9891\u7387 (access frequency)\u3001\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6 (latency tolerance) \u548c \u9762\u79ef\u5f00\u9500 (area overheads) \u8fd9\u4e09\u4e2a\u7ef4\u5ea6\uff0c\u5c06\u5143\u6570\u636e\u62c6\u89e3\u3002</li> <li>2KB/4KB \u533a\u57df\u7684\u6a21\u5f0f\uff1a<ul> <li>\u7279\u70b9\uff1a\u8bbf\u95ee\u975e\u5e38\u9891\u7e41\uff0c\u4e14\u9884\u53d6\u8ddd\u79bb\u77ed\uff0c\u5bf9\u5ef6\u8fdf\u6781\u5ea6\u654f\u611f\u3002</li> <li>\u5904\u7406\uff1a\u5168\u90e8\u653e\u5728 on-chip PHT \u4e2d\uff0c\u4fdd\u8bc1\u6700\u4f4e\u5ef6\u8fdf\u3002</li> </ul> </li> <li>16KB \u533a\u57df\u7684\u6a21\u5f0f\uff1a<ul> <li>\u7279\u70b9\uff1a\u5355\u4e2a\u6a21\u5f0f\u4f53\u79ef\u5927\uff08256-bit vector\uff09\uff0c\u603b\u9762\u79ef\u5f00\u9500\u5de8\u5927\uff1b\u4f46\u4e00\u65e6\u89e6\u53d1\uff0c\u80fd\u9884\u53d6\u5927\u91cf\u6570\u636e\uff0c\u56e0\u6b64\u5bf9 metadata \u7684\u8bbf\u95ee\u5ef6\u8fdf\u6709\u5f88\u9ad8\u7684\u5bb9\u5fcd\u5ea6\uff1b\u5e76\u4e14\u5176\u8bbf\u95ee\u5177\u6709 \u9ad8\u5ea6\u96c6\u4e2d\u6027\uff08\u5c11\u6570\u6a21\u5f0f\u8986\u76d6\u5927\u90e8\u5206\u8bf7\u6c42\uff09\u3002</li> <li>\u5904\u7406\uff1a\u91c7\u7528 tiered storage strategy\uff08\u5206\u5c42\u5b58\u50a8\u7b56\u7565\uff09\u3002</li> <li>\u5728\u7247\u4e0a\u4fdd\u7559\u4e00\u4e2a\u5f88\u5c0f\u7684 PHT Cache\uff08\u4ec5256 entries\uff09\uff0c\u4e13\u95e8\u7f13\u5b58 \u9ad8\u9891 \u7684 16KB \u6a21\u5f0f\u3002</li> <li>\u7edd\u5927\u90e8\u5206 \u4f4e\u9891 \u6a21\u5f0f\u88ab\u5378\u8f7d\u5230 off-chip main memory \u4e2d\u7684\u4e00\u4e2a\u4e13\u7528\u533a\u57df\uff08128KB\uff09\u3002</li> <li>\u5f15\u5165\u4e00\u4e2a Valid Map\uff08\u4f4d\u56fe\uff09\u6765\u5feb\u901f\u5224\u65ad\u67d0\u4e2a\u6a21\u5f0f\u662f\u5426\u5b58\u5728\u4e8e\u4e3b\u5b58\u4e2d\uff0c\u907f\u514d\u65e0\u6548\u7684 off-chip \u8bbf\u95ee\u3002</li> <li>\u66f4\u7edd\u7684\u662f\uff0c\u53ea\u6709\u5f53\u4e00\u4e2a 16KB \u6a21\u5f0f\u7684 prefetch count\uff08\u5373 bit-vector \u4e2d '1' \u7684\u6570\u91cf\uff09\u8d85\u8fc7\u9608\u503c\uff08\u598230\uff09\u65f6\uff0c\u624d\u503c\u5f97\u5c06\u5176\u5199\u5165\u4e3b\u5b58\u3002\u8fd9\u76f8\u5f53\u4e8e\u8bbe\u7f6e\u4e86\u4e00\u4e2a ROI\uff08\u6295\u8d44\u56de\u62a5\u7387\uff09\u95e8\u69db\uff0c\u786e\u4fdd off-chip \u64cd\u4f5c\u7684\u6027\u4ef7\u6bd4\u3002</li> </ul> </li> </ul> <p>\u8fd9\u79cd\u8bbe\u8ba1\u7684\u6838\u5fc3\u903b\u8f91\u8f6c\u6362\u5728\u4e8e\uff1a\u5c06\u201c\u5b58\u50a8\u4f4d\u7f6e\u201d\u7684\u51b3\u7b56\u4ece\u201c\u80fd\u4e0d\u80fd\u653e\u5f97\u4e0b\u201d\u8f6c\u53d8\u4e3a\u201c\u503c\u4e0d\u503c\u5f97\u4e3a\u5b83\u4ed8\u51fa\u5ef6\u8fdf\u4ee3\u4ef7\u201d\u3002\u901a\u8fc7\u627f\u8ba4\u5e76\u5229\u7528\u4e0d\u540c\u7c7b\u578b\u5143\u6570\u636e\u7684\u5185\u5728\u5c5e\u6027\u5dee\u5f02\uff0cRICH \u7528\u6781\u5c0f\u7684\u7247\u4e0a\u4ee3\u4ef7\uff08\u4ec5\u589e\u52a0\u4e00\u4e2a\u5c0f\u578b\u7f13\u5b58\u548c Valid Map\uff09\uff0c\u5c31\u64ac\u52a8\u4e86 off-chip \u5185\u5b58\u7684\u5de8\u5927\u5bb9\u91cf\uff0c\u4ece\u800c\u652f\u6301\u4e86\u6027\u80fd\u66f4\u5f3a\u7684\u5927\u533a\u57df\u9884\u53d6\uff0c\u5b8c\u7f8e\u89e3\u51b3\u4e86\u4f20\u7edf\u65b9\u6848\u7684\u4e24\u96be\u56f0\u5883\u3002</p> <p></p> <p>Table 2: Categorization of RICH's metadata</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/ELI5_notes/#4-eli5","title":"4. \u7247\u5916\u5143\u6570\u636e\u8bbf\u95ee\u8fc7\u6ee4\u673a\u5236 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <ul> <li>\u4f20\u7edf\u505a\u6cd5\u91cc\uff0c\u53ea\u8981\u6709\u4e2a\u65b0\u7684 16KB-region pattern\uff08\u4e00\u4e2a256-bit\u7684\u4f4d\u5411\u91cf\uff09\uff0c\u5c31\u4e00\u80a1\u8111\u5730\u5f80\u7247\u5916\u4e3b\u5b58\u91cc\u8bfb\u6216\u5199\u3002\u8fd9\u5728\u76f4\u89c9\u4e0a\u5f88\u201c\u5b8c\u6574\u201d\uff0c\u4f46\u5b9e\u9645\u8fd0\u884c\u8d77\u6765\u975e\u5e38\u96be\u53d7\u3002</li> <li>\u96be\u53d7\u5728\u54ea\uff1f\u4e00\u6b21\u7247\u5916\u8bbf\u95ee\u5f88\u53ef\u80fd\u5bfc\u81f4\u4e24\u6b21 row buffer miss\u3002\u5728\u672a\u6765\u7684\u9ad8\u5ef6\u8fdf\u5185\u5b58\u7cfb\u7edf\u91cc\uff0c\u8fd9\u4e2a\u4ee3\u4ef7\u6781\u5176\u9ad8\u6602\u3002</li> <li>\u66f4\u8981\u547d\u7684\u662f\uff0c\u5f88\u591a pattern \u6839\u672c\u4e0d\u503c\u5f97\u8fd9\u4e48\u5e72\u3002\u6bd4\u5982\u4e00\u4e2a pattern \u91cc\u53ea\u6709\u4e24\u4e09\u4e2a '1'\uff0c\u610f\u5473\u7740\u5b83\u53ea\u4f1a\u89e6\u53d1\u4e24\u4e09\u6b21\u9884\u53d6\u3002\u4e3a\u4e86\u8fd9\u70b9\u5fae\u8584\u7684\u6536\u76ca\uff0c\u53bb\u5192\u4e24\u6b21 row buffer miss \u7684\u5de8\u5927\u98ce\u9669\uff0c\u5b8c\u5168\u662f\u5f97\u4e0d\u507f\u5931\uff0c\u751a\u81f3\u4f1a\u62d6\u7d2f\u6574\u4f53\u6027\u80fd\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9</p> <ul> <li>\u8fd9\u5c31\u50cf\u4f60\u5f00\u4e86\u4e00\u5bb6\u5feb\u9012\u4e2d\u8f6c\u7ad9\uff08CPU\uff09\uff0c\u65c1\u8fb9\u6709\u4e2a\u8d85\u5927\u4ed3\u5e93\uff08Off-chip Memory\uff09\u3002\u6bcf\u6b21\u6709\u65b0\u5305\u88f9\uff08pattern\uff09\u8fdb\u6765\uff0c\u4f60\u90fd\u5f97\u6d3e\u4e00\u8f86\u8f66\uff08memory access\uff09\u53bb\u4ed3\u5e93\u767b\u8bb0\u4e00\u4e0b\u3002</li> <li>\u4f46\u5982\u679c\u662f\u4e2a\u53ea\u503c\u51e0\u5757\u94b1\u7684\u5c0f\u5305\u88f9\uff0c\u6d3e\u8f66\u8fc7\u53bb\u4e00\u8d9f\u7684\u6cb9\u94b1\uff08row buffer miss penalty\uff09\u53ef\u80fd\u6bd4\u5305\u88f9\u672c\u8eab\u8fd8\u8d35\u3002\u806a\u660e\u7684\u505a\u6cd5\u662f\uff1a\u53ea\u7ed9\u90a3\u4e9b\u4ef7\u503c\u8d85\u8fc730\u5757\u94b1\u7684\u5927\u5305\u88f9\uff08prefetch count &gt; 30\uff09\u3002\u8fd9\u6837\uff0c\u4f60\u7684\u8f66\u961f\u8d44\u6e90\uff08memory bandwidth\uff09\u5c31\u80fd\u96c6\u4e2d\u5728\u771f\u6b63\u80fd\u8d5a\u94b1\u7684\u4e1a\u52a1\u4e0a\uff0c\u907f\u514d\u88ab\u7410\u788e\u5c0f\u4e8b\u62d6\u57ae\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db</p> <ul> <li>\u4f5c\u8005\u6ca1\u6709\u6539\u53d8 pattern \u7684\u5b66\u4e60\u548c\u5b58\u50a8\u903b\u8f91\uff0c\u800c\u662f\u5728\u51b3\u5b9a\u662f\u5426\u8fdb\u884c\u7247\u5916I/O\u64cd\u4f5c\u7684\u90a3\u4e2a\u4e34\u754c\u70b9\uff0c\u63d2\u5165\u4e86\u4e00\u4e2a\u6781\u5176\u7b80\u5355\u7684\u8fc7\u6ee4\u5668\uff08filtering mechanism\uff09\u3002</li> <li>\u5177\u4f53\u6765\u8bf4\uff1a</li> <li>\u5728\u8bad\u7ec3\u9636\u6bb5\uff0c\u5f53\u4e00\u4e2a 16KB-region \u7684 pattern \u88ab\u6700\u7ec8\u786e\u5b9a\u540e\uff0c\u7cfb\u7edf\u4f1a\u7acb\u523b\u8ba1\u7b97\u5176\u9884\u53d6\u8ba1\u6570\uff08prefetch count\uff09\uff0c\u4e5f\u5c31\u662f\u4f4d\u5411\u91cf\u4e2d '1' \u7684\u4e2a\u6570\u3002</li> <li>\u53ea\u6709\u5f53\u8fd9\u4e2a\u8ba1\u6570\u8d85\u8fc7\u9884\u8bbe\u9608\u503c\uff08\u4f8b\u598230\uff09\uff0c\u7cfb\u7edf\u624d\u4f1a\u5141\u8bb8\u5c06\u8fd9\u4e2a pattern \u5199\u5165\uff08spill\uff09\u5230\u7247\u5916\u7684 PHT \u4e2d\u3002</li> <li>\u540c\u6837\uff0c\u5728\u9884\u6d4b\u9636\u6bb5\uff0c\u5373\u4f7f\u7247\u4e0a\u7f13\u5b58\u6ca1\u547d\u4e2d\uff0c\u7cfb\u7edf\u4e5f\u4f1a\u5148\u68c0\u67e5\u7247\u5916 Valid Map\u3002\u4f46\u5373\u4fbf Valid Map \u663e\u793a\u5b58\u5728\uff0c\u5982\u679c\u5f53\u521d\u5199\u5165\u65f6\u5c31\u6ca1\u8fbe\u6807\uff0c\u8fd9\u4e2a pattern \u6839\u672c\u5c31\u4e0d\u4f1a\u5b58\u5728\u4e8e\u7247\u5916\uff0c\u81ea\u7136\u4e5f\u5c31\u4e0d\u4f1a\u89e6\u53d1\u6602\u8d35\u7684\u52a0\u8f7d\u8bf7\u6c42\u3002</li> <li>\u8fd9\u4e00\u62db\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u7528\u4e00\u4e2a\u51e0\u4e4e\u96f6\u6210\u672c\u7684\u8ba1\u6570\u5224\u65ad\uff0c\u5c31\u89c4\u907f\u4e86\u5927\u91cf\u6f5c\u5728\u7684\u3001\u9ad8\u6210\u672c\u7684\u65e0\u6548\u7247\u5916\u8bbf\u95ee\uff0c\u5b8c\u7f8e\u5730\u5e73\u8861\u4e86\u6536\u76ca\uff08prefetch gain\uff09\u4e0e\u98ce\u9669\uff08row buffer miss penalty\uff09\u3002</li> </ul> <p></p> <p>Table 6: Comparison of area overheads</p> <p>\u5982\u4e0a\u8868\u6240\u793a\uff0cRICH \u901a\u8fc7\u8fd9\u79cd\u673a\u5236\uff0c\u5c06\u7247\u4e0a\u5b58\u50a8\u5f00\u9500\u4ece Bingo \u7684 127 KB \u5927\u5e45\u964d\u4f4e\u5230 47 KB\uff0c\u540c\u65f6\u4ec5\u4f7f\u7528 128 KB \u7684\u7247\u5916\u7a7a\u95f4\uff0c\u5c31\u5b9e\u73b0\u4e86\u8d85\u8d8a\u6240\u6709\u5bf9\u6bd4\u65b9\u6848\u7684\u6027\u80fd\u3002\u8fd9\u5145\u5206\u8bc1\u660e\u4e86\u8be5\u8fc7\u6ee4\u673a\u5236\u7684\u6709\u6548\u6027\u3002</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/","title":"RICH Prefetcher: Storing Rich Information in Memory to Trade Capacity and Bandwidth for Latency Hiding \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#table-1-ddr-specifications-across-generations-exhibit-the-high-bandwidth-high-capacity-and-high-latency-trends","title":"Table 1: DDR specifications across generations exhibit the high-bandwidth high-capacity and high-latency trends","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u8bba\u6587\u4e2d\u7684 Table 1\uff0c\u6807\u9898\u660e\u786e\u6307\u51fa\u5176\u5c55\u793a\u7684\u662f DDR \u89c4\u683c\u5728\u4e0d\u540c\u4ee3\u9645\u95f4\u7684\u6f14\u8fdb\u8d8b\u52bf\uff0c\u6838\u5fc3\u805a\u7126\u4e8e \u9ad8\u5e26\u5bbd\u3001\u5927\u5bb9\u91cf\u4e0e\u9ad8\u5ef6\u8fdf \u7684\u5e76\u5b58\u73b0\u8c61\u3002</li> <li>\u8868\u683c\u6a2a\u5411\u5217\u51fa\u56db\u5217\u5173\u952e\u6307\u6807\uff1aDDR Gen.\uff08\u4ee3\u9645\uff09\u3001Peak speed\uff08\u5cf0\u503c\u901f\u5ea6\uff09\u3001Max. size\uff08\u6700\u5927\u5bb9\u91cf\uff09\u3001latency on row hit\uff08\u884c\u547d\u4e2d\u5ef6\u8fdf\uff09 \u548c latency on row miss\uff08\u884c\u672a\u547d\u4e2d\u5ef6\u8fdf\uff09\u3002</li> <li>\u7eb5\u5411\u5bf9\u6bd4\u4e09\u4ee3\u4e3b\u6d41 DDR \u6807\u51c6\uff1aDDR3 [27]\u3001DDR4 [28]\u3001DDR5 [29]\uff0c\u6e05\u6670\u5448\u73b0\u6280\u672f\u8fed\u4ee3\u8def\u5f84\u3002</li> </ul> DDR Gen. Peak speed Max. size latency on row hit latency on row miss 3 [27] 2133 MT/s 8Gb 10-15ns 20-30ns 4 [28] 3200 MT/s 16Gb 12-15ns 25-30ns 5 [29] 7200 MT/s 64Gb 14-18ns 28-36ns <ul> <li>\u5cf0\u503c\u901f\u5ea6 \u4ece DDR3 \u7684 2133 MT/s \u8dc3\u5347\u81f3 DDR5 \u7684 7200 MT/s\uff0c\u589e\u957f\u8d85\u8fc7 \u4e09\u500d\uff0c\u4f53\u73b0 \u9ad8\u5e26\u5bbd \u8d8b\u52bf\u3002</li> <li>\u6700\u5927\u5bb9\u91cf \u4ece 8Gb \u589e\u81f3 64Gb\uff0c\u540c\u6837\u5b9e\u73b0 \u516b\u500d\u63d0\u5347\uff0c\u5370\u8bc1 \u5927\u5bb9\u91cf \u53d1\u5c55\u65b9\u5411\u3002</li> <li>\u8bbf\u95ee\u5ef6\u8fdf \u6307\u6807\u540c\u6b65\u4e0a\u5347\uff1a\u884c\u547d\u4e2d\u5ef6\u8fdf \u4ece 10-15ns \u589e\u81f3 14-18ns\uff0c\u884c\u672a\u547d\u4e2d\u5ef6\u8fdf \u4ece 20-30ns \u6269\u5c55\u81f3 28-36ns\uff0c\u8868\u660e \u9ad8\u5ef6\u8fdf \u6210\u4e3a\u4f34\u968f\u6027\u80fd\u63d0\u5347\u7684\u4ee3\u4ef7\u3002</li> <li>\u8be5\u8868\u683c\u4f5c\u4e3a\u80cc\u666f\u652f\u6491\uff0c\u65e8\u5728\u8bf4\u660e\u73b0\u4ee3\u5185\u5b58\u7cfb\u7edf\u8bbe\u8ba1\u4e2d \u5e26\u5bbd\u4e0e\u5bb9\u91cf\u63d0\u5347\u4ee5\u727a\u7272\u5ef6\u8fdf\u4e3a\u4ee3\u4ef7 \u7684\u666e\u904d\u89c4\u5f8b\uff0c\u4e3a\u8bba\u6587\u63d0\u51fa\u7684 RICH prefetcher \u9488\u5bf9\u9ad8\u5ef6\u8fdf\u573a\u666f\u4f18\u5316\u63d0\u4f9b\u5fc5\u8981\u6027\u4f9d\u636e\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-1-different-workloads-favor-distinct-spatial-region-sizes-for-prefetching-approximately-half-achieve-peak-performance-under-conventional-4-kb-regionswhile-the-remainder-achieve-peak-performance-with-larger-spatial-region-sizes","title":"Figure 1: Different workloads favor distinct spatial region sizes for prefetching; approximately half achieve peak performance under conventional 4 KB regions,while the remainder achieve peak performance with larger spatial region sizes","text":"<ul> <li>\u56fe\u7247\u4e3a\u4e00\u4e2a\u73af\u5f62\u56fe\uff0c\u6807\u9898\u4e3a\u201cFigure 1: Different workloads favor distinct spatial region sizes for prefetching; approximately half achieve peak performance under conventional 4 KB regions, while the remainder achieve peak performance with larger spatial region sizes\u201d\uff0c\u65e8\u5728\u5c55\u793a\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u5728\u9884\u53d6\u65f6\u5bf9\u7a7a\u95f4\u533a\u57df\u5927\u5c0f\u7684\u504f\u597d\u3002</li> <li>\u56fe\u8868\u4e2d\u5fc3\u6807\u6ce8\u201cPercentage of optimal spatial prefetch region sizes:\u201d\uff0c\u8868\u660e\u5176\u7edf\u8ba1\u7684\u662f\u5404\u533a\u57df\u5c3a\u5bf8\u4f5c\u4e3a\u6700\u4f18\u9884\u53d6\u5355\u5143\u7684\u5360\u6bd4\u3002</li> <li>\u56fe\u4f8b\u6e05\u6670\u5bf9\u5e94\u516d\u79cd\u533a\u57df\u5c3a\u5bf8\uff1a1KB\u30012KB\u30014KB\u30018KB\u300116KB\u300132KB\uff0c\u5206\u522b\u4ee5\u4e0d\u540c\u989c\u8272\u533a\u5206\u3002</li> <li>\u5404\u533a\u57df\u5c3a\u5bf8\u5bf9\u5e94\u7684\u767e\u5206\u6bd4\u5982\u4e0b\u8868\u6240\u793a\uff1a</li> </ul> \u533a\u57df\u5c3a\u5bf8 \u5360\u6bd4 1KB 7.1% 2KB 24.3% 4KB 22.1% 8KB 12.1% 16KB 25.7% 32KB 8.6% <ul> <li>\u6570\u636e\u663e\u793a\uff0c4KB\u533a\u57df\u867d\u662f\u4f20\u7edf\u4e3b\u6d41\u9009\u62e9\uff0c\u4f46\u4ec5\u536022.1%\uff0c\u4e0d\u8db3\u56db\u5206\u4e4b\u4e00\uff1b\u800c16KB\u533a\u57df\u5360\u6bd4\u6700\u9ad8\uff0c\u8fbe25.7%\uff0c\u6210\u4e3a\u6700\u5e38\u88ab\u9009\u4e3a\u6700\u4f18\u9884\u53d6\u5c3a\u5bf8\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002</li> <li>2KB\u548c16KB\u5408\u8ba1\u5360\u6bd450%\uff0c\u5370\u8bc1\u4e86\u539f\u6587\u201capproximately half achieve peak performance under conventional 4 KB regions, while the remainder achieve peak performance with larger spatial region sizes\u201d\u7684\u7ed3\u8bba\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u63ed\u793a\u4e86\u5355\u4e00\u56fa\u5b9a\u533a\u57df\u5c3a\u5bf8\uff08\u59824KB\uff09\u65e0\u6cd5\u6ee1\u8db3\u591a\u6837\u5316\u7684\u8bbf\u95ee\u6a21\u5f0f\u9700\u6c42\uff0c\u652f\u6301\u8bba\u6587\u4e2d\u63d0\u51fa\u591a\u5c3a\u5ea6\u533a\u57df\u9884\u53d6\u7684\u8bbe\u8ba1\u52a8\u673a\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-2-the-multi-offset-trigger-mechanism-can-distinguish-common-origin-later-divergent-access-streams","title":"Figure 2: The multi-offset trigger mechanism can distinguish \"common-origin, later-divergent\" access streams","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 multi-offset trigger mechanism \u5982\u4f55\u533a\u5206\u5177\u6709\u201c\u5171\u540c\u8d77\u70b9\u3001\u540e\u671f\u53d1\u6563\u201d\u7279\u5f81\u7684\u8bbf\u95ee\u6d41\uff0c\u8fd9\u662f\u4f20\u7edf\u5355\u504f\u79fb\u89e6\u53d1\u673a\u5236\u65e0\u6cd5\u505a\u5230\u7684\u3002</li> <li>\u5de6\u4fa7\u56fe\u793a\u4e3a single-offset trigger mechanism \u7684\u5c40\u9650\u6027\uff1a\u5728 4 KB \u7a7a\u95f4\u533a\u57df\u5185\uff0c\u4e24\u4e2a\u8bbf\u95ee\u6d41 A \u548c B \u5747\u4ece\u5730\u5740 0x1 \u5f00\u59cb\u8bbf\u95ee\uff0c\u4f46\u540e\u7eed\u8def\u5f84\u4e0d\u540c\uff08A \u8bbf\u95ee 0x4, 0xc\uff1bB \u8bbf\u95ee 0xc, 0x1\uff09\uff0c\u5355\u504f\u79fb\u673a\u5236\u4ec5\u51ed\u9996\u4e2a\u504f\u79fb\u91cf\u65e0\u6cd5\u533a\u5206\u4e8c\u8005\uff0c\u5bfc\u81f4\u8bef\u9884\u6d4b\u3002</li> <li>\u53f3\u4fa7\u56fe\u793a\u4e3a multi-offset trigger mechanism \u7684\u4f18\u52bf\uff1a\u901a\u8fc7\u8bb0\u5f55\u591a\u4e2a\u8bbf\u95ee\u504f\u79fb\uff08\u5982 0x1 \u548c 0x4 \u5bf9\u5e94\u6d41 A\uff0c0x1 \u548c 0xc \u5bf9\u5e94\u6d41 B\uff09\uff0c\u7cfb\u7edf\u53ef\u8bc6\u522b\u51fa\u4e24\u4e2a\u6d41\u867d\u8d77\u59cb\u76f8\u540c\uff0c\u4f46\u540e\u7eed\u884c\u4e3a\u4e0d\u540c\uff0c\u4ece\u800c\u5206\u522b\u5efa\u6a21\u5e76\u51c6\u786e\u9884\u6d4b\u3002</li> <li>\u8be5\u673a\u5236\u7684\u6838\u5fc3\u5728\u4e8e\u5229\u7528 \u591a\u504f\u79fb\u4fe1\u606f \u9a8c\u8bc1\u8bbf\u95ee\u6a21\u5f0f\u7684\u8fde\u7eed\u6027\u548c\u65b9\u5411\u6027\uff0c\u907f\u514d\u5c06\u201ccommon-origin, later-divergent\u201d\u6d41\u9519\u8bef\u5f52\u7c7b\u4e3a\u540c\u4e00\u6a21\u5f0f\u3002</li> <li>\u56fe\u4e2d\u660e\u786e\u6807\u6ce8\u4e86\u4e24\u4e2a\u8bbf\u95ee\u6d41\u7684\u5177\u4f53\u5730\u5740\u5e8f\u5217\uff1a</li> <li>\u6d41 A \u5730\u5740\uff1a0x1, 0x4, 0xc</li> <li>\u6d41 B \u5730\u5740\uff1a0x1, 0xc, 0x4</li> <li>\u6b64\u8bbe\u8ba1\u76f4\u63a5\u652f\u6301 RICH prefetcher \u4e2d\u5bf9 16 KB \u533a\u57df\u91c7\u7528 (PC, 5 offsets) \u89e6\u53d1\u7b56\u7565\uff0c\u4ee5\u63d0\u5347\u5927\u533a\u57df\u9884\u53d6\u7684\u51c6\u786e\u6027\uff0c\u540c\u65f6\u727a\u7272\u90e8\u5206\u8986\u76d6\u7387\u6362\u53d6\u9ad8\u7cbe\u5ea6\u3002</li> </ul> \u673a\u5236\u7c7b\u578b \u80fd\u5426\u533a\u5206\u6d41 A/B \u6838\u5fc3\u4f9d\u636e \u7f3a\u9677/\u4f18\u52bf Single-offset \u274c \u4e0d\u80fd \u4ec5\u4f9d\u8d56\u9996\u4e2a\u8bbf\u95ee\u504f\u79fb\uff080x1\uff09 \u65e0\u6cd5\u6355\u6349\u540e\u7eed\u53d1\u6563\u884c\u4e3a\uff0c\u6613\u4ea7\u751f\u8bef\u9884\u6d4b Multi-offset \u2705 \u80fd \u4f9d\u8d56\u591a\u4e2a\u8bbf\u95ee\u504f\u79fb\u7ec4\u5408\uff08\u5982 0x1+0x4 vs 0x1+0xc\uff09 \u63d0\u5347\u51c6\u786e\u6027\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u5927\u533a\u57df\u9884\u53d6\u573a\u666f <ul> <li>\u8be5\u56fe\u662f RICH \u8bbe\u8ba1\u4e2d Insight 2 \u7684\u76f4\u89c2\u4f53\u73b0\uff0c\u5373\u201c\u89c2\u5bdf\u66f4\u591a\u8bbf\u95ee\u504f\u79fb\u53ef\u63d0\u9ad8\u51c6\u786e\u6027\uff0c\u4ee3\u4ef7\u662f\u964d\u4f4e\u8986\u76d6\u7387\u201d\uff0c\u4e3a\u540e\u7eed\u591a\u5c3a\u5ea6\u533a\u57df\u4ef2\u88c1\u673a\u5236\u5960\u5b9a\u57fa\u7840\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-3-by-using-more-access-offsets-in-a-trigger-we-can-trade-off-between-the-accuracy-and-coverage-of-prefetching-specifically-a-band-c-correspond-to-16-kb-region-4-kbregion-and-2-kb-region","title":"Figure 3: By using more access offsets in a trigger, we can trade off between the accuracy and coverage of prefetching. Specifically, a), b),and c) correspond to 16 KB-region, 4 KBregion, and 2 KB-region.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u4e0d\u540c\u7a7a\u95f4\u533a\u57df\u5927\u5c0f\uff0816 KB\u30014 KB\u30012 KB\uff09\u4e0b\uff0c\u4f7f\u7528\u4e0d\u540c\u6570\u91cf\u7684\u8bbf\u95ee\u504f\u79fb\u91cf\uff08offsets\uff09\u4f5c\u4e3a\u89e6\u53d1\u6761\u4ef6\u65f6\uff0c\u9884\u53d6\u5668\u7684 Accuracy\uff08\u51c6\u786e\u7387\uff09\u3001Coverage\uff08\u8986\u76d6\u7387\uff09\u548c Timeliness\uff08\u53ca\u65f6\u6027\uff09\u4e09\u8005\u4e4b\u95f4\u7684\u6743\u8861\u5173\u7cfb\u3002</li> <li>\u4e09\u4e2a\u5b50\u56fe\u5206\u522b\u5bf9\u5e94\uff1a</li> <li>a) 16 KB-region\uff1a\u968f\u7740\u89e6\u53d1\u6761\u4ef6\u4e2d\u5305\u542b\u7684\u504f\u79fb\u91cf\u4ece (PC,1 offset) \u589e\u52a0\u5230 (PC,10 offsets)\uff0cAccuracy \u4ece\u7ea650%\u663e\u8457\u4e0a\u5347\u81f3\u63a5\u8fd1100%\uff0c\u800c Coverage \u5219\u4ece\u7ea650%\u6301\u7eed\u4e0b\u964d\u81f3\u7ea620%\uff0cTimeliness \u57fa\u672c\u4fdd\u6301\u7a33\u5b9a\u572875%-80%\u533a\u95f4\u3002</li> <li>b) 4 KB-region\uff1a\u968f\u7740\u504f\u79fb\u91cf\u4ece (PC,1 offset) \u589e\u52a0\u5230 (PC,8 offsets)\uff0cAccuracy \u4ece\u7ea665%\u4e0a\u5347\u81f3\u7ea695%\uff0cCoverage \u4ece\u7ea660%\u4e0b\u964d\u81f3\u7ea625%\uff0cTimeliness \u7a0d\u6709\u4e0b\u964d\u4f46\u4ecd\u7ef4\u6301\u572875%\u5de6\u53f3\u3002</li> <li> <p>c) 2 KB-region\uff1a\u968f\u7740\u504f\u79fb\u91cf\u4ece (PC,1 offset) \u589e\u52a0\u5230 (PC,8 offsets)\uff0cAccuracy \u4ece\u7ea665%\u4e0a\u5347\u81f3\u7ea695%\uff0cCoverage \u4ece\u7ea660%\u4e0b\u964d\u81f3\u7ea625%\uff0cTimeliness \u7565\u6709\u6ce2\u52a8\u4f46\u57fa\u672c\u7a33\u5b9a\u572870%\u4ee5\u4e0a\u3002</p> </li> <li> <p>\u6570\u636e\u8d8b\u52bf\u603b\u7ed3\u5982\u4e0b\uff1a</p> </li> </ul> \u533a\u57df\u5927\u5c0f Accuracy \u8d8b\u52bf Coverage \u8d8b\u52bf Timeliness \u8d8b\u52bf 16 KB \u663e\u8457\u4e0a\u5347 \u663e\u8457\u4e0b\u964d \u57fa\u672c\u7a33\u5b9a 4 KB \u4e0a\u5347 \u4e0b\u964d \u7565\u964d 2 KB \u4e0a\u5347 \u4e0b\u964d \u57fa\u672c\u7a33\u5b9a <ul> <li>\u6838\u5fc3\u7ed3\u8bba\uff1a</li> <li>\u589e\u52a0\u89e6\u53d1\u6761\u4ef6\u4e2d\u7684\u8bbf\u95ee\u504f\u79fb\u91cf\u53ef\u6709\u6548\u63d0\u5347 Accuracy\uff0c\u5c24\u5176\u5728\u5927\u533a\u57df\uff08\u598216 KB\uff09\u4e2d\u6548\u679c\u663e\u8457\uff0c\u80fd\u5c06\u51c6\u786e\u7387\u4ece\u4e0d\u8db350%\u63d0\u5347\u81f390%\u4ee5\u4e0a\u3002</li> <li>\u4ee3\u4ef7\u662f Coverage \u663e\u8457\u964d\u4f4e\uff0c\u56e0\u4e3a\u66f4\u4e25\u683c\u7684\u89e6\u53d1\u6761\u4ef6\u5bfc\u81f4\u66f4\u5c11\u7684\u9884\u53d6\u673a\u4f1a\u88ab\u6fc0\u6d3b\u3002</li> <li>Timeliness \u53d7\u5f71\u54cd\u8f83\u5c0f\uff0c\u8868\u660e\u8be5\u673a\u5236\u4e3b\u8981\u5f71\u54cd\u9884\u6d4b\u662f\u5426\u53d1\u751f\uff0c\u800c\u975e\u9884\u6d4b\u65f6\u673a\u3002</li> <li>RICH\u8bbe\u8ba1\u636e\u6b64\u91c7\u7528\u5dee\u5f02\u5316\u7b56\u7565\uff1a\u5bf916 KB\u533a\u57df\u91c7\u7528(PC,5 offsets)\u4ee5\u8ffd\u6c42\u9ad8\u7cbe\u5ea6\uff0c\u5bf94 KB\u533a\u57df\u91c7\u7528(PC,3 offsets)\u5e73\u8861\u7cbe\u5ea6\u4e0e\u8986\u76d6\uff0c\u5bf92 KB\u533a\u57df\u4fdd\u7559(PC,1 offset)\u6216(PC,address)\u4ee5\u6700\u5927\u5316\u8986\u76d6\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#24623341e46f13ed9c6004980d11054a104d928f1085abdd3d49c538fd7c2597jpg","title":"24623341e46f13ed9c6004980d11054a104d928f1085abdd3d49c538fd7c2597.jpg","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RICH \u9884\u53d6\u5668\u5728\u4e0d\u540c\u533a\u57df\u5927\u5c0f\u548c\u89e6\u53d1\u673a\u5236\u4e0b\u7684 Accuracy\uff08\u51c6\u786e\u7387\uff09\u4e0e Coverage\uff08\u8986\u76d6\u7387\uff09\u5bf9\u6bd4\uff0c\u76f4\u89c2\u5448\u73b0\u4e86\u5176\u591a\u5c3a\u5ea6\u8bbe\u8ba1\u7684\u6838\u5fc3\u6743\u8861\u7b56\u7565\u3002</li> <li>\u6570\u636e\u4ee5\u67f1\u72b6\u56fe\u5f62\u5f0f\u5448\u73b0\uff0c\u84dd\u8272\u4ee3\u8868 Accuracy\uff0c\u6a59\u8272\u4ee3\u8868 Coverage\uff0c\u6a2a\u8f74\u4e3a\u56db\u79cd\u4e0d\u540c\u7684\u9884\u53d6\u914d\u7f6e\uff1a</li> <li>16 KB-region (PC, 5 offsets)</li> <li>4 KB-region (PC, 3 offsets)</li> <li>2 KB-region (PC, offset)</li> <li> <p>2 KB-region (PC, address)</p> </li> <li> <p>\u5404\u914d\u7f6e\u6027\u80fd\u6570\u636e\u5982\u4e0b\u8868\u6240\u793a\uff1a</p> </li> </ul> \u914d\u7f6e Accuracy Coverage 16 KB-region (PC, 5 offsets) \u7ea6 90% \u7ea6 30% 4 KB-region (PC, 3 offsets) \u7ea6 85% \u7ea6 40% 2 KB-region (PC, offset) \u7ea6 65% \u7ea6 60% 2 KB-region (PC, address) \u7ea6 90% \u7ea6 10% <ul> <li>\u5206\u6790\u8868\u660e\uff0cRICH \u7684\u8bbe\u8ba1\u5b9e\u73b0\u4e86\u660e\u786e\u7684\u6027\u80fd\u53d6\u820d\uff1a</li> <li>\u5927\u533a\u57df\uff0816KB\uff09\uff1a\u91c7\u7528 (PC, 5 offsets) \u89e6\u53d1\uff0c\u8ffd\u6c42 \u9ad8\u51c6\u786e\u7387\uff08~90%\uff09\uff0c\u4f46\u727a\u7272\u4e86\u90e8\u5206\u8986\u76d6\u7387\uff08~30%\uff09\uff0c\u9002\u7528\u4e8e\u5bf9\u8bef\u9884\u53d6\u4ee3\u4ef7\u654f\u611f\u7684\u573a\u666f\u3002</li> <li>\u4e2d\u533a\u57df\uff084KB\uff09\uff1a\u91c7\u7528 (PC, 3 offsets) \u89e6\u53d1\uff0c\u5728\u51c6\u786e\u7387\uff08~85%\uff09\u548c\u8986\u76d6\u7387\uff08~40%\uff09\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u3002</li> <li>\u5c0f\u533a\u57df\uff082KB\uff09\uff1a\u91c7\u7528 (PC, offset) \u89e6\u53d1\uff0c\u4f18\u5148\u4fdd\u8bc1 \u9ad8\u8986\u76d6\u7387\uff08~60%\uff09\uff0c\u51c6\u786e\u7387\u76f8\u5bf9\u8f83\u4f4e\uff08~65%\uff09\uff0c\u7528\u4e8e\u6355\u6349\u66f4\u5e7f\u6cdb\u7684\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li> <p>\u7279\u6b8a\u5c0f\u533a\u57df\uff082KB\uff09\uff1a\u91c7\u7528 (PC, address) \u89e6\u53d1\uff0c\u5176\u51c6\u786e\u7387\u4e0e 16KB \u533a\u57df\u76f8\u5f53\uff08~90%\uff09\uff0c\u4f46\u8986\u76d6\u7387\u6781\u4f4e\uff08~10%\uff09\uff0c\u56e0\u5176\u89e6\u53d1\u6761\u4ef6\u82db\u523b\uff08\u9700\u7cbe\u786e\u5730\u5740\u5339\u914d\uff09\uff0c\u4e3b\u8981\u7528\u4e8e\u7279\u5b9a\u9ad8\u7cbe\u5ea6\u9700\u6c42\u3002</p> </li> <li> <p>\u6b64\u56fe\u8868\u662f RICH \u8bbe\u8ba1\u54f2\u5b66\u7684\u76f4\u63a5\u4f53\u73b0\uff1a\u901a\u8fc7 \u591a\u7ea7\u89e6\u53d1\u673a\u5236 \u548c \u533a\u57df\u4ef2\u88c1\u7b56\u7565\uff0c\u52a8\u6001\u9009\u62e9\u6700\u4f18\u9884\u53d6\u7c92\u5ea6\uff0c\u4ece\u800c\u5728\u6574\u4f53\u4e0a\u5b9e\u73b0 \u9ad8\u51c6\u786e\u7387\u3001\u9ad8\u8986\u76d6\u7387\u548c\u9ad8\u53ca\u65f6\u6027 \u7684\u534f\u540c\u4f18\u5316\u3002</p> </li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-4-achieving-high-accuracy-in-large-spatial-regions-and-high-coverage-in-small-spatial-regions-by-using-different-numbers-of-trigger-offsets-figure-5-placing-16-kb-pht-off-chip-keeps-most-prefetch-opportunities-even-with-additional-memory-access-latency","title":"Figure 4: Achieving high accuracy in large spatial regions and high coverage in small spatial regions by using different numbers of trigger offsets Figure 5: Placing 16 KB PHT off-chip keeps most prefetch opportunities, even with additional memory access latency","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 5\uff0c\u5176\u6838\u5fc3\u7ed3\u8bba\u662f\uff1a\u5c06 16 KB PHT \u653e\u7f6e\u5728\u7247\u5916\uff08off-chip\uff09\u4ecd\u80fd\u4fdd\u7559\u5927\u90e8\u5206\u9884\u53d6\u673a\u4f1a\uff0c\u5373\u4f7f\u5b58\u5728\u989d\u5916\u7684\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> <li>\u6a2a\u8f74\u8868\u793a Additional Memory Access Latency\uff0c\u4ece 0 ns \u5230 50 ns\uff0c\u4ee5 10 ns \u4e3a\u6b65\u957f\u9012\u589e\uff0c\u6a21\u62df\u672a\u6765\u9ad8\u5ef6\u8fdf\u5185\u5b58\u7cfb\u7edf\u573a\u666f\u3002</li> <li>\u7eb5\u8f74\u8868\u793a Late Prefetches\uff0c\u5373\u201c\u8fdf\u5230\u9884\u53d6\u201d\u7684\u6bd4\u4f8b\uff0c\u8303\u56f4\u4ece 5% \u5230 20%\uff0c\u8861\u91cf\u56e0\u5143\u6570\u636e\u52a0\u8f7d\u5ef6\u8fdf\u5bfc\u81f4\u9884\u53d6\u8bf7\u6c42\u672a\u80fd\u53ca\u65f6\u5b8c\u6210\u7684\u6bd4\u4f8b\u3002</li> <li>\u6570\u636e\u8d8b\u52bf\u663e\u793a\uff0c\u968f\u7740\u989d\u5916\u5ef6\u8fdf\u589e\u52a0\uff0cLate Prefetches \u6bd4\u4f8b\u5448\u7f13\u6162\u4e0a\u5347\u8d8b\u52bf\uff1a</li> <li>\u5728 0 ns \u5ef6\u8fdf\u65f6\uff0c\u7ea6\u4e3a 11%\u3002</li> <li>\u5728 50 ns \u5ef6\u8fdf\u65f6\uff0c\u4e0a\u5347\u81f3\u7ea6 15%\u3002</li> <li>\u8fd9\u8868\u660e\u5373\u4f7f\u5f15\u5165\u9ad8\u8fbe 50 ns \u7684\u989d\u5916\u5ef6\u8fdf\uff0cRICH prefetcher \u4ecd\u80fd\u7ef4\u6301\u8d85\u8fc7 85% \u7684\u9884\u53d6\u673a\u4f1a\u672a\u88ab\u6d6a\u8d39\uff0c\u9a8c\u8bc1\u4e86\u5176\u5bf9\u5ef6\u8fdf\u7684\u5bb9\u5fcd\u80fd\u529b\u3002</li> <li>\u6b64\u8bbe\u8ba1\u7b56\u7565\u6709\u6548\u5e73\u8861\u4e86 on-chip area overhead \u4e0e off-chip latency penalty\uff0c\u901a\u8fc7\u5c06\u5927\u533a\u57df\u6a21\u5f0f\uff0816 KB-region patterns\uff09\u5378\u8f7d\u5230\u4e3b\u5b58\uff0c\u663e\u8457\u8282\u7701\u82af\u7247\u9762\u79ef\uff0c\u540c\u65f6\u6027\u80fd\u635f\u5931\u53ef\u63a7\u3002</li> <li>\u8be5\u7ed3\u679c\u652f\u6491\u8bba\u6587\u4e2d\u63d0\u51fa\u7684 hierarchical storage design\uff0c\u5373\u9ad8\u9891\u6a21\u5f0f\u4fdd\u7559\u5728\u7247\u4e0a\u7f13\u5b58\uff0c\u4f4e\u9891\u6a21\u5f0f\u5b58\u50a8\u4e8e\u7247\u5916\uff0c\u5b9e\u73b0\u6210\u672c\u4e0e\u6027\u80fd\u7684\u6700\u4f18\u6298\u8877\u3002</li> </ul> Additional Memory Access Latency Late Prefetches (%) 0 ns ~11% 10 ns ~12% 20 ns ~12.5% 30 ns ~13.5% 40 ns ~14% 50 ns ~15%"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#table-2-categorization-of-richs-metadata","title":"Table 2: Categorization of RICH's metadata","text":"<ul> <li> <p>Table 2 \u5bf9 RICH prefetcher \u7684\u5143\u6570\u636e\u8fdb\u884c\u4e86\u7cfb\u7edf\u6027\u5206\u7c7b\uff0c\u4f9d\u636e\u4e09\u4e2a\u6838\u5fc3\u7ef4\u5ea6\uff1aArea overheads\u3001Access frequency \u548c Latency tolerance\uff0c\u5e76\u636e\u6b64\u51b3\u5b9a\u5176\u5b58\u50a8\u4f4d\u7f6e\uff08on-chip/off-chip\uff09\u3002</p> </li> <li> <p>\u5143\u6570\u636e\u88ab\u5212\u5206\u4e3a\u56db\u7c7b\uff1a</p> </li> <li>Large region\u2019s patterns (16 KB-region)</li> <li>Small region\u2019s patterns (4 KB &amp; 2 KB-region)</li> <li>Training metadata</li> <li> <p>Control metadata</p> </li> <li> <p>\u5404\u7c7b\u5143\u6570\u636e\u7684\u7279\u6027\u4e0e RICH \u7684\u51b3\u7b56\u5982\u4e0b\u8868\u6240\u793a\uff1a</p> </li> </ul> \u5143\u6570\u636e\u7c7b\u522b Area overheads Access frequency Latency tolerance RICH\u2019s structures RICH\u2019s decision Large region\u2019s patterns high (&gt; 100 KB) mixed high 16 KB-region PHT Cache, 16 KB-region PHT Frequently accessed: on-chipInfrequently accessed: off-chip Small region\u2019s patterns medium (~30 KB) mixed low 4 KB-region PHT, 2 KB-region PHT on-chip Training metadata low (&lt; 10 KB) high low FTs, ATs on-chip Control metadata low (&lt; 10 KB) high low Inflight Prefetch Table, 16 KB-region Valid Map on-chip <ul> <li>\u5173\u952e\u8bbe\u8ba1\u6d1e\u5bdf\uff1a</li> <li>\u5927\u533a\u57df\u6a21\u5f0f\u56e0\u9762\u79ef\u5f00\u9500\u5de8\u5927\u4e14\u5bf9\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6\u9ad8\uff0c\u91c7\u7528\u5206\u5c42\u5b58\u50a8\uff1a\u9ad8\u9891\u8bbf\u95ee\u90e8\u5206\u7f13\u5b58\u5728\u7247\u4e0a\uff08PHT Cache\uff09\uff0c\u4f4e\u9891\u90e8\u5206\u5378\u8f7d\u81f3\u7247\u5916\u4e3b\u5b58\uff0c\u4ee5\u5e73\u8861\u6027\u80fd\u4e0e\u6210\u672c\u3002</li> <li>\u5c0f\u533a\u57df\u6a21\u5f0f\u3001\u8bad\u7ec3\u5143\u6570\u636e\u548c\u63a7\u5236\u5143\u6570\u636e\u5747\u56e0\u8bbf\u95ee\u9891\u7387\u9ad8\u6216\u5bf9\u5ef6\u8fdf\u654f\u611f\uff0c\u88ab\u5f3a\u5236\u90e8\u7f72\u5728\u7247\u4e0a\uff0c\u786e\u4fdd\u5feb\u901f\u54cd\u5e94\u3002</li> <li>\u6b64\u5206\u7c7b\u7b56\u7565\u662f RICH \u5b9e\u73b0\u201c\u7528\u5bb9\u91cf\u548c\u5e26\u5bbd\u6362\u5ef6\u8fdf\u9690\u85cf\u201d\u6838\u5fc3\u601d\u60f3\u7684\u5173\u952e\u652f\u6491\uff0c\u6709\u6548\u89c4\u907f\u4e86\u4f20\u7edf\u9884\u53d6\u5668\u53d7\u9650\u4e8e\u7247\u4e0a\u8d44\u6e90\u7684\u74f6\u9888\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#table-3-cover-ratio-under-a-2oo-entry-storage-constraint-of-16-kb-region-patterns","title":"Table 3: Cover ratio under a 2oo-entry storage constraint of 16 KB-region patterns","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u8bba\u6587\u4e2d\u7684 Table 3\uff0c\u6807\u9898\u4e3a \u201cCover ratio under a 200-entry storage constraint of 16 KB-region patterns\u201d\uff0c\u7528\u4e8e\u8bc4\u4f30\u5728\u4ec5\u4fdd\u7559 200\u4e2a\u6761\u76ee \u7684\u5b58\u50a8\u9650\u5236\u4e0b\uff0cRICH prefetcher \u5bf9 16 KB-region patterns \u7684\u8986\u76d6\u80fd\u529b\u3002</li> <li>\u8868\u683c\u5c55\u793a\u4e868\u4e2a\u4ee3\u8868\u6027\u5de5\u4f5c\u8d1f\u8f7d\uff08traces\uff09\u7684\u8986\u76d6\u6bd4\u4f8b\uff08% Covered\uff09\uff0c\u8fd9\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\u5728\u4f7f\u752816 KB\u533a\u57df\u9884\u53d6\u65f6\u80fd\u83b7\u5f97\u663e\u8457\u6027\u80fd\u6536\u76ca\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u5728\u6709\u9650\u7684200\u4e2a\u6761\u76ee\u7f13\u5b58\u5bb9\u91cf\u4e0b\uff0cRICH\u4ecd\u80fd\u5bf9\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u5b9e\u73b0\u9ad8\u8986\u76d6\u7387\uff0c\u9a8c\u8bc1\u4e86\u5176 \u5206\u5c42\u5b58\u50a8\u7b56\u7565 \u7684\u6709\u6548\u6027\u3002</li> </ul> Trace % Covered bwaves-891 100.0% gcc-1850 93.7% mcf-782 90.4% mcf-1152 86.7% bwaves-2609 80.5% fotonik3d-7084 66.9% roms-1070 38.7% roms-294 32.8% <ul> <li>\u8986\u76d6\u7387\u6700\u9ad8\u7684\u5de5\u4f5c\u8d1f\u8f7d\u662f bwaves-891\uff0c\u8fbe\u5230 100%\uff0c\u8bf4\u660e\u517616 KB\u533a\u57df\u8bbf\u95ee\u6a21\u5f0f\u9ad8\u5ea6\u96c6\u4e2d\uff0c\u5c11\u91cf\u9ad8\u9891\u6a21\u5f0f\u5373\u53ef\u5b8c\u5168\u8986\u76d6\u3002</li> <li>\u8986\u76d6\u7387\u6700\u4f4e\u7684\u662f roms-294 \u548c roms-1070\uff0c\u5206\u522b\u4e3a 32.8% \u548c 38.7%\uff0c\u8868\u660e\u8fd9\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\u7684\u8bbf\u95ee\u6a21\u5f0f\u66f4\u5206\u6563\uff0c\u9700\u8981\u66f4\u591a\u6761\u76ee\u624d\u80fd\u6709\u6548\u8986\u76d6\u3002</li> <li>\u6b64\u7ed3\u679c\u652f\u6301\u8bba\u6587\u4e2d\u63d0\u51fa\u7684\u89c2\u70b9\uff1a16 KB\u533a\u57df\u6a21\u5f0f\u5177\u6709 \u6df7\u5408\u9891\u7387\u5206\u5e03\uff0c\u56e0\u6b64\u91c7\u7528 \u5206\u5c42\u5b58\u50a8\uff08\u9ad8\u9891\u6a21\u5f0f\u653e\u7247\u4e0a\u7f13\u5b58\uff0c\u4f4e\u9891\u6a21\u5f0f\u653e\u7247\u5916\u5185\u5b58\uff09\u662f\u5408\u7406\u4e14\u9ad8\u6548\u7684\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-6-architecture-of-rich","title":"Figure 6: Architecture of RICH","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RICH Prefetcher \u7684\u5b8c\u6574\u67b6\u6784\uff0c\u5206\u4e3a On-chip \u548c Off-chip \u4e24\u5927\u6a21\u5757\uff0c\u901a\u8fc7\u6e05\u6670\u7684\u6570\u636e\u6d41\u548c\u63a7\u5236\u6d41\u8fde\u63a5\u3002</li> <li>On-chip \u90e8\u5206 \u5305\u542b\u4e09\u4e2a\u6838\u5fc3\u7ec4\u4ef6\uff1aTraining Unit\u3001Pattern Storage\uff08\u5373 PHTs\uff09\u548c Prediction Unit\uff0c\u5e76\u8f85\u4ee5 Region Arbitration \u548c Control Units\u3002</li> <li>Training Unit \u8d1f\u8d23\u4ece L2 cache miss/hit \u4e8b\u4ef6\u4e2d\u6355\u83b7\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4e3a 16 KB\u30014 KB \u548c 2 KB \u4e09\u4e2a\u533a\u57df\u5206\u522b\u7ef4\u62a4 Filter Table (FT) \u548c Accumulation Table (AT)\uff0c\u7528\u4e8e\u8fc7\u6ee4\u566a\u58f0\u5e76\u7d2f\u79ef\u4f4d\u5411\u91cf\u6a21\u5f0f\u3002</li> <li>Pattern Storage \u4e2d\uff0c2 KB \u548c 4 KB \u533a\u57df\u7684 PHT \u5b8c\u5168\u9a7b\u7559\u5728\u82af\u7247\u4e0a\uff1b\u800c 16 KB \u533a\u57df\u91c7\u7528 \u5206\u5c42\u8bbe\u8ba1\uff0c\u4ec5\u4fdd\u7559\u4e00\u4e2a\u5c0f\u578b PHT Cache \u5728\u7247\u4e0a\uff0c\u4f5c\u4e3a\u4e3b\u5b58\u4e2d\u5b8c\u6574 16 KB-region PHT \u7684\u7f13\u5b58\u3002</li> <li>Prediction Unit \u662f\u89e6\u53d1\u9884\u6d4b\u7684\u6838\u5fc3\uff0c\u5305\u542b\u4e09\u4e2a Lookup Units\uff0c\u5206\u522b\u5bf9\u5e94\u4e0d\u540c\u533a\u57df\u5927\u5c0f\u3002\u5b83\u4eec\u6839\u636e (PC, address) \u6216 (PC, offsets) \u7b49\u89e6\u53d1\u6761\u4ef6\u67e5\u8be2\u5bf9\u5e94\u7684 PHT\u3002</li> <li>Region Arbitration \u5355\u5143\u8d1f\u8d23\u89e3\u51b3\u591a\u533a\u57df\u540c\u65f6\u89e6\u53d1\u65f6\u7684\u4f18\u5148\u7ea7\u95ee\u9898\uff0c\u5e76\u4e0e Inflight Prefetch Table \u534f\u4f5c\uff0c\u907f\u514d\u5bf9\u540c\u4e00\u5185\u5b58\u7a7a\u95f4\u7684\u91cd\u590d\u6216\u91cd\u53e0\u9884\u53d6\u3002</li> <li>Control Units \u4e13\u95e8\u7ba1\u7406 16 KB \u533a\u57df\u7684\u5143\u6570\u636e\u8bfb\u5199\uff0c\u5305\u62ec\u4e0e Valid Map \u5355\u5143\u534f\u540c\u5224\u65ad\u79bb\u7ebf\u6a21\u5f0f\u662f\u5426\u5b58\u5728\uff0c\u4ee5\u53ca\u5f02\u6b65\u53d1\u8d77\u5bf9\u4e3b\u5b58\u7684\u5143\u6570\u636e\u52a0\u8f7d\u8bf7\u6c42\u3002</li> <li>Off-chip \u90e8\u5206 \u4e3b\u8981\u7531 Main Memory \u6784\u6210\uff0c\u5176\u4e2d\u5b58\u50a8\u4e86\u5b8c\u6574\u7684 16 KB-region PHT \u6570\u7ec4\u3002\u5f53\u7247\u4e0a\u7f13\u5b58\u672a\u547d\u4e2d\u4e14 Valid Map \u6807\u8bb0\u6709\u6548\u65f6\uff0c\u4f1a\u89e6\u53d1\u5bf9\u4e3b\u5b58\u7684\u8bbf\u95ee\u3002</li> <li>\u6570\u636e\u6d41\u5411\u660e\u786e\uff1aL2 cache \u7684\u8bbf\u95ee\u4e8b\u4ef6\u9a71\u52a8 Training Unit \u548c Lookup Units\uff1bPrediction Unit \u7684\u8f93\u51fa\u7ecf Region Arbitration \u540e\u8fdb\u5165 Prefetch Buffer\uff0c\u518d\u901a\u8fc7 TLB \u53d1\u9001\u81f3 LLC \u548c Main Memory\u3002</li> <li>\u6574\u4f53\u67b6\u6784\u4f53\u73b0\u4e86 \u201c\u7528\u5bb9\u91cf\u548c\u5e26\u5bbd\u6362\u5ef6\u8fdf\u201d \u7684\u8bbe\u8ba1\u7406\u5ff5\uff0c\u5c06\u5927\u91cf\u4e0d\u5e38\u8bbf\u95ee\u7684 16 KB \u6a21\u5f0f\u5378\u8f7d\u5230\u4e3b\u5b58\uff0c\u540c\u65f6\u5229\u7528\u7247\u4e0a\u9ad8\u901f\u7f13\u5b58\u4fdd\u8bc1\u5173\u952e\u8def\u5f84\u7684\u4f4e\u5ef6\u8fdf\u3002</li> <li>\u5173\u952e\u672f\u8bed\u5982 PHT, FT, AT, TLB, LLC, Valid Map, Inflight Prefetch Table \u5747\u5728\u56fe\u4e2d\u6e05\u6670\u6807\u6ce8\uff0c\u7b26\u5408\u8bba\u6587\u63cf\u8ff0\u3002</li> </ul> \u7ec4\u4ef6\u540d\u79f0 \u6240\u5c5e\u6a21\u5757 \u529f\u80fd\u7b80\u8ff0 Training Unit On-chip \u4ece L2 \u8bbf\u95ee\u4e8b\u4ef6\u4e2d\u5b66\u4e60\u5e76\u6784\u5efa\u5404\u533a\u57df\u7684\u4f4d\u5411\u91cf\u6a21\u5f0f\u3002 16 KB-region PHT Cache On-chip \u7247\u4e0a\u7f13\u5b58\uff0c\u5b58\u50a8\u9ad8\u9891\u8bbf\u95ee\u7684 16 KB \u533a\u57df\u6a21\u5f0f\u3002 4 KB-region PHT / 2 KB-region PHT On-chip \u5b58\u50a8\u5bf9\u5e94\u533a\u57df\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5b8c\u5168\u9a7b\u7559\u7247\u4e0a\u3002 Lookup Units On-chip \u6839\u636e\u89e6\u53d1\u6761\u4ef6\u67e5\u8be2 PHT\uff0c\u751f\u6210\u9884\u53d6\u8bf7\u6c42\u3002 Region Arbitration On-chip \u89e3\u51b3\u591a\u533a\u57df\u51b2\u7a81\uff0c\u9009\u62e9\u6700\u4f18\u9884\u53d6\u65b9\u6848\u3002 Inflight Prefetch Table On-chip \u8bb0\u5f55\u6b63\u5728\u8fdb\u884c\u7684\u9884\u53d6\uff0c\u9632\u6b62\u91cd\u53e0\u3002 16 KB-region Control On-chip \u7ba1\u7406 16 KB \u533a\u57df\u5143\u6570\u636e\u7684\u79bb\u7ebf\u8bfb\u5199\u3002 Valid Map On-chip \u6807\u8bb0\u4e3b\u5b58\u4e2d\u54ea\u4e9b 16 KB \u6a21\u5f0f\u662f\u6709\u6548\u7684\u3002 16 KB-region PHT (Main Memory) Off-chip \u5b58\u50a8\u6240\u6709 16 KB \u533a\u57df\u6a21\u5f0f\u7684\u4e3b\u6570\u7ec4\u3002 Prefetch Buffer On-chip \u7f13\u51b2\u5f85\u53d1\u51fa\u7684\u9884\u53d6\u6d41\u3002 TLB On-chip \u5904\u7406\u865a\u62df\u5730\u5740\u5230\u7269\u7406\u5730\u5740\u7684\u8f6c\u6362\u3002 LLC / Main Memory Off-chip \u6700\u7ec8\u6267\u884c\u9884\u53d6\u64cd\u4f5c\u7684\u76ee\u6807\u5b58\u50a8\u5c42\u7ea7\u3002"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-7-training-process-of-each-region","title":"Figure 7: Training process of each region","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RICH \u9884\u53d6\u5668\u4e2d\u6bcf\u4e2a\u533a\u57df\uff082KB\u30014KB\u300116KB\uff09\u7684\u8bad\u7ec3\u8fc7\u7a0b\uff0c\u6838\u5fc3\u673a\u5236\u57fa\u4e8e Filter Table (FT) \u548c Accumulation Table (AT) \u4e24\u4e2a\u8868\u534f\u540c\u5de5\u4f5c\u3002</li> <li>\u8bad\u7ec3\u6d41\u7a0b\u4ee5\u4e00\u4e2a (PC, 2 offsets) \u89e6\u53d1\u5668\u4e3a\u4f8b\uff0c\u56fe\u4e2d\u7528\u7f16\u53f7 (1) \u5230 (5) \u6807\u793a\u4e86\u5173\u952e\u6b65\u9aa4\uff1a</li> <li>(1) \u521d\u59cb\u8bbf\u95ee P+3\uff1a\u5f53\u7a0b\u5e8f\u9996\u6b21\u8bbf\u95ee\u67d0\u4e2a\u533a\u57df\u5185\u7684\u504f\u79fb\u91cf 3 \u65f6\uff0c\u8be5\u4fe1\u606f\u88ab\u8bb0\u5f55\u5728 FT \u4e2d\uff0c\u4f46\u6b64\u65f6\u4e0d\u542f\u52a8\u6a21\u5f0f\u5b66\u4e60\u3002</li> <li>(2) \u7b2c\u4e8c\u6b21\u8bbf\u95ee P+1\uff1a\u540e\u7eed\u8bbf\u95ee\u504f\u79fb\u91cf 1\uff0cFT \u518d\u6b21\u8bb0\u5f55\u3002\u6b64\u65f6\u7cfb\u7edf\u4ecd\u5904\u4e8e\u201c\u8fc7\u6ee4\u201d\u9636\u6bb5\uff0c\u7b49\u5f85\u66f4\u591a\u4e0d\u540c\u504f\u79fb\u91cf\u6765\u786e\u8ba4\u8bbf\u95ee\u6a21\u5f0f\u7684\u6709\u6548\u6027\u3002</li> <li>(3) \u7b2c\u4e09\u6b21\u8bbf\u95ee P+2\uff1a\u5f53\u89c2\u5bdf\u5230\u7b2c\u4e09\u4e2a\u4e0d\u540c\u7684\u504f\u79fb\u91cf\uff08\u6b64\u5904\u4e3a 2\uff09\u65f6\uff0cFT \u6761\u76ee\u88ab\u201c\u63d0\u5347\u201d\u81f3 AT\u3002AT \u521d\u59cb\u5316\u4e00\u4e2a\u4f4d\u5411\u91cf\uff08Pattern\uff09\uff0c\u5e76\u5f00\u59cb\u8bb0\u5f55\u6240\u6709\u5df2\u8bbf\u95ee\u7684\u504f\u79fb\u91cf\u3002</li> <li>(4) \u540e\u7eed\u8bbf\u95ee P+4\uff1a\u968f\u7740\u66f4\u591a\u8bbf\u95ee\u53d1\u751f\uff08\u5982\u504f\u79fb\u91cf 4\uff09\uff0cAT \u6301\u7eed\u66f4\u65b0\u5176\u4f4d\u5411\u91cf\uff0c\u5c06\u65b0\u8bbf\u95ee\u7684\u504f\u79fb\u4f4d\u7f6e\u4f4d\uff08\u4f8b\u5982\uff0c\u4ece <code>001110</code> \u66f4\u65b0\u4e3a <code>011110</code>\uff09\u3002</li> <li> <p>(5) \u533a\u57df\u9a71\u9010\uff1a\u5f53\u8be5\u533a\u57df\u88ab L2 \u7f13\u5b58\u9a71\u9010\u6216 AT \u8fbe\u5230\u5bb9\u91cf\u4e0a\u9650\u65f6\uff0c\u6700\u7ec8\u5f62\u6210\u7684\u5b8c\u6574\u6a21\u5f0f\u4f1a\u88ab\u4f20\u8f93\u81f3 Pattern History Table (PHT) \u7528\u4e8e\u540e\u7eed\u9884\u6d4b\u3002</p> </li> <li> <p>\u4e0b\u8868\u603b\u7ed3\u4e86 FT \u548c AT \u5728\u5404\u6b65\u9aa4\u4e2d\u7684\u72b6\u6001\u53d8\u5316\uff1a</p> </li> </ul> \u6b65\u9aa4 Filter Table (FT) \u72b6\u6001 Accumulation Table (AT) \u72b6\u6001 (1) \u8bb0\u5f55 PC \u548c\u504f\u79fb\u91cf 3 \u65e0\u6761\u76ee (2) \u8bb0\u5f55 PC \u548c\u504f\u79fb\u91cf 3\u30011 \u65e0\u6761\u76ee (3) \u5c06 PC/3,1 \u6761\u76ee\u63d0\u5347\u81f3 AT \u521b\u5efa\u65b0\u6761\u76ee\uff0cTag=P\uff0cTrigger=PC/3,1\uff0cPattern=001110 (4) \u4fdd\u6301\u4e0d\u53d8 \u66f4\u65b0 Pattern \u4e3a 011110 (5) \u4fdd\u6301\u4e0d\u53d8 \u5c06\u6700\u7ec8 Pattern \u4f20\u8f93\u81f3 PHT <ul> <li>\u5173\u952e\u8bbe\u8ba1\u70b9\uff1a</li> <li>\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\uff1a\u901a\u8fc7\u8981\u6c42\u81f3\u5c11\u89c2\u5bdf\u5230\u591a\u4e2a\u4e0d\u540c\u504f\u79fb\u91cf\uff08\u5982 2 \u6216 5 \u4e2a\uff09\uff0c\u6709\u6548\u8fc7\u6ee4\u6389\u566a\u58f0\u8bbf\u95ee\uff0c\u786e\u4fdd\u53ea\u6709\u7a33\u5b9a\u7684\u7a7a\u95f4\u5c40\u90e8\u6027\u6a21\u5f0f\u624d\u88ab\u5b66\u4e60\u3002</li> <li>\u5206\u9636\u6bb5\u5b66\u4e60\uff1aFT \u8d1f\u8d23\u521d\u6b65\u7b5b\u9009\uff0cAT \u8d1f\u8d23\u7cbe\u786e\u5efa\u6a21\uff0c\u8fd9\u79cd\u5206\u79bb\u8bbe\u8ba1\u964d\u4f4e\u4e86\u786c\u4ef6\u590d\u6742\u5ea6\u548c\u8bef\u5b66\u4e60\u98ce\u9669\u3002</li> <li>LRU \u66ff\u6362\u7b56\u7565\uff1a\u4e09\u4e2a\u533a\u57df\u7684 PHT \u5747\u91c7\u7528 LRU \u7b56\u7565\u7ba1\u7406\u6761\u76ee\uff0c\u4fdd\u8bc1\u5e38\u7528\u6a21\u5f0f\u4f18\u5148\u4fdd\u7559\u3002</li> <li>\u89e6\u53d1\u5668\u5b9a\u4e49\uff1a\u89e6\u53d1\u5668\u7531\u7a0b\u5e8f\u8ba1\u6570\u5668 (PC) \u548c\u4e00\u7ec4\u504f\u79fb\u91cf\u7ec4\u6210\uff0c\u662f\u8bc6\u522b\u7279\u5b9a\u8bbf\u95ee\u6a21\u5f0f\u7684\u5173\u952e\u6807\u8bc6\u7b26\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-8-the-region-arbitration-unit-selects-the-appropriate-region-to-prefetch-step-p3","title":"Figure 8: The Region Arbitration unit selects the appropriate region to prefetch (Step P3)","text":"<ul> <li>Region Arbitration \u5355\u5143\u8d1f\u8d23\u5728\u591a\u4e2a\u53ef\u80fd\u89e6\u53d1\u7684\u9884\u53d6\u533a\u57df\u4e2d\u9009\u62e9\u6700\u4f18\u7684\u4e00\u4e2a\uff0c\u4ee5\u907f\u514d\u91cd\u590d\u6216\u51b2\u7a81\u7684\u9884\u53d6\u64cd\u4f5c\u3002</li> <li>\u8be5\u5355\u5143\u63a5\u6536\u6765\u81ea 2KB\u30014KB \u548c 16KB PHTs \u7684\u67e5\u627e\u547d\u4e2d\u4fe1\u53f7\u4f5c\u4e3a\u8f93\u5165\uff0c\u542f\u52a8\u4f18\u5148\u7ea7\u4ef2\u88c1\u6d41\u7a0b\u3002</li> <li>Priority Selection \u6a21\u5757\u6839\u636e\u9884\u5b9a\u4e49\u7684\u4f18\u5148\u7ea7\u987a\u5e8f\u51b3\u5b9a\u54ea\u4e2a\u533a\u57df\u5e94\u88ab\u9009\u4e2d\uff1a</li> <li>\u6700\u9ad8\u4f18\u5148\u7ea7\uff1a2KB by (PC, address)</li> <li>\u5176\u6b21\uff1a16KB</li> <li>\u518d\u6b21\uff1a4KB</li> <li> <p>\u6700\u4f4e\uff1a2KB by (PC, offset)</p> </li> <li> <p>\u9009\u5b9a\u533a\u57df\u540e\uff0c\u7cfb\u7edf\u4f1a\u68c0\u67e5\u5176\u662f\u5426\u4e0e\u4efb\u4f55\u66f4\u9ad8\u4f18\u5148\u7ea7\u7684 Inflight Prefetch Region \u5b58\u5728\u91cd\u53e0\uff1a</p> </li> <li>\u82e5\u5b58\u5728\u91cd\u53e0\uff08Y\uff09\uff0c\u5219\u5f53\u524d\u8bf7\u6c42\u88ab Ignored\uff0c\u9632\u6b62\u5197\u4f59\u9884\u53d6\u3002</li> <li> <p>\u82e5\u65e0\u91cd\u53e0\uff08N\uff09\uff0c\u5219\u5141\u8bb8\u751f\u6210\u9884\u53d6\u8bf7\u6c42\u5e76\u9001\u5165 Prefetch Buffer\u3002</p> </li> <li> <p>Inflight Prefetch Table \u7528\u4e8e\u8ddf\u8e2a\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u9884\u53d6\u4efb\u52a1\uff0c\u5305\u542b\u4ee5\u4e0b\u5b57\u6bb5\uff1a   | Region number | Number of prefetches left | Region type             |   |---------------|---------------------------|-------------------------|   | 0x70          | 15                        | 2KB by (PC, address)    |   | 0x60          | 64                        | 16KB                    |   | ...           | ...                       | ...                     |</p> </li> <li> <p>\u8868\u683c\u4e2d\u7684\u6761\u76ee\u4f1a\u968f\u7740\u9884\u53d6\u8fdb\u5ea6\u52a8\u6001\u66f4\u65b0\uff0c\u5f53 \u201cNumber of prefetches left\u201d \u5f52\u96f6\u65f6\uff0c\u5bf9\u5e94\u6761\u76ee\u88ab\u79fb\u9664\u3002</p> </li> <li>\u6b64\u673a\u5236\u786e\u4fdd\u4e86\u9884\u53d6\u884c\u4e3a\u65e2\u9ad8\u6548\u53c8\u4e0d\u6d6a\u8d39\u5e26\u5bbd\uff0c\u5c24\u5176\u5728\u591a\u5c3a\u5ea6\u533a\u57df\u540c\u65f6\u6d3b\u8dc3\u65f6\uff0c\u80fd\u6709\u6548\u534f\u8c03\u8d44\u6e90\u5206\u914d\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#table-4-breakdown-of-on-chip-storage-overheads","title":"Table 4: Breakdown of on-chip storage overheads","text":"<ul> <li>Table 4 \u8be6\u7ec6\u5217\u51fa\u4e86 RICH prefetcher \u7684\u7247\u4e0a\u5b58\u50a8\u5f00\u9500\u5206\u89e3\uff0c\u6db5\u76d6\u591a\u4e2a\u6838\u5fc3\u7ec4\u4ef6\u7684\u4f4d\u5bbd\u3001\u6761\u76ee\u6570\u548c\u603b\u5b58\u50a8\u5bb9\u91cf\u3002</li> <li>\u5404\u7ed3\u6784\u7684\u5b58\u50a8\u5f00\u9500\u5982\u4e0b\u8868\u6240\u793a\uff1a</li> </ul> Structure Width (bits) Size (entries) Storage (KB) FTs (2, 4, 16 KB) 64, 64, 90 64, 64, 64 1.7 ATs (2, 4, 16 KB) 91, 106, 312 128, 128, 32 4.3 PHTs (2, 4 KB) 43, 71 4096, 1024 30.4 16 KB-region PHT Cache 271 256 8.5 Inflight Prefetch Table 48 6 0.05 16 KB-region Valid Map 1 4096 0.5 Prefetch Buffer 48 320 1.9 Total \u2014 \u2014 47.3 <ul> <li>FTs (Filter Tables)\uff1a\u7528\u4e8e\u8fc7\u6ee4\u566a\u58f0\u6a21\u5f0f\uff0c\u9488\u5bf9 2 KB\u30014 KB \u548c 16 KB \u533a\u57df\u5206\u522b\u914d\u7f6e\uff0c\u603b\u5360\u7528 1.7 KB\u3002</li> <li>ATs (Accumulation Tables)\uff1a\u7528\u4e8e\u7d2f\u79ef\u8bbf\u95ee\u8db3\u8ff9\u4ee5\u6784\u5efa\u9884\u53d6\u6a21\u5f0f\uff0c\u5176\u4f4d\u5bbd\u968f\u533a\u57df\u589e\u5927\u800c\u589e\u52a0\uff0c\u603b\u5360\u7528 4.3 KB\u3002</li> <li>PHTs (Pattern History Tables)\uff1a\u5b58\u50a8\u5b66\u4e60\u5230\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c2 KB \u548c 4 KB \u533a\u57df\u7684 PHT \u5360\u7528 30.4 KB\uff0c\u662f\u4e3b\u8981\u5f00\u9500\u6765\u6e90\u3002</li> <li>16 KB-region PHT Cache\uff1a\u4f5c\u4e3a\u7247\u4e0a\u7f13\u5b58\uff0c\u4ec5\u4fdd\u7559\u9ad8\u9891\u6a21\u5f0f\uff0c256 \u6761\u76ee\u5360\u7528 8.5 KB\u3002</li> <li>Inflight Prefetch Table\uff1a\u8ffd\u8e2a\u6b63\u5728\u8fdb\u884c\u7684\u9884\u53d6\u8bf7\u6c42\uff0c6 \u6761\u76ee\u4ec5\u5360 0.05 KB\u3002</li> <li>16 KB-region Valid Map\uff1a\u6807\u8bb0\u54ea\u4e9b 16 KB \u6a21\u5f0f\u5b58\u5728\u4e8e\u7247\u5916\uff0c4096 \u4f4d\uff08\u5373 512 \u5b57\u8282\uff09\u5360\u7528 0.5 KB\u3002</li> <li>Prefetch Buffer\uff1a\u7f13\u51b2\u9884\u53d6\u8bf7\u6c42\uff0c320 \u6761\u76ee\u5360\u7528 1.9 KB\u3002</li> <li>\u603b\u4f53\u6765\u770b\uff0cRICH \u7684\u7247\u4e0a\u5b58\u50a8\u5f00\u9500\u4e3a 47.3 KB\uff0c\u663e\u8457\u4f4e\u4e8e Bingo \u7684 127 KB\uff0c\u4f53\u73b0\u4e86\u5176\u5728\u9762\u79ef\u6548\u7387\u4e0a\u7684\u4f18\u52bf\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#table-5-simulated-system","title":"Table 5: Simulated system","text":"<ul> <li>\u8be5\u8868\u683c\u8be6\u7ec6\u5217\u51fa\u4e86\u8bba\u6587\u4e2d\u7528\u4e8e\u8bc4\u4f30 RICH prefetcher \u7684\u6a21\u62df\u7cfb\u7edf\u914d\u7f6e\uff0c\u6db5\u76d6\u4e86\u4ece\u6838\u5fc3\u5fae\u67b6\u6784\u5230\u4e3b\u5b58\u7684\u5404\u4e2a\u5c42\u7ea7\u3002</li> <li> <p>\u6838\u5fc3\uff08Core\uff09\u90e8\u5206\u63cf\u8ff0\u4e86\u5904\u7406\u5668\u7684\u524d\u7aef\u548c\u6267\u884c\u5355\u5143\uff1a</p> <ul> <li>8-wide fetch \u548c 6-wide decode/dispatch \u8868\u660e\u5176\u5177\u5907\u5bbd\u53d1\u5c04\u80fd\u529b\u3002</li> <li>\u62e5\u6709 512-entry ROB\uff08Reorder Buffer\uff09\u548c 192/114-entry LQ/SQ\uff08Load/Store Queue\uff09\uff0c\u652f\u6301\u5927\u91cf\u4e71\u5e8f\u6307\u4ee4\u3002</li> <li>\u91c7\u7528 Perceptron branch predictor\uff0c\u5e76\u8bbe\u5b9a 17-cycle misprediction penalty\uff0c\u53cd\u6620\u5176\u5206\u652f\u9884\u6d4b\u673a\u5236\u53ca\u60e9\u7f5a\u5f00\u9500\u3002</li> </ul> </li> <li> <p>\u4e00\u7ea7\u7f13\u5b58\uff08L1 Cache\uff09\u5206\u4e3a\u6307\u4ee4\u7f13\u5b58\uff08L1-I\uff09\u548c\u6570\u636e\u7f13\u5b58\uff08L1-D\uff09\uff1a</p> <ul> <li>L1-I Cache\uff1a\u79c1\u6709\uff0c\u5bb9\u91cf\u4e3a 32KB\uff0c\u7ec4\u7ec7\u65b9\u5f0f\u4e3a 8-way set associative\uff0c\u884c\u5927\u5c0f 64B\uff0c\u5f80\u8fd4\u5ef6\u8fdf 4 cycles\uff0c\u62e5\u6709 8 MSHRs\uff08Miss Status Holding Registers\uff09\u3002</li> <li>L1-D Cache\uff1a\u79c1\u6709\uff0c\u5bb9\u91cf\u4e3a 48KB\uff0c\u7ec4\u7ec7\u65b9\u5f0f\u4e3a 12-way set associative\uff0c\u884c\u5927\u5c0f 64B\uff0c\u5f80\u8fd4\u5ef6\u8fdf 5 cycles\uff0c\u62e5\u6709 16 MSHRs\u3002</li> </ul> </li> <li> <p>\u4e8c\u7ea7\u7f13\u5b58\uff08L2 Cache\uff09\u914d\u7f6e\u5982\u4e0b\uff1a</p> <ul> <li>\u79c1\u6709\uff0c\u5bb9\u91cf\u4e3a 1.25MB\uff0c\u7ec4\u7ec7\u65b9\u5f0f\u4e3a 20-way set associative\uff0c\u884c\u5927\u5c0f 64B\uff0c\u5f80\u8fd4\u5ef6\u8fdf 15 cycles\uff0c\u62e5\u6709 48 MSHRs\u3002</li> </ul> </li> <li> <p>\u6700\u540e\u4e00\u7ea7\u7f13\u5b58\uff08LLC, Last Level Cache\uff09\uff1a</p> <ul> <li>\u5bb9\u91cf\u4e3a 3MB/core\uff0c\u7ec4\u7ec7\u65b9\u5f0f\u4e3a 12-way set associative\uff0c\u884c\u5927\u5c0f 64B\uff0c\u5f80\u8fd4\u5ef6\u8fdf 55 cycles\uff0c\u62e5\u6709 64 MSHRs\u3002</li> </ul> </li> <li> <p>\u4e3b\u5b58\uff08Main Memory\uff09\u914d\u7f6e\u6839\u636e\u901a\u9053\u6570\u4e0d\u540c\u800c\u5f02\uff1a</p> <ul> <li>1C (Single Channel)\uff1a\u5355\u901a\u9053\uff0c\u6bcf\u901a\u9053 1 rank\u3002</li> <li>4C (Dual Channel)\uff1a\u53cc\u901a\u9053\uff0c\u6bcf\u901a\u9053 2 ranks\u3002</li> <li>\u4f7f\u7528 DDR5-4800 MTPS \u5185\u5b58\u6807\u51c6\uff0c\u6bcf\u901a\u9053\u6570\u636e\u603b\u7ebf\u5bbd\u5ea6\u4e3a 64-bit\u3002</li> <li>\u5173\u952e\u65f6\u5e8f\u53c2\u6570\uff1atRCD = tRP = tCAS = 16.6ns\uff0c\u8fd9\u4e9b\u53c2\u6570\u76f4\u63a5\u5f71\u54cd\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> </ul> </li> </ul> \u7ec4\u4ef6 \u914d\u7f6e\u8be6\u60c5 Core 8-wide fetch, 6-wide decode/dispatch, 512-entry ROB, 192/114-entry LQ/SQ, Perceptron branch predictor with 17-cycle misprediction penalty L1-I Cache Private, 32KB (8-way, 64B line), 4-cycle round-trip latency, 8 MSHRs L1-D Cache Private, 48KB (12-way, 64B line), 5-cycle round-trip latency, 16 MSHRs L2 Cache Private, 1.25MB (20-way, 64B line), 15-cycle round-trip latency, 48 MSHRs LLC 3MB/core (12-way, 64B line), 55-cycle round-trip latency, 64 MSHRs Main Memory 1C: Single channel, 1 rank/channel; 4C: Dual channel, 2 ranks/channel. DDR5-4800 MTPS, 64-bit data bus per channel, tRCD=tRP=tCAS=16.6ns <ul> <li>\u6574\u4f53\u6765\u770b\uff0c\u8be5\u6a21\u62df\u7cfb\u7edf\u57fa\u4e8e\u73b0\u4ee3\u9ad8\u6027\u80fd\u5904\u7406\u5668\u8bbe\u8ba1\uff0c\u7279\u522b\u662f\u53c2\u8003\u4e86 Intel Alder Lake \u7684\u6027\u80fd\u6838\u5fc3\uff08P-Core\uff09\u67b6\u6784\uff0c\u65e8\u5728\u771f\u5b9e\u53cd\u6620\u5f53\u524d\u4e3b\u6d41\u786c\u4ef6\u73af\u5883\u4e0b\u7684 prefetcher \u6027\u80fd\u8868\u73b0\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#table-6-comparison-of-area-overheads","title":"Table 6: Comparison of area overheads","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u8bba\u6587\u4e2d\u7684 Table 6: Comparison of area overheads\uff0c\u7528\u4e8e\u5bf9\u6bd4\u4e0d\u540c\u786c\u4ef6\u9884\u53d6\u5668\uff08prefetcher\uff09\u7684\u5b58\u50a8\u5f00\u9500\u3002</li> <li>\u8868\u683c\u6a2a\u5411\u5217\u51fa\u4e94\u79cd\u9884\u53d6\u5668\uff1aBingo\u3001PMP\u3001SPP-PPF\u3001SMS \u548c RICH\u3002</li> <li>\u5404\u9884\u53d6\u5668\u5bf9\u5e94\u7684\u9762\u79ef\u5f00\u9500\u5982\u4e0b\uff1a</li> </ul> Prefetcher Area Overhead Bingo 127.8 KB PMP 4.3 KB SPP-PPF 48.4 KB SMS 116.6 KB RICH 47.3 KB on-chip, 128 KB off-chip <ul> <li>RICH \u7684\u8bbe\u8ba1\u91c7\u7528\u5206\u5c42\u5b58\u50a8\u7b56\u7565\uff1a\u5c06\u9ad8\u9891\u8bbf\u95ee\u6a21\u5f0f\u4fdd\u7559\u5728\u7247\u4e0a\uff08on-chip\uff09\uff0c\u4f4e\u9891\u6a21\u5f0f\u5378\u8f7d\u81f3\u7247\u5916\u4e3b\u5b58\uff08off-chip\uff09\uff0c\u4ece\u800c\u5728\u63a7\u5236\u603b\u5f00\u9500\u7684\u540c\u65f6\u63d0\u5347\u6027\u80fd\u3002</li> <li>\u76f8\u8f83\u4e8e Bingo \u548c SMS \u7b49\u4f20\u7edf\u9884\u53d6\u5668\uff0cRICH \u7684\u7247\u4e0a\u5f00\u9500\u663e\u8457\u964d\u4f4e\uff08\u4ece 127.8 KB / 116.6 KB \u964d\u81f3 47.3 KB\uff09\uff0c\u4f46\u901a\u8fc7\u5f15\u5165 128 KB \u7247\u5916\u5b58\u50a8\u6362\u53d6\u66f4\u4e30\u5bcc\u7684\u5143\u6570\u636e\u652f\u6301\u3002</li> <li>PMP \u867d\u7136\u7247\u4e0a\u5f00\u9500\u6700\u5c0f\uff08\u4ec5 4.3 KB\uff09\uff0c\u4f46\u5176\u8986\u76d6\u5ea6\u548c\u53ca\u65f6\u6027\u53d7\u9650\uff0c\u6027\u80fd\u4e0d\u53ca RICH\u3002</li> <li>SPP-PPF \u5f00\u9500\u5c45\u4e2d\uff0848.4 KB\uff09\uff0c\u4f46\u5176\u57fa\u4e8e delta \u5e8f\u5217\u7684\u673a\u5236\u5728\u9ad8\u5e26\u5bbd\u573a\u666f\u4e0b\u6269\u5c55\u6027\u4e0d\u8db3\u3002</li> <li>\u6b64\u8868\u51f8\u663e RICH \u5728\u201c\u6027\u80fd-\u5f00\u9500\u201d\u6743\u8861\u4e0a\u7684\u521b\u65b0\uff1a\u4ee5\u53ef\u63a7\u7684\u7247\u5916\u5b58\u50a8\u4ee3\u4ef7\uff0c\u6362\u53d6\u66f4\u4f18\u7684\u9884\u53d6\u51c6\u786e\u7387\u4e0e\u8986\u76d6\u8303\u56f4\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#table-7-workloads-used-for-evaluation","title":"Table 7: Workloads used for evaluation","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u8bba\u6587\u4e2d\u7684 Table 7\uff0c\u6807\u9898\u4e3a \u201cWorkloads used for evaluation\u201d\uff0c\u7528\u4e8e\u8bf4\u660e\u5b9e\u9a8c\u6240\u4f7f\u7528\u7684\u57fa\u51c6\u6d4b\u8bd5\u96c6\u6784\u6210\u3002</li> <li>\u8868\u683c\u5305\u542b\u4e09\u5217\uff1aSuite\uff08\u6d4b\u8bd5\u5957\u4ef6\uff09\u3001Count\uff08\u5de5\u4f5c\u8d1f\u8f7d\u6570\u91cf\uff09\u3001Example workloads\uff08\u793a\u4f8b\u5de5\u4f5c\u8d1f\u8f7d\uff09\u3002</li> <li>\u5177\u4f53\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> Suite Count Example workloads SPEC06 46 gcc, bwaves, mcf, leslie3d, GemsFDTD SPEC17 42 gcc, bwaves, mcf, cactuBSSN, lbm Ligra 40 Bellman-ford, Triangle, Radii, PageRank Parsec 12 canneal, fluidanimate, streamcluster <ul> <li>\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u5747\u6765\u81ea\u4e3b\u6d41\u57fa\u51c6\u6d4b\u8bd5\u96c6\uff0c\u5305\u62ec SPEC CPU 2006\u3001SPEC CPU 2017\u3001Ligra \u548c Parsec\u3002</li> <li>\u5b9e\u9a8c\u4e2d\u6392\u9664\u4e86 L2 \u7f13\u5b58\u6bcf\u5343\u6761\u6307\u4ee4\u7f3a\u5931\u7387\uff08MPKI\uff09\u4f4e\u4e8e 2 \u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u56e0\u5176\u53d7\u5185\u5b58\u5ef6\u8fdf\u5f71\u54cd\u8f83\u5c0f\u3002</li> <li>\u603b\u8ba1\u4f7f\u7528 140+ \u4e2a trace \u8fdb\u884c\u5355\u6838\u6027\u80fd\u8bc4\u4f30\uff0c\u6db5\u76d6\u8ba1\u7b97\u5bc6\u96c6\u578b\u3001\u56fe\u5904\u7406\u548c\u591a\u7ebf\u7a0b\u5e94\u7528\u7b49\u591a\u79cd\u573a\u666f\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-9-rich-outperforms-bingo-across-four-benchmark-suites-on-a-single-core-system","title":"Figure 9: RICH outperforms Bingo across four benchmark suites on a single-core system","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u5355\u6838\u7cfb\u7edf\u4e0b\uff0cRICH \u9884\u53d6\u5668\u4e0e\u5176\u4ed6\u56db\u79cd\u9884\u53d6\u5668\uff08SPP-PPF\u3001SMS\u3001Bingo\u3001PMP\uff09\u5728\u56db\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6\uff08SPEC17\u3001SPEC06\u3001Ligra\u3001Parsec\uff09\u4e0a\u7684\u6027\u80fd\u5bf9\u6bd4\uff0c\u4ee5\u201c\u65e0\u9884\u53d6\u201d\u4e3a\u57fa\u51c6\uff081.0\uff09\uff0c\u8861\u91cf\u5404\u9884\u53d6\u5668\u5e26\u6765\u7684\u52a0\u901f\u6bd4\u3002</li> <li>RICH \u5728\u6240\u6709\u56db\u4e2a\u57fa\u51c6\u5957\u4ef6\u4e2d\u5747\u53d6\u5f97\u6700\u9ad8\u52a0\u901f\u6bd4\uff0c\u9a8c\u8bc1\u4e86\u5176\u8bbe\u8ba1\u5728\u591a\u7c7b\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\u7684\u666e\u9002\u6027\u4f18\u52bf\u3002</li> <li>\u5404\u57fa\u51c6\u5957\u4ef6\u5177\u4f53\u8868\u73b0\u5982\u4e0b\uff1a</li> </ul> \u57fa\u51c6\u5957\u4ef6 SPP-PPF SMS Bingo PMP RICH SPEC17 ~1.15 ~1.20 ~1.20 ~1.22 ~1.28 SPEC06 ~1.40 ~1.48 ~1.45 ~1.48 ~1.55 Ligra ~1.35 ~1.38 ~1.38 ~1.39 ~1.43 Parsec ~1.05 ~1.08 ~1.07 ~1.08 ~1.10 <ul> <li>\u5728 GEOMEAN\uff08\u51e0\u4f55\u5e73\u5747\uff09 \u6c47\u603b\u6307\u6807\u4e0a\uff0cRICH \u8fbe\u5230\u7ea6 1.40\uff0c\u663e\u8457\u9886\u5148\u4e8e Bingo\uff08~1.35\uff09\u548c PMP\uff08~1.36\uff09\uff0c\u8868\u660e\u5176\u7efc\u5408\u6027\u80fd\u6700\u4f18\u3002</li> <li>\u4ece\u56fe\u4e2d\u53ef\u89c1\uff0cBingo \u548c PMP \u6027\u80fd\u63a5\u8fd1\uff0c\u4f46 RICH \u59cb\u7ec8\u8d85\u8d8a\u4e8c\u8005\uff1bSPP-PPF \u5728 SPEC06 \u4e0a\u8868\u73b0\u7a81\u51fa\uff0c\u4f46\u5728\u5176\u4ed6\u5957\u4ef6\u4e2d\u76f8\u5bf9\u843d\u540e\u3002</li> <li>\u6b64\u56fe\u76f4\u63a5\u652f\u6301\u8bba\u6587\u6838\u5fc3\u7ed3\u8bba\uff1aRICH \u5728\u5355\u6838\u73af\u5883\u4e0b\u5e73\u5747\u4f18\u4e8e Bingo 3.4%\uff0c\u4f53\u73b0\u4e86\u5176\u591a\u533a\u57df\u3001\u591a\u89e6\u53d1\u673a\u5236\u5728\u5b9e\u9645\u8d1f\u8f7d\u4e2d\u7684\u6709\u6548\u6027\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-10-rich-improves-coverage-and-timeliness-while-maintaining-comparable-accuracy","title":"Figure 10: RICH improves coverage and timeliness while maintaining comparable accuracy","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a\u201cFigure 10: RICH improves coverage and timeliness while maintaining comparable accuracy\u201d\uff0c\u65e8\u5728\u5bf9\u6bd4 RICH \u4e0e\u5176\u4ed6\u4e3b\u6d41 prefetcher \u5728 Accuracy\u3001Coverage \u548c Timeliness \u4e09\u4e2a\u6838\u5fc3\u6307\u6807\u4e0a\u7684\u8868\u73b0\u3002</li> <li>\u56fe\u8868\u6a2a\u8f74\u4e3a\u4e09\u9879\u6027\u80fd\u6307\u6807\uff1aAccuracy\u3001Coverage\u3001Timeliness\uff1b\u7eb5\u8f74\u4e3a\u767e\u5206\u6bd4\uff0c\u8303\u56f4\u4ece 0% \u5230 100%\u3002</li> <li>\u56fe\u4f8b\u5305\u542b\u4e94\u79cd prefetcher\uff1aSPP-PPF\uff08\u6a59\u8272\u659c\u7ebf\uff09\u3001SMS\uff08\u6a59\u8272\u70b9\u72b6\uff09\u3001Bingo\uff08\u84dd\u8272\u7f51\u683c\uff09\u3001PMP\uff08\u6d45\u84dd\u659c\u7ebf\uff09\u3001RICH\uff08\u9ec4\u8272\u5b9e\u5fc3\uff09\u3002</li> <li>RICH \u5728 Coverage \u548c Timeliness \u4e0a\u663e\u8457\u9886\u5148\uff0c\u5728 Accuracy \u4e0a\u4e0e Bingo \u76f8\u5f53\uff0c\u4f18\u4e8e PMP\u3002</li> <li>\u5177\u4f53\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> Prefetcher Accuracy (%) Coverage (%) Timeliness (%) SPP-PPF ~70 ~55 ~65 SMS ~70 ~60 ~70 Bingo 76.6 64 78 PMP ~70 69 80 RICH 76.3 75 91 <ul> <li>Coverage \u65b9\u9762\uff1aRICH \u8fbe\u5230 75%\uff0c\u6bd4 Bingo \u9ad8\u51fa 11%\uff0c\u6bd4 PMP \u9ad8\u51fa 6.2%\uff0c\u4f53\u73b0\u5176\u591a\u533a\u57df+\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u5bf9\u590d\u6742\u8bbf\u95ee\u6a21\u5f0f\u7684\u6355\u6349\u80fd\u529b\u3002</li> <li>Timeliness \u65b9\u9762\uff1aRICH \u8fbe\u5230 91%\uff0c\u6bd4 Bingo \u9ad8\u51fa 13%\uff0c\u6bd4 PMP \u9ad8\u51fa 11%\uff0c\u53cd\u6620\u5176\u5927\u533a\u57df\u9884\u53d6\u7b56\u7565\u6709\u6548\u63d0\u524d\u586b\u5145\u7f13\u5b58\u3002</li> <li>Accuracy \u65b9\u9762\uff1aRICH \u4e3a 76.3%\uff0c\u4e0e Bingo \u7684 76.6% \u51e0\u4e4e\u6301\u5e73\uff0c\u7565\u4f4e\u4e8e Bingo\uff0c\u4f46\u8fdc\u9ad8\u4e8e\u5176\u4ed6\u65b9\u6848\uff0c\u8bf4\u660e\u5176\u591a\u504f\u79fb\u9a8c\u8bc1\u673a\u5236\u6709\u6548\u63a7\u5236\u8bef\u9884\u53d6\u3002</li> <li>\u7efc\u5408\u6765\u770b\uff0cRICH \u901a\u8fc7\u727a\u7272\u5c11\u91cf Accuracy \u6362\u53d6\u5927\u5e45 Coverage \u548c Timeliness \u63d0\u5347\uff0c\u5b9e\u73b0\u6574\u4f53\u6027\u80fd\u6700\u4f18\uff0c\u7b26\u5408\u5176\u201c\u7528\u5bb9\u91cf\u548c\u5e26\u5bbd\u6362\u5ef6\u8fdf\u9690\u85cf\u201d\u7684\u8bbe\u8ba1\u54f2\u5b66\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-11-detailed-speedup-achieved-by-bingo-pmp-and-rich-on-representative-traces","title":"Figure 11: Detailed speedup achieved by Bingo, PMP and RICH on representative traces","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Figure 11\uff0c\u6807\u9898\u4e3a\u201cDetailed speedup achieved by Bingo, PMP and RICH on representative traces\u201d\uff0c\u7528\u4e8e\u6bd4\u8f83\u4e09\u79cd\u9884\u53d6\u5668\u5728\u591a\u4e2a\u4ee3\u8868\u6027\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u7684\u6027\u80fd\u52a0\u901f\u6bd4\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u4e86 40 \u4e2a SPEC CPU\u3001Ligra \u548c Parsec \u5de5\u4f5c\u8d1f\u8f7d\u7684\u7f29\u5199\u540d\u79f0\uff0c\u5982 <code>602.gcc-754</code>\u3001<code>603.bwaves-891</code>\u3001<code>459.GemsFDTD-765B</code> \u7b49\uff0c\u8986\u76d6\u4e86\u79d1\u5b66\u8ba1\u7b97\u3001\u7f16\u8bd1\u5668\u3001\u56fe\u5f62\u5904\u7406\u7b49\u573a\u666f\u3002</li> <li>\u7eb5\u8f74\u8868\u793a\u201cSpeedup over no prefetching\u201d\uff0c\u5373\u76f8\u5bf9\u4e8e\u65e0\u9884\u53d6\u57fa\u7ebf\u7684\u6027\u80fd\u52a0\u901f\u500d\u6570\uff0c\u8303\u56f4\u4ece 0 \u5230 3.8\u3002</li> <li>\u56fe\u4e2d\u4f7f\u7528\u4e09\u79cd\u989c\u8272\u67f1\u72b6\u56fe\u5206\u522b\u4ee3\u8868\uff1a</li> <li>\u84dd\u8272\uff1aPMP</li> <li>\u6a59\u8272\uff1aBingo</li> <li>\u9ec4\u8272\uff1aRICH</li> <li>\u5728\u7edd\u5927\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0cRICH \u7684\u52a0\u901f\u6bd4\u9ad8\u4e8e Bingo \u548c PMP\uff0c\u8868\u660e\u5176\u7efc\u5408\u6027\u80fd\u66f4\u4f18\u3002</li> <li>\u90e8\u5206\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0cRICH \u7684\u52a0\u901f\u6bd4\u663e\u8457\u9886\u5148\uff0c\u4f8b\u5982\uff1a</li> <li><code>603.bwaves-891</code>\uff1aRICH \u8fbe\u5230 3.8\uff0cBingo \u4e3a 3.6\uff0cPMP \u4e3a 2.5</li> <li><code>601.bwaves-1740</code>\uff1aRICH \u8fbe\u5230 4.8\uff0cBingo \u4e3a 3.8\uff0cPMP \u4e3a 2.8</li> <li><code>459.GemsFDTD-765B</code>\uff1aRICH \u8fbe\u5230 4.8\uff0cBingo \u4e3a 3.6\uff0cPMP \u4e3a 2.5</li> <li>\u5728\u5c11\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff08\u5982 <code>605.mcf-782</code>\u3001<code>605.mcf-1152</code>\uff09\uff0c\u4e09\u8005\u6027\u80fd\u63a5\u8fd1\uff0c\u4f46 RICH \u4ecd\u4fdd\u6301\u5fae\u5f31\u4f18\u52bf\u3002</li> <li>\u6570\u636e\u8868\u683c\u5316\u5982\u4e0b\uff1a</li> </ul> Workload PMP Speedup Bingo Speedup RICH Speedup 602.gcc-754 ~1.5 ~1.6 ~1.7 603.bwaves-891 ~2.5 ~3.6 3.8 601.bwaves-1740 ~2.8 ~3.8 4.8 459.GemsFDTD-765B ~2.5 ~3.6 4.8 654.roms-294 ~1.8 ~2.0 ~2.1 482.sphinx3-1297 ~1.6 ~1.7 ~1.8 <ul> <li>\u5173\u952e\u7ed3\u8bba\uff1aRICH \u5728\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5b9e\u73b0\u4e86\u6700\u9ad8\u52a0\u901f\u6bd4\uff0c\u5c24\u5176\u5728\u5177\u6709\u8de8\u9875\u7a7a\u95f4\u5c40\u90e8\u6027\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982 <code>603.bwaves</code>\u3001<code>459.GemsFDTD</code>\uff09\u4e2d\u8868\u73b0\u7a81\u51fa\uff0c\u9a8c\u8bc1\u4e86\u5176\u591a\u533a\u57df\u3001\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u7684\u6709\u6548\u6027\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-12-each-region-makes-a-significant-contribution-to-prefetchingand-we-achieve-a-significant-reduction-in-amat","title":"Figure 12: Each region makes a significant contribution to prefetching,and we achieve a significant reduction in AMAT","text":"<ul> <li>\u56fe\u7247\u5305\u542b\u4e24\u4e2a\u5b50\u56fe\uff0c\u5206\u522b\u5c55\u793a RICH prefetcher \u5728\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\u7684\u533a\u57df\u8d21\u732e\u548c\u5e73\u5747\u7f3a\u5931\u8bbf\u95ee\u65f6\u95f4\uff08AMAT\uff09\u8868\u73b0\u3002</li> <li>\u5b50\u56fe a) \u6807\u9898\u4e3a\u201cContribution of Each Region to Prefetch Coverage\u201d\uff0c\u663e\u793a\u4e86 2 KB-region\u30014 KB-region \u548c 16 KB-region \u5728\u56db\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6\uff08Parsec\u3001Ligra\u3001SPEC06\u3001SPEC17\uff09\u4e2d\u7684\u8986\u76d6\u8d21\u732e\u6bd4\u4f8b\u3002</li> <li>Parsec\uff1a2 KB-region \u7ea6\u5360 0.5\uff0c4 KB-region \u7ea6\u5360 0.2\uff0c16 KB-region \u7ea6\u5360 0.3\u3002</li> <li>Ligra\uff1a2 KB-region \u7ea6\u5360 0.3\uff0c4 KB-region \u7ea6\u5360 0.2\uff0c16 KB-region \u7ea6\u5360 0.5\u3002</li> <li>SPEC06\uff1a2 KB-region \u7ea6\u5360 0.4\uff0c4 KB-region \u7ea6\u5360 0.2\uff0c16 KB-region \u7ea6\u5360 0.4\u3002</li> <li>SPEC17\uff1a2 KB-region \u7ea6\u5360 0.3\uff0c4 KB-region \u7ea6\u5360 0.2\uff0c16 KB-region \u7ea6\u5360 0.5\u3002</li> <li>\u5b50\u56fe b) \u6807\u9898\u4e3a\u201cAverage Miss Access Time (AMAT) (cycles)\u201d\uff0c\u6bd4\u8f83\u4e86\u4e09\u79cd prefetcher\uff08PMP\u3001Bingo\u3001RICH\uff09\u5728 L1D\u3001L2C\u3001LLC \u548c Main Memory \u5c42\u7ea7\u4e0a\u7684 AMAT\u3002</li> <li>PMP\uff1aL1D \u7ea6 5 cycles\uff0cL2C \u7ea6 5 cycles\uff0cLLC \u7ea6 10 cycles\uff0cMain Memory \u7ea6 30 cycles\uff0c\u603b\u8ba1\u7ea6 50 cycles\u3002</li> <li>Bingo\uff1aL1D \u7ea6 5 cycles\uff0cL2C \u7ea6 5 cycles\uff0cLLC \u7ea6 10 cycles\uff0cMain Memory \u7ea6 25 cycles\uff0c\u603b\u8ba1\u7ea6 45 cycles\u3002</li> <li>RICH\uff1aL1D \u7ea6 5 cycles\uff0cL2C \u7ea6 5 cycles\uff0cLLC \u7ea6 5 cycles\uff0cMain Memory \u7ea6 20 cycles\uff0c\u603b\u8ba1\u7ea6 35 cycles\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0cRICH \u5728\u6240\u6709\u5c42\u7ea7\u4e0a\u5747\u5b9e\u73b0\u4e86\u6700\u4f4e\u7684 AMAT\uff0c\u5c24\u5176\u5728 Main Memory \u5c42\u7ea7\u663e\u8457\u4f18\u4e8e Bingo \u548c PMP\u3002</li> <li>\u5404\u533a\u57df\u5bf9\u8986\u76d6\u7684\u8d21\u732e\u56e0\u5de5\u4f5c\u8d1f\u8f7d\u800c\u5f02\uff0c\u8bf4\u660e RICH \u7684\u591a\u533a\u57df\u8bbe\u8ba1\u80fd\u81ea\u9002\u5e94\u4e0d\u540c\u7a0b\u5e8f\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li>\u7efc\u5408\u6765\u770b\uff0cRICH \u901a\u8fc7\u6709\u6548\u5229\u7528\u591a\u5c3a\u5ea6\u533a\u57df\u548c\u5206\u5c42\u5b58\u50a8\u7b56\u7565\uff0c\u5728\u4fdd\u6301\u9ad8\u51c6\u786e\u7387\u7684\u540c\u65f6\u663e\u8457\u63d0\u5347\u8986\u76d6\u548c\u53ca\u65f6\u6027\uff0c\u4ece\u800c\u964d\u4f4e\u6574\u4f53\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-13-rich-demonstrates-greater-performance-gains-compared-to-bingo-and-pmp-as-memory-latency-increases-highlighting-its-potential-for-future-high-latency-systems","title":"Figure 13: RICH demonstrates greater performance gains compared to Bingo and PMP as memory latency increases, highlighting its potential for future high-latency systems","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 RICH prefetcher \u76f8\u8f83\u4e8e Bingo \u548c PMP \u5728\u4e0d\u540c\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\u4e0b\u7684\u6027\u80fd\u589e\u76ca\uff0c\u6a2a\u8f74\u4e3a\u989d\u5916\u589e\u52a0\u7684\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\uff080ns \u81f3 120ns\uff09\uff0c\u7eb5\u8f74\u4e3a\u6027\u80fd\u63d0\u5347\u767e\u5206\u6bd4\u3002</li> <li>RICH vs Bingo \u7684\u6027\u80fd\u589e\u76ca\u968f\u5ef6\u8fdf\u589e\u52a0\u5448\u7ebf\u6027\u4e0a\u5347\u8d8b\u52bf\uff0c\u4ece 0ns \u65f6\u7684\u7ea6 3.4% \u589e\u957f\u81f3 120ns \u65f6\u7684 8.3%\uff0c\u8868\u660e RICH \u5728\u9ad8\u5ef6\u8fdf\u7cfb\u7edf\u4e2d\u4f18\u52bf\u663e\u8457\u3002</li> <li>RICH vs PMP \u7684\u6027\u80fd\u589e\u76ca\u589e\u957f\u8f83\u5e73\u7f13\uff0c\u4ece 0ns \u65f6\u7ea6 4.4% \u4e0a\u5347\u81f3 120ns \u65f6\u7684 6.2%\uff0c\u8bf4\u660e RICH \u5bf9 PMP \u7684\u9886\u5148\u5e45\u5ea6\u5728\u9ad8\u5ef6\u8fdf\u4e0b\u4ecd\u6301\u7eed\u6269\u5927\u3002</li> <li>\u6570\u636e\u70b9\u5206\u5e03\u663e\u793a\uff0c\u968f\u7740\u5ef6\u8fdf\u589e\u52a0\uff0cRICH \u7684\u76f8\u5bf9\u4f18\u52bf\u6108\u53d1\u660e\u663e\uff0c\u5370\u8bc1\u5176\u8bbe\u8ba1\u521d\u8877\u2014\u2014\u901a\u8fc7\u5229\u7528\u4e30\u5bcc\u5143\u6570\u636e\u548c\u591a\u5c3a\u5ea6\u533a\u57df\u9884\u53d6\u673a\u5236\u6709\u6548\u63a9\u76d6\u9ad8\u5ef6\u8fdf\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5173\u952e\u5ef6\u8fdf\u70b9\u5bf9\u5e94\u7684\u6027\u80fd\u589e\u76ca\uff1a</li> </ul> \u989d\u5916\u5ef6\u8fdf RICH vs Bingo RICH vs PMP 0ns ~3.4% ~4.4% 30ns ~5.0% ~4.8% 60ns ~6.0% ~5.2% 90ns ~7.0% ~5.8% 120ns 8.3% 6.2% <ul> <li>\u56fe\u8868\u6807\u9898\u660e\u786e\u6307\u51fa\uff1aRICH \u5728\u9ad8\u5ef6\u8fdf\u7cfb\u7edf\u4e2d\u8868\u73b0\u66f4\u4f18\uff0c\u51f8\u663e\u5176\u9762\u5411\u672a\u6765\u5185\u5b58\u67b6\u6784\uff08\u5982 CXL\u3001NVM\uff09\u7684\u8bbe\u8ba1\u524d\u77bb\u6027\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-14-performance-under-different-memory-bandwidth","title":"Figure 14: Performance under different memory bandwidth","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a\u201cFigure 14: Performance under different memory bandwidth\u201d\uff0c\u5c55\u793a\u4e0d\u540c\u5185\u5b58\u5e26\u5bbd\u4e0b\u5404\u9884\u53d6\u5668\u7684\u6027\u80fd\u589e\u76ca\u3002</li> <li>\u6a2a\u8f74\u4e3a\u201cPeak DRAM Bandwidth\u201d\uff0c\u8303\u56f4\u4ece5GB/s\u523035GB/s\uff0c\u51717\u4e2a\u6d4b\u8bd5\u70b9\uff1b\u7eb5\u8f74\u4e3a\u201cPerformance Gain\u201d\uff0c\u5355\u4f4d\u4e3a\u767e\u5206\u6bd4\uff0c\u8303\u56f40%\u81f340%\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u4e94\u6761\u66f2\u7ebf\uff0c\u5206\u522b\u4ee3\u8868\u4e94\u4e2a\u9884\u53d6\u5668\uff1aRICH\uff08\u84dd\u8272\uff09\u3001Bingo\uff08\u6a59\u8272\uff09\u3001PMP\uff08\u7070\u8272\uff09\u3001SMS\uff08\u9ec4\u8272\uff09\u3001SPP-PPF\uff08\u6d45\u84dd\u8272\uff09\u3002</li> <li>RICH\u5728\u6240\u6709\u5e26\u5bbd\u6761\u4ef6\u4e0b\u5747\u8868\u73b0\u6700\u4f18\uff0c\u5c24\u5176\u5728\u9ad8\u5e26\u5bbd\u573a\u666f\u4f18\u52bf\u663e\u8457\u3002\u572835GB/s\u65f6\uff0c\u5176\u6027\u80fd\u589e\u76ca\u8fbe39%\uff0c\u8fdc\u8d85\u5176\u4ed6\u9884\u53d6\u5668\u3002</li> <li>Bingo\u6b21\u4e4b\uff0c\u572835GB/s\u65f6\u6027\u80fd\u589e\u76ca\u4e3a34%\uff0c\u4e0eRICH\u5dee\u8ddd\u6269\u5927\u3002</li> <li>PMP\u548cSMS\u8868\u73b0\u63a5\u8fd1\uff0c35GB/s\u65f6\u5206\u522b\u4e3a33%\u548c30%\uff0c\u4f46\u6574\u4f53\u589e\u957f\u659c\u7387\u4f4e\u4e8eRICH\u3002</li> <li>SPP-PPF\u8868\u73b0\u6700\u5f31\uff0c35GB/s\u65f6\u4ec520%\uff0c\u4e14\u589e\u957f\u5e73\u7f13\u3002</li> <li>\u5728\u4f4e\u5e26\u5bbd\uff085GB/s\uff09\u65f6\uff0cRICH\u6027\u80fd\u589e\u76ca\u4e3a19%\uff0c\u7565\u4f4e\u4e8eBingo\u768420.1%\uff0c\u8868\u660e\u5176\u6fc0\u8fdb\u9884\u53d6\u7b56\u7565\u5728\u5e26\u5bbd\u53d7\u9650\u65f6\u53ef\u80fd\u5f15\u53d1\u7ade\u4e89\u3002</li> <li>\u968f\u7740\u5e26\u5bbd\u63d0\u5347\uff0cRICH\u6027\u80fd\u589e\u76ca\u5feb\u901f\u4e0a\u5347\uff0c\u4ece5GB/s\u768419%\u8dc3\u5347\u81f335GB/s\u768439%\uff0c\u589e\u5e45\u8fbe20\u4e2a\u767e\u5206\u70b9\uff0c\u4f53\u73b0\u5176\u5bf9\u9ad8\u5e26\u5bbd\u8d44\u6e90\u7684\u9ad8\u6548\u5229\u7528\u80fd\u529b\u3002</li> <li>\u5176\u4ed6\u9884\u53d6\u5668\u5728\u5e26\u5bbd\u589e\u52a0\u65f6\u4e5f\u6709\u63d0\u5347\uff0c\u4f46\u5e45\u5ea6\u8f83\u5c0f\uff0c\u4f8b\u5982Bingo\u4ece20.1%\u589e\u81f334%\uff0c\u589e\u5e45\u4ec513.9\u4e2a\u767e\u5206\u70b9\u3002</li> <li>\u6570\u636e\u6c47\u603b\u5982\u4e0b\uff1a</li> </ul> Peak DRAM Bandwidth RICH (%) Bingo (%) PMP (%) SMS (%) SPP-PPF (%) 5GB/s 19.0 20.1 12.0 11.0 13.0 10GB/s 28.0 26.0 20.0 18.0 16.0 15GB/s 32.0 29.0 25.0 22.0 18.0 20GB/s 34.0 31.0 28.0 25.0 19.0 25GB/s 36.0 33.0 30.0 27.0 20.0 30GB/s 38.0 34.0 32.0 29.0 20.0 35GB/s 39.0 34.0 33.0 30.0 20.0 <ul> <li>\u7ed3\u8bba\uff1aRICH\u8bbe\u8ba1\u9488\u5bf9\u9ad8\u5e26\u5bbd\u5185\u5b58\u8d8b\u52bf\uff0c\u80fd\u6709\u6548\u5229\u7528\u4e30\u5bcc\u5143\u6570\u636e\u548c\u591a\u533a\u57df\u9884\u53d6\u673a\u5236\uff0c\u5728\u9ad8\u5e26\u5bbd\u73af\u5883\u4e0b\u5b9e\u73b0\u663e\u8457\u6027\u80fd\u63d0\u5347\uff1b\u4f46\u5728\u4f4e\u5e26\u5bbd\u573a\u666f\u9700\u6743\u8861\u9884\u53d6\u6fc0\u8fdb\u6027\u4ee5\u907f\u514d\u8d44\u6e90\u4e89\u7528\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-15-multi-offset-trigger-mechanism-significantly-benefits-rich-while-offloading-part-of-the-16-kb-region-patterns-has-limited-performance-impact","title":"Figure 15: Multi-offset trigger mechanism significantly benefits RICH, while offloading part of the 16 KB-Region patterns has limited performance impact.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 15\uff0c\u65e8\u5728\u5c55\u793a Multi-offset trigger mechanism \u5bf9 RICH \u7684\u663e\u8457\u589e\u76ca\uff0c\u4ee5\u53ca\u5c06\u90e8\u5206 16 KB-region patterns \u5378\u8f7d\u81f3\u7247\u5916\u5bf9\u6027\u80fd\u5f71\u54cd\u6709\u9650\u3002</li> <li>\u56fe\u8868\u4e0a\u534a\u90e8\u5206\u4e3a\u6298\u7ebf\u56fe\uff0c\u6a2a\u8f74\u8868\u793a\u4e03\u79cd\u4e0d\u540c\u914d\u7f6e\uff08\u4ece (1) \u5230 (7)\uff09\uff0c\u7eb5\u8f74\u4e3a\u201cPerformance Gain over No Prefetching\u201d\uff0c\u8303\u56f4\u4ece 10% \u81f3 50%\u3002</li> <li>\u6298\u7ebf\u56fe\u663e\u793a\uff1a2 KB-region only \u914d\u7f6e\u6027\u80fd\u589e\u76ca\u7ea6 35%\uff0c4 KB-region only \u7ea6 25%\uff0c16 KB-region only \u6700\u4f4e\u7ea6 18%\uff0c\u968f\u540e\u9010\u6b65\u63d0\u5347\u81f3 RICH \u914d\u7f6e\u7684\u7ea6 40%\u3002</li> <li>\u4e0b\u534a\u90e8\u5206\u8868\u683c\u8be6\u7ec6\u5217\u51fa\u5404\u914d\u7f6e\u7684\u5173\u952e\u7279\u6027\u4e0e\u7247\u4e0a\u5f00\u9500\uff1a</li> <li>(1) 2KB-region only\uff1a\u4ec5\u652f\u6301 2KB \u533a\u57df\uff0c\u65e0\u591a\u533a\u57df\u3001\u591a\u504f\u79fb\u3001\u533a\u57df\u4ef2\u88c1\u6216\u7247\u5916\u5b58\u50a8\uff0c\u7247\u4e0a\u5f00\u9500 22 KB\u3002</li> <li>(2) 4KB-region only\uff1a\u4ec5\u652f\u6301 4KB \u533a\u57df\uff0c\u7247\u4e0a\u5f00\u9500 10 KB\u3002</li> <li>(3) 16KB-region only\uff1a\u4ec5\u652f\u6301 16KB \u533a\u57df\uff0c\u7247\u4e0a\u5f00\u9500 137 KB\u3002</li> <li>(4) Naive multi-region\uff1a\u652f\u6301\u591a\u533a\u57df\u4f46\u65e0\u591a\u504f\u79fb\u89e6\u53d1\u548c\u533a\u57df\u4ef2\u88c1\uff0c\u7247\u4e0a\u5f00\u9500 174 KB\u3002</li> <li>(5) Multi-region multi-trigger\uff1a\u52a0\u5165\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\uff0c\u7247\u4e0a\u5f00\u9500\u4ecd\u4e3a 174 KB\u3002</li> <li>(6) All-on-chip\uff1a\u5728 (5) \u57fa\u7840\u4e0a\u589e\u52a0\u533a\u57df\u4ef2\u88c1\uff0c\u7247\u4e0a\u5f00\u9500\u589e\u81f3 175 KB\u3002</li> <li>(7) RICH (proposed)\uff1a\u5b8c\u6574\u8bbe\u8ba1\uff0c\u5305\u542b\u533a\u57df\u4ef2\u88c1\u4e0e\u7247\u5916\u534f\u4f5c\u7b56\u7565\uff0c\u7247\u4e0a\u5f00\u9500\u5927\u5e45\u964d\u81f3 47.3 KB\u3002</li> <li>\u5173\u952e\u7ed3\u8bba\uff1a\u5f15\u5165 multi-offset trigger \u548c region arbitration \u663e\u8457\u63d0\u5347\u6027\u80fd\uff1b\u800c\u5c06\u90e8\u5206 16KB \u6a21\u5f0f\u5378\u8f7d\u81f3\u7247\u5916\uff0c\u4ec5\u5bfc\u81f4\u7ea6 0.5% \u6027\u80fd\u635f\u5931\uff0c\u9a8c\u8bc1\u4e86\u5176\u9ad8\u6548\u6027\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0cRICH \u5728\u4fdd\u6301\u9ad8\u6027\u80fd\u7684\u540c\u65f6\uff0c\u7247\u4e0a\u8d44\u6e90\u6d88\u8017\u4ec5\u4e3a\u4f20\u7edf\u5168\u7247\u4e0a\u65b9\u6848\u7684\u7ea6 27%\uff0c\u4f53\u73b0\u5176\u5728\u9ad8\u5e26\u5bbd\u3001\u5927\u5bb9\u91cf\u5185\u5b58\u7cfb\u7edf\u4e2d\u7684\u8bbe\u8ba1\u4f18\u52bf\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-16-iso-storage-comparison-shows-rich-is-more-storage-efficient-than-bingo-and-pmp","title":"Figure 16: Iso-storage comparison shows RICH is more storage efficient than Bingo and PMP.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u76f8\u540c\u5b58\u50a8\u9884\u7b97\u4e0b\uff0cRICH \u4e0e Bingo\u3001PMP \u53ca\u5176\u589e\u5f3a\u7248\u672c\u7684\u6027\u80fd\u5bf9\u6bd4\uff0c\u65e8\u5728\u9a8c\u8bc1 RICH \u7684\u5b58\u50a8\u6548\u7387\u3002</li> <li>\u6a2a\u8f74\u4e3a\u4e0d\u540c prefetcher \u914d\u7f6e\uff1aBingo\u3001Enhanced Bingo\u3001PMP\u3001Enhanced PMP\u3001RICH\u3002</li> <li>\u7eb5\u8f74\u4e3a\u201cSpeedup over No Prefetching\u201d\uff0c\u5373\u76f8\u5bf9\u4e8e\u65e0\u9884\u53d6\u57fa\u7ebf\u7684\u52a0\u901f\u6bd4\uff0c\u6570\u503c\u8d8a\u9ad8\u4ee3\u8868\u6027\u80fd\u8d8a\u597d\u3002</li> <li>\u6570\u636e\u663e\u793a\uff0cRICH \u7684\u52a0\u901f\u6bd4\u6700\u9ad8\uff0c\u7ea6\u4e3a 1.4\uff0c\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u6240\u6709\u914d\u7f6e\u3002</li> <li>Bingo \u548c Enhanced Bingo \u7684\u52a0\u901f\u6bd4\u76f8\u8fd1\uff0c\u5747\u7ea6\u4e3a 1.35\uff0c\u8868\u660e\u5355\u7eaf\u6269\u5927 Bingo \u7684 PHT \u5bb9\u91cf\u5e26\u6765\u7684\u6536\u76ca\u6709\u9650\u3002</li> <li>PMP \u548c Enhanced PMP \u7684\u52a0\u901f\u6bd4\u4e5f\u76f8\u8fd1\uff0c\u7ea6\u4e3a 1.33\uff0c\u540c\u6837\u8bf4\u660e\u7b80\u5355\u6269\u5bb9\u5bf9 PMP \u7684\u63d0\u5347\u4e0d\u660e\u663e\u3002</li> <li>\u8fd9\u4e00\u7ed3\u679c\u652f\u6301\u4e86\u8bba\u6587\u4e2d\u7684\u6838\u5fc3\u89c2\u70b9\uff1aRICH \u80fd\u66f4\u6709\u6548\u5730\u5c06\u4e30\u5bcc\u7684\u5143\u6570\u636e\u8f6c\u5316\u4e3a\u6027\u80fd\u589e\u76ca\uff0c\u800c\u4f20\u7edf prefetcher \u5728\u6269\u5bb9\u540e\u9762\u4e34\u8fb9\u9645\u6548\u76ca\u9012\u51cf\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e86\u5404\u914d\u7f6e\u7684\u5b58\u50a8\u5f00\u9500\u548c\u6027\u80fd\u8868\u73b0\uff1a</li> </ul> Prefetcher On-chip Storage (KB) Off-chip Storage (KB) Total Storage (KB) Speedup over No Prefetching Bingo 127 0 127 ~1.35 Enhanced Bingo 193 0 193 ~1.35 PMP 128 0 128 ~1.33 Enhanced PMP 194 0 194 ~1.33 RICH 47 128 175 ~1.40 <ul> <li>\u5c3d\u7ba1 RICH \u7684\u603b\u5b58\u50a8\u5f00\u9500\uff08175 KB\uff09\u4ecb\u4e8e Bingo/PMP \u4e0e\u5176\u589e\u5f3a\u7248\u4e4b\u95f4\uff0c\u4f46\u5176\u6027\u80fd\u4f18\u52bf\u660e\u663e\uff0c\u8bc1\u660e\u5176\u8bbe\u8ba1\u80fd\u66f4\u9ad8\u6548\u5730\u5229\u7528\u5b58\u50a8\u8d44\u6e90\u3002</li> <li>RICH \u7684\u6210\u529f\u5728\u4e8e\u5176\u5206\u5c42\u5b58\u50a8\u7b56\u7565\uff1a\u5c06\u9ad8\u9891\u6a21\u5f0f\u4fdd\u7559\u5728\u7247\u4e0a\uff0c\u4f4e\u9891\u6a21\u5f0f\u5378\u8f7d\u5230\u7247\u5916\uff0c\u65e2\u8282\u7701\u4e86\u5b9d\u8d35\u7684\u7247\u4e0a\u9762\u79ef\uff0c\u53c8\u672a\u727a\u7272\u592a\u591a\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-17-sensitivity-to-different-prefetch-count-thresholds-for-16-kb-region-under-different-memory-latencies","title":"Figure 17: Sensitivity to different prefetch count thresholds for 16 KB-region under different memory latencies","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RICH prefetcher \u5728\u4e0d\u540c\u5185\u5b58\u5ef6\u8fdf\u4e0b\uff0c\u5176 16 KB-region \u6a21\u5f0f\u5bf9 prefetch count threshold \u7684\u654f\u611f\u6027\u5206\u6790\u3002\u8be5\u9608\u503c\u7528\u4e8e\u51b3\u5b9a\u662f\u5426\u5c06\u4e0d\u9891\u7e41\u7684 16 KB \u6a21\u5f0f\u5199\u5165 off-chip PHT\uff0c\u4ee5\u907f\u514d\u56e0 row buffer miss \u5bfc\u81f4\u7684\u6027\u80fd\u635f\u5931\u3002</li> <li>\u56fe\u8868\u5206\u4e3a\u4e09\u4e2a\u5b50\u56fe (a, b, c)\uff0c\u5206\u522b\u5bf9\u5e94 0ns\u300130ns \u548c 60ns \u7684\u989d\u5916\u5185\u5b58\u5ef6\u8fdf\u573a\u666f\uff0c\u7eb5\u8f74\u4e3a Performance Gain\uff08\u76f8\u5bf9\u4e8e\u65e0 prefetch \u57fa\u7ebf\uff09\uff0c\u6a2a\u8f74\u4e3a Threshold \u503c\uff08\u4ece 10 \u5230 70\uff09\u3002</li> <li>\u5728 0ns \u5ef6\u8fdf\uff08\u5e38\u89c4\u7cfb\u7edf\uff09\u4e0b\uff0c\u6027\u80fd\u589e\u76ca\u5728\u9608\u503c\u4e3a 10 \u65f6\u8fbe\u5230\u5cf0\u503c\uff08\u7ea6 40%\uff09\uff0c\u968f\u540e\u968f\u9608\u503c\u589e\u52a0\u800c\u4e0b\u964d\u3002\u8fd9\u8868\u660e\u5728\u4f4e\u5ef6\u8fdf\u73af\u5883\u4e0b\uff0c\u8f83\u4f4e\u7684\u9608\u503c\u80fd\u6355\u83b7\u66f4\u591a\u6709\u6548\u6a21\u5f0f\uff0c\u4ece\u800c\u83b7\u5f97\u66f4\u9ad8\u6536\u76ca\u3002</li> <li>\u5728 30ns \u5ef6\u8fdf \u4e0b\uff0c\u6027\u80fd\u589e\u76ca\u5728\u9608\u503c\u4e3a 30 \u65f6\u8fbe\u5230\u6700\u4f18\uff08\u7ea6 50%\uff09\u3002\u6b64\u65f6\uff0c\u8fc7\u4f4e\u7684\u9608\u503c\u4f1a\u56e0\u9891\u7e41\u89e6\u53d1 off-chip \u8bbf\u95ee\u5bfc\u81f4 row buffer miss\uff0c\u800c\u8fc7\u9ad8\u9608\u503c\u5219\u4f1a\u9519\u8fc7\u5927\u91cf\u6f5c\u5728\u7684 prefetch \u673a\u4f1a\u3002</li> <li>\u5728 60ns \u5ef6\u8fdf \u4e0b\uff0c\u6027\u80fd\u589e\u76ca\u540c\u6837\u5728\u9608\u503c\u4e3a 30 \u65f6\u8fbe\u5230\u6700\u9ad8\u70b9\uff08\u7ea6 56%\uff09\uff0c\u8d8b\u52bf\u4e0e 30ns \u573a\u666f\u7c7b\u4f3c\u3002\u8fd9\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u4e86\u5728\u9ad8\u5ef6\u8fdf\u7cfb\u7edf\u4e2d\uff0c30 \u662f\u4e00\u4e2a\u5e73\u8861\u6027\u80fd\u4e0e\u5f00\u9500\u7684\u7a33\u5065\u9009\u62e9\u3002</li> <li>\u7efc\u5408\u4e09\u56fe\u53ef\u89c1\uff0c\u968f\u7740\u5185\u5b58\u5ef6\u8fdf\u589e\u52a0\uff0c\u6700\u4f18\u9608\u503c\u4ece 10 \u4e0a\u5347\u81f3 30\uff0c\u8bf4\u660e\u5728\u9ad8\u5ef6\u8fdf\u7cfb\u7edf\u4e2d\uff0c\u9700\u8981\u66f4\u4e25\u683c\u7684\u7b5b\u9009\u673a\u5236\u6765\u907f\u514d off-chip \u8bbf\u95ee\u5e26\u6765\u7684\u8d1f\u9762\u5f71\u54cd\u3002</li> </ul> \u5ef6\u8fdf (ns) \u6700\u4f18 Threshold \u6700\u9ad8 Performance Gain (%) 0 10 ~40 30 30 ~50 60 30 ~56"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-18-sensitivity-to-different-pht-sizes","title":"Figure 18: Sensitivity to different PHT sizes","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RICH prefetcher \u5bf9\u4e0d\u540c Pattern History Table (PHT) \u5c3a\u5bf8\u7684\u654f\u611f\u6027\u5206\u6790\uff0c\u5206\u4e3a\u4e09\u4e2a\u5b50\u56fe\uff1aa) 2 KB-region PHT\u3001b) 4 KB-region PHT\u3001c) 16 KB-region PHT Cache\u3002</li> <li>\u6027\u80fd\u589e\u76ca\uff08Performance Gain\uff09\u4f5c\u4e3a\u7eb5\u8f74\uff0c\u6a2a\u8f74\u4e3a\u5bf9\u5e94\u533a\u57df\u7684 PHT \u6761\u76ee\u6570\uff08Entries\uff09\uff0c\u7528\u4e8e\u8861\u91cf\u4e0d\u540c\u914d\u7f6e\u4e0b prefetcher \u7684\u6027\u80fd\u8868\u73b0\u3002</li> <li>\u5b50\u56fe a) \u663e\u793a 2 KB-region PHT \u5728\u6761\u76ee\u6570\u4ece 2048 \u589e\u52a0\u5230 16384 \u65f6\uff0c\u6027\u80fd\u589e\u76ca\u4ece\u7ea6 38% \u4e0a\u5347\u81f3 39.5%\uff0c\u5e76\u5728 8192 \u6761\u76ee\u540e\u8d8b\u4e8e\u9971\u548c\uff1b\u4f4e\u4e8e 2048 \u6761\u76ee\u65f6\u6027\u80fd\u660e\u663e\u4e0b\u964d\uff0c\u8868\u660e\u8be5\u533a\u57df\u5bf9\u5bb9\u91cf\u8f83\u654f\u611f\u3002</li> <li>\u5b50\u56fe b) \u663e\u793a 4 KB-region PHT \u5728\u6761\u76ee\u6570\u4ece 512 \u589e\u52a0\u5230 4096 \u65f6\uff0c\u6027\u80fd\u589e\u76ca\u4ece\u7ea6 37.5% \u4e0a\u5347\u81f3 39.5%\uff0c\u5728 2048 \u6761\u76ee\u540e\u57fa\u672c\u9971\u548c\uff1b1024 \u6761\u76ee\u5df2\u53ef\u5b9e\u73b0\u63a5\u8fd1\u6700\u4f18\u6027\u80fd\uff0c\u8bf4\u660e\u5176\u5bb9\u91cf\u9700\u6c42\u9002\u4e2d\u3002</li> <li>\u5b50\u56fe c) \u663e\u793a 16 KB-region PHT Cache\uff08\u4ec5\u9650\u4e8e on-chip \u90e8\u5206\uff09\u5728\u6761\u76ee\u6570\u4ece 128 \u589e\u52a0\u5230 1024 \u65f6\uff0c\u6027\u80fd\u589e\u76ca\u4ece\u7ea6 38% \u4e0a\u5347\u81f3 39.5%\uff0c\u5373\u4f7f\u4ec5 256 \u6761\u76ee\u4e5f\u63a5\u8fd1\u9971\u548c\uff0c\u8bc1\u660e\u5176\u8bbe\u8ba1\u9ad8\u6548\uff0c\u4f9d\u8d56 off-chip \u5b58\u50a8\u8865\u5145\u3002</li> <li>\u7efc\u5408\u6765\u770b\uff0cRICH \u7684\u591a\u7ea7\u5b58\u50a8\u7b56\u7565\u6709\u6548\u5e73\u8861\u4e86 on-chip \u5bb9\u91cf\u4e0e\u6027\u80fd\uff1a2 KB \u548c 4 KB \u533a\u57df\u9700\u9002\u5ea6 on-chip \u7a7a\u95f4\uff0c\u800c 16 KB \u533a\u57df\u901a\u8fc7\u5c0f\u5bb9\u91cf cache + off-chip \u5b58\u50a8\u5373\u53ef\u7ef4\u6301\u9ad8\u6027\u80fd\u3002</li> </ul> \u533a\u57df\u5927\u5c0f \u6700\u4f18\u6761\u76ee\u6570 \u6027\u80fd\u9971\u548c\u70b9 \u5173\u952e\u89c2\u5bdf 2 KB-region PHT 8192+ 8192 \u4f4e\u4e8e 2048 \u6761\u76ee\u6027\u80fd\u663e\u8457\u4e0b\u964d 4 KB-region PHT 2048+ 2048 1024 \u6761\u76ee\u5df2\u63a5\u8fd1\u6700\u4f18 16 KB-region PHT Cache 256+ 256 \u6781\u5c0f\u5bb9\u91cf\u5373\u8fbe\u9971\u548c\uff0c\u4f9d\u8d56 off-chip \u8865\u5145 <ul> <li>\u6b64\u7ed3\u679c\u9a8c\u8bc1\u4e86\u8bba\u6587\u4e2d\u63d0\u51fa\u7684\u5206\u5c42\u5b58\u50a8\u673a\u5236\u7684\u6709\u6548\u6027\uff1a\u901a\u8fc7\u5c06\u9ad8\u9891\u6a21\u5f0f\u4fdd\u7559\u5728 on-chip\uff0c\u4f4e\u9891\u6a21\u5f0f\u79fb\u81f3 off-chip\uff0cRICH \u5728\u63a7\u5236\u9762\u79ef\u5f00\u9500\u7684\u540c\u65f6\u4fdd\u6301\u9ad8\u8986\u76d6\u7387\u548c\u53ca\u65f6\u6027\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/figs_notes/#figure-19-rich-outperforms-bingo-in-both-homogeneous-and-heterogeneous-workloads-on-a-4-core-system","title":"Figure 19: RICH outperforms Bingo in both homogeneous and heterogeneous workloads on a 4-core system","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u5728 4 \u6838\u7cfb\u7edf\u4e0b\uff0cRICH \u4e0e\u5176\u4ed6\u56db\u79cd\u4e3b\u6d41 prefetcher\uff08SPP-PPF\u3001SMS\u3001Bingo\u3001PMP\uff09\u5728\u4e09\u79cd\u4e0d\u540c workload \u7c7b\u578b\u4e0b\u7684\u6027\u80fd\u5bf9\u6bd4\uff0c\u6027\u80fd\u6307\u6807\u4e3a Speedup over No Prefetching\u3002</li> <li>\u6a2a\u8f74\u5206\u4e3a\u4e09\u7ec4\uff1aHeter Geomean\uff08\u5f02\u6784\u5de5\u4f5c\u8d1f\u8f7d\u51e0\u4f55\u5e73\u5747\uff09\u3001Homo Geomean\uff08\u540c\u6784\u5de5\u4f5c\u8d1f\u8f7d\u51e0\u4f55\u5e73\u5747\uff09\u3001Geomean\uff08\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u7684\u51e0\u4f55\u5e73\u5747\uff09\uff0c\u7eb5\u8f74\u8868\u793a\u76f8\u5bf9\u4e8e\u65e0\u9884\u53d6\u57fa\u7ebf\u7684\u52a0\u901f\u6bd4\u3002</li> <li>RICH \u5728\u6240\u6709\u4e09\u7c7b workload \u4e2d\u5747\u53d6\u5f97\u6700\u9ad8\u52a0\u901f\u6bd4\uff0c\u5176\u67f1\u72b6\u56fe\u4ee5\u7ea2\u8272\u5b9e\u5fc3\u586b\u5145\uff0c\u663e\u8457\u9ad8\u4e8e\u5176\u4ed6 prefetcher\u3002</li> <li>\u5404 prefetcher \u5728\u4e0d\u540c workload \u4e0b\u7684\u8868\u73b0\u5982\u4e0b\uff1a</li> </ul> Workload Type SPP-PPF SMS Bingo PMP RICH Heter Geomean ~1.15 ~1.28 ~1.20 ~1.20 ~1.32 Homo Geomean ~1.10 ~1.25 ~1.30 ~1.28 ~1.36 Geomean ~1.20 ~1.28 ~1.25 ~1.23 ~1.34 <ul> <li>RICH \u76f8\u8f83\u4e8e Bingo \u7684\u4f18\u52bf\u5728\u5f02\u6784\u8d1f\u8f7d\u4e2d\u5c24\u4e3a\u660e\u663e\uff08+3.4%\uff09\uff0c\u5728\u540c\u6784\u8d1f\u8f7d\u4e2d\u7565\u6709\u7f29\u5c0f\uff08+4.6%\uff09\uff0c\u6574\u4f53\u51e0\u4f55\u5e73\u5747\u63d0\u5347\u8fbe +7.2%\u3002</li> <li>\u5c3d\u7ba1 RICH \u91c7\u7528\u6fc0\u8fdb\u9884\u53d6\u7b56\u7565\uff0c\u5728\u591a\u6838\u73af\u5883\u4e0b\u4f1a\u5360\u7528\u66f4\u591a\u5e26\u5bbd\u8d44\u6e90\uff0c\u4f46\u5176\u4ecd\u80fd\u4fdd\u6301\u9886\u5148\u6027\u80fd\uff0c\u9a8c\u8bc1\u4e86\u5176\u5728\u591a\u6838\u573a\u666f\u4e0b\u7684\u6709\u6548\u6027\u3002</li> <li>\u56fe\u4f8b\u6e05\u6670\u6807\u6ce8\u5404 prefetcher \u5bf9\u5e94\u7684\u989c\u8272\u4e0e\u56fe\u6848\uff0c\u4fbf\u4e8e\u5feb\u901f\u8bc6\u522b\u3002RICH \u7684\u7ea2\u8272\u5b9e\u5fc3\u67f1\u5f62\u5728\u89c6\u89c9\u4e0a\u7a81\u51fa\u5176\u6700\u4f18\u8868\u73b0\u3002</li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/","title":"RICH Prefetcher: Storing Rich Information in Memory to Trade Capacity and Bandwidth for Latency Hiding \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Ningzhi Ai - Wenjian He - Hu He - Jing Xia - Heng Liao - Guowei Zhang</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - 58th IEEE/ACM International Symposium on Microarchitecture (MICRO '25)</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - 2025</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u9488\u5bf9\u672a\u6765\u5185\u5b58\u7cfb\u7edf\uff08\u5982 Non-Volatile Memory (NVM) \u548c CXL-based memory pooling\uff09\u5448\u73b0\u51fa\u7684 \u9ad8\u5e26\u5bbd\u3001\u5927\u5bb9\u91cf\u4f46\u9ad8\u5ef6\u8fdf \u7684\u8d8b\u52bf\uff0c\u89e3\u51b3\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\uff08prefetcher\uff09\u56e0\u53d7\u9650\u4e8e\u7247\u4e0a\u5b58\u50a8\u9762\u79ef\u800c\u65e0\u6cd5\u5145\u5206\u5229\u7528\u4e30\u5bcc\u5143\u6570\u636e\uff08rich metadata\uff09\u6765\u6709\u6548\u9690\u85cf\u5ef6\u8fdf\u7684\u95ee\u9898\u3002 - \u65e8\u5728\u8bbe\u8ba1\u4e00\u79cd\u65b0\u578b\u9884\u53d6\u5668\uff0c\u80fd\u591f\u6218\u7565\u6027\u5730\u5229\u7528\u989d\u5916\u7684\u5185\u5b58\u5bb9\u91cf\u548c\u5e26\u5bbd\uff0c\u4ee5\u6362\u53d6\u66f4\u4f18\u7684\u5ef6\u8fdf\u9690\u85cf\u80fd\u529b\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa RICH Prefetcher\uff0c\u5176\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5\u662f\u901a\u8fc7\u6d88\u8017\u5185\u5b58\u5bb9\u91cf\u548c\u5e26\u5bbd\u6765\u6362\u53d6\u66f4\u4f4e\u7684\u6709\u6548\u8bbf\u95ee\u5ef6\u8fdf\u3002 - \u591a\u5c3a\u5ea6\u7a7a\u95f4\u5c40\u90e8\u6027\u5229\u7528\uff1a   - \u652f\u6301 2 KB\u30014 KB \u548c 16 KB \u4e09\u79cd\u4e0d\u540c\u5927\u5c0f\u7684\u7a7a\u95f4\u533a\u57df\u8fdb\u884c\u9884\u53d6\u3002   - \u4e3a\u4e0d\u540c\u533a\u57df\u8bbe\u8ba1\u5dee\u5f02\u5316\u7684\u89e6\u53d1\u673a\u5236\uff1a\u5bf9 16 KB \u5927\u533a\u57df\u91c7\u7528 (PC, 5 offsets) \u7684\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u4ee5\u4fdd\u8bc1\u9ad8\u7cbe\u5ea6\uff1b\u5bf9 2 KB/4 KB \u5c0f\u533a\u57df\u91c7\u7528\u66f4\u8f7b\u91cf\u7ea7\u7684\u89e6\u53d1\uff08\u5982 Bingo \u7684 (PC, address)\uff09\u4ee5\u4fdd\u8bc1\u9ad8\u8986\u76d6\u7387\u3002   - \u8bbe\u8ba1\u4e86\u533a\u57df\u4ef2\u88c1\u5355\u5143 (Region Arbitration)\uff0c\u6839\u636e\u7cbe\u5ea6\u548c\u6027\u80fd\u4f18\u5148\u7ea7\uff0816KB &gt; 4KB &gt; 2KB\uff0c\u4f46 (PC, address) \u89e6\u53d1\u7684 2KB \u4f18\u5148\u7ea7\u6700\u9ad8\uff09\u9009\u62e9\u6700\u4f18\u7684\u9884\u53d6\u533a\u57df\uff0c\u5e76\u5f15\u5165\u53bb\u91cd\u673a\u5236\u907f\u514d\u91cd\u53e0\u9884\u53d6\u3002 - \u5206\u5c42\u5143\u6570\u636e\u5b58\u50a8\uff1a   - \u5bf9\u5143\u6570\u636e\u6309\u8bbf\u95ee\u9891\u7387\u3001\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6\u548c\u9762\u79ef\u5f00\u9500\u8fdb\u884c\u5206\u7c7b\u3002   - \u7247\u4e0a\u5b58\u50a8\uff1a\u5b58\u653e\u5bf9\u5ef6\u8fdf\u654f\u611f\u7684\u5c0f\u533a\u57df\uff082KB/4KB\uff09\u6a21\u5f0f\u3001\u8bad\u7ec3\u5143\u6570\u636e\u548c\u63a7\u5236\u5143\u6570\u636e\u3002   - \u7247\u5916\u5b58\u50a8\uff1a\u5c06\u8bbf\u95ee\u4e0d\u9891\u7e41\u3001\u9762\u79ef\u5f00\u9500\u5927\u7684 16 KB \u533a\u57df\u6a21\u5f0f\u8868 (PHT) \u5b58\u653e\u5728\u4e3b\u5b58\u4e2d\uff0c\u5e76\u5728\u7247\u4e0a\u4fdd\u7559\u4e00\u4e2a\u5c0f\u578b\u7f13\u5b58\u3002\u4ec5\u5f53\u6a21\u5f0f\u7684\u9884\u53d6\u8ba1\u6570\uff08prefetch count\uff09\u8d85\u8fc7\u9608\u503c\uff08\u598230\uff09\u65f6\uff0c\u624d\u5c06\u5176\u5199\u5165\u7247\u5916\u5b58\u50a8\uff0c\u4ee5\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u7247\u5916\u8bbf\u95ee\u3002   - </p> <p></p> <p>Table 2: Categorization of RICH's metadata</p> <p>\u7ed3\u679c - \u5728\u6807\u51c6\u5355\u6838\u7cfb\u7edf\u4e2d\uff0cRICH \u76f8\u6bd4\u5f53\u524d\u6700\u5148\u8fdb\u7684 Bingo \u9884\u53d6\u5668\u5b9e\u73b0\u4e86 3.4% \u7684\u5e73\u5747\u6027\u80fd\u63d0\u5347\u3002 - \u5728\u6a21\u62df\u672a\u6765\u9ad8\u5ef6\u8fdf\u5185\u5b58\u7cfb\u7edf\uff08\u589e\u52a0 120 ns \u5185\u5b58\u5ef6\u8fdf\uff09\u7684\u573a\u666f\u4e0b\uff0cRICH \u7684\u4f18\u52bf\u66f4\u4e3a\u663e\u8457\uff0c\u6027\u80fd\u63d0\u5347\u5206\u522b\u8fbe\u5230 8.3%\uff08\u5bf9\u6bd4 Bingo\uff09\u548c 6.2%\uff08\u5bf9\u6bd4 PMP\uff09\u3002 - RICH \u5728\u5173\u952e\u6307\u6807\u4e0a\u5168\u9762\u8d85\u8d8a\u57fa\u7ebf\uff1a   - \u8986\u76d6\u7387 (Coverage): 75% vs. Bingo \u7684 64%\u3002   - \u53ca\u65f6\u6027 (Timeliness): 91% vs. Bingo \u7684 78%\u3002   - \u51c6\u786e\u7387 (Accuracy): 76.3%\uff0c\u4e0e Bingo \u7684 76.6% \u57fa\u672c\u6301\u5e73\u3002 - \u5373\u4f7f\u5c06\u90e8\u5206 16KB \u6a21\u5f0f\u8868\u653e\u7f6e\u5728\u7247\u5916\uff0c\u6027\u80fd\u635f\u5931\u4e5f\u4ec5\u4e3a 0.5%\uff0c\u9a8c\u8bc1\u4e86\u5206\u5c42\u5b58\u50a8\u7b56\u7565\u7684\u6709\u6548\u6027\u3002 - </p> <p></p> <p>Figure 10: RICH improves coverage and timeliness while maintaining comparable accuracy</p> <p></p> <p>Figure 14: Performance under different memory bandwidth</p> <p>\u7ed3\u8bba - RICH \u9884\u53d6\u5668\u901a\u8fc7\u521b\u65b0\u7684\u591a\u5c3a\u5ea6\u533a\u57df\u9884\u53d6\u548c\u5206\u5c42\u5143\u6570\u636e\u5b58\u50a8\u673a\u5236\uff0c\u6210\u529f\u5730\u5c06\u4e30\u5bcc\u7684\u5143\u6570\u636e\u8f6c\u5316\u4e3a\u663e\u8457\u7684\u6027\u80fd\u6536\u76ca\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u9ad8\u5ef6\u8fdf\u3001\u9ad8\u5e26\u5bbd\u7684\u672a\u6765\u5185\u5b58\u67b6\u6784\u3002 - \u8be5\u8bbe\u8ba1\u8bc1\u660e\u4e86\u5728\u5185\u5b58\u8d44\u6e90\u65e5\u76ca\u4e30\u5bcc\u7684\u80cc\u666f\u4e0b\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u7684\u8bbe\u8ba1\u8303\u5f0f\u53ef\u4ee5\u4ece\u201c\u6700\u5c0f\u5316\u5143\u6570\u636e\u201d\u8f6c\u5411\u201c\u6218\u7565\u6027\u5229\u7528\u4e30\u5bcc\u5143\u6570\u636e\u201d\uff0c\u4ece\u800c\u66f4\u6709\u6548\u5730\u5e94\u5bf9\u5185\u5b58\u5899\u6311\u6218\u3002</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f</p> <ul> <li>\u73b0\u4ee3\u5185\u5b58\u6280\u672f\u7684\u53d1\u5c55\u8d8b\u52bf\u662f\u9ad8\u5e26\u5bbd\uff08high bandwidth\uff09\u548c\u5927\u5bb9\u91cf\uff08high capacity\uff09\uff0c\u4f46\u4ee3\u4ef7\u662f\u8bbf\u95ee\u5ef6\u8fdf\uff08access latency\uff09\u663e\u8457\u589e\u52a0\u3002</li> <li>\u8fd9\u4e00\u8d8b\u52bf\u4f53\u73b0\u5728\u591a\u4e2a\u5c42\u9762\uff1a</li> <li>\u8bbe\u5907\u5c42\u9762\uff1a\u5982\u975e\u6613\u5931\u6027\u5185\u5b58\uff08NVM\uff09\u7b49\u65b0\u578b\u5b58\u50a8\u4ecb\u8d28\uff0c\u867d\u7136\u5bc6\u5ea6\u9ad8\u3001\u6210\u672c\u4f4e\uff0c\u4f46\u8bbf\u95ee\u5ef6\u8fdf\u8fdc\u9ad8\u4e8e\u4f20\u7edf DRAM\u3002</li> <li>\u7cfb\u7edf\u5c42\u9762\uff1a\u5982\u57fa\u4e8e CXL (Compute Express Link) \u7684\u5185\u5b58\u6c60\u5316\u67b6\u6784\uff0c\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u6269\u5c55\u4e86\u6709\u6548\u5bb9\u91cf\uff0c\u4f46\u4e5f\u5f15\u5165\u4e86\u989d\u5916\u7684\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> <li>\u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 SMS, Bingo, PMP\uff09\u4e3b\u8981\u4e3a\u9762\u79ef\u6548\u7387\uff08area efficiency\uff09\u800c\u8bbe\u8ba1\uff0c\u901a\u5e38\u5c06\u5143\u6570\u636e\uff08metadata\uff09\u5b58\u50a8\u5728\u7247\u4e0a\uff0c\u8fd9\u9650\u5236\u4e86\u5176\u80fd\u6355\u83b7\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u591a\u6837\u6027\uff0c\u5c24\u5176\u96be\u4ee5\u5904\u7406\u8de8\u8d8a\u591a\u4e2a\u9875\u9762\u7684\u5927\u8303\u56f4\u7a7a\u95f4\u5c40\u90e8\u6027\u3002</li> </ul> <p>\u7814\u7a76\u52a8\u673a</p> <ul> <li>\u9762\u5bf9\u9ad8\u5ef6\u8fdf\u5185\u5b58\uff0c\u4f20\u7edf\u7684\u201c\u7cbe\u7b80\u5143\u6570\u636e\u201d\u8bbe\u8ba1\u54f2\u5b66\u5df2\u4e0d\u518d\u9002\u7528\u3002\u9ad8\u5e26\u5bbd\u3001\u5927\u5bb9\u91cf\u7684\u5185\u5b58\u7cfb\u7edf\u6709\u80fd\u529b\u627f\u8f7d\u548c\u4f20\u8f93\u66f4\u4e30\u5bcc\u7684\u4fe1\u606f\uff0c\u8fd9\u4e3a\u8bbe\u8ba1\u66f4\u5f3a\u5927\u7684\u9884\u53d6\u5668\u63d0\u4f9b\u4e86\u673a\u4f1a\u3002</li> <li>\u7136\u800c\uff0c\u76f4\u63a5\u6269\u5c55\u73b0\u6709\u9884\u53d6\u5668\u7684\u5143\u6570\u636e\u89c4\u6a21\u4f1a\u9762\u4e34\u4e24\u4e2a\u6838\u5fc3\u6311\u6218\uff1a</li> <li>\u5982\u4f55\u5c06\u4e30\u5bcc\u7684\u5143\u6570\u636e\u6709\u6548\u8f6c\u5316\u4e3a\u6027\u80fd\u6536\u76ca\uff1f\u7b80\u5355\u5730\u6269\u5927\u89c4\u6a21\u5f80\u5f80\u906d\u9047\u8fb9\u9645\u6548\u76ca\u9012\u51cf\uff08law of diminishing marginal returns\uff09\u3002</li> <li>\u5982\u4f55\u4ee5\u6700\u5c0f\u7684\u5f00\u9500\u5b9e\u73b0\u8fd9\u4e9b\u5143\u6570\u636e\uff1f\u5c06\u6240\u6709\u5143\u6570\u636e\u653e\u5728\u7247\u4e0a\u4f1a\u6d88\u8017\u5927\u91cf\u5b9d\u8d35\u7684\u7247\u4e0a\u9762\u79ef\uff08on-chip area\uff09\uff0c\u800c\u5b8c\u5168\u4f9d\u8d56\u7247\u5916\u5b58\u50a8\u5219\u4f1a\u56e0\u83b7\u53d6\u5143\u6570\u636e\u672c\u8eab\u7684\u9ad8\u5ef6\u8fdf\u800c\u62b5\u6d88\u9884\u53d6\u5e26\u6765\u7684\u597d\u5904\u3002</li> </ul> <p>\u6838\u5fc3\u8d21\u732e</p> <p>RICH \u9884\u53d6\u5668\u901a\u8fc7\u4e00\u79cd\u521b\u65b0\u7684\u8bbe\u8ba1\uff0c\u5de7\u5999\u5730\u5229\u7528\u4e86\u672a\u6765\u5185\u5b58\u7cfb\u7edf\u7684\u7279\u6027\uff0c\u5b9e\u73b0\u4e86\u7528\u5bb9\u91cf\u548c\u5e26\u5bbd\u6362\u53d6\u5ef6\u8fdf\u9690\u85cf\u7684\u76ee\u6807\u3002</p> <ul> <li>\u63d0\u51fa\u4e86\u4e00\u79cd\u591a\u5c3a\u5ea6\u3001\u591a\u89e6\u53d1\u673a\u5236\u7684\u9884\u53d6\u7b56\u7565\uff0c\u7ed3\u5408\u4e86\u5927\u533a\u57df\u548c\u5c0f\u533a\u57df\u9884\u53d6\u7684\u4f18\u52bf\uff1a</li> <li>\u5927\u533a\u57df\uff0816 KB\uff09\uff1a\u91c7\u7528\u591a\u504f\u79fb\u89e6\u53d1\uff08multi-offset trigger\uff09\u673a\u5236\uff08\u5982 (PC, 5 offsets)\uff09\uff0c\u901a\u8fc7\u89c2\u5bdf\u591a\u4e2a\u8bbf\u95ee\u5730\u5740\u540e\u518d\u89e6\u53d1\u9884\u53d6\uff0c\u786e\u4fdd\u4e86\u9ad8\u7cbe\u5ea6\uff08high accuracy\uff09\uff0c\u9002\u5408\u53d1\u5c04\u957f\u8ddd\u79bb\u3001\u9ad8\u5e26\u5bbd\u7684\u9884\u53d6\u6d41\u4ee5\u63d0\u5347\u53ca\u65f6\u6027\uff08timeliness\uff09\u3002</li> <li>\u5c0f\u533a\u57df\uff082 KB/4 KB\uff09\uff1a\u91c7\u7528\u8f7b\u91cf\u7ea7\u89e6\u53d1\uff08\u5982 Bingo \u7684 (PC, address) \u6216 (PC, 3 offsets)\uff09\uff0c\u4f18\u5148\u4fdd\u8bc1\u9ad8\u8986\u76d6\u7387\uff08high coverage\uff09\uff0c\u5373\u4f7f\u9884\u6d4b\u9519\u8bef\uff0c\u5176\u60e9\u7f5a\uff08\u6d6a\u8d39\u7684\u5e26\u5bbd\u548c\u7f13\u5b58\u6c61\u67d3\uff09\u4e5f\u8f83\u5c0f\u3002</li> <li>\u533a\u57df\u4ef2\u88c1\u673a\u5236\uff1a\u5f53\u591a\u4e2a\u533a\u57df\u540c\u65f6\u88ab\u89e6\u53d1\u65f6\uff0c\u6839\u636e\u9884\u8bbe\u7684\u4f18\u5148\u7ea7\uff082KB-(PC,address) &gt; 16KB &gt; 4KB &gt; 2KB-(PC,offset)\uff09\u548c\u53bb\u91cd\u903b\u8f91\u9009\u62e9\u6700\u4f18\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u907f\u514d\u4e86\u5197\u4f59\u548c\u51b2\u7a81\u3002</li> </ul> <p></p> <p>Figure 2: The multi-offset trigger mechanism can distinguish \"common-origin, later-divergent\" access streams</p> <p></p> <p>Figure 3: By using more access offsets in a trigger, we can trade off between the accuracy and coverage of prefetching. Specifically, a), b),and c) correspond to 16 KB-region, 4 KBregion, and 2 KB-region.</p> <ul> <li>\u8bbe\u8ba1\u4e86\u4e00\u79cd\u5206\u5c42\u7684\u7247\u4e0a/\u7247\u4e0b\u5143\u6570\u636e\u5b58\u50a8\u673a\u5236\uff0c\u4ee5\u6700\u5c0f\u5316\u6574\u4f53\u5f00\u9500\uff1a</li> <li>\u7247\u4e0a\u5b58\u50a8\uff1a\u5b58\u653e\u5bf9\u5ef6\u8fdf\u654f\u611f\u7684\u7ec4\u4ef6\uff0c\u5305\u62ec 2KB/4KB \u533a\u57df\u7684\u6a21\u5f0f\u8868\uff08PHT\uff09\u3001\u8bad\u7ec3\u5355\u5143\uff08Training Unit\uff09\u548c\u63a7\u5236\u5143\u6570\u636e\u3002</li> <li>\u7247\u4e0b\u5b58\u50a8\uff08\u4e3b\u5b58\uff09\uff1a\u5b58\u653e\u8bbf\u95ee\u9891\u7387\u8f83\u4f4e\u3001\u4f46\u5360\u7528\u7a7a\u95f4\u5de8\u5927\u7684 16KB \u533a\u57df\u6a21\u5f0f\u3002\u8be5\u8bbe\u8ba1\u5229\u7528\u4e86 16KB \u5927\u9884\u53d6\u6d41\u672c\u8eab\u5bf9\u5143\u6570\u636e\u8bbf\u95ee\u5ef6\u8fdf\u7684\u5929\u7136\u5bb9\u5fcd\u5ea6\uff08latency tolerance\uff09\u3002</li> <li>\u4e24\u7ea7\u7f13\u5b58\u7ed3\u6784\uff1a\u4e3a 16KB \u6a21\u5f0f\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u5c0f\u578b\u7684\u7247\u4e0a PHT Cache\uff0c\u5e76\u914d\u5408\u4e00\u4e2a Valid Map \u6765\u7ba1\u7406\u7247\u5916\u5b58\u50a8\u7684\u6709\u6548\u6027\uff0c\u4ec5\u5f53\u6a21\u5f0f\u7684\u9884\u53d6\u8ba1\u6570\uff08prefetch count\uff09\u8d85\u8fc7\u9608\u503c\u65f6\u624d\u8fdb\u884c\u7247\u5916\u8bfb\u5199\uff0c\u6709\u6548\u51cf\u5c11\u4e86\u4e0d\u5fc5\u8981\u7684\u7247\u5916\u8bbf\u95ee\u3002</li> </ul> <p></p> <p>Table 2: Categorization of RICH's metadata</p> <p></p> <p>Figure 4: Achieving high accuracy in large spatial regions and high coverage in small spatial regions by using different numbers of trigger offsets Figure 5: Placing 16 KB PHT off-chip keeps most prefetch opportunities, even with additional memory access latency</p> <ul> <li>\u5b9e\u9a8c\u8bc4\u4f30\u7ed3\u679c\u663e\u8457\uff1a</li> <li>\u5728\u5e38\u89c4\u7cfb\u7edf\u4e2d\uff0cRICH \u76f8\u6bd4\u5f53\u524d\u6700\u5148\u8fdb\u7684 Bingo \u9884\u53d6\u5668\u5b9e\u73b0\u4e86 3.4% \u7684\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u5728\u6a21\u62df\u672a\u6765\u9ad8\u5ef6\u8fdf\u5185\u5b58\u7cfb\u7edf\uff08\u989d\u5916\u589e\u52a0 120ns \u5ef6\u8fdf\uff09\u7684\u573a\u666f\u4e0b\uff0cRICH \u7684\u4f18\u52bf\u66f4\u4e3a\u7a81\u51fa\uff0c\u6027\u80fd\u63d0\u5347\u5206\u522b\u8fbe\u5230 8.3%\uff08vs. Bingo\uff09\u548c 6.2%\uff08vs. PMP\uff09\u3002</li> <li>RICH \u5728\u8986\u76d6\u7387\u548c\u53ca\u65f6\u6027\u4e0a\u5747\u6709\u5927\u5e45\u63d0\u5347\uff0c\u540c\u65f6\u4fdd\u6301\u4e86\u4e0e Bingo \u76f8\u5f53\u7684\u51c6\u786e\u6027\u3002</li> </ul> <p></p> <p>Figure 10: RICH improves coverage and timeliness while maintaining comparable accuracy</p> <p></p> <p>Figure 14: Performance under different memory bandwidth</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u67b6\u6784\u6982\u89c8</p> <p>RICH (Storing Rich Information in Memory to Trade Capacity and Bandwidth for Latency Hiding) \u662f\u4e00\u79cd\u65b0\u578b\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u5176\u6838\u5fc3\u8bbe\u8ba1\u54f2\u5b66\u662f\u5229\u7528\u672a\u6765\u9ad8\u5e26\u5bbd\u3001\u5927\u5bb9\u91cf\u4f46\u9ad8\u5ef6\u8fdf\u7684\u5185\u5b58\u7cfb\u7edf\uff08\u5982 NVM \u6216 CXL-based memory pooling\uff09\u7279\u6027\uff0c\u901a\u8fc7\u6218\u7565\u6027\u5730\u6d88\u8017\u989d\u5916\u7684\u5185\u5b58\u5bb9\u91cf\u548c\u5e26\u5bbd\u6765\u6362\u53d6\u66f4\u4f4e\u7684\u6709\u6548\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\u3002\u5176\u67b6\u6784\u56f4\u7ed5\u4e24\u4e2a\u5173\u952e\u6d1e\u5bdf\u6784\u5efa\uff1a\u4e00\u662f\u5229\u7528\u591a\u5c3a\u5ea6\u7a7a\u95f4\u5c40\u90e8\u6027\uff0c\u4e8c\u662f\u91c7\u7528\u7247\u4e0a/\u7247\u4e0b\u5206\u5c42\u5b58\u50a8\u6765\u7ba1\u7406\u4e30\u5bcc\u7684\u5143\u6570\u636e\u3002</p> <p>\u591a\u5c3a\u5ea6\u7a7a\u95f4\u9884\u53d6\u4e0e\u4ef2\u88c1\u673a\u5236</p> <ul> <li>RICH \u540c\u65f6\u652f\u6301 2 KB\u30014 KB \u548c 16 KB \u4e09\u79cd\u4e0d\u540c\u7c92\u5ea6\u7684\u7a7a\u95f4\u533a\u57df\u9884\u53d6\uff0c\u4ee5\u9002\u5e94\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u5bf9\u7a7a\u95f4\u5c40\u90e8\u6027\u7684\u591a\u6837\u5316\u9700\u6c42\u3002</li> <li>\u4e3a\u5e73\u8861\u51c6\u786e\u6027 (Accuracy)\u4e0e\u8986\u76d6\u7387 (Coverage)\uff0cRICH \u4e3a\u4e0d\u540c\u533a\u57df\u5927\u5c0f\u8bbe\u8ba1\u4e86\u5dee\u5f02\u5316\u7684\u89e6\u53d1\u673a\u5236\uff1a</li> <li>16 KB \u5927\u533a\u57df\uff1a\u91c7\u7528 (PC, 5 offsets) \u7684\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u3002\u8be5\u673a\u5236\u901a\u8fc7\u89c2\u5bdf\u4e00\u4e2a\u533a\u57df\u5185\u81f3\u5c115\u4e2a\u4e0d\u540c\u7684\u8bbf\u95ee\u504f\u79fb\u91cf\u540e\u518d\u89e6\u53d1\u9884\u53d6\uff0c\u663e\u8457\u63d0\u9ad8\u4e86\u9884\u6d4b\u7684\u51c6\u786e\u6027\uff08&gt;90%\uff09\uff0c\u4f46\u727a\u7272\u4e86\u90e8\u5206\u8986\u76d6\u7387\u3002\u8fd9\u89e3\u51b3\u4e86\u4f20\u7edf\u5355\u504f\u79fb\u89e6\u53d1\u5728\u5927\u533a\u57df\u4e0a\u56e0\u201c\u540c\u6e90\u5f02\u6d41\u201d\uff08common-origin, later-divergent\uff09\u8bbf\u95ee\u6a21\u5f0f\u800c\u5bfc\u81f4\u7684\u9ad8\u8bef\u9884\u53d6\u7387\u95ee\u9898\u3002</li> <li>4 KB \u4e2d\u533a\u57df\uff1a\u91c7\u7528 (PC, 3 offsets) \u89e6\u53d1\u673a\u5236\uff0c\u4f5c\u4e3a\u51c6\u786e\u6027\u548c\u8986\u76d6\u7387\u7684\u6298\u4e2d\u3002</li> <li>2 KB \u5c0f\u533a\u57df\uff1a\u6cbf\u7528 Bingo \u7684\u89e6\u53d1\u65b9\u5f0f\uff0c\u5305\u62ec (PC, offset) \u548c (PC, address)\u3002\u5176\u4e2d (PC, address) \u89e6\u53d1\u80fd\u6355\u83b7\u90e8\u5206\u65f6\u95f4\u5c40\u90e8\u6027\uff0c\u4e14\u56e0\u5176\u8bef\u9884\u53d6\u4ee3\u4ef7\u4f4e\uff0c\u88ab\u8d4b\u4e88\u6700\u9ad8\u4f18\u5148\u7ea7\u3002</li> <li>\u5f53\u591a\u4e2a\u533a\u57df\u540c\u65f6\u88ab\u89e6\u53d1\u65f6\uff0cRICH \u901a\u8fc7\u4e00\u4e2a\u533a\u57df\u4ef2\u88c1\u5355\u5143 (Region Arbitration) \u8fdb\u884c\u51b3\u7b56\uff1a</li> <li>\u91c7\u7528\u56fa\u5b9a\u4f18\u5148\u7ea7\u7b56\u7565\uff1a2KB-(PC,address) &gt; 16KB &gt; 4KB &gt; 2KB-(PC,offset)\u3002</li> <li>\u5f15\u5165\u53bb\u91cd\u673a\u5236\uff1a\u4e00\u65e6\u5927\u533a\u57df\uff08\u598216KB\uff09\u9884\u53d6\u88ab\u89e6\u53d1\uff0c\u5728\u5176\u5b8c\u6210\u524d\u4f1a\u963b\u6b62\u5176\u8986\u76d6\u8303\u56f4\u5185\u7684\u5c0f\u533a\u57df\uff08\u59824KB\u30012KB\uff09\u518d\u6b21\u89e6\u53d1\uff0c\u4ee5\u907f\u514d\u5197\u4f59\u548c\u4f4e\u6548\u7684\u9884\u53d6\u3002</li> </ul> <p></p> <p>Figure 8: The Region Arbitration unit selects the appropriate region to prefetch (Step P3)</p> <p>\u7247\u4e0a/\u7247\u4e0b\u5206\u5c42\u5143\u6570\u636e\u5b58\u50a8</p> <ul> <li>RICH \u5bf9\u5176\u5143\u6570\u636e\u8fdb\u884c\u7ec6\u81f4\u5206\u7c7b\uff0c\u5e76\u6839\u636e\u8bbf\u95ee\u9891\u7387\u3001\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6\u548c\u9762\u79ef\u5f00\u9500\u5c06\u5176\u667a\u80fd\u5730\u5206\u914d\u5230\u7247\u4e0a\u6216\u7247\u4e0b\u5b58\u50a8\uff0c\u4ee5\u6700\u5c0f\u5316\u6574\u4f53\u5f00\u9500\u3002</li> <li>\u9002\u5408\u7247\u4e0b\u5b58\u50a8\u7684\u5143\u6570\u636e\uff1a</li> <li>16 KB \u533a\u57df\u7684\u6a21\u5f0f\u5386\u53f2\u8868 (PHT)\uff1a\u8fd9\u4e9b\u6a21\u5f0f\u5411\u91cf\uff08256-bit\uff09\u6570\u91cf\u5e9e\u5927\uff0c\u5168\u90e8\u653e\u5728\u7247\u4e0a\u4f1a\u5bfc\u81f4\u8d85\u8fc7 100 KB \u7684\u6602\u8d35\u5f00\u9500\u3002\u7531\u4e8e16KB\u9884\u53d6\u672c\u8eab\u5177\u6709\u9ad8\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6\uff08\u4e00\u6b21\u9884\u53d6\u5927\u91cf\u6570\u636e\uff09\uff0c\u56e0\u6b64\u5927\u90e8\u5206\u4f4e\u9891\u8bbf\u95ee\u768416KB\u6a21\u5f0f\u88ab\u5378\u8f7d\u5230\u4e3b\u5b58\u4e2d\u3002</li> <li>\u91c7\u7528\u4e24\u7ea7\u5b58\u50a8\u7b56\u7565\uff1a\u4e00\u4e2a\u5c0f\u578b\u7684 256-entry \u7247\u4e0a PHT Cache \u7f13\u5b58\u9ad8\u9891\u6a21\u5f0f\uff0c\u800c\u5b8c\u6574\u7684 4096-entry PHT \u5b58\u50a8\u5728\u7247\u4e0b\u4e3b\u5b58\uff08\u5360\u7528 128 KB\uff09\u3002</li> <li>\u5f15\u5165\u5199\u56de\u8fc7\u6ee4\u673a\u5236\uff1a\u53ea\u6709\u5f53\u4e00\u4e2a16KB\u6a21\u5f0f\u7684\u9884\u53d6\u8ba1\u6570\uff08\u5373\u4f4d\u5411\u91cf\u4e2d'1'\u7684\u6570\u91cf\uff09\u8d85\u8fc7\u9608\u503c\uff08\u598230\uff09\u65f6\uff0c\u624d\u5c06\u5176\u4ece\u7247\u4e0a\u7f13\u5b58\u5199\u56de\u5230\u7247\u4e0bPHT\uff0c\u4ee5\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u7247\u5916\u8bbf\u95ee\u3002</li> <li>\u9002\u5408\u7247\u4e0a\u5b58\u50a8\u7684\u5143\u6570\u636e\uff1a</li> <li>2 KB \u548c 4 KB \u533a\u57df\u7684 PHT\uff1a\u5bf9\u5ef6\u8fdf\u654f\u611f\uff0c\u5fc5\u987b\u4fdd\u7559\u5728\u7247\u4e0a\u4ee5\u4fdd\u8bc1\u53ca\u65f6\u54cd\u5e94\u3002</li> <li>\u8bad\u7ec3\u5355\u5143 (Training Unit)\uff1a\u5305\u542b\u8fc7\u6ee4\u8868 (FT) \u548c\u7d2f\u79ef\u8868 (AT)\uff0c\u7528\u4e8e\u5728\u7ebf\u5b66\u4e60\u8bbf\u95ee\u6a21\u5f0f\uff0c\u9700\u9891\u7e41\u4e0eL2 Cache\u4ea4\u4e92\u3002</li> <li>\u63a7\u5236\u5143\u6570\u636e\uff1a\u5982\u98de\u884c\u4e2d\u9884\u53d6\u8868 (Inflight Prefetch Table) \u548c\u4ef2\u88c1\u903b\u8f91\uff0c\u9762\u79ef\u5c0f\u4f46\u8bbf\u95ee\u9891\u7e41\u3002</li> </ul> <p></p> <p>Table 2: Categorization of RICH's metadata</p> <p>\u7aef\u5230\u7aef\u5de5\u4f5c\u6d41\u7a0b</p> <ul> <li>\u8bad\u7ec3\u8fc7\u7a0b\uff1a\u5f53\u53d1\u751fL2 Cache Miss\u6216\u547d\u4e2d\u9884\u53d6\u884c\u65f6\uff0c\u8bad\u7ec3\u5355\u5143\u4f1a\u8bb0\u5f55\u8bbf\u95ee\u4fe1\u606f\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u533a\u57df\uff0c\u5148\u5728FT\u4e2d\u8bb0\u5f55\u8bbf\u95ee\uff0c\u5f53\u89c2\u5bdf\u5230\u8db3\u591f\u591a\u7684\u4e0d\u540c\u504f\u79fb\u540e\uff0c\u5c06\u6a21\u5f0f\u63d0\u5347\u5230AT\u4e2d\u7d2f\u79ef\u6210\u4f4d\u5411\u91cf\uff0c\u6700\u7ec8\u5b58\u5165\u5bf9\u5e94\u7684PHT\u3002</li> <li>\u7247\u4e0a\u9884\u6d4b\u8fc7\u7a0b\uff1a</li> <li>\u67e5\u627e\u9636\u6bb5\uff1aLookup Units \u4f7f\u7528FIFO\u7f13\u51b2\u533a\u6536\u96c6\u6700\u8fd1\u7684\u8bbf\u95ee\u504f\u79fb\uff0c\u4ee5\u5f62\u6210\u89e6\u53d1\u6761\u4ef6\u3002</li> <li>\u67e5\u8be2\u9636\u6bb5\uff1a\u6ee1\u8db3\u89e6\u53d1\u6761\u4ef6\u540e\uff0c\u67e5\u8be2\u5bf9\u5e94\u7684\u7247\u4e0aPHT\u3002\u82e516KB PHT\u672a\u547d\u4e2d\uff0c\u5219\u8fdb\u5165\u7247\u4e0b\u9884\u6d4b\u6d41\u7a0b\u3002</li> <li>\u4ef2\u88c1\u9636\u6bb5\uff1aRegion Arbitration\u5355\u5143\u6839\u636e\u4f18\u5148\u7ea7\u548c\u53bb\u91cd\u89c4\u5219\uff0c\u51b3\u5b9a\u6700\u7ec8\u6267\u884c\u54ea\u4e2a\u533a\u57df\u7684\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>\u7247\u4e0b\u9884\u6d4b\u8fc7\u7a0b (\u4ec516KB)\uff1a</li> <li>\u5f53\u7247\u4e0aPHT\u672a\u547d\u4e2d\u4f46\u7247\u4e0bValid Map\u6307\u793a\u5b58\u5728\u6709\u6548\u6a21\u5f0f\u65f6\uff0c\u5f02\u6b65\u53d1\u8d77\u7247\u5916\u5143\u6570\u636e\u52a0\u8f7d\u8bf7\u6c42\u3002</li> <li>\u5728\u7b49\u5f85\u5143\u6570\u636e\u8fd4\u56de\u671f\u95f4\uff0c\u7cfb\u7edf\u4f1a\u8ddf\u8e2a\u5904\u7406\u5668\u5bf9\u76ee\u680716KB\u533a\u57df\u7684\u201c\u8fdf\u5230\u8bbf\u95ee\u201d\uff08late prefetches\uff09\uff0c\u5e76\u5728\u5143\u6570\u636e\u8fd4\u56de\u540e\uff0c\u4ece\u9884\u53d6\u6d41\u4e2d\u5254\u9664\u8fd9\u4e9b\u5df2\u88ab\u8bbf\u95ee\u7684\u5b50\u533a\u57df\uff0c\u4ee5\u907f\u514d\u65e0\u7528\u9884\u53d6\u3002</li> <li>\u6700\u7ec8\uff0c\u4fee\u526a\u540e\u7684\u9884\u53d6\u8bf7\u6c42\u88ab\u9001\u5165\u4ef2\u88c1\u5355\u5143\u5e76\u751f\u6210\u9884\u53d6\u6d41\u3002</li> </ul> <p></p> <p>Figure 6: Architecture of RICH</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#1_1","title":"1. \u591a\u5c3a\u5ea6\u7a7a\u95f4\u9884\u53d6\u4e0e\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236","text":"<p>\u591a\u5c3a\u5ea6\u7a7a\u95f4\u9884\u53d6\u4e0e\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u7684\u5b9e\u73b0\u539f\u7406</p> <p>RICH\u9884\u53d6\u5668\u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\u5176\u591a\u5c3a\u5ea6\u7a7a\u95f4\u9884\u53d6\uff08multi-scale spatial prefetching\uff09\u4e0e\u591a\u504f\u79fb\u89e6\u53d1\uff08multi-offset trigger\uff09\u673a\u5236\uff0c\u8be5\u673a\u5236\u901a\u8fc7\u52a8\u6001\u9009\u62e9\u4e0d\u540c\u7c92\u5ea6\u7684\u7a7a\u95f4\u533a\u57df\u5e76\u5339\u914d\u76f8\u5e94\u7684\u89e6\u53d1\u7b56\u7565\uff0c\u4ee5\u534f\u540c\u4f18\u5316\u8986\u76d6\u7387\uff08Coverage\uff09\u548c\u51c6\u786e\u6027\uff08Accuracy\uff09\u3002</p> <ul> <li>\u533a\u57df\u5c3a\u5bf8\u4e0e\u89e6\u53d1\u6761\u4ef6\u7684\u5dee\u5f02\u5316\u8bbe\u8ba1\uff1a</li> <li>16KB\u5927\u533a\u57df\uff1a\u91c7\u7528 (PC, 5 offsets) \u89e6\u53d1\u6761\u4ef6\u3002\u6b64\u8bbe\u8ba1\u65e8\u5728\u89e3\u51b3\u201ccommon-origin, later-divergent\u201d\uff08\u540c\u6e90\u5f02\u6d41\uff09\u95ee\u9898\uff0c\u5373\u591a\u4e2a\u8bbf\u95ee\u6d41\u8d77\u59cb\u4e8e\u540c\u4e00\u504f\u79fb\u4f46\u540e\u7eed\u8f68\u8ff9\u4e0d\u540c\u3002\u901a\u8fc7\u89c2\u5bdf\u524d5\u4e2a\u4e0d\u540c\u7684\u8bbf\u95ee\u504f\u79fb\uff0c\u53ef\u4ee5\u9ad8\u7f6e\u4fe1\u5ea6\u5730\u9a8c\u8bc1\u8bbf\u95ee\u6d41\u7684\u65b9\u5411\uff0c\u4ece\u800c\u5b9e\u73b0accuracy-first\uff08\u7cbe\u5ea6\u4f18\u5148\uff09\u7b56\u7565\u3002</li> </ul> <p></p> <p>Figure 3: By using more access offsets in a trigger, we can trade off between the accuracy and coverage of prefetching. Specifically, a), b),and c) correspond to 16 KB-region, 4 KBregion, and 2 KB-region.</p> <ul> <li>4KB\u4e2d\u7b49\u533a\u57df\uff1a\u91c7\u7528 (PC, 3 offsets) \u89e6\u53d1\u6761\u4ef6\u3002\u4f5c\u4e3a16KB\u548c2KB\u4e4b\u95f4\u7684\u6298\u8877\uff0c\u5728\u4fdd\u8bc1\u8f83\u9ad8\u51c6\u786e\u6027\u7684\u540c\u65f6\uff0c\u63d0\u4f9b\u6bd416KB\u66f4\u5e7f\u7684\u8986\u76d6\u8303\u56f4\u3002</li> <li> <p>2KB\u5c0f\u533a\u57df\uff1a\u6cbf\u7528Bingo\u7684\u4e24\u79cd\u89e6\u53d1\u65b9\u5f0f\uff1a</p> <ul> <li>(PC, offset)\uff1a\u7528\u4e8e\u6355\u6349\u57fa\u672c\u7684\u7a7a\u95f4\u5c40\u90e8\u6027\uff0c\u5b9e\u73b0coverage-first\uff08\u8986\u76d6\u4f18\u5148\uff09\u7b56\u7565\uff0c\u786e\u4fdd\u5e7f\u6cdb\u7684\u6a21\u5f0f\u6355\u83b7\u3002</li> <li>(PC, address)\uff1a\u7528\u4e8e\u6355\u6349\u7279\u5b9a\u7684\u65f6\u5e8f\u5c40\u90e8\u6027\uff08temporal locality\uff09\uff0c\u5176\u51c6\u786e\u6027\u4e0e16KB\u533a\u57df\u76f8\u5f53\uff0c\u4f46\u8bef\u9884\u53d6\u6210\u672c\u6781\u4f4e\u3002</li> </ul> </li> <li> <p>\u8f93\u5165\u4e0e\u8f93\u51fa\u5173\u7cfb\uff1a</p> </li> <li>\u8f93\u5165\uff1a\u5904\u7406\u5668\u6838\u5fc3\u4ea7\u751f\u7684L2\u7f13\u5b58\u672a\u547d\u4e2d\uff08demand miss\uff09\u6216\u5bf9\u9884\u53d6\u6570\u636e\u7684\u547d\u4e2d\uff08hit on prefetch\uff09\u4e8b\u4ef6\uff0c\u5305\u542b\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\u548c\u865a\u62df\u5730\u5740\uff08address\uff09\u3002</li> <li>\u5904\u7406\u6d41\u7a0b\uff1a<ol> <li>\u504f\u79fb\u6536\u96c6\uff1aLookup Unit\u4e3a\u6bcf\u4e2a\u6d3b\u52a8\u7684\u533a\u57df\u7ef4\u62a4\u4e00\u4e2aFIFO\u7f13\u51b2\u533a\uff0c\u6301\u7eed\u6536\u96c6\u8bbf\u95ee\u504f\u79fb\u300216KB\u533a\u57df\u7684FIFO\u6df1\u5ea6\u4e3a5\uff0c4KB\u4e3a3\uff0c2KB\u5219\u65e0\u9700FIFO\u3002</li> <li>\u89e6\u53d1\u5224\u5b9a\uff1a\u5f53FIFO\u88ab\u586b\u6ee1\uff08\u5bf9\u4e8e16KB/4KB\uff09\u6216\u53d1\u751f\u5355\u6b21\u8bbf\u95ee\uff08\u5bf9\u4e8e2KB\uff09\u65f6\uff0c\u751f\u6210\u5bf9\u5e94\u7684\u89e6\u53d1\u4e8b\u4ef6\u3002</li> <li>\u6a21\u5f0f\u67e5\u8be2\uff1a\u4f7f\u7528\u89e6\u53d1\u4e8b\u4ef6\uff08\u5982\u54c8\u5e0c\u540e\u7684(PC, 5 offsets)\uff09\u67e5\u8be2\u7247\u4e0aPattern History Table (PHT)\u3002</li> <li>\u533a\u57df\u4ef2\u88c1\uff1a\u82e5\u591a\u4e2a\u533a\u57df\u540c\u65f6\u89e6\u53d1\uff0c\u5219\u6839\u636e\u9884\u8bbe\u7684\u56fa\u5b9a\u4f18\u5148\u7ea7\u8fdb\u884c\u4ef2\u88c1\u3002</li> </ol> </li> <li>\u8f93\u51fa\uff1a\u4e00\u4e2a\u7ecf\u8fc7\u4ef2\u88c1\u7684\u3001\u6700\u4f18\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u5305\u542b\u76ee\u6807\u533a\u57df\u6807\u7b7e\u548c\u5bf9\u5e94\u7684\u4f4d\u5411\u91cf\uff08bit-vector\uff09\u6a21\u5f0f\uff0c\u7528\u4e8e\u751f\u6210\u5177\u4f53\u7684\u9884\u53d6\u6d41\u3002</li> </ul> <p>\u533a\u57df\u4ef2\u88c1\u4e0e\u534f\u540c\u5de5\u4f5c\u673a\u5236</p> <p>\u4e3a\u907f\u514d\u4e0d\u540c\u5c3a\u5ea6\u9884\u53d6\u95f4\u7684\u5197\u4f59\u548c\u51b2\u7a81\uff0cRICH\u8bbe\u8ba1\u4e86\u4e00\u5957\u7cbe\u7ec6\u7684Region Arbitration\uff08\u533a\u57df\u4ef2\u88c1\uff09\u5355\u5143\u3002</p> <ul> <li>\u4ef2\u88c1\u4f18\u5148\u7ea7\u89c4\u5219\uff08\u4ece\u9ad8\u5230\u4f4e\uff09\uff1a</li> <li>2KB\u533a\u57df\uff08\u7531 (PC, address) \u89e6\u53d1\uff09</li> <li>16KB\u533a\u57df\uff08\u7531 (PC, 5 offsets) \u89e6\u53d1\uff09</li> <li>4KB\u533a\u57df\uff08\u7531 (PC, 3 offsets) \u89e6\u53d1\uff09</li> <li> <p>2KB\u533a\u57df\uff08\u7531 (PC, offset) \u89e6\u53d1\uff09</p> </li> <li> <p>\u53bb\u91cd\u673a\u5236\uff08De-duplication\uff09\uff1a</p> </li> <li>\u4e00\u65e6\u4e00\u4e2a\u5927\u533a\u57df\uff08\u598216KB\uff09\u7684\u9884\u53d6\u88ab\u89e6\u53d1\u5e76\u5f00\u59cb\u6267\u884c\uff0c\u5728\u5176\u5b8c\u6210\u524d\uff0c\u4f1a\u963b\u6b62\u5176\u5185\u90e8\u6240\u6709\u5b50\u533a\u57df\uff084KB\u548c2KB\uff09\u7684\u9884\u53d6\u89e6\u53d1\u3002</li> <li>\u8fd9\u4e00\u673a\u5236\u57fa\u4e8e\u4e00\u4e2a\u5173\u952e\u6d1e\u5bdf\uff1a\u5927\u533a\u57df\u9884\u53d6\u5728\u591a\u504f\u79fb\u89e6\u53d1\u4e0b\u5177\u6709\u66f4\u9ad8\u7684\u51c6\u786e\u6027\uff0c\u5e94\u4f18\u5148\u4fdd\u969c\u5176\u6267\u884c\uff0c\u907f\u514d\u88ab\u4f4e\u51c6\u786e\u6027\u7684\u5c0f\u533a\u9884\u53d6\u5e72\u6270\u3002</li> <li>\u540c\u65f6\uff0c\u4e3a\u4e86\u9632\u6b62\u5927\u533a\u57df\u9884\u53d6\u56e0\u89e6\u53d1\u6761\u4ef6\u82db\u523b\uff08\u97005\u6b21\u8bbf\u95ee\uff09\u800c\u5bfc\u81f4\u673a\u4f1a\u4e22\u5931\uff0c\u5c0f\u533a\u57df\u9884\u53d6\u53ef\u4ee5\u5148\u884c\u542f\u52a8\uff0c\u786e\u4fdd\u5728\u5927\u533a\u57df\u6a21\u5f0f\u786e\u8ba4\u524d\u4e0d\u4e22\u5931\u65e9\u671f\u7684\u9884\u53d6\u673a\u4f1a\u3002</li> </ul> <p></p> <p>Figure 8: The Region Arbitration unit selects the appropriate region to prefetch (Step P3)</p> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u6027\u80fd\u6743\u8861</p> <p>\u8be5\u673a\u5236\u7684\u5173\u952e\u53c2\u6570\uff08\u5982\u504f\u79fb\u6570\u91cf\u3001PHT\u5927\u5c0f\uff09\u5747\u7ecf\u8fc7\u5b9e\u9a8c\u8c03\u4f18\uff0c\u4ee5\u5728\u6027\u80fd\u548c\u5f00\u9500\u95f4\u53d6\u5f97\u6700\u4f73\u5e73\u8861\u3002</p> <ul> <li>\u591a\u504f\u79fb\u89e6\u53d1\u7684\u6743\u8861\u6548\u5e94\uff1a</li> <li>\u589e\u52a0\u89e6\u53d1\u6240\u9700\u7684\u504f\u79fb\u6570\u91cf\u4f1a\u663e\u8457\u63d0\u9ad8\u51c6\u786e\u6027\uff0c\u4f46\u4f1a\u964d\u4f4e\u8986\u76d6\u7387\uff0c\u56e0\u4e3a\u66f4\u4e25\u683c\u7684\u89e6\u53d1\u6761\u4ef6\u66f4\u96be\u88ab\u6ee1\u8db3\u3002</li> <li></li> </ul> <p></p> <p>Figure 2: The multi-offset trigger mechanism can distinguish \"common-origin, later-divergent\" access streams</p> <p>\u5c55\u793a\u4e86\u591a\u504f\u79fb\u5982\u4f55\u533a\u5206\u540c\u6e90\u5f02\u6d41\u7684\u8bbf\u95ee\u6a21\u5f0f\u3002   - </p> <p></p> <p>Figure 3: By using more access offsets in a trigger, we can trade off between the accuracy and coverage of prefetching. Specifically, a), b),and c) correspond to 16 KB-region, 4 KBregion, and 2 KB-region.</p> <p>\u7684\u56fe\u8868(a)(b)(c)\u6e05\u6670\u5730\u91cf\u5316\u4e86\u572816KB\u30014KB\u30012KB\u533a\u57df\u4e0a\uff0c\u504f\u79fb\u6570\u91cf\u4e0e\u51c6\u786e\u7387\u3001\u8986\u76d6\u7387\u4e4b\u95f4\u7684\u6b64\u6d88\u5f7c\u957f\u5173\u7cfb\u3002</p> <ul> <li>PHT\u5bb9\u91cf\u654f\u611f\u6027\uff1a</li> <li>2KB PHT\uff1a\u7531\u4e8e(PC, address)\u89e6\u53d1\u4f1a\u4ea7\u751f\u5927\u91cf\u6761\u76ee\uff0c\u5176\u6027\u80fd\u57284096\u4e2a\u6761\u76ee\u65f6\u8fbe\u5230\u9971\u548c\u3002</li> <li>4KB PHT\uff1a\u57281024\u4e2a\u6761\u76ee\u65f6\u6027\u80fd\u9971\u548c\u3002</li> <li>16KB PHT (\u7247\u4e0a\u7f13\u5b58)\uff1a\u4ec5\u9700256\u4e2a\u6761\u76ee\u5373\u53ef\u83b7\u5f97\u63a5\u8fd1\u6700\u4f18\u7684\u6027\u80fd\uff0c\u8fd9\u5f97\u76ca\u4e8e\u5176\u5206\u5c42\u5b58\u50a8\u8bbe\u8ba1\u2014\u2014\u4f4e\u9891\u6a21\u5f0f\u88ab\u5378\u8f7d\u5230\u7247\u5916\u5185\u5b58\uff0c\u7247\u4e0a\u7f13\u5b58\u53ea\u9700\u4fdd\u7559\u9ad8\u9891\u70ed\u70b9\u6a21\u5f0f\u3002<ul> <li></li> </ul> </li> </ul> <p></p> <p>Table 3: Cover ratio under a 2oo-entry storage constraint of 16 KB-region patterns</p> <p>\u663e\u793a\uff0c\u4ec5200\u4e2a\u7247\u4e0a\u6761\u76ee\u5c31\u80fd\u8986\u76d6\u5927\u90e8\u520616KB\u9884\u53d6\u8bf7\u6c42\u3002</p> <p>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <p>\u8be5\u673a\u5236\u662fRICH\u5b9e\u73b0\u5176\u8bbe\u8ba1\u54f2\u5b66\u2014\u2014\u201c\u7528\u5bb9\u91cf\u548c\u5e26\u5bbd\u6362\u53d6\u5ef6\u8fdf\u9690\u85cf\u201d\u2014\u2014\u7684\u5173\u952e\u6267\u884c\u5355\u5143\u3002</p> <ul> <li>\u63d0\u5347\u8986\u76d6\u7387\uff1a\u901a\u8fc72KB\u5c0f\u533a\u57df\u7684\u5e7f\u6cdb\u89e6\u53d1\uff0c\u6355\u83b7\u4e86\u4f20\u7edf4KB\u56fa\u5b9a\u7c92\u5ea6\u9884\u53d6\u5668\u65e0\u6cd5\u8986\u76d6\u7684\u7ec6\u7c92\u5ea6\u6216\u8de8\u9875\u7a7a\u95f4\u5c40\u90e8\u6027\u3002</li> <li>\u63d0\u5347\u53ca\u65f6\u6027\uff08Timeliness\uff09\uff1a\u901a\u8fc716KB\u5927\u533a\u57df\u7684\u6279\u91cf\u9884\u53d6\uff0c\u5145\u5206\u5229\u7528\u9ad8\u5e26\u5bbd\u5185\u5b58\u7684\u4f18\u52bf\uff0c\u5728\u4e00\u6b21\u89e6\u53d1\u4e2d\u586b\u5145\u5927\u91cf\u6570\u636e\uff0c\u663e\u8457\u589e\u52a0\u4e86\u9884\u53d6\u8ddd\u79bb\uff0c\u4f7f\u6570\u636e\u66f4\u53ef\u80fd\u5728\u5904\u7406\u5668\u771f\u6b63\u9700\u8981\u65f6\u5df2\u5b58\u5728\u4e8e\u7f13\u5b58\u4e2d\u3002</li> <li>\u7ef4\u6301\u9ad8\u51c6\u786e\u6027\uff1a\u901a\u8fc7\u4e3a\u5927\u533a\u57df\u5f15\u5165\u591a\u504f\u79fb\u9a8c\u8bc1\uff0c\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u5927\u533a\u57df\u9884\u53d6\u6613\u8bef\u5224\u7684\u96be\u9898\uff0c\u4f7f\u5f97\u6fc0\u8fdb\u7684\u9884\u53d6\u7b56\u7565\u53d8\u5f97\u53ef\u884c\u4e14\u9ad8\u6548\u3002</li> <li>\u6700\u7ec8\u6548\u679c\uff1a\u5982 </li> </ul> <p></p> <p>Figure 10: RICH improves coverage and timeliness while maintaining comparable accuracy</p> <p>\u6240\u793a\uff0cRICH\u5728\u4fdd\u6301\u4e0eBingo\u76f8\u5f53\u7684\u51c6\u786e\u6027\uff0876.3% vs 76.6%\uff09\u7684\u540c\u65f6\uff0c\u5c06\u8986\u76d6\u7387\u4ece64%\u5927\u5e45\u63d0\u5347\u81f375%\uff0c\u5e76\u5c06\u53ca\u65f6\u6027\u4ece78%\u63d0\u5347\u81f391%\u3002</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#-516kb90","title":"- \u5b9e\u9a8c\u8868\u660e\uff0c\u4f7f\u75285\u4e2a\u504f\u79fb\u53ef\u5c0616KB\u533a\u57df\u7684\u9884\u53d6\u51c6\u786e\u6027\u63d0\u5347\u81f390%\u4ee5\u4e0a\uff0c\u6709\u6548\u907f\u514d\u4e86\u56e0\u8bef\u9884\u53d6\u5927\u91cf\u65e0\u7528\u7f13\u5b58\u884c\u800c\u9020\u6210\u7684\u5e26\u5bbd\u6d6a\u8d39\u548c\u7f13\u5b58\u6c61\u67d3\u3002","text":""},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#2_1","title":"2. \u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u533a\u57df\u4ef2\u88c1\u7b56\u7565","text":"<p>\u4ef2\u88c1\u7b56\u7565\u7684\u5b9e\u73b0\u539f\u7406\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <p>RICH \u7684\u533a\u57df\u4ef2\u88c1\uff08Region Arbitration\uff09\u5355\u5143\u662f\u5176\u591a\u5c3a\u5ea6\u9884\u53d6\u673a\u5236\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23\u5728\u591a\u4e2a\u6f5c\u5728\u9884\u53d6\u8bf7\u6c42\u51b2\u7a81\u65f6\u505a\u51fa\u6700\u4f18\u51b3\u7b56\u3002\u5176\u5b9e\u73b0\u57fa\u4e8e\u4e00\u4e2a\u56fa\u5b9a\u4f18\u5148\u7ea7\u89c4\u5219\u548c\u4e00\u4e2a\u53bb\u91cd\uff08de-duplication\uff09 \u673a\u5236\u3002</p> <ul> <li>\u56fa\u5b9a\u4f18\u5148\u7ea7\u89c4\u5219\uff1a\u8be5\u89c4\u5219\u7684\u8bbe\u8ba1\u6e90\u4e8e\u5bf9\u4e0d\u540c\u533a\u57df\u9884\u53d6\u7279\u6027\u7684\u6df1\u523b\u6d1e\u5bdf\u3002<ul> <li>2KB-(PC,address) \u89e6\u53d1\u7684\u9884\u53d6\u62e5\u6709\u6700\u9ad8\u4f18\u5148\u7ea7\u3002\u8fd9\u662f\u56e0\u4e3a <code>(PC, address)</code> \u89e6\u53d1\u5668\u80fd\u6355\u6349\u5230\u7cbe\u786e\u7684temporal locality\uff08\u65f6\u95f4\u5c40\u90e8\u6027\uff09\uff0c\u5176accuracy\uff08\u51c6\u786e\u7387\uff09\u4e0e16KB\u533a\u57df\u76f8\u5f53\uff0c\u4f46\u5176misprediction cost\uff08\u8bef\u9884\u6d4b\u4ee3\u4ef7\uff09\u6781\u4f4e\uff0c\u56e0\u4e3a\u5b83\u53ea\u9884\u53d6\u5c11\u91cf\u7f13\u5b58\u884c\u3002</li> <li>16KB \u533a\u57df\u9884\u53d6\u7d27\u968f\u5176\u540e\u3002\u5b83\u901a\u8fc7 (PC, 5 offsets) \u89e6\u53d1\uff0c\u5b9e\u73b0\u4e86\u8d85\u8fc790%\u7684\u9ad8\u51c6\u786e\u7387\uff0c\u5e76\u80fd\u5e26\u6765\u663e\u8457\u7684\u6027\u80fd\u589e\u76ca\uff08timeliness\u9ad8\uff09\uff0c\u4f46\u8bef\u9884\u6d4b\u4ee3\u4ef7\u9ad8\u6602\u3002</li> <li>4KB \u533a\u57df\u9884\u53d6\u4f7f\u7528 (PC, 3 offsets) \u89e6\u53d1\uff0c\u4f5c\u4e3a\u4e2d\u7b49\u7c92\u5ea6\u7684\u6298\u4e2d\u65b9\u6848\uff0c\u4f18\u5148\u7ea7\u5c45\u4e2d\u3002</li> <li>2KB-(PC,offset) \u89e6\u53d1\u7684\u9884\u53d6\u4f18\u5148\u7ea7\u6700\u4f4e\u3002\u5b83\u91c7\u7528coverage-first\uff08\u8986\u76d6\u7387\u4f18\u5148\uff09\u7b56\u7565\uff0c\u89e6\u53d1\u6761\u4ef6\u5bbd\u677e\uff0c\u4f46\u51c6\u786e\u7387\u76f8\u5bf9\u8f83\u4f4e\uff0c\u4e3b\u8981\u7528\u4e8e\u515c\u5e95\u8986\u76d6\u3002</li> </ul> </li> <li>\u53bb\u91cd\uff08de-duplication\uff09\u673a\u5236\uff1a\u4e3a\u907f\u514d\u5728\u91cd\u53e0\u5185\u5b58\u7a7a\u95f4\u4e0a\u53d1\u51fa\u5197\u4f59\u9884\u53d6\u8bf7\u6c42\uff0c\u6d6a\u8d39\u5e26\u5bbd\u548c\u7f13\u5b58\u7a7a\u95f4\u3002<ul> <li>\u4e00\u65e6\u4e00\u4e2a\u66f4\u5927\u3001\u66f4\u9ad8\u4f18\u5148\u7ea7\u7684\u533a\u57df\uff08\u598216KB\uff09\u88ab\u89e6\u53d1\u5e76\u5f00\u59cb\u9884\u53d6\uff0c\u7cfb\u7edf\u4f1a\u6682\u65f6block\uff08\u963b\u585e\uff09\u5bf9\u8be5\u533a\u57df\u5185\u6240\u6709\u66f4\u5c0f\u533a\u57df\uff08\u59824KB\u548c2KB\uff09\u7684\u540e\u7eed\u89e6\u53d1\u3002</li> <li>\u8fd9\u4e00\u673a\u5236\u5efa\u7acb\u5728\u201clarger regions have higher accuracy\u201d\uff08\u66f4\u5927\u533a\u57df\u5177\u6709\u66f4\u9ad8\u51c6\u786e\u7387\uff09\u7684\u524d\u63d0\u4e4b\u4e0a\uff0c\u786e\u4fdd\u4e86\u9884\u53d6\u8d44\u6e90\u88ab\u5206\u914d\u7ed9\u6700\u53ef\u9760\u7684\u9884\u6d4b\u3002</li> </ul> </li> <li>\u5904\u7406\u665a\u89e6\u53d1\u95ee\u9898\uff1a\u4e3a\u4e86\u907f\u514d\u56e0\u7b49\u5f85\u5927\u533a\u57df\uff0816KB\uff09\u6536\u96c6\u8db3\u591f\u504f\u79fb\u91cf\uff085\u4e2a\uff09\u800c\u5bfc\u81f4\u5c0f\u533a\u57df\u9884\u53d6\u673a\u4f1a\u4e22\u5931\uff0cRICH\u5141\u8bb8\u5c0f\u533a\u57df\u9884\u53d6\u5148\u884c\u3002<ul> <li>\u4f8b\u5982\uff0c2KB\u9884\u53d6\u53ef\u4ee5\u5728\u7b2c\u4e00\u4e2a\u8bbf\u95ee\u53d1\u751f\u65f6\u5c31\u88ab\u89e6\u53d1\uff0c\u800c\u65e0\u9700\u7b49\u5f8516KB\u533a\u57df\u5b8c\u6210\u5176\u89e6\u53d1\u6761\u4ef6\u3002\u8fd9\u4fdd\u8bc1\u4e86timeliness\uff08\u53ca\u65f6\u6027\uff09\uff0c\u9632\u6b62\u56e0\u5927\u533a\u57df\u9884\u6d4b\u5ef6\u8fdf\u800c\u9519\u8fc7\u5c0f\u533a\u57df\u7684\u9884\u53d6\u7a97\u53e3\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 8: The Region Arbitration unit selects the appropriate region to prefetch (Step P3)</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528</p> <p>\u533a\u57df\u4ef2\u88c1\u5355\u5143\u7684\u8f93\u5165\u662f\u6765\u81ea\u4e09\u4e2a\u4e0d\u540c\u533a\u57df\u67e5\u627e\u5355\u5143\uff08Lookup Units\uff09\u7684\u6f5c\u5728\u9884\u53d6\u8bf7\u6c42\uff0c\u8f93\u51fa\u5219\u662f\u6700\u7ec8\u80dc\u51fa\u7684\u3001\u5c06\u8981\u88ab\u6267\u884c\u7684\u9884\u53d6\u8bf7\u6c42\u3002</p> <ul> <li>\u8f93\u5165\uff1a<ul> <li><code>req16KB</code>: \u6765\u81ea16KB\u533a\u57df\u67e5\u627e\u5355\u5143\u7684\u8bf7\u6c42\uff0c\u5305\u542b\u533a\u57df\u6807\u7b7e\uff08region_tag\uff09\u548c\u5bf9\u5e94\u7684\u4f4d\u5411\u91cf\u6a21\u5f0f\uff08pattern\uff09\u3002</li> <li><code>req4KB</code>: \u6765\u81ea4KB\u533a\u57df\u67e5\u627e\u5355\u5143\u7684\u8bf7\u6c42\u3002</li> <li><code>req2KB</code>: \u6765\u81ea2KB\u533a\u57df\u67e5\u627e\u5355\u5143\u7684\u8bf7\u6c42\uff0c\u53ef\u80fd\u7531 <code>(PC, offset)</code> \u6216 <code>(PC, address)</code> \u89e6\u53d1\u3002</li> </ul> </li> <li>\u5904\u7406\u903b\u8f91\uff1a<ol> <li>\u4f18\u5148\u7ea7\u88c1\u51b3\uff1a\u9996\u5148\u6839\u636e\u56fa\u5b9a\u7684\u4f18\u5148\u7ea7\u987a\u5e8f\uff082KB-(PC,address) &gt; 16KB &gt; 4KB &gt; 2KB-(PC,offset)\uff09\u4ece\u975e\u7a7a\u8bf7\u6c42\u4e2d\u9009\u51fa\u4e00\u4e2a\u201c\u83b7\u80dc\u8bf7\u6c42\u201d\uff08win_req\uff09\u3002</li> <li>\u91cd\u53e0\u68c0\u67e5\uff1a\u63a5\u7740\uff0c\u5c06\u8fd9\u4e2a\u83b7\u80dc\u8bf7\u6c42\u4e0e Inflight Prefetch Table\uff08\u98de\u884c\u4e2d\u9884\u53d6\u8868\uff09\u8fdb\u884c\u6bd4\u5bf9\u3002\u8be5\u8868\u8bb0\u5f55\u4e86\u6240\u6709\u6b63\u5728\u8fdb\u884c\u4e2d\u7684\u9884\u53d6\u64cd\u4f5c\u6240\u8986\u76d6\u7684\u5185\u5b58\u533a\u57df\u3002<ul> <li>\u5982\u679c\u5f53\u524d\u83b7\u80dc\u8bf7\u6c42\u4e0e\u8868\u4e2d\u4efb\u4f55\u6761\u76ee\u5b58\u5728overlap\uff08\u91cd\u53e0\uff09\uff0c\u5219\u53ea\u6709\u5f53\u5f53\u524d\u8bf7\u6c42\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u8868\u4e2d\u5bf9\u5e94\u6761\u76ee\u7684\u4f18\u5148\u7ea7\u65f6\uff0c\u624d\u4f1a\u88ab\u5141\u8bb8\u6267\u884c\uff1b\u5426\u5219\uff0c\u8be5\u8bf7\u6c42\u4f1a\u88ab\u5ffd\u7565\uff08ignored\uff09\u3002</li> </ul> </li> </ol> </li> <li>\u8f93\u51fa\uff1a<ul> <li>\u4e00\u4e2a\u7ecf\u8fc7\u53cc\u91cd\u9a8c\u8bc1\uff08\u4f18\u5148\u7ea7\u548c\u91cd\u53e0\u68c0\u67e5\uff09\u7684\u6700\u7ec8\u9884\u53d6\u8bf7\u6c42\uff0c\u8be5\u8bf7\u6c42\u5c06\u88ab\u9001\u5165 Prefetch Buffer \u5e76\u6700\u7ec8\u751f\u6210\u5177\u4f53\u7684\u9884\u53d6\u6d41\u3002</li> </ul> </li> <li>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528\uff1a<ul> <li>\u534f\u540c\u4f18\u5316\uff1a\u8be5\u7b56\u7565\u6210\u529f\u5730\u5c06\u5927\u533a\u57df\u7684high performance gain\uff08\u9ad8\u6027\u80fd\u589e\u76ca\uff09\u548c\u5c0f\u533a\u57df\u7684low misprediction penalties\uff08\u4f4e\u8bef\u9884\u6d4b\u60e9\u7f5a\uff09\u7ed3\u5408\u8d77\u6765\uff0c\u5b9e\u73b0\u4e86synergistic optimization\uff08\u534f\u540c\u4f18\u5316\uff09\u3002</li> <li>\u8d44\u6e90\u9ad8\u6548\uff1a\u901a\u8fc7\u53bb\u91cd\u548c\u4f18\u5148\u7ea7\u9009\u62e9\uff0c\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u4e86useless prefetches\uff08\u65e0\u7528\u9884\u53d6\uff09\uff0c\u63d0\u9ad8\u4e86\u5185\u5b58\u5e26\u5bbd\u548c\u7f13\u5b58\u7a7a\u95f4\u7684\u5229\u7528\u6548\u7387\u3002</li> <li>\u4fdd\u969c\u6027\u80fd\uff1a\u786e\u4fdd\u4e86\u7cfb\u7edf\u603b\u662f\u4f18\u5148\u6267\u884c\u6700\u53ef\u9760\u3001\u6536\u76ca\u6700\u9ad8\u7684\u9884\u53d6\u64cd\u4f5c\uff0c\u4ece\u800c\u5728\u590d\u6742\u591a\u53d8\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u4e0b\u7ef4\u6301\u4e86high coverage\uff08\u9ad8\u8986\u76d6\u7387\uff09\u548chigh timeliness\uff08\u9ad8\u53ca\u65f6\u6027\uff09\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#3_1","title":"3. \u5206\u5c42\u5143\u6570\u636e\u5b58\u50a8\u67b6\u6784","text":"<p>\u5206\u5c42\u5143\u6570\u636e\u5b58\u50a8\u67b6\u6784\u7684\u8bbe\u8ba1\u539f\u7406</p> <p>RICH prefetcher \u7684\u6838\u5fc3\u521b\u65b0\u4e4b\u4e00\u662f\u5176\u5206\u5c42\u5143\u6570\u636e\u5b58\u50a8\u67b6\u6784\uff0c\u8be5\u67b6\u6784\u65e8\u5728\u5229\u7528\u672a\u6765\u9ad8\u5e26\u5bbd\u3001\u5927\u5bb9\u91cf\u4f46\u9ad8\u5ef6\u8fdf\u7684\u5185\u5b58\u7cfb\u7edf\u7279\u6027\uff0c\u5728\u4e0d\u663e\u8457\u589e\u52a0\u7247\u4e0a\u9762\u79ef\u5f00\u9500\u7684\u524d\u63d0\u4e0b\uff0c\u6709\u6548\u7ba1\u7406\u7528\u4e8e\u591a\u5c3a\u5ea6\u7a7a\u95f4\u9884\u53d6\u7684\u4e30\u5bcc\u5143\u6570\u636e\u3002</p> <ul> <li>\u8bbe\u8ba1\u9a71\u52a8\u529b: \u4f20\u7edf\u7684\u9884\u53d6\u5668\u53d7\u9650\u4e8e\u7247\u4e0a\u5b58\u50a8\uff08on-chip storage\uff09\u7684\u7a00\u7f3a\u6027\uff0c\u901a\u5e38\u5c06\u6240\u6709\u5143\u6570\u636e\uff08\u5982 Pattern History Table, PHT\uff09\u4fdd\u5b58\u5728\u82af\u7247\u4e0a\uff0c\u8fd9\u4e25\u91cd\u9650\u5236\u4e86\u53ef\u5b66\u4e60\u6a21\u5f0f\u7684\u590d\u6742\u5ea6\u548c\u6570\u91cf\u3002RICH \u5219\u53cd\u5176\u9053\u800c\u884c\u4e4b\uff0c\u4e3b\u52a8\u5229\u7528\u7247\u5916\u4e3b\u5b58\uff08off-chip main memory\uff09\u7684\u5de8\u5927\u5bb9\u91cf\u6765\u5b58\u653e\u90e8\u5206\u5143\u6570\u636e\u3002</li> <li>\u5206\u7c7b\u4f9d\u636e: RICH \u6839\u636e\u4e09\u4e2a\u5173\u952e\u7ef4\u5ea6\u5bf9\u5143\u6570\u636e\u8fdb\u884c\u5206\u7c7b\uff0c\u4ee5\u51b3\u5b9a\u5176\u5b58\u50a8\u4f4d\u7f6e\uff1a</li> <li>\u8bbf\u95ee\u9891\u7387 (Access Frequency): \u9ad8\u9891\u8bbf\u95ee\u7684\u5143\u6570\u636e\u5e94\u7f6e\u4e8e\u7247\u4e0a\u4ee5\u4fdd\u8bc1\u4f4e\u5ef6\u8fdf\u3002</li> <li>\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6 (Latency Tolerance): \u67d0\u4e9b\u5143\u6570\u636e\u7684\u4f7f\u7528\u573a\u666f\u5929\u7136\u80fd\u5bb9\u5fcd\u8f83\u9ad8\u7684\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> <li>\u9762\u79ef\u5f00\u9500 (Area Overheads): \u5927\u578b\u6570\u636e\u7ed3\u6784\u4f1a\u6d88\u8017\u5927\u91cf\u5b9d\u8d35\u7684\u7247\u4e0a\u8d44\u6e90\u3002</li> <li>\u5177\u4f53\u7b56\u7565: \u57fa\u4e8e\u4e0a\u8ff0\u5206\u6790\uff0cRICH \u5c06\u4e0d\u540c\u533a\u57df\u5927\u5c0f\u7684\u9884\u53d6\u6a21\u5f0f\u8fdb\u884c\u5dee\u5f02\u5316\u5904\u7406\uff1a</li> <li>2KB \u548c 4KB \u533a\u57df\u6a21\u5f0f: \u8fd9\u4e9b\u6a21\u5f0f\u5bf9\u5ef6\u8fdf\u6781\u4e3a\u654f\u611f\uff0c\u56e0\u4e3a\u5b83\u4eec\u9700\u8981\u5feb\u901f\u54cd\u5e94\u5355\u6b21\u6216\u5c11\u6570\u51e0\u6b21\u7f13\u5b58\u672a\u547d\u4e2d\u3002\u56e0\u6b64\uff0c\u5b83\u4eec\u7684 PHT \u88ab\u5b8c\u5168\u653e\u7f6e\u5728\u7247\u4e0a\u3002</li> <li>16KB \u533a\u57df\u6a21\u5f0f: \u8fd9\u4e9b\u6a21\u5f0f\u5177\u6709\u72ec\u7279\u7684\u6027\u8d28\uff0c\u4f7f\u5176\u975e\u5e38\u9002\u5408\u7247\u5916\u5b58\u50a8\uff1a<ul> <li>\u9ad8\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6: \u4e00\u6b21\u6210\u529f\u7684 16KB \u533a\u57df\u9884\u53d6\u53ef\u4ee5\u5e26\u6765\u591a\u8fbe 256 \u6761\u7f13\u5b58\u7ebf\uff08cache line\uff09\u7684\u6570\u636e\uff0c\u5373\u4f7f\u83b7\u53d6\u5176\u5143\u6570\u636e\u6709\u5ef6\u8fdf\uff0c\u53ea\u8981\u5728\u5904\u7406\u5668\u8bbf\u95ee\u5230\u8be5\u533a\u57df\u672b\u5c3e\u524d\u5b8c\u6210\uff0c\u4f9d\u7136\u80fd\u63d0\u4f9b\u5de8\u5927\u7684\u6027\u80fd\u6536\u76ca\u3002\u5b9e\u9a8c\u8868\u660e\uff0c\u5373\u4f7f\u589e\u52a0 50ns \u7684\u989d\u5916\u5ef6\u8fdf\uff0c\u9884\u53d6\u673a\u4f1a\u7684\u635f\u5931\u4e5f\u5c0f\u4e8e15%\u3002</li> <li>\u6df7\u5408\u8bbf\u95ee\u9891\u7387: \u867d\u7136\u603b\u7684\u6a21\u5f0f\u79cd\u7c7b\u7e41\u591a\uff08\u5355\u4e2a trace \u53ef\u8d85 3500 \u79cd\uff09\uff0c\u4f46\u5b9e\u9645\u8bbf\u95ee\u5448\u73b0\u51fa\u9ad8\u5ea6\u96c6\u4e2d\u6027\uff0c\u5373\u5c11\u6570\u9ad8\u9891\u6a21\u5f0f\u8986\u76d6\u4e86\u5927\u90e8\u5206\u8bf7\u6c42\u3002</li> <li>\u5de8\u5927\u9762\u79ef\u5f00\u9500: \u5b58\u50a8\u6240\u6709 16KB \u6a21\u5f0f\u9700\u8981\u8d85\u8fc7 100KB \u7684\u7247\u4e0a\u5b58\u50a8\uff0c\u6210\u672c\u8fc7\u9ad8\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 4: Achieving high accuracy in large spatial regions and high coverage in small spatial regions by using different numbers of trigger offsets Figure 5: Placing 16 KB PHT off-chip keeps most prefetch opportunities, even with additional memory access latency</p> <p>16KB \u533a\u57df\u5143\u6570\u636e\u7684\u5206\u5c42\u5b58\u50a8\u5b9e\u73b0</p> <p>\u4e3a\u4e86\u9ad8\u6548\u7ba1\u7406 16KB \u533a\u57df\u7684\u5143\u6570\u636e\uff0cRICH \u91c7\u7528\u4e86\u4e00\u79cd\u7c7b\u4f3c\u7f13\u5b58\u7684\u5c42\u7ea7\u7ed3\u6784\u3002</p> <ul> <li>\u7247\u4e0a\u7ec4\u4ef6:</li> <li>16KB PHT Cache: \u4e00\u4e2a\u5c0f\u578b\u7684\u3001\u5168\u76f8\u8054\u6216\u9ad8\u76f8\u8054\u7684\u7247\u4e0a\u7f13\u5b58\uff0c\u5bb9\u91cf\u4e3a 256 \u4e2a\u6761\u76ee\u3002\u5b83\u4e13\u95e8\u7528\u4e8e\u7f13\u5b58\u9ad8\u9891\u8bbf\u95ee\u7684 16KB \u533a\u57df\u6a21\u5f0f\uff0c\u4ee5\u5b9e\u73b0\u5feb\u901f\u8bbf\u95ee\u3002</li> <li>Valid Map Unit: \u4e00\u4e2a 4096 \u4f4d\u7684\u4f4d\u56fe\uff08bit-vector\uff09\uff0c\u7528\u4e8e\u6807\u8bb0\u54ea\u4e9b 16KB \u6a21\u5f0f\u5f53\u524d\u6709\u6548\u5e76\u5b58\u5728\u4e8e\u7247\u5916\u5b58\u50a8\u4e2d\u3002\u6bcf\u4e2a\u4f4d\u5bf9\u5e94\u4e00\u4e2a\u552f\u4e00\u7684 12-bit trigger ID\u3002</li> <li>\u7247\u5916\u7ec4\u4ef6:</li> <li>Off-chip PHT: \u4f4d\u4e8e\u4e3b\u5b58\u4e2d\u7684\u4e00\u4e2a\u4e13\u7528\u6570\u7ec4\uff0c\u53ef\u5bb9\u7eb3 4096 \u4e2a 16KB \u533a\u57df\u6a21\u5f0f\u3002\u6bcf\u4e2a\u6a21\u5f0f\u662f\u4e00\u4e2a 256-bit \u7684\u4f4d\u5411\u91cf\uff0c\u603b\u8ba1\u5360\u7528 128KB \u4e3b\u5b58\u7a7a\u95f4\u3002</li> <li>\u5730\u5740\u6620\u5c04\u673a\u5236:</li> <li>\u91c7\u7528 12-bit trigger ID \u4f5c\u4e3a\u7d22\u5f15\uff0c\u5b9e\u73b0\u4e86\u7247\u4e0a Valid Map\u3001\u7247\u4e0a PHT Cache\uff08\u4f5c\u4e3a\u6807\u7b7e\uff09\u548c\u7247\u5916 PHT \u4e4b\u95f4\u7684\u4e00\u5bf9\u4e00\u6620\u5c04\u3002\u8fd9\u79cd\u8bbe\u8ba1\u7b80\u5316\u4e86\u67e5\u627e\u903b\u8f91\uff0c\u907f\u514d\u4e86\u590d\u6742\u7684\u54c8\u5e0c\u51b2\u7a81\u5904\u7406\u3002</li> <li>\u5199\u56de\u4e0e\u8fc7\u6ee4\u7b56\u7565:</li> <li>\u5e76\u975e\u6240\u6709\u5728\u7247\u4e0a PHT Cache \u4e2d\u88ab\u6dd8\u6c70\u7684\u6a21\u5f0f\u90fd\u4f1a\u88ab\u5199\u5165\u7247\u5916 PHT\u3002</li> <li>\u7cfb\u7edf\u5f15\u5165\u4e86\u4e00\u4e2a prefetch count threshold\uff08\u9884\u53d6\u8ba1\u6570\u9608\u503c\uff09\uff0c\u53ea\u6709\u5f53\u4e00\u4e2a\u6a21\u5f0f\u7684\u4f4d\u5411\u91cf\u4e2d '1' \u7684\u6570\u91cf\uff08\u5373\u9884\u671f\u80fd\u9884\u53d6\u7684\u7f13\u5b58\u7ebf\u6570\uff09\u8d85\u8fc7\u9608\u503c\uff08\u9ed8\u8ba4\u4e3a30\uff09 \u65f6\uff0c\u624d\u8ba4\u4e3a\u5176\u4ef7\u503c\u8db3\u591f\u9ad8\uff0c\u503c\u5f97\u8fdb\u884c\u7247\u5916\u5b58\u50a8\u64cd\u4f5c\u3002\u8fd9\u6709\u6548\u51cf\u5c11\u4e86\u4e0d\u5fc5\u8981\u7684\u7247\u5916\u8bfb\u5199\uff0c\u907f\u514d\u4e86\u56e0\u5143\u6570\u636e\u8bbf\u95ee\u5bfc\u81f4\u7684 row buffer misses \u6027\u80fd\u635f\u5931\u3002</li> </ul> <p></p> <p>Table 2: Categorization of RICH's metadata</p> <p></p> <p>Table 3: Cover ratio under a 2oo-entry storage constraint of 16 KB-region patterns</p> <p>\u9884\u6d4b\u6d41\u7a0b\u4e2d\u7684\u534f\u540c\u5de5\u4f5c\u673a\u5236</p> <p>\u5206\u5c42\u5b58\u50a8\u67b6\u6784\u6df1\u5ea6\u96c6\u6210\u5230 RICH \u7684\u9884\u6d4b\u6d41\u7a0b\u4e2d\uff0c\u786e\u4fdd\u4e86\u9ad8\u6548\u548c\u6b63\u786e\u6027\u3002</p> <ul> <li>\u8f93\u5165: \u9884\u6d4b\u5355\u5143\u63a5\u6536\u5230\u7531 (PC, 5 offsets) \u89e6\u53d1\u7684 16KB \u533a\u57df\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>\u7247\u4e0a\u67e5\u627e:</li> <li>\u9996\u5148\u8ba1\u7b97 12-bit trigger ID\uff0c\u5e76\u5728 16KB PHT Cache \u4e2d\u67e5\u627e\u3002</li> <li>\u5982\u679c\u547d\u4e2d\uff08Hit\uff09\uff0c\u5219\u7acb\u5373\u4f7f\u7528\u8be5\u6a21\u5f0f\u751f\u6210\u9884\u53d6\u6d41\u3002</li> <li>\u7247\u5916\u67e5\u627e\uff08Miss \u5904\u7406\uff09:</li> <li>\u5982\u679c\u7247\u4e0a\u672a\u547d\u4e2d\uff0c\u5219\u67e5\u8be2 Valid Map Unit\u3002</li> <li>\u5982\u679c Valid Map \u5bf9\u5e94\u4f4d\u4e3a 1\uff0c\u8bf4\u660e\u6709\u6548\u6a21\u5f0f\u5b58\u5728\u4e8e\u7247\u5916\u3002\u6b64\u65f6\uff0c\u63a7\u5236\u5355\u5143\u4f1a\u5f02\u6b65\u53d1\u8d77\u4e00\u4e2a\u4ece\u4e3b\u5b58\u52a0\u8f7d\u8be5\u6a21\u5f0f\u7684\u8bf7\u6c42\u3002</li> <li>\u5728\u7b49\u5f85\u7247\u5916\u6570\u636e\u8fd4\u56de\u671f\u95f4\uff0c\u5904\u7406\u5668\u53ef\u80fd\u5df2\u7ecf\u8bbf\u95ee\u4e86\u8be5 16KB \u533a\u57df\u7684\u90e8\u5206\u5185\u5bb9\u3002\u4e3a\u6b64\uff0c\u7cfb\u7edf\u4f1a\u8ddf\u8e2a\u8fd9\u4e9b\u201clate prefetches\u201d\uff08\u665a\u671f\u9884\u53d6\uff09\uff0c\u5e76\u4ee5 2KB \u5b50\u533a\u57df\u4e3a\u7c92\u5ea6\u8fdb\u884c\u6807\u8bb0\uff08\u51718\u4f4d\uff09\u3002</li> <li>\u8f93\u51fa\u4e0e\u6574\u5408:</li> <li>\u5f53\u7247\u5916\u6a21\u5f0f\u6570\u636e\u8fd4\u56de\u540e\uff0c\u5b83\u4f1a\u88ab\u540c\u65f6\u5b58\u5165 16KB PHT Cache\uff0c\u5e76\u6839\u636e late prefetches \u7684\u6807\u8bb0\u4fe1\u606f\u5bf9\u6a21\u5f0f\u8fdb\u884c\u4fee\u526a\uff08trimming\uff09\uff0c\u907f\u514d\u5bf9\u5df2\u8bbf\u95ee\u8fc7\u7684\u5b50\u533a\u57df\u91cd\u590d\u9884\u53d6\u3002</li> <li>\u4fee\u526a\u540e\u7684\u6a21\u5f0f\u88ab\u9001\u5165 Region Arbitration \u5355\u5143\uff0c\u53c2\u4e0e\u6700\u7ec8\u7684\u9884\u53d6\u51b3\u7b56\u3002</li> <li>\u6574\u4f53\u4f5c\u7528: \u8be5\u67b6\u6784\u6210\u529f\u5730\u5c06\u7edd\u5927\u90e8\u5206\uff08\u901a\u8fc7 Valid Map \u7ba1\u7406\uff0916KB \u6a21\u5f0f\u7684\u5b58\u50a8\u8d1f\u62c5\u5378\u8f7d\u5230\u7247\u5916\uff0c\u540c\u65f6\u901a\u8fc7\u4e00\u4e2a\u5c0f\u5de7\u7684\u7247\u4e0a\u7f13\u5b58\u548c\u667a\u80fd\u7684\u8fc7\u6ee4/\u4fee\u526a\u673a\u5236\uff0c\u5c06\u7247\u5916\u8bbf\u95ee\u5e26\u6765\u7684\u5ef6\u8fdf\u5f00\u9500\u964d\u81f3\u6700\u4f4e\uff0c\u5b9e\u73b0\u4e86\u9762\u79ef\u5f00\u9500\u4e0e\u6027\u80fd\u6536\u76ca\u7684\u6700\u4f73\u5e73\u8861\u3002\u8bc4\u4f30\u663e\u793a\uff0c\u76f8\u6bd4\u5c06\u6240\u6709\u5143\u6570\u636e\u653e\u5728\u7247\u4e0a\u7684\u65b9\u6848\uff0c\u6b64\u5206\u5c42\u8bbe\u8ba1\u4ec5\u5e26\u6765 0.5% \u7684\u6027\u80fd\u635f\u5931\u3002</li> </ul> <p></p> <p>Table 4: Breakdown of on-chip storage overheads</p>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#4","title":"4. \u7247\u5916\u5143\u6570\u636e\u8bbf\u95ee\u8fc7\u6ee4\u673a\u5236","text":"<p>\u6838\u5fc3\u673a\u5236\u4e0e\u8bbe\u8ba1\u52a8\u673a</p> <ul> <li>RICH\u5f15\u5165\u7247\u5916\u5143\u6570\u636e\u8bbf\u95ee\u8fc7\u6ee4\u673a\u5236\u7684\u6838\u5fc3\u76ee\u7684\u662f\u907f\u514d\u56e0\u9891\u7e41\u3001\u4f4e\u6548\u7684\u7247\u5916\u8bbf\u95ee\u800c\u62b5\u6d88\u9884\u53d6\u5e26\u6765\u7684\u6027\u80fd\u6536\u76ca\u3002\u5728\u9ad8\u5ef6\u8fdf\u5185\u5b58\u7cfb\u7edf\u4e2d\uff0c\u4e00\u6b21\u7247\u5916\u5143\u6570\u636e\u8bbf\u95ee\u53ef\u80fd\u89e6\u53d1\u4e24\u6b21\u884c\u7f13\u51b2\u533a\u672a\u547d\u4e2d\uff08row buffer misses\uff09\uff0c\u5176\u4ee3\u4ef7\u9ad8\u6602\u3002</li> <li>\u8be5\u673a\u5236\u57fa\u4e8e\u4e00\u4e2a\u5173\u952e\u6d1e\u5bdf\uff1a\u5e76\u975e\u6240\u670916KB\u533a\u57df\u7684\u8bbf\u95ee\u6a21\u5f0f\u90fd\u503c\u5f97\u88ab\u6301\u4e45\u5316\u5230\u7247\u5916\u5b58\u50a8\u3002\u53ea\u6709\u90a3\u4e9b\u80fd\u5e26\u6765\u663e\u8457\u51c0\u6536\u76ca\u7684\u6a21\u5f0f\u624d\u5e94\u89e6\u53d1\u7247\u5916\u64cd\u4f5c\u3002</li> <li>\u51c0\u6536\u76ca\u7684\u8861\u91cf\u6807\u51c6\u662f\u6a21\u5f0f\u7684\u9884\u53d6\u8ba1\u6570\uff08prefetch count\uff09\uff0c\u5373\u5176\u4f4d\u5411\u91cf\uff08bit-vector\uff09\u4e2d'1'\u7684\u6570\u91cf\uff0c\u5b83\u76f4\u63a5\u4ee3\u8868\u4e86\u6210\u529f\u9884\u53d6\u7684cache line\u6570\u91cf\u3002</li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5b9e\u73b0\u7ec6\u8282</p> <ul> <li>\u5199\u5165\u8fc7\u6ee4\uff08Eviction to Off-chip\uff09:<ul> <li>\u5f5316KB\u533a\u57df\u7684On-chip PHT Cache\u56e0\u5bb9\u91cf\u9650\u5236\u9700\u8981\u9a71\u9010\uff08evict\uff09\u4e00\u4e2a\u6761\u76ee\u65f6\uff0c\u7cfb\u7edf\u4f1a\u68c0\u67e5\u8be5\u6a21\u5f0f\u7684\u9884\u53d6\u8ba1\u6570\u3002</li> <li>\u53ea\u6709\u5f53\u9884\u53d6\u8ba1\u6570\u8d85\u8fc7\u9884\u8bbe\u9608\u503c\uff08\u9ed8\u8ba4\u4e3a30\uff09 \u65f6\uff0c\u8be5\u6a21\u5f0f\u624d\u4f1a\u88ab\u5199\u5165\u7247\u5916\u4e3b\u5b58\u4e2d\u7684PHT\uff1b\u5426\u5219\uff0c\u8be5\u6a21\u5f0f\u5c06\u88ab\u76f4\u63a5\u4e22\u5f03\u3002</li> </ul> </li> <li>\u52a0\u8f7d\u8fc7\u6ee4\uff08Load from Off-chip\uff09:<ul> <li>\u5728\u7247\u4e0a\u9884\u6d4b\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c16KB\u533a\u57df\u7684\u67e5\u8be2\u5728On-chip PHT Cache\u4e2d\u672a\u547d\u4e2d\uff0c\u4f46Valid Map\u6307\u793a\u7247\u5916\u5b58\u5728\u6709\u6548\u6a21\u5f0f\uff0c\u5219\u4f1a\u53d1\u8d77\u7247\u5916\u52a0\u8f7d\u8bf7\u6c42\u3002</li> <li>\u6b64\u5904\u7684\u201c\u8fc7\u6ee4\u201d\u4f53\u73b0\u5728\u51b3\u7b56\u903b\u8f91\u4e0a\uff1a\u7cfb\u7edf\u53ea\u4f1a\u5728\u9884\u671f\u6536\u76ca\uff08\u7531\u5386\u53f2\u9884\u53d6\u8ba1\u6570\u63a8\u65ad\uff09\u5927\u4e8e\u6f5c\u5728\u635f\u5931\uff08\u884c\u7f13\u51b2\u533a\u672a\u547d\u4e2d\u5f00\u9500\uff09\u65f6\uff0c\u624d\u5141\u8bb8\u8fdb\u884c\u8fd9\u6b21\u52a0\u8f7d\u3002\u8fd9\u4e2a\u5224\u65ad\u5728\u8bad\u7ec3\u9636\u6bb5\u901a\u8fc7\u5199\u5165\u8fc7\u6ee4\u5df2\u7ecf\u9690\u5f0f\u5b8c\u6210\uff0c\u56e0\u4e3a\u53ea\u6709\u9ad8\u4ef7\u503c\u6a21\u5f0f\u624d\u88ab\u5b58\u5165\u7247\u5916\u3002</li> </ul> </li> </ul> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u654f\u611f\u6027\u5206\u6790</p> <ul> <li>\u9884\u53d6\u8ba1\u6570\u9608\u503c\u662f\u4e00\u4e2a\u5173\u952e\u53ef\u8c03\u53c2\u6570\uff0c\u5176\u6700\u4f18\u503c\u4e0e\u7cfb\u7edf\u5185\u5b58\u5ef6\u8fdf\u5bc6\u5207\u76f8\u5173\u3002<ul> <li>\u5728\u5e38\u89c4\u5185\u5b58\u5ef6\u8fdf\u4e0b\uff0c\u8f83\u4f4e\u7684\u9608\u503c\uff08\u598210\uff09\u5373\u53ef\u83b7\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u56e0\u4e3a\u7247\u5916\u8bbf\u95ee\u7684\u60e9\u7f5a\u76f8\u5bf9\u8f83\u5c0f\u3002</li> <li>\u5728\u9ad8\u5185\u5b58\u5ef6\u8fdf\u573a\u666f\u4e0b\uff08\u5982\u589e\u52a060ns\u6216120ns\uff09\uff0c\u66f4\u9ad8\u7684\u9608\u503c\uff08\u598230\uff09\u66f4\u4e3a\u5408\u9002\uff0c\u4ee5\u786e\u4fdd\u53ea\u6709\u80fd\u5e26\u6765\u5de8\u5927\u6536\u76ca\u7684\u6a21\u5f0f\u624d\u503c\u5f97\u627f\u62c5\u9ad8\u6602\u7684\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> </ul> </li> <li></li> </ul> <p></p> <p>Figure 17: Sensitivity to different prefetch count thresholds for 16 KB-region under different memory latencies</p> <ul> <li>\u8fd9\u4e00\u654f\u611f\u6027\u5206\u6790\u8bc1\u660e\u4e86\u8be5\u8fc7\u6ee4\u673a\u5236\u7684\u6709\u6548\u6027\u548c\u5fc5\u8981\u6027\uff0c\u5b83\u80fd\u6839\u636e\u7cfb\u7edf\u7279\u6027\u52a8\u6001\u8c03\u6574\u7b56\u7565\uff0c\u6700\u5927\u5316\u6027\u80fd\u3002</li> </ul> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: <ul> <li>\u4eceTraining Unit\u751f\u6210\u768416KB\u533a\u57df\u6a21\u5f0f\u53ca\u5176\u5bf9\u5e94\u7684\u9884\u53d6\u8ba1\u6570\u3002</li> <li>On-chip PHT Cache\u7684\u9a71\u9010\u4fe1\u53f7\u3002</li> <li>Prediction Unit\u53d1\u51fa\u7684\u7247\u4e0a\u672a\u547d\u4e2d\u4fe1\u53f7\u548cValid Map\u7684\u6709\u6548\u6027\u67e5\u8be2\u7ed3\u679c\u3002</li> </ul> </li> <li>\u8f93\u51fa:<ul> <li>\u5bf9\u7247\u5916\u5b58\u50a8\u7684\u6709\u6761\u4ef6\u5199\u5165/\u52a0\u8f7d\u8bf7\u6c42\u3002</li> <li>\u4e00\u4e2a\u7ecf\u8fc7\u7b5b\u9009\u7684\u3001\u4ec5\u5305\u542b\u9ad8\u4ef7\u503c\u6a21\u5f0f\u7684\u7247\u5916PHT\u3002</li> </ul> </li> <li>\u5728RICH\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:<ul> <li>\u964d\u4f4e\u7247\u5916\u5e26\u5bbd\u538b\u529b: \u901a\u8fc7\u8fc7\u6ee4\u6389\u4f4e\u4ef7\u503c\u6a21\u5f0f\uff0c\u663e\u8457\u51cf\u5c11\u4e86\u4e0d\u5fc5\u8981\u7684\u7247\u5916\u5143\u6570\u636e\u6d41\u91cf\uff0c\u5c06\u5b9d\u8d35\u7684\u5e26\u5bbd\u7559\u7ed9\u771f\u6b63\u6709\u7528\u7684\u6570\u636e\u9884\u53d6\u3002</li> <li>\u63d0\u5347\u7247\u5916\u5b58\u50a8\u6548\u7387: \u786e\u4fdd\u6709\u9650\u7684128KB\u7247\u5916\u5143\u6570\u636e\u7a7a\u95f4\u88ab\u7528\u4e8e\u5b58\u50a8\u6700\u5177\u4ef7\u503c\u7684\u6a21\u5f0f\uff0c\u63d0\u9ad8\u4e86\u5b58\u50a8\u8d44\u6e90\u7684\u5229\u7528\u7387\u3002</li> <li>\u4fdd\u969c\u6027\u80fd\u51c0\u6536\u76ca: \u8fd9\u662f\u6574\u4e2a\u7247\u4e0a/\u7247\u4e0b\u534f\u540c\u5b58\u50a8\u7b56\u7565\uff08hierarchical storage design\uff09 \u7684\u5173\u952e\u4e00\u73af\uff0c\u5b83\u4fdd\u8bc1\u4e86\u5c06\u5143\u6570\u636e\u5378\u8f7d\u5230\u7247\u5916\u8fd9\u4e00\u8bbe\u8ba1\u51b3\u7b56\u80fd\u591f\u771f\u6b63\u5e26\u6765\u6027\u80fd\u63d0\u5347\uff0c\u800c\u975e\u6210\u4e3a\u65b0\u7684\u74f6\u9888\u3002\u8be5\u673a\u5236\u4e0e\u591a\u504f\u79fb\u89e6\u53d1\uff08multi-offset trigger\uff09 \u548c\u533a\u57df\u4ef2\u88c1\uff08Region Arbitration\uff09 \u5171\u540c\u6784\u6210\u4e86RICH\u9ad8\u6548\u5229\u7528\u4e30\u5bcc\u5143\u6570\u636e\u7684\u6838\u5fc3\u652f\u67f1\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/rich-prefetcher-storing-rich-information-in-memory-to-trade-capacity-and-bandwidth-for-latency-hiding/paper_notes/#4_1","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u4eff\u771f\u5e73\u53f0\u4e0e\u914d\u7f6e\uff1a\u5b9e\u9a8c\u57fa\u4e8e ChampSim \u4eff\u771f\u5668\uff0c\u6a21\u62df\u4e00\u4e2a Intel Alder Lake \u6027\u80fd\u6838 (P-Core) \u7684\u5355\u6838\u53ca\u56db\u6838\u7cfb\u7edf\u3002L2 Cache \u5927\u5c0f\u4e3a 2 MB\uff0c\u4e3b\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\u5728\u57fa\u7ebf\u914d\u7f6e\u4e0b\u4e3a 210 ns\u3002</li> <li>\u5bf9\u6bd4\u5bf9\u8c61\uff1aRICH \u4e0e\u56db\u79cd\u5148\u8fdb\u7684\u7a7a\u95f4\u9884\u53d6\u5668\u8fdb\u884c\u5bf9\u6bd4\uff0c\u5206\u522b\u662f Bingo\u3001PMP\u3001SPP-PPF \u548c SMS\u3002\u6240\u6709\u9884\u53d6\u5668\u5747\u90e8\u7f72\u5728 L2 Cache \u5c42\u7ea7\u3002</li> <li>\u5de5\u4f5c\u8d1f\u8f7d\uff1a</li> <li>\u4f7f\u7528\u4e86\u8d85\u8fc7 100 \u6761\u6765\u81ea SPEC CPU 2006/2017\u3001Ligra \u548c Parsec \u7684 traces\u3002</li> <li>\u6392\u9664\u4e86 L2 MPKI (Misses Per Kilo Instructions) \u5c0f\u4e8e 2 \u7684 traces\uff0c\u4ee5\u805a\u7126\u4e8e\u5185\u5b58\u654f\u611f\u578b\u5e94\u7528\u3002</li> <li>\u5355\u6838\u8bc4\u4f30\u4f7f\u7528\u5168\u90e8 traces\uff1b\u591a\u6838\u8bc4\u4f30\u5305\u62ec \u540c\u6784 (homogeneous) \u548c \u5f02\u6784 (heterogeneous) \u5de5\u4f5c\u8d1f\u8f7d\u7ec4\u5408\u3002</li> <li>\u8bc4\u4f30\u6307\u6807\uff1a\u4e3b\u8981\u6027\u80fd\u6307\u6807\u4e3a Speedup\uff08\u76f8\u5bf9\u4e8e\u65e0\u9884\u53d6\u57fa\u7ebf\uff09\uff0c\u5e76\u8f85\u4ee5 Accuracy\uff08\u51c6\u786e\u7387\uff09\u3001Coverage\uff08\u8986\u76d6\u7387\uff09\u548c Timeliness\uff08\u53ca\u65f6\u6027\uff09\u8fdb\u884c\u6df1\u5165\u5206\u6790\u3002</li> </ul> <p></p> <p>Table 5: Simulated system</p> <p>\u6838\u5fc3\u7ed3\u679c\u6570\u636e</p> <ul> <li>\u5355\u6838\u6027\u80fd\uff1a\u5728\u6807\u51c6\u5ef6\u8fdf\u4e0b\uff0cRICH \u76f8\u5bf9\u4e8e\u65e0\u9884\u53d6\u57fa\u7ebf\u5e73\u5747\u63d0\u5347 39%\u3002\u4e0e SOTA \u9884\u53d6\u5668\u76f8\u6bd4\uff1a</li> <li>\u8d85\u8d8a Bingo 3.4%</li> <li>\u8d85\u8d8a PMP 4.4%</li> <li>\u8d85\u8d8a SMS 6.6%</li> <li>\u8d85\u8d8a SPP-PPF 16.8%</li> <li>\u9ad8\u5ef6\u8fdf\u573a\u666f\u4e0b\u7684\u4f18\u52bf\uff1a\u5f53\u4e3b\u5b58\u5ef6\u8fdf\u989d\u5916\u589e\u52a0 120 ns \u65f6\uff0cRICH \u7684\u4f18\u52bf\u663e\u8457\u6269\u5927\uff1a</li> <li>\u8d85\u8d8a Bingo 8.3%</li> <li>\u8d85\u8d8a PMP 6.2%   \u8fd9\u8bc1\u660e\u4e86 RICH \u5728\u672a\u6765\u9ad8\u5ef6\u8fdf\u5185\u5b58\u7cfb\u7edf\uff08\u5982 CXL, NVM\uff09\u4e2d\u7684\u5de8\u5927\u6f5c\u529b\u3002</li> <li>\u6027\u80fd\u6307\u6807\u5206\u89e3\uff1aRICH \u7684\u6210\u529f\u6e90\u4e8e\u5176\u5728\u5173\u952e\u6307\u6807\u4e0a\u7684\u5168\u9762\u4f18\u5316\uff1a</li> <li>Coverage: 75% (vs. Bingo \u7684 64%)</li> <li>Timeliness: 91% (vs. Bingo \u7684 78%)</li> <li>Accuracy: 76.3% (\u4e0e Bingo \u7684 76.6% \u57fa\u672c\u6301\u5e73)</li> </ul> <p></p> <p>Figure 10: RICH improves coverage and timeliness while maintaining comparable accuracy</p> <ul> <li>\u5e26\u5bbd\u654f\u611f\u6027\uff1aRICH \u7684\u8bbe\u8ba1\u5145\u5206\u5229\u7528\u4e86\u9ad8\u5e26\u5bbd\u7279\u6027\u3002\u5f53\u5e26\u5bbd\u4ece 5 GB/s \u63d0\u5347\u81f3 35 GB/s \u65f6\uff0c\u5176\u6027\u80fd\u589e\u76ca\u4ece 19% \u5927\u5e45\u8dc3\u5347\u81f3 39%\uff0c\u589e\u5e45\u8fdc\u8d85 Bingo\uff0820% -&gt; 34%\uff09\u3002\u8fd9\u8868\u660e RICH \u80fd\u66f4\u9ad8\u6548\u5730\u5229\u7528\u9ad8\u5e26\u5bbd\u8d44\u6e90\u3002</li> </ul> <p></p> <p>Figure 14: Performance under different memory bandwidth</p> <ul> <li>\u591a\u6838\u6027\u80fd\uff1a\u5728 4 \u6838\u7cfb\u7edf\u4e2d\uff0cRICH \u4f9d\u7136\u4fdd\u6301\u9886\u5148\uff0c\u8d85\u8d8a Bingo 2.8%\uff0c\u8d85\u8d8a PMP 7%\u3002\u5c3d\u7ba1\u5176\u6fc0\u8fdb\u7684\u9884\u53d6\u7b56\u7565\u5728\u591a\u6838\u7ade\u4e89\u5e26\u5bbd\u65f6\u6536\u76ca\u7565\u6709\u4e0b\u964d\uff0c\u4f46\u4f18\u52bf\u4f9d\u7136\u7a33\u56fa\u3002</li> </ul> <p></p> <p>Figure 19: RICH outperforms Bingo in both homogeneous and heterogeneous workloads on a 4-core system</p> <p>\u6d88\u878d\u5b9e\u9a8c (Ablation Study)</p> <p>\u6d88\u878d\u5b9e\u9a8c\u901a\u8fc7\u9010\u6b65\u6784\u5efa RICH \u7684\u5404\u4e2a\u7ec4\u4ef6\uff0c\u9a8c\u8bc1\u4e86\u5176\u8bbe\u8ba1\u51b3\u7b56\u7684\u6709\u6548\u6027\u3002</p> <ul> <li>\u57fa\u7840\u914d\u7f6e\uff1a\u4ec5\u4f7f\u7528 2KB-region only\uff08\u5373 Bingo \u7684\u57fa\u7840\u673a\u5236\uff09\u4f5c\u4e3a\u8d77\u70b9\u3002</li> <li>\u65e0\u6548\u7684\u7b80\u5355\u7ec4\u5408\uff1a\u5c06 2KB\u30014KB\u300116KB \u533a\u57df\u7b80\u5355\u7ec4\u5408\uff08Naive multi-region\uff09\uff0c\u6027\u80fd\u53cd\u800c\u6bd4\u4ec5\u7528 2KB \u66f4\u5dee\uff0c\u51f8\u663e\u4e86\u76f4\u63a5\u7ec4\u5408\u4e0d\u540c\u7c92\u5ea6\u533a\u57df\u7684\u51b2\u7a81\u95ee\u9898\u3002</li> <li>\u591a\u504f\u79fb\u89e6\u53d1\u673a\u5236\u7684\u5173\u952e\u4f5c\u7528\uff1a\u5f15\u5165 Multi-region multi-trigger\uff08\u5373\u4e3a\u5927\u533a\u57df\u4f7f\u7528\u591a\u504f\u79fb\u89e6\u53d1\uff09\u540e\uff0c\u6027\u80fd\u5f97\u5230\u663e\u8457\u6062\u590d\u3002\u8fd9\u8bc1\u660e\u4e86 multi-offset trigger \u5bf9\u4e8e\u4fdd\u8bc1\u5927\u533a\u57df\u9884\u53d6 Accuracy \u7684\u81f3\u5173\u91cd\u8981\u6027\u3002</li> </ul> <p></p> <p>Figure 15: Multi-offset trigger mechanism significantly benefits RICH, while offloading part of the 16 KB-Region patterns has limited performance impact.</p> <ul> <li>\u533a\u57df\u4ef2\u88c1\u673a\u5236\u7684\u5fc5\u8981\u6027\uff1a\u5728\u591a\u89e6\u53d1\u57fa\u7840\u4e0a\u52a0\u5165 Region Arbitration\uff08All-on-chip \u914d\u7f6e\uff09\uff0c\u6027\u80fd\u8fdb\u4e00\u6b65\u63d0\u5347\u3002\u8be5\u673a\u5236\u901a\u8fc7\u4f18\u5148\u9009\u62e9\u9ad8\u51c6\u786e\u7387\u7684\u5927\u533a\u57df\u9884\u53d6\uff0c\u5e76\u963b\u6b62\u5c0f\u533a\u57df\u5bf9\u5df2\u8986\u76d6\u7a7a\u95f4\u7684\u91cd\u590d\u9884\u53d6\uff0c\u6709\u6548\u89e3\u51b3\u4e86\u9884\u53d6\u5197\u4f59\u548c\u51b2\u7a81\u95ee\u9898\u3002</li> <li>\u7247\u4e0a/\u7247\u4e0b\u534f\u540c\u5b58\u50a8\u7684\u9ad8\u6548\u6027\uff1a\u6700\u7ec8\u7684 RICH (proposed) \u914d\u7f6e\u5c06\u4e0d\u5e38\u7528\u7684 16KB \u6a21\u5f0f\u8868\uff08PHT\uff09\u5378\u8f7d\u5230\u7247\u5916\u5185\u5b58\u3002\u7ed3\u679c\u663e\u793a\uff0c\u76f8\u6bd4\u5b8c\u5168\u7247\u4e0a\u5b9e\u73b0\uff08All-on-chip\uff09\uff0c\u6027\u80fd\u4ec5\u635f\u5931 0.5%\u3002\u8fd9\u6709\u529b\u5730\u8bc1\u660e\u4e86\u5176 hierarchical storage \u8bbe\u8ba1\u5728\u51e0\u4e4e\u4e0d\u727a\u7272\u6027\u80fd\u7684\u524d\u63d0\u4e0b\uff0c\u5927\u5e45\u964d\u4f4e\u4e86\u5b9d\u8d35\u7684 on-chip area \u5f00\u9500\u3002</li> </ul> <p>\u5b58\u50a8\u6548\u7387\u5bf9\u6bd4</p> <ul> <li>Iso-storage \u5b9e\u9a8c\uff1a\u5728\u76f8\u8fd1\u7684\u603b\u5b58\u50a8\u9884\u7b97\u4e0b\uff08RICH: 47KB on-chip + 128KB off-chip; Enhanced Bingo/PMP: ~193KB on-chip\uff09\uff0cRICH \u4f9d\u7136\u5927\u5e45\u9886\u5148\u3002</li> <li>\u8fb9\u9645\u6548\u76ca\u9012\u51cf\uff1a\u7b80\u5355\u5730\u6269\u5927 Bingo \u6216 PMP \u7684 PHT\uff08\u5206\u522b\u589e\u81f3 193KB \u548c 194KB\uff09\u4ec5\u5e26\u6765 0.3% \u7684\u5fae\u5f31\u6027\u80fd\u63d0\u5347\uff0c\u9a8c\u8bc1\u4e86\u8bba\u6587\u7684\u6838\u5fc3\u89c2\u70b9\u2014\u2014\u7b80\u5355\u5730\u6269\u5c55\u4f20\u7edf\u9884\u53d6\u5668\u4f1a\u906d\u9047\u8fb9\u9645\u6548\u76ca\u9012\u51cf\uff0c\u800c RICH \u7684 rich metadata \u8bbe\u8ba1\u80fd\u66f4\u9ad8\u6548\u5730\u5c06\u5176\u8f6c\u5316\u4e3a\u6027\u80fd\u589e\u76ca\u3002</li> </ul> <p></p> <p>Figure 16: Iso-storage comparison shows RICH is more storage efficient than Bingo and PMP.</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/ELI5_notes/","title":"RnR: A Software-Assisted Record-and-Replay Hardware Prefetcher \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 \u786c\u4ef6\u9884\u53d6\u5668 (hardware prefetcher) \u5728\u9762\u5bf9 \u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f (irregular memory access patterns) \u65f6\u975e\u5e38\u201c\u96be\u53d7\u201d\u3002\u8fd9\u7c7b\u6a21\u5f0f\u5e38\u89c1\u4e8e\u56fe\u8ba1\u7b97\uff08\u5982PageRank\uff09\u3001\u7a00\u758f\u77e9\u9635\u8fd0\u7b97\uff08\u5982SpMV\uff09\u7b49\u91cd\u8981\u5e94\u7528\u4e2d\u3002 - \u5177\u4f53\u6765\u8bf4\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u4f9d\u8d56\u4e8e\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u53d1\u73b0\u5730\u5740\u95f4\u7684 \u7a7a\u95f4\u6216\u65f6\u95f4\u76f8\u5173\u6027\u3002\u4f46\u5f53\u8bbf\u95ee\u5e8f\u5217\u5f88\u957f\u3001\u5f88\u968f\u673a\uff0c\u4e14\u7f3a\u4e4f\u91cd\u590d\u7684\u77ed\u5468\u671f\u6a21\u5f0f\u65f6\uff0c\u786c\u4ef6\u8868\uff08\u5982GHB\uff09\u5f88\u5bb9\u6613\u88ab\u76f8\u4f3c\u4f46\u4e0d\u540c\u7684\u6a21\u5f0f\u201c\u6df7\u6dc6\u201d\uff0c\u5bfc\u81f4 \u9884\u6d4b\u51c6\u786e\u7387\u4f4e \u548c \u8986\u76d6\u5ea6\u4e0d\u8db3\u3002 - \u53e6\u4e00\u65b9\u9762\uff0c\u8f6f\u4ef6\u9884\u53d6\u5668 (software prefetcher) \u867d\u7136\u53ef\u4ee5\u5229\u7528\u7a0b\u5e8f\u5458\u7684\u5148\u9a8c\u77e5\u8bc6\uff0c\u4f46\u5b83\u9700\u8981\u5728\u4ee3\u7801\u4e2d\u63d2\u5165\u989d\u5916\u7684\u6307\u4ee4\u6765\u751f\u6210\u9884\u53d6\u5730\u5740\uff0c\u8fd9\u4e0d\u4ec5\u589e\u52a0\u4e86 \u6307\u4ee4\u5f00\u9500 (instruction overhead)\uff0c\u8fd8\u56e0\u4e3a\u65e0\u6cd5\u611f\u77e5\u8fd0\u884c\u65f6\u7684\u7f13\u5b58\u548c\u603b\u7ebf\u72b6\u6001\uff0c\u96be\u4ee5\u505a\u5230 \u7cbe\u51c6\u7684\u65f6\u673a\u63a7\u5236 (timeliness)\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u5728\u4e00\u5bb6\u5de8\u5927\u7684\u56fe\u4e66\u9986\uff08\u4e3b\u5b58\uff09\u91cc\u627e\u4e66\u3002\u4e00\u4e2a\u5e38\u89c4\u7684\u56fe\u4e66\u7ba1\u7406\u5458\uff08\u786c\u4ef6\u9884\u53d6\u5668\uff09\u4f1a\u6839\u636e\u4f60\u6700\u8fd1\u501f\u8fc7\u7684\u51e0\u672c\u4e66\uff0c\u731c\u6d4b\u4f60\u4e0b\u4e00\u672c\u53ef\u80fd\u8981\u4ec0\u4e48\u3002\u4f46\u5982\u679c\u4eca\u5929\u4f60\u8981\u6267\u884c\u4e00\u4e2a\u975e\u5e38\u590d\u6742\u7684\u3001\u6b65\u9aa4\u56fa\u5b9a\u7684\u5bfb\u4e66\u4efb\u52a1\uff08\u6bd4\u5982\uff0c\u6309\u7167\u4e00\u4efd\u53e4\u8001\u7684\u85cf\u5b9d\u56fe\u987a\u5e8f\u627e100\u672c\u7279\u5b9a\u7684\u4e66\uff09\uff0c\u800c\u8fd9\u4e2a\u4efb\u52a1\u4f60\u660e\u5929\u3001\u540e\u5929\u8fd8\u8981\u91cd\u590d\u505a\u5f88\u591a\u6b21\uff0c\u90a3\u4e48\u56fe\u4e66\u7ba1\u7406\u5458\u6bcf\u6b21\u90fd\u8981\u91cd\u65b0\u731c\uff0c\u6548\u7387\u6781\u4f4e\u3002 - RnR\u7684\u505a\u6cd5\u662f\uff1a\u5728\u4f60\u7b2c\u4e00\u6b21\u6267\u884c\u8fd9\u4e2a\u590d\u6742\u4efb\u52a1\u65f6\uff0c\u8ba9\u4e00\u4e2a\u52a9\u624b\uff08\u786c\u4ef6\uff09\u5728\u65c1\u8fb9 \u9ed8\u9ed8\u8bb0\u5f55\u4e0b\u4f60\u5b9e\u9645\u53bb\u54ea\u4e9b\u4e66\u67b6\uff08cache miss sequence\uff09\u4ee5\u53ca\u6bcf\u4e00\u6b65\u82b1\u4e86\u591a\u957f\u65f6\u95f4\uff08timing information\uff09\u3002\u4ece\u7b2c\u4e8c\u6b21\u5f00\u59cb\uff0c\u8fd9\u4e2a\u52a9\u624b\u5c31\u4e0d\u518d\u731c\u4e86\uff0c\u800c\u662f\u76f4\u63a5 \u6309\u6628\u5929\u8bb0\u4e0b\u7684\u5267\u672c\uff0c\u63d0\u524d\u628a\u4e66\u653e\u5230\u4f60\u7684\u4e34\u65f6\u684c\uff08L2 cache\uff09\u4e0a\u3002\u4f60\u53ea\u9700\u8981\u4e13\u6ce8\u4e8e\u9605\u8bfb\uff0c\u5b8c\u5168\u4e0d\u7528\u64cd\u5fc3\u627e\u4e66\u7684\u4e8b\u3002\u8fd9\u5c31\u50cf\u662f\u7528\u4e00\u6b21\u6027\u7684\u201c\u6392\u7ec3\u201d\u6362\u53d6\u4e86\u65e0\u6570\u6b21\u9ad8\u6548\u7684\u201c\u6b63\u5f0f\u6f14\u51fa\u201d\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u8bbe\u8ba1\u4e00\u4e2a\u66f4\u806a\u660e\u7684\u786c\u4ef6\u6765\u201c\u731c\u201d\u4e0d\u89c4\u5219\u6a21\u5f0f\uff0c\u800c\u662f\u5de7\u5999\u5730\u5f15\u5165\u4e86\u4e00\u4e2a \u8f7b\u91cf\u7ea7\u7684\u8f6f\u786c\u4ef6\u534f\u540c\u63a5\u53e3\uff0c\u5c06 \u201c\u4f55\u65f6\u8bb0\u5f55\u201d\u3001\u201c\u8bb0\u5f55\u4ec0\u4e48\u201d\u3001\u201c\u4f55\u65f6\u56de\u653e\u201d \u7684\u51b3\u7b56\u6743\u4ea4\u7ed9\u4e86\u7a0b\u5e8f\u5458\u3002 - \u8fd9\u4e2a\u6838\u5fc3\u601d\u8def\u4f53\u73b0\u5728\u4e09\u4e2a\u5173\u952e\u8bbe\u8ba1\u4e0a\uff1a   - \u5206\u79bb\u5173\u6ce8\u70b9: \u7a0b\u5e8f\u5458\u901a\u8fc7\u63a5\u53e3\u660e\u786e\u6307\u5b9a \u76ee\u6807\u6570\u636e\u7ed3\u6784\uff08\u5982PageRank\u4e2d\u7684<code>pcurr</code>\u6570\u7ec4\uff09\uff0c\u8fd9\u6837\u786c\u4ef6\u53ea\u9700\u5173\u6ce8\u8fd9\u90e8\u5206\u7684\u4e0d\u89c4\u5219\u8bbf\u95ee\uff0c\u800c\u5c06\u89c4\u5219\u7684\u8bbf\u95ee\uff08\u5982CSR\u683c\u5f0f\u7684\u77e9\u9635\u884c\u6307\u9488\uff09\u7559\u7ed9\u4f20\u7edf\u7684\u6d41\u5f0f\u9884\u53d6\u5668\u5904\u7406\uff0c\u907f\u514d\u4e86\u6a21\u5f0f\u6df7\u6742\u7684\u95ee\u9898\u3002   - \u8bb0\u5f55\u4e0e\u56de\u653e\u673a\u5236: \u786c\u4ef6\u5728\u7b2c\u4e00\u6b21\u8fed\u4ee3\uff08Record\u9636\u6bb5\uff09\u53ea\u8bb0\u5f55 L2 cache miss \u7684\u5730\u5740\u5e8f\u5217\u53ca\u5176\u5bf9\u5e94\u7684 \u7a0b\u5e8f\u8fdb\u5ea6\u4fe1\u606f\uff08\u901a\u8fc7\u8ba1\u6570\u5668\u5b9e\u73b0\uff09\u3002\u5728\u540e\u7eed\u8fed\u4ee3\uff08Replay\u9636\u6bb5\uff09\uff0c\u5b83\u76f4\u63a5\u56de\u653e\u8fd9\u4e2a\u5e8f\u5217\u8fdb\u884c\u9884\u53d6\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86 \u63a5\u8fd1100%\u7684\u51c6\u786e\u7387\u3002   - \u57fa\u4e8e\u7a97\u53e3\u7684\u65f6\u673a\u63a7\u5236: \u4e3a\u4e86\u786e\u4fdd\u9884\u53d6\u7684\u6570\u636e\u4e0d\u4f1a\u56e0\u8fc7\u65e9\u800c\u88ab\u6324\u51fa\u7f13\u5b58\uff0c\u4e5f\u4e0d\u4f1a\u56e0\u8fc7\u665a\u800c\u9519\u8fc7\u4f7f\u7528\u65f6\u673a\uff0cRnR\u5c06\u8bb0\u5f55\u7684\u5e8f\u5217\u5212\u5206\u4e3a\u591a\u4e2a \u7a97\u53e3 (window)\uff0c\u5e76\u8bb0\u5f55\u6bcf\u4e2a\u7a97\u53e3\u5185\u7684 \u7f3a\u5931\u7387 (miss ratio)\u3002\u5728\u56de\u653e\u65f6\uff0c\u5b83\u4f1a\u6839\u636e\u5f53\u524d\u7a0b\u5e8f\u6267\u884c\u5230\u54ea\u4e2a\u7a97\u53e3\uff0c\u52a8\u6001\u8c03\u6574\u9884\u53d6\u7684\u6fc0\u8fdb\u7a0b\u5ea6\uff0c\u786e\u4fdd\u9884\u53d6\u8282\u594f\u4e0e\u7a0b\u5e8f\u5b9e\u9645\u9700\u6c42\u5b8c\u7f8e\u540c\u6b65\u3002</p> <p></p> <p>Fig. 5. Prefetching timing control example with window size = 3.</p> <p>\u6700\u7ec8\uff0cRnR\u901a\u8fc7\u8fd9\u79cd\u201c\u4e00\u6b21\u8bb0\u5f55\uff0c\u591a\u6b21\u7cbe\u51c6\u56de\u653e\u201d\u7684\u7b56\u7565\uff0c\u5728\u56fe\u8ba1\u7b97\u548c\u7a00\u758f\u8fed\u4ee3\u6c42\u89e3\u5668\u7b49\u5e94\u7528\u4e0a\u53d6\u5f97\u4e86\u60ca\u4eba\u7684\u6548\u679c\uff0c\u5e73\u5747\u901f\u5ea6\u63d0\u5347\u8d85\u8fc7 2\u500d\uff0c\u5e76\u4e14\u9884\u53d6\u51c6\u786e\u7387\u548c\u8986\u76d6\u7387\u5747\u8d85\u8fc7 95%\u3002</p> <p></p> <p>Fig. 6. Speedup over no prefetcher baseline.</p> <p></p> <p>Fig. 9. Prefetcher accuracy.</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/ELI5_notes/#1-record-and-replay-eli5","title":"1. \u8f6f\u4ef6\u8f85\u52a9\u7684\u8bb0\u5f55\u4e0e\u56de\u653e\uff08Record-and-Replay\uff09\u673a\u5236 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 \u786c\u4ef6\u9884\u53d6\u5668 (hardware prefetcher) \u9762\u5bf9 \u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee (irregular memory access) \u65f6\u975e\u5e38\u201c\u96be\u53d7\u201d\u3002\u5b83\u4eec\u8981\u4e48\u4f9d\u8d56\u7b80\u5355\u7684\u7a7a\u95f4/\u6b65\u957f\u6a21\u5f0f\uff08\u5bf9\u4e0d\u89c4\u5219\u6570\u636e\u65e0\u6548\uff09\uff0c\u8981\u4e48\u9700\u8981\u590d\u6742\u7684\u8868\u7ed3\u6784\u6765\u8bb0\u5f55\u5386\u53f2\u8bbf\u95ee\uff0c\u4f46\u8fd9\u4e9b\u8868\u5bb9\u91cf\u6709\u9650\uff0c\u65e0\u6cd5\u533a\u5206\u5728\u4e0d\u540c\u7a0b\u5e8f\u9636\u6bb5\u53d1\u751f\u7684\u3001\u770b\u4f3c\u76f8\u4f3c\u7684\u957f\u5e8f\u5217\u3002 - \u8f6f\u4ef6\u9884\u53d6\u5668 (software prefetcher) \u867d\u7136\u77e5\u9053\u7a0b\u5e8f\u5458\u7684\u610f\u56fe\uff0c\u4f46\u9700\u8981\u5728\u4ee3\u7801\u4e2d\u63d2\u5165\u989d\u5916\u7684\u6307\u4ee4\u6765\u8ba1\u7b97\u548c\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\u3002\u8fd9\u4e0d\u4ec5\u589e\u52a0\u4e86 \u6307\u4ee4\u5f00\u9500 (instruction overhead)\uff0c\u8fd8\u56e0\u4e3a\u8f6f\u4ef6\u65e0\u6cd5\u7cbe\u786e\u611f\u77e5\u786c\u4ef6\u8fd0\u884c\u65f6\u7684\u52a8\u6001\uff08\u5982\u603b\u7ebf\u62e5\u585e\uff09\uff0c\u5bfc\u81f4\u9884\u53d6\u65f6\u673a\u4e0d\u51c6\uff0c\u53ef\u80fd\u8fc7\u65e9\uff08\u6570\u636e\u88ab\u6324\u51fa\u7f13\u5b58\uff09\u6216\u8fc7\u665a\uff08\u6ca1\u8d77\u5230\u9690\u85cf\u5ef6\u8fdf\u7684\u4f5c\u7528\uff09\u3002 - \u6838\u5fc3\u77db\u76fe\u5728\u4e8e\uff1a\u5f88\u591a\u91cd\u8981\u5e94\u7528\uff08\u5982\u56fe\u7b97\u6cd5\u3001\u7a00\u758f\u77e9\u9635\u8fed\u4ee3\u6c42\u89e3\uff09\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u867d\u7136\u4e0d\u89c4\u5219\uff0c\u4f46\u5728\u591a\u6b21\u8fed\u4ee3\u4e2d\u662f\u5b8c\u5168\u91cd\u590d\u7684\u3002\u786c\u4ef6\u4e0d\u77e5\u9053\u8fd9\u4e2a\u201c\u91cd\u590d\u201d\u7684\u8bed\u4e49\uff0c\u800c\u8f6f\u4ef6\u53c8\u4e0d\u60f3/\u4e0d\u80fd\u9ad8\u6548\u5730\u627f\u62c5\u5730\u5740\u751f\u6210\u548c\u7cbe\u51c6\u8c03\u5ea6\u7684\u4efb\u52a1\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u6bcf\u5929\u90fd\u8981\u8d70\u4e00\u6761\u975e\u5e38\u590d\u6742\u3001\u6ca1\u6709\u89c4\u5f8b\u7684\u8ff7\u5bab\u53bb\u4e0a\u73ed\u3002\u7b2c\u4e00\u6b21\u8d70\u7684\u65f6\u5019\uff0c\u4f60\u78d5\u78d5\u7eca\u7eca\uff0c\u82b1\u4e86\u5f88\u591a\u65f6\u95f4\uff08\u76f8\u5f53\u4e8e\u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u6027\u80fd\u5dee\uff09\u3002 - \u4e00\u4e2a\u7b28\u62d9\u7684\u5411\u5bfc\uff08\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\uff09\u8bd5\u56fe\u8bb0\u4f4f\u4f60\u8d70\u8fc7\u7684\u8def\uff0c\u4f46\u4ed6\u8bb0\u6027\u4e0d\u597d\uff0c\u53ea\u80fd\u8bb0\u4f4f\u6700\u8fd1\u51e0\u6b65\uff0c\u6216\u8005\u628a\u6240\u6709\u8d70\u8fc7\u7684\u8def\u6df7\u5728\u4e00\u8d77\u8bb0\uff0c\u4e0b\u6b21\u8fd8\u662f\u4f1a\u5e26\u4f60\u8d70\u9519\u3002 - \u5982\u679c\u4f60\u81ea\u5df1\u6bcf\u6b21\u53bb\u90fd\u5f97\u91cd\u65b0\u753b\u4e00\u904d\u5730\u56fe\u5e76\u5e26\u8def\uff08\u8f6f\u4ef6\u9884\u53d6\uff09\uff0c\u90a3\u592a\u7d2f\u4e86\uff0c\u800c\u4e14\u4f60\u8fd8\u5f97\u4e00\u8fb9\u770b\u5730\u56fe\u4e00\u8fb9\u8d70\u8def\uff0c\u6548\u7387\u4e5f\u4e0d\u9ad8\u3002 - RnR \u7684\u505a\u6cd5\u662f\uff1a\u7b2c\u4e00\u6b21\u8d70\u8ff7\u5bab\u65f6\uff0c\u4f60\u5e26\u4e0a\u4e00\u4e2a\u5f55\u97f3\u7b14\uff08\u8bb0\u5f55\u9636\u6bb5\uff09\uff0c\u628a\u4f60\u6bcf\u4e00\u6b65\u8e29\u7a7a\uff08\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u7684\u4f4d\u7f6e\u548c\u987a\u5e8f\u90fd\u5f55\u4e0b\u6765\u3002\u4ece\u7b2c\u4e8c\u5929\u5f00\u59cb\uff0c\u4f60\u5c31\u4e0d\u7528\u81ea\u5df1\u8bb0\u8def\u4e86\uff0c\u800c\u662f\u653e\u5f55\u97f3\uff08\u56de\u653e\u9636\u6bb5\uff09\uff0c\u8ba9\u4e00\u4e2a\u4e13\u804c\u7684\u3001\u8dd1\u5f97\u98de\u5feb\u7684\u4fe1\u4f7f\uff08\u786c\u4ef6\u9884\u53d6\u5668\uff09\u542c\u7740\u5f55\u97f3\uff0c\u63d0\u524d\u4e00\u6b65\u628a\u4f60\u8981\u8e29\u7684\u7816\u5757\uff08\u6570\u636e\uff09\u653e\u5230\u4f60\u811a\u4e0b\u3002\u4f60\u53ea\u9700\u8981\u4e13\u6ce8\u4e8e\u8d70\u8def\uff08\u6267\u884c\u8ba1\u7b97\uff09\u5c31\u884c\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u8ba9\u786c\u4ef6\u53d8\u5f97\u66f4\u201c\u806a\u660e\u201d\u53bb\u9884\u6d4b\u4efb\u610f\u7684\u4e0d\u89c4\u5219\u6a21\u5f0f\uff0c\u800c\u662f\u5de7\u5999\u5730\u5f15\u5165\u4e86\u4e00\u4e2a \u8f7b\u91cf\u7ea7\u7684\u8f6f\u4ef6-\u786c\u4ef6\u534f\u540c\u5951\u7ea6\u3002\u8fd9\u4e2a\u5951\u7ea6\u901a\u8fc7\u51e0\u4e2a\u7b80\u5355\u7684API\u5b9e\u73b0\uff1a     - <code>RnR.AddrBase.set(...)</code>: \u544a\u8bc9\u786c\u4ef6\uff1a\u201c\u6ce8\u610f\uff0c\u4e0b\u9762\u8fd9\u5757\u5185\u5b58\u533a\u57df\uff08\u6bd4\u5982PageRank\u91cc\u7684pcurr\u6570\u7ec4\uff09\u7684\u8bbf\u95ee\u6a21\u5f0f\u5f88\u7279\u6b8a\uff0c\u4f60\u8981\u76ef\u7d27\u5b83\u201d\u3002     - <code>RnR.PrefetchState.start()</code>: \u544a\u8bc9\u786c\u4ef6\uff1a\u201c\u73b0\u5728\u662f\u7b2c\u4e00\u6b21\u8fed\u4ee3\uff0c\u5f00\u59cb\u5f55\u97f3\uff01\u628a\u6240\u6709\u6765\u81ea\u8fd9\u5757\u533a\u57df\u7684L2\u7f13\u5b58\u672a\u547d\u4e2d\u5730\u5740\u6309\u987a\u5e8f\u8bb0\u4e0b\u6765\u201d\u3002     - <code>RnR.PrefetchState.replay()</code>: \u544a\u8bc9\u786c\u4ef6\uff1a\u201c\u540e\u9762\u7684\u8fed\u4ee3\u5f00\u59cb\u4e86\uff0c\u522b\u518d\u5f55\u97f3\u4e86\uff0c\u76f4\u63a5\u6309\u521a\u624d\u5f55\u597d\u7684\u78c1\u5e26\uff08\u8bb0\u5f55\u7684\u5730\u5740\u5e8f\u5217\uff09\u53bb\u9884\u53d6\u6570\u636e\u5427\uff01\u201d - \u8fd9\u4e2a\u8bbe\u8ba1\u6700\u7cbe\u5999\u7684\u5730\u65b9\u5728\u4e8e \u804c\u8d23\u5206\u79bb\uff1a     - \u8f6f\u4ef6\u8d1f\u8d23\u63d0\u4f9b\u9ad8\u5c42\u8bed\u4e49\uff1a\u4ec0\u4e48\u65f6\u5019\u5f00\u59cb/\u7ed3\u675f\u4e00\u4e2a\u91cd\u590d\u7684\u9636\u6bb5\uff08\u8fed\u4ee3\uff09\uff0c\u4ee5\u53ca\u54ea\u4e2a\u6570\u636e\u7ed3\u6784\u662f\u76ee\u6807\u3002\u8fd9\u89e3\u51b3\u4e86\u786c\u4ef6\u65e0\u6cd5\u7406\u89e3\u7a0b\u5e8f\u903b\u8f91\u7684\u6839\u672c\u95ee\u9898\u3002     - \u786c\u4ef6\u8d1f\u8d23\u5e95\u5c42\u6267\u884c\uff1a\u9ad8\u6548\u3001\u53ca\u65f6\u5730\u8bb0\u5f55\u548c\u56de\u653e\u5730\u5740\u6d41\uff0c\u5e76\u4e14\u5229\u7528\u8bb0\u5f55\u4e0b\u6765\u7684\u7a97\u53e3\u5185\u672a\u547d\u4e2d\u7387\u4fe1\u606f\uff08</p> <p></p> <p>Fig. 5. Prefetching timing control example with window size = 3.</p> <p>\uff09\u6765\u52a8\u6001\u8c03\u6574\u9884\u53d6\u901f\u5ea6\uff0c\u786e\u4fdd\u6570\u636e\u65e2\u4e0d\u4f1a\u592a\u65e9\u88ab\u6324\u51fa\u53bb\uff0c\u4e5f\u4e0d\u4f1a\u592a\u665a\u624d\u5230\u3002\u8fd9\u89e3\u51b3\u4e86\u8f6f\u4ef6\u65e0\u6cd5\u7cbe\u51c6\u63a7\u5236\u786c\u4ef6\u65f6\u5e8f\u7684\u95ee\u9898\u3002 - \u6700\u7ec8\u6548\u679c\u5c31\u662f\uff0c\u5bf9\u4e8e\u8fd9\u7c7b\u91cd\u590d\u7684\u4e0d\u89c4\u5219\u8bbf\u95ee\uff0cRnR\u5b9e\u73b0\u4e86\u63a5\u8fd1\u5b8c\u7f8e\u7684 \u9884\u53d6\u51c6\u786e\u7387 (prefetching accuracy) \u548c \u672a\u547d\u4e2d\u8986\u76d6\u7387 (miss coverage)\uff08</p> <p></p> <p>Fig. 9. Prefetcher accuracy.</p> <p>\u548c </p> <p></p> <p>Fig. 8. Miss coverage.</p> <p>\uff09\uff0c\u4ece\u800c\u5e26\u6765\u4e86\u663e\u8457\u7684\u6027\u80fd\u63d0\u5347\uff08</p> <p></p> <p>Fig. 6. Speedup over no prefetcher baseline.</p> <p>\uff09\u3002</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/ELI5_notes/#2-eli5","title":"2. \u57fa\u4e8e\u7a97\u53e3\u7684\u56de\u653e\u65f6\u5e8f\u63a7\u5236 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 Next-line, Bingo\uff09\u5728\u5904\u7406 irregular memory access \u65f6\uff0c\u6700\u5927\u7684\u95ee\u9898\u4e0d\u662f\u201c\u731c\u4e0d\u51c6\u201d\uff0c\u800c\u662f\u201c\u9001\u5f97\u4e0d\u662f\u65f6\u5019\u201d\u3002 - \u5b83\u4eec\u901a\u5e38\u5728\u4e00\u6b21 demand miss \u540e\uff0c\u5c31\u4e00\u80a1\u8111\u5730\u628a\u9884\u6d4b\u5230\u7684\u540e\u7eed\u5730\u5740\u90fd\u53d1\u51fa\u53bb\u3002\u8fd9\u4f1a\u5bfc\u81f4\u4e24\u4e2a\u707e\u96be\u6027\u540e\u679c\uff1a   - \u9884\u53d6\u592a\u65e9 (Too Early)\uff1a\u6570\u636e\u88ab\u63d0\u524d\u52a0\u8f7d\u5230 L2 cache\uff0c\u4f46\u7a0b\u5e8f\u8fd8\u6ca1\u6267\u884c\u5230\u90a3\u91cc\u3002\u5728\u8fd9\u6bb5\u7b49\u5f85\u65f6\u95f4\u91cc\uff0c\u8fd9\u4e9b\u5b9d\u8d35\u7684\u6570\u636e\u5f88\u53ef\u80fd\u56e0\u4e3a cache capacity eviction \u800c\u88ab\u5176\u4ed6\u6570\u636e\u6324\u51fa\u53bb\uff0c\u7b49\u771f\u6b63\u8981\u7528\u65f6\u53c8\u5f97\u91cd\u65b0\u4ece\u5185\u5b58\u52a0\u8f7d\uff0c\u767d\u5fd9\u6d3b\u4e00\u573a\u3002   - \u9884\u53d6\u592a\u665a (Too Late)\uff1a\u5982\u679c\u9884\u53d6\u8bf7\u6c42\u53d1\u5f97\u592a\u4fdd\u5b88\uff0c\u7b49\u5230\u7a0b\u5e8f\u5feb\u7528\u5230\u6570\u636e\u65f6\u624d\u5f00\u59cb\u9884\u53d6\uff0c\u90a3\u5c31\u5b8c\u5168\u65e0\u6cd5 hide the memory latency\uff0c\u5931\u53bb\u4e86\u9884\u53d6\u7684\u610f\u4e49\u3002 - \u7b80\u5355\u8bf4\uff0c\u65e7\u65b9\u6cd5\u662f\u201c\u76f2\u6253\u201d\uff0c\u5b83\u4e0d\u77e5\u9053\u7a0b\u5e8f\u6267\u884c\u7684\u201c\u8282\u594f\u201d\u6709\u591a\u5feb\uff0c\u53ea\u80fd\u51ed\u611f\u89c9\u4e71\u9001\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u5728\u7ed9\u4e00\u4e2a\u9a6c\u62c9\u677e\u9009\u624b\u9012\u6c34\u3002\u4f60\u7684\u76ee\u6807\u662f\u8ba9\u4ed6\u5728\u521a\u597d\u53e3\u6e34\u7684\u65f6\u5019\uff0c\u624b\u91cc\u5c31\u6709\u6c34\u3002 - \u65e7\u5f0f\u9884\u53d6\u5668\u7684\u505a\u6cd5\u662f\uff1a\u770b\u5230\u4ed6\u8dd1\u8fc7\u7b2c\u4e00\u4e2a\u8865\u7ed9\u7ad9\uff0c\u5c31\u628a\u540e\u9762\u6240\u6709\u8865\u7ed9\u7ad9\u7684\u6c34\u90fd\u4e00\u6b21\u6027\u6254\u5230\u8d5b\u9053\u4e0a\u3002\u7ed3\u679c\u8981\u4e48\u6c34\u74f6\u88ab\u540e\u9762\u7684\u9009\u624b\u8e22\u98de\u4e86\uff08cache eviction\uff09\uff0c\u8981\u4e48\u4ed6\u8dd1\u5230\u5f88\u8fdc\u624d\u53d1\u73b0\u6c34\u8fd8\u5728\u8d77\u70b9\u9644\u8fd1\uff08too late\uff09\u3002 - RnR \u7684\u201c\u57fa\u4e8e\u7a97\u53e3\u7684\u56de\u653e\u65f6\u5e8f\u63a7\u5236\u201d\u5219\u806a\u660e\u5f97\u591a\u3002\u5b83\u5148\u8ddf\u7740\u9009\u624b\u8dd1\u4e00\u5708\uff08Record \u9636\u6bb5\uff09\uff0c\u8be6\u7ec6\u8bb0\u5f55\u4e0b\u4ed6\u5728\u6bcf\u4e00\u6bb5\uff08\u6bd4\u5982\u6bcf5\u516c\u91cc\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a window\uff09\u4f1a\u559d\u591a\u5c11\u53e3\u6c34\uff08miss ratio\uff09\u3002 - \u5728\u6b63\u5f0f\u6bd4\u8d5b\uff08Replay \u9636\u6bb5\uff09\uff0c\u4f60\u5c31\u6839\u636e\u8fd9\u4efd\u8bb0\u5f55\uff0c\u5728\u4ed6\u8fdb\u5165\u4e0b\u4e00\u6bb5\u8def\u4e4b\u524d\uff0c\u7cbe\u51c6\u5730\u53ea\u9012\u7ed9\u4ed6\u8fd9\u4e00\u6bb5\u9700\u8981\u7684\u6c34\u91cf\uff0c\u5e76\u4e14\u6839\u636e\u4ed6\u5f53\u524d\u7684\u914d\u901f\uff08Cur Struct Read counter\uff09\u6765\u51b3\u5b9a\u4ec0\u4e48\u65f6\u5019\u9012\u3002\u8fd9\u6837\u65e2\u4e0d\u4f1a\u6d6a\u8d39\u6c34\uff08\u5e26\u5bbd\uff09\uff0c\u4e5f\u80fd\u4fdd\u8bc1\u4ed6\u968f\u65f6\u6709\u6c34\u559d\uff08timely prefetch\uff09\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u53bb\u9884\u6d4b\u590d\u6742\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u800c\u662f\u5229\u7528\u4e86\u8fd9\u7c7b\u5e94\u7528\uff08\u5982 PageRank, SpMV\uff09\u7684\u4e00\u4e2a\u6838\u5fc3\u7279\u6027\uff1a\u91cd\u590d\u6027 (repeating pattern)\u3002 - \u4ed6\u4eec\u505a\u7684\u5173\u952e\u626d\u8f6c\u662f\uff1a\u5c06\u201c\u9884\u53d6\u65f6\u673a\u201d\u7684\u51b3\u7b56\u4f9d\u636e\uff0c\u4ece\u201c\u731c\u6d4b\u672a\u6765\u201d\u8f6c\u53d8\u4e3a\u201c\u590d\u523b\u8fc7\u53bb\u201d\u3002 - \u5177\u4f53\u6765\u8bf4\uff0c\u5728 Record \u9636\u6bb5\uff0c\u7cfb\u7edf\u4e0d\u53ea\u662f\u7b80\u5355\u5730\u8bb0\u5f55\u4e0b\u6240\u6709 L2 miss \u7684\u5730\u5740\u5e8f\u5217\uff0c\u8fd8\u989d\u5916\u505a\u4e86\u4e00\u4ef6\u4e8b\uff1a   - \u5c06\u6574\u4e2a\u8bbf\u95ee\u5e8f\u5217\u6309\u56fa\u5b9a\u7684 window size\uff08\u4f8b\u5982\uff0c\u6bcf3\u4e2a\u672a\u547d\u4e2d\u4e3a\u4e00\u4e2a\u7a97\u53e3\uff09\u5207\u5206\u6210\u591a\u4e2a\u7a97\u53e3\u3002   - \u5bf9\u6bcf\u4e2a\u7a97\u53e3\uff0c\u8bb0\u5f55\u4e0b\u4e24\u4e2a\u5173\u952e\u5143\u6570\u636e\uff1a1) \u7a97\u53e3\u5185\u7684 miss addresses\uff1b2) \u4e3a\u4e86\u4ea7\u751f\u8fd9\u4e9b\u672a\u547d\u4e2d\uff0c\u7a0b\u5e8f\u603b\u5171\u6267\u884c\u4e86\u591a\u5c11\u6b21\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\uff08\u5373 demand accesses\uff09\u3002\u8fd9\u4e2a\u603b\u6570\u76f4\u63a5\u53cd\u6620\u4e86\u8be5\u7a97\u53e3\u7684 miss ratio\u3002 - \u5728 Replay \u9636\u6bb5\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u5185\u90e8\u7ef4\u62a4\u4e00\u4e2a\u8ba1\u6570\u5668\uff08Cur Struct Read\uff09\uff0c\u5b9e\u65f6\u8ffd\u8e2a\u7a0b\u5e8f\u5f53\u524d\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\u8fdb\u5ea6\u3002 - \u5f53\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u5339\u914d\u4e0a\u4e0a\u4e00\u4e2a\u7a97\u53e3\u6240\u8bb0\u5f55\u7684 demand accesses \u603b\u6570\u65f6\uff0c\u9884\u53d6\u5668\u5c31\u77e5\u9053\uff1a\u201c\u597d\uff0c\u4e0a\u4e00\u6bb5\u7ed3\u675f\u4e86\uff0c\u73b0\u5728\u8be5\u4e3a\u4e0b\u4e00\u6bb5\uff08\u4e0b\u4e00\u4e2a\u7a97\u53e3\uff09\u9884\u53d6\u6570\u636e\u4e86\u201d\u3002 - \u8fd9\u6837\uff0c\u9884\u53d6\u884c\u4e3a\u5c31\u88ab\u7cbe\u786e\u5730\u201c\u951a\u5b9a\u201d\u5728\u4e86\u7a0b\u5e8f\u7684\u5b9e\u9645\u6267\u884c\u8fdb\u5ea6\u4e0a\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86 timely prefetching\uff0c\u5b8c\u7f8e\u907f\u514d\u4e86\u6570\u636e\u56e0\u7b49\u5f85\u8fc7\u4e45\u800c\u88ab\u9a71\u9010\u7684\u95ee\u9898\u3002</p> <p></p> <p>Fig. 5. Prefetching timing control example with window size = 3.</p> <p>\u4e0a\u56fe\u6e05\u6670\u5730\u5c55\u793a\u4e86\u8fd9\u4e2a\u673a\u5236\u7684\u6548\u679c\u3002\u56fe(b)\u662f\u65e0\u63a7\u5236\u7684\u9884\u53d6\uff0c\u6570\u636e\u88ab\u8fc7\u65e9\u52a0\u8f7d\u5e76\u53ef\u80fd\u88ab\u9a71\u9010\u3002\u56fe(c)\u548c(d)\u5c55\u793a\u4e86\u57fa\u4e8e\u7a97\u53e3\u7684\u63a7\u5236\u5982\u4f55\u8ba9\u9884\u53d6\u8bf7\u6c42\u4e0e\u7a0b\u5e8f\u9700\u6c42\u5b8c\u7f8e\u540c\u6b65\u3002\u8bba\u6587\u7684\u8bc4\u4f30\u4e5f\u8bc1\u5b9e\u4e86\u8fd9\u4e00\u70b9\uff1a</p> <p></p> <p>Fig. 10. Effectiveness of replay timing control.</p> <p>\u6570\u636e\u663e\u793a\uff0c\u52a0\u5165\u7a97\u53e3\u63a7\u5236\u540e\uff0c\u6027\u80fd\u63d0\u5347\u4ece\u51e0\u4e4e\u4e3a\u96f6\u4e00\u8dc3\u81f3 2.31x\uff0c\u8fd9\u6b63\u662f\u89e3\u51b3\u4e86\u201ctimeliness\u201d\u8fd9\u4e00\u6838\u5fc3\u75db\u70b9\u6240\u5e26\u6765\u7684\u5de8\u5927\u6536\u76ca\u3002</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/ELI5_notes/#3-eli5","title":"3. \u8f6f\u786c\u4ef6\u534f\u540c\u7684\u8f7b\u91cf\u7ea7\u7f16\u7a0b\u63a5\u53e3 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 \u786c\u4ef6\u9884\u53d6\u5668 (hardware prefetcher) \u662f\u4e2a\u201c\u9ed1\u76d2\u201d\uff0c\u5b83\u53ea\u80fd\u9760\u81ea\u5df1\u89c2\u5bdf\u8fc7\u53bb\u7684\u8bbf\u5b58\u6a21\u5f0f\u6765\u731c\u672a\u6765\u3002\u5bf9\u4e8e PageRank \u6216 SpMV \u8fd9\u7c7b\u5e94\u7528\uff0c\u5176\u8bbf\u5b58\u6a21\u5f0f\u662f \u957f\u4e14\u4e0d\u89c4\u5219 (long and irregular) \u7684\uff0c\u4f46\u504f\u504f\u5728\u6bcf\u6b21\u8fed\u4ee3\u4e2d\u53c8 \u5b8c\u7f8e\u91cd\u590d\u3002\u786c\u4ef6\u9884\u53d6\u5668\u9762\u5bf9\u8fd9\u79cd\u201c\u4e00\u6b21\u6027\u957f\u5e8f\u5217\u201d\u6839\u672c\u8bb0\u4e0d\u4f4f\uff0c\u6216\u8005\u4f1a\u548c\u5176\u4ed6\u76f8\u4f3c\u6a21\u5f0f\u6df7\u6dc6\uff0c\u5bfc\u81f4 \u51c6\u786e\u7387 (accuracy) \u548c \u8986\u76d6\u7387 (coverage) \u53cc\u4f4e\u3002 - \u800c \u8f6f\u4ef6\u9884\u53d6 (software prefetching) \u867d\u7136\u7a0b\u5e8f\u5458\u77e5\u9053\u6a21\u5f0f\u5728\u54ea\uff0c\u4f46\u9700\u8981\u5728\u4ee3\u7801\u91cc\u63d2\u5165\u989d\u5916\u7684 prefetch \u6307\u4ee4\u3002\u8fd9\u4e0d\u4ec5\u589e\u52a0\u4e86 \u6307\u4ee4\u5f00\u9500 (instruction overhead)\uff0c\u8fd8\u56e0\u4e3a\u8f6f\u4ef6\u65e0\u6cd5\u611f\u77e5\u5e95\u5c42\u5185\u5b58\u7cfb\u7edf\u7684\u5b9e\u65f6\u72b6\u6001\uff08\u6bd4\u5982\u603b\u7ebf\u662f\u5426\u62e5\u5835\uff09\uff0c\u5f88\u96be\u505a\u5230 \u53ca\u65f6 (timely) \u9884\u53d6\uff0c\u53ef\u80fd\u53d6\u65e9\u4e86\u88ab\u6324\u51fa\u7f13\u5b58\uff0c\u53d6\u665a\u4e86\u53c8\u6ca1\u7528\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u8981\u5728\u4e00\u4e2a\u5de8\u5927\u7684\u3001\u5e03\u5c40\u6df7\u4e71\u7684\u4ed3\u5e93\uff08\u4e3b\u5b58\uff09\u91cc\u53cd\u590d\u627e\u4e00\u6279\u7279\u5b9a\u7684\u96f6\u4ef6\uff08\u6570\u636e\uff09\u3002\u6bcf\u6b21\u4efb\u52a1\uff08\u8fed\u4ee3\uff09\u8981\u627e\u7684\u96f6\u4ef6\u6e05\u5355\u548c\u987a\u5e8f\u90fd\u4e00\u6a21\u4e00\u6837\uff0c\u4f46\u6e05\u5355\u592a\u957f\uff0c\u4f60\u6ca1\u6cd5\u5168\u8bb0\u4f4f\u3002 - \u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668 \u5c31\u50cf\u4e00\u4e2a\u53ea\u51ed\u7ecf\u9a8c\u731c\u6d4b\u7684\u4ed3\u5e93\u7ba1\u7406\u5458\u3002\u4ed6\u770b\u5230\u4f60\u62ff\u4e86A\uff0c\u5c31\u731c\u4f60\u4e0b\u4e00\u4e2a\u8981\u62ffB\u6216C\uff0c\u4f46\u5728\u6df7\u4e71\u7684\u4ed3\u5e93\u91cc\uff0c\u4ed6\u7684\u731c\u6d4b\u7ecf\u5e38\u51fa\u9519\u3002 - \u8f6f\u4ef6\u9884\u53d6 \u5c31\u50cf\u4f60\u81ea\u5df1\u62ff\u7740\u6e05\u5355\uff0c\u4e00\u8fb9\u5e72\u6d3b\u4e00\u8fb9\u5927\u58f0\u558a\uff1a\u201c\u7ba1\u7406\u5458\uff0c\u5e2e\u6211\u628a\u7b2c100\u4e2a\u96f6\u4ef6\u5148\u51c6\u5907\u597d\uff01\u201d \u4f46\u4f60\u558a\u8bdd\u672c\u8eab\u803d\u8bef\u65f6\u95f4\uff0c\u800c\u4e14\u7ba1\u7406\u5458\u53ef\u80fd\u6b63\u5fd9\u7740\u5904\u7406\u522b\u4eba\u7684\u8bf7\u6c42\uff0c\u7b49\u4ed6\u62ff\u5230\u65f6\u4f60\u5df2\u7ecf\u4e0d\u9700\u8981\u4e86\u3002 - RnR\u7684\u8f7b\u91cf\u7ea7\u63a5\u53e3 \u5219\u50cf\u662f\u4f60\u7ed9\u4e86\u7ba1\u7406\u5458\u4e00\u4e2a \u5bf9\u8bb2\u673a \u548c\u4e00\u4efd \u7cbe\u786e\u7684\u64cd\u4f5c\u624b\u518c\u3002\u4f60\u7b2c\u4e00\u6b21\u6267\u884c\u4efb\u52a1\u65f6\uff0c\u544a\u8bc9\u7ba1\u7406\u5458\uff1a\u201c\u73b0\u5728\u5f00\u59cb\u5f55\u97f3\uff0c\u8bb0\u4e0b\u6211\u6bcf\u6b21\u627e\u4e0d\u5230\u96f6\u4ef6\u65f6\u53bb\u7684\u8d27\u67b6\u53f7\u201d\u3002\u4efb\u52a1\u7ed3\u675f\u540e\uff0c\u4f60\u544a\u8bc9\u4ed6\uff1a\u201c\u4e0b\u6b21\u4efb\u52a1\u5f00\u59cb\u65f6\uff0c\u4f60\u5c31\u6309\u5f55\u97f3\u91cc\u7684\u987a\u5e8f\uff0c\u63d0\u524d\u628a\u90a3\u4e9b\u8d27\u67b6\u7684\u96f6\u4ef6\u653e\u5230\u6211\u7684\u5de5\u4f5c\u53f0\uff08L2 cache\uff09\u4e0a\u3002\u201d \u7ba1\u7406\u5458\uff08\u786c\u4ef6\uff09\u53ea\u9700\u8981\u5fe0\u5b9e\u56de\u653e\uff0c\u800c\u4f60\uff08\u8f6f\u4ef6\uff09\u53ea\u9700\u5728\u5173\u952e\u8282\u70b9\u53d1\u51e0\u4e2a\u7b80\u5355\u7684\u6307\u4ee4\uff08\u5f00\u59cb\u5f55\u97f3\u3001\u5f00\u59cb\u56de\u653e\u3001\u7ed3\u675f\uff09\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u8ba9\u786c\u4ef6\u53d8\u5f97\u66f4\u806a\u660e\u53bb\u8bc6\u522b\u590d\u6742\u6a21\u5f0f\uff0c\u800c\u662f\u5de7\u5999\u5730 \u5c06\u201c\u6a21\u5f0f\u8bc6\u522b\u201d\u7684\u8d23\u4efb\u4ea4\u8fd8\u7ed9\u6700\u4e86\u89e3\u7a0b\u5e8f\u7684\u8f6f\u4ef6\uff0c\u540c\u65f6\u4e3a\u786c\u4ef6\u63d0\u4f9b\u4e86\u4e00\u4e2a \u6781\u7b80\u7684\u63a7\u5236\u901a\u9053\u3002 - \u8fd9\u4e2a\u901a\u9053\u5c31\u662f\u4e00\u7ec4 \u7279\u6b8a\u7684\u4f53\u7cfb\u7ed3\u6784\u5bc4\u5b58\u5668 (special architectural registers)\uff0c\u5b83\u4eec\u6784\u6210\u4e86\u8f6f\u786c\u4ef6\u4e4b\u95f4\u7684 \u8f7b\u91cf\u7ea7\u7f16\u7a0b\u63a5\u53e3\u3002\u901a\u8fc7\u8fd9\u4e2a\u63a5\u53e3\uff0c\u8f6f\u4ef6\u53ef\u4ee5\u7cbe\u786e\u5730\uff1a     - \u5212\u5b9a\u7a7a\u95f4\u8303\u56f4\uff1a\u901a\u8fc7\u8bbe\u7f6e <code>boundary checking address registers</code>\uff0c\u544a\u8bc9\u786c\u4ef6\u201c\u53ea\u5173\u5fc3\u8fd9\u4e2a\u5730\u5740\u8303\u56f4\u5185\u7684\u6570\u636e\u7ed3\u6784\uff08\u6bd4\u5982 pcurr \u6570\u7ec4\uff09\u201d\uff0c\u4ece\u800c\u8fc7\u6ee4\u6389\u65e0\u5173\u7684\u3001\u6709\u89c4\u5f8b\u7684\u8bbf\u5b58\uff08\u5982\u77e9\u9635\u7684\u884c\u6307\u9488\uff09\uff0c\u8ba9\u786c\u4ef6\u4e13\u6ce8\u5904\u7406\u771f\u6b63\u7684\u4e0d\u89c4\u5219\u8bbf\u95ee\u3002     - \u63a7\u5236\u65f6\u95f4\u8282\u594f\uff1a\u901a\u8fc7\u64cd\u4f5c <code>prefetch state register</code>\uff08\u5982\u8c03\u7528 <code>RnR.PrefetchState.start()</code> \u548c <code>RnR.PrefetchState.replay()</code>\uff09\uff0c\u660e\u786e\u6307\u793a\u786c\u4ef6\u201c\u73b0\u5728\u662f\u7b2c\u4e00\u6b21\u8fd0\u884c\uff0c\u5f00\u59cb\u8bb0\u5f55\u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217\u201d\u548c\u201c\u63a5\u4e0b\u6765\u7684\u8fed\u4ee3\u90fd\u662f\u91cd\u590d\u7684\uff0c\u5f00\u59cb\u56de\u653e\u9884\u53d6\u201d\u3002     - \u4f20\u9012\u5143\u6570\u636e\u4f4d\u7f6e\uff1a\u901a\u8fc7 <code>base address register for a Sequence Table</code> \u7b49\u5bc4\u5b58\u5668\uff0c\u76f4\u63a5\u544a\u8bc9\u786c\u4ef6\u201c\u628a\u8bb0\u5f55\u4e0b\u6765\u7684\u6570\u636e\uff08miss sequence\uff09\u5b58\u5728\u5185\u5b58\u7684\u8fd9\u4e2a\u4f4d\u7f6e\u201d\uff0c\u4ee5\u53ca\u201c\u7528\u6765\u63a7\u5236\u9884\u53d6\u8282\u594f\u7684\u7a97\u53e3\u4fe1\u606f\u8868\u5728\u90a3\u4e2a\u4f4d\u7f6e\u201d\u3002 - \u8fd9\u4e2a\u8bbe\u8ba1\u7684\u5173\u952e\u626d\u8f6c\u5728\u4e8e\uff1a\u7528\u51e0\u4e2a\u7b80\u5355\u7684\u5bc4\u5b58\u5668\u5199\u64cd\u4f5c\uff0c\u66ff\u4ee3\u4e86\u590d\u6742\u7684\u5728\u7ebf\u6a21\u5f0f\u5b66\u4e60\u548c\u5927\u91cf\u7684\u6307\u4ee4\u63d2\u5165\u3002\u786c\u4ef6\u4e0d\u518d\u9700\u8981\u5e9e\u5927\u7684\u6a21\u5f0f\u8868\u548c\u590d\u6742\u7684\u5339\u914d\u903b\u8f91\uff0c\u5b83\u53d8\u6210\u4e86\u4e00\u4e2a\u9ad8\u6548\u7684\u201c\u5f55\u97f3\u673a\u201d\u548c\u201c\u64ad\u653e\u5668\u201d\uff0c\u800c\u8f6f\u4ef6\u5219\u626e\u6f14\u4e86\u201c\u5bfc\u6f14\u201d\u7684\u89d2\u8272\uff0c\u5728\u6700\u5408\u9002\u7684\u65f6\u673a\u53d1\u51fa\u6700\u5173\u952e\u7684\u6307\u4ee4\u3002\u8fd9\u79cd\u5206\u5de5\u4f7f\u5f97\u7cfb\u7edf\u65e2\u80fd\u83b7\u5f97\u63a5\u8fd1100%\u7684\u9884\u53d6\u51c6\u786e\u7387\uff0c\u53c8\u907f\u514d\u4e86\u8f6f\u4ef6\u9884\u53d6\u7684\u6027\u80fd\u5f00\u9500\u3002</p> <p></p> <p>Fig. 3. State transition diagram of the RnR prefetch state.</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/ELI5_notes/#4-l2-eli5","title":"4. \u79c1\u6709L2\u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217\u8bb0\u5f55 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982\u57fa\u4e8eGHB\u7684\u65f6\u5e8f\u9884\u53d6\u5668\uff09\u8bd5\u56fe\u4ece\u6240\u6709\u5185\u5b58\u8bbf\u95ee\u4e2d\u5b66\u4e60\u6a21\u5f0f\uff0c\u4f46\u8fd9\u5728\u5904\u7406\u50cf\u56fe\u8ba1\u7b97\u6216\u7a00\u758f\u77e9\u9635\u4e58\u6cd5\u8fd9\u7c7b\u5e94\u7528\u65f6\u4f1a\u201c\u5f88\u96be\u53d7\u201d\u3002 - \u8fd9\u4e9b\u5e94\u7528\u7684\u5185\u5b58\u8bbf\u95ee\u6d41\u662f\u6df7\u5408\u7684\uff1a\u65e2\u6709\u5bf9\u77e9\u9635/\u8fb9\u5217\u8868\u7684\u89c4\u5219\u3001\u6d41\u5f0f\u8bbf\u95ee\uff08\u80fd\u88abL1/L2\u7f13\u5b58\u8f7b\u677e\u6355\u83b7\uff09\uff0c\u4e5f\u6709\u5bf9\u9876\u70b9\u503c/\u5411\u91cf\u7684\u4e0d\u89c4\u5219\u3001\u8df3\u8dc3\u5f0f\u8bbf\u95ee\uff08\u624d\u662f\u771f\u6b63\u5bfc\u81f4\u957f\u5ef6\u8fdf\u7684\u7f6a\u9b41\u7978\u9996\uff09\u3002 - \u5982\u679c\u9884\u53d6\u5668\u8bb0\u5f55\u6240\u6709\u8bbf\u95ee\uff0c\u5b83\u4f1a\u88ab\u5927\u91cf\u201c\u65e0\u7528\u201d\u7684\u89c4\u5219\u8bbf\u95ee\u6df9\u6ca1\uff0c\u4e0d\u4ec5\u6d6a\u8d39\u5b9d\u8d35\u7684\u5143\u6570\u636e\u5b58\u50a8\u7a7a\u95f4\uff0c\u8fd8\u4f1a\u56e0\u4e3a\u6a21\u5f0f\u6df7\u6dc6\u800c\u964d\u4f4e\u5bf9\u771f\u6b63\u4e0d\u89c4\u5219\u6a21\u5f0f\u7684\u9884\u6d4b\u51c6\u786e\u7387\u3002\u8fd9\u5c31\u50cf\u5728\u4e00\u4e2a\u5608\u6742\u7684\u623f\u95f4\u91cc\uff0c\u4f60\u5f88\u96be\u542c\u6e05\u4e00\u4e2a\u7279\u5b9a\u4eba\u7684\u4f4e\u8bed\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u8981\u4e3a\u4e00\u4f4d\u6f14\u8bb2\u8005\u51c6\u5907\u4ed6\u4e0b\u4e00\u9875PPT\u8981\u7528\u7684\u8d44\u6599\u3002\u4e00\u4e2a\u7b28\u529e\u6cd5\u662f\u628a\u4ed6\u7ffb\u8fc7\u7684\u6bcf\u4e00\u9875\u4e66\u3001\u770b\u8fc7\u7684\u6bcf\u4e00\u4e2a\u7f51\u9875\u90fd\u8bb0\u4e0b\u6765\uff0c\u7136\u540e\u4e0b\u6b21\u7167\u505a\u4e00\u904d\u3002\u4f46\u5176\u5b9e\uff0c\u4ed6\u5927\u90e8\u5206\u65f6\u95f4\u90fd\u5728\u770b\u81ea\u5df1\u5df2\u7ecf\u80cc\u719f\u7684\u8bb2\u7a3f\uff08\u76f8\u5f53\u4e8eL1/L2\u7f13\u5b58\u547d\u4e2d\u7684\u6570\u636e\uff09\uff0c\u771f\u6b63\u9700\u8981\u4f60\u63d0\u524d\u51c6\u5907\u7684\uff0c\u662f\u4ed6\u5076\u5c14\u624d\u4f1a\u53bb\u67e5\u8bc1\u7684\u51e0\u4efd\u5916\u90e8\u53c2\u8003\u8d44\u6599\uff08\u76f8\u5f53\u4e8eL2\u7f13\u5b58\u672a\u547d\u4e2d\u7684\u6570\u636e\uff09\u3002 - RnR\u7684\u505a\u6cd5\u5f88\u806a\u660e\uff1a\u5b83\u53ea\u5728\u6f14\u8bb2\u8005\u7b2c\u4e00\u6b21\u4f38\u624b\u53bb\u62ff\u573a\u5916\u8d44\u6599\uff08L2 Miss\uff09\u7684\u65f6\u5019\u624d\u5f00\u59cb\u8bb0\u5f55\u3002\u8fd9\u6837\uff0c\u4f60\u7684\u5907\u5fd8\u5f55\u5c31\u975e\u5e38\u7cbe\u7b80\u3001\u7cbe\u51c6\uff0c\u5168\u662f\u5e72\u8d27\uff0c\u4e0b\u6b21\u91cd\u6f14\u65f6\u6548\u7387\u6781\u9ad8\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u5e76\u6ca1\u6709\u5c1d\u8bd5\u53bb\u8bb0\u5f55\u548c\u5206\u6790\u6574\u4e2a\u7a0b\u5e8f\u7684\u5b8c\u6574\u5185\u5b58\u8bbf\u95ee\u5e8f\u5217\uff0c\u800c\u662f\u5de7\u5999\u5730\u5c06\u89c2\u5bdf\u70b9\u4e0b\u6c89\u5230\u4e86\u79c1\u6709L2\u7f13\u5b58\u8fd9\u4e00\u5c42\u3002 - \u5177\u4f53\u66ff\u6362\u903b\u8f91\u5982\u4e0b\uff1a     - \u65e7\u6d41\u7a0b\uff1a\u76d1\u63a7\u6240\u6709\u5185\u5b58\u8bf7\u6c42 -&gt; \u5c1d\u8bd5\u4ece\u4e2d\u627e\u51fa\u901a\u7528\u6a21\u5f0f -&gt; \u9884\u53d6\u3002     - \u65b0\u6d41\u7a0b\uff1a\u76d1\u63a7\u6240\u6709\u5185\u5b58\u8bf7\u6c42 -&gt; \u5148\u8ba9L1/L2\u7f13\u5b58\u8fc7\u6ee4\u4e00\u904d -&gt; \u53ea\u8bb0\u5f55\u90a3\u4e9b\u8fdeL2\u90fd\u6ca1\u80fd\u62e6\u4f4f\u7684\u201c\u6f0f\u7f51\u4e4b\u9c7c\u201d\uff08L2 Misses\uff09 -&gt; \u9488\u5bf9\u8fd9\u4e9b\u201c\u786c\u9aa8\u5934\u201d\u8fdb\u884c\u8bb0\u5f55\u548c\u91cd\u653e\u9884\u53d6\u3002 - \u8fd9\u4e2a\u8bbe\u8ba1\u4e00\u4e3e\u4e24\u5f97\uff1a     - \u8fc7\u6ee4\u566a\u58f0\uff1a\u5229\u7528\u73b0\u6709\u7684\u7f13\u5b58\u5c42\u6b21\u7ed3\u6784\uff0c\u81ea\u52a8\u6ee4\u9664\u4e86\u5177\u6709\u826f\u597d\u65f6\u7a7a\u5c40\u90e8\u6027\u7684\u8bbf\u95ee\uff0c\u4f7f\u5f97\u8bb0\u5f55\u4e0b\u6765\u7684\u5e8f\u5217\u7eaf\u7cb9\u662f\u90a3\u4e9b\u771f\u6b63\u4e0d\u89c4\u5219\u3001\u96be\u4ee5\u9884\u6d4b\u7684\u8bbf\u95ee\u6a21\u5f0f\u3002     - \u805a\u7126\u75db\u70b9\uff1a\u9884\u53d6\u5668\u7684\u7cbe\u529b\u548c\u5b58\u50a8\u8d44\u6e90\u5168\u90e8\u96c6\u4e2d\u5728\u6700\u9700\u8981\u5e2e\u52a9\u7684\u5730\u65b9\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u8bba\u6587\u4e2d\u63d0\u5230\u7684\u8d85\u8fc795%\u7684\u9884\u53d6\u51c6\u786e\u7387\u548c\u7f3a\u5931\u8986\u76d6\u7387\u3002</p> <p></p> <p>Fig. 7. L2 MPKI.</p> <p>\u8fd9\u5f20\u56fe\u6e05\u6670\u5730\u5c55\u793a\u4e86RnR\u5982\u4f55\u5927\u5e45\u964d\u4f4eL2\u7684MPKI\uff08\u6bcf\u5343\u6761\u6307\u4ee4\u7f3a\u5931\u6570\uff09\uff0c\u5176\u6548\u679c\u8fdc\u8d85\u5176\u4ed6\u9884\u53d6\u5668\u3002</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/ELI5_notes/#5-eli5","title":"5. \u4e0e\u73b0\u6709\u9884\u53d6\u5668\u7684\u96c6\u6210\u8bbe\u8ba1 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982\u6d41\u5f0f\u3001\u6b65\u957f\u9884\u53d6\u5668\uff09\u5728\u5904\u7406\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u65f6\u975e\u5e38\u9ad8\u6548\uff0c\u4f46\u9762\u5bf9\u4e0d\u89c4\u5219\u3001\u91cd\u590d\u7684\u8bbf\u95ee\u6a21\u5f0f\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u77e9\u9635\u8fd0\u7b97\uff09\u65f6\uff0c\u8981\u4e48\u5b8c\u5168\u5931\u6548\uff0c\u8981\u4e48\u51c6\u786e\u7387\u6781\u4f4e\u3002 - \u5982\u679c\u5f3a\u884c\u8ba9\u4e00\u4e2a\u901a\u7528\u9884\u53d6\u5668\u53bb\u5904\u7406\u6240\u6709\u7c7b\u578b\u7684\u8bbf\u95ee\uff0c\u5b83\u4f1a\u5728\u4e0d\u89c4\u5219\u6570\u636e\u4e0a\u4ea7\u751f\u5927\u91cf\u65e0\u7528\u9884\u53d6 (useless prefetches)\uff0c\u4e0d\u4ec5\u6d6a\u8d39\u5e26\u5bbd\uff0c\u8fd8\u4f1a\u6c61\u67d3\u7f13\u5b58\uff0c\u53cd\u800c\u62d6\u6162\u6027\u80fd\u3002 - \u53cd\u4e4b\uff0c\u5982\u679c\u53ea\u7528 RnR \u8fd9\u79cd\u9488\u5bf9\u4e0d\u89c4\u5219\u6a21\u5f0f\u7684\u4e13\u7528\u9884\u53d6\u5668\uff0c\u53c8\u4f1a\u9519\u8fc7\u5bf9\u89c4\u5219\u6570\u636e\u8fdb\u884c\u9ad8\u6548\u9884\u53d6\u7684\u673a\u4f1a\uff0c\u987e\u6b64\u5931\u5f7c\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u8fd9\u5c31\u50cf\u4e00\u4e2a\u9ad8\u6548\u7684\u5de5\u5382\u6d41\u6c34\u7ebf\u3002\u5bf9\u4e8e\u6807\u51c6\u5316\u7684\u96f6\u4ef6\uff08\u89c4\u5219\u8bbf\u95ee\uff09\uff0c\u6211\u4eec\u6709\u4e13\u95e8\u7684\u3001\u9ad8\u901f\u7684\u81ea\u52a8\u5316\u673a\u68b0\u81c2\uff08\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\uff09\u6765\u5904\u7406\uff0c\u53c8\u5feb\u53c8\u51c6\u3002 - \u4f46\u5bf9\u4e8e\u4e00\u4e9b\u5f62\u72b6\u5947\u7279\u3001\u9700\u8981\u624b\u5de5\u7cbe\u96d5\u7ec6\u7422\u7684\u5b9a\u5236\u4ef6\uff08\u4e0d\u89c4\u5219\u8bbf\u95ee\uff09\uff0c\u81ea\u52a8\u5316\u673a\u68b0\u81c2\u5c31\u675f\u624b\u65e0\u7b56\u4e86\u3002\u8fd9\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4f4d\u7ecf\u9a8c\u4e30\u5bcc\u7684\u8001\u5e08\u5085\uff08RnR \u9884\u53d6\u5668\uff09\uff0c\u4ed6\u5148\u770b\u4e00\u904d\u56fe\u7eb8\uff08Record\uff09\uff0c\u8bb0\u4f4f\u6bcf\u4e00\u4e2a\u6b65\u9aa4\uff0c\u7136\u540e\u5728\u540e\u7eed\u6279\u91cf\u751f\u4ea7\u65f6\uff08Replay\uff09\uff0c\u5c31\u80fd\u5b8c\u7f8e\u590d\u73b0\u3002 - \u6700\u806a\u660e\u7684\u505a\u6cd5\u4e0d\u662f\u8ba9\u8001\u5e08\u5085\u53bb\u5e72\u6240\u6709\u6d3b\uff0c\u4e5f\u4e0d\u662f\u8ba9\u673a\u68b0\u81c2\u53bb\u78b0\u5b9a\u5236\u4ef6\uff0c\u800c\u662f\u660e\u786e\u5206\u5de5\uff1a\u5728\u6d41\u6c34\u7ebf\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u5206\u62e3\u5668\uff0c\u628a\u6807\u51c6\u4ef6\u548c\u5b9a\u5236\u4ef6\u5206\u5f00\uff0c\u5404\u81ea\u4ea4\u7ed9\u6700\u64c5\u957f\u7684\u4eba/\u673a\u5668\u53bb\u5904\u7406\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") \u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u7528 RnR \u66ff\u4ee3\u6240\u6709\u9884\u53d6\u5668\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728\u7cfb\u7edf\u4e2d\u5f15\u5165\u4e86\u4e00\u4e2a\u57fa\u4e8e\u5730\u5740\u8303\u56f4\u7684\u8fc7\u6ee4\u673a\u5236\uff0c\u5b9e\u73b0\u4e86\u65e0\u7f1d\u534f\u540c\uff1a - \u7b2c\u4e00\u6b65\uff1a\u5212\u5b9a\u201c\u8d23\u4efb\u7530\u201d\u3002\u7a0b\u5e8f\u5458\u901a\u8fc7\u8f7b\u91cf\u7ea7\u63a5\u53e3\uff0c\u660e\u786e\u544a\u8bc9\u786c\u4ef6\uff1a\u201c\u4ece\u5730\u5740 A \u5230 B \u7684\u8fd9\u7247\u5185\u5b58\u533a\u57df\uff0c\u5b58\u653e\u7684\u662f\u4e0d\u89c4\u5219\u8bbf\u95ee\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8bf7\u4ea4\u7ed9 RnR \u5904\u7406\u3002\u201d - \u7b2c\u4e8c\u6b65\uff1a\u667a\u80fd\u5206\u6d41\u3002\u5728 CPU \u53d1\u51fa\u5185\u5b58\u8bf7\u6c42\u65f6\uff0c\u786c\u4ef6\u4f1a\u5148\u68c0\u67e5\u8fd9\u4e2a\u8bf7\u6c42\u7684\u5730\u5740\u662f\u5426\u843d\u5728 RnR \u7684\u201c\u8d23\u4efb\u7530\u201d\u5185\u3002   - \u5982\u679c\u5728\u8303\u56f4\u5185\uff0c\u5219\u8be5\u8bf7\u6c42\u53ca\u5176\u540e\u7eed\u7684\u7f3a\u5931\uff08miss\uff09\u7531 RnR \u8d1f\u8d23\u8bb0\u5f55\u548c\u91cd\u653e\u9884\u53d6\u3002   - \u5982\u679c\u4e0d\u5728\u8303\u56f4\u5185\uff0c\u5219\u8be5\u8bf7\u6c42\u88ab\u5b8c\u5168\u6392\u9664\u5728 RnR \u7684\u903b\u8f91\u4e4b\u5916\uff0c\u53ef\u4ee5\u81ea\u7531\u5730\u88ab\u73b0\u6709\u7684\u6d41\u5f0f\u9884\u53d6\u5668 (Next-line) \u6216\u5176\u4ed6\u901a\u7528\u9884\u53d6\u5668\u6355\u83b7\u548c\u5904\u7406\u3002 - \u7b2c\u4e09\u6b65\uff1a\u5e76\u884c\u4e0d\u6096\u3002\u901a\u8fc7\u8fd9\u79cd\u8bbe\u8ba1\uff0cRnR \u548c\u4f20\u7edf\u9884\u53d6\u5668\u53ef\u4ee5\u540c\u65f6\u5de5\u4f5c\uff0c\u4e92\u4e0d\u5e72\u6270\u3002RnR \u4e13\u6ce8\u4e8e\u89e3\u51b3\u6700\u96be\u5543\u7684\u786c\u9aa8\u5934\uff08\u4e0d\u89c4\u5219\u8bbf\u95ee\uff09\uff0c\u800c\u4f20\u7edf\u9884\u53d6\u5668\u5219\u7ee7\u7eed\u9ad8\u6548\u5730\u5904\u7406\u5b83\u4eec\u64c5\u957f\u7684\u5e38\u89c4\u4efb\u52a1\u3002</p> <p></p> <p>Fig. 4. RnR system architecture.</p> <p>\u8fd9\u79cd\u96c6\u6210\u65b9\u5f0f\u7684\u5173\u952e\u4f18\u52bf\u5728\u4e8e\u5176\u6781\u4f4e\u7684\u4fb5\u5165\u6027\u548c\u6781\u9ad8\u7684\u6548\u7387\u3002\u5b83\u4e0d\u9700\u8981\u4fee\u6539\u73b0\u6709\u9884\u53d6\u5668\u7684\u4efb\u4f55\u903b\u8f91\uff0c\u53ea\u662f\u589e\u52a0\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u5730\u5740\u8fc7\u6ee4\u5c42\uff0c\u5c31\u5b9e\u73b0\u4e86\u201c\u4e13\u4e1a\u7684\u4e8b\u4ea4\u7ed9\u4e13\u4e1a\u7684\u4eba\u505a\u201d\u7684\u6548\u679c\uff0c\u4ece\u800c\u5728\u6574\u4f53\u4e0a\u6700\u5927\u5316\u4e86\u9884\u53d6\u7cfb\u7edf\u7684\u6027\u80fd\u548c\u8d44\u6e90\u5229\u7528\u7387\u3002</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/","title":"RnR: A Software-Assisted Record-and-Replay Hardware Prefetcher \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-1-prefetcher-coverage-and-accuracy-of-pagerank-48-on-amazon-graph-32","title":"Fig. 1. Prefetcher coverage and accuracy of PageRank [48] on amazon graph [32].","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a\u201cFig. 1. Prefetcher coverage and accuracy of PageRank [48] on amazon graph [32]\u201d\uff0c\u5c55\u793a\u7684\u662f\u5728\u4e9a\u9a6c\u900a\u56fe\u6570\u636e\u96c6\u4e0a\u8fd0\u884cPageRank\u7b97\u6cd5\u65f6\uff0c\u4e0d\u540c\u9884\u53d6\u5668\u7684Miss Coverage\uff08\u7f3a\u5931\u8986\u76d6\u7387\uff09\u4e0ePrefetching Accuracy\uff08\u9884\u53d6\u51c6\u786e\u7387\uff09\u7684\u5bf9\u6bd4\u3002</li> <li>\u6a2a\u8f74\u8868\u793aPrefetching Accuracy\uff0c\u8303\u56f4\u4ece0%\u5230100%\uff1b\u7eb5\u8f74\u8868\u793aMiss Coverage\uff0c\u8303\u56f4\u540c\u6837\u4e3a0%\u5230100%\u3002\u7406\u60f3\u70b9\u4f4d\u4e8e\u53f3\u4e0a\u89d2\uff08100%, 100%\uff09\uff0c\u4ee3\u8868\u5b8c\u7f8e\u9884\u53d6\u5668\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u4e94\u4e2a\u9884\u53d6\u5668\u7684\u6570\u636e\u70b9\uff0c\u5206\u522b\u7528\u4e0d\u540c\u6807\u8bb0\u8868\u793a\uff1a</li> <li>Next-line [50]\uff1a\u4f4d\u4e8e\u5de6\u4e0b\u89d2\uff0c\u51c6\u786e\u7387\u7ea610%\uff0c\u8986\u76d6\u7387\u7ea65%\uff0c\u8868\u73b0\u6700\u5dee\u3002</li> <li>Bingo [9]\uff1a\u51c6\u786e\u7387\u7ea620%\uff0c\u8986\u76d6\u7387\u7ea615%\uff0c\u7565\u4f18\u4e8eNext-line\u3002</li> <li>SteMS [52]\uff1a\u51c6\u786e\u7387\u7ea630%\uff0c\u8986\u76d6\u7387\u7ea625%\uff0c\u6027\u80fd\u4e2d\u7b49\u3002</li> <li>MISB [59]\uff1a\u51c6\u786e\u7387\u7ea665%\uff0c\u8986\u76d6\u7387\u7ea640%\uff0c\u8868\u73b0\u8f83\u597d\u3002</li> <li>DROPLET [10]\uff1a\u51c6\u786e\u7387\u7ea670%\uff0c\u8986\u76d6\u7387\u7ea660%\uff0c\u662f\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u4e2d\u7684\u4f7c\u4f7c\u8005\u3002</li> <li>RnR\uff1a\u4ee5\u7ea2\u8272\u661f\u53f7\u6807\u6ce8\uff0c\u4f4d\u4e8e\u53f3\u4e0a\u89d2\uff0c\u51c6\u786e\u7387\u63a5\u8fd1100%\uff0c\u8986\u76d6\u7387\u4e5f\u63a5\u8fd1100%\uff0c\u663e\u8457\u4f18\u4e8e\u6240\u6709\u5176\u4ed6\u9884\u53d6\u5668\u3002</li> </ul> \u9884\u53d6\u5668 Prefetching Accuracy Miss Coverage Next-line [50] ~10% ~5% Bingo [9] ~20% ~15% SteMS [52] ~30% ~25% MISB [59] ~65% ~40% DROPLET [10] ~70% ~60% RnR ~100% ~100% <ul> <li>RnR\u9884\u53d6\u5668\u5728\u8be5\u573a\u666f\u4e0b\u5b9e\u73b0\u4e86\u8fd1\u4e4e\u5b8c\u7f8e\u7684\u9884\u53d6\u6548\u679c\uff0c\u8868\u660e\u5176\u8f6f\u4ef6\u8f85\u52a9\u8bb0\u5f55\u4e0e\u91cd\u653e\u673a\u5236\u80fd\u6709\u6548\u6355\u6349\u5e76\u5229\u7528PageRank\u7b97\u6cd5\u4e2d\u91cd\u590d\u7684\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4ece\u800c\u5927\u5e45\u8d85\u8d8a\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u9a8c\u8bc1\u4e86\u8bba\u6587\u6838\u5fc3\u4e3b\u5f20\uff1a\u5bf9\u4e8e\u5177\u6709\u957f\u5468\u671f\u91cd\u590d\u8bbf\u95ee\u6a21\u5f0f\u7684\u5e94\u7528\uff0cRnR\u80fd\u901a\u8fc7\u7a0b\u5e8f\u5458\u6307\u5bfc\u5b9e\u73b0\u9ad8\u7cbe\u5ea6\u3001\u9ad8\u8986\u76d6\u7387\u7684\u9884\u53d6\uff0c\u89e3\u51b3\u73b0\u6709\u9884\u53d6\u5668\u5728\u4e0d\u89c4\u5219\u8bbf\u95ee\u573a\u666f\u4e0b\u7684\u5931\u6548\u95ee\u9898\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-2-motivation-and-key-idea-of-the-rnr-prefetcher","title":"Fig. 2. Motivation and key idea of the RnR prefetcher.","text":"<ul> <li> <p>\u56fe 2 \u5c55\u793a\u4e86 RnR prefetcher \u7684\u52a8\u673a\u4e0e\u6838\u5fc3\u8bbe\u8ba1\u601d\u60f3\uff0c\u5206\u4e3a\u56db\u4e2a\u5b50\u56fe\uff1a(a) \u91cd\u590d\u6027\u4e0d\u89c4\u5219\u65f6\u7a7a\u6a21\u5f0f\uff0c(b) \u4e0d\u540c\u8bb0\u5f55\u4e0e\u91cd\u653e\u65b9\u6848\u5bf9\u6bd4\uff0c(c) RnR prefetcher \u6838\u5fc3\u7406\u5ff5\uff0c(d) RnR \u65f6\u5e8f\u63a7\u5236\u5e26\u6765\u7684\u6027\u80fd\u6536\u76ca\u3002</p> </li> <li> <p>\u5b50\u56fe (a) \u63cf\u8ff0\u4e86\u5728 SpMV \u548c PageRank \u7b49\u8fed\u4ee3\u7b97\u6cd5\u4e2d\uff0c\u5185\u5b58\u8bbf\u95ee\u5448\u73b0\u91cd\u590d\u6027\u4e0d\u89c4\u5219\u65f6\u7a7a\u6a21\u5f0f\u3002\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u540c\u7a7a\u95f4\u533a\u57df\uff08\u5982 Matrix/Edge \u4e0e Vector/pr_curr\uff09\u4ea7\u751f\u4e0d\u540c\u7684\u8bbf\u95ee\u5e8f\u5217\uff0c\u8fd9\u4e9b\u5e8f\u5217\u5728\u6bcf\u4e2a\u8fed\u4ee3\u5468\u671f\uff08Temporal Region\uff09\u5185\u91cd\u590d\u51fa\u73b0\u3002\u4f8b\u5982\uff0cMatrix \u8bbf\u95ee\u662f\u6d41\u5f0f\uff08s1\uff09\uff0c\u800c Vector \u8bbf\u95ee\u662f\u4e0d\u89c4\u5219\u7684\uff08s2\uff09\uff0c\u4e24\u8005\u6df7\u5408\u53d1\u751f\uff0c\u5bfc\u81f4\u4f20\u7edf\u9884\u53d6\u5668\u96be\u4ee5\u533a\u5206\u548c\u9884\u6d4b\u3002</p> </li> <li> <p>\u5b50\u56fe (b) \u5bf9\u6bd4\u4e86\u4e09\u79cd\u9884\u53d6\u673a\u5236\uff1a</p> </li> <li>GHB Based Temporal Prefetcher\uff1a\u57fa\u4e8e\u5168\u5c40\u5386\u53f2\u7f13\u51b2\u533a\uff0c\u4ec5\u7528\u5730\u5740\u7d22\u5f15\uff0c\u65e0\u6cd5\u533a\u5206\u76f8\u4f3c\u6a21\u5f0f\uff08\u5982\u5730\u57409\u540e\u63a512\u621620\uff09\uff0c\u6613\u8bef\u9884\u6d4b\u3002</li> <li>ISB with PC Localization\uff1a\u5f15\u5165\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\u8f85\u52a9\u533a\u5206\uff0c\u4f46\u4ecd\u4f9d\u8d56\u5171\u4eab\u8868\uff0c\u5bf9\u957f\u5e8f\u5217\u548c\u6df7\u5408\u6a21\u5f0f\u6548\u679c\u6709\u9650\u3002</li> <li> <p>RnR with a Light Software Interface\uff1a\u7531\u8f6f\u4ef6\u5b9a\u4e49\u65f6\u7a7a\u533a\u57df\uff0c\u5728\u9996\u6b21\u8fed\u4ee3\u8bb0\u5f55 miss \u5e8f\u5217\u53ca\u65f6\u95f4\u6233\uff0c\u540e\u7eed\u8fed\u4ee3\u6309\u7cbe\u786e\u65f6\u5e8f\u91cd\u653e\uff0c\u5b9e\u73b0\u9ad8\u7cbe\u5ea6\u4e0e\u53ca\u65f6\u6027\u3002</p> </li> <li> <p>\u5b50\u56fe (c) \u9610\u660e RnR \u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a</p> </li> <li>\u9996\u6b21\u8fed\u4ee3\uff08iter=1\uff09\uff1a\u53d1\u751f cache miss \u65f6\uff0cRnR \u8bb0\u5f55 miss \u5730\u5740\u5e8f\u5217\uff08\u5982 Blk9, Blk20, Blk1\uff09\u53ca\u5143\u6570\u636e\uff08timing info\uff09\uff0c\u5b58\u50a8\u4e8e\u5185\u5b58\u3002</li> <li> <p>\u540e\u7eed\u8fed\u4ee3\uff08iter&gt;1\uff09\uff1aRnR \u5728\u76f8\u540c\u65f6\u7a7a\u533a\u57df\u89e6\u53d1\u91cd\u653e\uff0c\u6839\u636e\u8bb0\u5f55\u7684 timing \u63a7\u5236\u9884\u53d6\u8282\u594f\uff0c\u5c06\u6570\u636e\u63d0\u524d\u8f7d\u5165 private cache\uff0c\u907f\u514d miss\u3002</p> </li> <li> <p>\u5b50\u56fe (d) \u5f3a\u8c03\u65f6\u5e8f\u63a7\u5236\u7684\u91cd\u8981\u6027\uff1a</p> </li> <li>\u82e5\u65e0\u63a7\u5236\uff08Late/Eearly\uff09\uff0c\u9884\u53d6\u8fc7\u65e9\u6216\u8fc7\u665a\u4f1a\u5bfc\u81f4\u6570\u636e\u88ab\u9a71\u9010\u6216\u9519\u8fc7\u4f7f\u7528\u65f6\u673a\uff0c\u65e0\u6cd5\u63d0\u5347\u6027\u80fd\u3002</li> <li> <p>RnR \u901a\u8fc7 window-based timing control\uff0c\u786e\u4fdd\u9884\u53d6\u5757\u5728\u9700\u6c42\u524d\u201c\u6070\u5230\u597d\u5904\u201d\u5230\u8fbe L2 cache\uff0c\u5b9e\u73b0 Timely Prefetch\uff0c\u663e\u8457\u63d0\u5347\u6027\u80fd\u3002</p> </li> <li> <p>\u5173\u952e\u672f\u8bed\u4fdd\u7559\uff1aLLC\u3001GHB\u3001ISB\u3001PC\u3001Temporal Region\u3001Spatial Region\u3001Private Cache\u3001Metadata\u3001Replay\u3001Record\u3002</p> </li> <li> <p>\u6027\u80fd\u5bf9\u6bd4\u793a\u610f\uff1a</p> </li> </ul> \u9884\u53d6\u673a\u5236 \u7cbe\u5ea6 \u8986\u76d6\u7387 \u65f6\u5e8f\u63a7\u5236 \u9002\u7528\u573a\u666f GHB \u4f4e \u4e2d \u65e0 \u5e38\u89c4\u6a21\u5f0f ISB \u4e2d \u4e2d \u5f31 PC\u5c40\u90e8\u5316 RnR \u9ad8 \u9ad8 \u5f3a \u91cd\u590d\u4e0d\u89c4\u5219\u6a21\u5f0f <ul> <li>RnR \u7684\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u8f6f\u4ef6\u5f15\u5bfc\u786c\u4ef6\uff0c\u5229\u7528\u7a0b\u5e8f\u5458\u5bf9\u5e94\u7528\u7ed3\u6784\u548c\u8fed\u4ee3\u884c\u4e3a\u7684\u5148\u9a8c\u77e5\u8bc6\uff0c\u5b9e\u73b0\u7cbe\u51c6\u8bb0\u5f55\u4e0e\u91cd\u653e\uff0c\u4ece\u800c\u89e3\u51b3\u4f20\u7edf\u9884\u53d6\u5668\u5728\u4e0d\u89c4\u5219\u3001\u957f\u5e8f\u5217\u3001\u6df7\u5408\u6a21\u5f0f\u4e0b\u7684\u5931\u6548\u95ee\u9898\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-3-state-transition-diagram-of-the-rnr-prefetch-state","title":"Fig. 3. State transition diagram of the RnR prefetch state.","text":"<ul> <li>\u56fe\u7247 a411c9bb16467f008f25fdaefd04d87326c1286fa05a084065b20d3d18802c22.jpg \u5c55\u793a\u7684\u662f RnR prefetcher \u7684\u72b6\u6001\u8f6c\u6362\u56fe\uff0c\u5373 Fig. 3\u3002</li> <li>\u8be5\u56fe\u63cf\u7ed8\u4e86 RnR \u9884\u53d6\u5668\u5728\u56db\u4e2a\u6838\u5fc3\u72b6\u6001\u4e4b\u95f4\u7684\u8f6c\u6362\u903b\u8f91\uff1aIdle\u3001Record\u3001Replay \u548c Pause\u3002</li> <li>\u72b6\u6001\u8f6c\u6362\u7531\u8f6f\u4ef6\u8c03\u7528\u7684\u7279\u5b9a\u51fd\u6570\u89e6\u53d1\uff0c\u8fd9\u4e9b\u51fd\u6570\u662f RnR \u7f16\u7a0b\u63a5\u53e3\u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u63a7\u5236\u9884\u53d6\u884c\u4e3a\u3002</li> </ul> \u8f6c\u6362\u7f16\u53f7 \u89e6\u53d1\u51fd\u6570 \u6e90\u72b6\u6001 \u76ee\u6807\u72b6\u6001 \u63cf\u8ff0 \u2460 <code>PrefetchState.start()</code> Idle Record \u542f\u52a8\u8bb0\u5f55\u6a21\u5f0f\uff0c\u5f00\u59cb\u6355\u83b7\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684 L2 \u7f13\u5b58\u7f3a\u5931\u5e8f\u5217\u3002 \u2461 <code>PrefetchState.replay()</code> Record Replay \u7ed3\u675f\u8bb0\u5f55\uff0c\u5f00\u59cb\u56de\u653e\u5df2\u8bb0\u5f55\u7684\u7f3a\u5931\u5e8f\u5217\u4ee5\u8fdb\u884c\u9884\u53d6\u3002 \u2462 <code>PrefetchState.replay()</code> Replay Replay \u5728\u56de\u653e\u8fc7\u7a0b\u4e2d\uff0c\u5141\u8bb8\u91cd\u65b0\u8fdb\u5165\u56de\u653e\u72b6\u6001\uff08\u81ea\u5faa\u73af\uff09\uff0c\u53ef\u80fd\u7528\u4e8e\u91cd\u7f6e\u6216\u7eed\u64ad\u3002 \u2463 <code>PrefetchState.end()</code> Record Idle \u7ec8\u6b62\u8bb0\u5f55\u8fc7\u7a0b\u5e76\u8fd4\u56de\u7a7a\u95f2\u72b6\u6001\u3002 \u2464 <code>PrefetchState.pause()</code> Replay Pause \u6682\u505c\u5f53\u524d\u7684\u56de\u653e\u64cd\u4f5c\u3002 \u2465 <code>PrefetchState.resume()</code> Pause Replay \u4ece\u6682\u505c\u72b6\u6001\u6062\u590d\u56de\u653e\u64cd\u4f5c\u3002 \u2466 <code>PrefetchState.end()</code> Pause Idle \u7ec8\u6b62\u9884\u53d6\u5668\uff0c\u4ece\u6682\u505c\u72b6\u6001\u76f4\u63a5\u8fd4\u56de\u7a7a\u95f2\u3002 \u2467 <code>PrefetchState.pause()</code> Record Pause \u6682\u505c\u5f53\u524d\u7684\u8bb0\u5f55\u64cd\u4f5c\u3002 \u2468 <code>PrefetchState.resume()</code> Pause Record \u4ece\u6682\u505c\u72b6\u6001\u6062\u590d\u8bb0\u5f55\u64cd\u4f5c\u3002 <ul> <li>\u5173\u952e\u8bbe\u8ba1\u70b9\uff1a</li> <li>\u8f6f\u4ef6\u4e3b\u5bfc\u63a7\u5236\uff1a\u6240\u6709\u72b6\u6001\u8f6c\u6362\u5747\u7531\u8f6f\u4ef6\u663e\u5f0f\u8c03\u7528\u51fd\u6570\u89e6\u53d1\uff0c\u4f53\u73b0\u4e86\u201c\u8f6f\u4ef6\u8f85\u52a9\u201d\u7684\u6838\u5fc3\u601d\u60f3\u3002</li> <li>\u7075\u6d3b\u6027\uff1a\u652f\u6301\u5728 Record \u548c Replay \u72b6\u6001\u4e4b\u95f4\u6682\u505c (<code>pause</code>) \u548c\u6062\u590d (<code>resume</code>)\uff0c\u8fd9\u5bf9\u4e8e\u5904\u7406\u4e0a\u4e0b\u6587\u5207\u6362\u6216\u52a8\u6001\u8c03\u6574\u975e\u5e38\u5173\u952e\u3002</li> <li>\u751f\u547d\u5468\u671f\u7ba1\u7406\uff1a<code>start()</code> \u548c <code>end()</code> \u51fd\u6570\u5b9a\u4e49\u4e86\u9884\u53d6\u5668\u7684\u5b8c\u6574\u751f\u547d\u5468\u671f\uff0c\u786e\u4fdd\u8d44\u6e90\u53ef\u4ee5\u88ab\u6b63\u786e\u5206\u914d\u548c\u91ca\u653e\u3002</li> <li>\u72b6\u6001\u9694\u79bb\uff1aRecord \u548c Replay \u662f\u4e92\u65a5\u7684\u64cd\u4f5c\u9636\u6bb5\uff0c\u901a\u8fc7\u660e\u786e\u7684\u72b6\u6001\u8f6c\u6362\u4fdd\u8bc1\u4e86\u6570\u636e\u7684\u4e00\u81f4\u6027\u548c\u64cd\u4f5c\u7684\u539f\u5b50\u6027\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#table-i-rnr-function-calls","title":"TABLE I RNR FUNCTION CALLS.","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a TABLE I RNR FUNCTION CALLS\uff0c\u8be6\u7ec6\u5217\u51fa\u4e86 RnR prefetcher \u63d0\u4f9b\u7684\u7f16\u7a0b\u63a5\u53e3\u51fd\u6570\u53ca\u5176\u529f\u80fd\u8bf4\u660e\u3002</li> <li>\u8868\u683c\u5305\u542b\u4e24\u5217\uff1aFunction \u548c Explanation\uff0c\u6e05\u6670\u5b9a\u4e49\u4e86\u6bcf\u4e2a\u51fd\u6570\u8c03\u7528\u7684\u76ee\u7684\u548c\u884c\u4e3a\u3002</li> <li>\u6240\u6709\u51fd\u6570\u5747\u4ee5 RnR. \u4e3a\u524d\u7f00\uff0c\u8868\u660e\u5176\u5c5e\u4e8e Record-and-Replay (RnR) \u786c\u4ef6\u9884\u53d6\u5668\u7684\u8f6f\u4ef6\u63a7\u5236\u63a5\u53e3\u3002</li> <li>\u51fd\u6570\u6309\u529f\u80fd\u53ef\u5206\u4e3a\u521d\u59cb\u5316\u3001\u5730\u5740\u8fb9\u754c\u7ba1\u7406\u3001\u7a97\u53e3\u5927\u5c0f\u8bbe\u7f6e\u3001\u9884\u53d6\u72b6\u6001\u63a7\u5236\u548c\u8d44\u6e90\u91ca\u653e\u4e94\u5927\u7c7b\u3002</li> </ul> Function Explanation RnR.init() \u8bbe\u7f6e ASID \u7528\u4e8e\u6743\u9650\u68c0\u67e5\uff0c\u4e3a SequenceTable \u548c DivisionTable \u5206\u914d\u5185\u5b58\uff0c\u5e76\u8bbe\u7f6e\u9ed8\u8ba4\u7a97\u53e3\u5927\u5c0f\u3002 AddrBase.set(addr, size) \u6dfb\u52a0\u4e00\u4e2a\u57fa\u5730\u5740\u53ca\u5176\u5bf9\u5e94\u5927\u5c0f\uff0c\u7528\u4e8e\u5b9a\u4e49\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u5185\u5b58\u8303\u56f4\u3002 AddrBase.enable(addr) \u542f\u7528\u5bf9\u6307\u5b9a\u5730\u5740\u8303\u56f4\u7684\u8fb9\u754c\u68c0\u67e5\uff0c\u5141\u8bb8\u8bb0\u5f55\u6216\u91cd\u653e\u8be5\u533a\u57df\u7684\u8bbf\u95ee\u3002 AddrBase.disable(addr) \u7981\u7528\u5bf9\u6307\u5b9a\u5730\u5740\u8303\u56f4\u7684\u8fb9\u754c\u68c0\u67e5\uff0c\u505c\u6b62\u5bf9\u8be5\u533a\u57df\u7684\u8bb0\u5f55\u6216\u91cd\u653e\u3002 WindowSize.set(size) \u8bbe\u7f6e\u4e0d\u540c\u4e8e\u9ed8\u8ba4\u503c\u7684\u7a97\u53e3\u5927\u5c0f\uff0c\u7528\u4e8e\u63a7\u5236\u91cd\u653e\u9636\u6bb5\u7684\u9884\u53d6\u8282\u594f\u3002 PrefetchState.start() \u542f\u7528 RnR \u5e76\u5f00\u59cb\u8bb0\u5f55\u9996\u6b21\u51fa\u73b0\u7684\u7f13\u5b58\u7f3a\u5931\u5e8f\u5217\u3002 PrefetchState.replay() \u4ece\u5934\u5f00\u59cb\u91cd\u653e\u5df2\u8bb0\u5f55\u7684\u5e8f\u5217\uff0c\u542f\u52a8\u9884\u53d6\u64cd\u4f5c\u3002 PrefetchState.end() \u7981\u7528 RnR\uff0c\u505c\u6b62\u6240\u6709\u8bb0\u5f55\u548c\u91cd\u653e\u64cd\u4f5c\u3002 PrefetchState.pause() \u6682\u505c\u5f53\u524d\u7684\u91cd\u653e\u8fc7\u7a0b\uff0c\u5e38\u7528\u4e8e\u4e0a\u4e0b\u6587\u5207\u6362\u6216\u8fc1\u79fb\u573a\u666f\u3002 PrefetchState.resume() \u4ece\u6682\u505c\u72b6\u6001\u6062\u590d\u91cd\u653e\uff0c\u7ee7\u7eed\u6267\u884c\u672a\u5b8c\u6210\u7684\u9884\u53d6\u5e8f\u5217\u3002 RnR.end() \u91ca\u653e\u4e3a\u5143\u6570\u636e\u5206\u914d\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u6e05\u7406\u8d44\u6e90\u3002 <ul> <li>RnR.init() \u662f\u6574\u4e2a\u6d41\u7a0b\u7684\u8d77\u70b9\uff0c\u8d1f\u8d23\u521d\u59cb\u5316\u786c\u4ef6\u72b6\u6001\u548c\u5185\u5b58\u5206\u914d\uff0c\u662f\u540e\u7eed\u6240\u6709\u64cd\u4f5c\u7684\u524d\u63d0\u3002</li> <li>AddrBase.set(), enable(), disable() \u5141\u8bb8\u7a0b\u5e8f\u5458\u7cbe\u786e\u63a7\u5236\u54ea\u4e9b\u6570\u636e\u7ed3\u6784\u53c2\u4e0e\u8bb0\u5f55\u4e0e\u91cd\u653e\uff0c\u5b9e\u73b0\u7a7a\u95f4\u533a\u57df\u7684\u9694\u79bb\u3002</li> <li>WindowSize.set() \u63d0\u4f9b\u4e86\u5bf9\u9884\u53d6\u8282\u594f\u7684\u7ec6\u7c92\u5ea6\u63a7\u5236\uff0c\u662f\u5b9e\u73b0\u53ca\u65f6\u9884\u53d6\u7684\u5173\u952e\u673a\u5236\u3002</li> <li>PrefetchState.start(), replay(), end(), pause(), resume() \u6784\u6210\u4e86\u5b8c\u6574\u7684\u72b6\u6001\u673a\uff0c\u4f7f\u7a0b\u5e8f\u5458\u80fd\u7075\u6d3b\u63a7\u5236\u9884\u53d6\u5668\u5728\u4e0d\u540c\u9636\u6bb5\u7684\u884c\u4e3a\u3002</li> <li>RnR.end() \u8d1f\u8d23\u8d44\u6e90\u56de\u6536\uff0c\u786e\u4fdd\u7cfb\u7edf\u5728\u9884\u53d6\u4efb\u52a1\u7ed3\u675f\u540e\u80fd\u91ca\u653e\u5360\u7528\u7684\u5185\u5b58\uff0c\u907f\u514d\u5185\u5b58\u6cc4\u6f0f\u3002</li> <li>\u6574\u4f53\u8bbe\u8ba1\u4f53\u73b0\u4e86\u201c\u8f6f\u4ef6\u8f85\u52a9\u201d\u7684\u6838\u5fc3\u601d\u60f3\uff1a\u7a0b\u5e8f\u5458\u901a\u8fc7\u8fd9\u4e9b\u8f7b\u91cf\u7ea7\u63a5\u53e3\uff0c\u5c06\u5e94\u7528\u5c42\u9762\u7684\u77e5\u8bc6\uff08\u5982\u6570\u636e\u7ed3\u6784\u4f4d\u7f6e\u3001\u8fed\u4ee3\u8fb9\u754c\uff09\u4f20\u9012\u7ed9\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u4ece\u800c\u5927\u5e45\u63d0\u5347\u9884\u53d6\u7684\u51c6\u786e\u6027\u548c\u8986\u76d6\u7387\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-4-rnr-system-architecture","title":"Fig. 4. RnR system architecture.","text":"<ul> <li>\u8be5\u56fe\u5c55\u793a\u4e86 RnR prefetcher \u7684\u7cfb\u7edf\u67b6\u6784\uff0c\u5206\u4e3a Record \u548c Replay \u4e24\u4e2a\u6838\u5fc3\u9636\u6bb5\uff0c\u5e76\u901a\u8fc7\u8f6f\u4ef6\u63a5\u53e3\u4e0e\u786c\u4ef6\u534f\u540c\u5de5\u4f5c\u3002</li> <li>\u56fe\u4e2d\u4f7f\u7528\u4e0d\u540c\u989c\u8272\u7bad\u5934\u533a\u5206\u6570\u636e\u6d41\uff1a\u6a59\u8272\u4ee3\u8868\u8f6f\u4ef6\u63a7\u5236\u4fe1\u53f7\uff0c\u7ea2\u8272\u865a\u7ebf\u4ee3\u8868 Record \u9636\u6bb5\u7684\u6570\u636e\u8def\u5f84\uff0c\u84dd\u8272\u865a\u7ebf\u4ee3\u8868 Replay \u9636\u6bb5\u7684\u6570\u636e\u8def\u5f84\uff0c\u9ed1\u8272\u5b9e\u7ebf\u4ee3\u8868\u901a\u7528\u6216\u5171\u4eab\u8def\u5f84\u3002</li> <li>Record \u9636\u6bb5\uff08\u5de6\u4fa7\uff09\uff1a</li> <li>\u5f53\u5185\u5b58\u5305\u8bbf\u95ee\u547d\u4e2d\u9884\u8bbe\u5730\u5740\u8303\u56f4\u65f6\uff0c\u4f1a\u6807\u8bb0 <code>Packet Flag=1</code> \u5e76\u9012\u589e <code>Cur Struct Read</code> \u8ba1\u6570\u5668\u3002</li> <li>\u82e5\u53d1\u751f L2 miss \u4e14 <code>Packet Flag=1</code>\uff0c\u5219\u5c06\u8be5 miss \u5730\u5740\u5199\u5165 Seq Table Buffer\uff0c\u5e76\u66f4\u65b0\u957f\u5ea6\u3002</li> <li>\u6bcf\u5f53\u8bb0\u5f55\u7684 miss \u6570\u91cf\u8fbe\u5230 <code>Window Size</code>\uff0c\u5c06\u5f53\u524d <code>Cur Struct Read</code> \u503c\u5199\u5165 Div Table Buffer\uff0c\u7528\u4e8e\u540e\u7eed\u8282\u594f\u63a7\u5236\u3002</li> <li>\u5143\u6570\u636e\uff08Seq Table \u548c Div Table\uff09\u5728\u7f13\u51b2\u533a\u6ee1\u65f6\u6279\u91cf\u5199\u56de\u9884\u7559\u5185\u5b58\u7a7a\u95f4\uff0c\u901a\u8fc7 TLB \u67e5\u8be2\u7269\u7406\u5730\u5740\uff0c\u6bcf 4MB \u9875\u9762\u4ec5\u67e5\u4e00\u6b21\u4ee5\u51cf\u5c11\u5f00\u9500\u3002</li> <li>Replay \u9636\u6bb5\uff08\u53f3\u4fa7\uff09\uff1a</li> <li>\u7cfb\u7edf\u4ece\u9884\u7559\u5185\u5b58\u9884\u53d6 Seq Table \u548c Div Table \u5230\u672c\u5730\u7f13\u51b2\u533a\uff0c\u5b9e\u73b0\u53cc\u7f13\u51b2\u673a\u5236\u3002</li> <li>\u6839\u636e <code>Cur Struct Read</code> \u4e0e Div Table \u4e2d\u7a97\u53e3\u9608\u503c\u5bf9\u6bd4\uff0c\u52a8\u6001\u8c03\u6574 prefetch pace\uff0c\u786e\u4fdd prefetch \u4e0e\u7a0b\u5e8f\u6267\u884c\u8fdb\u5ea6\u540c\u6b65\u3002</li> <li>Prefetch \u8bf7\u6c42\u76f4\u63a5\u53d1\u9001\u81f3 L2 cache\uff0c\u907f\u514d\u6c61\u67d3 LLC\uff0c\u540c\u65f6\u6839\u636e <code>Prefetch Pace</code> \u63a7\u5236\u9891\u7387\uff0c\u51cf\u5c11\u4e0e\u9700\u6c42\u8bbf\u95ee\u7684\u7ade\u4e89\u3002</li> <li>\u8f6f\u4ef6\u63a5\u53e3\u90e8\u5206\uff08\u9876\u90e8\u4e2d\u592e\uff09\uff1a</li> <li>\u8f6f\u4ef6\u901a\u8fc7\u8bbe\u7f6e\u5bc4\u5b58\u5668\u63a7\u5236 RnR \u72b6\u6001\uff0c\u5305\u62ec <code>Prefetch State</code>\u3001<code>Window Size</code>\u3001<code>Base Addr</code>\u3001<code>Struct Len</code>\u3001<code>Enable/Disable</code> \u7b49\u3002</li> <li>ASID \u5bc4\u5b58\u5668\u7528\u4e8e\u6743\u9650\u68c0\u67e5\uff0c\u786e\u4fdd\u591a\u8fdb\u7a0b\u73af\u5883\u4e0b\u7684\u5b89\u5168\u9694\u79bb\u3002</li> <li>\u5173\u952e\u7ec4\u4ef6\u4ea4\u4e92\uff1a</li> <li>Cache Controller \u534f\u8c03 L1/L2/LLC \u4e0e RnR prefetcher \u7684\u6570\u636e\u6d41\u3002</li> <li>Stream Prefetcher \u5728 Record \u9636\u6bb5\u88ab\u7981\u7528\uff0c\u907f\u514d\u5e72\u6270\u76ee\u6807\u7ed3\u6784\u7684 miss \u8bb0\u5f55\u3002</li> <li>Reserved Memory Space \u5b58\u50a8\u5e8f\u5217\u548c\u5212\u5206\u8868\uff0c\u7531\u7a0b\u5e8f\u5458\u5206\u914d\uff0c\u652f\u6301\u8de8\u4e0a\u4e0b\u6587\u5207\u6362\u4fdd\u7559\u5143\u6570\u636e\u3002</li> <li>\u72b6\u6001\u673a\u4e0e\u63a7\u5236\u903b\u8f91\uff1a</li> <li>RnR \u5185\u90e8\u7ef4\u62a4\u591a\u4e2a\u8ba1\u6570\u5668\u548c\u6307\u9488\uff0c\u5982 <code>Cur Window</code>\u3001<code>Cur Seq Table Len</code>\u3001<code>Prefetch Pace</code>\uff0c\u786e\u4fdd replay \u65f6\u7cbe\u786e\u5339\u914d record \u65f6\u7684\u8bbf\u95ee\u8282\u594f\u3002</li> <li>\u652f\u6301\u6682\u505c\uff08Pause\uff09\u4e0e\u6062\u590d\uff08Resume\uff09\uff0c\u4fbf\u4e8e\u4e0a\u4e0b\u6587\u5207\u6362\u6216\u52a8\u6001\u8c03\u6574\u3002</li> </ul> \u9636\u6bb5 \u4e3b\u8981\u64cd\u4f5c \u5173\u952e\u63a7\u5236\u4fe1\u53f7 Record \u8bb0\u5f55 L2 miss \u5e8f\u5217\uff0c\u7edf\u8ba1\u6bcf\u7a97\u53e3\u8bbf\u95ee\u6b21\u6570 <code>Prefetch State=Record</code>, <code>Enable</code> Replay \u6839\u636e\u8bb0\u5f55\u5e8f\u5217\u548c\u8282\u594f\u4fe1\u606f\u53d1\u8d77 prefetch\uff0c\u5199\u5165 L2 cache <code>Prefetch State=Replay</code>, <code>Prefetch Pace</code> Software \u8bbe\u7f6e\u5730\u5740\u8303\u56f4\u3001\u7a97\u53e3\u5927\u5c0f\u3001\u542f\u7528/\u7981\u7528\u3001\u542f\u52a8/\u505c\u6b62 <code>ASID</code>, <code>Base Addr</code>, <code>Window Size</code> <ul> <li>\u6574\u4f53\u8bbe\u8ba1\u5f3a\u8c03 \u8f6f\u4ef6\u6307\u5bfc\u786c\u4ef6\uff0c\u5229\u7528\u7a0b\u5e8f\u5458\u5bf9\u5e94\u7528\u6a21\u5f0f\u7684\u8ba4\u77e5\uff0c\u5b9e\u73b0\u9ad8\u7cbe\u5ea6\u3001\u9ad8\u8986\u76d6\u7387\u3001\u53ca\u65f6\u6027\u7684 prefetch\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u5177\u6709\u91cd\u590d\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u7684\u5e94\u7528\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-5-prefetching-timing-control-example-with-window-size-3","title":"Fig. 5. Prefetching timing control example with window size = 3.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RnR prefetcher \u7684 replay timing control \u673a\u5236\uff0c\u4ee5\u7a97\u53e3\u5927\u5c0f\u4e3a 3 \u7684\u793a\u4f8b\u8bf4\u660e\u5982\u4f55\u901a\u8fc7\u8bb0\u5f55\u548c\u56de\u653e\u63a7\u5236\u9884\u53d6\u65f6\u673a\uff0c\u907f\u514d\u8fc7\u65e9\u6216\u8fc7\u665a\u9884\u53d6\u3002</li> <li>\u56fe\u4e2d\u5206\u4e3a\u56db\u4e2a\u5b50\u56fe\uff1a(a) Record\u3001(b) Replay without timing controls\u3001(c) Replay with window controls\u3001(d) Replay with window and pace controls\uff0c\u5206\u522b\u4ee3\u8868\u4e0d\u540c\u63a7\u5236\u7b56\u7565\u4e0b\u7684\u9884\u53d6\u884c\u4e3a\u3002</li> <li>\u5728 (a) Record \u9636\u6bb5\uff0c\u7cfb\u7edf\u5c06\u5185\u5b58\u8bbf\u95ee\u5e8f\u5217\u6309\u7a97\u53e3\u5212\u5206\uff08Window 1~4\uff09\uff0c\u6bcf\u4e2a\u7a97\u53e3\u5305\u542b 3 \u6b21\u7ed3\u6784\u8bbf\u95ee\uff08\u5982 1,2,3 \u5c5e\u4e8e Window 1\uff09\uff0c\u5e76\u8bb0\u5f55\u6bcf\u4e2a\u7a97\u53e3\u5185\u7684 miss \u6bd4\u7387\uff08\u4f8b\u5982 Window 1 \u6709 2 \u6b21 miss\uff0cmiss ratio = 50%\uff09\u3002</li> <li>(b) Replay without timing controls \u8868\u793a\u65e0\u63a7\u5236\u7684\u56de\u653e\uff1a\u9884\u53d6\u5668\u5728\u6bcf\u6b21\u9700\u6c42\u8bbf\u95ee\u540e\u7acb\u5373\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\uff0c\u5bfc\u81f4\u5927\u91cf\u6570\u636e\u5728\u672a\u88ab\u4f7f\u7528\u524d\u5c31\u88ab\u9a71\u9010\uff08early prefetch\uff09\uff0c\u9020\u6210\u7f13\u5b58\u6c61\u67d3\u3002</li> <li>(c) Replay with window controls \u5f15\u5165\u4e86\u57fa\u4e8e\u7a97\u53e3\u7684\u63a7\u5236\uff1a\u9884\u53d6\u5668\u5728\u5b8c\u6210\u5f53\u524d\u7a97\u53e3\u5185\u6240\u6709\u9700\u6c42\u8bbf\u95ee\u540e\u624d\u5f00\u59cb\u9884\u53d6\u4e0b\u4e00\u7a97\u53e3\u7684\u6570\u636e\uff08\u5982 Window 1 \u5b8c\u6210\u540e\u624d\u9884\u53d6 Window 2 \u7684 4,5,6\uff09\uff0c\u4ece\u800c\u786e\u4fdd\u9884\u53d6\u6570\u636e\u5728\u9700\u8981\u65f6\u4ecd\u5728\u7f13\u5b58\u4e2d\u3002</li> <li>(d) Replay with window and pace controls \u8fdb\u4e00\u6b65\u4f18\u5316\uff0c\u5728\u7a97\u53e3\u5185\u5747\u5300\u5206\u5e03\u9884\u53d6\u8bf7\u6c42\uff08\u5982 Window 1 \u4e2d\u6bcf 1.5 \u6b21\u8bbf\u95ee\u53d1\u4e00\u6b21\u9884\u53d6\uff09\uff0c\u51cf\u5c11\u4e0e\u9700\u6c42\u8bbf\u95ee\u7684\u51b2\u7a81\uff0c\u63d0\u5347\u7cfb\u7edf\u541e\u5410\u3002</li> <li>\u5173\u952e\u672f\u8bed\u4fdd\u7559\u82f1\u6587\uff1aRecord, Replay, window size, prefetch, hit, miss, pace control\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5404\u9636\u6bb5\u9884\u53d6\u884c\u4e3a\u5bf9\u6bd4\uff1a</li> </ul> \u9636\u6bb5 \u63a7\u5236\u65b9\u5f0f \u9884\u53d6\u65f6\u673a \u7f13\u5b58\u6548\u7387 \u8bf4\u660e (a) Record \u65e0 \u8bb0\u5f55 miss \u5e8f\u5217\u53ca\u7a97\u53e3\u5185\u8bbf\u95ee\u6b21\u6570 \u65e0 \u7528\u4e8e\u540e\u7eed replay \u7684\u5143\u6570\u636e\u91c7\u96c6 (b) Replay without timing controls \u65e0 \u6bcf\u6b21\u8bbf\u95ee\u540e\u7acb\u5373\u9884\u53d6 \u4f4e \u6570\u636e\u6613\u88ab\u63d0\u524d\u9a71\u9010\uff0c\u9020\u6210\u6d6a\u8d39 (c) Replay with window controls \u7a97\u53e3\u7ea7\u63a7\u5236 \u5f53\u524d\u7a97\u53e3\u5b8c\u6210\u540e\u9884\u53d6\u4e0b\u4e00\u7a97\u53e3 \u9ad8 \u5339\u914d\u7a0b\u5e8f\u6267\u884c\u8282\u594f\uff0c\u907f\u514d\u8fc7\u65e9\u9884\u53d6 (d) Replay with window and pace controls \u7a97\u53e3+\u6b65\u8c03\u63a7\u5236 \u7a97\u53e3\u5185\u5747\u5300\u5206\u5e03\u9884\u53d6 \u6700\u9ad8 \u51cf\u5c11\u4e89\u7528\uff0c\u63d0\u5347\u5e76\u53d1\u6548\u7387 <ul> <li>\u6838\u5fc3\u4f18\u52bf\uff1a\u901a\u8fc7\u8bb0\u5f55\u7a97\u53e3\u5185 miss ratio \u548c\u8bbf\u95ee\u9891\u7387\uff0cRnR \u80fd\u52a8\u6001\u8c03\u6574\u9884\u53d6\u8282\u594f\uff0c\u5b9e\u73b0\u201ctimely prefetching\u201d\uff0c\u663e\u8457\u63d0\u5347\u9884\u53d6\u547d\u4e2d\u7387\u548c\u7cfb\u7edf\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#table-iibaseline-configuration","title":"TABLE IIBASELINE CONFIGURATION.","text":"<ul> <li>\u8be5\u8868\u683c\u8be6\u7ec6\u5217\u51fa\u4e86\u8bba\u6587\u4e2d\u7528\u4e8e\u8bc4\u4f30 RnR \u9884\u53d6\u5668\u7684\u57fa\u7ebf\u7cfb\u7edf\u914d\u7f6e\uff0c\u6db5\u76d6\u4e86\u5904\u7406\u5668\u3001\u7f13\u5b58\u3001\u5185\u5b58\u63a7\u5236\u5668\u548c\u4e3b\u5b58\u7b49\u5173\u952e\u7ec4\u4ef6\u3002</li> <li>\u5904\u7406\u5668\u90e8\u5206\u6307\u660e\u4e86\u7cfb\u7edf\u91c7\u7528 4 \u6838\u5fc3\u67b6\u6784\uff0c\u8fd0\u884c\u9891\u7387\u4e3a 4 GHz\uff0c\u5177\u5907 4-wide Out-of-Order (OoO) \u6267\u884c\u80fd\u529b\uff0c\u5e76\u914d\u5907\u4e86 256-entry Reorder Buffer (ROB) \u548c 64-entry Load/Store Queue (LSQ)\u3002\u5206\u652f\u9884\u6d4b\u5668\u91c7\u7528\u4e86 16-entry perceptron \u5206\u652f\u9884\u6d4b\u5668\uff0c\u6307\u4ee4\u53d1\u5c04\u961f\u5217\u4e3a 16-entry\u3002</li> <li>L1 \u6570\u636e/\u6307\u4ee4\u7f13\u5b58 (L1-Ds/Is) \u4e3a\u6bcf\u4e2a\u6838\u5fc3\u79c1\u6709\uff0c\u5bb9\u91cf\u4e3a 64KB\uff0c\u91c7\u7528 8-way \u7ec4\u76f8\u8054\uff0c\u62e5\u6709 8-entry Miss Status Holding Register (MSHR)\uff0c\u8bbf\u95ee\u5ef6\u8fdf\u4e3a 4 \u4e2a\u5468\u671f\u3002</li> <li>L2 \u7f13\u5b58 (L2s) \u540c\u6837\u4e3a\u6bcf\u4e2a\u6838\u5fc3\u79c1\u6709\uff0c\u5bb9\u91cf\u6269\u5927\u81f3 256KB\uff0c\u4ecd\u4e3a 8-way \u7ec4\u76f8\u8054\uff0c\u914d\u5907 16-entry MSHR\uff0c\u8bbf\u95ee\u5ef6\u8fdf\u589e\u52a0\u5230 12 \u4e2a\u5468\u671f\u3002</li> <li>\u6700\u540e\u4e00\u7ea7\u7f13\u5b58 (LLC) \u4e3a\u6240\u6709\u6838\u5fc3\u5171\u4eab\uff0c\u5bb9\u91cf\u9ad8\u8fbe 8MB\uff0c\u91c7\u7528 16-way \u7ec4\u76f8\u8054\uff0c\u62e5\u6709 128-entry MSHR\uff0c\u8bbf\u95ee\u5ef6\u8fdf\u4e3a 42 \u4e2a\u5468\u671f\u3002</li> <li>\u5185\u5b58\u63a7\u5236\u5668\u91c7\u7528 FCFS (First-Come, First-Served) \u8c03\u5ea6\u7b56\u7565\uff0c\u8bfb\u961f\u5217\u5927\u5c0f\u4e3a 64\uff0c\u5199\u961f\u5217\u5927\u5c0f\u4e3a 32\u3002\u5199\u961f\u5217\u6392\u6c34\u7b56\u7565\u8bbe\u5b9a\u4e3a\uff1a\u5f53\u961f\u5217\u5360\u7528\u7387\u8fbe\u5230 75% \u65f6\u542f\u52a8\u9ad8\u4f18\u5148\u7ea7\u6392\u6c34\uff0c\u8fbe\u5230 25% \u65f6\u542f\u52a8\u4f4e\u4f18\u5148\u7ea7\u6392\u6c34\u3002</li> <li>\u4e3b\u5b58\u914d\u7f6e\u4e3a 4GB \u5bb9\u91cf\uff0c\u8fd0\u884c\u5728 2400 MHz \u9891\u7387\u4e0b\uff0c\u91c7\u7528 \u5355\u901a\u9053\u3001\u5355 Rank\u300116 \u4e2a Bank \u7684\u7ed3\u6784\u3002\u5173\u952e\u65f6\u5e8f\u53c2\u6570 tCL (CAS Latency)\u3001tRCD (RAS to CAS Delay) \u548c tRP (Row Precharge Time) \u5747\u8bbe\u5b9a\u4e3a 17 \u4e2a\u5468\u671f\u3002</li> </ul> \u7ec4\u4ef6 \u914d\u7f6e\u8be6\u60c5 Processors 4 cores, 4 GHz, 4-wide OoO, 256-entry ROB, 64-entry LSQ, 16-entry perceptron branch predictor [27], 16-entry issue queue L1-Ds/Is private, 64KB, 8-way, 8-entry MSHR, delay = 4 cycles L2s private, 256KB, 8-way, 16-entry MSHR, delay = 12 cycles LLC shared, 8 MB, 16-way, 128-entry MSHR, delay = 42 cycles Memory Controller FCFS, read queue size = 64, write queue size = 32, write queue draining: high/low threshold = 75%/25% Main Memory 4GB, 2400 MHz, 1 channel, 1 rank, 16 banks, tCL = tRCD = tRP = 17 cycles"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#table-iii-input-datasets","title":"TABLE III INPUT DATASETS.","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a\u8bba\u6587\u4e2d\u7684 Table III\uff0c\u6807\u9898\u4e3a INPUT DATASETS\uff0c\u7528\u4e8e\u5217\u51fa\u5b9e\u9a8c\u6240\u4f7f\u7528\u7684\u8f93\u5165\u6570\u636e\u96c6\u3002</li> <li>\u6570\u636e\u96c6\u5206\u4e3a\u4e24\u5927\u7c7b\uff1aGraph Input \u548c Sparse Matrix\uff0c\u5206\u522b\u5bf9\u5e94\u56fe\u7b97\u6cd5\u548c\u7a00\u758f\u77e9\u9635\u8ba1\u7b97\u7684\u57fa\u51c6\u6d4b\u8bd5\u3002</li> <li>Graph Input \u90e8\u5206\u5305\u542b\u56db\u4e2a\u6570\u636e\u96c6\uff0c\u5176\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b\uff1a</li> </ul> Names Edges Nodes Size Type amazon [32] 3.3M 0.4M 47.9MB purchase network com-orkut [32] 117M 3.1M 1.7GB social network urand [11] 260M 16.8M 2.1GB synthetic roadUSA [11] 57.7M 23.9M 1.3GB road network <ul> <li>Sparse Matrix \u90e8\u5206\u5305\u542b\u56db\u4e2a\u7a00\u758f\u77e9\u9635\u6570\u636e\u96c6\uff0c\u5176\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b\uff1a</li> </ul> Names Rows Nonzeros Size Type atmosmodj [19] 1.2M 8.8M 214MB fluid dynamics bbmat [19] 38.7K 1.7M 42.4MB fluid dynamics nlpkkt80 [19] 1.1M 28.1M 350MB PDE optimization pdb1HYS [19] 36.4K 4.3M 86.0MB protein data bank <ul> <li>\u6240\u6709\u6570\u636e\u96c6\u5747\u6807\u6ce8\u4e86\u5f15\u7528\u6765\u6e90\uff08\u5982 [32]\u3001[11]\u3001[19]\uff09\uff0c\u8868\u660e\u5176\u6765\u81ea\u516c\u5f00\u6216\u5df2\u53d1\u8868\u7684\u7814\u7a76\u6570\u636e\u96c6\u3002</li> <li>\u6570\u636e\u96c6\u7c7b\u578b\u8986\u76d6\u5e7f\u6cdb\uff0c\u5305\u62ec\u793e\u4ea4\u7f51\u7edc\u3001\u5408\u6210\u56fe\u3001\u9053\u8def\u7f51\u7edc\u3001\u6d41\u4f53\u52a8\u529b\u5b66\u3001\u504f\u5fae\u5206\u65b9\u7a0b\u4f18\u5316\u548c\u86cb\u767d\u8d28\u6570\u636e\u5e93\uff0c\u4f53\u73b0\u4e86\u5b9e\u9a8c\u7684\u591a\u6837\u6027\u4e0e\u4ee3\u8868\u6027\u3002</li> <li>\u6570\u636e\u89c4\u6a21\u4ece\u51e0\u5341 MB \u5230\u51e0 GB \u4e0d\u7b49\uff0c\u8282\u70b9\u6570\u548c\u8fb9\u6570\u8de8\u5ea6\u5927\uff0c\u9002\u5408\u8bc4\u4f30\u4e0d\u540c\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u4e0b\u7684\u9884\u53d6\u5668\u6027\u80fd\u3002</li> <li>urand \u4e3a\u5408\u6210\u56fe\uff0c\u5177\u6709\u968f\u673a\u8fde\u63a5\u7279\u6027\uff0c\u5e38\u7528\u4e8e\u6d4b\u8bd5\u9884\u53d6\u5668\u5728\u65e0\u89c4\u5f8b\u8bbf\u95ee\u6a21\u5f0f\u4e0b\u7684\u8868\u73b0\u3002</li> <li>roadUSA \u4e3a\u9053\u8def\u7f51\u7edc\uff0c\u7ed3\u6784\u76f8\u5bf9\u89c4\u5219\uff0c\u53ef\u4f5c\u4e3a\u5bf9\u6bd4\u57fa\u7ebf\uff0c\u9a8c\u8bc1\u9884\u53d6\u5668\u5728\u5c40\u90e8\u6027\u8f83\u597d\u7684\u573a\u666f\u4e0b\u7684\u6709\u6548\u6027\u3002</li> <li>\u7a00\u758f\u77e9\u9635\u6570\u636e\u96c6\u5982 atmosmodj \u548c nlpkkt80 \u5177\u6709\u9ad8\u975e\u96f6\u5143\u7d20\u5bc6\u5ea6\uff0c\u9002\u7528\u4e8e\u8bc4\u4f30 SpMV\uff08Sparse Matrix-Vector multiplication\uff09\u5185\u6838\u7684\u9884\u53d6\u6548\u7387\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-6-speedup-over-no-prefetcher-baseline","title":"Fig. 6. Speedup over no prefetcher baseline.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Fig. 6. Speedup over no prefetcher baseline\uff0c\u5c55\u793a\u7684\u662f\u4e0d\u540c\u9884\u53d6\u5668\u5728\u4e09\u79cd\u5e94\u7528\uff08PageRank\u3001Hyper-Anf\u3001spCG\uff09\u4e0a\u76f8\u5bf9\u4e8e\u65e0\u9884\u53d6\u57fa\u7ebf\u7684\u6027\u80fd\u52a0\u901f\u6bd4\u3002</li> <li>\u6a2a\u8f74\u6309\u5e94\u7528\u5206\u7ec4\uff1aPageRank\u3001Hyper-Anf\u3001spCG\uff0c\u6bcf\u7ec4\u5185\u5305\u542b\u591a\u4e2a\u8f93\u5165\u6570\u636e\u96c6\uff08\u5982 urand\u3001amazon\u3001com-orkut\u3001roadUSA \u7b49\uff09\uff0c\u5e76\u4ee5 GEOMEAN \u8868\u793a\u51e0\u4f55\u5e73\u5747\u503c\u3002</li> <li>\u7eb5\u8f74\u4e3a Speedup\uff0c\u8303\u56f4\u4ece 0.0 \u5230 5.0\uff0c\u8868\u793a\u6027\u80fd\u63d0\u5347\u500d\u6570\u3002</li> <li>\u56fe\u4f8b\u4e2d\u5305\u542b\u516b\u79cd\u9884\u53d6\u5668\uff1a</li> <li>next-line</li> <li>bingo</li> <li>SteMS</li> <li>MISB</li> <li>droplet</li> <li>RnR</li> <li>RnR-Combined</li> <li> <p>Ideal</p> </li> <li> <p>\u5404\u9884\u53d6\u5668\u8868\u73b0\u603b\u7ed3\u5982\u4e0b\uff1a</p> </li> </ul> \u9884\u53d6\u5668 PageRank (GEOMEAN) Hyper-Anf (GEOMEAN) spCG (GEOMEAN) next-line ~1.2 ~1.3 ~1.4 bingo ~1.3 ~1.4 ~1.5 SteMS ~1.4 ~1.5 ~1.6 MISB ~1.5 ~1.6 ~1.7 droplet ~1.6 ~1.8 \u2014 RnR ~2.1 ~2.2 ~2.9 RnR-Combined ~2.3 ~2.4 ~3.0 Ideal ~4.5 ~4.7 ~5.0 <ul> <li>RnR \u548c RnR-Combined \u5728\u6240\u6709\u5e94\u7528\u548c\u8f93\u5165\u6570\u636e\u96c6\u4e0a\u5747\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u901a\u7528\u9884\u53d6\u5668\uff08next-line\u3001bingo\u3001SteMS\u3001MISB\uff09\uff0c\u5c24\u5176\u5728 spCG \u4e0a\u8fbe\u5230 2.9\u00d7 \u548c 3.0\u00d7 \u52a0\u901f\u3002</li> <li>droplet \u5728 PageRank \u548c Hyper-Anf \u4e0a\u8868\u73b0\u8f83\u597d\uff0c\u4f46\u5728 spCG \u4e0a\u672a\u8bc4\u4f30\uff08\u56e0\u8bbe\u8ba1\u9488\u5bf9\u56fe\u7b97\u6cd5\uff09\u3002</li> <li>Ideal \u4ee3\u8868\u7406\u8bba\u6700\u4f18\u60c5\u51b5\uff08\u65e0\u9650\u5927 LLC\uff09\uff0c\u5176\u52a0\u901f\u6bd4\u8fdc\u9ad8\u4e8e\u6240\u6709\u5b9e\u9645\u9884\u53d6\u5668\uff0c\u8bf4\u660e\u5f53\u524d\u786c\u4ef6\u4ecd\u5b58\u5728\u4f18\u5316\u7a7a\u95f4\u3002</li> <li>\u5728 urand \u8f93\u5165\uff08\u9ad8\u968f\u673a\u6027\u3001\u4f4e\u5c40\u90e8\u6027\uff09\u4e0b\uff0c\u4f20\u7edf\u9884\u53d6\u5668\u6548\u679c\u5dee\uff0c\u800c RnR \u4ecd\u4fdd\u6301\u9ad8\u52a0\u901f\u6bd4\uff0c\u4f53\u73b0\u5176\u5bf9\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u7684\u6709\u6548\u6027\u3002</li> <li>RnR-Combined \u5728\u6240\u6709\u5e94\u7528\u4e2d\u5747\u7565\u4f18\u4e8e RnR\uff0c\u8868\u660e\u7ed3\u5408\u6d41\u5f0f\u9884\u53d6\uff08next-line\uff09\u53ef\u8fdb\u4e00\u6b65\u63d0\u5347\u6574\u4f53\u6027\u80fd\u3002</li> <li>\u6240\u6709\u9884\u53d6\u5668\u5728 roadUSA\uff08\u7ed3\u6784\u8f83\u89c4\u5219\uff09\u4e0a\u8868\u73b0\u76f8\u5bf9\u66f4\u597d\uff0c\u8bf4\u660e\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u66f4\u6613\u88ab\u4f20\u7edf\u9884\u53d6\u5668\u6355\u6349\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-7-l2-mpki","title":"Fig. 7. L2 MPKI.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\uff08PageRank\u3001Hyper-Anf\u3001spCG\uff09\u548c\u4e0d\u540c\u8f93\u5165\u6570\u636e\u96c6\u4e0a\uff0c\u5404\u79cd\u9884\u53d6\u5668\u5bf9 L2 MPKI\uff08\u6bcf\u5343\u6761\u6307\u4ee4\u7684 L2 \u7f13\u5b58\u672a\u547d\u4e2d\u6b21\u6570\uff09\u7684\u5f71\u54cd\u3002</li> <li>RnR \u548c RnR-Combined \u5728\u7edd\u5927\u591a\u6570\u6d4b\u8bd5\u573a\u666f\u4e0b\u5b9e\u73b0\u4e86\u6700\u4f4e\u7684 L2 MPKI\uff0c\u8868\u660e\u5176\u5728\u51cf\u5c11\u7f13\u5b58\u672a\u547d\u4e2d\u65b9\u9762\u6548\u679c\u663e\u8457\u3002</li> <li>\u5bf9\u4e8e PageRank \u5de5\u4f5c\u8d1f\u8f7d\uff1a</li> <li>\u5728 urand \u8f93\u5165\u4e0a\uff0cRnR-Combined \u5c06 MPKI \u4ece\u7ea6 80 \u964d\u81f3\u63a5\u8fd1 0\uff0c\u964d\u5e45\u8d85\u8fc7 97%\u3002</li> <li>\u5728 amazon \u548c com-orkut \u4e0a\uff0cRnR-Combined \u4e5f\u5c06 MPKI \u964d\u4f4e\u81f3 10 \u4ee5\u4e0b\uff0c\u964d\u5e45\u5206\u522b\u7ea6\u4e3a 94.6% \u548c 98.9%\u3002</li> <li>\u5728 roadUSA \u4e0a\uff0c\u7531\u4e8e\u5176\u8f83\u597d\u7684\u5c40\u90e8\u6027\uff0c\u6240\u6709\u9884\u53d6\u5668\u8868\u73b0\u90fd\u8f83\u597d\uff0c\u4f46 RnR-Combined \u4ecd\u4fdd\u6301\u6700\u4f4e MPKI\u3002</li> <li>\u5bf9\u4e8e Hyper-Anf \u5de5\u4f5c\u8d1f\u8f7d\uff1a</li> <li>\u5728 urand \u8f93\u5165\u4e0a\uff0cRnR-Combined \u5c06 MPKI \u4ece\u7ea6 60 \u964d\u81f3\u63a5\u8fd1 0\u3002</li> <li>\u5728 amazon \u548c com-orkut \u4e0a\uff0cRnR-Combined \u540c\u6837\u5c06 MPKI \u964d\u81f3 10 \u4ee5\u4e0b\u3002</li> <li>\u5728 roadUSA \u4e0a\uff0cRnR-Combined \u7684 MPKI \u7565\u9ad8\u4e8e\u5176\u4ed6\u4e00\u4e9b\u9884\u53d6\u5668\uff0c\u4f46\u4ecd\u5904\u4e8e\u8f83\u4f4e\u6c34\u5e73\u3002</li> <li>\u5bf9\u4e8e spCG \u5de5\u4f5c\u8d1f\u8f7d\uff1a</li> <li>\u5728 bimat\u3001nlpkkt80 \u548c pdt01MYS \u8f93\u5165\u4e0a\uff0cRnR-Combined \u5747\u5c06 MPKI \u964d\u81f3\u63a5\u8fd1 0\u3002</li> <li>\u5728 GEOMEAN\uff08\u51e0\u4f55\u5e73\u5747\u503c\uff09\u4e0a\uff0cRnR-Combined \u7684 MPKI \u4e5f\u8fdc\u4f4e\u4e8e\u5176\u4ed6\u9884\u53d6\u5668\u3002</li> <li>RnR-Combined \u662f\u6307\u540c\u65f6\u4e3a\u89c4\u5219\u548c\u4e0d\u89c4\u5219\u8bbf\u95ee\u7684\u6570\u636e\u7ed3\u6784\u542f\u7528 RnR \u9884\u53d6\u5668\uff0c\u800c RnR \u4ec5\u9488\u5bf9\u4e0d\u89c4\u5219\u8bbf\u95ee\u7684\u6570\u636e\u7ed3\u6784\u3002</li> <li>\u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0cRnR-Combined \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4f18\u4e8e RnR\uff0c\u8bf4\u660e\u7ed3\u5408\u4f7f\u7528\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63d0\u5347\u6027\u80fd\u3002</li> <li>\u5176\u4ed6\u9884\u53d6\u5668\u5982 nextline\u3001bingo\u3001SteMS\u3001MISB\u3001droplet \u5728\u4e0d\u540c\u8f93\u5165\u4e0a\u7684\u8868\u73b0\u5dee\u5f02\u8f83\u5927\uff0c\u4e14\u666e\u904d\u4e0d\u5982 RnR-Combined\u3002</li> <li>droplet \u5728 PageRank \u4e0a\u8868\u73b0\u5c1a\u53ef\uff0c\u4f46\u5728 Hyper-Anf \u548c spCG \u4e0a\u8868\u73b0\u4e0d\u4f73\u3002</li> <li>MISB \u5728\u67d0\u4e9b\u8f93\u5165\u4e0a\u8868\u73b0\u8f83\u597d\uff0c\u4f46\u603b\u4f53\u4e0a\u4e0d\u5982 RnR-Combined\u3002</li> <li>nextline \u4f5c\u4e3a\u6700\u7b80\u5355\u7684\u9884\u53d6\u5668\uff0c\u5728\u6240\u6709\u8f93\u5165\u4e0a\u8868\u73b0\u6700\u5dee\u3002</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d \u8f93\u5165\u6570\u636e\u96c6 RnR-Combined MPKI \u5176\u4ed6\u9884\u53d6\u5668\u6700\u9ad8 MPKI \u964d\u5e45 PageRank urand \u63a5\u8fd1 0 \u7ea6 80 &gt;97% PageRank amazon &lt;10 \u7ea6 50 ~94.6% PageRank com-orkut &lt;10 \u7ea6 50 ~98.9% PageRank roadUSA \u7ea6 10 \u7ea6 30 ~66.7% Hyper-Anf urand \u63a5\u8fd1 0 \u7ea6 60 &gt;98% Hyper-Anf amazon &lt;10 \u7ea6 40 ~75% Hyper-Anf com-orkut &lt;10 \u7ea6 40 ~75% Hyper-Anf roadUSA \u7ea6 15 \u7ea6 25 ~40% spCG bimat \u63a5\u8fd1 0 \u7ea6 40 &gt;97% spCG nlpkkt80 \u63a5\u8fd1 0 \u7ea6 40 &gt;97% spCG pdt01MYS \u63a5\u8fd1 0 \u7ea6 40 &gt;97% <ul> <li>\u603b\u4f53\u800c\u8a00\uff0cRnR-Combined \u9884\u53d6\u5668\u5728\u51cf\u5c11 L2 \u7f13\u5b58\u672a\u547d\u4e2d\u65b9\u9762\u8868\u73b0\u51fa\u8272\uff0c\u5c24\u5176\u662f\u5728\u5904\u7406\u5177\u6709\u91cd\u590d\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u5e94\u7528\u7a0b\u5e8f\u65f6\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-8-miss-coverage","title":"Fig. 8. Miss coverage.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u4e0d\u540c\u786c\u4ef6\u9884\u53d6\u5668\u5728\u4e09\u4e2a\u5e94\u7528\uff08PageRank\u3001Hyper-Anf\u3001spCG\uff09\u53ca\u5176\u591a\u4e2a\u8f93\u5165\u6570\u636e\u96c6\u4e0a\u7684Miss Coverage\u6027\u80fd\u5bf9\u6bd4\uff0c\u8986\u76d6\u8303\u56f4\u4ece0%\u5230100%\u3002</li> <li>RnR\uff08Record-and-Replay\uff09\u9884\u53d6\u5668\u5728\u6240\u6709\u6d4b\u8bd5\u573a\u666f\u4e2d\u5747\u8868\u73b0\u51fa\u6700\u9ad8\u6216\u63a5\u8fd1\u6700\u9ad8\u7684\u8986\u76d6\u7387\uff0c\u5c24\u5176\u5728\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\uff08\u5982urand\u3001com-orkut\uff09\u4e0b\u4f18\u52bf\u663e\u8457\u3002</li> <li>\u5bf9\u6bd4\u5176\u4ed6\u9884\u53d6\u5668\uff1a</li> <li>nextline\uff1a\u4f5c\u4e3a\u57fa\u7840\u6d41\u5f0f\u9884\u53d6\u5668\uff0c\u5728\u7ed3\u6784\u5316\u6570\u636e\uff08\u5982roadUSA\uff09\u4e0a\u8868\u73b0\u5c1a\u53ef\uff0c\u4f46\u5728\u4e0d\u89c4\u5219\u56fe\u6570\u636e\u4e0a\u8986\u76d6\u7387\u6781\u4f4e\u3002</li> <li>bingo \u548c SteMS\uff1a\u7a7a\u95f4/\u65f6\u7a7a\u9884\u53d6\u5668\uff0c\u5728\u5c40\u90e8\u6027\u8f83\u597d\u7684\u6570\u636e\uff08\u5982roadUSA\uff09\u4e0a\u8868\u73b0\u8f83\u597d\uff0c\u4f46\u5728\u968f\u673a\u56fe\uff08urand\uff09\u4e0a\u8986\u76d6\u7387\u9aa4\u964d\u3002</li> <li>MISB\uff1a\u57fa\u4e8e\u65f6\u95f4\u76f8\u5173\u6027\u7684\u9884\u53d6\u5668\uff0c\u53d7\u9650\u4e8e\u6a21\u5f0f\u533a\u5206\u80fd\u529b\uff0c\u5728\u590d\u6742\u56fe\u7ed3\u6784\u4e2d\u8986\u76d6\u7387\u4e0d\u7a33\u5b9a\u3002</li> <li>droplet\uff1a\u9762\u5411\u56fe\u7b97\u6cd5\u7684\u9886\u57df\u4e13\u7528\u9884\u53d6\u5668\uff0c\u5728Hyper-Anf\u4e0a\u8868\u73b0\u4f18\u4e8ePageRank\uff0c\u4f46\u4ecd\u4f4e\u4e8eRnR\u3002</li> </ul> \u5e94\u7528 \u6570\u636e\u96c6 RnR \u8986\u76d6\u7387 bingo \u8986\u76d6\u7387 SteMS \u8986\u76d6\u7387 MISB \u8986\u76d6\u7387 droplet \u8986\u76d6\u7387 PageRank urand ~95% ~20% ~30% ~40% ~50% PageRank amazon ~85% ~60% ~70% ~65% ~75% PageRank com-orkut ~90% ~50% ~60% ~55% ~70% PageRank roadUSA ~95% ~80% ~85% ~80% ~85% Hyper-Anf urand ~90% ~25% ~35% ~45% ~60% Hyper-Anf amazon ~88% ~65% ~75% ~70% ~80% Hyper-Anf com-orkut ~92% ~55% ~65% ~60% ~75% Hyper-Anf roadUSA ~95% ~85% ~90% ~85% ~90% spCG GEOMEAN ~95% ~70% ~75% ~70% N/A <ul> <li>\u5728GEOMEAN\uff08\u51e0\u4f55\u5e73\u5747\uff09\u6c47\u603b\u4e2d\uff0cRnR\u5728\u6240\u6709\u5e94\u7528\u4e0a\u5747\u4fdd\u630188%\u4ee5\u4e0a\u7684\u8986\u76d6\u7387\uff0c\u8fdc\u8d85\u5176\u4ed6\u9884\u53d6\u5668\u3002</li> <li>RnR\u7684\u4f18\u52bf\u6e90\u4e8e\u5176\u8f6f\u4ef6\u8f85\u52a9\u8bb0\u5f55\u4e0e\u56de\u653e\u673a\u5236\uff0c\u80fd\u7cbe\u51c6\u6355\u83b7\u91cd\u590d\u7684\u4e0d\u89c4\u5219\u8bbf\u95ee\u5e8f\u5217\uff0c\u65e0\u9700\u4f9d\u8d56\u5171\u4eab\u6a21\u5f0f\u6216\u5730\u5740\u76f8\u5173\u6027\uff0c\u4ece\u800c\u5b9e\u73b0\u9ad8\u8986\u76d6\u7387\u3002</li> <li>\u7279\u522b\u662f\u5728urand\u8fd9\u7c7b\u9ad8\u5ea6\u968f\u673a\u56fe\u6570\u636e\u4e0a\uff0cRnR\u7684\u8986\u76d6\u7387\u63a5\u8fd195%\uff0c\u800c\u5176\u4ed6\u9884\u53d6\u5668\u666e\u904d\u4f4e\u4e8e50%\uff0c\u51f8\u663e\u5176\u5bf9\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u7684\u9002\u5e94\u80fd\u529b\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-9-prefetcher-accuracy","title":"Fig. 9. Prefetcher accuracy.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u4e0d\u540c\u786c\u4ef6\u9884\u53d6\u5668\u5728\u4e09\u4e2a\u5e94\u7528\uff08PageRank\u3001Hyper-Anf\u3001spCG\uff09\u53ca\u5176\u591a\u79cd\u8f93\u5165\u6570\u636e\u96c6\u4e0a\u7684\u9884\u53d6\u51c6\u786e\u7387\uff08Accuracy\uff09\u5bf9\u6bd4\uff0c\u6a2a\u8f74\u4e3a\u5e94\u7528\u4e0e\u6570\u636e\u96c6\u7ec4\u5408\uff0c\u7eb5\u8f74\u4e3a\u51c6\u786e\u7387\u767e\u5206\u6bd4\u3002</li> <li>RnR \u9884\u53d6\u5668\u5728\u6240\u6709\u6d4b\u8bd5\u573a\u666f\u4e2d\u5747\u8868\u73b0\u51fa\u6700\u9ad8\u6216\u63a5\u8fd1\u6700\u9ad8\u7684\u51c6\u786e\u7387\uff0c\u5e73\u5747\u51c6\u786e\u7387\u8fbe 97.18%\uff0c\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u9884\u53d6\u5668\u3002</li> <li>\u5176\u4ed6\u9884\u53d6\u5668\u8868\u73b0\u5982\u4e0b\uff1a</li> <li>Next-line\uff1a\u5728\u5177\u6709\u826f\u597d\u5c40\u90e8\u6027\u7684\u6570\u636e\u96c6\uff08\u5982 roadUSA\uff09\u4e0a\u8868\u73b0\u5c1a\u53ef\uff0c\u4f46\u5728\u968f\u673a\u56fe\uff08urand\uff09\u4e0a\u51c6\u786e\u7387\u6781\u4f4e\u3002</li> <li>Bingo \u548c SteMS\uff1a\u4f5c\u4e3a\u901a\u7528\u7a7a\u95f4/\u65f6\u7a7a\u9884\u53d6\u5668\uff0c\u5728\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u4e0b\u51c6\u786e\u7387\u666e\u904d\u504f\u4f4e\uff0c\u5c24\u5176\u5728 urand \u6570\u636e\u96c6\u4e0a\u63a5\u8fd1 0%\u3002</li> <li>MISB\uff1a\u4f5c\u4e3a\u57fa\u4e8e\u65f6\u95f4\u76f8\u5173\u6027\u7684\u9884\u53d6\u5668\uff0c\u5728\u90e8\u5206\u6570\u636e\u96c6\u4e0a\u8868\u73b0\u4f18\u4e8e Bingo \u548c SteMS\uff0c\u4f46\u4ecd\u8fdc\u4f4e\u4e8e RnR\u3002</li> <li>DROPLET\uff1a\u4e13\u4e3a\u56fe\u7b97\u6cd5\u8bbe\u8ba1\uff0c\u5728 Hyper-Anf \u4e0a\u8868\u73b0\u8f83\u597d\uff0c\u4f46\u5728 PageRank-urand \u4e0a\u56e0\u95f4\u63a5\u8bbf\u95ee\u5ef6\u8fdf\u5bfc\u81f4\u51c6\u786e\u7387\u4e0b\u964d\u3002</li> </ul> \u5e94\u7528/\u6570\u636e\u96c6 Next-line Bingo SteMS MISB DROPLET RnR PageRank-urand ~5% ~0% ~0% ~20% ~30% ~98% PageRank-amazon ~40% ~60% ~70% ~80% ~85% ~99% PageRank-com-orkut ~30% ~50% ~60% ~75% ~80% ~98% PageRank-roadUSA ~50% ~70% ~80% ~85% ~90% ~99% Hyper-Anf-urand ~5% ~0% ~0% ~25% ~40% ~97% Hyper-Anf-amazon ~45% ~65% ~75% ~85% ~90% ~98% Hyper-Anf-com-orkut ~35% ~55% ~65% ~80% ~85% ~97% Hyper-Anf-roadUSA ~55% ~75% ~85% ~90% ~95% ~99% spCG-bbmat ~50% ~60% ~70% ~80% N/A ~98% spCG-nlpkkt80 ~45% ~55% ~65% ~75% N/A ~97% spCG-pdb1HYS ~55% ~65% ~75% ~85% N/A ~98% spCG-GEO-MEAN ~50% ~60% ~70% ~80% N/A ~98% <ul> <li>RnR \u51c6\u786e\u7387\u9ad8\u7684\u6838\u5fc3\u539f\u56e0\u5728\u4e8e\u5176\u8bb0\u5f55-\u56de\u653e\u673a\u5236\uff1a\u9996\u6b21\u8fed\u4ee3\u8bb0\u5f55\u771f\u5b9e\u7f13\u5b58\u7f3a\u5931\u5e8f\u5217\uff0c\u540e\u7eed\u8fed\u4ee3\u7cbe\u786e\u56de\u653e\u76f8\u540c\u5e8f\u5217\uff0c\u907f\u514d\u4e86\u4f20\u7edf\u9884\u53d6\u5668\u56e0\u6a21\u5f0f\u6df7\u6dc6\u6216\u9884\u6d4b\u9519\u8bef\u5bfc\u81f4\u7684\u8bef\u9884\u53d6\u3002</li> <li>\u5728urand\u7b49\u9ad8\u5ea6\u968f\u673a\u7684\u6570\u636e\u96c6\u4e0a\uff0cRnR \u7684\u4f18\u52bf\u5c24\u4e3a\u660e\u663e\uff0c\u56e0\u4e3a\u5176\u4ed6\u9884\u53d6\u5668\u65e0\u6cd5\u6355\u6349\u65e0\u89c4\u5f8b\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u800c RnR \u4f9d\u8d56\u7a0b\u5e8f\u5458\u6307\u5b9a\u7684\u91cd\u590d\u533a\u57df\uff0c\u65e0\u9700\u9884\u6d4b\u5373\u53ef\u5b9e\u73b0\u9ad8\u7cbe\u5ea6\u9884\u53d6\u3002</li> <li>\u56fe\u8868\u663e\u793a\uff0c\u5373\u4f7f\u5728roadUSA\u8fd9\u7c7b\u5177\u6709\u826f\u597d\u5c40\u90e8\u6027\u7684\u6570\u636e\u96c6\u4e0a\uff0cRnR \u4ecd\u80fd\u4fdd\u6301\u63a5\u8fd1 100% \u7684\u51c6\u786e\u7387\uff0c\u8bf4\u660e\u5176\u8bbe\u8ba1\u5728\u5404\u79cd\u8bbf\u95ee\u6a21\u5f0f\u4e0b\u5747\u5177\u5907\u9c81\u68d2\u6027\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-10-effectiveness-of-replay-timing-control","title":"Fig. 10. Effectiveness of replay timing control.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Fig. 10. Effectiveness of replay timing control\uff0c\u65e8\u5728\u8bc4\u4f30 RnR prefetcher \u4e2d\u56de\u653e\u65f6\u5e8f\u63a7\u5236\u673a\u5236\u7684\u6709\u6548\u6027\u3002</li> <li>\u6a2a\u8f74\u6309\u5e94\u7528\u5206\u7c7b\uff1aPageRank\u3001Hyper-Anf \u548c spCG\uff0c\u6bcf\u4e2a\u5e94\u7528\u4e0b\u5305\u542b\u4e0d\u540c\u8f93\u5165\u6570\u636e\u96c6\uff1aurand\u3001amazon\u3001com-orkut\u3001roadUSA \u548c GEO-MEAN\uff08\u51e0\u4f55\u5e73\u5747\u503c\uff09\u3002</li> <li>\u7eb5\u8f74\u8868\u793a Speedup\uff08\u52a0\u901f\u6bd4\uff09\uff0c\u8303\u56f4\u4ece 0.0 \u5230 4.0\uff0c\u7528\u4e8e\u8861\u91cf\u4e0d\u540c\u63a7\u5236\u7b56\u7565\u4e0b\u7684\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u56fe\u4f8b\u8bf4\u660e\u4e09\u79cd\u63a7\u5236\u7b56\u7565\uff1a</li> <li>no control\uff08\u7eff\u8272\u67f1\uff09\uff1a\u65e0\u7a97\u53e3\u6216\u8282\u594f\u63a7\u5236\uff0c\u4ec5\u7b80\u5355\u56de\u653e\u5e8f\u5217\u3002</li> <li>window control\uff08\u9ec4\u8272\u67f1\uff09\uff1a\u542f\u7528\u57fa\u4e8e\u7a97\u53e3\u7684\u65f6\u5e8f\u63a7\u5236\uff0c\u6839\u636e\u8bb0\u5f55\u7684\u8bbf\u95ee\u5bc6\u5ea6\u8c03\u6574\u9884\u53d6\u8282\u594f\u3002</li> <li>window and pace control\uff08\u6a59\u8272\u67f1\uff09\uff1a\u5728\u7a97\u53e3\u63a7\u5236\u57fa\u7840\u4e0a\u8fdb\u4e00\u6b65\u5f15\u5165\u201cpace control\u201d\uff0c\u66f4\u7cbe\u7ec6\u5730\u5339\u914d\u9700\u6c42\u8bbf\u95ee\u9891\u7387\u3002</li> </ul> \u5e94\u7528 \u8f93\u5165\u6570\u636e\u96c6 no control window control window and pace control PageRank urand ~1.0 ~2.3 ~2.5 amazon ~1.2 ~2.6 ~2.7 com-orkut ~1.1 ~2.4 ~2.5 roadUSA ~1.5 ~2.8 ~2.9 GEO-MEAN ~1.2 ~2.5 ~2.6 Hyper-Anf urand ~1.0 ~2.2 ~2.3 amazon ~1.3 ~2.7 ~2.8 com-orkut ~1.2 ~2.5 ~2.6 roadUSA ~1.6 ~2.9 ~3.0 GEO-MEAN ~1.3 ~2.6 ~2.7 spCG urand ~1.0 ~2.4 ~2.6 amazon ~1.4 ~2.8 ~2.9 com-orkut ~1.3 ~2.6 ~2.7 roadUSA ~1.7 ~3.0 ~3.1 GEO-MEAN ~1.4 ~2.7 ~2.8 <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u6240\u6709\u5e94\u7528\u548c\u8f93\u5165\u4e2d\uff0cwindow control \u76f8\u8f83\u4e8e no control \u5747\u5e26\u6765\u663e\u8457\u6027\u80fd\u63d0\u5347\uff0c\u5e73\u5747\u52a0\u901f\u6bd4\u63d0\u5347\u7ea6 2.3x\u20133.0x\u3002</li> <li>window and pace control \u5728\u591a\u6570\u60c5\u51b5\u4e0b\u7565\u4f18\u4e8e window control\uff0c\u4f46\u63d0\u5347\u5e45\u5ea6\u8f83\u5c0f\uff08\u901a\u5e38 &lt; 0.2x\uff09\uff0c\u8868\u660e\u7a97\u53e3\u63a7\u5236\u5df2\u8db3\u591f\u6709\u6548\u3002</li> <li>roadUSA \u8f93\u5165\u8868\u73b0\u6700\u4f73\uff0c\u56e0\u5176\u5177\u6709\u8f83\u597d\u7a7a\u95f4\u5c40\u90e8\u6027\uff0c\u9884\u53d6\u66f4\u5bb9\u6613\u547d\u4e2d\u4e14\u4e0d\u88ab\u8fc7\u65e9\u9a71\u9010\u3002</li> <li>urand \u8f93\u5165\u8868\u73b0\u6700\u5dee\uff0c\u56e0\u968f\u673a\u8fde\u63a5\u5bfc\u81f4\u9ad8\u5931\u6548\u7387\u548c\u4f4e\u5c40\u90e8\u6027\uff0c\u4f46\u4ecd\u80fd\u901a\u8fc7\u65f6\u5e8f\u63a7\u5236\u83b7\u5f97\u660e\u663e\u6536\u76ca\u3002</li> <li> <p>GEO-MEAN \u663e\u793a\u6574\u4f53\u8d8b\u52bf\uff1awindow control \u5e73\u5747\u63d0\u4f9b\u7ea6 2.6x \u52a0\u901f\uff0cwindow and pace control \u63d0\u5347\u81f3\u7ea6 2.7x\u3002</p> </li> <li> <p>\u7ed3\u8bba\uff1a</p> </li> <li>Replay timing control \u662f RnR prefetcher \u9ad8\u6548\u6027\u7684\u6838\u5fc3\u673a\u5236\uff0c\u5c24\u5176 window control \u80fd\u6709\u6548\u907f\u514d\u8fc7\u65e9\u6216\u8fc7\u665a\u9884\u53d6\u3002</li> <li>\u5f15\u5165 pace control \u53ef\u5fae\u8c03\u9884\u53d6\u8282\u594f\uff0c\u4f46\u5728\u5927\u591a\u6570\u573a\u666f\u4e0b\u6536\u76ca\u6709\u9650\uff0c\u8bf4\u660e\u7a97\u53e3\u7c92\u5ea6\u5df2\u8db3\u591f\u7cbe\u7ec6\u3002</li> <li>\u8be5\u673a\u5236\u5bf9\u6240\u6709\u6d4b\u8bd5\u5e94\u7528\u5747\u6709\u6548\uff0c\u5c24\u5176\u5728\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\uff08\u5982 urand\uff09\u4e2d\u4ecd\u80fd\u7ef4\u6301\u9ad8\u6027\u80fd\uff0c\u9a8c\u8bc1\u4e86 RnR \u8bbe\u8ba1\u7684\u9c81\u68d2\u6027\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-11-prefetch-timeliness-breakdown-left-bar-no-control-middle-bar-window-control-right-bar-windowpace-control","title":"Fig. 11. Prefetch timeliness breakdown (Left bar: no control, middle bar: window control, right bar: window+pace control).","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Fig. 11\uff0c\u6807\u9898\u4e3a\u201cPrefetch timeliness breakdown\u201d\uff0c\u7528\u4e8e\u5206\u6790 RnR prefetcher \u5728\u4e0d\u540c\u63a7\u5236\u7b56\u7565\u4e0b\u7684\u9884\u53d6\u53ca\u65f6\u6027\u8868\u73b0\u3002</li> <li>\u6a2a\u8f74\u6309\u5e94\u7528\u548c\u8f93\u5165\u6570\u636e\u96c6\u5206\u7c7b\uff0c\u5305\u62ec PageRank\u3001Hyper-Anf \u548c spCG\uff0c\u6bcf\u4e2a\u5e94\u7528\u4e0b\u6709\u591a\u4e2a\u8f93\u5165\uff08\u5982 urand, amazon, com-orkut \u7b49\uff09\u3002</li> <li>\u7eb5\u8f74\u8868\u793a\u9884\u53d6\u6570\u636e\u7684\u767e\u5206\u6bd4\u5206\u5e03\uff0c\u5206\u4e3a\u56db\u7c7b\uff1aOn time\uff08\u51c6\u65f6\uff09\u3001Early\uff08\u8fc7\u65e9\uff09\u3001Late\uff08\u8fc7\u665a\uff09\u3001Out of window\uff08\u7a97\u53e3\u5916\uff09\u3002</li> <li>\u6bcf\u4e2a\u6570\u636e\u96c6\u5bf9\u5e94\u4e09\u7ec4\u67f1\u72b6\u56fe\uff0c\u5206\u522b\u4ee3\u8868\u4e09\u79cd\u63a7\u5236\u7b56\u7565\uff1a</li> <li>\u5de6\u4fa7\u67f1\uff1ano control\uff08\u65e0\u63a7\u5236\uff09</li> <li>\u4e2d\u95f4\u67f1\uff1awindow control\uff08\u7a97\u53e3\u63a7\u5236\uff09</li> <li>\u53f3\u4fa7\u67f1\uff1awindow+pace control\uff08\u7a97\u53e3+\u8282\u594f\u63a7\u5236\uff09</li> </ul> \u5e94\u7528/\u8f93\u5165 \u63a7\u5236\u7b56\u7565 On time Early Late Out of window PageRank-urand no control ~70% ~25% ~5% ~0% window control ~90% ~8% ~2% ~0% window+pace ~92% ~6% ~2% ~0% PageRank-amazon no control ~85% ~10% ~5% ~0% window control ~95% ~4% ~1% ~0% window+pace ~96% ~3% ~1% ~0% Hyper-Anf-urand no control ~65% ~30% ~5% ~0% window control ~88% ~10% ~2% ~0% window+pace ~90% ~8% ~2% ~0% spCG-pdbHYS no control ~90% ~5% ~5% ~0% window control ~98% ~1% ~1% ~0% window+pace ~98% ~1% ~1% ~0% <ul> <li>\u5173\u952e\u89c2\u5bdf\uff1a</li> <li>\u65e0\u63a7\u5236\u7b56\u7565\u4e0b\uff0c\u9884\u53d6\u6570\u636e\u4e2d\u201cEarly\u201d\u6bd4\u4f8b\u8f83\u9ad8\uff0c\u5c24\u5176\u5728 urand \u8f93\u5165\u4e0a\u53ef\u8fbe 25%-30%\uff0c\u8868\u660e\u9884\u53d6\u8fc7\u65e9\u5bfc\u81f4\u6570\u636e\u88ab\u63d0\u524d\u9a71\u9010\u3002</li> <li>\u5f15\u5165 window control \u540e\uff0c\u201cOn time\u201d\u6bd4\u4f8b\u663e\u8457\u63d0\u5347\u81f3 88%-98%\uff0c\u540c\u65f6\u201cEarly\u201d\u5927\u5e45\u4e0b\u964d\uff0c\u8bf4\u660e\u7a97\u53e3\u673a\u5236\u6709\u6548\u5339\u914d\u4e86\u7a0b\u5e8f\u6267\u884c\u8282\u594f\u3002</li> <li>\u8fdb\u4e00\u6b65\u52a0\u5165 pace control \u5bf9\u5927\u591a\u6570\u8f93\u5165\u63d0\u5347\u6709\u9650\uff0c\u4ec5\u5728 urand \u7c7b\u578b\u8f93\u5165\u4e0a\u7565\u6709\u6539\u5584\uff08\u51cf\u5c11 2%-4% \u7684\u201cEarly\u201d\uff09\uff0c\u8868\u660e\u7a97\u53e3\u63a7\u5236\u5df2\u8db3\u591f\u5e94\u5bf9\u591a\u6570\u573a\u666f\u3002</li> <li> <p>\u6240\u6709\u7b56\u7565\u4e0b\u201cOut of window\u201d\u5747\u63a5\u8fd1 0%\uff0c\u8bf4\u660e\u9884\u53d6\u8303\u56f4\u63a7\u5236\u826f\u597d\uff0c\u672a\u4ea7\u751f\u65e0\u6548\u9884\u53d6\u3002</p> </li> <li> <p>\u7ed3\u8bba\uff1a</p> </li> <li>window control \u662f\u63d0\u5347\u9884\u53d6\u53ca\u65f6\u6027\u7684\u6838\u5fc3\u673a\u5236\uff0c\u80fd\u5c06\u201cOn time\u201d\u6bd4\u4f8b\u7a33\u5b9a\u5728 90% \u4ee5\u4e0a\u3002</li> <li>pace control \u4f5c\u4e3a\u8865\u5145\uff0c\u5728\u6781\u7aef\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\uff08\u5982 urand\uff09\u4e2d\u53ef\u5fae\u8c03\u9884\u53d6\u8282\u594f\uff0c\u4f46\u5bf9\u6574\u4f53\u6027\u80fd\u5f71\u54cd\u8f83\u5c0f\u3002</li> <li>RnR prefetcher \u901a\u8fc7\u8bb0\u5f55\u65f6\u5e8f\u4fe1\u606f\u5e76\u52a8\u6001\u8c03\u6574\u9884\u53d6\u8282\u594f\uff0c\u5b9e\u73b0\u4e86\u9ad8\u53ca\u65f6\u6027\uff0c\u907f\u514d\u4e86\u4f20\u7edf\u9884\u53d6\u5668\u56e0\u201c\u8fc7\u65e9\u201d\u6216\u201c\u8fc7\u665a\u201d\u5bfc\u81f4\u7684\u7f13\u5b58\u6c61\u67d3\u6216\u5ef6\u8fdf\u63a9\u76d6\u5931\u6548\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-12-additional-off-chip-traffic","title":"Fig. 12. Additional off-chip traffic.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u4e0d\u540c prefetcher \u5728 PageRank\u3001Hyper-Anf \u548c spCG \u4e09\u79cd\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\uff0c\u76f8\u5bf9\u4e8e\u65e0 prefetcher \u57fa\u7ebf\u6240\u589e\u52a0\u7684 off-chip traffic \u767e\u5206\u6bd4\u3002</li> <li>\u6a2a\u8f74\u6309\u5de5\u4f5c\u8d1f\u8f7d\u5206\u7ec4\uff0c\u6bcf\u7ec4\u5185\u5305\u542b\u591a\u4e2a\u8f93\u5165\u6570\u636e\u96c6\uff08\u5982 urand, amazon, com-orkut \u7b49\uff09\uff0c\u5e76\u4ee5 GEOMEAN \u8868\u793a\u51e0\u4f55\u5e73\u5747\u503c\u3002</li> <li>\u7eb5\u8f74\u4e3a\u767e\u5206\u6bd4\uff0c\u8868\u793a\u989d\u5916\u6d41\u91cf\u5360\u57fa\u7ebf\u5185\u5b58\u8bbf\u95ee\u91cf\u7684\u6bd4\u4f8b\u3002</li> <li>\u5404 prefetcher \u7528\u4e0d\u540c\u989c\u8272\u67f1\u72b6\u56fe\u8868\u793a\uff1anextline\uff08\u7eff\u8272\uff09\u3001bingo\uff08\u9ec4\u8272\uff09\u3001SteMS\uff08\u6a59\u8272\uff09\u3001MISB\uff08\u7d2b\u8272\uff09\u3001droplet\uff08\u68d5\u8272\uff09\u3001RnR\uff08\u6df1\u84dd\u8272\uff09\u3001RnR-Combined\uff08\u6d45\u84dd\u8272\uff09\u3002</li> <li>RnR \u548c RnR-Combined \u7684\u989d\u5916\u6d41\u91cf\u663e\u8457\u4f4e\u4e8e\u5176\u4ed6\u901a\u7528 prefetcher\uff0c\u5c24\u5176\u5728 spCG \u4e0a\u8868\u73b0\u6700\u4f18\u3002</li> <li>\u5728 PageRank \u548c Hyper-Anf \u4e2d\uff0cDROPLET \u7684\u989d\u5916\u6d41\u91cf\u4e0e RnR \u76f8\u8fd1\uff0c\u4f46 RnR-Combined \u56e0\u540c\u65f6\u5904\u7406\u89c4\u5219\u548c\u4e0d\u89c4\u5219\u7ed3\u6784\uff0c\u6d41\u91cf\u7565\u9ad8\u3002</li> <li>MISB \u548c bingo \u4ea7\u751f\u6700\u9ad8\u989d\u5916\u6d41\u91cf\uff0c\u56e0\u5176\u9884\u6d4b\u7cbe\u5ea6\u4f4e\uff0c\u5bfc\u81f4\u5927\u91cf\u65e0\u6548 prefetch \u8bf7\u6c42\u3002</li> <li>GEOMEAN \u6570\u636e\u663e\u793a\uff1a   | Prefetcher     | PageRank | Hyper-Anf | spCG   |   |----------------|----------|-----------|--------|   | nextline       | 45.2%    | 58.4%     | \u2014      |   | bingo          | 67.1%    | \u2014         | \u2014      |   | SteMS          | \u2014        | \u2014         | \u2014      |   | MISB           | 19.7%    | \u2014         | \u2014      |   | droplet        | 12.2%    | \u2014         | \u2014      |   | RnR            | 12.0%    | \u2014         | \u2014      |   | RnR-Combined   | 27.6%    | \u2014         | \u2014      |</li> <li>RnR \u7684\u4f4e\u989d\u5916\u6d41\u91cf\u4e3b\u8981\u5f52\u56e0\u4e8e\u5176\u9ad8\u51c6\u786e\u7387\uff08&gt;97%\uff09\uff0c\u51cf\u5c11\u4e86\u65e0\u6548 prefetch\uff1b\u800c DROPLET \u867d\u6d41\u91cf\u76f8\u8fd1\uff0c\u4f46\u6e90\u4e8e\u5176\u5730\u5740\u751f\u6210\u5ef6\u8fdf\u5bfc\u81f4\u7684\u4f4e\u6548\u3002</li> <li>Metadata traffic \u662f RnR \u989d\u5916\u6d41\u91cf\u7684\u4e3b\u8981\u6765\u6e90\uff0c\u4f46\u56e0\u5176\u5177\u6709\u826f\u597d\u7a7a\u95f4\u5c40\u90e8\u6027\uff0c\u53ef\u9ad8\u6548\u5229\u7528 DRAM row buffer\uff0c\u5bf9\u6027\u80fd\u5f71\u54cd\u8f83\u5c0f\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-13-metadata-storage-overhead-of-sequence-table-and-window-division-table-normalized-to-input-dataset-sizes","title":"Fig. 13. Metadata storage overhead of sequence table and window division table (normalized to input dataset sizes).","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Fig. 13\uff0c\u5373 RnR prefetcher \u7684\u5143\u6570\u636e\u5b58\u50a8\u5f00\u9500\uff08sequence table + window division table\uff09\uff0c\u5e76\u4ee5\u8f93\u5165\u6570\u636e\u96c6\u5927\u5c0f\u4e3a\u57fa\u51c6\u8fdb\u884c\u5f52\u4e00\u5316\u3002</li> <li>\u56fe\u8868\u6a2a\u8f74\u5206\u4e3a\u4e09\u7ec4\uff1aPageRank\u3001Hyper-Anf \u548c spCG\uff0c\u6bcf\u7ec4\u4e0b\u5305\u542b\u591a\u4e2a\u8f93\u5165\u6570\u636e\u96c6\uff0c\u5982 urand\u3001amazon\u3001com-orkut\u3001roadUSA \u7b49\u3002</li> <li>\u7eb5\u8f74\u4e3a\u201cNormalized Storage Overhead\u201d\uff0c\u5355\u4f4d\u4e3a\u767e\u5206\u6bd4\uff0c\u8868\u793a\u5143\u6570\u636e\u5b58\u50a8\u5360\u539f\u59cb\u8f93\u5165\u6570\u636e\u96c6\u5927\u5c0f\u7684\u6bd4\u4f8b\u3002</li> <li>\u6bcf\u4e2a\u67f1\u72b6\u56fe\u4e0a\u65b9\u6807\u6ce8\u4e86\u5b9e\u9645\u5b58\u50a8\u5f00\u9500\uff08MB\uff09\uff0c\u4e0b\u65b9\u4e3a\u5f52\u4e00\u5316\u540e\u7684\u767e\u5206\u6bd4\u503c\u3002</li> <li>PageRank\uff1a</li> <li>urand \u8f93\u5165\uff1a471MB\uff0c\u5360\u6bd4 25%\uff08\u6700\u9ad8\uff09\u3002</li> <li>amazon \u8f93\u5165\uff1a190.4MB\uff0c\u5360\u6bd4\u7ea6 15%\u3002</li> <li>com-orkut \u8f93\u5165\uff1a80.4MB\uff0c\u5360\u6bd4\u7ea6 10%\u3002</li> <li>roadUSA \u8f93\u5165\uff1a5.3MB\uff0c\u5360\u6bd4\u7ea6 5%\uff08\u6700\u4f4e\uff0c\u56e0\u5c40\u90e8\u6027\u597d\uff09\u3002</li> <li>GEOMEAN\uff1a87.2MB\uff0c\u5360\u6bd4\u7ea6 10%\u3002</li> <li>Hyper-Anf\uff1a</li> <li>urand \u8f93\u5165\uff1a449MB\uff0c\u5360\u6bd4\u7ea6 20%\u3002</li> <li>amazon \u8f93\u5165\uff1a6.8MB\uff0c\u5360\u6bd4\u7ea6 5%\u3002</li> <li>com-orkut \u8f93\u5165\uff1a78.4MB\uff0c\u5360\u6bd4\u7ea6 10%\u3002</li> <li>roadUSA \u8f93\u5165\uff1a173MB\uff0c\u5360\u6bd4\u7ea6 15%\u3002</li> <li>GEOMEAN\uff1a70.1MB\uff0c\u5360\u6bd4\u7ea6 10%\u3002</li> <li>spCG\uff1a</li> <li>atmosmodj \u8f93\u5165\uff1a35.1MB\uff0c\u5360\u6bd4\u7ea6 15%\u3002</li> <li>bimat \u8f93\u5165\uff1a4.3MB\uff0c\u5360\u6bd4\u7ea6 5%\u3002</li> <li>nlpkkt80 \u8f93\u5165\uff1a54.3MB\uff0c\u5360\u6bd4\u7ea6 10%\u3002</li> <li>pdi1HYS \u8f93\u5165\uff1a9.5MB\uff0c\u5360\u6bd4\u7ea6 5%\u3002</li> <li>GEOMEAN\uff1a16.7MB\uff0c\u5360\u6bd4\u7ea6 5%\u3002</li> <li>\u603b\u4f53\u8d8b\u52bf\u663e\u793a\uff0c\u5c40\u90e8\u6027\u5dee\u7684\u6570\u636e\u96c6\uff08\u5982 urand\uff09\u5bfc\u81f4\u66f4\u9ad8\u7684\u5b58\u50a8\u5f00\u9500\uff0c\u800c\u5c40\u90e8\u6027\u597d\u7684\u6570\u636e\u96c6\uff08\u5982 roadUSA\u3001bimat\uff09\u5219\u663e\u8457\u964d\u4f4e\u5f00\u9500\u3002</li> <li>\u5b58\u50a8\u5f00\u9500\u4e3b\u8981\u6765\u81ea sequence table\uff0c\u56e0\u5176\u8bb0\u5f55\u6bcf\u4e2a L2 miss \u5730\u5740\uff1bwindow division table \u5f00\u9500\u6781\u5c0f\uff0c\u4ec5\u8bb0\u5f55\u6bcf\u7a97\u53e3\u7684\u8bbf\u95ee\u8ba1\u6570\u3002</li> <li>\u5e73\u5747\u800c\u8a00\uff0cRnR \u5728 PageRank\u3001spCG\u3001Hyper-Anf \u4e0a\u5206\u522b\u9700 12.1%\u300111.58%\u300113.0% \u7684\u8f93\u5165\u6570\u636e\u96c6\u5927\u5c0f\u4f5c\u4e3a\u5143\u6570\u636e\u5b58\u50a8\u7a7a\u95f4\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#fig-14-average-speedup-and-storage-for-different-window-sizes","title":"Fig. 14. Average speedup and storage for different window sizes.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Fig. 14. Average speedup and storage for different window sizes\uff0c\u5c55\u793a\u7684\u662f RnR prefetcher \u5728\u4e0d\u540c Window Size \u8bbe\u7f6e\u4e0b\u7684\u5e73\u5747\u6027\u80fd\u52a0\u901f\u6bd4\uff08Speedup\uff09\u4e0e\u5b58\u50a8\u5f00\u9500\uff08Storage Overhead\uff09\u7684\u5bf9\u6bd4\u5173\u7cfb\u3002</li> <li>\u6a2a\u8f74\u4e3a Window Size\uff0c\u53d6\u503c\u4ece 1 \u5230 2048\uff0c\u5355\u4f4d\u4e3a cache lines\u3002\u7eb5\u8f74\u5de6\u4fa7\u4e3a Speedup\uff08\u7eff\u8272\u67f1\u72b6\u56fe\uff09\uff0c\u53f3\u4fa7\u4e3a Storage Overhead\uff08\u84dd\u8272\u6298\u7ebf\u56fe\uff0c\u767e\u5206\u6bd4\uff09\u3002</li> <li>Speedup \u968f\u7740 Window Size \u589e\u5927\u800c\u4e0a\u5347\uff0c\u5728 Window Size \u8fbe\u5230 64 \u540e\u8d8b\u4e8e\u7a33\u5b9a\uff0c\u7ef4\u6301\u5728\u7ea6 2.0x \u5de6\u53f3\u3002\u8fd9\u8868\u660e RnR \u7684\u6027\u80fd\u589e\u76ca\u5728\u7a97\u53e3\u5927\u5c0f\u8fbe\u5230\u4e00\u5b9a\u9608\u503c\u540e\u4e0d\u518d\u663e\u8457\u63d0\u5347\u3002</li> <li>Storage Overhead \u968f Window Size \u589e\u5927\u800c\u4e0b\u964d\uff0c\u4ece Window Size=1 \u65f6\u7684\u7ea6 25% \u4e0b\u964d\u81f3 Window Size=2048 \u65f6\u7684\u7ea6 10%\u3002\u8fd9\u662f\u56e0\u4e3a\u66f4\u5927\u7684\u7a97\u53e3\u610f\u5473\u7740\u66f4\u5c11\u7684\u7a97\u53e3\u5212\u5206\uff0c\u4ece\u800c\u51cf\u5c11 Window Division Table \u7684\u5143\u6570\u636e\u5b58\u50a8\u91cf\u3002</li> <li>\u5173\u952e\u89c2\u5bdf\uff1a\u5f53 Window Size \u5c0f\u4e8e 64 \u65f6\uff0cSpeedup \u663e\u8457\u964d\u4f4e\uff0c\u540c\u65f6 Storage Overhead \u6025\u5267\u4e0a\u5347\uff0c\u8bf4\u660e\u8fc7\u5c0f\u7684\u7a97\u53e3\u4f1a\u635f\u5bb3\u6027\u80fd\u5e76\u589e\u52a0\u5b58\u50a8\u8d1f\u62c5\u3002</li> <li>\u7efc\u5408\u6765\u770b\uff0cWindow Size \u5728 64 \u81f3 2048 \u8303\u56f4\u5185 \u662f\u6700\u4f18\u9009\u62e9\uff0c\u65e2\u80fd\u4fdd\u8bc1\u9ad8\u52a0\u901f\u6bd4\uff0c\u53c8\u80fd\u63a7\u5236\u5b58\u50a8\u5f00\u9500\u5728\u5408\u7406\u6c34\u5e73\u3002</li> </ul> Window Size Speedup (approx.) Storage Overhead (approx.) 1 1.0x 25% 4 1.3x 20% 16 1.5x 15% 64 2.0x 12% 256 2.0x 10% 1024 2.0x 10% 2048 2.0x 10% <ul> <li>\u8be5\u56fe\u8868\u9a8c\u8bc1\u4e86\u8bba\u6587\u4e2d\u5173\u4e8e Window Size \u9009\u62e9\u7b56\u7565 \u7684\u7ed3\u8bba\uff1a\u4e0d\u5e94\u5c0f\u4e8e 64\uff0c\u4e14\u5728 64 \u81f3 2048 \u4e4b\u95f4\u6027\u80fd\u4e0e\u5b58\u50a8\u5f00\u9500\u8fbe\u5230\u6700\u4f73\u5e73\u8861\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/figs_notes/#table-iv-comparison-to-other-irregular-hardware-prefetchers","title":"TABLE IV COMPARISON TO OTHER IRREGULAR HARDWARE PREFETCHERS.","text":"<ul> <li>RnR (Proposed) \u9488\u5bf9\u5177\u6709\u91cd\u590d\u6a21\u5f0f\u7684\u5e94\u7528\uff0c\u5982\u8fed\u4ee3\u6c42\u89e3\u5668\u548c\u56fe\u7b97\u6cd5\u5185\u6838\u3002\u5176\u9884\u53d6\u76ee\u6807\u7531\u8f6f\u4ef6\u5b9a\u4e49\uff0c\u901a\u8fc7\u201c\u8bb0\u5f55\u4e0e\u91cd\u653e\u201d\u673a\u5236\u751f\u6210\u9884\u53d6\u5730\u5740\uff0c\u89e6\u53d1\u65f6\u673a\u4f9d\u8d56\u4e8e\u8f6f\u4ef6\u8f85\u52a9\u7684\u91cd\u653e\u65f6\u5e8f\u63a7\u5236\u673a\u5236\u3002\u7cfb\u7edf\u5f00\u9500\u65b9\u9762\uff0c\u786c\u4ef6\u90e8\u5206\u5c0f\u4e8e1KB\uff0c\u8f6f\u4ef6\u63a5\u53e3\u8f7b\u91cf\uff0c\u5b58\u50a8\u5f00\u9500\u7ea6\u4e3a\u8f93\u5165\u6570\u636e\u768412%\u3002</li> <li>DROPLET [10] \u4e13\u6ce8\u4e8e\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee\uff0c\u5982\u56fe\u7b97\u6cd5\u3002\u9884\u53d6\u5bf9\u8c61\u4e3a\u8fb9\u6570\u636e\u548c\u9876\u70b9\u6570\u636e\uff0c\u5730\u5740\u57fa\u4e8e\u4f9d\u8d56\u5173\u7cfb\u8ba1\u7b97\uff0c\u89e6\u53d1\u65f6\u673a\u4e3a\u8fb9\u6570\u636e\u8bbf\u95ee\u6216\u56de\u586b\u3002\u786c\u4ef6\u5f00\u9500\u4e3a12KB\uff0c\u8f6f\u4ef6\u63a5\u53e3\u8f7b\u91cf\u3002</li> <li>IMP [60] \u540c\u6837\u9488\u5bf9\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee\uff0c\u9002\u7528\u4e8e\u5305\u542bSpMV\u5185\u6838\u6216\u56fe\u7b97\u6cd5\u7684\u5e94\u7528\u3002\u9884\u53d6\u5bf9\u8c61\u4e3a\u7d22\u5f15\u548c\u95f4\u63a5\u6570\u636e\uff0c\u5730\u5740\u57fa\u4e8e\u4f9d\u8d56\u5173\u7cfb\u8ba1\u7b97\uff0c\u89e6\u53d1\u65f6\u673a\u4e3a\u7d22\u5f15\u6570\u636e\u8bbf\u95ee\u3002\u786c\u4ef6\u5f00\u9500\u4e3a0.7KB\u3002</li> <li>Bingo [9] \u7528\u4e8e\u91cd\u590d\u7a7a\u95f4\u6a21\u5f0f\uff0c\u5982OLTP\u548cDSS\u3002\u65e0\u7279\u5b9a\u9884\u53d6\u7ed3\u6784\u7ea6\u675f\uff0c\u5730\u5740\u57fa\u4e8e\u5386\u53f2\u9884\u6d4b\uff0c\u89e6\u53d1\u65f6\u673a\u4e3a\u7f13\u5b58\u8bbf\u95ee\u3002\u786c\u4ef6\u5f00\u9500\u4e3a119KB\u3002</li> <li>MISB [59] \u7528\u4e8e\u91cd\u590d\u65f6\u95f4\u6a21\u5f0f\uff0c\u5982\u6570\u636e\u5e93\u548c\u7f13\u5b58\u3002\u65e0\u7279\u5b9a\u9884\u53d6\u7ed3\u6784\u7ea6\u675f\uff0c\u5730\u5740\u57fa\u4e8e\u5386\u53f2\u9884\u6d4b\uff0c\u89e6\u53d1\u65f6\u673a\u4e3a\u7f13\u5b58\u672a\u547d\u4e2d\u3002\u786c\u4ef6\u5f00\u9500\u4e3a49KB\uff0c\u5b58\u50a8\u5f00\u9500\u4e3a\u8f93\u5165\u6570\u636e\u76848%\u3002</li> </ul> Prefetcher Design Prefetching Target Properties and Applications What Structure to Prefetch How to Generate Prefetch Addresses When to Prefetch System Overhead RnR (Proposed) Repeating patterns, e.g., iterative solver, iterative graph kernel Defined by software Record and replay Software assist, replay timing control mechanism Hardware: less than 1KBSoftware: light interfaceStorage: 12% input DROPLET [10] Indirect memory access, e.g., graph algorithms Edge and vertex data Compute based on dependency Edge access or refill Hardware: 12KBSoftware: light interface IMP [60] Indirect memory access, e.g., applications with SpMV kernel, graph algorithms Index and indirect data Compute based on dependency Index data access Hardware: 0.7KB Bingo [9] Repeating spatial patterns, e.g., OLTP, DSS No constraint Predict based on history Cache access Hardware: 119KB MISB [59] Repeating temporal patterns, e.g., database, caching No constraint Predict based on history Cache miss Hardware: 49KBStorage: 8% input <ul> <li>\u5173\u952e\u5bf9\u6bd4\uff1aRnR \u7684\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u5176\u8f6f\u4ef6\u8f85\u52a9\u7684\u8bb0\u5f55\u4e0e\u91cd\u653e\u673a\u5236\uff0c\u80fd\u591f\u7cbe\u51c6\u6355\u6349\u91cd\u590d\u7684\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4ece\u800c\u5b9e\u73b0\u9ad8\u51c6\u786e\u7387\u548c\u8986\u76d6\u7387\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5176\u4ed6\u9884\u53d6\u5668\u591a\u4f9d\u8d56\u5386\u53f2\u9884\u6d4b\uff0c\u96be\u4ee5\u5904\u7406\u590d\u6742\u6216\u76f8\u4f3c\u7684\u8bbf\u95ee\u5e8f\u5217\u3002\u6b64\u5916\uff0cRnR \u7684\u786c\u4ef6\u5f00\u9500\u6781\u4f4e\uff08&lt;1KB\uff09\uff0c\u800c MISB \u548c Bingo \u5206\u522b\u9700\u8981 49KB \u548c 119KB \u7684\u786c\u4ef6\u8d44\u6e90\u3002</li> <li>\u5b58\u50a8\u5f00\u9500\uff1aRnR \u7684\u5b58\u50a8\u5f00\u9500\u4e3a\u8f93\u5165\u6570\u636e\u768412%\uff0c\u9ad8\u4e8e MISB \u76848%\uff0c\u4f46\u663e\u8457\u4f4e\u4e8e Bingo \u7684119KB \u786c\u4ef6\u5f00\u9500\u3002\u8fd9\u8868\u660e RnR \u5728\u4fdd\u6301\u9ad8\u6027\u80fd\u7684\u540c\u65f6\uff0c\u5b9e\u73b0\u4e86\u5408\u7406\u7684\u8d44\u6e90\u5e73\u8861\u3002</li> <li>\u89e6\u53d1\u673a\u5236\uff1aRnR \u7684\u89e6\u53d1\u65f6\u673a\u7531\u8f6f\u4ef6\u63a7\u5236\uff0c\u7ed3\u5408\u91cd\u653e\u65f6\u5e8f\u63a7\u5236\u673a\u5236\uff0c\u786e\u4fdd\u9884\u53d6\u7684\u53ca\u65f6\u6027\u3002\u800c\u5176\u4ed6\u9884\u53d6\u5668\u591a\u4f9d\u8d56\u7f13\u5b58\u8bbf\u95ee\u6216\u672a\u547d\u4e2d\u4e8b\u4ef6\uff0c\u53ef\u80fd\u5bfc\u81f4\u9884\u53d6\u8fc7\u65e9\u6216\u8fc7\u665a\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/","title":"RnR: A Software-Assisted Record-and-Replay Hardware Prefetcher \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Chao Zhang (Lehigh University) - Yuan Zeng (Lehigh University) - John Shalf (Lawrence Berkeley National Lab) - Xiaochen Guo (Lehigh University)</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - \u8be5\u8bba\u6587\u672a\u5728\u63d0\u4f9b\u7684\u6587\u672c\u4e2d\u660e\u786e\u6307\u51fa\u5176\u53d1\u8868\u7684\u671f\u520a\u6216\u4f1a\u8bae\u540d\u79f0\u3002</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - \u8be5\u8bba\u6587\u672a\u5728\u63d0\u4f9b\u7684\u6587\u672c\u4e2d\u660e\u786e\u6307\u51fa\u5176\u53d1\u8868\u5e74\u4efd\u3002</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u5177\u6709\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff08irregular memory access patterns\uff09\u7684\u5e94\u7528\u7a0b\u5e8f\u96be\u4ee5\u4ece\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u4e2d\u53d7\u76ca\u7684\u95ee\u9898\u3002\u8fd9\u7c7b\u5e94\u7528\uff08\u5982\u56fe\u7b97\u6cd5\u3001\u8fed\u4ee3\u6c42\u89e3\u5668\uff09\u901a\u5e38\u5177\u6709\u9ad8\u7f13\u5b58\u7f3a\u5931\u7387\u548c\u957f\u5185\u5b58\u5ef6\u8fdf\uff0c\u5bfc\u81f4\u5904\u7406\u5668\u505c\u987f\u3002 - \u514b\u670d\u73b0\u6709\u65b9\u6848\u7684\u5c40\u9650\u6027\uff1a   - \u8f6f\u4ef6\u9884\u53d6\u5668\u4f1a\u5f15\u5165\u989d\u5916\u7684\u6307\u4ee4\u5f00\u9500\u3002   - \u786c\u4ef6\u9884\u53d6\u5668\u96be\u4ee5\u9ad8\u6548\u3001\u51c6\u786e\u5730\u9884\u6d4b\u957f\u4e14\u590d\u6742\u7684\u4e0d\u89c4\u5219\u8bbf\u95ee\u5e8f\u5217\u3002 - \u9488\u5bf9\u4e00\u7c7b\u5173\u952e\u573a\u666f\uff1a\u8bb8\u591a\u91cd\u8981\u5e94\u7528\uff08\u5982PageRank\u3001\u7a00\u758f\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5 SpMV\uff09\u7684\u5185\u5b58\u8bbf\u95ee\u5e8f\u5217\u5728\u591a\u6b21\u8fed\u4ee3\u6216\u7a0b\u5e8f\u9636\u6bb5\u4e2d\u4f1a\u91cd\u590d\u51fa\u73b0\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa\u4e00\u79cd\u8f6f\u4ef6\u8f85\u52a9\u7684\u8bb0\u5f55\u4e0e\u56de\u653e\uff08Record-and-Replay, RnR\uff09\u786c\u4ef6\u9884\u53d6\u5668\u3002 - \u6838\u5fc3\u601d\u60f3\u662f\u5229\u7528\u7a0b\u5e8f\u5458\u7684\u5148\u9a8c\u77e5\u8bc6\uff0c\u901a\u8fc7\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u7f16\u7a0b\u63a5\u53e3\uff0c\u7cbe\u786e\u63a7\u5236\u786c\u4ef6\u9884\u53d6\u5668\u7684\u884c\u4e3a\u3002 - \u5177\u4f53\u5b9e\u73b0\u5305\u542b\u4ee5\u4e0b\u5173\u952e\u7ec4\u4ef6\uff1a   - \u8f7b\u91cf\u7ea7\u7f16\u7a0b\u63a5\u53e3\uff1a\u5141\u8bb8\u7a0b\u5e8f\u5458\u5728\u5e94\u7528\u4ee3\u7801\u4e2d\u6307\u5b9a\uff1a     - \u54ea\u4e9b\u6570\u636e\u7ed3\u6784\u5177\u6709\u4e0d\u89c4\u5219\u7684\u91cd\u590d\u8bbf\u95ee\u6a21\u5f0f\u3002     - \u4f55\u65f6\u5f00\u59cb\u8bb0\u5f55\uff08Record\uff09\u9996\u6b21\u51fa\u73b0\u7684\u7f13\u5b58\u7f3a\u5931\u5e8f\u5217\u3002     - \u4f55\u65f6\u5f00\u59cb\u56de\u653e\uff08Replay\uff09\u4ee5\u8fdb\u884c\u9884\u53d6\u3002   - \u8bb0\u5f55\u9636\u6bb5\uff08Record\uff09\uff1a     - \u5728\u9996\u6b21\u8fed\u4ee3\u4e2d\uff0c\u4ec5\u8bb0\u5f55\u9488\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u79c1\u6709L2\u7f13\u5b58\u7f3a\u5931\u5730\u5740\u5e8f\u5217\u3002     - \u540c\u65f6\u8bb0\u5f55\u65f6\u95f4\u4fe1\u606f\uff08timing information\uff09\uff0c\u5373\u6bcf\u4e2a\u9884\u53d6\u7a97\u53e3\u5185\u7684\u603b\u9700\u6c42\u8bbf\u95ee\u6b21\u6570\uff0c\u7528\u4e8e\u540e\u7eed\u63a7\u5236\u56de\u653e\u8282\u594f\u3002   - \u56de\u653e\u9636\u6bb5\uff08Replay\uff09\uff1a     - \u5728\u540e\u7eed\u91cd\u590d\u8fed\u4ee3\u4e2d\uff0c\u786c\u4ef6\u9884\u53d6\u5668\u6839\u636e\u8bb0\u5f55\u7684\u5e8f\u5217\u4e3b\u52a8\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\u3002     - \u91c7\u7528\u57fa\u4e8e\u7a97\u53e3\u7684\u56de\u653e\u65f6\u673a\u63a7\u5236\u673a\u5236\uff08Replay Timing Control\uff09\uff0c\u901a\u8fc7\u5339\u914d\u7a0b\u5e8f\u6267\u884c\u8fdb\u5ea6\uff08\u7531\u9700\u6c42\u8bbf\u95ee\u8ba1\u6570\u9a71\u52a8\uff09\u6765\u52a8\u6001\u8c03\u6574\u9884\u53d6\u7684\u6fc0\u8fdb\u7a0b\u5ea6\uff0c\u786e\u4fdd\u6570\u636e\u5728\u9700\u8981\u65f6\u5df2\u5728\u7f13\u5b58\u4e2d\uff0c\u907f\u514d\u8fc7\u65e9\u9884\u53d6\u88ab\u9a71\u9010\u6216\u8fc7\u665a\u9884\u53d6\u65e0\u6cd5\u9690\u85cf\u5ef6\u8fdf\u3002   - \u4e0e\u5176\u4ed6\u9884\u53d6\u5668\u534f\u540c\uff1aRnR\u4e13\u6ce8\u4e8e\u4e0d\u89c4\u5219\u6a21\u5f0f\uff0c\u800c\u5e38\u89c4\u7684\u6d41\u5f0f\u6216\u6b65\u957f\u9884\u53d6\u5668\u53ef\u7ee7\u7eed\u5904\u7406\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4e8c\u8005\u4e92\u4e0d\u5e72\u6270\u3002</p> <p></p> <p>Fig. 2. Motivation and key idea of the RnR prefetcher.</p> <p>\u7ed3\u679c - \u5728\u4e09\u4e2a\u4e0d\u89c4\u5219\u5de5\u4f5c\u8d1f\u8f7d\uff08PageRank, Hyper-Anf, spCG\uff09\u4e0a\u8bc4\u4f30\uff0cRnR\u9884\u53d6\u5668\u5c55\u73b0\u51fa\u5353\u8d8a\u6027\u80fd\u3002 - \u6027\u80fd\u63d0\u5347\uff1a   - \u5bf9\u56fe\u5e94\u7528\u5e73\u5747\u5b9e\u73b0 2.16\u500d \u52a0\u901f\u3002   - \u5bf9\u5305\u542bSpMV\u5185\u6838\u7684\u8fed\u4ee3\u6c42\u89e3\u5668\uff08spCG\uff09\u5b9e\u73b0 2.91\u500d \u52a0\u901f\u3002 - \u9884\u53d6\u6548\u7387\uff1a   - \u9884\u53d6\u51c6\u786e\u7387\uff08Prefetching Accuracy\uff09\u8d85\u8fc7 95%\u3002   - \u7f3a\u5931\u8986\u76d6\u7387\uff08Miss Coverage\uff09\u540c\u6837\u8d85\u8fc7 95%\u3002 - \u4e0e\u5176\u4ed6\u9884\u53d6\u5668\u5bf9\u6bd4\uff1a   - RnR\u5728\u6240\u6709\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u5747\u4f18\u4e8eNext-line\u3001Bingo\u3001SteMS\u7b49\u901a\u7528\u9884\u53d6\u5668\u4ee5\u53ca\u4e13\u4e3a\u56fe\u8bbe\u8ba1\u7684DROPLET\u9884\u53d6\u5668\uff0c\u5c24\u5176\u5728\u968f\u673a\u8fde\u63a5\u56fe\uff08\u5982urand\uff09\u4e0a\u4f18\u52bf\u5de8\u5927\u3002</p> \u9884\u53d6\u5668\u7c7b\u578b PageRank (\u5e73\u5747) Hyper-Anf (\u5e73\u5747) spCG RnR 2.11\u00d7 2.23\u00d7 2.90\u00d7 <p></p> <p>Fig. 6. Speedup over no prefetcher baseline.</p> <p></p> <p>Fig. 9. Prefetcher accuracy.</p> <p>\u7ed3\u8bba - RnR\u9884\u53d6\u5668\u901a\u8fc7\u8f6f\u4ef6\u8f85\u52a9\u7684\u65b9\u5f0f\uff0c\u6210\u529f\u89e3\u51b3\u4e86\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u5728\u5904\u7406\u957f\u91cd\u590d\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u65f6\u7684\u51c6\u786e\u6027\u548c\u65f6\u6548\u6027\u96be\u9898\u3002 - \u5176\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u5c06\u7a0b\u5e8f\u5458\u5bf9\u5e94\u7528\u8bed\u4e49\u7684\u7406\u89e3\uff08\u5982\u8fed\u4ee3\u8fb9\u754c\u3001\u76ee\u6807\u6570\u636e\u7ed3\u6784\uff09\u4e0e\u786c\u4ef6\u7684\u9ad8\u6548\u6267\u884c\u80fd\u529b\u76f8\u7ed3\u5408\uff0c\u5b9e\u73b0\u4e86\u63a5\u8fd1\u5b8c\u7f8e\u7684\u9884\u53d6\u6548\u679c\u3002 - \u8be5\u8bbe\u8ba1\u5177\u6709\u4f4e\u786c\u4ef6\u5f00\u9500\uff08\u6bcf\u6838\u5c0f\u4e8e1KB\uff09\u3001\u826f\u597d\u7684\u53ef\u6269\u5c55\u6027\uff08\u9002\u7528\u4e8e\u591a\u6838\u7cfb\u7edf\uff09\u4ee5\u53ca\u6613\u4e8e\u96c6\u6210\uff08\u53ef\u4e0e\u5176\u4ed6\u9884\u53d6\u5668\u5171\u5b58\uff09\u7684\u7279\u70b9\uff0c\u4e3a\u63d0\u5347\u4e0d\u89c4\u5219\u5e94\u7528\u7684\u6027\u80fd\u63d0\u4f9b\u4e86\u4e00\u79cd\u9ad8\u6548\u4e14\u5b9e\u7528\u7684\u65b0\u8303\u5f0f\u3002</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f - \u73b0\u4ee3\u5904\u7406\u5668\u9762\u4e34\u5de8\u5927\u7684 processor-memory frequency gap\uff0c\u4f9d\u8d56\u7f13\u5b58\u6765\u7f13\u89e3\u5ef6\u8fdf\u3002 - \u5177\u6709\u826f\u597d\u5c40\u90e8\u6027\uff08good locality\uff09\u7684\u5e94\u7528\u80fd\u6709\u6548\u5229\u7528\u7f13\u5b58\u5c42\u6b21\u7ed3\u6784\uff0c\u800c\u8bb8\u591a\u91cd\u8981\u5e94\u7528\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u7a00\u758f\u77e9\u9635\u8fd0\u7b97\u3001\u63a8\u8350\u7cfb\u7edf\uff09\u5177\u6709\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff08irregular memory access patterns\uff09\uff0c\u5bfc\u81f4\u9ad8\u7f13\u5b58\u7f3a\u5931\u7387\u548c\u957f\u5ef6\u8fdf\uff0c\u4e25\u91cd\u62d6\u7d2f\u6027\u80fd\u3002 - \u786c\u4ef6\u9884\u53d6\u5668\uff08hardware prefetcher\uff09\u96be\u4ee5\u9ad8\u6548\u3001\u51c6\u786e\u5730\u9884\u6d4b\u957f\u4e14\u590d\u6742\u7684\u4e0d\u89c4\u5219\u8bbf\u95ee\u5e8f\u5217\uff1b\u800c\u8f6f\u4ef6\u9884\u53d6\u5668\uff08software prefetcher\uff09\u4f1a\u5f15\u5165\u989d\u5916\u7684\u6307\u4ee4\u5f00\u9500\uff0c\u5e76\u4e14\u96be\u4ee5\u7cbe\u786e\u628a\u63e1\u9884\u53d6\u65f6\u673a\u3002</p> <p>\u7814\u7a76\u52a8\u673a - \u8bb8\u591a\u91cd\u8981\u7684\u4e0d\u89c4\u5219\u5e94\u7528\uff08\u5982\u8fed\u4ee3\u6c42\u89e3\u5668\u3001\u56fe\u7b97\u6cd5\u3001\u7a00\u758f\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5 SpMV\uff09\u5728\u591a\u6b21\u8fed\u4ee3\u6216\u7a0b\u5e8f\u9636\u6bb5\u4e2d\uff0c\u5176\u5185\u5b58\u8bbf\u95ee\u5e8f\u5217\u662f\u91cd\u590d\u51fa\u73b0\u7684\u3002 - \u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982\u57fa\u4e8e\u5168\u5c40\u5386\u53f2\u7f13\u51b2\u533a GHB \u7684\u65f6\u5e8f\u9884\u53d6\u5668\u6216\u57fa\u4e8eOS\u9875\u9762\u7684\u7a7a\u95f4\u9884\u53d6\u5668\uff09\u65e0\u6cd5\u6709\u6548\u533a\u5206\u548c\u5904\u7406\u8fd9\u79cd\u6df7\u5408\u4e86\u89c4\u5219\u4e0e\u4e0d\u89c4\u5219\u8bbf\u95ee\u7684\u957f\u91cd\u590d\u6a21\u5f0f\uff0c\u5bfc\u81f4\u9884\u53d6\u51c6\u786e\u7387\uff08prefetching accuracy\uff09\u548c\u7f3a\u5931\u8986\u76d6\u7387\uff08miss coverage\uff09\u4f4e\u4e0b\u3002 - \u7a0b\u5e8f\u5458\u5bf9\u5e94\u7528\u7a0b\u5e8f\u7684\u91cd\u590d\u6a21\u5f0f\uff08\u4f55\u65f6\u5f00\u59cb/\u7ed3\u675f\u3001\u6d89\u53ca\u54ea\u4e9b\u6570\u636e\u7ed3\u6784\uff09\u62e5\u6709\u5148\u9a8c\u77e5\u8bc6\uff0c\u5982\u679c\u80fd\u5c06\u8fd9\u90e8\u5206\u77e5\u8bc6\u4f20\u9012\u7ed9\u786c\u4ef6\uff0c\u5c31\u80fd\u5b9e\u73b0\u8fd1\u4e4e\u5b8c\u7f8e\u7684\u9884\u53d6\u3002 - \u73b0\u6709\u9884\u53d6\u5668\u5e38\u56e0\u7f3a\u4e4f\u65f6\u5e8f\u4fe1\u606f\u800c\u53d1\u51fa\u8fc7\u65e9\u6216\u8fc7\u665a\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u5f71\u54cd\u6548\u679c\u3002</p> <p></p> <p>Fig. 2. Motivation and key idea of the RnR prefetcher.</p> <p>\u6838\u5fc3\u8d21\u732e - \u63d0\u51fa\u4e86\u4e00\u79cd\u8f6f\u786c\u4ef6\u534f\u540c\u7684 Record-and-Replay (RnR) \u786c\u4ef6\u9884\u53d6\u5668\uff0c\u4e13\u95e8\u9488\u5bf9\u5177\u6709\u957f\u91cd\u590d\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u5e94\u7528\u3002 - \u8bbe\u8ba1\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7f16\u7a0b\u63a5\u53e3\uff0c\u5141\u8bb8\u7a0b\u5e8f\u5458\u5728\u4ee3\u7801\u4e2d\u660e\u786e\u6307\u5b9a\uff1a   - \u54ea\u4e9b\u6570\u636e\u7ed3\u6784\u5177\u6709\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u3002   - \u5728\u54ea\u4e2a\u65f6\u95f4\u70b9\u5f00\u59cb\u8bb0\u5f55\uff08Record\uff09\u9996\u6b21\u51fa\u73b0\u7684\u7f13\u5b58\u7f3a\u5931\u5e8f\u5217\u3002   - \u5728\u54ea\u4e2a\u65f6\u95f4\u70b9\u5f00\u59cb\u56de\u653e\uff08Replay\uff09\u4ee5\u8fdb\u884c\u9884\u53d6\u3002 - \u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u56de\u653e\u65f6\u5e8f\u63a7\u5236\u673a\u5236\uff08Replay Timing Control\uff09\uff1a   - \u5728\u8bb0\u5f55\u9636\u6bb5\uff0c\u4e0d\u4ec5\u8bb0\u5f55\u7f3a\u5931\u5730\u5740\u5e8f\u5217\uff0c\u8fd8\u8bb0\u5f55\u6bcf\u4e2a\u9884\u53d6\u7a97\u53e3\uff08prefetch window\uff09\u5185\u7684\u7f3a\u5931\u6bd4\u7387\uff08miss ratio\uff09\u4f5c\u4e3a\u5143\u6570\u636e\u3002   - \u5728\u56de\u653e\u9636\u6bb5\uff0c\u6839\u636e\u8bb0\u5f55\u7684\u7f3a\u5931\u6bd4\u7387\u52a8\u6001\u8c03\u6574\u9884\u53d6\u7684\u6fc0\u8fdb\u7a0b\u5ea6\uff08aggressiveness\uff09\u548c\u9891\u7387\uff0c\u786e\u4fdd\u9884\u53d6\u6570\u636e\u80fd\u53ca\u65f6\u5230\u8fbe\u4e14\u4e0d\u4f1a\u56e0\u8fc7\u65e9\u9884\u53d6\u800c\u88ab\u9a71\u9010\u3002 - RnR\u9884\u53d6\u5668\u80fd\u4e0e\u73b0\u6709\u7684\u786c\u4ef6\u9884\u53d6\u5668\u5171\u5b58\uff0c\u901a\u8fc7\u8fc7\u6ee4\u6389\u7a0b\u5e8f\u5458\u6307\u5b9a\u7684\u533a\u57df\uff0c\u8ba9\u4f20\u7edf\u9884\u53d6\u5668\u4e13\u6ce8\u4e8e\u5904\u7406\u89c4\u5219\u6a21\u5f0f\uff0c\u4ece\u800c\u5b9e\u73b0\u4f18\u52bf\u4e92\u8865\u3002 - \u5b9e\u9a8c\u8bc4\u4f30\u8868\u660e\uff0c\u5bf9\u4e8e\u6240\u6d4b\u8bd5\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0cRnR\u9884\u53d6\u5668\u5e73\u5747\u53ef\u5b9e\u73b0 2.16\u500d\uff08\u56fe\u5e94\u7528\uff09\u548c 2.91\u500d\uff08\u8fed\u4ee3\u6c42\u89e3\u5668\uff09\u7684\u52a0\u901f\u6bd4\uff0c\u5e76\u80fd\u8fbe\u5230\u8d85\u8fc795%\u7684\u9884\u53d6\u51c6\u786e\u7387\u548c\u7f3a\u5931\u8986\u76d6\u7387\u3002</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>RnR (Record-and-Replay) \u662f\u4e00\u79cd\u8f6f\u4ef6\u8f85\u52a9\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u5176\u6838\u5fc3\u67b6\u6784\u56f4\u7ed5\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u8f6f\u786c\u4ef6\u534f\u540c\u63a5\u53e3\u5c55\u5f00\uff0c\u65e8\u5728\u9ad8\u6548\u5904\u7406\u5177\u6709\u957f\u91cd\u590d\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u5e94\u7528\u3002</p> <ul> <li>\u6838\u5fc3\u601d\u60f3: \u901a\u8fc7\u7a0b\u5e8f\u5458\u5728\u5e94\u7528\u4ee3\u7801\u4e2d\u663e\u5f0f\u6807\u8bb0\uff0c\u7cfb\u7edf\u5728\u9996\u6b21\u6267\u884c\u65f6\u8bb0\u5f55 (Record) \u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684 L2 \u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217\u53ca\u5176\u65f6\u5e8f\u4fe1\u606f\uff0c\u5e76\u5728\u540e\u7eed\u91cd\u590d\u6267\u884c\u9636\u6bb5\u56de\u653e (Replay) \u8be5\u5e8f\u5217\u4ee5\u8fdb\u884c\u7cbe\u51c6\u9884\u53d6\u3002</li> <li>\u76ee\u6807\u573a\u666f: \u4e3b\u8981\u9488\u5bf9\u8fed\u4ee3\u6c42\u89e3\u5668 (iterative solvers)\u3001\u56fe\u7b97\u6cd5 (graph algorithms) \u548c\u7a00\u758f\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5 (SpMV) \u7b49\u5e94\u7528\uff0c\u8fd9\u4e9b\u5e94\u7528\u5728\u591a\u6b21\u8fed\u4ee3\u4e2d\u4f1a\u91cd\u590d\u8bbf\u95ee\u76f8\u540c\u7684\u4e0d\u89c4\u5219\u5185\u5b58\u5730\u5740\u5e8f\u5217\u3002</li> </ul> <p>\u8f6f\u4ef6-\u786c\u4ef6\u63a5\u53e3\u4e0e\u63a7\u5236\u6d41</p> <p>RnR \u7684\u8fd0\u4f5c\u7531\u7a0b\u5e8f\u5458\u901a\u8fc7\u4e00\u7ec4 API \u63a7\u5236\uff0c\u8fd9\u4e9b API \u64cd\u4f5c\u4e00\u7cfb\u5217 per-core \u7684\u4e13\u7528\u5bc4\u5b58\u5668\u6765\u7ba1\u7406\u9884\u53d6\u5668\u7684\u72b6\u6001\u548c\u8303\u56f4\u3002</p> <ul> <li>\u5173\u952e\u5bc4\u5b58\u5668:<ul> <li>ASID \u5bc4\u5b58\u5668: \u7528\u4e8e\u6743\u9650\u68c0\u67e5\u3002</li> <li>\u8fb9\u754c\u68c0\u67e5\u5730\u5740\u5bc4\u5b58\u5668: \u5b9a\u4e49\u9700\u8981\u8bb0\u5f55/\u56de\u653e\u7684\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u865a\u62df\u5730\u5740\u8303\u56f4\u3002</li> <li>\u5e8f\u5217\u8868 (Sequence Table) \u57fa\u5730\u5740\u5bc4\u5b58\u5668: \u6307\u5411\u5b58\u50a8\u8bb0\u5f55\u7684\u7f13\u5b58\u672a\u547d\u4e2d\u5730\u5740\u5e8f\u5217\u7684\u5185\u5b58\u533a\u57df\u3002</li> <li>\u7a97\u53e3\u5212\u5206\u8868 (Window Division Table) \u57fa\u5730\u5740\u5bc4\u5b58\u5668: \u6307\u5411\u5b58\u50a8\u65f6\u5e8f\u4fe1\u606f\uff08\u6bcf\u4e2a\u7a97\u53e3\u5185\u7684\u603b\u9700\u6c42\u8bbf\u95ee\u6b21\u6570\uff09\u7684\u5185\u5b58\u533a\u57df\u3002</li> <li>\u9884\u53d6\u72b6\u6001\u5bc4\u5b58\u5668: \u63a7\u5236 RnR \u7684\u5de5\u4f5c\u72b6\u6001\uff08\u521d\u59cb\u5316\u3001\u8bb0\u5f55\u3001\u56de\u653e\u3001\u6682\u505c\u3001\u7ed3\u675f\uff09\u3002</li> </ul> </li> <li>API \u8c03\u7528\u6d41\u7a0b:<ul> <li><code>RnR.init()</code>: \u521d\u59cb\u5316\u5185\u90e8\u53c2\u6570\u5e76\u5206\u914d\u5143\u6570\u636e\u5185\u5b58\u3002</li> <li><code>RnR.AddrBase.set(...)</code>: \u8bbe\u7f6e\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u5730\u5740\u8303\u56f4\u3002</li> <li><code>RnR.AddrBase.enable(...)</code> / <code>disable(...)</code>: \u542f\u7528\u6216\u7981\u7528\u7279\u5b9a\u5730\u5740\u8303\u56f4\u7684\u8bb0\u5f55/\u56de\u653e\u3002</li> <li><code>RnR.PrefetchState.start()</code>: \u5f00\u59cb\u8bb0\u5f55\u9636\u6bb5\u3002</li> <li><code>RnR.PrefetchState.replay()</code>: \u7ed3\u675f\u8bb0\u5f55\u5e76\u5f00\u59cb\u56de\u653e\uff08\u9884\u53d6\uff09\u9636\u6bb5\u3002</li> <li><code>RnR.end()</code>: \u7ec8\u6b62\u6574\u4e2a RnR \u8fc7\u7a0b\u5e76\u91ca\u653e\u5143\u6570\u636e\u5185\u5b58\u3002</li> </ul> </li> <li>\u72b6\u6001\u673a: RnR \u9884\u53d6\u5668\u6839\u636e\u8f6f\u4ef6\u8bbe\u7f6e\u7684\u72b6\u6001\u5bc4\u5b58\u5668\uff0c\u5728 Record\u3001Replay\u3001Pause \u7b49\u72b6\u6001\u95f4\u8f6c\u6362\uff0c\u4ee5\u652f\u6301\u4e0a\u4e0b\u6587\u5207\u6362\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e8b\u4ef6\u3002</li> </ul> <p></p> <p>Fig. 3. State transition diagram of the RnR prefetch state.</p> <p>\u8bb0\u5f55 (Record) \u9636\u6bb5\u67b6\u6784</p> <p>\u6b64\u9636\u6bb5\u53d1\u751f\u5728\u76ee\u6807\u6a21\u5f0f\u7684\u9996\u6b21\u6267\u884c\u65f6\uff0c\u786c\u4ef6\u8d1f\u8d23\u6355\u83b7\u5e76\u5b58\u50a8\u5fc5\u8981\u7684\u4fe1\u606f\u3002</p> <ul> <li>\u8fc7\u6ee4\u673a\u5236: \u4ec5\u5f53 L2 \u7f13\u5b58\u672a\u547d\u4e2d\u7684\u8bf7\u6c42\u843d\u5728\u7a0b\u5e8f\u5458\u6307\u5b9a\u7684\u5730\u5740\u8303\u56f4\u5185\u65f6\uff0c\u624d\u4f1a\u88ab\u8bb0\u5f55\u3002\u8fd9\u907f\u514d\u4e86\u8bb0\u5f55\u5177\u6709\u826f\u597d\u5c40\u90e8\u6027\u7684\u5e38\u89c4\u8bbf\u95ee\u3002</li> <li>\u8bb0\u5f55\u5185\u5bb9:<ul> <li>\u5e8f\u5217\u8868: \u5b58\u50a8\u8fc7\u6ee4\u540e\u7684 L2 \u672a\u547d\u4e2d\u7269\u7406\u5730\u5740\u5e8f\u5217\u3002</li> <li>\u7a97\u53e3\u5212\u5206\u8868: \u5c06\u8bb0\u5f55\u8fc7\u7a0b\u5212\u5206\u4e3a\u56fa\u5b9a\u5927\u5c0f\u7684\u7a97\u53e3 (window)\uff0c\u5e76\u8bb0\u5f55\u6bcf\u4e2a\u7a97\u53e3\u5185\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u603b\u9700\u6c42\u8bbf\u95ee\u6b21\u6570\u3002\u8fd9\u4e2a\u6bd4\u7387\uff08\u672a\u547d\u4e2d\u6570/\u603b\u8bbf\u95ee\u6570\uff09\u662f\u540e\u7eed\u56de\u653e\u65f6\u63a7\u5236\u9884\u53d6\u901f\u5ea6\u7684\u5173\u952e\u3002</li> </ul> </li> <li>\u5143\u6570\u636e\u5199\u5165\u4f18\u5316: \u4e3a\u4e86\u51cf\u5c11\u5f00\u9500\uff0c\u5143\u6570\u636e\u5199\u5165\u91c7\u7528\u975e\u4e34\u65f6\u5b58\u50a8 (non-temporal stores) \u5e76\u4ee5 cache line (64B) \u4e3a\u5355\u4f4d\u8fdb\u884c\u6279\u5904\u7406\u3002\u4f7f\u7528\u4e00\u4e2a 4MB \u9875\u9762\u7f13\u51b2\u533a\u6765\u6700\u5c0f\u5316 TLB \u67e5\u627e\u6b21\u6570\u3002</li> </ul> <p>\u56de\u653e (Replay) \u9636\u6bb5\u67b6\u6784</p> <p>\u5728\u6b64\u9636\u6bb5\uff0cRnR \u5229\u7528\u8bb0\u5f55\u7684\u4fe1\u606f\u4e3b\u52a8\u53d1\u8d77\u9884\u53d6\uff0c\u4ee5\u9690\u85cf\u5185\u5b58\u5ef6\u8fdf\u3002</p> <ul> <li>\u5143\u6570\u636e\u9884\u53d6: \u5e8f\u5217\u8868\u548c\u7a97\u53e3\u5212\u5206\u8868\u672c\u8eab\u5177\u6709\u6d41\u5f0f\u8bbf\u95ee\u6a21\u5f0f\uff0c\u56e0\u6b64\u53ef\u4ee5\u88ab\u9ad8\u6548\u5730\u9884\u53d6\u5230\u786c\u4ef6\u5185\u90e8\u7684 128B \u53cc\u7f13\u51b2\u533a\u4e2d\u3002</li> <li>\u9884\u53d6\u76ee\u6807: \u9884\u53d6\u7684\u6570\u636e\u88ab\u76f4\u63a5\u653e\u5165 private L2 cache\uff0c\u4ee5\u907f\u514d\u6c61\u67d3\u5171\u4eab\u7684 LLC\u3002</li> <li>\u4e0e\u73b0\u6709\u9884\u53d6\u5668\u5171\u5b58: RnR \u4f1a\u5c06\u76ee\u6807\u5730\u5740\u8303\u56f4\u4ece\u5e38\u89c4\u7684\u6d41\u5f0f\u9884\u53d6\u5668 (stream prefetcher) \u4e2d\u6392\u9664\uff0c\u8ba9\u5e38\u89c4\u9884\u53d6\u5668\u4e13\u6ce8\u4e8e\u5904\u7406\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5b9e\u73b0\u4f18\u52bf\u4e92\u8865\u3002</li> </ul> <p></p> <p>Fig. 4. RnR system architecture.</p> <p>\u56de\u653e\u65f6\u5e8f\u63a7\u5236\u673a\u5236 (Replay Timing Control)</p> <p>\u8fd9\u662f RnR \u67b6\u6784\u7684\u5173\u952e\u521b\u65b0\uff0c\u786e\u4fdd\u9884\u53d6\u65e2\u4e0d\u8fc7\u65e9\uff08\u5bfc\u81f4\u6570\u636e\u88ab\u9a71\u9010\uff09\u4e5f\u4e0d\u8fc7\u665a\uff08\u65e0\u6cd5\u9690\u85cf\u5ef6\u8fdf\uff09\u3002</p> <ul> <li>\u57fa\u4e8e\u7a97\u53e3\u7684\u8282\u594f\u5339\u914d: \u56de\u653e\u9636\u6bb5\uff0c\u786c\u4ef6\u4f1a\u76d1\u63a7\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u5f53\u524d\u9700\u6c42\u8bbf\u95ee\u8ba1\u6570 (Cur Struct Read)\u3002</li> <li>\u52a8\u6001\u8c03\u6574\u9884\u53d6\u4fb5\u7565\u6027: \u5f53\u5f53\u524d\u7a97\u53e3\u7684\u9700\u6c42\u8bbf\u95ee\u8ba1\u6570\u8fbe\u5230\u8bb0\u5f55\u503c\u65f6\uff0cRnR \u77e5\u9053\u8be5\u7a97\u53e3\u7684\u8ba1\u7b97\u5373\u5c06\u5b8c\u6210\uff0c\u5e76\u51c6\u5907\u9884\u53d6\u4e0b\u4e00\u4e2a\u7a97\u53e3\u7684\u6570\u636e\u3002</li> <li>\u7a97\u53e3\u5185\u5747\u5300\u5206\u53d1: \u4e3a\u4e86\u51cf\u5c11\u4e0e\u9700\u6c42\u8bbf\u95ee\u7684\u4e89\u7528\uff0c\u9884\u53d6\u8bf7\u6c42\u4f1a\u5728\u7a97\u53e3\u5185\u5747\u5300\u5206\u53d1\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a\u7a97\u53e3\u6709 6 \u6b21\u9700\u6c42\u8bbf\u95ee\u548c 2 \u6b21\u9884\u53d6\uff0c\u5219\u6bcf 3 \u6b21\u9700\u6c42\u8bbf\u95ee\u540e\u53d1\u8d77\u4e00\u6b21\u9884\u53d6\u3002</li> </ul> <p></p> <p>Fig. 5. Prefetching timing control example with window size = 3.</p> <p>\u53ef\u6269\u5c55\u6027\u4e0e\u5f00\u9500</p> <ul> <li>\u591a\u6838\u6269\u5c55: \u6240\u6709\u786c\u4ef6\u72b6\u6001\uff08\u5bc4\u5b58\u5668\u3001\u7f13\u51b2\u533a\uff09\u5747\u4e3a per-core \u8bbe\u8ba1\uff0c\u56e0\u6b64\u786c\u4ef6\u5f00\u9500\u968f\u6838\u5fc3\u6570\u7ebf\u6027\u589e\u957f\uff0c\u4f46\u603b\u91cf\u5f88\u5c0f\uff08&lt;1KB/core\uff09\u3002</li> <li>\u5b58\u50a8\u5f00\u9500: \u5143\u6570\u636e\uff08\u4e3b\u8981\u662f\u5e8f\u5217\u8868\uff09\u5b58\u50a8\u5728\u4e3b\u5b58\u4e2d\uff0c\u5176\u5927\u5c0f\u4e0e\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684 L2 \u672a\u547d\u4e2d\u6b21\u6570\u6210\u6b63\u6bd4\u3002\u5bf9\u4e8e\u8bc4\u4f30\u7684\u5e94\u7528\uff0c\u5e73\u5747\u5b58\u50a8\u5f00\u9500\u7ea6\u4e3a\u8f93\u5165\u6570\u636e\u96c6\u5927\u5c0f\u7684 12.1%\u3002</li> </ul> <p></p> <p>Fig. 13. Metadata storage overhead of sequence table and window division table (normalized to input dataset sizes).</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301: \u5728\u4e0a\u4e0b\u6587\u5207\u6362\u6216\u8fdb\u7a0b\u8fc1\u79fb\u65f6\uff0cRnR \u7684\u5c11\u91cf\u67b6\u6784\u72b6\u6001\uff08\u7ea6 86.5B\uff09\u53ef\u4ee5\u88ab\u4fdd\u5b58\u548c\u6062\u590d\uff0c\u800c\u5143\u6570\u636e\u672c\u8eab\u4f4d\u4e8e\u5806\u5185\u5b58\u4e2d\uff0c\u65e0\u9700\u91cd\u65b0\u8bad\u7ec3\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#1-record-and-replay","title":"1. \u8f6f\u4ef6\u8f85\u52a9\u7684\u8bb0\u5f55\u4e0e\u56de\u653e\uff08Record-and-Replay\uff09\u673a\u5236","text":"<p>\u6838\u5fc3\u673a\u5236\u4e0e\u5b9e\u73b0\u539f\u7406</p> <p>RnR (Record-and-Replay) \u9884\u53d6\u5668\u7684\u6838\u5fc3\u601d\u60f3\u662f\u5229\u7528\u5e94\u7528\u7a0b\u5e8f\u4e2d\u666e\u904d\u5b58\u5728\u7684\u91cd\u590d\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff08\u4f8b\u5982\u8fed\u4ee3\u6c42\u89e3\u5668\u3001\u56fe\u7b97\u6cd5\u4e2d\u7684\u591a\u6b21\u8fed\u4ee3\uff09\uff0c\u901a\u8fc7\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u8f6f\u4ef6-\u786c\u4ef6\u534f\u540c\u63a5\u53e3\uff0c\u5c06\u9996\u6b21\u6267\u884c\u65f6\u7684\u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217\u7cbe\u786e\u8bb0\u5f55\u4e0b\u6765\uff0c\u5e76\u5728\u540e\u7eed\u91cd\u590d\u6267\u884c\u65f6\u76f4\u63a5\u56de\u653e\u8be5\u5e8f\u5217\u8fdb\u884c\u9884\u53d6\uff0c\u4ece\u800c\u7ed5\u8fc7\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u96be\u4ee5\u9884\u6d4b\u957f\u4e14\u590d\u6742\u4e0d\u89c4\u5219\u6a21\u5f0f\u7684\u96be\u9898\u3002</p> <ul> <li>\u8f6f\u4ef6\u8f85\u52a9\u7684\u5173\u952e\u4f5c\u7528\uff1a\u7a0b\u5e8f\u5458\u901a\u8fc7\u63d0\u4f9b\u7684\u7f16\u7a0b\u63a5\u53e3\uff0c\u663e\u5f0f\u5730\u544a\u77e5\u786c\u4ef6\u9884\u53d6\u5668\u4e09\u4e2a\u5173\u952e\u4fe1\u606f\uff1a<ul> <li>\u54ea\u4e9b\u6570\u636e\u7ed3\u6784\u5177\u6709\u91cd\u590d\u7684\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\uff08\u5b9a\u4e49\u7a7a\u95f4\u533a\u57df\uff09\u3002</li> <li>\u4f55\u65f6\u5f00\u59cb\u8bb0\u5f55\uff08\u901a\u5e38\u5728\u7b2c\u4e00\u6b21\u8fed\u4ee3\u5f00\u59cb\u65f6\uff09\u3002</li> <li>\u4f55\u65f6\u5f00\u59cb\u56de\u653e\uff08\u9884\u53d6\uff0c\u901a\u5e38\u5728\u540e\u7eed\u8fed\u4ee3\u5f00\u59cb\u65f6\uff09\u3002</li> </ul> </li> <li>\u8bb0\u5f55\u5185\u5bb9\uff1aRnR \u5e76\u975e\u8bb0\u5f55\u6240\u6709\u5185\u5b58\u8bbf\u95ee\uff0c\u800c\u662f\u9009\u62e9\u6027\u5730\u8bb0\u5f55\u79c1\u6709 L2 \u7f13\u5b58\u7684\u672a\u547d\u4e2d\u5730\u5740\u5e8f\u5217\u3002\u8fd9\u8fc7\u6ee4\u6389\u4e86\u80fd\u88ab L1/L2 \u7f13\u5b58\u547d\u4e2d\u7684\u5177\u6709\u5c40\u90e8\u6027\u7684\u8bbf\u95ee\uff0c\u53ea\u5173\u6ce8\u771f\u6b63\u9700\u8981\u4ece\u5185\u5b58\u83b7\u53d6\u7684\u6570\u636e\uff0c\u63d0\u9ad8\u4e86\u8bb0\u5f55\u6548\u7387\u5e76\u51cf\u5c11\u4e86\u5b58\u50a8\u5f00\u9500\u3002</li> <li>\u5143\u6570\u636e\u5b58\u50a8\uff1a\u8bb0\u5f55\u4e0b\u6765\u7684\u5730\u5740\u5e8f\u5217\uff08Sequence Table\uff09\u548c\u7528\u4e8e\u63a7\u5236\u56de\u653e\u8282\u594f\u7684\u65f6\u5e8f\u4fe1\u606f\uff08Window Division Table\uff09\u88ab\u5b58\u50a8\u5728\u7531\u7a0b\u5e8f\u5458\u5206\u914d\u7684\u4e3b\u5185\u5b58\u4e2d\uff0c\u800c\u975e\u6709\u9650\u7684\u7247\u4e0a\u5b58\u50a8\u3002\u8fd9\u4f7f\u5f97 RnR \u80fd\u591f\u5904\u7406\u975e\u5e38\u957f\u7684\u8bbf\u95ee\u6a21\u5f0f\u3002</li> </ul> <p></p> <p>Fig. 2. Motivation and key idea of the RnR prefetcher.</p> <p>\u7f16\u7a0b\u63a5\u53e3\u4e0e\u5de5\u4f5c\u6d41\u7a0b</p> <p>RnR \u901a\u8fc7\u4e00\u7ec4\u7279\u6b8a\u7684\u67b6\u6784\u5bc4\u5b58\u5668\u548c\u51fd\u6570\u8c03\u7528\u4e3a\u7a0b\u5e8f\u5458\u63d0\u4f9b\u63a5\u53e3\u3002</p> <ul> <li>\u67b6\u6784\u72b6\u6001\u5bc4\u5b58\u5668\uff08\u6bcf\u6838\uff09\uff1a<ul> <li><code>ASID</code> \u5bc4\u5b58\u5668\uff1a\u7528\u4e8e\u6743\u9650\u68c0\u67e5\u3002</li> <li>\u8fb9\u754c\u5730\u5740\u5bc4\u5b58\u5668\uff1a\u5b9a\u4e49\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u865a\u62df\u5730\u5740\u8303\u56f4\u3002</li> <li>\u5e8f\u5217\u8868\u57fa\u5730\u5740\u3001\u7a97\u53e3\u5212\u5206\u8868\u57fa\u5730\u5740\u5bc4\u5b58\u5668\uff1a\u6307\u5411\u4e3b\u5b58\u4e2d\u5143\u6570\u636e\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002</li> <li>\u7a97\u53e3\u5927\u5c0f\u5bc4\u5b58\u5668\uff1a\u5b9a\u4e49\u65f6\u5e8f\u63a7\u5236\u7684\u7c92\u5ea6\u3002</li> <li>\u9884\u53d6\u72b6\u6001\u5bc4\u5b58\u5668\uff1a\u63a7\u5236\u5f53\u524d\u662f <code>Record</code>\u3001<code>Replay</code>\u3001<code>Pause</code> \u8fd8\u662f <code>End</code> \u72b6\u6001\u3002</li> </ul> </li> <li>\u5de5\u4f5c\u6d41\u7a0b\uff1a<ol> <li>\u521d\u59cb\u5316 (<code>RnR.init()</code>)\uff1a\u8bbe\u7f6e\u5185\u90e8\u53c2\u6570\uff0c\u5206\u914d\u5143\u6570\u636e\u5185\u5b58\u3002</li> <li>\u5b9a\u4e49\u533a\u57df (<code>RnR.AddrBase.set()</code>)\uff1a\u6307\u5b9a\u8981\u76d1\u63a7\u7684\u6570\u636e\u7ed3\u6784\uff08\u5982 <code>pcurr</code>, <code>pnext</code> \u6570\u7ec4\uff09\u53ca\u5176\u5927\u5c0f\u3002</li> <li>\u5f00\u59cb\u8bb0\u5f55 (<code>RnR.PrefetchState.start()</code>)\uff1a\u8fdb\u5165 <code>Record</code> \u72b6\u6001\uff0c\u5728\u7b2c\u4e00\u6b21\u8fed\u4ee3\u4e2d\u8bb0\u5f55 L2 \u672a\u547d\u4e2d\u5e8f\u5217\u3002</li> <li>\u5207\u6362\u5230\u56de\u653e (<code>RnR.PrefetchState.replay()</code>)\uff1a\u5728\u540e\u7eed\u8fed\u4ee3\u5f00\u59cb\u524d\uff0c\u5207\u6362\u5230 <code>Replay</code> \u72b6\u6001\u3002</li> <li>\u52a8\u6001\u66f4\u65b0\u533a\u57df\uff1a\u5bf9\u4e8e\u50cf PageRank \u8fd9\u6837\u5728\u8fed\u4ee3\u95f4\u4ea4\u6362\u6307\u9488\u7684\u5e94\u7528\uff0c\u9700\u8981\u5728\u6bcf\u6b21\u8fed\u4ee3\u540e\u66f4\u65b0\u8fb9\u754c\u5bc4\u5b58\u5668\u4ee5\u6307\u5411\u65b0\u7684\u6d3b\u52a8\u6570\u7ec4\u3002</li> <li>\u7ed3\u675f (<code>RnR.PrefetchState.end()</code>)\uff1a\u7ec8\u6b62 RnR \u529f\u80fd\u5e76\u91ca\u653e\u8d44\u6e90\u3002</li> </ol> </li> </ul> <p></p> <p>Fig. 3. State transition diagram of the RnR prefetch state.</p> <p>\u56de\u653e\u65f6\u5e8f\u63a7\u5236\u673a\u5236</p> <p>\u8fd9\u662f RnR \u5b9e\u73b0\u9ad8\u65f6\u6548\u6027\uff08Timeliness\uff09\u7684\u5173\u952e\uff0c\u907f\u514d\u4e86\u8fc7\u65e9\u9884\u53d6\uff08\u6570\u636e\u88ab\u9a71\u9010\uff09\u6216\u8fc7\u665a\u9884\u53d6\uff08\u65e0\u6cd5\u9690\u85cf\u5ef6\u8fdf\uff09\u7684\u95ee\u9898\u3002</p> <ul> <li>\u7a97\u53e3\u5316\uff08Windowing\uff09\uff1a\u8bb0\u5f55\u9636\u6bb5\uff0cL2 \u672a\u547d\u4e2d\u5e8f\u5217\u88ab\u5212\u5206\u4e3a\u56fa\u5b9a\u5927\u5c0f\uff08\u7531\u7a97\u53e3\u5927\u5c0f\u5bc4\u5b58\u5668\u5b9a\u4e49\uff09\u7684\u7a97\u53e3\u3002\u540c\u65f6\uff0c\u8bb0\u5f55\u6bcf\u4e2a\u7a97\u53e3\u5185\u53d1\u751f\u7684\u603b\u9700\u6c42\u8bbf\u95ee\u6b21\u6570\uff08Demand Accesses\uff09\u5230\u7a97\u53e3\u5212\u5206\u8868\uff08Window Division Table\uff09\u3002</li> <li>\u52a8\u6001\u8c03\u6574\u9884\u53d6\u8282\u594f\uff1a\u56de\u653e\u9636\u6bb5\uff0cRnR \u4f1a\u76d1\u63a7\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u5b9e\u65f6\u9700\u6c42\u8bbf\u95ee\u6b21\u6570\uff08<code>Cur Struct Read</code> \u8ba1\u6570\u5668\uff09\u3002<ul> <li>\u5f53\u5b9e\u65f6\u8bbf\u95ee\u6b21\u6570\u8fbe\u5230\u8bb0\u5f55\u4e2d\u67d0\u4e2a\u7a97\u53e3\u5bf9\u5e94\u7684\u603b\u8bbf\u95ee\u6b21\u6570\u65f6\uff0cRnR \u77e5\u9053\u8be5\u7a97\u53e3\u7684\u8ba1\u7b97\u5373\u5c06\u5b8c\u6210\uff0c\u4fbf\u5f00\u59cb\u4e3a\u4e0b\u4e00\u4e2a\u7a97\u53e3\u9884\u53d6\u6570\u636e\u3002</li> <li>\u8fd9\u786e\u4fdd\u4e86\u9884\u53d6\u7684\u6570\u636e\u5728\u9700\u8981\u65f6\u6b63\u597d\u5728\u7f13\u5b58\u4e2d\uff0c\u800c\u4e0d\u4f1a\u56e0\u7b49\u5f85\u592a\u4e45\u800c\u88ab\u9a71\u9010\u3002</li> </ul> </li> <li>\u7a97\u53e3\u5185\u5747\u5300\u5206\u53d1\uff1a\u4e3a\u4e86\u51cf\u5c11\u5bf9\u5185\u5b58\u5e26\u5bbd\u7684\u77ac\u65f6\u51b2\u51fb\uff0cRnR \u4f1a\u6839\u636e\u7a97\u53e3\u5185\u7684\u672a\u547d\u4e2d\u6570\u91cf\u548c\u603b\u8bbf\u95ee\u6b21\u6570\uff0c\u8ba1\u7b97\u51fa\u4e00\u4e2a\u9884\u53d6\u6b65\u8c03\uff08NPace = Window_Demand_Accesses / Window_Misses\uff09\uff0c\u5e76\u5728\u7a97\u53e3\u5185\u5747\u5300\u5730\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\u3002</li> </ul> <p></p> <p>Fig. 5. Prefetching timing control example with window size = 3.</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u7cfb\u7edf\u96c6\u6210</p> <ul> <li>\u8f93\u5165\uff1a<ul> <li>\u8f6f\u4ef6\u8f93\u5165\uff1a\u7a0b\u5e8f\u5458\u901a\u8fc7 API \u63d0\u4f9b\u7684\u7a7a\u95f4/\u65f6\u95f4\u533a\u57df\u5b9a\u4e49\u3001\u8bb0\u5f55/\u56de\u653e\u63a7\u5236\u4fe1\u53f7\u3002</li> <li>\u786c\u4ef6\u8f93\u5165\uff1a\u6765\u81ea\u5904\u7406\u5668\u6838\u5fc3\u7684 L2 \u7f13\u5b58\u672a\u547d\u4e2d\u8bf7\u6c42\u6d41\u3002</li> </ul> </li> <li>\u8f93\u51fa\uff1a<ul> <li>\u8bb0\u5f55\u9636\u6bb5\u8f93\u51fa\uff1a\u751f\u6210\u5e76\u5199\u5165\u4e3b\u5b58\u7684 Sequence Table \u548c Window Division Table\u3002</li> <li>\u56de\u653e\u9636\u6bb5\u8f93\u51fa\uff1a\u5411\u5185\u5b58\u5b50\u7cfb\u7edf\u53d1\u51fa\u7684\u3001\u57fa\u4e8e\u8bb0\u5f55\u5e8f\u5217\u7684\u9884\u53d6\u8bf7\u6c42\uff0c\u76ee\u6807\u662f\u79c1\u6709 L2 \u7f13\u5b58\u3002</li> </ul> </li> <li>\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528\uff1a<ul> <li>RnR \u4e13\u6ce8\u4e8e\u5904\u7406\u90a3\u4e9b\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982 Next-line, Bingo, SteMS\uff09\u96be\u4ee5\u5904\u7406\u7684\u957f\u91cd\u590d\u4e0d\u89c4\u5219\u6a21\u5f0f\u3002</li> <li>\u5b83\u53ef\u4ee5\u4e0e\u73b0\u6709\u7684\u5e38\u89c4\u9884\u53d6\u5668\u5171\u5b58\u3002\u901a\u8fc7\u8fb9\u754c\u5bc4\u5b58\u5668\uff0cRnR \u5c06\u76ee\u6807\u6570\u636e\u7ed3\u6784\u4ece\u5e38\u89c4\u9884\u53d6\u5668\u7684\u8bad\u7ec3\u96c6\u4e2d\u6392\u9664\uff0c\u8ba9\u5e38\u89c4\u9884\u53d6\u5668\u7ee7\u7eed\u9ad8\u6548\u5904\u7406\u6d41\u5f0f\u6216\u6b65\u957f\u7b49\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\uff0c\u800c RnR \u5219\u8d1f\u8d23\u4e0d\u89c4\u5219\u90e8\u5206\uff0c\u5f62\u6210\u4e92\u8865\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 4. RnR system architecture.</p> <p>\u6027\u80fd\u4e0e\u5f00\u9500\u8bc4\u4f30</p> <p>RnR \u7684\u8bbe\u8ba1\u5728\u6027\u80fd\u63d0\u5347\u548c\u8d44\u6e90\u5f00\u9500\u4e4b\u95f4\u53d6\u5f97\u4e86\u826f\u597d\u5e73\u8861\u3002</p> <ul> <li>\u6027\u80fd\u63d0\u5347\uff1a\u5728\u8bc4\u4f30\u7684\u56fe\u5e94\u7528\uff08PageRank, Hyper-Anf\uff09\u548c\u8fed\u4ee3\u6c42\u89e3\u5668\uff08spCG\uff09\u4e0a\uff0cRnR \u5b9e\u73b0\u4e86\u663e\u8457\u7684\u52a0\u901f\u6bd4\u3002</li> <li>\u9ad8\u7cbe\u5ea6\u4e0e\u8986\u76d6\u7387\uff1a\u5f97\u76ca\u4e8e\u7cbe\u786e\u7684\u8bb0\u5f55\u4e0e\u56de\u653e\uff0cRnR \u8fbe\u5230\u4e86\u8d85\u8fc7 95% \u7684\u9884\u53d6\u51c6\u786e\u7387\u548c\u9ad8\u7f3a\u5931\u8986\u76d6\u7387\uff0c\u8fdc\u8d85\u5bf9\u6bd4\u7684\u901a\u7528\u9884\u53d6\u5668\u3002</li> <li>\u786c\u4ef6\u5f00\u9500\u6781\u4f4e\uff1a\u6bcf\u6838\u4ec5\u9700\u4e0d\u5230 1KB \u7684\u989d\u5916\u5bc4\u5b58\u5668\u548c\u63a7\u5236\u903b\u8f91\uff0c\u9762\u79ef\u5f00\u9500\u53ef\u5ffd\u7565\u4e0d\u8ba1\uff08&lt; 0.01%\uff09\u3002</li> <li>\u5b58\u50a8\u5f00\u9500\u53ef\u63a7\uff1a\u5143\u6570\u636e\u5b58\u50a8\u5f00\u9500\u4e0e\u8f93\u5165\u6570\u636e\u96c6\u5927\u5c0f\u548c\u5176\u5c40\u90e8\u6027\u76f8\u5173\uff0c\u5e73\u5747\u7ea6\u4e3a\u539f\u59cb\u6570\u636e\u96c6\u5927\u5c0f\u7684 12% \u5de6\u53f3\u3002</li> </ul> \u6307\u6807 RnR \u8868\u73b0 \u5bf9\u6bd4\u9884\u53d6\u5668\u8868\u73b0 \u5e73\u5747\u52a0\u901f\u6bd4 (PageRank/Hyper-Anf/spCG) 2.16x / 2.16x / 2.91x \u663e\u8457\u4f4e\u4e8e RnR\uff0c\u5c24\u5176\u5728\u968f\u673a\u56fe\uff08urand\uff09\u4e0a \u9884\u53d6\u51c6\u786e\u7387 ~97.18% \u901a\u7528\u9884\u53d6\u5668\u901a\u5e38 &lt; 50%\uff0cDROPLET \u5728\u7279\u5b9a\u573a\u666f\u4e0b\u8f83\u597d \u7f3a\u5931\u8986\u76d6\u7387 ~88-91% \u901a\u7528\u9884\u53d6\u5668\u8986\u76d6\u7387\u5f88\u4f4e\uff0cDROPLET \u5bf9\u7279\u5b9a\u56fe\u7b97\u6cd5\u6709\u6548 \u786c\u4ef6\u9762\u79ef\u5f00\u9500 &lt; 1KB/\u6838 MISB \u9700\u8981 ~49KB \u7247\u4e0a\u5143\u6570\u636e\u7f13\u5b58 \u989d\u5916\u7247\u5916\u6d41\u91cf ~12.0% \u4e3b\u8981\u6765\u81ea\u5143\u6570\u636e\uff1b\u901a\u7528\u9884\u53d6\u5668\u56e0\u4f4e\u51c6\u786e\u7387\u4ea7\u751f\u66f4\u591a\u65e0\u6548\u6d41\u91cf <p></p> <p>Fig. 6. Speedup over no prefetcher baseline.</p> <p></p> <p>Fig. 9. Prefetcher accuracy.</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#2_1","title":"2. \u57fa\u4e8e\u7a97\u53e3\u7684\u56de\u653e\u65f6\u5e8f\u63a7\u5236","text":"<p>\u6838\u5fc3\u673a\u5236\u4e0e\u5b9e\u73b0\u539f\u7406</p> <ul> <li>RnR \u9884\u53d6\u5668\u7684\u6838\u5fc3\u521b\u65b0\u4e4b\u4e00\u662f\u5176 Replay Timing Control (\u56de\u653e\u65f6\u5e8f\u63a7\u5236) \u673a\u5236\uff0c\u65e8\u5728\u89e3\u51b3\u4f20\u7edf\u9884\u53d6\u5668\u56e0\u7f3a\u4e4f\u7cbe\u786e\u65f6\u5e8f\u4fe1\u606f\u800c\u5bfc\u81f4\u7684 \u8fc7\u65e9 (early) \u6216 \u8fc7\u665a (late) \u9884\u53d6\u95ee\u9898\u3002</li> <li>\u8be5\u673a\u5236\u7684\u5173\u952e\u5728\u4e8e\u5c06\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u5212\u5206\u4e3a\u4e00\u7cfb\u5217 \u65f6\u95f4\u7a97\u53e3 (time window)\uff0c\u5e76\u5728 Record (\u8bb0\u5f55) \u9636\u6bb5\u6355\u83b7\u6bcf\u4e2a\u7a97\u53e3\u5185\u7684 \u5185\u5b58\u8bbf\u95ee\u884c\u4e3a\u7279\u5f81\u3002</li> <li>\u5177\u4f53\u800c\u8a00\uff0c\u5728\u8bb0\u5f55\u9636\u6bb5\uff0c\u7cfb\u7edf\u4f1a\u7ef4\u62a4\u4e00\u4e2a \u5f53\u524d\u7ed3\u6784\u8bfb\u53d6\u8ba1\u6570\u5668 (Cur Struct Read counter)\uff0c\u7528\u4e8e\u7edf\u8ba1\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u603b\u8bbf\u95ee\u6b21\u6570\u3002</li> <li>\u540c\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8bb0\u5f55 L2 cache miss sequence (L2\u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217)\u3002\u6bcf\u5f53\u8bb0\u5f55\u7684\u672a\u547d\u4e2d\u6570\u91cf\u8fbe\u5230\u9884\u8bbe\u7684 \u7a97\u53e3\u5927\u5c0f (Window Size) \u65f6\uff0c\u5c31\u4f1a\u5c06\u5f53\u524d\u7684 Cur Struct Read \u8ba1\u6570\u503c \u4fdd\u5b58\u5230 Window Division Table (\u7a97\u53e3\u5212\u5206\u8868) \u4e2d\u3002</li> <li>\u8fd9\u4e2a\u4fdd\u5b58\u7684\u8ba1\u6570\u503c\u5b9e\u8d28\u4e0a\u4ee3\u8868\u4e86\u5728\u4ea7\u751f <code>Window Size</code> \u4e2a\u7f13\u5b58\u672a\u547d\u4e2d\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7a0b\u5e8f\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u6267\u884c\u7684 \u603b\u9700\u6c42\u8bbf\u95ee\u6b21\u6570 (total demand accesses)\u3002\u7531\u6b64\u53ef\u4ee5\u8ba1\u7b97\u51fa\u8be5\u7a97\u53e3\u7684 \u672a\u547d\u4e2d\u7387 (miss ratio)\u3002</li> </ul> <p></p> <p>Fig. 5. Prefetching timing control example with window size = 3.</p> <p>\u56de\u653e\u9636\u6bb5\u7684\u52a8\u6001\u8c03\u6574\u7b97\u6cd5</p> <ul> <li>\u5728 Replay (\u56de\u653e) \u9636\u6bb5\uff0cRnR \u9884\u53d6\u5668\u4f1a\u91cd\u7f6e\u5176\u5185\u90e8\u8ba1\u6570\u5668\uff0c\u5e76\u518d\u6b21\u4f7f\u7528 Cur Struct Read counter \u6765\u8ddf\u8e2a\u5f53\u524d\u8fed\u4ee3\u4e2d\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\u8fdb\u5ea6\u3002</li> <li>\u9884\u53d6\u5668\u4f1a\u4ece\u5185\u5b58\u4e2d \u9884\u53d6 (prefetch) \u4e4b\u524d\u8bb0\u5f55\u597d\u7684 Sequence Table \u548c Window Division Table \u5230\u5185\u90e8\u7f13\u51b2\u533a\u3002</li> <li>\u9884\u53d6\u5668\u7684\u6838\u5fc3\u903b\u8f91\u662f\uff1a\u5c06\u5f53\u524d\u7684 Cur Struct Read \u503c\u4e0e Window Division Table \u4e2d\u8bb0\u5f55\u7684\u503c\u8fdb\u884c\u6bd4\u8f83\u3002</li> <li>\u5f53 <code>Cur Struct Read</code> \u8fbe\u5230\u7b2c\u4e00\u4e2a\u7a97\u53e3\u7684\u8bb0\u5f55\u503c\u65f6\uff0c\u610f\u5473\u7740\u7a0b\u5e8f\u6267\u884c\u8fdb\u5ea6\u5df2\u4e0e\u8bb0\u5f55\u9636\u6bb5\u7684\u7b2c\u4e00\u4e2a\u7a97\u53e3\u672b\u5c3e\u5bf9\u9f50\u3002</li> <li>\u6b64\u65f6\uff0c\u9884\u53d6\u5668\u4f1a\u5f00\u59cb\u4e3a \u4e0b\u4e00\u4e2a\u7a97\u53e3 \u7684\u672a\u547d\u4e2d\u5730\u5740\u53d1\u51fa\u9884\u53d6\u8bf7\u6c42\u3002</li> <li>\u4e3a\u4e86\u8fdb\u4e00\u6b65\u4f18\u5316\u5e26\u5bbd\u5229\u7528\u5e76\u51cf\u5c11\u4e0e\u9700\u6c42\u8bbf\u95ee\u7684\u51b2\u7a81\uff0c\u9884\u53d6\u5668\u4e0d\u4ec5\u63a7\u5236\u4f55\u65f6\u5f00\u59cb\u9884\u53d6\u4e0b\u4e00\u4e2a\u7a97\u53e3\uff0c\u8fd8\u63a7\u5236 \u7a97\u53e3\u5185\u7684\u9884\u53d6\u9891\u7387\u3002</li> <li>\u9884\u53d6\u9891\u7387\u7531\u516c\u5f0f <code>NPace = StructAccessesInCurrentWindow / MissesInCurrentWindow</code> \u51b3\u5b9a\u3002</li> <li>\u8fd9\u610f\u5473\u7740\u9884\u53d6\u5668\u4f1a \u5747\u5300\u5730 \u5728\u5f53\u524d\u7a97\u53e3\u7684\u9700\u6c42\u8bbf\u95ee\u4e4b\u95f4\u63d2\u5165\u9884\u53d6\u8bf7\u6c42\uff0c\u800c\u4e0d\u662f\u4e00\u6b21\u6027\u53d1\u51fa\u6240\u6709\u8bf7\u6c42\u3002</li> </ul> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u8bbe\u8ba1\u8003\u91cf</p> <ul> <li>\u7a97\u53e3\u5927\u5c0f (Window Size) \u662f\u4e00\u4e2a\u5173\u952e\u7684\u8bbe\u8ba1\u53c2\u6570\uff0c\u5b83\u5b9a\u4e49\u4e86\u65f6\u5e8f\u63a7\u5236\u7684\u7c92\u5ea6\u3002</li> <li>\u7a97\u53e3\u592a\u5c0f\u4f1a\u5bfc\u81f4 Window Division Table \u8fc7\u5927\uff0c\u589e\u52a0\u5b58\u50a8\u5f00\u9500\uff0c\u5e76\u53ef\u80fd\u56e0\u8fc7\u4e8e\u9891\u7e41\u7684\u8c03\u6574\u800c\u5f15\u5165\u4e0d\u5fc5\u8981\u7684\u590d\u6742\u6027\u3002</li> <li>\u7a97\u53e3\u592a\u5927\u5219\u4f1a\u964d\u4f4e\u65f6\u5e8f\u63a7\u5236\u7684\u7cbe\u5ea6\uff0c\u65e0\u6cd5\u6709\u6548\u5e94\u5bf9\u7a0b\u5e8f\u5c40\u90e8\u6027\u53d8\u5316\u3002</li> <li>\u8bba\u6587\u5b9e\u9a8c\u8868\u660e\uff0c\u5bf9\u4e8e\u79c1\u6709 L2 \u7f13\u5b58\u4f5c\u4e3a\u9884\u53d6\u76ee\u6807\u7684\u573a\u666f\uff0c\u7a97\u53e3\u5927\u5c0f\u5728 64 \u5230 2048 \u4e2a\u7f13\u5b58\u884c\u4e4b\u95f4 \u80fd\u53d6\u5f97\u8f83\u597d\u7684\u6027\u80fd\u548c\u5b58\u50a8\u5f00\u9500\u5e73\u8861\u3002</li> <li>\u9ed8\u8ba4\u7a97\u53e3\u5927\u5c0f\u88ab\u8bbe\u7f6e\u4e3a L2 \u7f13\u5b58\u5927\u5c0f\u7684\u4e00\u534a\uff0c\u4ee5\u652f\u6301 double buffering (\u53cc\u7f13\u51b2) \u7b56\u7565\uff0c\u786e\u4fdd\u5728\u5904\u7406\u5f53\u524d\u7a97\u53e3\u6570\u636e\u7684\u540c\u65f6\uff0c\u53ef\u4ee5\u63d0\u524d\u5c06\u4e0b\u4e00\u4e2a\u7a97\u53e3\u7684\u6570\u636e\u9884\u53d6\u5230\u7f13\u5b58\u4e2d\u3002</li> </ul> <p></p> <p>Fig. 14. Average speedup and storage for different window sizes.</p> <p>\u8f93\u5165\u3001\u8f93\u51fa\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165:</li> <li>Record \u9636\u6bb5: \u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684 L2 \u672a\u547d\u4e2d\u5730\u5740\u6d41 \u548c \u603b\u9700\u6c42\u8bbf\u95ee\u6d41\u3002</li> <li>Replay \u9636\u6bb5: \u5f53\u524d\u8fed\u4ee3\u4e2d\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684 \u5b9e\u65f6\u9700\u6c42\u8bbf\u95ee\u6d41\u3002</li> <li>\u8f93\u51fa:</li> <li>Record \u9636\u6bb5: \u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u7684 Sequence Table (\u672a\u547d\u4e2d\u5730\u5740\u5e8f\u5217) \u548c Window Division Table (\u6bcf\u4e2a\u7a97\u53e3\u5bf9\u5e94\u7684\u603b\u9700\u6c42\u8bbf\u95ee\u6570)\u3002</li> <li>Replay \u9636\u6bb5: \u7cbe\u51c6\u8c03\u5ea6\u7684\u9884\u53d6\u8bf7\u6c42\u6d41\uff0c\u5176\u901f\u5ea6\u548c\u8282\u594f\u4e0e\u7a0b\u5e8f\u7684\u5b9e\u9645\u6267\u884c\u8fdb\u5ea6\u52a8\u6001\u5339\u914d\u3002</li> <li>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:</li> <li>\u89e3\u8026\u5730\u5740\u751f\u6210\u4e0e\u5904\u7406\u5668: \u9884\u53d6\u5730\u5740\u76f4\u63a5\u4ece\u8bb0\u5f55\u7684\u5e8f\u5217\u4e2d\u56de\u653e\uff0c\u65e0\u9700\u590d\u6742\u7684\u5728\u7ebf\u9884\u6d4b\u6216\u5730\u5740\u8ba1\u7b97\uff0c\u964d\u4f4e\u4e86\u786c\u4ef6\u590d\u6742\u5ea6\u3002</li> <li>\u786e\u4fdd\u9884\u53d6\u53ca\u65f6\u6027 (Timeliness): \u901a\u8fc7\u5339\u914d\u7a0b\u5e8f\u6267\u884c\u8fdb\u5ea6\uff0c\u6781\u5927\u51cf\u5c11\u4e86 \u8fc7\u65e9\u9884\u53d6\uff08\u5bfc\u81f4\u6570\u636e\u5728\u4f7f\u7528\u524d\u88ab\u9a71\u9010\uff09\u548c \u8fc7\u665a\u9884\u53d6\uff08\u65e0\u6cd5\u9690\u85cf\u5ef6\u8fdf\uff09\u7684\u60c5\u51b5\u3002</li> <li>\u63d0\u5347\u9884\u53d6\u6548\u7387: \u5747\u5300\u5206\u5e03\u7684\u9884\u53d6\u8bf7\u6c42\u51cf\u5c11\u4e86\u5bf9\u5185\u5b58\u5b50\u7cfb\u7edf\u7684\u77ac\u65f6\u538b\u529b\uff0c\u907f\u514d\u4e86\u4e0e\u9700\u6c42\u8bbf\u95ee\u7684\u6fc0\u70c8\u7ade\u4e89\uff0c\u4ece\u800c\u63d0\u9ad8\u4e86\u6574\u4f53\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u3002</li> </ul> <p></p> <p>Fig. 11. Prefetch timeliness breakdown (Left bar: no control, middle bar: window control, right bar: window+pace control).</p>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#3_1","title":"3. \u8f6f\u786c\u4ef6\u534f\u540c\u7684\u8f7b\u91cf\u7ea7\u7f16\u7a0b\u63a5\u53e3","text":"<p>\u8f6f\u786c\u4ef6\u534f\u540c\u7684\u8f7b\u91cf\u7ea7\u7f16\u7a0b\u63a5\u53e3\u5b9e\u73b0\u539f\u7406</p> <p>RnR (Record-and-Replay) \u9884\u53d6\u5668\u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\u5176\u8f7b\u91cf\u7ea7\u7684\u8f6f\u4ef6-\u786c\u4ef6\u534f\u540c\u63a5\u53e3\u3002\u8be5\u63a5\u53e3\u901a\u8fc7\u66b4\u9732\u4e00\u7ec4\u7279\u6b8a\u7684\u4f53\u7cfb\u7ed3\u6784\u5bc4\u5b58\u5668 (special registers)\uff0c\u5141\u8bb8\u7a0b\u5e8f\u5458\u5728\u5e94\u7528\u4ee3\u7801\u4e2d\u7cbe\u786e\u5730\u5212\u5b9a\u9884\u53d6\u64cd\u4f5c\u7684\u65f6\u7a7a\u8fb9\u754c\uff0c\u5e76\u63a7\u5236\u5176\u751f\u547d\u5468\u671f\u3002\u8fd9\u89e3\u51b3\u4e86\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u65e0\u6cd5\u6709\u6548\u5904\u7406\u957f\u4e14\u91cd\u590d\u7684\u4e0d\u89c4\u5219\u8bbf\u5b58\u6a21\u5f0f\u7684\u6839\u672c\u95ee\u9898\u3002</p> <ul> <li>\u4f53\u7cfb\u7ed3\u6784\u72b6\u6001\u5bc4\u5b58\u5668\u5b9a\u4e49\uff1a\u6bcf\u4e2a\u6838\u5fc3\u90fd\u914d\u5907\u4e86\u4e00\u7ec4\u4e13\u7528\u5bc4\u5b58\u5668\uff0c\u7528\u4e8e\u4e0eRnR\u786c\u4ef6\u903b\u8f91\u901a\u4fe1\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u5305\u62ec\uff1a<ul> <li>\u5730\u5740\u7a7a\u95f4\u6807\u8bc6\u7b26 (ASID) \u5bc4\u5b58\u5668\uff1a\u7528\u4e8e\u6743\u9650\u68c0\u67e5\uff0c\u786e\u4fdd\u9884\u53d6\u64cd\u4f5c\u4ec5\u9650\u4e8e\u5f53\u524d\u8fdb\u7a0b\u3002</li> <li>\u8fb9\u754c\u68c0\u67e5\u5730\u5740\u5bc4\u5b58\u5668\u7ec4\uff1a\u5b58\u50a8\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u865a\u62df\u5730\u5740\u57fa\u5740\u53ca\u5176\u5927\u5c0f\u3002\u786c\u4ef6\u5229\u7528\u8fd9\u4e9b\u4fe1\u606f\u8fc7\u6ee4\u51fa\u9700\u8981\u8bb0\u5f55\u6216\u56de\u653e\u7684\u7f13\u5b58\u672a\u547d\u4e2d\u3002</li> <li>\u5e8f\u5217\u8868 (Sequence Table) \u57fa\u5740\u5bc4\u5b58\u5668\uff1a\u6307\u5411\u5185\u5b58\u4e2d\u7528\u4e8e\u5b58\u50a8\u8bb0\u5f55\u4e0b\u6765\u7684L2\u7f13\u5b58\u672a\u547d\u4e2d\u5730\u5740\u5e8f\u5217\u7684\u533a\u57df\u3002</li> <li>\u7a97\u53e3\u5927\u5c0f (Window Size) \u5bc4\u5b58\u5668\uff1a\u5b9a\u4e49\u4e86\u7528\u4e8e\u63a7\u5236\u56de\u653e\u8282\u594f\u7684\u65f6\u95f4\u7a97\u53e3\u7c92\u5ea6\uff08\u4ee5\u7ed3\u6784\u4f53\u672a\u547d\u4e2d\u6b21\u6570\u8ba1\uff09\u3002</li> <li>\u7a97\u53e3\u5212\u5206\u8868 (Window Division Table) \u57fa\u5740\u5bc4\u5b58\u5668\uff1a\u6307\u5411\u5185\u5b58\u4e2d\u5b58\u50a8\u6bcf\u4e2a\u7a97\u53e3\u5185\u603b\u9700\u6c42\u8bbf\u95ee\u6b21\u6570\u7684\u533a\u57df\uff0c\u7528\u4e8e\u8ba1\u7b97\u56de\u653e\u65f6\u7684\u9884\u53d6\u8282\u594f\u3002</li> <li>\u9884\u53d6\u72b6\u6001 (Prefetch State) \u5bc4\u5b58\u5668\uff1a\u63a7\u5236RnR\u786c\u4ef6\u7684\u72b6\u6001\u673a\uff0c\u5176\u503c\u7531\u8f6f\u4ef6\u901a\u8fc7\u51fd\u6570\u8c03\u7528\u8bbe\u7f6e\u3002</li> </ul> </li> </ul> <p></p> <p>Fig. 3. State transition diagram of the RnR prefetch state.</p> <ul> <li>\u8f6f\u4ef6\u63a7\u5236\u6d41\u7a0b\u4e0eAPI\uff1a\u7a0b\u5e8f\u5458\u901a\u8fc7\u8c03\u7528\u4e00\u7ec4\u7b80\u5355\u7684\u51fd\u6570\u6765\u64cd\u4f5c\u4e0a\u8ff0\u5bc4\u5b58\u5668\uff0c\u4ece\u800c\u9a71\u52a8RnR\u72b6\u6001\u673a\u3002\u4e3b\u8981\u51fd\u6570\u8c03\u7528\u53ca\u5176\u4f5c\u7528\u5982\u4e0b\uff1a</li> </ul> \u51fd\u6570\u8c03\u7528 \u4f5c\u7528 <code>RnR.init()</code> \u521d\u59cb\u5316RnR\uff0c\u5206\u914d\u5143\u6570\u636e\u5185\u5b58\uff0c\u5e76\u8bbe\u7f6e\u9ed8\u8ba4\u53c2\u6570\uff08\u5982\u7a97\u53e3\u5927\u5c0f\uff09\u3002 <code>RnR.AddrBase.set(base, size)</code> \u5c06\u6570\u636e\u7ed3\u6784\u7684\u57fa\u5740\u548c\u5927\u5c0f\u5199\u5165\u8fb9\u754c\u68c0\u67e5\u5bc4\u5b58\u5668\u3002 <code>RnR.AddrBase.enable(base)</code> / <code>disable(base)</code> \u52a8\u6001\u542f\u7528\u6216\u7981\u7528\u5bf9\u7279\u5b9a\u5730\u5740\u8303\u56f4\u7684\u8bb0\u5f55/\u56de\u653e\uff0c\u9002\u7528\u4e8e\u6307\u9488\u4ea4\u6362\u573a\u666f\uff08\u5982PageRank\u4e2d\u7684<code>pcurr</code>/<code>pnext</code>\uff09\u3002 <code>RnR.PrefetchState.start()</code> \u5c06\u9884\u53d6\u72b6\u6001\u8bbe\u4e3a\u201c\u8bb0\u5f55 (Record)\u201d\uff0c\u5f00\u59cb\u6355\u83b7L2\u672a\u547d\u4e2d\u5e8f\u5217\u3002 <code>RnR.PrefetchState.replay()</code> \u5c06\u9884\u53d6\u72b6\u6001\u5207\u6362\u5230\u201c\u56de\u653e (Replay)\u201d\uff0c\u5f00\u59cb\u6839\u636e\u8bb0\u5f55\u7684\u6570\u636e\u8fdb\u884c\u9884\u53d6\u3002 <code>RnR.PrefetchState.end()</code> \u7ec8\u6b62RnR\u64cd\u4f5c\uff0c\u91ca\u653e\u76f8\u5173\u8d44\u6e90\u3002 <p></p> <p>TABLE I RNR FUNCTION CALLS.</p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u8f93\u5165\u8f93\u51fa\u5173\u7cfb</p> <p>\u8be5\u63a5\u53e3\u7684\u8fd0\u4f5c\u8d2f\u7a7f\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7684\u8fed\u4ee3\u5468\u671f\u4e2d\uff0c\u5176\u8f93\u5165\u662f\u7a0b\u5e8f\u5458\u7684\u610f\u56fe\uff08\u901a\u8fc7API\u8c03\u7528\u8868\u8fbe\uff09\uff0c\u8f93\u51fa\u662f\u7cbe\u51c6\u3001\u53ca\u65f6\u7684\u786c\u4ef6\u9884\u53d6\u884c\u4e3a\u3002</p> <ul> <li> <p>\u8bb0\u5f55 (Record) \u9636\u6bb5\u6d41\u7a0b\uff1a</p> <ol> <li>\u8f6f\u4ef6\u8c03\u7528 <code>start()</code>\uff0c\u5c06\u72b6\u6001\u5bc4\u5b58\u5668\u7f6e\u4e3a\u201c\u8bb0\u5f55\u201d\u3002</li> <li>\u786c\u4ef6\u76d1\u63a7\u6240\u6709L2\u7f13\u5b58\u672a\u547d\u4e2d\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u672a\u547d\u4e2d\uff0c\u786c\u4ef6\u68c0\u67e5\u5176\u865a\u62df\u5730\u5740\u662f\u5426\u843d\u5728\u4efb\u4e00\u5df2\u542f\u7528\u7684\u8fb9\u754c\u8303\u56f4\u5185\u3002</li> <li>\u5982\u679c\u5728\u8303\u56f4\u5185\uff0c\u5219\u5c06\u8be5\u7269\u7406\u5730\u5740\u8ffd\u52a0\u5230\u5e8f\u5217\u8868\u7f13\u51b2\u533a\uff0c\u5e76\u9012\u589e\u5f53\u524d\u7ed3\u6784\u8bfb\u8ba1\u6570\u5668 (Cur Struct Read counter)\u3002</li> <li>\u6bcf\u5f53\u8bb0\u5f55\u7684\u672a\u547d\u4e2d\u6570\u91cf\u8fbe\u5230\u7a97\u53e3\u5927\u5c0f\uff0c\u5c31\u5c06\u5f53\u524d\u7684<code>Cur Struct Read</code>\u8ba1\u6570\u503c\u5199\u5165\u7a97\u53e3\u5212\u5206\u8868\uff0c\u4f5c\u4e3a\u8be5\u7a97\u53e3\u7684\u201c\u603b\u9700\u6c42\u8bbf\u95ee\u6b21\u6570\u201d\u3002</li> <li>\u5143\u6570\u636e\uff08\u5e8f\u5217\u8868\u548c\u5212\u5206\u8868\uff09\u4ee5\u7f13\u5b58\u884c\u7c92\u5ea6\u6279\u91cf\u5199\u56de\u5185\u5b58\uff0c\u4ee5\u51cf\u5c11\u5199\u6d41\u91cf\u3002</li> </ol> </li> <li> <p>\u56de\u653e (Replay) \u9636\u6bb5\u6d41\u7a0b\uff1a</p> <ol> <li>\u8f6f\u4ef6\u8c03\u7528 <code>replay()</code>\uff0c\u5c06\u72b6\u6001\u5bc4\u5b58\u5668\u7f6e\u4e3a\u201c\u56de\u653e\u201d\uff0c\u5e76\u91cd\u7f6e\u5185\u90e8\u8ba1\u6570\u5668\u3002</li> <li>\u786c\u4ef6\u540c\u6837\u76d1\u63a7\u6240\u6709L2\u672a\u547d\u4e2d\uff0c\u5e76\u66f4\u65b0<code>Cur Struct Read</code>\u8ba1\u6570\u5668\u4ee5\u8ddf\u8e2a\u7a0b\u5e8f\u6267\u884c\u8fdb\u5ea6\u3002</li> <li>\u786c\u4ef6\u6839\u636e\u7a97\u53e3\u5212\u5206\u8868\u4e2d\u7684\u4fe1\u606f\uff0c\u52a8\u6001\u8ba1\u7b97\u9884\u53d6\u8282\u594f\u3002\u5177\u4f53\u800c\u8a00\uff0c\u5728\u4e00\u4e2a\u7a97\u53e3\u5185\uff0c\u9884\u53d6\u8bf7\u6c42\u7684\u9891\u7387\u4e3a <code>NPace = Window_Division_Table[Current_Window] / Window_Size</code>\uff0c\u5373\u6bcf<code>NPace</code>\u6b21\u7ed3\u6784\u8bbf\u95ee\u53d1\u51fa\u4e00\u6b21\u9884\u53d6\u3002</li> <li>\u5f53<code>Cur Struct Read</code>\u8ba1\u6570\u5668\u8fbe\u5230\u4e0b\u4e00\u4e2a\u7a97\u53e3\u7684\u8d77\u59cb\u70b9\u65f6\uff0c\u786c\u4ef6\u5207\u6362\u5230\u4e0b\u4e00\u4e2a\u7a97\u53e3\uff0c\u5e76\u66f4\u65b0<code>NPace</code>\u3002</li> <li>\u9884\u53d6\u8bf7\u6c42\u88ab\u53d1\u9001\u5230LLC\uff0c\u6570\u636e\u6700\u7ec8\u88ab\u586b\u5145\u5230\u79c1\u6709\u7684L2\u7f13\u5b58\u4e2d\u3002</li> </ol> </li> </ul> <p></p> <p>Fig. 5. Prefetching timing control example with window size = 3.</p> <p>\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528</p> <p>\u8fd9\u4e2a\u8f7b\u91cf\u7ea7\u63a5\u53e3\u662fRnR\u9884\u53d6\u5668\u5b9e\u73b0\u9ad8\u7cbe\u5ea6 (&gt;95%) \u548c\u9ad8\u8986\u76d6\u7387 (&gt;91%) \u7684\u5173\u952e\u3002</p> <ul> <li>\u89e3\u8026\u5730\u5740\u751f\u6210\u4e0e\u5904\u7406\u5668\uff1a\u9884\u53d6\u5730\u5740\u76f4\u63a5\u4ece\u5185\u5b58\u4e2d\u7684\u5e8f\u5217\u8868\u8bfb\u53d6\uff0c\u65e0\u9700\u5728\u8fd0\u884c\u65f6\u91cd\u65b0\u8ba1\u7b97\uff08\u5982DROPLET\u9700\u8981\u5148\u9884\u53d6\u8fb9\u518d\u8ba1\u7b97\u9876\u70b9\u5730\u5740\uff09\uff0c\u907f\u514d\u4e86\u8ba1\u7b97\u5ef6\u8fdf\u5bfc\u81f4\u7684\u9884\u53d6\u4e0d\u53ca\u65f6\u3002</li> <li>\u7cbe\u51c6\u7684\u65f6\u7a7a\u63a7\u5236\uff1a\u8f6f\u4ef6\u660e\u786e\u544a\u77e5\u786c\u4ef6\u201c\u4f55\u65f6\u5f00\u59cb\u8bb0\u5f55\u201d\u3001\u201c\u8bb0\u5f55\u4ec0\u4e48\u201d\u3001\u201c\u4f55\u65f6\u5f00\u59cb\u56de\u653e\u201d\uff0c\u4f7f\u5f97\u786c\u4ef6\u80fd\u4e13\u6ce8\u4e8e\u76ee\u6807\u6570\u636e\u7ed3\u6784\uff0c\u907f\u514d\u4e86\u5168\u5c40\u5386\u53f2\u7f13\u51b2\u533a(GHB)\u7b49\u8bbe\u8ba1\u56e0\u6a21\u5f0f\u6df7\u6dc6\u800c\u5bfc\u81f4\u7684\u9884\u6d4b\u9519\u8bef\u3002</li> <li>\u9ad8\u6548\u7684\u5143\u6570\u636e\u7ba1\u7406\uff1a\u5143\u6570\u636e\u5b58\u50a8\u5728\u7a0b\u5e8f\u5458\u5206\u914d\u7684\u8fde\u7eed\u5806\u5185\u5b58\u4e2d\uff0c\u4fbf\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u5728\u4e0a\u4e0b\u6587\u5207\u6362\u65f6\u4fdd\u5b58\u548c\u6062\u590d\uff08\u4ec5\u9700\u4fdd\u5b58\u5bc4\u5b58\u5668\u72b6\u6001\uff09\uff0c\u4e14\u53ef\u4ee5\u5728\u7a0b\u5e8f\u9636\u6bb5\u7ed3\u675f\u540e\u7acb\u5373\u91ca\u653e\uff0c\u63d0\u9ad8\u4e86\u8d44\u6e90\u5229\u7528\u7387\u3002</li> <li>\u4e0e\u73b0\u6709\u9884\u53d6\u5668\u5171\u5b58\uff1a\u901a\u8fc7\u5730\u5740\u8303\u56f4\u8fc7\u6ee4\uff0cRnR\u53ea\u5904\u7406\u6307\u5b9a\u7684\u4e0d\u89c4\u5219\u6570\u636e\u7ed3\u6784\uff0c\u800c\u5e38\u89c4\u7684\u6d41\u5f0f\u6216\u6b65\u957f\u5f0f\u9884\u53d6\u5668\u53ef\u4ee5\u7ee7\u7eed\u5904\u7406\u5176\u4ed6\u5177\u6709\u89c4\u5219\u6a21\u5f0f\u7684\u6570\u636e\uff0c\u5b9e\u73b0\u4e86\u4f18\u52bf\u4e92\u8865\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#4-l2","title":"4. \u79c1\u6709L2\u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217\u8bb0\u5f55","text":"<p>\u6838\u5fc3\u52a8\u673a\u4e0e\u8bbe\u8ba1\u539f\u7406</p> <p>RnR\u9884\u53d6\u5668\u9009\u62e9\u8bb0\u5f55\u79c1\u6709L2\u7f13\u5b58\u672a\u547d\u4e2d\u5e8f\u5217\uff0c\u800c\u975e\u6240\u6709\u5185\u5b58\u8bbf\u95ee\u6216\u66f4\u9ad8\u5c42\u7ea7\uff08\u5982LLC\uff09\u7684\u672a\u547d\u4e2d\uff0c\u5176\u80cc\u540e\u6709\u6df1\u523b\u7684\u8bbe\u8ba1\u8003\u91cf\u3002</p> <ul> <li>\u8fc7\u6ee4\u5c40\u90e8\u6027\u8bbf\u95ee\uff1a\u73b0\u4ee3\u5904\u7406\u5668\u7684L1\u548cL2\u7f13\u5b58\u65e8\u5728\u6355\u83b7\u5177\u6709\u7a7a\u95f4\u5c40\u90e8\u6027\u548c\u65f6\u95f4\u5c40\u90e8\u6027\u7684\u6570\u636e\u8bbf\u95ee\u3002\u901a\u8fc7\u4ec5\u8bb0\u5f55L2\u672a\u547d\u4e2d\uff0cRnR\u80fd\u591f\u81ea\u52a8\u8fc7\u6ee4\u6389\u90a3\u4e9b\u5df2\u7ecf\u88abL1/L2\u7f13\u5b58\u6210\u529f\u670d\u52a1\u7684\u3001\u5177\u6709\u826f\u597d\u5c40\u90e8\u6027\u7684\u8bbf\u95ee\u6a21\u5f0f\u3002</li> <li>\u805a\u7126\u771f\u6b63\u96be\u9898\uff1a\u8be5\u8bbe\u8ba1\u5c06\u9884\u53d6\u5668\u7684\u5173\u6ce8\u70b9\u7cbe\u51c6\u5730\u96c6\u4e2d\u5728\u90a3\u4e9b\u65e0\u6cd5\u88ab\u4f20\u7edf\u7f13\u5b58\u5c42\u6b21\u7ed3\u6784\u6709\u6548\u5904\u7406\u7684\u4e0d\u89c4\u5219\u3001\u957f\u8ddd\u79bb\u4f9d\u8d56\u7684\u5185\u5b58\u8bbf\u95ee\u4e0a\uff0c\u8fd9\u6b63\u662f\u786c\u4ef6\u9884\u53d6\u5668\u6700\u96be\u9884\u6d4b\u7684\u90e8\u5206\u3002</li> <li>\u964d\u4f4e\u8bb0\u5f55\u5f00\u9500\uff1a\u8bb0\u5f55\u6240\u6709\u5185\u5b58\u8bbf\u95ee\u4f1a\u4ea7\u751f\u5de8\u5927\u7684\u5143\u6570\u636e\u5b58\u50a8\u548c\u5e26\u5bbd\u5f00\u9500\u3002\u4ec5\u8bb0\u5f55L2\u672a\u547d\u4e2d\u53ef\u4ee5\u663e\u8457\u51cf\u5c11\u9700\u8981\u8bb0\u5f55\u7684\u5730\u5740\u6570\u91cf\uff0c\u4f7f\u65b9\u6848\u5728\u5b9e\u8df5\u4e2d\u66f4\u4e3a\u53ef\u884c\u3002</li> </ul> <p>\u8bb0\u5f55\u9636\u6bb5\u7684\u8be6\u7ec6\u7b97\u6cd5\u6d41\u7a0b</p> <p>\u8bb0\u5f55\u8fc7\u7a0b\u7531\u8f6f\u4ef6\u901a\u8fc7\u7f16\u7a0b\u63a5\u53e3\u89e6\u53d1\uff0c\u5e76\u7531\u786c\u4ef6\u534f\u540c\u5b8c\u6210\u3002\u5176\u6838\u5fc3\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u5f53\u8f6f\u4ef6\u8c03\u7528 <code>RnR.PrefetchState.start()</code> \u540e\uff0c\u786c\u4ef6\u72b6\u6001\u673a\u8fdb\u5165 \u2018Record\u2019 \u72b6\u6001\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u9700\u6c42\u8bbf\u95ee (demand access)\uff1a</li> <li>\u9996\u5148\u68c0\u67e5\u5176\u865a\u62df\u5730\u5740\u662f\u5426\u843d\u5728\u7531 <code>RnR.AddrBase.set()</code> \u5b9a\u4e49\u7684\u76ee\u6807\u6570\u636e\u7ed3\u6784\u5730\u5740\u8303\u56f4\u5185\u3002</li> <li>\u5982\u679c\u5728\u8303\u56f4\u5185\uff0c\u5219\u9012\u589e Cur Struct Read counter\uff0c\u6b64\u8ba1\u6570\u5668\u7528\u4e8e\u540e\u7eed\u7684\u9884\u53d6\u8282\u594f\u63a7\u5236\u3002</li> <li>\u8bbf\u95ee\u6309\u5e38\u89c4\u6d41\u7a0b\u7ecf\u8fc7TLB\u548c\u7f13\u5b58\u5c42\u6b21\u3002</li> <li>\u5982\u679c\u8be5\u8bbf\u95ee\u5728\u79c1\u6709L2\u7f13\u5b58\u4e2d\u672a\u547d\u4e2d\uff0c\u5e76\u4e14\u5c5e\u4e8e\u76ee\u6807\u5730\u5740\u8303\u56f4\uff0c\u5219\u89e6\u53d1\u8bb0\u5f55\u52a8\u4f5c\u3002</li> <li>\u5143\u6570\u636e\u5199\u5165\uff1a</li> <li>\u5c06\u8be5L2\u672a\u547d\u4e2d\u7684\u7269\u7406\u5730\u5740\u8ffd\u52a0\u5230Sequence Table (\u5e8f\u5217\u8868) \u7684\u7f13\u51b2\u533a\u4e2d\u3002</li> <li>Window Division Table (\u7a97\u53e3\u5212\u5206\u8868) \u7684\u66f4\u65b0\uff1a\u6bcf\u8bb0\u5f55\u6ee1\u4e00\u4e2a\u7a97\u53e3\u5927\u5c0f (Window Size) \u7684\u672a\u547d\u4e2d\uff08\u4f8b\u5982\uff0c\u9ed8\u8ba4\u4e3aL2\u7f13\u5b58\u5927\u5c0f\u7684\u4e00\u534a\uff09\uff0c\u5c31\u5c06\u5f53\u524d\u7684 Cur Struct Read counter \u503c\u5199\u5165\u7a97\u53e3\u5212\u5206\u8868\u3002\u8fd9\u4e2a\u503c\u4ee3\u8868\u4e86\u5728\u8bb0\u5f55\u8be5\u7a97\u53e3\u5185\u6240\u6709\u672a\u547d\u4e2d\u65f6\uff0c\u7a0b\u5e8f\u5bf9\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u603b\u8bbf\u95ee\u6b21\u6570\uff0c\u4ece\u800c\u9690\u542b\u4e86\u8be5\u7a97\u53e3\u7684\u672a\u547d\u4e2d\u7387\u4fe1\u606f\u3002</li> <li>\u4e3a\u4e86\u6700\u5c0f\u5316\u5199\u6d41\u91cf\uff0c\u5143\u6570\u636e\u5199\u56de\u4ee564B\u7f13\u5b58\u884c\u7c92\u5ea6\u8fdb\u884c\u6279\u5904\u7406\u3002</li> <li>\u4e3a\u52a0\u901f\u865a\u62df\u5730\u5740\u5230\u7269\u7406\u5730\u5740\u7684\u8f6c\u6362\uff0c\u786c\u4ef6\u7ef4\u62a4\u4e86\u4e00\u4e2a4MB\u5927\u9875\u7684\u7269\u7406\u9875\u5730\u5740\u7f13\u51b2\u533a\uff0c\u907f\u514d\u4e86\u5bf9\u6bcf\u4e2a\u5143\u6570\u636e\u5199\u5165\u90fd\u8fdb\u884cTLB\u67e5\u627e\u3002</li> </ul> <p></p> <p>Fig. 4. RnR system architecture.</p> <p>\u5173\u952e\u53c2\u6570\u8bbe\u7f6e</p> <ul> <li>\u8bb0\u5f55\u4f4d\u7f6e\uff1a\u79c1\u6709L2\u7f13\u5b58\u3002\u8fd9\u662f\u6743\u8861\u4e86\u5c40\u90e8\u6027\u8fc7\u6ee4\u6548\u679c\u548c\u5b9e\u73b0\u590d\u6742\u5ea6\u540e\u7684\u6700\u4f73\u9009\u62e9\u3002</li> <li>\u76ee\u6807\u5730\u5740\u8303\u56f4\uff1a\u7531\u7a0b\u5e8f\u5458\u901a\u8fc7 <code>RnR.AddrBase.set(base_addr, size)</code> \u663e\u5f0f\u6307\u5b9a\uff0c\u786e\u4fdd\u53ea\u8bb0\u5f55\u76f8\u5173\u6570\u636e\u7ed3\u6784\u7684\u8bbf\u95ee\u3002</li> <li>\u7a97\u53e3\u5927\u5c0f (Window Size)\uff1a\u8fd9\u662f\u4e00\u4e2a\u6838\u5fc3\u53c2\u6570\uff0c\u5b9a\u4e49\u4e86\u8282\u594f\u63a7\u5236\u7684\u7c92\u5ea6\u3002</li> <li>\u9ed8\u8ba4\u503c\u8bbe\u4e3aL2\u7f13\u5b58\u5927\u5c0f\u7684\u4e00\u534a\uff0c\u4ee5\u652f\u6301\u53cc\u7f13\u51b2\u7b56\u7565\u3002</li> <li>\u5b9e\u9a8c\u8868\u660e\uff0c\u7a97\u53e3\u5927\u5c0f\u5728 64\u52302048\u4e2a\u7f13\u5b58\u884c\u4e4b\u95f4\u80fd\u53d6\u5f97\u8f83\u597d\u7684\u6027\u80fd\u4e0e\u5b58\u50a8\u5f00\u9500\u5e73\u8861\u3002\u8fc7\u5c0f\u7684\u7a97\u53e3\u4f1a\u589e\u52a0\u5143\u6570\u636e\u5f00\u9500\u5e76\u964d\u4f4e\u6709\u6548\u6027\u3002</li> </ul> \u7a97\u53e3\u5927\u5c0f\u5f71\u54cd \u6027\u80fd\u5f71\u54cd \u5b58\u50a8\u5f00\u9500\u5f71\u54cd \u8fc7\u5c0f (&lt;64 CL) \u663e\u8457\u964d\u4f4e\u9884\u53d6\u6709\u6548\u6027 \u663e\u8457\u589e\u52a0\uff08\u7a97\u53e3\u5212\u5206\u8868\u53d8\u5927\uff09 \u9002\u4e2d (64-2048 CL) \u901f\u5ea6\u63d0\u5347\u7a33\u5b9a\u4e14\u9ad8 \u5f00\u9500\u53ef\u63a7 \u8fc7\u5927 (&gt;L2/2) \u53ef\u80fd\u5bfc\u81f4\u9884\u53d6\u6570\u636e\u5728L2\u4e2d\u88ab\u8fc7\u65e9\u9a71\u9010 \u51cf\u5c11\uff0c\u4f46\u5931\u53bb\u7cbe\u7ec6\u63a7\u5236\u4f18\u52bf <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165\uff1a</li> <li>\u8f6f\u4ef6\u6307\u4ee4\uff1a\u5b9a\u4e49\u76ee\u6807\u5730\u5740\u8303\u56f4\u3001\u542f\u52a8/\u505c\u6b62\u8bb0\u5f55\u3002</li> <li>\u786c\u4ef6\u4fe1\u53f7\uff1a\u6765\u81ea\u5904\u7406\u5668\u6838\u5fc3\u7684L2\u7f13\u5b58\u672a\u547d\u4e2d\u8bf7\u6c42\u53ca\u5176\u5730\u5740\u3002</li> <li>\u8f93\u51fa\uff1a</li> <li>Sequence Table\uff1a\u4e00\u4e2a\u7cbe\u786e\u7684\u3001\u6309\u65f6\u95f4\u987a\u5e8f\u6392\u5217\u7684\u76ee\u6807\u6570\u636e\u7ed3\u6784L2\u672a\u547d\u4e2d\u7269\u7406\u5730\u5740\u5e8f\u5217\u3002</li> <li>Window Division Table\uff1a\u4e00\u4e2a\u8bb0\u5f55\u4e86\u6bcf\u4e2a\u9884\u53d6\u7a97\u53e3\u5bf9\u5e94\u7a0b\u5e8f\u6267\u884c\u8fdb\u5ea6\uff08\u603b\u7ed3\u6784\u8bbf\u95ee\u6b21\u6570\uff09\u7684\u8868\uff0c\u7528\u4e8e\u63a8\u5bfc\u672a\u547d\u4e2d\u7387\u3002</li> <li>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528\uff1a</li> <li>\u8fd9\u4e24\u4e2a\u8868\u5171\u540c\u6784\u6210\u4e86Record-and-Replay\u673a\u5236\u7684\u201c\u5f55\u97f3\u5e26\u201d\u3002</li> <li>Sequence Table \u63d0\u4f9b\u4e86\u201c\u9884\u53d6\u4ec0\u4e48\u201d\u7684\u7cbe\u786e\u7b54\u6848\uff0c\u4fdd\u8bc1\u4e86\u63a5\u8fd1100%\u7684\u9884\u53d6\u51c6\u786e\u7387\u3002</li> <li>Window Division Table \u63d0\u4f9b\u4e86\u201c\u4f55\u65f6\u4ee5\u53ca\u4ee5\u591a\u5feb\u901f\u5ea6\u9884\u53d6\u201d\u7684\u6307\u5bfc\uff0c\u901a\u8fc7\u5339\u914d\u7a0b\u5e8f\u6267\u884c\u8fdb\u5ea6\u6765\u5b9e\u73b0\u53ca\u65f6\u9884\u53d6 (timely prefetching)\uff0c\u89e3\u51b3\u4e86\u4f20\u7edf\u9884\u53d6\u5668\u56e0\u65f6\u673a\u4e0d\u5f53\u800c\u5bfc\u81f4\u6570\u636e\u88ab\u9a71\u9010\u6216\u5ef6\u8fdf\u7684\u95ee\u9898\u3002\u8fd9\u4e00\u673a\u5236\u7684\u6709\u6548\u6027\u5728\u56fe10\u548c\u56fe11\u4e2d\u5f97\u5230\u4e86\u9a8c\u8bc1\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#5","title":"5. \u4e0e\u73b0\u6709\u9884\u53d6\u5668\u7684\u96c6\u6210\u8bbe\u8ba1","text":"<p>RnR\u4e0e\u73b0\u6709\u9884\u53d6\u5668\u7684\u96c6\u6210\u8bbe\u8ba1</p> <ul> <li>RnR\u5e76\u975e\u65e8\u5728\u53d6\u4ee3\u6240\u6709\u73b0\u6709\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff0c\u800c\u662f\u4f5c\u4e3a\u4e00\u79cd\u4e13\u7528\u8865\u5145\uff0c\u4e0e\u901a\u7528\u9884\u53d6\u5668\u534f\u540c\u5de5\u4f5c\uff0c\u5171\u540c\u4f18\u5316\u7cfb\u7edf\u6027\u80fd\u3002</li> <li>\u5176\u6838\u5fc3\u96c6\u6210\u7b56\u7565\u662f\u901a\u8fc7\u5730\u5740\u8303\u56f4\u8fc7\u6ee4 (address range filtering) \u6765\u5212\u5206\u804c\u8d23\uff0c\u786e\u4fdd\u4e0d\u540c\u7c7b\u578b\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7531\u6700\u9002\u5408\u7684\u9884\u53d6\u5668\u5904\u7406\u3002</li> </ul> <p>\u96c6\u6210\u539f\u7406\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <ul> <li>\u804c\u8d23\u5212\u5206:</li> <li>RnR\u9884\u53d6\u5668: \u4e13\u95e8\u8d1f\u8d23\u5904\u7406\u7531\u7a0b\u5e8f\u5458\u901a\u8fc7\u8f6f\u4ef6\u63a5\u53e3\u6807\u8bb0\u7684\u3001\u5177\u6709\u91cd\u590d\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u7684\u76ee\u6807\u6570\u636e\u7ed3\u6784\uff08\u4f8b\u5982PageRank\u4e2d\u7684<code>pcurr</code>/<code>pnext</code>\u6570\u7ec4\u6216SpMV\u4e2d\u7684\u7a20\u5bc6\u5411\u91cf\uff09\u3002</li> <li>\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668 (\u5982Next-line, BINGO): \u7ee7\u7eed\u5904\u7406\u6240\u6709\u672a\u88abRnR\u6807\u8bb0\u7684\u5730\u5740\u8303\u56f4\u5185\u7684\u5185\u5b58\u8bbf\u95ee\u3002\u8fd9\u5305\u62ec\u5e38\u89c4\u7684\u6d41\u5f0f (streaming) \u6216\u6b65\u957f (stride) \u8bbf\u95ee\u6a21\u5f0f\uff0c\u4f8b\u5982SpMV\u4e2d\u6309\u987a\u5e8f\u8bbf\u95ee\u7684\u7a00\u758f\u77e9\u9635CSR\u683c\u5f0f\u7684\u884c\u6307\u9488\u548c\u5217\u7d22\u5f15\u6570\u7ec4\u3002</li> <li>\u8fc7\u6ee4\u673a\u5236\u5b9e\u73b0:</li> <li>\u5728\u5904\u7406\u5668\u6d41\u6c34\u7ebf\u4e2d\uff0c\u5f53\u53d1\u751fL2 Cache Miss\u65f6\uff0c\u8be5\u8bf7\u6c42\u4f1a\u9996\u5148\u7ecf\u8fc7RnR\u6a21\u5757\u7684\u68c0\u67e5\u3002</li> <li>RnR\u6a21\u5757\u5185\u90e8\u7ef4\u62a4\u4e00\u4e2a\u7531\u8f6f\u4ef6\u914d\u7f6e\u7684\u8fb9\u754c\u68c0\u67e5\u5730\u5740\u5bc4\u5b58\u5668 (boundary checking address registers) \u5217\u8868\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u6240\u6709\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u865a\u62df\u5730\u5740\u8303\u56f4\u3002</li> <li>\u786c\u4ef6\u4f1a\u68c0\u67e5\u5f53\u524dMiss\u8bf7\u6c42\u7684\u5730\u5740\u662f\u5426\u843d\u5728\u4efb\u4f55\u4e00\u4e2a\u5df2\u542f\u7528\u7684\u8fb9\u754c\u8303\u56f4\u5185\u3002<ul> <li>\u5982\u679c\u5728\u8303\u56f4\u5185\uff0c\u8be5\u8bf7\u6c42\u5c06\u88ab\u6807\u8bb0\u4e3aRnR\u76ee\u6807\uff0c\u5e76\u4ea4\u7531RnR\u7684Record\u6216Replay\u903b\u8f91\u5904\u7406\uff0c\u540c\u65f6\u6392\u9664\u5728\u4f20\u7edfL2\u6d41\u5f0f\u9884\u53d6\u5668\u7684\u8bad\u7ec3\u8303\u56f4\u4e4b\u5916\u3002</li> <li>\u5982\u679c\u4e0d\u5728\u8303\u56f4\u5185\uff0c\u8be5\u8bf7\u6c42\u5c06\u88ab\u5ffd\u7565\uff0c\u53ef\u4ee5\u88ab\u5176\u4ed6\u4f20\u7edf\u7684\u786c\u4ef6\u9884\u53d6\u5668\uff08\u5982L2 Stream Prefetcher\uff09\u6b63\u5e38\u89c2\u5bdf\u548c\u8bad\u7ec3\u3002</li> </ul> </li> <li>\u534f\u540c\u4f18\u52bf:</li> <li>\u8fd9\u79cd\u8bbe\u8ba1\u907f\u514d\u4e86\u4f20\u7edf\u9884\u53d6\u5668\u56e0\u5c1d\u8bd5\u9884\u6d4b\u590d\u6742\u7684\u4e0d\u89c4\u5219\u6a21\u5f0f\u800c\u4ea7\u751f\u7684\u4f4e\u51c6\u786e\u7387\u548c\u9ad8\u5e26\u5bbd\u6d6a\u8d39\u95ee\u9898\u3002</li> <li>\u540c\u65f6\uff0c\u4e5f\u907f\u514d\u4e86RnR\u53bb\u5904\u7406\u7b80\u5355\u3001\u9ad8\u6548\u7684\u6d41\u5f0f\u6a21\u5f0f\uff0c\u56e0\u4e3a\u4e13\u7528\u7684\u6d41\u5f0f\u9884\u53d6\u5668\uff08\u5982Next-line\uff09\u5728\u8fd9\u4e9b\u573a\u666f\u4e0b\u6548\u7387\u66f4\u9ad8\u3001\u5f00\u9500\u66f4\u5c0f\u3002</li> </ul> <p></p> <p>Fig. 4. RnR system architecture.</p> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u8f93\u5165\u8f93\u51fa\u5173\u7cfb</p> <ul> <li>\u8f93\u5165:</li> <li>\u8f6f\u4ef6\u8f93\u5165: \u7a0b\u5e8f\u5458\u901a\u8fc7API\uff08\u5982<code>RnR.AddrBase.set(base_addr, size)</code>\u548c<code>RnR.AddrBase.enable()</code>\uff09\u5411\u786c\u4ef6\u63d0\u4f9b\u76ee\u6807\u6570\u636e\u7ed3\u6784\u7684\u57fa\u5730\u5740 (base address) \u548c\u5927\u5c0f (size)\u3002\u8fd9\u4e9b\u4fe1\u606f\u88ab\u5199\u5165RnR\u7684\u8fb9\u754c\u5bc4\u5b58\u5668\uff0c\u5b9a\u4e49\u4e86\u8fc7\u6ee4\u7684\u5730\u5740\u8303\u56f4\u3002</li> <li>\u786c\u4ef6\u8f93\u5165: \u6765\u81eaL2 Cache\u7684Miss\u8bf7\u6c42\u5730\u5740\u3002</li> <li>\u8f93\u51fa:</li> <li>\u5bf9RnR\u5185\u90e8: \u5730\u5740\u5339\u914d\u7ed3\u679c\u51b3\u5b9a\u4e86\u662f\u5426\u542f\u52a8\u8bb0\u5f55\u6216\u91cd\u653e\u903b\u8f91\u3002</li> <li>\u5bf9\u5176\u4ed6\u9884\u53d6\u5668: \u901a\u8fc7\u8fc7\u6ee4\u673a\u5236\uff0c\u4e3a\u5176\u4ed6\u9884\u53d6\u5668\u63d0\u4f9b\u4e86\u4e00\u4e2a\u201c\u5e72\u51c0\u201d\u7684\u3001\u4e0d\u542b\u590d\u6742\u4e0d\u89c4\u5219\u6a21\u5f0f\u7684\u8bbf\u95ee\u6d41\uff0c\u4f7f\u5176\u80fd\u66f4\u4e13\u6ce8\u3001\u9ad8\u6548\u5730\u5de5\u4f5c\u3002</li> <li>\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528:</li> <li>\u8be5\u96c6\u6210\u8bbe\u8ba1\u4f7f\u5f97RnR\u80fd\u591f\u65e0\u7f1d\u5d4c\u5165\u5230\u73b0\u4ee3\u5904\u7406\u5668\u590d\u6742\u7684\u9884\u53d6\u5668\u751f\u6001\u7cfb\u7edf\u4e2d\u3002</li> <li>\u5b83\u5145\u5f53\u4e86\u4e00\u4e2a\u667a\u80fd\u5206\u6d41\u5668 (smart traffic director) \u7684\u89d2\u8272\uff0c\u5c06\u5185\u5b58\u8bbf\u95ee\u6d41\u7cbe\u51c6\u5730\u5bfc\u5411\u6700\u5408\u9002\u7684\u9884\u53d6\u5f15\u64ce\uff0c\u4ece\u800c\u5728\u6574\u4f53\u4e0a\u5b9e\u73b0\u4e86\u66f4\u9ad8\u7684\u9884\u53d6\u51c6\u786e\u7387\u3001\u66f4\u4f4e\u7684\u65e0\u6548\u5e26\u5bbd\u6d88\u8017\u4ee5\u53ca\u66f4\u4f18\u7684\u7cfb\u7edf\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#4","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u91c7\u7528 ChampSim\uff08DPC3\u5b98\u65b9\u6a21\u62df\u5668\uff09\u8fdb\u884ctrace-based simulation\u3002</li> <li>\u6a21\u62df\u914d\u7f6e\u57fa\u4e8e Intel i7-6700\uff0c\u5177\u4f53\u53c2\u6570\u5982\u4e0b\u8868\u6240\u793a\u3002</li> <li>\u4f7f\u7528 PIN tool \u63d0\u53d6\u5e94\u7528\u6838\u5fc3\uff08ROI\uff09\u7684\u6307\u4ee4\u548c\u5185\u5b58\u8bbf\u95ee\u8f68\u8ff9\u3002</li> <li>\u6a21\u62df\u6d41\u7a0b\u5305\u62ec 2000\u4e07\u6761\u6307\u4ee4\u9884\u70ed \u548c \u81f3\u5c115\u4ebf\u6761\u6307\u4ee4\u7684\u6838\u5fc3\u6267\u884c\u3002</li> <li>\u8bc4\u4f30\u4e86\u4e09\u7c7b\u5177\u6709\u91cd\u590d\u8bbf\u95ee\u6a21\u5f0f\u7684\u5e94\u7528\uff1a<ul> <li>PageRank (\u6765\u81ea Ligra)</li> <li>sparse CG (spCG) (\u6765\u81ea Adept)</li> <li>Hyper-anf (\u6765\u81ea x-stream)</li> </ul> </li> <li>\u8f93\u5165\u6570\u636e\u96c6\u6db5\u76d6\u4e0d\u540c\u7279\u6027\u7684\u56fe\u548c\u7a00\u758f\u77e9\u9635\uff0c\u8be6\u60c5\u89c1\u4e0b\u8868\u3002</li> <li>\u5e94\u7528\u4ee5 SPMD (Single Program Multiple Data) \u6a21\u578b\u5b9e\u73b0\uff0c\u5e76\u4f7f\u7528 METIS \u8fdb\u884c\u56db\u8def\u56fe\u5212\u5206\u3002</li> </ul> <p></p> <p>TABLE IIBASELINE CONFIGURATION.</p> <p></p> <p>TABLE III INPUT DATASETS.</p> <p>\u7ed3\u679c\u6570\u636e\u5206\u6790</p> <ul> <li>\u6027\u80fd\u63d0\u5347 (Speedup):<ul> <li>RnR \u5728\u6240\u6709\u6d4b\u8bd5\u8d1f\u8f7d\u4e0a\u5747\u53d6\u5f97\u6700\u4f73\u6027\u80fd\u3002</li> <li>\u5bf9 PageRank, Hyper-Anf, spCG \u5206\u522b\u5b9e\u73b0\u4e86 2.11\u00d7, 2.23\u00d7, 2.90\u00d7 \u7684\u5e73\u5747\u52a0\u901f\u6bd4\u3002</li> <li>\u5728\u968f\u673a\u56fe urand \u4e0a\u4f18\u52bf\u5c24\u4e3a\u660e\u663e\uff0c\u56e0\u4e3a\u5176\u6781\u5dee\u7684\u5c40\u90e8\u6027\u4f7f\u4f20\u7edf\u786c\u4ef6\u9884\u53d6\u5668\u5931\u6548\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 6. Speedup over no prefetcher baseline.</p> <ul> <li>\u7f13\u5b58\u7f3a\u5931\u7387 (L2 MPKI):</li> </ul> <p></p> <p>Fig. 7. L2 MPKI.</p> <ul> <li>\u9884\u53d6\u8986\u76d6\u7387 (Miss Coverage):<ul> <li>\u8986\u76d6\u7387\u8861\u91cf\u9884\u53d6\u5668\u80fd\u6d88\u9664\u591a\u5c11\u57fa\u7ebf\u7f3a\u5931\u3002RnR \u5e73\u5747\u8fbe\u5230 91.4% (PageRank), 84.5% (Hyper-Anf), 88.7% (spCG)\u3002</li> <li>\u8fdc\u9ad8\u4e8e\u5176\u4ed6\u901a\u7528\u9884\u53d6\u5668\uff08\u5982 SteMS, Bingo\uff09\uff0c\u56e0\u4e3a RnR \u80fd\u7cbe\u786e\u6355\u83b7\u6574\u4e2a\u91cd\u590d\u5e8f\u5217\uff0c\u800c\u975e\u4f9d\u8d56\u5171\u4eab\u6a21\u5f0f\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 8. Miss coverage.</p> <ul> <li>\u9884\u53d6\u51c6\u786e\u7387 (Prefetching Accuracy):<ul> <li>\u51c6\u786e\u7387\u8861\u91cf\u53d1\u51fa\u7684\u9884\u53d6\u8bf7\u6c42\u4e2d\u6709\u591a\u5c11\u662f\u6709\u7528\u7684\u3002RnR \u5e73\u5747\u51c6\u786e\u7387\u8fbe\u5230 97.18%\u3002</li> <li>\u9ad8\u51c6\u786e\u7387\u6e90\u4e8e\u5176\u201c\u8bb0\u5f55-\u56de\u653e\u201d\u673a\u5236\uff0c\u907f\u514d\u4e86\u6a21\u5f0f\u5339\u914d\u9519\u8bef\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 9. Prefetcher accuracy.</p> <ul> <li>\u989d\u5916\u7247\u5916\u6d41\u91cf (Additional Off-chip Traffic):<ul> <li>RnR \u7684\u989d\u5916\u6d41\u91cf\u4e3b\u8981\u6765\u81ea\u5143\u6570\u636e\u8bbf\u95ee\uff0c\u800c\u975e\u65e0\u6548\u9884\u53d6\u3002</li> <li>\u5176\u603b\u6d41\u91cf\u5f00\u9500\uff0812.0%\uff09\u4e0e\u9886\u57df\u4e13\u7528\u9884\u53d6\u5668 DROPLET\uff0812.2%\uff09\u76f8\u5f53\uff0c\u4f46\u8fdc\u4f4e\u4e8e\u901a\u7528\u9884\u53d6\u5668\uff08\u5982 Bingo 67.1%\uff09\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 12. Additional off-chip traffic.</p> <p>\u6d88\u878d\u5b9e\u9a8c (Ablation Study)</p> <ul> <li>\u91cd\u653e\u65f6\u5e8f\u63a7\u5236\u7684\u6709\u6548\u6027:<ul> <li>\u5b9e\u9a8c\u5bf9\u6bd4\u4e86\u4e09\u79cd\u65b9\u6848\uff1a\u65e0\u63a7\u5236\u3001\u4ec5\u7a97\u53e3\u63a7\u5236\u3001\u7a97\u53e3+\u6b65\u8c03\u63a7\u5236\u3002</li> <li>\u65e0\u63a7\u5236 \u7684\u65b9\u6848\u56e0\u9884\u53d6\u8fc7\u65e9\uff08\u6570\u636e\u88ab\u9a71\u9010\uff09\u6216\u8fc7\u665a\u800c\u51e0\u4e4e\u65e0\u6027\u80fd\u6536\u76ca\u3002</li> <li>\u7a97\u53e3\u63a7\u5236 \u901a\u8fc7\u5339\u914d\u7a0b\u5e8f\u8fdb\u5ea6\u6765\u8c03\u6574\u9884\u53d6\u6fc0\u8fdb\u7a0b\u5ea6\uff0c\u5e26\u6765\u4e86\u663e\u8457\u7684 2.31\u00d7 \u52a0\u901f\u3002</li> <li>\u7a97\u53e3+\u6b65\u8c03\u63a7\u5236 \u5728\u7a97\u53e3\u5185\u5747\u5300\u5206\u5e03\u9884\u53d6\u8bf7\u6c42\uff0c\u8fdb\u4e00\u6b65\u5fae\u8c03\u4e86\u6027\u80fd\uff0c\u4f46\u5728\u5927\u591a\u6570\u8d1f\u8f7d\u4e0a\u63d0\u5347\u6709\u9650\uff0c\u4ec5\u5728 urand \u56fe\u4e0a\u7565\u5fae\u51cf\u5c11\u4e86\u65e9\u671f\u9884\u53d6\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 10. Effectiveness of replay timing control.</p> <pre><code>-\n</code></pre> <p></p> <p>Fig. 11. Prefetch timeliness breakdown (Left bar: no control, middle bar: window control, right bar: window+pace control).</p> <ul> <li>\u7a97\u53e3\u5927\u5c0f (Window Size) \u7684\u5f71\u54cd:<ul> <li>\u7a97\u53e3\u5927\u5c0f\u51b3\u5b9a\u4e86\u8c03\u6574\u9884\u53d6\u901f\u5ea6\u7684\u7c92\u5ea6\u3002</li> <li>\u5b9e\u9a8c\u53d1\u73b0\uff0c\u5728 64 \u5230 2048 \u4e2a cache line \u7684\u8303\u56f4\u5185\uff0c\u6027\u80fd\u548c\u5b58\u50a8\u5f00\u9500\u90fd\u76f8\u5bf9\u7a33\u5b9a\u3002</li> <li>\u7a97\u53e3\u8fc7\u5c0f\uff08&lt;64\uff09\u4f1a\u663e\u8457\u964d\u4f4e\u9884\u53d6\u6548\u679c\u5e76\u589e\u52a0\u5143\u6570\u636e\uff08\u7a97\u53e3\u5212\u5206\u8868\uff09\u7684\u5b58\u50a8\u5f00\u9500\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Fig. 14. Average speedup and storage for different window sizes.</p> <ul> <li>\u8bb0\u5f55\u8fed\u4ee3\u5f00\u9500 (Record Iteration Overhead):<ul> <li>\u7b2c\u4e00\u6b21\u8bb0\u5f55\u8fed\u4ee3\u4f1a\u4ea7\u751f\u5199\u5165\u5143\u6570\u636e\u7684\u5f00\u9500\u3002</li> <li>\u7531\u4e8e\u5199\u64cd\u4f5c\u4e0d\u5728\u5173\u952e\u8def\u5f84\u4e0a\uff0c\u4e14\u4f7f\u7528\u975e\u4e34\u65f6\u5b58\u50a8\uff08non-temporal stores\uff09\uff0c\u5f00\u9500\u88ab\u6709\u6548\u9690\u85cf\u3002</li> <li>\u5e73\u5747\u4ec5\u5bfc\u81f4 1.02% \u7684\u6027\u80fd\u4e0b\u964d\uff0c\u6700\u574f\u60c5\u51b5\uff08PageRank-urand\uff09\u4e5f\u4ec5\u4e3a 1.75%\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/rnr-a-software-assisted-record-and-replay-hardware-prefetcher/paper_notes/#-rnr-combined-pagerank-hyper-anf-spcg-l2-973-946-989","title":"- RnR-Combined \u65b9\u6848\u5c06 PageRank, Hyper-Anf, spCG \u7684 L2 \u7f3a\u5931\u7387\u5206\u522b\u964d\u4f4e\u4e86 97.3%, 94.6%, 98.9%\u3002","text":""},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/ELI5_notes/","title":"RPG2: Robust Profile-Guided Runtime Prefetch Generation \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684\u8f6f\u4ef6\u9884\u53d6\uff08Software Prefetching\uff09\u662f\u4e2a\u201c\u4e00\u6b21\u6027\u4e70\u5356\u201d\u3002\u7f16\u8bd1\u5668\u6216\u5f00\u53d1\u8005\u6839\u636e\u7279\u5b9a\u8f93\u5165\u548c\u7279\u5b9a\u786c\u4ef6\uff0c\u628a\u9884\u53d6\u6307\u4ee4\uff08\u6bd4\u5982 <code>_builtin_prefetch()</code>\uff09\u786c\u7f16\u7801\u8fdb\u7a0b\u5e8f\u91cc\u3002</li> <li>\u8fd9\u5728\u73b0\u5b9e\u4e2d\u975e\u5e38\u8106\u5f31\u3002\u8bba\u6587\u901a\u8fc7\u5927\u91cf\u5b9e\u9a8c\uff08\u5982 Figure 1, 2, 3\uff09\u8bc1\u660e\uff1a\u6700\u4f18\u7684\u9884\u53d6\u8ddd\u79bb\uff08prefetch distance\uff09\u5bf9\u7a0b\u5e8f\u8f93\u5165\u548c\u5904\u7406\u5668\u5fae\u67b6\u6784\u6781\u5ea6\u654f\u611f\u3002</li> <li>\u540c\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6362\u4e00\u4e2a\u6570\u636e\u96c6\uff0c\u6700\u4f73\u9884\u53d6\u8ddd\u79bb\u53ef\u80fd\u4ece 1 \u53d8\u6210 50\u3002</li> <li>\u540c\u4e00\u4e2a\u7a0b\u5e8f\u548c\u6570\u636e\u96c6\uff0c\u5728 Haswell \u548c Cascade Lake \u4e0a\uff0c\u9884\u53d6\u751a\u81f3\u53ef\u80fd\u4ece\u201c\u795e\u52a9\u653b\u201d\u53d8\u6210\u201c\u732a\u961f\u53cb\u201d\uff0c\u5bfc\u81f4 50-70% \u7684\u4e25\u91cd\u6027\u80fd\u4e0b\u964d\uff08Figure 3\uff09\u3002</li> <li>\u9759\u6001\u65b9\u6848\u65e0\u6cd5\u5e94\u5bf9\u8fd9\u79cd\u52a8\u6001\u53d8\u5316\u3002\u4f60\u4e0d\u53ef\u80fd\u4e3a\u6bcf\u4e2a\u53ef\u80fd\u7684\u8f93\u5165\u548c\u6bcf\u79cd\u670d\u52a1\u5668 CPU \u90fd\u7ef4\u62a4\u4e00\u4e2a\u5355\u72ec\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u8fd9\u5c31\u5bfc\u81f4\u5f00\u53d1\u8005\u5bf9\u9884\u53d6\u656c\u800c\u8fdc\u4e4b\uff0c\u56e0\u4e3a\u98ce\u9669\u592a\u9ad8\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u5728\u9ad8\u901f\u516c\u8def\u4e0a\u5f00\u8f66\u53bb\u4e00\u4e2a\u964c\u751f\u57ce\u5e02\u3002\u9759\u6001\u9884\u53d6\u5c31\u50cf\u51fa\u53d1\u524d\uff0c\u4f60\u6839\u636e\u5730\u56feApp\uff08\u57fa\u4e8e\u67d0\u4e2a\u5047\u8bbe\u7684\u8def\u51b5\uff09\u89c4\u5212\u597d\u4e86\u4e00\u4e2a\u56fa\u5b9a\u7684\u52a0\u6cb9\u70b9\u3002</li> <li>\u4f46\u5982\u679c\u8def\u4e0a\u7a81\u7136\u5927\u5835\u8f66\uff08\u8f93\u5165\u53d8\u4e86\uff09\uff0c\u6216\u8005\u4f60\u7684\u8f66\u662f\u7535\u8f66\u800cApp\u6309\u6cb9\u8f66\u89c4\u5212\u7684\uff08\u5fae\u67b6\u6784\u53d8\u4e86\uff09\uff0c\u8fd9\u4e2a\u56fa\u5b9a\u7684\u52a0\u6cb9\u70b9\u5c31\u5b8c\u5168\u5931\u6548\u4e86\uff0c\u4f60\u53ef\u80fd\u534a\u8def\u629b\u951a\u3002</li> <li>RPG2 \u7684\u505a\u6cd5\u5b8c\u5168\u4e0d\u540c\uff1a\u5b83\u7ed9\u4f60\u8f66\u4e0a\u88c5\u4e86\u4e00\u4e2a\u667a\u80fd\u526f\u9a7e\u3002\u8fd9\u4e2a\u526f\u9a7e\u4e00\u8fb9\u5f00\u8f66\uff08\u7a0b\u5e8f\u8fd0\u884c\uff09\uff0c\u4e00\u8fb9\u5b9e\u65f6\u89c2\u5bdf\u6cb9\u8868\uff08\u6027\u80fd\u8ba1\u6570\u5668\uff09\u3001\u8def\u51b5\uff08\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff09\uff0c\u5e76\u80fd\u52a8\u6001\u5730\u3001\u5b89\u5168\u5730\u51b3\u5b9a\uff1a</li> <li>\u8981\u4e0d\u8981\u4e2d\u9014\u52a0\u6cb9\uff08\u63d2\u5165\u9884\u53d6\uff09\u3002</li> <li>\u5728\u54ea\u91cc\u52a0\u6cb9\u6700\u5408\u9002\uff08\u8c03\u6574\u9884\u53d6\u8ddd\u79bb\uff09\u3002</li> <li>\u5982\u679c\u53d1\u73b0\u52a0\u6cb9\u53cd\u800c\u8ba9\u8f66\u66f4\u6162\u4e86\uff08\u6bd4\u5982\u6392\u961f\u592a\u4e45\uff09\uff0c\u5c31\u7acb\u523b\u53d6\u6d88\u52a0\u6cb9\u8ba1\u5212\uff0c\u8ba9\u4f60\u6309\u539f\u901f\u524d\u8fdb\uff0c\u4fdd\u8bc1\u4e0d\u6bd4\u539f\u6765\u66f4\u5dee\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>RPG2 \u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\u6784\u5efa\u4e86\u4e00\u4e2a\u7eaf\u8f6f\u4ef6\u7684\u3001\u5728\u7ebf\u7684\u3001\u53ef\u56de\u6eda\u7684\u9884\u53d6\u4f18\u5316\u95ed\u73af\u3002\u5b83\u6ca1\u6709\u53d1\u660e\u65b0\u7684\u9884\u53d6\u7b97\u6cd5\uff0c\u800c\u662f\u5de7\u5999\u5730\u6539\u9020\u4e86\u6574\u4e2a\u4f18\u5316\u6d41\u7a0b\uff1a</p> <ul> <li>\u4f5c\u8005\u5e76\u6ca1\u6709\u4f9d\u8d56\u9759\u6001\u7f16\u8bd1\uff0c\u800c\u662f\u6784\u5efa\u4e86\u4e00\u4e2a\u56db\u9636\u6bb5\u7684\u8fd0\u884c\u65f6\u7cfb\u7edf\uff08Figure 4\uff09\uff1a</li> <li>Profile\uff08\u5256\u6790\uff09: \u7a0b\u5e8f\u8dd1\u8d77\u6765\u540e\uff0c\u7528\u786c\u4ef6\u6027\u80fd\u8ba1\u6570\u5668\uff08PEBS\uff09\u5b9e\u65f6\u627e\u51fa\u9020\u6210 LLC Miss \u7684\u70ed\u70b9\u6307\u4ee4\u3002</li> <li>Generate\uff08\u751f\u6210\uff09: \u5229\u7528 BOLT\uff08\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f18\u5316\u5de5\u5177\uff09\u4f5c\u4e3a\u540e\u7aef\uff0c\u5728\u4e0d\u63a5\u89e6\u6e90\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u4e3a\u76ee\u6807\u51fd\u6570\u751f\u6210\u4e00\u4e2a\u5e26\u9884\u53d6\u5185\u6838\uff08prefetch kernel\uff09\u7684\u65b0\u7248\u672c\u3002\u8fd9\u4e2a\u5185\u6838\u88ab\u8bbe\u8ba1\u6210\u903b\u8f91\u4e0a\u7684 NOP\uff0c\u4fdd\u8bc1\u8bed\u4e49\u4e0d\u53d8\u3002</li> <li>Insert\uff08\u63d2\u5165\uff09: \u8fd9\u662f\u6700 tricky \u7684\u4e00\u6b65\u3002\u4f5c\u8005\u6ca1\u6709\u7b80\u5355\u5730\u8986\u76d6\u539f\u51fd\u6570\uff0c\u800c\u662f\u5c06\u65b0\u51fd\u6570\u653e\u5728\u65b0\u5730\u5740\uff0c\u5e76\u5b9e\u73b0\u4e86\u9488\u5bf9 C/C++ \u7684 On-Stack Replacement (OSR)\u3002\u8fd9\u610f\u5473\u7740\u5373\u4f7f\u51fd\u6570\u6b63\u5728\u6267\u884c\u4e2d\uff0c\u4e5f\u80fd\u5b89\u5168\u5730\u5c06\u6267\u884c\u6d41\u5207\u6362\u5230\u5e26\u9884\u53d6\u7684\u65b0\u7248\u672c\uff08Figure 6\uff09\u3002</li> <li> <p>Tune &amp; Rollback\uff08\u8c03\u4f18\u4e0e\u56de\u6eda\uff09: \u7cfb\u7edf\u4f1a\u5728\u7ebf\u641c\u7d22\u6700\u4f18\u7684\u9884\u53d6\u8ddd\u79bb\u3002\u6700\u5173\u952e\u7684\u662f\uff0c\u5982\u679c\u53d1\u73b0\u4efb\u4f55\u9884\u53d6\u8ddd\u79bb\u90fd\u65e0\u6cd5\u8d85\u8d8a\u539f\u59cb\u6027\u80fd\uff0c\u5b83\u4f1a\u5229\u7528 OSR \u65e0\u7f1d\u5207\u56de\u539f\u59cb\u4ee3\u7801\uff0c\u5f7b\u5e95\u89c4\u907f\u4e86\u9884\u53d6\u5e26\u6765\u7684\u6027\u80fd\u98ce\u9669\u3002</p> </li> <li> <p>\u8fd9\u5957\u673a\u5236\u7684\u6838\u5fc3\u4fdd\u969c\u662f BOLT Address Translation Table (BATT)\uff0c\u5b83\u50cf\u4e00\u5f20\u7cbe\u786e\u7684\u5730\u56fe\uff0c\u8ba9\u7cfb\u7edf\u80fd\u5728\u65b0\u65e7\u4e24\u4e2a\u51fd\u6570\u7248\u672c\u7684\u4efb\u610f\u6307\u4ee4\u95f4\u8fdb\u884c\u5b89\u5168\u8f6c\u6362\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u201c\u5927\u80c6\u5c1d\u8bd5\uff0c\u4e0d\u884c\u5c31\u64a4\u201d\u7684\u9c81\u68d2\u6027\u3002\u8fd9\u6b63\u662f RPG2 \u540d\u5b57\u4e2d \u201cRobust\u201d \u7684\u771f\u6b63\u542b\u4e49\u3002</p> </li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/ELI5_notes/#1-bolt-eli5","title":"1. \u57fa\u4e8eBOLT\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u5206\u6790\u4e0e\u751f\u6210 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684 profile-guided prefetching\uff08\u5982 APT-GET\uff09\u90fd\u662f\u5728\u7f16\u8bd1\u671f\u9759\u6001\u5b8c\u6210\u7684\u3002\u8fd9\u610f\u5473\u7740\u4f60\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u7a0b\u5e8f\u3001\u6bcf\u79cd\u8f93\u5165\u3001\u751a\u81f3\u6bcf\u79cd CPU \u5fae\u67b6\u6784\uff0c\u90fd\u9884\u5148\u8dd1\u4e00\u904d profiling\uff0c\u7136\u540e\u751f\u6210\u4e00\u4e2a\u4e13\u7528\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u8fd9\u5728\u73b0\u5b9e\u4e2d\u51e0\u4e4e\u4e0d\u53ef\u884c\uff1a\u7a0b\u5e8f\u8f93\u5165\u5343\u53d8\u4e07\u5316\uff08\u6bd4\u5982\u56fe\u7b97\u6cd5\u8dd1\u4e0d\u540c\u89c4\u6a21\u7684\u793e\u4ea4\u7f51\u7edc\uff09\uff0cCPU \u578b\u53f7\u4e5f\u5404\u4e0d\u76f8\u540c\uff08Haswell vs. Cascade Lake\uff09\u3002\u4e00\u4e2a\u5728 A \u8f93\u5165\u4e0a\u6700\u4f18\u7684\u9884\u53d6\u8ddd\u79bb\uff0c\u5728 B \u8f93\u5165\u4e0a\u53ef\u80fd\u76f4\u63a5\u5bfc\u81f4 50% \u7684\u6027\u80fd\u4e0b\u964d\uff08\u89c1 Figure 3\uff09\u3002</li> <li>\u66f4\u9ebb\u70e6\u7684\u662f\uff0c\u5f88\u591a\u7a0b\u5e8f\u6839\u672c\u62ff\u4e0d\u5230\u6e90\u7801\uff0c\u53ea\u6709\u4e8c\u8fdb\u5236\u3002\u9759\u6001\u7f16\u8bd1\u5668\u5bf9\u6b64\u675f\u624b\u65e0\u7b56\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u8981\u7ed9\u4e00\u8f86\u6b63\u5728\u9ad8\u901f\u884c\u9a76\u7684\u6c7d\u8f66\u6362\u8f6e\u80ce\u3002\u4f20\u7edf\u65b9\u6cd5\u662f\uff1a\u628a\u8f66\u5f00\u56de\u8f66\u5e93\uff08\u505c\u673a\uff09\uff0c\u62c6\u6389\u65e7\u8f6e\u5b50\uff0c\u88c5\u4e0a\u65b0\u8f6e\u5b50\uff08\u91cd\u65b0\u7f16\u8bd1\uff09\uff0c\u518d\u5f00\u51fa\u53bb\u3002\u4f46\u5982\u679c\u8def\u51b5\uff08\u8f93\u5165\u6570\u636e\uff09\u968f\u65f6\u5728\u53d8\uff0c\u4f60\u603b\u4e0d\u80fd\u9891\u7e41\u505c\u8f66\u6362\u80ce\u3002</li> <li>RPG2 \u7684\u505a\u6cd5\u66f4\u50cf\u662f\u201c\u8fb9\u5f00\u8fb9\u6362\u201d\uff1a\u5b83\u5148\u89c2\u5bdf\u8f66\u5b50\u8dd1\u5f97\u600e\u4e48\u6837\uff08Profiling\uff09\uff0c\u7136\u540e\u5728\u540e\u5907\u7bb1\u91cc\u5feb\u901f\u9020\u4e00\u4e2a\u65b0\u8f6e\u80ce\uff08BOLT \u751f\u6210\u65b0\u4ee3\u7801\uff09\uff0c\u627e\u4e2a\u670d\u52a1\u533a\u77ed\u6682\u9760\u8fb9\uff08ptrace \u6682\u505c\uff09\uff0c\u51e0\u79d2\u949f\u5185\u628a\u65b0\u8f6e\u80ce\u6362\u4e0a\uff08Runtime Code Insertion\uff09\uff0c\u5982\u679c\u53d1\u73b0\u65b0\u8f6e\u80ce\u53cd\u800c\u66f4\u98a0\u7c38\uff0c\u8fd8\u80fd\u7acb\u523b\u6362\u56de\u539f\u6765\u7684\uff08Rollback\uff09\u3002</li> <li>\u800c BOLT \u5c31\u662f\u90a3\u4e2a\u80fd\u5728\u540e\u5907\u7bb1\u91cc\u5feb\u901f\u3001\u7cbe\u51c6\u5730\u5236\u9020\u51fa\u5b8c\u7f8e\u5339\u914d\u65b0\u8f66\u8f6e\u7684\u201c\u79fb\u52a8\u4fee\u8f66\u5382\u201d\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u5e76\u6ca1\u6709\u8bd5\u56fe\u53bb\u4fee\u6539\u6216\u66ff\u6362\u6574\u4e2a\u7f16\u8bd1\u5de5\u5177\u94fe\uff0c\u800c\u662f\u5de7\u5999\u5730\u5c06\u4ed6\u4eec\u7684\u9884\u53d6\u903b\u8f91\u5c01\u88c5\u6210\u4e00\u4e2a BOLT Pass\uff08\u5177\u4f53\u53eb <code>InjectPrefetchPass</code>\uff09\uff0c\u76f4\u63a5\u4f5c\u7528\u4e8e\u7a0b\u5e8f\u7684 \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u8fd9\u4e2a Pass \u7684\u6838\u5fc3\u5de5\u4f5c\u6d41\u662f\uff1a</li> <li>\u8bc6\u522b\u70ed\u70b9\uff1a\u901a\u8fc7\u5206\u6790 PEBS \u91c7\u6837\u5230\u7684 LLC Miss \u4fe1\u606f\uff0c\u5b9a\u4f4d\u5230\u9020\u6210\u6700\u591a\u7f13\u5b58\u672a\u547d\u4e2d\u7684\u90a3\u51e0\u6761 load \u6307\u4ee4\u3002</li> <li>\u6a21\u5f0f\u5339\u914d\uff1a\u5bf9\u8fd9\u4e9b load \u6307\u4ee4\u8fdb\u884c backward slicing\uff0c\u8ffd\u6eaf\u5176\u5730\u5740\u8ba1\u7b97\u4f9d\u8d56\uff0c\u5e76\u5c06\u5176\u5f52\u7c7b\u5230\u9884\u5b9a\u4e49\u7684\u4e09\u79cd\u53ef\u9884\u53d6\u6a21\u5f0f\u4e2d\uff08\u89c1 Table 1\uff09\u3002\u8fd9\u4e00\u6b65\u7684\u5173\u952e\u5728\u4e8e\uff0c\u5b83\u80fd\u5904\u7406\u590d\u6742\u7684 indirect memory access\uff08\u5982 <code>a[b[i]]</code>\uff09\uff0c\u800c\u8fd9\u6b63\u662f\u786c\u4ef6\u9884\u53d6\u5668\u7684\u8f6f\u808b\u3002</li> <li>\u751f\u6210\u5185\u6838\uff1a\u4e00\u65e6\u6a21\u5f0f\u5339\u914d\u6210\u529f\uff0c\u5c31\u5728\u5bf9\u5e94\u7684\u5faa\u73af\u5934\uff08loop header\uff09\u5904\uff0c\u539f\u5730\u63d2\u5165\u4e00\u6bb5\u201c\u9884\u53d6\u5185\u6838\u201d\uff08prefetch kernel\uff09\u3002\u8fd9\u4e2a\u5185\u6838\u4f1a\u7cbe\u786e\u5730\u590d\u5236\u539f\u59cb load \u7684\u5730\u5740\u8ba1\u7b97\u903b\u8f91\uff0c\u4f46\u76ee\u6807\u662f\u63d0\u524d <code>d</code> \u6b65\u8ba1\u7b97\u51fa\u672a\u6765\u8981\u8bbf\u95ee\u7684\u5730\u5740\uff0c\u5e76\u53d1\u51fa <code>_mm_prefetch</code> \u6307\u4ee4\u3002</li> <li>\u4fdd\u8bc1\u5b89\u5168\uff1a\u751f\u6210\u7684\u5185\u6838\u81ea\u5e26 bounds check\uff08\u8fb9\u754c\u68c0\u67e5\uff09\uff0c\u9632\u6b62\u56e0\u9884\u53d6\u8d8a\u754c\u800c\u5f15\u53d1\u6bb5\u9519\u8bef\u3002\u540c\u65f6\uff0c\u5b83\u88ab\u8bbe\u8ba1\u6210\u4e00\u4e2a\u903b\u8f91\u4e0a\u7684 NOP\uff0c\u5373\u9664\u4e86\u9884\u53d6\u884c\u4e3a\u5916\uff0c\u4e0d\u4f1a\u6539\u53d8\u4efb\u4f55\u5bc4\u5b58\u5668\u6216\u5185\u5b58\u72b6\u6001\uff0c\u786e\u4fdd\u8bed\u4e49\u6b63\u786e\u6027\u3002</li> <li>\u6700\u7ec8\uff0cBOLT \u8f93\u51fa\u4e00\u4e2a\u5168\u65b0\u7684\u3001\u5d4c\u5165\u4e86\u667a\u80fd\u9884\u53d6\u903b\u8f91\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e3a\u540e\u7eed\u7684 \u5728\u7ebf\u8c03\u4f18\uff08Phase 4\uff09\u548c \u8fd0\u884c\u65f6\u66ff\u6362\uff08Phase 3\uff09\u63d0\u4f9b\u4e86\u57fa\u7840\u3002\u6574\u4e2a\u8fc7\u7a0b\u5b8c\u5168\u7ed5\u8fc7\u4e86\u6e90\u4ee3\u7801\uff0c\u5b9e\u73b0\u4e86\u5bf9\u9ed1\u76d2\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u201c\u5916\u79d1\u624b\u672f\u5f0f\u201d\u4f18\u5316\u3002</li> </ul> <p></p> <p>Table 1. Memory access categories that RPG2 supports</p> <p></p> <p>Figure 5. Annotated example of RPG2 code transformations.</p>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/ELI5_notes/#2-osr-eli5","title":"2. \u8fd0\u884c\u65f6\u4ee3\u7801\u6ce8\u5165\u4e0e\u5728\u7ebf\u6808\u66ff\u6362\uff08OSR\uff09 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684 Profile-Guided Optimization (PGO) \u6216\u9759\u6001\u7f16\u8bd1\u5668\uff08\u5982 APT-GET\uff09\u5728\u7a0b\u5e8f\u8fd0\u884c\u524d\u5c31\u201c\u62cd\u677f\u201d\u4e86\u9884\u53d6\u7b56\u7565\u3002\u8fd9\u5728\u9762\u5bf9\u591a\u53d8\u7684\u8f93\u5165\u6570\u636e\u6216\u4e0d\u540c\u7684 CPU \u5fae\u67b6\u6784\u65f6\u975e\u5e38\u96be\u53d7\u3002</li> <li>\u60f3\u8c61\u4e00\u4e0b\uff0c\u4f60\u4e3a\u4e00\u4e2a\u56fe\u7b97\u6cd5\u7f16\u8bd1\u4e86\u4e00\u4e2a\u5e26\u9884\u53d6\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5b83\u5728\u4e00\u4e2a\u793e\u4ea4\u7f51\u7edc\u56fe\u4e0a\u8dd1\u5f97\u98de\u5feb\uff0c\u4f46\u5728\u53e6\u4e00\u4e2a\u7f51\u9875\u94fe\u63a5\u56fe\u4e0a\u5374\u56e0\u4e3a\u9884\u53d6\u8ddd\u79bb\u4e0d\u5bf9\uff0c\u75af\u72c2\u6c61\u67d3\u7f13\u5b58\uff0c\u6027\u80fd\u76f4\u63a5\u5d29\u76d8\u3002\u66f4\u7cdf\u7684\u662f\uff0c\u4e00\u65e6\u7a0b\u5e8f\u8dd1\u8d77\u6765\uff0c\u4f60\u5c31\u65e0\u6cd5\u66f4\u6539\u8fd9\u4e2a\u5df2\u7ecf\u201c\u710a\u6b7b\u201d\u5728\u4e8c\u8fdb\u5236\u91cc\u7684\u9884\u53d6\u903b\u8f91\u3002</li> <li>\u5373\u4f7f\u4f60\u77e5\u9053\u9884\u53d6\u53ef\u80fd\u6709\u5bb3\uff0c\u9759\u6001\u65b9\u6848\u4e5f\u65e0\u6cd5\u5728\u8fd0\u884c\u65f6\u201c\u60ac\u5d16\u52d2\u9a6c\u201d\uff0c\u53ea\u80fd\u773c\u7741\u7741\u770b\u7740\u6027\u80fd\u88ab\u62d6\u57ae\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u8fd9\u5c31\u50cf\u7ed9\u4e00\u8f86\u6b63\u5728\u9ad8\u901f\u516c\u8def\u4e0a\u98de\u9a70\u7684\u6c7d\u8f66\u66f4\u6362\u5f15\u64ce\u3002\u4f20\u7edf\u505a\u6cd5\u662f\uff1a\u8f66\u5fc5\u987b\u5f00\u56de\u8f66\u5e93\uff08\u505c\u6b62\u8fd0\u884c\uff09\uff0c\u62c6\u6389\u65e7\u5f15\u64ce\uff08\u539f\u59cb\u51fd\u6570\uff09\uff0c\u88c5\u4e0a\u65b0\u5f15\u64ce\uff08\u5e26\u9884\u53d6\u7684\u51fd\u6570\uff09\uff0c\u7136\u540e\u518d\u4e0a\u8def\u3002\u4f46\u5bf9\u4e8e\u90a3\u4e9b99%\u65f6\u95f4\u90fd\u5728\u4e00\u4e2a\u70ed\u5faa\u73af\u91cc\u8dd1\u7684\u7a0b\u5e8f\u6765\u8bf4\uff0c\u201c\u56de\u8f66\u5e93\u201d\u7684\u6210\u672c\u592a\u9ad8\uff0c\u751a\u81f3\u9519\u8fc7\u4e86\u6700\u4f73\u4f18\u5316\u65f6\u673a\u3002</li> <li>RPG2\u7684\u505a\u6cd5\u66f4\u50cf\u662f\u7a7a\u4e2d\u52a0\u6cb9+\u90e8\u4ef6\u70ed\u63d2\u62d4\u3002\u5b83\u5148\u5728\u65c1\u8fb9\u51c6\u5907\u597d\u4e00\u4e2a\u5347\u7ea7\u7248\u7684\u5f15\u64ce\u6a21\u5757\uff08\u901a\u8fc7BOLT\u751f\u6210\u65b0\u51fd\u6570\uff09\uff0c\u7136\u540e\u5728\u4e0d\u505c\u8f66\u7684\u60c5\u51b5\u4e0b\uff0c\u7cbe\u51c6\u5730\u5c06\u6b63\u5728\u5de5\u4f5c\u7684\u65e7\u5f15\u64ce\u65e0\u7f1d\u5207\u6362\u5230\u65b0\u5f15\u64ce\u4e0a\uff0c\u5e76\u4e14\u4fdd\u8bc1\u9a7e\u9a76\u5458\uff08\u7a0b\u5e8f\u903b\u8f91\uff09\u5b8c\u5168\u611f\u89c9\u4e0d\u5230\u98a0\u7c38\u3002\u5982\u679c\u53d1\u73b0\u65b0\u5f15\u64ce\u6709\u95ee\u9898\uff08\u6bd4\u5982\u6cb9\u8017\u53cd\u800c\u66f4\u9ad8\uff09\uff0c\u8fd8\u80fd\u7acb\u523b\u5207\u56de\u65e7\u5f15\u64ce\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>RPG2\u89e3\u51b3\u8fd9\u4e2a\u96be\u9898\u7684\u6838\u5fc3\uff0c\u5728\u4e8e\u5b83\u6ca1\u6709\u8bd5\u56fe\u53bb\u201c\u4fee\u6539\u201d\u539f\u59cb\u51fd\u6570\u7684\u5185\u5b58\uff0c\u800c\u662f\u91c7\u7528\u4e86\u201c\u5f71\u5b50\u51fd\u6570 + \u7cbe\u51c6\u91cd\u5b9a\u5411\u201d\u7684\u7b56\u7565\uff0c\u5e76\u5de7\u5999\u5730\u5229\u7528\u4e86\u73b0\u6709\u5de5\u5177\u94fe\u7684\u80fd\u529b\u3002</p> <ul> <li>\u7b2c\u4e00\u6b65\uff1a\u5236\u9020\u201c\u5f71\u5b50\u201d\u3002RPG2\u5229\u7528 BOLT \u8fd9\u4e2a\u4e8c\u8fdb\u5236\u4f18\u5316\u6846\u67b6\uff0c\u5728\u79bb\u7ebf\u72b6\u6001\u4e0b\u5206\u6790\u539f\u59cb\u7a0b\u5e8f\uff0c\u751f\u6210\u4e00\u4e2a\u5168\u65b0\u7684\u3001\u5305\u542b\u9884\u53d6\u5185\u6838\uff08prefetch kernel\uff09\u7684\u51fd\u6570\u7248\u672c\u3002\u8fd9\u4e2a\u65b0\u51fd\u6570\u662f\u539f\u59cb\u51fd\u6570\u7684\u201c\u5f71\u5b50\u201d\uff0c\u62e5\u6709\u76f8\u540c\u7684\u8bed\u4e49\u4f46\u66f4\u5f3a\u7684\u6027\u80fd\u6f5c\u529b\u3002</li> <li>\u7b2c\u4e8c\u6b65\uff1a\u5b89\u5168\u6ce8\u5165\u3002\u901a\u8fc7 LD_PRELOAD \u6ce8\u5165\u4e00\u4e2a\u540d\u4e3a <code>libpg2</code> \u7684\u8f7b\u91cf\u7ea7\u5e93\u5230\u76ee\u6807\u8fdb\u7a0b\u4e2d\u3002\u5f53\u9700\u8981\u8fdb\u884c\u4f18\u5316\u65f6\uff0cRPG2\u7684\u4e3b\u63a7\u8fdb\u7a0b\u901a\u8fc7 ptrace \u6682\u505c\u76ee\u6807\u8fdb\u7a0b\uff0c\u7136\u540e\u8ba9 <code>libpg2</code> \u5728\u76ee\u6807\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u5185\u7528 <code>mmap</code> \u5206\u914d\u4e00\u5757\u65b0\u5185\u5b58\uff0c\u5e76\u5c06\u201c\u5f71\u5b50\u51fd\u6570\u201d\u7684\u4ee3\u7801\u62f7\u8d1d\u8fdb\u53bb\u3002\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u8986\u76d6\u539f\u59cb\u4ee3\u7801\u7684\u98ce\u9669\u3002</li> <li>\u7b2c\u4e09\u6b65\uff1a\u5b9e\u73b0\u5728\u7ebf\u6808\u66ff\u6362\uff08OSR\uff09\u3002\u8fd9\u662f\u6700\u7cbe\u5999\u7684\u4e00\u6b65\u3002\u95ee\u9898\u5728\u4e8e\uff0c\u5f53\u76ee\u6807\u8fdb\u7a0b\u88ab\u6682\u505c\u65f6\uff0c\u5b83\u7684\u8c03\u7528\u6808\u4e0a\u53ef\u80fd\u6b63\u6709\u591a\u4e2a\u7ebf\u7a0b\u5728\u6267\u884c\u539f\u59cb\u51fd\u6570\u7684\u4e0d\u540c\u4f4d\u7f6e\u3002\u7b80\u5355\u5730\u628a\u672a\u6765\u7684\u51fd\u6570\u8c03\u7528\u6307\u5411\u201c\u5f71\u5b50\u51fd\u6570\u201d\u662f\u4e0d\u591f\u7684\uff0c\u5fc5\u987b\u628a\u5df2\u7ecf\u5728\u6267\u884c\u4e2d\u7684\u51fd\u6570\u8c03\u7528\u4e5f\u5207\u6362\u8fc7\u53bb\u3002</li> <li>RPG2\u5229\u7528\u4e86BOLT\u81ea\u5e26\u7684 BOLT Address Translation Table (BATT)\u3002\u8fd9\u4e2a\u8868\u539f\u672c\u662f\u4e3a\u4e86\u652f\u6301\u5bf9\u5df2\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u518d\u6b21\u4f18\u5316\u800c\u8bbe\u8ba1\u7684\uff0c\u5b83\u7cbe\u786e\u8bb0\u5f55\u4e86\u539f\u59cb\u51fd\u6570\u4e2d\u6bcf\u6761\u6307\u4ee4\u4e0eBOLT\u4f18\u5316\u540e\u51fd\u6570\u4e2d\u5bf9\u5e94\u6307\u4ee4\u7684\u5730\u5740\u6620\u5c04\u5173\u7cfb\u3002</li> <li>RPG2\u901a\u8fc7 <code>ptrace</code> \u8bfb\u53d6\u6240\u6709\u7ebf\u7a0b\u7684\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\uff0c\u5bf9\u4e8ePC\u6307\u5411\u539f\u59cb\u51fd\u6570\u7684\u7ebf\u7a0b\uff0c\u5b83\u67e5\u8be2BATT\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u201c\u5f71\u5b50\u51fd\u6570\u201d\u4e2d\u7684\u65b0\u5730\u5740\uff0c\u5e76\u76f4\u63a5\u4fee\u6539\u8be5\u7ebf\u7a0b\u7684PC\u3002\u8fd9\u6837\uff0c\u5f53\u8fdb\u7a0b\u6062\u590d\u8fd0\u884c\u65f6\uff0c\u7ebf\u7a0b\u5c31\u4f1a\u4ece\u201c\u5f71\u5b50\u51fd\u6570\u201d\u7684\u5bf9\u5e94\u4f4d\u7f6e\u7ee7\u7eed\u6267\u884c\uff0c\u5b9e\u73b0\u4e86\u771f\u6b63\u7684\u65e0\u7f1d\u5207\u6362\u3002</li> <li>\u5bf9\u4e8e\u5207\u6362\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u51fa\u73b0\u5728\u9884\u53d6\u5185\u6838\u91cc\u7684\u7ebf\u7a0b\uff08\u8fd9\u90e8\u5206\u4ee3\u7801\u5728\u539f\u59cb\u51fd\u6570\u91cc\u4e0d\u5b58\u5728\uff0cBATT\u65e0\u6620\u5c04\uff09\uff0cRPG2\u91c7\u7528\u4fdd\u5b88\u7b56\u7565\uff1a\u901a\u8fc7 ptrace\u5355\u6b65\u6267\u884c\uff0c\u76f4\u5230\u7ebf\u7a0b\u6267\u884c\u5230BATT\u4e2d\u6709\u6620\u5c04\u7684\u4ee3\u7801\u4f4d\u7f6e\uff0c\u518d\u8fdb\u884c\u8f6c\u6362\u3002</li> <li>\u7b2c\u56db\u6b65\uff1a\u52a8\u6001\u56de\u6eda\u3002\u5982\u679c\u540e\u7eed\u7684\u6027\u80fd\u76d1\u63a7\u53d1\u73b0\u9884\u53d6\u6709\u5bb3\uff0cRPG2\u53ef\u4ee5\u5229\u7528\u540c\u6837\u7684BATT\u673a\u5236\uff0c\u5c06\u6240\u6709\u6307\u5411\u201c\u5f71\u5b50\u51fd\u6570\u201d\u7684\u8c03\u7528\u548cPC\u90fd\u53cd\u5411\u6620\u5c04\u56de\u539f\u59cb\u51fd\u6570\uff0c\u5b8c\u7f8e\u5730\u201c\u64a4\u9500\u201d\u6574\u4e2a\u4f18\u5316\u64cd\u4f5c\uff0c\u5c06\u6027\u80fd\u6062\u590d\u5230\u57fa\u51c6\u7ebf\u3002</li> </ul> <p></p> <p>Figure 6. The PC register and code memory of the target process before and after, RPG2\u2019s code replacement.</p>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/ELI5_notes/#3-eli5","title":"3. \u57fa\u4e8e\u6027\u80fd\u53cd\u9988\u7684\u52a8\u6001\u9884\u53d6\u8ddd\u79bb\u8c03\u4f18 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4f20\u7edf\u7684\u8f6f\u4ef6\u9884\u53d6\uff0c\u65e0\u8bba\u662f\u624b\u52a8\u8fd8\u662f\u7f16\u8bd1\u5668\u81ea\u52a8\u63d2\u5165\uff0c\u90fd\u9762\u4e34\u4e00\u4e2a\u81f4\u547d\u95ee\u9898\uff1a\u9884\u53d6\u8ddd\u79bb\uff08prefetch distance\uff09\u662f\u201c\u5199\u6b7b\u201d\u7684\u3002\u8fd9\u4e2a\u8ddd\u79bb\u4e00\u65e6\u786e\u5b9a\uff0c\u5c31\u65e0\u6cd5\u9002\u5e94\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u771f\u5b9e\u60c5\u51b5\u3002 - \u8fd9\u4e2a\u201c\u96be\u53d7\u201d\u4f53\u73b0\u5728\u4e09\u4e2a\u65b9\u9762\uff1a   - \u8f93\u5165\u654f\u611f\u6027\uff1a\u540c\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5904\u7406\u4e0d\u540c\u89c4\u6a21\u6216\u7ed3\u6784\u7684\u6570\u636e\uff08\u6bd4\u5982\u56fe\u7b97\u6cd5\u8dd1\u5728\u4e0d\u540c\u7684\u793e\u4ea4\u7f51\u7edc\u56fe\u4e0a\uff09\uff0c\u5176\u5185\u5b58\u8bbf\u95ee\u7684\u8282\u594f\u5b8c\u5168\u4e0d\u540c\u3002\u5bf9A\u6570\u636e\u96c6\u6700\u4f18\u7684\u8ddd\u79bb\uff0c\u5728B\u6570\u636e\u96c6\u4e0a\u53ef\u80fd\u5b8c\u5168\u65e0\u6548\u751a\u81f3\u6709\u5bb3\u3002</p> <p></p> <p>Figure 1. The sssp benchmark from CRONO [2] has very different optimal prefetch distances (shaded regions) with different inputs.</p> <ul> <li>\u786c\u4ef6\u654f\u611f\u6027\uff1a\u540c\u6837\u7684\u4ee3\u7801\u548c\u6570\u636e\uff0c\u5728Haswell\u548cCascade Lake\u8fd9\u6837\u7684\u4e0d\u540c\u5fae\u67b6\u6784\u4e0a\uff0c\u7531\u4e8e\u7f13\u5b58\u5927\u5c0f\u3001\u5185\u5b58\u5e26\u5bbd\u3001\u4e71\u5e8f\u6267\u884c\u80fd\u529b\u7684\u5dee\u5f02\uff0c\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u4e5f\u4f1a\u5927\u76f8\u5f84\u5ead\u3002</li> </ul> <p></p> <p>Figure 2. The pr benchmark from CRONO [2] sees a speedup or a slowdown with prefetching, depending on the microarchitecture.</p> <ul> <li>\u53cc\u5203\u5251\u6548\u5e94\uff1a\u9884\u53d6\u592a\u8fd1\uff0c\u6570\u636e\u8fd8\u6ca1\u5230\u5c31\u88ab\u7528\uff0c\u7b49\u4e8e\u6ca1\u9884\u53d6\uff1b\u9884\u53d6\u592a\u8fdc\uff0c\u6570\u636e\u65e9\u65e9\u8fdb\u4e86\u7f13\u5b58\u53c8\u88ab\u6324\u51fa\u53bb\uff0c\u8fd8\u767d\u767d\u6d6a\u8d39\u4e86\u5b9d\u8d35\u7684\u5185\u5b58\u5e26\u5bbd\u3002\u66f4\u7cdf\u7684\u662f\uff0c\u9519\u8bef\u7684\u9884\u53d6\u4f1a\u4e25\u91cd\u62d6\u6162\u7a0b\u5e8f\uff0c\u800c\u9759\u6001\u65b9\u6cd5\u5bf9\u6b64\u675f\u624b\u65e0\u7b56\u3002</li> </ul> <p></p> <p>Figure 3. The bfs benchmark from CRONO [2] often (but not always) suffers significant performance slowdown with prefetching.</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u5728\u4e00\u6761\u4f20\u9001\u5e26\u4e0a\u5de5\u4f5c\uff0c\u4f60\u7684\u4efb\u52a1\u662f\u4ece\u4f20\u9001\u5e26\u4e0a\u62ff\u96f6\u4ef6\u7ec4\u88c5\u4ea7\u54c1\u3002\u96f6\u4ef6\u5230\u8fbe\u4f60\u9762\u524d\u9700\u8981\u56fa\u5b9a\u7684\u65f6\u95f4\uff08\u5185\u5b58\u5ef6\u8fdf\uff09\u3002 - \u9759\u6001\u9884\u53d6\u5c31\u50cf\u662f\u8001\u677f\u6839\u636e\u6628\u5929\u7684\u7ecf\u9a8c\uff0c\u7ed9\u4f60\u5b9a\u4e0b\u4e86\u4e00\u4e2a\u89c4\u77e9\uff1a\u201c\u4f60\u5fc5\u987b\u5728\u7ec4\u88c5\u5f53\u524d\u96f6\u4ef6\u7684\u540c\u65f6\uff0c\u4f38\u624b\u53bb\u62ff\u540e\u9762\u7b2cN\u4e2a\u96f6\u4ef6\u201d\u3002\u4f46\u5982\u679c\u4eca\u5929\u4f20\u9001\u5e26\u901f\u5ea6\u53d8\u4e86\uff08\u5fae\u67b6\u6784\u4e0d\u540c\uff09\uff0c\u6216\u8005\u96f6\u4ef6\u7684\u5927\u5c0f\u548c\u95f4\u8ddd\u53d8\u4e86\uff08\u8f93\u5165\u6570\u636e\u4e0d\u540c\uff09\uff0c\u8fd9\u4e2aN\u503c\u5f88\u53ef\u80fd\u5c31\u4e0d\u5408\u9002\u4e86\u3002\u62ff\u65e9\u4e86\u624b\u95f2\u7740\uff08\u6d6a\u8d39\u7cbe\u529b/\u5e26\u5bbd\uff09\uff0c\u62ff\u665a\u4e86\u5c31\u5f97\u5e72\u7b49\uff08\u6d41\u6c34\u7ebf\u505c\u987f\uff09\u3002 - RPG2\u7684\u505a\u6cd5\u5219\u50cf\u662f\u7ed9\u4f60\u914d\u4e86\u4e00\u4e2a\u667a\u80fd\u52a9\u624b\u3002\u4ed6\u5148\u89c2\u5bdf\u4f60\u5de5\u4f5c\u51e0\u79d2\u949f\uff08Profiling\uff09\uff0c\u7136\u540e\u5728\u4f60\u65c1\u8fb9\u88c5\u4e86\u4e00\u4e2a\u53ef\u4ee5\u968f\u65f6\u8c03\u8282\u7684\u673a\u68b0\u81c2\uff08\u6ce8\u5165\u9884\u53d6\u4ee3\u7801\uff09\u3002\u63a5\u7740\uff0c\u4ed6\u4e0d\u65ad\u5fae\u8c03\u673a\u68b0\u81c2\u6293\u53d6\u7684\u63d0\u524d\u91cf\uff08\u52a8\u6001\u8c03\u4f18\uff09\uff0c\u5e76\u901a\u8fc7\u770b\u4f60\u5355\u4f4d\u65f6\u95f4\u80fd\u7ec4\u88c5\u591a\u5c11\u4ea7\u54c1\uff08IPC\uff09\u6765\u5224\u65ad\u54ea\u4e2a\u63d0\u524d\u91cf\u6700\u597d\u3002\u5982\u679c\u53d1\u73b0\u600e\u4e48\u8c03\u90fd\u6bd4\u4f60\u81ea\u5df1\u5e72\u8fd8\u6162\uff0c\u4ed6\u5c31\u5e72\u8106\u628a\u673a\u68b0\u81c2\u6536\u8d77\u6765\uff0c\u8ba9\u4f60\u6062\u590d\u539f\u6837\u3002</p> <p>\u5173\u952e\u4e00\u62db - RPG2\u6700\u6838\u5fc3\u7684\u521b\u65b0\u5728\u4e8e\uff0c\u5b83\u6ca1\u6709\u8bd5\u56fe\u5728\u7f16\u8bd1\u65f6\u201c\u731c\u201d\u51fa\u4e00\u4e2a\u5b8c\u7f8e\u7684\u9884\u53d6\u8ddd\u79bb\uff0c\u800c\u662f\u5c06\u8fd9\u4e2a\u51b3\u7b56\u63a8\u8fdf\u5230\u8fd0\u884c\u65f6\uff0c\u5e76\u5efa\u7acb\u4e86\u4e00\u4e2a\u95ed\u73af\u53cd\u9988\u7cfb\u7edf\u3002 - \u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u5728\u539f\u6765\u7684\u201c\u5206\u6790-\u6ce8\u5165\u201d\u6d41\u7a0b\u540e\uff0c\u589e\u52a0\u4e86\u4e00\u4e2a\u201c\u76d1\u63a7-\u641c\u7d22-\u51b3\u7b56\u201d\u7684\u5728\u7ebf\u8c03\u4f18\u9636\u6bb5\uff1a   - \u6027\u80fd\u6307\u6807\u9009\u62e9\uff1a\u5b83\u9009\u7528IPC\uff08Instructions Per Cycle\uff09\u4f5c\u4e3a\u201c\u5065\u5eb7\u5ea6\u201d\u6307\u6807\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u806a\u660e\u7684\u9009\u62e9\uff0c\u56e0\u4e3aIPC\u76f4\u63a5\u53cd\u6620\u4e86\u5904\u7406\u5668\u6d41\u6c34\u7ebf\u7684\u5145\u5b9e\u7a0b\u5ea6\uff0c\u7efc\u5408\u4e86\u7f13\u5b58\u547d\u4e2d\u3001\u5e26\u5bbd\u7ade\u4e89\u7b49\u6240\u6709\u56e0\u7d20\u7684\u6700\u7ec8\u6548\u679c\uff0c\u6bd4\u5355\u7eaf\u770b\u7f13\u5b58\u672a\u547d\u4e2d\u7387\uff08MPKI\uff09\u66f4\u80fd\u53cd\u6620\u771f\u5b9e\u6027\u80fd\u3002   - \u9ad8\u6548\u7684\u641c\u7d22\u7b56\u7565\uff1a\u4e3a\u4e86\u907f\u514d\u5728\u5de8\u5927\u7684\u8ddd\u79bb\u7a7a\u95f4\uff08\u6bd4\u59821-200\uff09\u91cc\u76f2\u76ee\u7a77\u4e3e\uff0c\u5b83\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u4e09\u9636\u6bb5\u7684\u667a\u80fd\u641c\u7d22\u7b97\u6cd5\uff1a     - \u68af\u5ea6\u63a2\u6d4b\uff1a\u4ece\u4e00\u4e2a\u968f\u673a\u70b9\u51fa\u53d1\uff0c\u5c0f\u6b65\u8bd5\u63a2\uff08\u00b15\uff09\uff0c\u5feb\u901f\u5224\u65ad\u6027\u80fd\u63d0\u5347\u7684\u65b9\u5411\u3002     - \u7c97\u7c92\u5ea6\u8df3\u8dc3\uff1a\u6cbf\u7740\u6709\u5229\u65b9\u5411\u6307\u6570\u7ea7\uff08\u7ffb\u500d\uff09\u8df3\u8dc3\uff0c\u5feb\u901f\u903c\u8fd1\u6027\u80fd\u5cf0\u503c\u533a\u57df\u3002     - \u7cbe\u7ec6\u4e8c\u5206\uff1a\u5728\u9501\u5b9a\u7684\u5c0f\u8303\u56f4\u5185\u8fdb\u884c\u4e8c\u5206\u67e5\u627e\uff0c\u7cbe\u786e\u5b9a\u4f4d\u5c40\u90e8\u6700\u4f18\u89e3\u3002   - \u5b89\u5168\u56de\u6eda\u673a\u5236\uff1a\u6574\u4e2a\u8c03\u4f18\u8fc7\u7a0b\u662f\u201c\u65e0\u5bb3\u201d\u7684\u3002\u5982\u679c\u641c\u7d22\u5b8c\u6240\u6709\u5019\u9009\u8ddd\u79bb\uff0c\u53d1\u73b0\u6700\u597d\u7684\u90a3\u4e2a\u4e5f\u6bd4\u539f\u59cb\u4ee3\u7801\u7684IPC\u4f4e\uff0cRPG2\u4f1a\u679c\u65ad\u5730\u5c06\u6267\u884c\u6d41\u5207\u6362\u56de\u672a\u7ecf\u4fee\u6539\u7684\u539f\u59cb\u51fd\u6570\uff0c\u786e\u4fdd\u6027\u80fd\u4e0d\u4f1a\u56e0\u9884\u53d6\u800c\u53d7\u635f\u3002\u8fd9\u4e2a\u80fd\u529b\u662f\u4efb\u4f55\u9759\u6001\u65b9\u6cd5\u90fd\u65e0\u6cd5\u4f01\u53ca\u7684\u3002</p> <p></p> <p>Figure 10. RPG2\u2019s impact on IPC over time.</p>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/ELI5_notes/#4-eli5","title":"4. \u5b89\u5168\u56de\u6eda\u673a\u5236 (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684 profile-guided prefetching\uff08\u5982 APT-GET\uff09\u662f\u201c\u4e00\u9524\u5b50\u4e70\u5356\u201d\uff1a\u7f16\u8bd1\u65f6\u6839\u636e\u67d0\u4e2a\u8f93\u5165\u6216\u786c\u4ef6\u73af\u5883\uff0c\u628a\u9884\u53d6\u6307\u4ee4\u548c\u8ddd\u79bb\u786c\u7f16\u7801\u8fdb\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u8fd9\u5728\u73b0\u5b9e\u4e2d\u975e\u5e38\u201c\u96be\u53d7\u201d\uff0c\u56e0\u4e3a\uff1a</li> <li>\u540c\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6362\u4e00\u4e2a\u8f93\u5165\u6570\u636e\uff08\u6bd4\u5982\u56fe\u7684\u7a00\u758f\u5ea6\u4e0d\u540c\uff09\uff0c\u6700\u4f18\u7684\u9884\u53d6\u8ddd\u79bb\u53ef\u80fd\u5929\u5dee\u5730\u522b\uff08\u89c1 Figure 1\uff09\u3002</li> <li>\u540c\u4e00\u4e2a\u7a0b\u5e8f+\u8f93\u5165\uff0c\u5728\u4e0d\u540c\u7684\u5fae\u67b6\u6784\uff08\u5982 Haswell vs. Cascade Lake\uff09\u4e0a\uff0c\u9884\u53d6\u751a\u81f3\u53ef\u80fd\u4ece\u201c\u795e\u52a9\u653b\u201d\u53d8\u6210\u201c\u732a\u961f\u53cb\u201d\uff08\u89c1 Figure 2 \u548c Figure 3\uff09\u3002</li> <li>\u6700\u81f4\u547d\u7684\u662f\uff0c\u4e00\u65e6\u9884\u53d6\u914d\u7f6e\u4e0d\u5f53\uff0c\u5b83\u4f1a\u4e3b\u52a8\u4f5c\u6076\uff1a\u4e0d\u4ec5\u6d6a\u8d39\u5185\u5b58\u5e26\u5bbd\uff0c\u8fd8\u4f1a\u628a\u6709\u7528\u7684\u7f13\u5b58\u884c\u7ed9\u6324\u51fa\u53bb\uff0c\u5bfc\u81f4\u6027\u80fd\u96ea\u5d29\u5f0f\u4e0b\u964d\u3002\u800c\u9759\u6001\u65b9\u6848\u5bf9\u6b64\u6beb\u65e0\u529e\u6cd5\uff0c\u53ea\u80fd\u773c\u7741\u7741\u770b\u7740\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u5728\u5f00\u8f66\uff0cRPG2 \u5c31\u50cf\u4e00\u4e2a\u6781\u5176\u8c28\u614e\u7684\u81ea\u52a8\u9a7e\u9a76\u526f\u9a7e\u3002</li> <li>\u5b83\u770b\u5230\u524d\u65b9\u8def\u51b5\u590d\u6742\uff08\u7a0b\u5e8f\u70ed\u70b9\uff09\uff0c\u51b3\u5b9a\u5c1d\u8bd5\u4e00\u5957\u65b0\u7684\u9a7e\u9a76\u7b56\u7565\uff08\u63d2\u5165\u9884\u53d6\uff09\u3002</li> <li>\u4f46\u5b83\u4e0d\u4f1a\u76f4\u63a5\u731b\u6253\u65b9\u5411\u76d8\u3002\u5b83\u4f1a\u5148\u5c0f\u5e45\u5ea6\u8c03\u6574\uff08\u5c1d\u8bd5\u4e00\u4e2a\u9884\u53d6\u8ddd\u79bb\uff09\uff0c\u7136\u540e\u7d27\u76ef\u4eea\u8868\u76d8\uff08\u76d1\u63a7 IPC\uff09\u3002</li> <li>\u5982\u679c\u53d1\u73b0\u8f66\u901f\uff08\u6027\u80fd\uff09\u53d8\u5feb\u4e86\uff0c\u5c31\u7ee7\u7eed\u5fae\u8c03\uff1b\u4f46\u5982\u679c\u53d1\u73b0\u8f66\u901f\u53cd\u800c\u6162\u4e86\uff0c\u6216\u8005\u8f66\u8eab\u4e0d\u7a33\uff08\u6027\u80fd\u4e0b\u964d\uff09\uff0c\u5b83\u4f1a\u7acb\u523b\u3001\u679c\u65ad\u5730\u677e\u5f00\u65b9\u5411\u76d8\uff0c\u8ba9\u4f60\u7684\u624b\uff08\u539f\u59cb\u4ee3\u7801\uff09\u91cd\u65b0\u638c\u63a7\u8f66\u8f86\uff0c\u786e\u4fdd\u4f60\u81f3\u5c11\u80fd\u7ef4\u6301\u539f\u6765\u7684\u9a7e\u9a76\u4f53\u9a8c\u3002</li> <li>\u8fd9\u4e2a\u201c\u677e\u5f00\u65b9\u5411\u76d8\u201d\u7684\u52a8\u4f5c\uff0c\u5c31\u662f\u5b89\u5168\u56de\u6eda\u673a\u5236\u3002\u5b83\u4e0d\u662f\u7b80\u5355\u7684\u201c\u5173\u6389\u9884\u53d6\u201d\uff0c\u800c\u662f\u628a\u6574\u4e2a\u6267\u884c\u72b6\u6001\u65e0\u7f1d\u5207\u56de\u5230\u4ece\u672a\u88ab\u4fee\u6539\u8fc7\u7684\u539f\u59cb\u4ee3\u7801\u8def\u5f84\u4e0a\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u5e76\u6ca1\u6709\u5728\u539f\u5730\u4fee\u6539\u4ee3\u7801\uff0c\u800c\u662f\u5de7\u5999\u5730\u91c7\u7528\u4e86\u201c\u5f71\u5b50\u51fd\u6570\u201d\u7684\u8bbe\u8ba1\u3002</li> <li>\u539f\u59cb\u51fd\u6570 <code>F0</code> \u88ab\u5b8c\u6574\u4fdd\u7559\uff0c\u7eb9\u4e1d\u4e0d\u52a8\u3002</li> <li>\u4f18\u5316\u540e\u7684\u65b0\u51fd\u6570 <code>F1</code>\uff08\u5e26\u9884\u53d6\u5185\u6838\uff09\u88ab\u751f\u6210\u5e76\u52a0\u8f7d\u5230\u65b0\u7684\u5185\u5b58\u5730\u5740\u3002</li> <li>\u5f53\u9700\u8981\u56de\u6eda\u65f6\uff0c\u6700\u5173\u952e\u7684\u4e00\u6b65\u662f\u5904\u7406\u90a3\u4e9b\u201c\u6b63\u5728 <code>F0</code> \u91cc\u6267\u884c\u201d\u7684\u7ebf\u7a0b\uff08\u5373 On-Stack Replacement, OSR \u95ee\u9898\uff09\u3002</li> <li>RPG2 \u5229\u7528\u4e86 BOLT \u751f\u6210\u7684 BATT (BOLT Address Translation Table)\u3002\u8fd9\u4e2a\u8868\u5c31\u50cf\u4e00\u672c\u7cbe\u786e\u7684\u201c\u65b0\u65e7\u5730\u56fe\u5750\u6807\u5bf9\u7167\u624b\u518c\u201d\uff0c\u80fd\u5c06 <code>F1</code> \u4e2d\u4efb\u610f\u6307\u4ee4\u7684\u5730\u5740\u6620\u5c04\u56de <code>F0</code> \u4e2d\u5bf9\u5e94\u7684\u539f\u59cb\u5730\u5740\u3002</li> <li>\u5bf9\u4e8e\u5df2\u7ecf\u8fdb\u5165 <code>F1</code> \u9884\u53d6\u5185\u6838\u7684\u7ebf\u7a0b\uff08\u8fd9\u90e8\u5206\u5728 <code>F0</code> \u91cc\u6ca1\u6709\u5bf9\u5e94\u7269\uff09\uff0cRPG2 \u91c7\u7528\u4e86\u4e00\u79cd\u201c\u7b28\u4f46\u53ef\u9760\u201d\u7684\u65b9\u6cd5\uff1a\u901a\u8fc7 ptrace \u5355\u6b65\u6267\u884c\uff0c\u76f4\u5230\u7ebf\u7a0b\u6267\u884c\u6d41\u56de\u5230 <code>F1</code> \u7684\u4e3b\u4f53\u90e8\u5206\uff08\u8fd9\u90e8\u5206\u5728 BATT \u4e2d\u6709\u8bb0\u5f55\uff09\uff0c\u7136\u540e\u518d\u5229\u7528 BATT \u5b8c\u6210\u5730\u5740\u7ffb\u8bd1\u548c\u8df3\u8f6c\u3002</li> <li>\u6700\u7ec8\uff0c\u901a\u8fc7\u4fee\u6539\u6240\u6709\u76f8\u5173\u7ebf\u7a0b\u7684 PC (Program Counter) \u548c\u8c03\u7528\u70b9\uff0c\u5c06\u6574\u4e2a\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u5e72\u51c0\u5229\u843d\u5730\u5207\u6362\u56de <code>F0</code>\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u96f6\u98ce\u9669\u7684\u6027\u80fd\u515c\u5e95\u3002</li> </ul> <p></p> <p>Figure 6. The PC register and code memory of the target process before and after, RPG2\u2019s code replacement.</p> <p>\u8fd9\u4e2a\u673a\u5236\u7684\u6838\u5fc3\u4ef7\u503c\u5728\u4e8e\uff0c\u5b83\u5c06\u9884\u53d6\u4ece\u4e00\u4e2a\u201c\u9ad8\u98ce\u9669\u3001\u9ad8\u56de\u62a5\u201d\u7684\u8d4c\u535a\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u201c\u6709\u6b62\u635f\u7ebf\u7684\u6295\u8d44\u201d\u3002\u65e0\u8bba\u5728\u7ebf\u8c03\u4f18\u7684\u7ed3\u679c\u5982\u4f55\uff0c\u7a0b\u5e8f\u7684\u6027\u80fd\u4e0b\u9650\u90fd\u88ab\u7262\u7262\u9501\u5b9a\u5728\u539f\u59cb\u57fa\u7ebf\u6c34\u5e73\uff0c\u8fd9\u6781\u5927\u5730\u63d0\u5347\u4e86\u9884\u53d6\u6280\u672f\u5728\u771f\u5b9e\u3001\u591a\u53d8\u73af\u5883\u4e2d\u7684\u9c81\u68d2\u6027 (Robustness) \u548c\u5b9e\u7528\u6027\u3002</p>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/","title":"RPG2: Robust Profile-Guided Runtime Prefetch Generation \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-1-the-sssp-benchmark-from-crono-2-has-very-different-optimal-prefetch-distances-shaded-regions-with-different-inputs","title":"Figure 1. The sssp benchmark from CRONO [2] has very different optimal prefetch distances (shaded regions) with different inputs.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 sssp \u57fa\u51c6\u6d4b\u8bd5\u5728 Haswell \u67b6\u6784\u4e0a\u7684\u6027\u80fd\u8868\u73b0\uff0c\u6a2a\u8f74\u4e3a prefetch distance\uff08\u9884\u53d6\u8ddd\u79bb\uff09\uff0c\u7eb5\u8f74\u4e3a speedup\uff08\u52a0\u901f\u6bd4\uff09\uff0c\u57fa\u51c6\u7ebf\u4e3a 1.0\u3002</li> <li>\u56db\u6761\u66f2\u7ebf\u5206\u522b\u4ee3\u8868\u4e0d\u540c\u8f93\u5165\u6570\u636e\u96c6\uff1aRO-edges\uff08\u7eff\u8272\uff09\u3001amazon0601\uff08\u84dd\u8272\uff09\u3001gowalla\uff08\u7d2b\u8272\uff09\u3001NotreDame\uff08\u6a59\u8272\uff09\u3002</li> <li>\u6bcf\u6761\u66f2\u7ebf\u7684\u9634\u5f71\u533a\u57df\u6807\u793a\u4e86\u8be5\u8f93\u5165\u4e0b\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u8303\u56f4\uff0c\u5373\u52a0\u901f\u6bd4\u6700\u9ad8\u7684\u533a\u95f4\uff1a</li> <li>RO-edges\uff1a\u6700\u4f18\u533a\u95f4\u4e3a 20\u201334\uff0c\u6700\u9ad8\u52a0\u901f\u6bd4\u63a5\u8fd1 1.8x\u3002</li> <li>amazon0601\uff1a\u6700\u4f18\u533a\u95f4\u4e3a 70\u2013100\uff0c\u52a0\u901f\u6bd4\u7a33\u5b9a\u5728 1.2x \u5de6\u53f3\u3002</li> <li>gowalla\uff1a\u6700\u4f18\u533a\u95f4\u4e3a 1\u20132\uff0c\u52a0\u901f\u6bd4\u7ea6 1.2x\uff0c\u8d85\u8fc7\u6b64\u8303\u56f4\u6027\u80fd\u8fc5\u901f\u4e0b\u964d\u3002</li> <li>NotreDame\uff1a\u65e0\u660e\u663e\u6700\u4f18\u533a\u95f4\uff0c\u6574\u4f53\u52a0\u901f\u6bd4\u63a5\u8fd1\u6216\u4f4e\u4e8e 1.0\uff0c\u90e8\u5206\u8ddd\u79bb\u751a\u81f3\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u540c\u4e00\u7a0b\u5e8f\u5728\u4e0d\u540c\u8f93\u5165\u4e0b\uff0c\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u5dee\u5f02\u5de8\u5927\uff0c\u9759\u6001\u7f16\u8bd1\u5668\u96be\u4ee5\u7edf\u4e00\u4f18\u5316\u3002</li> <li>\u8868\u683c\u603b\u7ed3\u5404\u8f93\u5165\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u4e0e\u6027\u80fd\u8868\u73b0\uff1a</li> </ul> \u8f93\u5165\u6570\u636e\u96c6 \u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u8303\u56f4 \u6700\u9ad8\u52a0\u901f\u6bd4 \u6027\u80fd\u8d8b\u52bf RO-edges 20\u201334 ~1.8x \u660e\u663e\u5cf0\u503c\uff0c\u8303\u56f4\u8f83\u5bbd amazon0601 70\u2013100 ~1.2x \u5e73\u7f13\u4e0a\u5347\u540e\u8d8b\u4e8e\u7a33\u5b9a gowalla 1\u20132 ~1.2x \u7a84\u5cf0\uff0c\u8fc7\u65e9\u6216\u8fc7\u665a\u5747\u663e\u8457\u964d\u901f NotreDame \u65e0\u660e\u786e\u6700\u4f18 \u22641.0x \u591a\u6570\u8ddd\u79bb\u65e0\u6536\u76ca\uff0c\u90e8\u5206\u6709\u5bb3 <ul> <li>\u6b64\u56fe\u76f4\u89c2\u63ed\u793a\u4e86\u9884\u53d6\u8ddd\u79bb\u5bf9\u6027\u80fd\u7684\u9ad8\u5ea6\u654f\u611f\u6027\uff0c\u5f3a\u8c03\u52a8\u6001\u8c03\u6574\u7684\u5fc5\u8981\u6027\uff0c\u4e5f\u662f RPG2 \u7cfb\u7edf\u8bbe\u8ba1\u7684\u6838\u5fc3\u52a8\u673a\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-2-the-pr-benchmark-from-crono-2-sees-a-speedup-or-a-slowdown-with-prefetching-depending-on-the-microarchitecture","title":"Figure 2. The pr benchmark from CRONO [2] sees a speedup or a slowdown with prefetching, depending on the microarchitecture.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86 CRONO \u5957\u4ef6\u4e2d\u7684 pr \u57fa\u51c6\u6d4b\u8bd5\u5728\u4e0d\u540c\u5fae\u67b6\u6784\u548c\u8f93\u5165\u4e0b\u7684\u6027\u80fd\u8868\u73b0\uff0c\u7eb5\u8f74\u4e3a speedup\uff08\u8d8a\u9ad8\u8d8a\u597d\uff09\uff0c\u6a2a\u8f74\u4e3a prefetch distance\u3002</li> <li>\u56db\u6761\u66f2\u7ebf\u5206\u522b\u4ee3\u8868\u4e24\u79cd\u8f93\u5165\uff08wiki-topcats \u548c tvshow-edges\uff09\u5728\u4e24\u79cd\u5fae\u67b6\u6784\uff08Cascade Lake \u548c Haswell\uff09\u4e0a\u7684\u8868\u73b0\uff1a</li> <li>wiki-topcats Cascade Lake\uff1a\u865a\u7ebf\u6d45\u84dd\u8272\uff0c\u6574\u4f53\u8868\u73b0\u4f18\u5f02\uff0cspeedup \u7a33\u5b9a\u5728 1.75\u20132.00 \u533a\u95f4\u3002</li> <li>tvshow-edges Haswell\uff1a\u5b9e\u7ebf\u6df1\u7eff\u8272\uff0c\u8868\u73b0\u4e2d\u7b49\uff0cspeedup \u5728 1.00\u20131.25 \u4e4b\u95f4\u6ce2\u52a8\u3002</li> <li>wiki-topcats Haswell\uff1a\u5b9e\u7ebf\u6d45\u84dd\u8272\uff0c\u8868\u73b0\u8f83\u5dee\uff0cspeedup \u63a5\u8fd1 1.00\uff0c\u90e8\u5206\u533a\u57df\u751a\u81f3\u4f4e\u4e8e 1.00\u3002</li> <li>tvshow-edges Cascade Lake\uff1a\u865a\u7ebf\u6df1\u7eff\u8272\uff0c\u8868\u73b0\u6700\u5dee\uff0cspeedup \u591a\u6570\u65f6\u95f4\u4f4e\u4e8e 1.00\uff0c\u8868\u660e prefetching \u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002</li> <li>\u6570\u636e\u603b\u7ed3\u5982\u4e0b\uff1a</li> </ul> \u8f93\u5165 \u5fae\u67b6\u6784 \u6027\u80fd\u8d8b\u52bf \u6700\u5927 speedup wiki-topcats Cascade Lake \u663e\u8457\u63d0\u5347 ~2.00 tvshow-edges Haswell \u8f7b\u5fae\u63d0\u5347 ~1.25 wiki-topcats Haswell \u57fa\u672c\u65e0\u63d0\u5347\u6216\u8f7b\u5fae\u4e0b\u964d ~1.00 tvshow-edges Cascade Lake \u660e\u663e\u4e0b\u964d &lt;1.00 <ul> <li>\u5173\u952e\u53d1\u73b0\uff1a</li> <li>prefetching \u7684\u6548\u679c\u9ad8\u5ea6\u4f9d\u8d56\u4e8e\u5fae\u67b6\u6784\u4e0e\u8f93\u5165\u7684\u7ec4\u5408\uff0c\u540c\u4e00\u8f93\u5165\u5728\u4e0d\u540c\u5fae\u67b6\u6784\u4e0a\u53ef\u80fd\u4ea7\u751f\u5b8c\u5168\u76f8\u53cd\u7684\u6548\u679c\u3002</li> <li>Cascade Lake \u5bf9 wiki-topcats \u8f93\u5165\u8868\u73b0\u51fa\u6781\u4f73\u7684 prefetch \u6548\u679c\uff0c\u4f46\u5bf9 tvshow-edges \u8f93\u5165\u5219\u9002\u5f97\u5176\u53cd\u3002</li> <li>Haswell \u4e0a tvshow-edges \u8f93\u5165\u53d7\u76ca\u4e8e prefetching\uff0c\u800c wiki-topcats \u5219\u51e0\u4e4e\u65e0\u6536\u76ca\u3002</li> <li>\u8fd9\u79cd\u4e0d\u4e00\u81f4\u6027\u51f8\u663e\u4e86\u9759\u6001\u7f16\u8bd1\u5668\u96be\u4ee5\u51c6\u786e\u9884\u6d4b\u6700\u4f18 prefetch \u914d\u7f6e\u7684\u95ee\u9898\uff0c\u4e5f\u8bf4\u660e\u4e86 RPG2 \u8fd9\u7c7b\u52a8\u6001\u8c03\u6574\u7cfb\u7edf\u7684\u91cd\u8981\u6027\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-3-the-bfs-benchmark-from-crono-2-often-but-not-always-suffers-significant-performance-slowdown-with-prefetching","title":"Figure 3. The bfs benchmark from CRONO [2] often (but not always) suffers significant performance slowdown with prefetching.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 bfs \u57fa\u51c6\u6d4b\u8bd5\u5728\u4e0d\u540c\u8f93\u5165\u548c\u5fae\u67b6\u6784\u4e0b\u7684\u6027\u80fd\u8868\u73b0\uff0c\u6a2a\u8f74\u4e3a prefetch distance\uff08\u9884\u53d6\u8ddd\u79bb\uff09\uff0c\u7eb5\u8f74\u4e3a speedup\uff08\u52a0\u901f\u6bd4\uff09\uff0c\u57fa\u51c6\u7ebf\u4e3a 1.0\u3002</li> <li>amazon0505 \u8f93\u5165\u5728 Cascade Lake \u4e0a\u8868\u73b0\u826f\u597d\uff0c\u52a0\u901f\u6bd4\u7a33\u5b9a\u5728 1.0 \u4ee5\u4e0a\uff0c\u8868\u660e\u9884\u53d6\u5728\u6b64\u914d\u7f6e\u4e0b\u6709\u6548\u3002</li> <li>\u540c\u4e00\u8f93\u5165 amazon0505 \u5728 Haswell \u4e0a\u52a0\u901f\u6bd4\u7565\u4f4e\u4e8e 1.0\uff0c\u8bf4\u660e\u9884\u53d6\u5728\u6b64\u5fae\u67b6\u6784\u4e0b\u6548\u679c\u4e0d\u4f73\u6216\u7565\u6709\u62d6\u7d2f\u3002</li> <li>RO-edges \u8f93\u5165\u5728 Haswell \u4e0a\u52a0\u901f\u6bd4\u7ea6\u4e3a 0.45\uff0c\u663e\u8457\u4f4e\u4e8e\u57fa\u51c6\u7ebf\uff0c\u8868\u660e\u9884\u53d6\u5bfc\u81f4\u4e25\u91cd\u6027\u80fd\u4e0b\u964d\u3002</li> <li>RO-edges \u8f93\u5165\u5728 Cascade Lake \u4e0a\u52a0\u901f\u6bd4\u7ea6\u4e3a 0.3\uff0c\u6027\u80fd\u4e0b\u964d\u66f4\u4e3a\u4e25\u91cd\uff0c\u8fdb\u4e00\u6b65\u51f8\u663e\u9884\u53d6\u7684\u8d1f\u9762\u5f71\u54cd\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0c\u9884\u53d6\u6548\u679c\u9ad8\u5ea6\u4f9d\u8d56\u4e8e \u8f93\u5165\u6570\u636e \u548c \u5fae\u67b6\u6784\uff0c\u540c\u4e00\u8f93\u5165\u5728\u4e0d\u540c\u786c\u4ef6\u4e0a\u8868\u73b0\u5dee\u5f02\u5de8\u5927\u3002</li> <li>\u6027\u80fd\u53d8\u5316\u8d8b\u52bf\u663e\u793a\uff0cprefetch distance \u7684\u8c03\u6574\u5bf9\u6027\u80fd\u5f71\u54cd\u6709\u9650\uff0c\u5c24\u5176\u5728 RO-edges \u8f93\u5165\u4e2d\uff0c\u65e0\u8bba\u8ddd\u79bb\u5982\u4f55\u8c03\u6574\uff0c\u6027\u80fd\u5747\u672a\u6539\u5584\u3002</li> </ul> \u8f93\u5165 \u5fae\u67b6\u6784 \u52a0\u901f\u6bd4\u8303\u56f4 \u6027\u80fd\u8d8b\u52bf amazon0505 Cascade Lake &gt;1.0 \u7a33\u5b9a\u63d0\u5347 amazon0505 Haswell ~0.95 \u8f7b\u5fae\u4e0b\u964d RO-edges Haswell ~0.45 \u663e\u8457\u4e0b\u964d RO-edges Cascade Lake ~0.3 \u6781\u5ea6\u4e0b\u964d <ul> <li>\u6b64\u56fe\u5370\u8bc1\u4e86\u8bba\u6587\u6838\u5fc3\u89c2\u70b9\uff1a\u9884\u53d6\u662f\u53cc\u5203\u5251\uff0c\u4e0d\u5f53\u4f7f\u7528\u4f1a\u5bfc\u81f4\u6027\u80fd\u5927\u5e45\u4e0b\u6ed1\uff0c\u9700\u52a8\u6001\u8c03\u6574\u4ee5\u9002\u5e94\u8fd0\u884c\u65f6\u73af\u5883\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-4-rpg2-proceeds-through-four-phases-when-optimizing-a-target-process","title":"Figure 4. RPG2 proceeds through four phases when optimizing a target process.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RPG2 \u7cfb\u7edf\u4f18\u5316\u76ee\u6807\u8fdb\u7a0b\u7684\u56db\u4e2a\u6838\u5fc3\u9636\u6bb5\uff0c\u4ece\u5de6\u81f3\u53f3\u4f9d\u6b21\u4e3a\uff1aProfile\u3001Build new binary\u3001Insert code \u548c Tune\u3002</li> <li>\u5728\u7b2c\u4e00\u9636\u6bb5 Profile \u4e2d\uff0cRPG2 \u901a\u8fc7\u5206\u6790\u8fd0\u884c\u4e2d\u7684\u76ee\u6807\u8fdb\u7a0b\uff0c\u8bc6\u522b\u51fa\u9891\u7e41\u89e6\u53d1 LLC miss \u7684\u6307\u4ee4\u3002\u56fe\u4e2d\u793a\u4f8b\u4ee3\u7801 <code>ld [r3+r2]\u2192r4</code> \u88ab\u6807\u8bb0\u4e3a\u9ad8\u9891 LLC miss \u6e90\uff0c\u5176\u524d\u5411\u4f9d\u8d56\u94fe\uff08backwards slice\uff09\u88ab\u63d0\u53d6\u7528\u4e8e\u540e\u7eed prefetch kernel \u6784\u5efa\u3002</li> <li>\u7b2c\u4e8c\u9636\u6bb5 Build new binary \u57fa\u4e8e BOLT \u5de5\u5177\u751f\u6210\u65b0\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u56fe\u4e2d\u7ea2\u8272\u9ad8\u4eae\u90e8\u5206\u4e3a\u63d2\u5165\u7684 prefetch kernel\uff0c\u5305\u542b\uff1a</li> <li>\u5bc4\u5b58\u5668\u4fdd\u5b58\uff08<code>push r5</code>\uff09</li> <li>\u5730\u5740\u8ba1\u7b97\uff08<code>add r1, #20\u2192r5</code>\uff0c\u5176\u4e2d 20 \u4e3a\u521d\u59cb prefetch distance\uff09</li> <li>\u8fb9\u754c\u68c0\u67e5\uff08<code>cmp r5, #100; bgte cleanup</code>\uff09</li> <li>\u9884\u53d6\u6307\u4ee4\uff08<code>pf [r3+r5]</code>\uff09</li> <li>\u6e05\u7406\u4e0e\u6062\u590d\uff08<code>pop r5</code>\uff09</li> <li>\u539f\u59cb\u5faa\u73af\u4f53\u7ee7\u7eed\u6267\u884c</li> <li>\u7b2c\u4e09\u9636\u6bb5 Insert code \u5c06\u65b0\u51fd\u6570 <code>newtop</code> \u6ce8\u5165\u76ee\u6807\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u3002\u6b64\u9636\u6bb5\u9700\u6682\u505c\u8fdb\u7a0b\uff0c\u901a\u8fc7 <code>ptrace</code> \u6216 <code>libpg2</code> \u5b9e\u73b0\u4ee3\u7801\u66ff\u6362\uff0c\u5e76\u66f4\u65b0\u6240\u6709\u6307\u5411\u539f\u51fd\u6570 <code>top</code> \u7684\u8c03\u7528\u70b9\u548c\u6808\u8fd4\u56de\u5730\u5740\uff0c\u786e\u4fdd\u63a7\u5236\u6d41\u6b63\u786e\u8df3\u8f6c\u81f3 <code>newtop</code>\u3002</li> <li>\u7b2c\u56db\u9636\u6bb5 Tune \u5bf9 prefetch distance \u8fdb\u884c\u52a8\u6001\u8c03\u6574\u3002\u56fe\u4e2d\u663e\u793a\u5c06\u8ddd\u79bb\u4ece 20 \u4fee\u6539\u4e3a 32\uff08<code>add r1, #32\u2192r2</code>\uff09\uff0c\u8be5\u8fc7\u7a0b\u901a\u8fc7\u4fee\u6539\u673a\u5668\u7801\u4e2d\u7684\u7acb\u5373\u6570\u5b9e\u73b0\uff0c\u6bcf\u6b21\u8c03\u6574\u4ec5\u9700\u91cd\u5199\u5c11\u91cf\u5b57\u8282\uff0c\u4e14\u4f34\u968f\u77ed\u6682\u8fdb\u7a0b\u6682\u505c\u3002</li> <li>\u6574\u4e2a\u6d41\u7a0b\u5f3a\u8c03 \u5728\u7ebf\u4f18\u5316 \u4e0e \u65e0\u4fb5\u5165\u5f0f\u56de\u9000\uff1a\u82e5 tuning \u540e\u6027\u80fd\u672a\u63d0\u5347\uff0cRPG2 \u53ef\u5feb\u901f\u56de\u6eda\u81f3\u539f\u59cb\u4ee3\u7801 <code>top</code>\uff0c\u907f\u514d\u6027\u80fd\u635f\u5931\u3002</li> <li>\u5173\u952e\u672f\u8bed\u4fdd\u7559\u82f1\u6587\uff1aLLC miss\u3001prefetch kernel\u3001backwards slice\u3001BOLT\u3001ptrace\u3001libpg2\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u5448\u73b0\u4e86 RPG2 \u5982\u4f55\u5728\u4e0d\u4e2d\u65ad\u7a0b\u5e8f\u8bed\u4e49\u7684\u524d\u63d0\u4e0b\uff0c\u52a8\u6001\u6ce8\u5165\u5e76\u4f18\u5316 prefetch \u6307\u4ee4\uff0c\u4f53\u73b0\u5176\u201crobust\u201d\u7279\u6027\u2014\u2014\u65e2\u80fd\u63d0\u5347\u6027\u80fd\uff0c\u4e5f\u80fd\u5b89\u5168\u56de\u9000\u3002</li> </ul> \u9636\u6bb5 \u4e3b\u8981\u64cd\u4f5c \u5173\u952e\u6280\u672f/\u7ec4\u4ef6 \u76ee\u6807 Profile \u8bc6\u522b\u9ad8\u9891 LLC miss \u6307\u4ee4 PEBS, perf \u5b9a\u4f4d\u53ef\u4f18\u5316\u70b9 Build new binary \u63d2\u5165 prefetch kernel BOLT, InjectPrefetchPass \u751f\u6210\u542b\u9884\u53d6\u903b\u8f91\u7684\u65b0\u51fd\u6570 Insert code \u6ce8\u5165\u65b0\u51fd\u6570\u5230\u8fd0\u884c\u8fdb\u7a0b ptrace, libpg2, OSR \u5b9e\u73b0\u8fd0\u884c\u65f6\u4ee3\u7801\u66ff\u6362 Tune \u52a8\u6001\u8c03\u6574 prefetch distance IPC \u76d1\u63a7, \u4e8c\u5206\u641c\u7d22 \u627e\u5230\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u6216\u56de\u9000 <ul> <li>\u56fe\u4e2d\u7bad\u5934\u4e0e\u865a\u7ebf\u6846\u6e05\u6670\u5212\u5206\u5404\u9636\u6bb5\u8fb9\u754c\uff0c\u5f3a\u8c03\u201cpaused\u201d\u72b6\u6001\u4ec5\u5728\u5173\u952e\u64cd\u4f5c\u65f6\u53d1\u751f\uff0c\u5176\u4f59\u65f6\u95f4\u76ee\u6807\u8fdb\u7a0b\u6b63\u5e38\u8fd0\u884c\uff0c\u6700\u5c0f\u5316\u6027\u80fd\u5e72\u6270\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#table-1-memory-access-categories-that-rpg2-supports","title":"Table 1. Memory access categories that RPG2 supports","text":"<ul> <li>\u56fe\u7247\u5185\u5bb9\u4e3a Table 1\uff0c\u6807\u9898\u4e3a \u201cMemory access categories that RPG2 supports\u201d\uff0c\u7528\u4e8e\u8bf4\u660e RPG2 \u7cfb\u7edf\u652f\u6301\u7684\u4e09\u79cd\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u53ca\u5176\u5bf9\u5e94\u7684\u9884\u53d6\u7b56\u7565\u3002</li> <li>\u8868\u683c\u5305\u542b\u4e09\u5217\uff1ademand access\uff08\u9700\u6c42\u8bbf\u95ee\uff09\u3001prefetch\uff08\u9884\u53d6\u8868\u8fbe\u5f0f\uff09\u3001description\uff08\u63cf\u8ff0\uff09\u3002</li> <li>\u4e09\u79cd\u8bbf\u95ee\u6a21\u5f0f\u5747\u57fa\u4e8e\u6570\u7ec4\u548c\u5faa\u73af\u53d8\u91cf\u6784\u5efa\uff0c\u9002\u7528\u4e8e\u5e38\u89c1\u6570\u636e\u7ed3\u6784\u5982\u5bc6\u96c6\u6570\u7ec4\u3001\u7a00\u758f\u6570\u7ec4\u548c stencil \u6a21\u5f0f\u3002</li> </ul> demand access prefetch description a[j] a[j+d] direct access using inner loop induction var a[f(b[j])] a[f(b[j+d])] indirect access using inner loop induction var a[f(b[i])+j] a[f(b[i+d])+j] indirect access using inner and outer loop induction vars <ul> <li>\u7b2c\u4e00\u884c\u5bf9\u5e94\u76f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff0cRPG2 \u5728\u5185\u5c42\u5faa\u73af\u4e2d\u5bf9\u7d22\u5f15 <code>j</code> \u504f\u79fb <code>d</code> \u8fdb\u884c\u9884\u53d6\uff0c\u9002\u7528\u4e8e\u5177\u6709\u7a7a\u95f4\u5c40\u90e8\u6027\u7684\u6570\u7ec4\u8bbf\u95ee\u3002</li> <li>\u7b2c\u4e8c\u884c\u5bf9\u5e94\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff0c\u901a\u8fc7\u51fd\u6570 <code>f</code> \u5bf9 <code>b[j]</code> \u7684\u7ed3\u679c\u8fdb\u884c\u5bfb\u5740\uff0c\u9884\u53d6\u65f6\u5c06 <code>j</code> \u66ff\u6362\u4e3a <code>j+d</code>\uff0c\u4ee5\u8986\u76d6\u66f4\u590d\u6742\u7684\u6307\u9488\u94fe\u5f0f\u8bbf\u95ee\u3002</li> <li>\u7b2c\u4e09\u884c\u5bf9\u5e94\u5d4c\u5957\u5faa\u73af\u4e2d\u7684\u6df7\u5408\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4f7f\u7528\u5916\u5c42\u5faa\u73af\u53d8\u91cf <code>i</code> \u548c\u5185\u5c42\u53d8\u91cf <code>j</code>\uff0c\u9884\u53d6\u65f6\u4ec5\u504f\u79fb\u5916\u5c42\u53d8\u91cf <code>i</code> \u81f3 <code>i+d</code>\uff0c\u8be5\u7b56\u7565\u5728\u5b9e\u9a8c\u4e2d\u8868\u73b0\u4f18\u4e8e\u540c\u65f6\u504f\u79fb\u5185\u5916\u5c42\u53d8\u91cf\u3002</li> <li>RPG2 \u5f53\u524d\u4ec5\u652f\u6301\u8fd9\u4e09\u7c7b\u6a21\u5f0f\uff0c\u4f46\u4f5c\u8005\u6307\u51fa\u5176\u5df2\u8986\u76d6\u591a\u6570\u5b9e\u9645\u4ee3\u7801\u573a\u666f\uff0c\u5982\u7a20\u5bc6/\u7a00\u758f\u6570\u7ec4\u4e0e stencil \u8ba1\u7b97\u3002</li> <li>\u672a\u652f\u6301\u7684\u6a21\u5f0f\u5305\u62ec\u7eaf\u6307\u9488\u7ed3\u6784\uff08\u65e0\u6570\u7ec4\u53c2\u4e0e\uff09\uff0c\u7559\u5f85\u672a\u6765\u6269\u5c55\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-5-annotated-example-of-rpg2-code-transformations","title":"Figure 5. Annotated example of RPG2 code transformations.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RPG2 \u7cfb\u7edf\u5bf9\u4e00\u6bb5\u539f\u59cb\u6c47\u7f16\u4ee3\u7801\u8fdb\u884c\u4f18\u5316\u7684\u5b8c\u6574\u6d41\u7a0b\uff0c\u6838\u5fc3\u76ee\u6807\u662f\u4e3a\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee\uff08\u5982 <code>ld [r3+r2]\u2192r4</code>\uff09\u63d2\u5165prefetch kernel\uff0c\u540c\u65f6\u4fdd\u8bc1\u8bed\u4e49\u4e0d\u53d8\u3002</li> <li>\u539f\u59cb\u4ee3\u7801\u662f\u4e00\u4e2a\u5faa\u73af\u4f53\uff0c\u5305\u542b\u4e24\u4e2a\u5173\u952e\u52a0\u8f7d\u6307\u4ee4\uff1a<code>ld [r0+r1]\u2192r2</code> \u548c <code>ld [r3+r2]\u2192r4</code>\u3002\u5176\u4e2d\uff0c\u540e\u8005\u662f\u5bfc\u81f4 LLC miss \u7684\u70ed\u70b9\u8d1f\u8f7d\uff0c\u88ab\u9009\u4e3a prefetch \u76ee\u6807\u3002</li> <li>RPG2 \u901a\u8fc7backwards slicing\u5206\u6790\u6570\u636e\u4f9d\u8d56\u94fe\uff0c\u4ece <code>ld [r3+r2]\u2192r4</code> \u56de\u6eaf\u81f3 <code>ld [r0+r1]\u2192r2</code>\uff0c\u786e\u8ba4\u5176\u5c5e\u4e8e <code>a[??(b[j])]</code> \u7c7b\u578b\u7684\u95f4\u63a5\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4ece\u800c\u51b3\u5b9a\u5728\u5916\u5c42\u5faa\u73af\u5934\u63d2\u5165 prefetch kernel\u3002</li> <li>\u4f18\u5316\u540e\u7684\u4ee3\u7801\u7ed3\u6784\u6e05\u6670\u5206\u4e3a\u4e09\u90e8\u5206\uff1a</li> <li>Prefetch Kernel\uff1a\u4f4d\u4e8e <code>newtop</code> \u6807\u7b7e\u4e0b\uff0c\u8d1f\u8d23\u8ba1\u7b97\u5e76\u6267\u884c prefetch \u6307\u4ee4\u3002</li> <li>Cleanup\uff1a\u6062\u590d\u88ab\u501f\u7528\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u3002</li> <li>Original Loop Body\uff1a\u4fdd\u6301\u539f\u6709\u903b\u8f91\u4e0d\u53d8\u3002</li> <li>\u5177\u4f53\u4f18\u5316\u6b65\u9aa4\u5982\u4e0b\uff1a</li> <li>\u4fdd\u5b58\u5bc4\u5b58\u5668\uff1a<code>push r5</code> \u5c06\u5bc4\u5b58\u5668 <code>r5</code> \u538b\u6808\uff0c\u4f5c\u4e3a\u4e34\u65f6\u5de5\u4f5c\u5bc4\u5b58\u5668\u3002</li> <li>\u8ba1\u7b97 prefetch \u5730\u5740\uff1a<code>add r1, #20\u2192r5</code> \u8ba1\u7b97 20 \u4e2a\u8fed\u4ee3\u540e\u7684\u5730\u5740\u504f\u79fb\u91cf\u3002</li> <li>\u8fb9\u754c\u68c0\u67e5\uff1a<code>cmp r5, #100</code> \u548c <code>bgte cleanup_</code> \u786e\u4fdd\u4e0d\u4f1a\u8bbf\u95ee\u975e\u6cd5\u5185\u5b58\u3002</li> <li>\u6267\u884c prefetch\uff1a<code>ld [r0+r5]\u2192r5</code> \u548c <code>pf [r3+r5]</code> \u5206\u522b\u52a0\u8f7d\u7d22\u5f15\u548c\u53d1\u51fa prefetch \u6307\u4ee4\u3002</li> <li>\u6062\u590d\u72b6\u6001\uff1a<code>pop r5</code> \u6062\u590d\u539f\u5bc4\u5b58\u5668\u503c\u3002</li> <li>\u6267\u884c\u539f\u5faa\u73af\u4f53\uff1a\u540e\u7eed\u6307\u4ee4\u4e0e\u539f\u59cb\u4ee3\u7801\u5b8c\u5168\u4e00\u81f4\u3002</li> <li>\u6574\u4e2a\u8fc7\u7a0b\u4f53\u73b0\u4e86 RPG2 \u7684\u8bbe\u8ba1\u54f2\u5b66\uff1aNOP-like semantics\uff0c\u5373 prefetch kernel \u5728\u529f\u80fd\u4e0a\u7b49\u4ef7\u4e8e\u7a7a\u64cd\u4f5c\uff0c\u4ec5\u589e\u52a0\u9884\u53d6\u884c\u4e3a\uff0c\u4e0d\u6539\u53d8\u7a0b\u5e8f\u903b\u8f91\u3002</li> <li>\u8be5\u56fe\u8fd8\u7528\u7bad\u5934\u6807\u6ce8\u4e86\u63a7\u5236\u6d41\u8def\u5f84\uff0c\u6e05\u6670\u5c55\u793a\u4e86 prefetch kernel \u5982\u4f55\u65e0\u7f1d\u5d4c\u5165\u5230\u539f\u6709\u5faa\u73af\u4e2d\uff0c\u786e\u4fdd\u7a0b\u5e8f\u6b63\u786e\u6027\u548c\u6027\u80fd\u63d0\u5347\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-6-the-pc-register-and-code-memory-of-the-target-process-before-and-after-rpg2s-code-replacement","title":"Figure 6. The PC register and code memory of the target process before and after, RPG2\u2019s code replacement.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RPG2 \u7cfb\u7edf\u5728\u8fd0\u884c\u65f6\u8fdb\u884c \u4ee3\u7801\u66ff\u6362 \u7684\u524d\u540e\u5bf9\u6bd4\uff0c\u6838\u5fc3\u76ee\u6807\u662f\u5c06\u539f\u59cb\u51fd\u6570 <code>f0</code> \u66ff\u6362\u4e3a\u4f18\u5316\u540e\u7684\u51fd\u6570 <code>f1</code>\uff0c\u540c\u65f6\u4fdd\u6301\u7a0b\u5e8f\u8bed\u4e49\u4e0d\u53d8\u3002</li> <li>\u201cbefore\u201d \u90e8\u5206\uff1a</li> <li>\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\u6307\u5411\u51fd\u6570 <code>f0</code> \u7684\u67d0\u6761\u6307\u4ee4\uff0c\u8868\u793a\u5f53\u524d\u6b63\u5728\u6267\u884c <code>f0</code>\u3002</li> <li>\u51fd\u6570 <code>g0</code> \u548c <code>h0</code> \u5185\u90e8\u5747\u5305\u542b\u5bf9 <code>f0</code> \u7684\u8c03\u7528\u6307\u4ee4\uff08<code>call f0</code>\uff09\uff0c\u5373\u5b83\u4eec\u7684\u6267\u884c\u6d41\u4f1a\u8df3\u8f6c\u5230 <code>f0</code>\u3002</li> <li>\u6240\u6709\u8c03\u7528\u548c\u6267\u884c\u90fd\u56f4\u7ed5 <code>f0</code> \u8fdb\u884c\uff0c\u6b64\u65f6\u7cfb\u7edf\u5c1a\u672a\u5e94\u7528\u4efb\u4f55\u4f18\u5316\u3002</li> <li>\u201cafter\u201d \u90e8\u5206\uff1a</li> <li>RPG2 \u5c06\u4f18\u5316\u540e\u7684\u51fd\u6570 <code>f1</code> \u653e\u7f6e\u5728\u5185\u5b58\u4e2d\u7684\u65b0\u4f4d\u7f6e\uff08\u7ea2\u8272\u533a\u57df\uff09\uff0c\u800c\u539f\u59cb\u51fd\u6570 <code>f0</code> \u4ecd\u4fdd\u7559\u5728\u539f\u5904\u3002</li> <li>\u6240\u6709\u539f\u672c\u8c03\u7528 <code>f0</code> \u7684\u6307\u4ee4\uff08\u5982 <code>g0</code> \u548c <code>h0</code> \u4e2d\u7684 <code>call f0</code>\uff09\u88ab\u4fee\u6539\u4e3a\u8c03\u7528 <code>f1</code>\uff08\u5373 <code>call f1</code>\uff09\u3002</li> <li>PC \u6307\u9488\u5df2\u66f4\u65b0\uff0c\u6307\u5411 <code>f1</code> \u4e2d\u5bf9\u5e94\u7684\u6307\u4ee4\u4f4d\u7f6e\uff0c\u786e\u4fdd\u7ebf\u7a0b\u4ece <code>f0</code> \u7684\u6267\u884c\u70b9\u65e0\u7f1d\u5207\u6362\u5230 <code>f1</code> \u7684\u5bf9\u5e94\u4f4d\u7f6e\u3002</li> <li>\u6b64\u8bbe\u8ba1\u5141\u8bb8 RPG2 \u5728\u6027\u80fd\u9000\u5316\u65f6\u5feb\u901f\u56de\u6eda\u81f3 <code>f0</code>\uff0c\u65e0\u9700\u91cd\u65b0\u7f16\u8bd1\u6216\u91cd\u542f\u8fdb\u7a0b\u3002</li> <li>\u5173\u952e\u673a\u5236\uff1aRPG2 \u5229\u7528 BOLT Address Translation Table (BATT) \u5b9e\u73b0 On-Stack Replacement (OSR)\uff0c\u5c06 <code>f0</code> \u7684 PC \u6620\u5c04\u5230 <code>f1</code> \u7684\u7b49\u6548\u4f4d\u7f6e\uff0c\u4ece\u800c\u652f\u6301\u5728\u51fd\u6570\u6267\u884c\u4e2d\u9014\u5207\u6362\u7248\u672c\u3002</li> <li>\u4f18\u52bf\u603b\u7ed3\uff1a</li> </ul> \u7279\u6027 \u63cf\u8ff0 \u96f6\u6570\u636e\u5e03\u5c40\u53d8\u66f4 Prefetch kernel \u8bbe\u8ba1\u4e3a\u903b\u8f91 NOP\uff0c\u4e0d\u6539\u53d8\u5bc4\u5b58\u5668\u6216\u6808\u53d8\u91cf\u5206\u914d\u3002 \u5b89\u5168\u56de\u6eda \u82e5 <code>f1</code> \u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\uff0c\u53ef\u6062\u590d\u81f3 <code>f0</code>\uff0c\u4fdd\u7559\u539f\u59cb\u6027\u80fd\u3002 \u4f4e\u5f00\u9500\u6ce8\u5165 \u4f7f\u7528 <code>libpg2</code> \u76f4\u63a5\u64cd\u4f5c\u76ee\u6807\u8fdb\u7a0b\u5185\u5b58\uff0c\u907f\u514d\u9891\u7e41\u7cfb\u7edf\u8c03\u7528\u3002 \u517c\u5bb9\u6027 \u65e0\u9700\u6e90\u7801\uff0c\u4ec5\u4f9d\u8d56\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u9002\u7528\u4e8e C/C++ \u7b49\u975e\u6258\u7ba1\u8bed\u8a00\u3002 <ul> <li>\u8be5\u56fe\u76f4\u89c2\u4f53\u73b0\u4e86 RPG2 \u5982\u4f55\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u63d2\u5165\u5e76\u6fc0\u6d3b\u4f18\u5316\u4ee3\u7801\uff0c\u540c\u65f6\u4fdd\u969c\u7a0b\u5e8f\u7a33\u5b9a\u6027\u548c\u6027\u80fd\u53ef\u9006\u6027\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-7-rpg2-and-baseline-performance-on-cascade-lake-top-and-haswell-bottom","title":"Figure 7. RPG2 and baseline performance on Cascade Lake (top) and Haswell (bottom).","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RPG2 \u7cfb\u7edf\u5728 Cascade Lake \u548c Haswell \u4e24\u79cd\u5fae\u67b6\u6784\u4e0a\u7684\u6027\u80fd\u8868\u73b0\uff0c\u5bf9\u6bd4\u4e86\u591a\u4e2a\u57fa\u7ebf\u65b9\u6848\uff0c\u5305\u62ec APT-GET\u3001offline\u3001active-only \u548c manual\u3002</li> <li>\u6570\u636e\u6309\u57fa\u51c6\u6d4b\u8bd5\uff08CRONO \u548c AJ\uff09\u548c\u673a\u5668\u7c7b\u578b\u5206\u7ec4\uff0c\u6bcf\u4e2a\u67f1\u72b6\u56fe\u4ee3\u8868\u4e0d\u540c\u8f93\u5165\u96c6\u5408\u7684\u5e73\u5747\u52a0\u901f\u6bd4\uff08speedup over original\uff09\uff0c\u8bef\u5dee\u6761\u8868\u793a\u6807\u51c6\u5dee\u3002</li> <li>CRONO \u57fa\u51c6\u6d4b\u8bd5\u5305\u542b pr\u3001sssp\u3001bfs \u548c bc\uff0cAJ \u57fa\u51c6\u6d4b\u8bd5\u5305\u542b cg\u3001is \u548c randacc\u3002\u6bcf\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u8fdb\u4e00\u6b65\u7ec6\u5206\u4e3a\u201call\u201d\u3001\u201cspeedup\u201d\u548c\u201cslowdown\u201d\u4e09\u7ec4\uff0c\u5206\u522b\u5bf9\u5e94\u6240\u6709\u8f93\u5165\u3001\u4ec5\u52a0\u901f\u8f93\u5165\u548c\u4ec5\u51cf\u901f\u8f93\u5165\u3002</li> <li>\u5728 Cascade Lake \u4e0a\uff0cRPG2 \u5728 pr \u548c sssp \u7684\u201cspeedup\u201d\u7ec4\u4e2d\u8868\u73b0\u4f18\u5f02\uff0c\u63a5\u8fd1\u6216\u8d85\u8fc7 offline \u548c APT-GET\uff1b\u4f46\u5728 bfs \u7684\u201cslowdown\u201d\u7ec4\u4e2d\uff0cRPG2 \u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u65b9\u6848\uff0c\u56e0\u5176\u80fd\u81ea\u52a8\u56de\u6eda\u81f3\u539f\u59cb\u4ee3\u7801\u3002</li> <li>\u5728 Haswell \u4e0a\uff0cRPG2 \u5728 pr \u548c sssp \u7684\u201cspeedup\u201d\u7ec4\u4e2d\u4ecd\u4fdd\u6301\u7ade\u4e89\u529b\uff0c\u4f46\u5728 bfs \u7684\u201cslowdown\u201d\u7ec4\u4e2d\u4f18\u52bf\u66f4\u52a0\u660e\u663e\uff0c\u56e0\u4e3a\u5176\u80fd\u6709\u6548\u907f\u514d prefetching \u5e26\u6765\u7684\u6027\u80fd\u4e0b\u964d\u3002</li> <li>\u5bf9\u4e8e AJ \u57fa\u51c6\u6d4b\u8bd5\uff0cRPG2 \u5728 is \u548c randacc \u4e0a\u8868\u73b0\u826f\u597d\uff0c\u5c24\u5176\u5728 Haswell \u4e0a\u63a5\u8fd1 manual \u4f18\u5316\u6c34\u5e73\uff1b\u4f46\u5728 cg \u4e0a\u8868\u73b0\u8f83\u5f31\uff0c\u53ef\u80fd\u56e0\u8f93\u5165\u7279\u6027\u6216 prefetching \u7b56\u7565\u4e0d\u5339\u914d\u3002</li> <li>active-only \u6a21\u5f0f\u4ec5\u5728\u6536\u96c6\u5230\u8db3\u591f profiling \u6570\u636e\u65f6\u6fc0\u6d3b\u4f18\u5316\uff0c\u56e0\u6b64\u5176\u6027\u80fd\u901a\u5e38\u4f4e\u4e8e full RPG2\uff0c\u4f46\u9ad8\u4e8e offline\uff0c\u8868\u660e online profiling \u5b58\u5728\u4e00\u5b9a\u566a\u58f0\u548c\u5ef6\u8fdf\u3002</li> <li>offline \u6a21\u5f0f\u59cb\u7ec8\u542f\u7528 prefetching\uff0c\u867d\u5728\u90e8\u5206\u8f93\u5165\u4e0a\u8868\u73b0\u6700\u4f73\uff0c\u4f46\u5728 prefetching \u6709\u5bb3\u7684\u8f93\u5165\u4e0a\u4f1a\u5bfc\u81f4\u663e\u8457 slowdown\uff0c\u800c RPG2 \u80fd\u52a8\u6001\u89c4\u907f\u6b64\u7c7b\u60c5\u51b5\u3002</li> <li>\u603b\u4f53\u800c\u8a00\uff0cRPG2 \u5728\u4fdd\u8bc1\u6027\u80fd\u63d0\u5347\u7684\u540c\u65f6\uff0c\u901a\u8fc7\u52a8\u6001\u8c03\u6574\u548c\u56de\u6eda\u673a\u5236\uff0c\u663e\u8457\u63d0\u5347\u4e86 prefetching \u7684\u9c81\u68d2\u6027\uff0c\u5c24\u5176\u5728\u9762\u5bf9\u8f93\u5165\u548c\u5fae\u67b6\u6784\u53d8\u5316\u65f6\u8868\u73b0\u7a33\u5b9a\u3002</li> </ul> Benchmark Machine Group RPG2 Speedup APT-GET Speedup Offline Speedup Notes pr Cascade Lake all (71) ~1.2 ~1.1 ~1.2 RPG2 \u4e0e offline \u76f8\u5f53 pr Cascade Lake speedup (54) ~1.3 ~1.2 ~1.3 RPG2 \u7565\u4f18 pr Cascade Lake slowdown (11) ~0.9 ~0.8 ~0.7 RPG2 \u660e\u663e\u4f18\u4e8e\u5176\u4ed6 sssp Cascade Lake all (71) ~1.3 ~1.2 ~1.3 RPG2 \u4e0e offline \u76f8\u5f53 sssp Cascade Lake speedup (54) ~1.4 ~1.3 ~1.4 RPG2 \u7565\u4f18 sssp Cascade Lake slowdown (11) ~0.8 ~0.7 ~0.6 RPG2 \u660e\u663e\u4f18\u4e8e\u5176\u4ed6 bfs Cascade Lake all (71) ~1.0 ~0.9 ~1.0 RPG2 \u4e0e offline \u76f8\u5f53 bfs Cascade Lake speedup (2) ~1.1 ~1.0 ~1.1 RPG2 \u7565\u4f18 bfs Cascade Lake slowdown (42) ~0.7 ~0.6 ~0.5 RPG2 \u660e\u663e\u4f18\u4e8e\u5176\u4ed6 bc Cascade Lake all (7) ~1.1 ~1.0 ~1.1 RPG2 \u4e0e offline \u76f8\u5f53 bc Cascade Lake speedup (4) ~1.2 ~1.1 ~1.2 RPG2 \u7565\u4f18 bc Cascade Lake slowdown (3) ~0.9 ~0.8 ~0.7 RPG2 \u660e\u663e\u4f18\u4e8e\u5176\u4ed6 pr Haswell all (67) ~1.2 ~1.1 ~1.2 RPG2 \u4e0e offline \u76f8\u5f53 pr Haswell speedup (51) ~1.3 ~1.2 ~1.3 RPG2 \u7565\u4f18 pr Haswell slowdown (16) ~0.8 ~0.7 ~0.6 RPG2 \u660e\u663e\u4f18\u4e8e\u5176\u4ed6 sssp Haswell all (67) ~1.3 ~1.2 ~1.3 RPG2 \u4e0e offline \u76f8\u5f53 sssp Haswell speedup (46) ~1.4 ~1.3 ~1.4 RPG2 \u7565\u4f18 sssp Haswell slowdown (21) ~0.7 ~0.6 ~0.5 RPG2 \u660e\u663e\u4f18\u4e8e\u5176\u4ed6 bfs Haswell all (67) ~1.0 ~0.9 ~1.0 RPG2 \u4e0e offline \u76f8\u5f53 bfs Haswell speedup (8) ~1.1 ~1.0 ~1.1 RPG2 \u7565\u4f18 bfs Haswell slowdown (31) ~0.6 ~0.5 ~0.4 RPG2 \u660e\u663e\u4f18\u4e8e\u5176\u4ed6 bc Haswell all (7) ~1.1 ~1.0 ~1.1 RPG2 \u4e0e offline \u76f8\u5f53 bc Haswell speedup (6) ~1.2 ~1.1 ~1.2 RPG2 \u7565\u4f18 bc Haswell slowdown (1) ~0.9 ~0.8 ~0.7 RPG2 \u660e\u663e\u4f18\u4e8e\u5176\u4ed6 cg Cascade Lake - ~0.8 ~0.7 ~0.9 RPG2 \u8868\u73b0\u4e00\u822c is Cascade Lake - ~1.3 ~1.2 ~1.3 RPG2 \u4e0e offline \u76f8\u5f53 randacc Cascade Lake - ~1.4 ~1.3 ~1.4 RPG2 \u7565\u4f18 cg Haswell - ~1.0 ~0.9 ~1.1 RPG2 \u8868\u73b0\u4e00\u822c is Haswell - ~1.2 ~1.1 ~1.2 RPG2 \u4e0e offline \u76f8\u5f53 randacc Haswell - ~1.3 ~1.2 ~1.3 RPG2 \u7565\u4f18 <ul> <li>\u5173\u952e\u7ed3\u8bba\uff1aRPG2 \u7684\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u5176\u52a8\u6001\u9002\u5e94\u80fd\u529b\uff0c\u4e0d\u4ec5\u80fd\u6355\u6349\u8f93\u5165\u548c\u5fae\u67b6\u6784\u53d8\u5316\u5e26\u6765\u7684\u6027\u80fd\u5dee\u5f02\uff0c\u8fd8\u80fd\u5728 prefetching \u6709\u5bb3\u65f6\u81ea\u52a8\u56de\u6eda\uff0c\u4ece\u800c\u5728\u6574\u4f53\u4e0a\u63d0\u4f9b\u66f4\u7a33\u5b9a\u548c\u53ef\u9760\u7684\u6027\u80fd\u63d0\u5347\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-8-how-close-rpg2-gets-to-the-optimal-prefetch-distance-for-inputs-with-a-single-optimal-distance","title":"Figure 8. How close RPG2 gets to the optimal prefetch distance, for inputs with a single optimal distance.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 8\uff0c\u4e3b\u9898\u662f\u8bc4\u4f30 RPG2 \u5728\u5177\u6709\u5355\u4e00\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u7684\u8f93\u5165\u4e0a\uff0c\u5176\u641c\u7d22\u7ed3\u679c\u4e0e\u771f\u5b9e\u6700\u4f18\u503c\u4e4b\u95f4\u7684\u504f\u5dee\u3002</li> <li>\u6a2a\u8f74\u8868\u793a absolute distance from optimal prefetch distance\uff0c\u5373 RPG2 \u627e\u5230\u7684\u8ddd\u79bb\u4e0e\u771f\u5b9e\u6700\u4f18\u8ddd\u79bb\u4e4b\u95f4\u7684\u7edd\u5bf9\u5dee\u503c\uff0c\u5355\u4f4d\u4e3a\u8fed\u4ee3\u6b21\u6570\u3002</li> <li>\u7eb5\u8f74\u8868\u793a frequency\uff0c\u5373\u5728 120 \u4e2a\u6d4b\u8bd5\u8f93\u5165\u4e2d\uff0c\u5bf9\u5e94\u504f\u5dee\u503c\u51fa\u73b0\u7684\u9891\u6b21\u3002</li> <li>\u6570\u636e\u5206\u5e03\u5448\u73b0\u660e\u663e\u7684\u53f3\u504f\u6001\uff1a\u5927\u90e8\u5206\u8f93\u5165\uff08\u7ea6 50%\uff09\u7684\u504f\u5dee\u5728 10 \u4ee5\u5185\uff0c\u5176\u4e2d\u504f\u5dee\u4e3a 0\u20133 \u7684\u8f93\u5165\u6709 22 \u4e2a\uff0c\u504f\u5dee\u4e3a 4\u201310 \u7684\u8f93\u5165\u5408\u8ba1\u7ea6 36 \u4e2a\u3002</li> <li>\u504f\u5dee\u8d85\u8fc7 20 \u7684\u8f93\u5165\u6570\u91cf\u663e\u8457\u51cf\u5c11\uff0c\u4f46\u4ecd\u6709\u90e8\u5206\u8f93\u5165\u5b58\u5728\u8f83\u5927\u8bef\u5dee\uff0c\u5982\u504f\u5dee\u5728 50\u201360 \u533a\u95f4\u5185\u4ecd\u5b58\u5728\u591a\u4e2a\u6848\u4f8b\u3002</li> <li>\u6700\u5927\u504f\u5dee\u63a5\u8fd1 65\uff0c\u8868\u660e\u5728\u5c11\u6570\u6781\u7aef\u60c5\u51b5\u4e0b\uff0cRPG2 \u7684\u641c\u7d22\u672a\u80fd\u6536\u655b\u81f3\u6700\u4f18\u89e3\u3002</li> <li>\u4f5c\u8005\u6307\u51fa\uff0c\u6027\u80fd\u589e\u76ca\u5e76\u4e0d\u603b\u662f\u968f\u8ddd\u79bb\u903c\u8fd1\u6700\u4f18\u503c\u800c\u7ebf\u6027\u63d0\u5347\uff0c\u56e0\u6b64\u5373\u4f7f\u5b58\u5728\u4e00\u5b9a\u504f\u5dee\uff0c\u5b9e\u9645\u6027\u80fd\u5f71\u54cd\u53ef\u80fd\u6709\u9650\u3002</li> <li>\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u662f IPC \u6d4b\u91cf\u566a\u58f0\uff0c\u5bfc\u81f4\u641c\u7d22\u7a7a\u95f4\u88ab\u8bef\u5224\uff0c\u4ece\u800c\u63d0\u524d\u7ec8\u6b62\u6216\u504f\u79bb\u6700\u4f18\u8def\u5f84\u3002</li> </ul> \u504f\u5dee\u533a\u95f4 \u9891\u6b21\uff08\u8f93\u5165\u6570\uff09 \u5360\u6bd4\uff08\u8fd1\u4f3c\uff09 0\u20133 22 18.3% 4\u201310 ~36 ~30% 11\u201320 ~15 ~12.5% 21\u201330 ~10 ~8.3% 31\u201340 ~5 ~4.2% 41\u201350 ~3 ~2.5% 51\u201360 ~8 ~6.7% &gt;60 ~2 ~1.7% <ul> <li>\u603b\u4f53\u800c\u8a00\uff0cRPG2 \u7684\u9884\u53d6\u8ddd\u79bb\u641c\u7d22\u7b97\u6cd5\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u8868\u73b0\u826f\u597d\uff0c\u4f46\u5728\u9ad8\u566a\u58f0\u73af\u5883\u4e0b\u4ecd\u6709\u6539\u8fdb\u7a7a\u95f4\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-9-the-impact-of-profiling-phase-duration-on-rpg2s-optimization-activation","title":"Figure 9. The impact of profiling phase duration on RPG2\u2019s optimization activation.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 9\uff0c\u4e3b\u9898\u662f profiling phase duration \u5bf9 RPG2\u2019s optimization activation \u7684\u5f71\u54cd\u3002</li> <li>\u6a2a\u8f74\u8868\u793a profiling phase duration\uff0c\u53d6\u503c\u4e3a 0.5s, 1s, 2s, 4s\uff1b\u7eb5\u8f74\u4e3a\u767e\u5206\u6bd4\uff0c\u8303\u56f4\u4ece 0% \u5230 100%\u3002</li> <li>\u7eb5\u5411\u5806\u53e0\u67f1\u72b6\u56fe\u5206\u4e3a\u4e09\u6bb5\uff1a</li> <li>\u84dd\u8272\u5e95\u90e8\u533a\u57df\uff08always\uff09\uff1a\u8868\u793a\u5728\u6240\u6709\u8fd0\u884c\u4e2d\uff0cRPG2 \u7684\u4f18\u5316\u9636\u6bb5\uff08\u4ee3\u7801\u751f\u6210\u3001\u6ce8\u5165\u548c\u8c03\u4f18\uff09\u59cb\u7ec8\u88ab\u6fc0\u6d3b\u3002</li> <li>\u6d45\u84dd\u8272\u4e2d\u95f4\u533a\u57df\uff08mixed\uff09\uff1a\u8868\u793a\u4f18\u5316\u9636\u6bb5\u6709\u65f6\u88ab\u6fc0\u6d3b\uff0c\u6709\u65f6\u672a\u88ab\u6fc0\u6d3b\u3002</li> <li>\u7ea2\u8272\u9876\u90e8\u533a\u57df\uff08never\uff09\uff1a\u8868\u793a\u4f18\u5316\u9636\u6bb5\u4ece\u672a\u88ab\u6fc0\u6d3b\u3002</li> <li>\u6570\u636e\u8d8b\u52bf\u663e\u793a\uff1a</li> <li>\u968f\u7740 profiling duration \u589e\u52a0\uff0calways \u533a\u57df\u6269\u5927\uff0c\u8bf4\u660e\u66f4\u957f\u7684\u91c7\u6837\u65f6\u95f4\u63d0\u9ad8\u4e86 RPG2 \u6210\u529f\u89e6\u53d1\u4f18\u5316\u7684\u6982\u7387\u3002</li> <li>never \u533a\u57df\u7f29\u5c0f\uff0c\u8868\u660e\u8f83\u957f\u7684 profiling \u51cf\u5c11\u4e86\u56e0\u6570\u636e\u4e0d\u8db3\u5bfc\u81f4\u4f18\u5316\u5931\u8d25\u7684\u60c5\u51b5\u3002</li> <li>mixed \u533a\u57df\u53d8\u5316\u8f83\u5c0f\uff0c\u8bf4\u660e\u90e8\u5206\u8f93\u5165\u5bf9 profiling \u65f6\u95f4\u4e0d\u654f\u611f\u3002</li> <li>\u5177\u4f53\u6570\u503c\u4f30\u7b97\uff08\u57fa\u4e8e\u89c6\u89c9\u6bd4\u4f8b\uff09\uff1a</li> </ul> Profiling Duration Always (%) Mixed (%) Never (%) 0.5s ~38% ~47% ~15% 1s ~40% ~45% ~15% 2s ~39% ~48% ~13% 4s ~48% ~40% ~12% <ul> <li>\u7ed3\u8bba\uff1a\u5ef6\u957f profiling phase \u53ef\u63d0\u5347 RPG2 \u4f18\u5316\u6fc0\u6d3b\u7387\uff0c\u4f46\u8fb9\u9645\u6536\u76ca\u9012\u51cf\u3002\u9ed8\u8ba4\u8bbe\u7f6e 2s \u662f\u517c\u987e\u6548\u7387\u4e0e\u6548\u679c\u7684\u5408\u7406\u6298\u8877\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-10-rpg2s-impact-on-ipc-over-time","title":"Figure 10. RPG2\u2019s impact on IPC over time.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RPG2 \u7cfb\u7edf\u5728\u4e24\u4e2a\u4e0d\u540c\u8f93\u5165\uff08higgs-retweet_network \u548c soc-sign-bitcoinalpha-edit\uff09\u4e0b\u5bf9 IPC\uff08Instructions Per Cycle\uff09\u968f\u65f6\u95f4\u53d8\u5316\u7684\u5f71\u54cd\uff0c\u7528\u4e8e\u8bc4\u4f30\u5176\u5728\u7ebf\u4f18\u5316\u884c\u4e3a\u3002</li> <li>\u5de6\u56fe\u5bf9\u5e94 higgs-retweet_network \u8f93\u5165\uff0c\u5728 Haswell \u673a\u5668\u4e0a\u8fd0\u884c\u3002\u521d\u59cb IPC \u7ea6\u4e3a 0.44\uff0c\u5728\u7ea6 6 \u79d2\u5904\u56e0 RPG2 \u8fdb\u5165\u4ee3\u7801\u6ce8\u5165\u4e0e\u8c03\u4f18\u9636\u6bb5\u800c\u77ed\u6682\u4e0b\u964d\uff0c\u968f\u540e\u7a33\u5b9a\u5728 0.55 \u4ee5\u4e0a\uff0c\u6700\u7ec8\u9009\u5b9a prefetch distance \u4e3a 62\uff0c\u5b9e\u73b0 \u8d85\u8fc7 25% \u7684 IPC \u63d0\u5347\u3002</li> <li>\u53f3\u56fe\u5bf9\u5e94 soc-sign-bitcoinalpha-edit \u8f93\u5165\uff0c\u5728 Cascade Lake \u673a\u5668\u4e0a\u8fd0\u884c\u3002\u521d\u59cb IPC \u7ea6\u4e3a 2.0\uff0c\u5728\u7ea6 3 \u79d2\u540e\u8fdb\u5165 prefetch active \u9636\u6bb5\uff08\u9634\u5f71\u533a\u57df\uff09\uff0c\u4f46 IPC \u4e0d\u5347\u53cd\u964d\uff0c\u8868\u660e prefetching \u6709\u5bb3\u6027\u80fd\uff1bRPG2 \u5728\u7ea6 8 \u79d2\u65f6\u68c0\u6d4b\u5230\u6b64\u60c5\u51b5\u5e76\u6267\u884c rollback\uff0c\u6062\u590d\u81f3\u539f\u59cb\u4ee3\u7801\uff0cIPC \u56de\u5347\u81f3 2.0 \u9644\u8fd1\u3002</li> <li>\u4e24\u5f20\u56fe\u5171\u540c\u8bf4\u660e RPG2 \u80fd\u52a8\u6001\u54cd\u5e94\u7a0b\u5e8f\u884c\u4e3a\uff1a\u5728\u6709\u76ca\u65f6\u63d0\u5347\u6027\u80fd\uff0c\u5728\u6709\u5bb3\u65f6\u5feb\u901f\u56de\u9000\uff0c\u907f\u514d\u6301\u7eed\u6027\u80fd\u635f\u5931\u3002</li> <li>\u5173\u952e\u64cd\u4f5c\u65f6\u95f4\u70b9\uff1a</li> <li>\u4ee3\u7801\u6ce8\u5165\u4e0e\u8c03\u4f18\u6682\u505c\uff1a\u53d1\u751f\u5728\u7b2c 6 \u79d2\uff08\u5de6\u56fe\uff09\u548c\u7b2c 3\u20138 \u79d2\uff08\u53f3\u56fe\uff09\uff0c\u671f\u95f4 IPC \u6ce2\u52a8\u3002</li> <li>Rollback \u89e6\u53d1\uff1a\u53f3\u56fe\u4e2d\u4e8e\u7b2c 8 \u79d2\u5b8c\u6210\uff0c\u6062\u590d\u539f\u59cb\u6027\u80fd\u3002</li> <li>RPG2 \u7684\u6838\u5fc3\u80fd\u529b\u4f53\u73b0\u5728\uff1a</li> <li>\u5b9e\u65f6\u76d1\u6d4b IPC \u53d8\u5316\u4f5c\u4e3a\u6027\u80fd\u6307\u6807\u3002</li> <li>\u81ea\u52a8\u51b3\u7b56\u662f\u5426\u542f\u7528\u6216\u7981\u7528 prefetch\uff0c\u65e0\u9700\u4eba\u5de5\u5e72\u9884\u3002</li> <li>\u652f\u6301 On-Stack Replacement (OSR)\uff0c\u786e\u4fdd\u5728\u51fd\u6570\u6267\u884c\u4e2d\u9014\u4e5f\u80fd\u5b89\u5168\u5207\u6362\u4ee3\u7801\u7248\u672c\u3002</li> </ul> \u65f6\u95f4\u70b9 (\u79d2) \u4e8b\u4ef6\u63cf\u8ff0 IPC \u53d8\u5316\u8d8b\u52bf 0\u20136 \u521d\u59cb\u6267\u884c + profiling \u7a33\u5b9a\u6216\u8f7b\u5fae\u6ce2\u52a8 6 \u4ee3\u7801\u6ce8\u5165\u4e0e\u8c03\u4f18\u5f00\u59cb \u77ed\u6682\u4e0b\u964d 6\u20139 \u8c03\u4f18\u5b8c\u6210\uff0c\u542f\u7528\u6700\u4f18 prefetch distance \u663e\u8457\u4e0a\u5347\uff08\u5de6\u56fe\uff09 3\u20138 prefetch active\uff08\u6709\u5bb3\u6848\u4f8b\uff09 \u4e0b\u964d \u2192 \u6301\u7eed\u4f4e\u8c37 8 Rollback \u81f3\u539f\u59cb\u4ee3\u7801 \u6062\u590d\u81f3\u521d\u59cb\u6c34\u5e73 <ul> <li>\u6b64\u56fe\u9a8c\u8bc1\u4e86 RPG2 \u7684\u201c\u9c81\u68d2\u6027\u201d\u8bbe\u8ba1\u76ee\u6807\uff1a\u4e0d\u4ec5\u8ffd\u6c42\u6027\u80fd\u63d0\u5347\uff0c\u66f4\u5173\u952e\u7684\u662f\u80fd\u8bc6\u522b\u5e76\u89c4\u907f\u6027\u80fd\u9677\u9631\uff0c\u786e\u4fdd\u7cfb\u7edf\u6574\u4f53\u7a33\u5b9a\u6027\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-11-the-relationship-between-speedup-and-llc-mpki-for-pr-on-cascade-lake","title":"Figure 11. The relationship between speedup and LLC MPKI for pr on Cascade Lake.","text":"<ul> <li>\u56fe\u8868\u5c55\u793a\u4e86\u5728 Cascade Lake \u5e73\u53f0\u4e0a\u8fd0\u884c pr \u57fa\u51c6\u6d4b\u8bd5\u65f6\uff0cspeedup \u4e0e LLC MPKI\uff08Last-Level Cache Misses Per Kilo-Instruction\uff09\u53d8\u5316\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</li> <li>\u6a2a\u8f74\u4e3a\u201cchange in LLC MPKI\u201d\uff0c\u8868\u793a\u76f8\u5bf9\u4e8e\u65e0 prefetch \u57fa\u7ebf\u7684 LLC \u7f3a\u5931\u7387\u53d8\u5316\uff0c\u8d1f\u503c\u4ee3\u8868\u51cf\u5c11\uff0c\u6b63\u503c\u4ee3\u8868\u589e\u52a0\uff1b\u7eb5\u8f74\u4e3a speedup\uff0c\u5373\u6027\u80fd\u52a0\u901f\u6bd4\u3002</li> <li>\u6570\u636e\u70b9\u5206\u5e03\u663e\u793a\uff1a\u5927\u90e8\u5206\u6570\u636e\u70b9\u96c6\u4e2d\u5728\u6a2a\u8f74\u8d1f\u534a\u8f74\uff0c\u8868\u660e RPG2 \u7684 prefetch \u673a\u5236\u666e\u904d\u964d\u4f4e\u4e86 LLC MPKI\uff0c\u5373\u51cf\u5c11\u4e86\u7f13\u5b58\u7f3a\u5931\u3002</li> <li>\u5c3d\u7ba1 LLC MPKI \u964d\u4f4e\uff0c\u4f46 speedup \u5e76\u672a\u5448\u73b0\u5f3a\u6b63\u76f8\u5173\u6027\u3002\u4f8b\u5982\uff1a</li> <li>\u5f53 LLC MPKI \u51cf\u5c11\u7ea6 -15 \u65f6\uff0cspeedup \u53ef\u8fbe 1.3\u20131.4\uff1b</li> <li>\u4f46\u5f53 LLC MPKI \u51cf\u5c11\u81f3 -5 \u5de6\u53f3\u65f6\uff0cspeedup \u4ecd\u53ef\u9ad8\u8fbe 1.3\uff1b</li> <li>\u540c\u65f6\uff0c\u90e8\u5206\u6570\u636e\u70b9\u5373\u4f7f LLC MPKI \u51e0\u4e4e\u65e0\u53d8\u5316\uff08\u63a5\u8fd1 0\uff09\uff0cspeedup \u4ecd\u7ef4\u6301\u5728 1.1\u20131.2 \u533a\u95f4\u3002</li> <li>\u5b58\u5728\u5c11\u91cf\u6570\u636e\u70b9\u4f4d\u4e8e\u6a2a\u8f74\u53f3\u4fa7\uff08LLC MPKI \u589e\u52a0\uff09\uff0c\u5176 speedup \u591a\u6570\u4f4e\u4e8e 1.0\uff0c\u8bf4\u660e prefetch \u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\u53cd\u800c\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002</li> <li>\u56fe\u4e2d\u5bc6\u96c6\u7c07\u72b6\u5206\u5e03\u4e8e\u6a2a\u8f74\u63a5\u8fd1 0\u3001\u7eb5\u8f74 1.0\u20131.2 \u533a\u57df\uff0c\u6697\u793a\u90e8\u5206\u8f93\u5165\u4e0b prefetch \u5bf9 LLC MPKI \u5f71\u54cd\u5fae\u5f31\uff0c\u4f46\u4ecd\u6709\u5c0f\u5e45\u6027\u80fd\u63d0\u5347\uff0c\u53ef\u80fd\u6e90\u4e8e\u5176\u4ed6\u5c42\u7ea7\u7f13\u5b58\u6216 DRAM \u5e26\u5bbd\u4f18\u5316\u3002</li> <li>\u8be5\u56fe\u9a8c\u8bc1\u4e86\u8bba\u6587\u7b2c 4.4 \u8282\u7ed3\u8bba\uff1aLLC MPKI \u4e0d\u662f\u8861\u91cf prefetch \u6548\u679c\u7684\u53ef\u9760\u6307\u6807\uff0c\u56e0\u4e3a\u6027\u80fd\u63d0\u5347\u4e0d\u4ec5\u4f9d\u8d56\u4e8e LLC \u7f3a\u5931\u51cf\u5c11\uff0c\u8fd8\u53d7\u5176\u4ed6\u5185\u5b58\u5c42\u7ea7\u884c\u4e3a\u548c\u5e26\u5bbd\u7ade\u4e89\u5f71\u54cd\u3002</li> </ul> \u6a2a\u8f74\u533a\u95f4 (change in LLC MPKI) \u7eb5\u8f74\u8868\u73b0 (speedup) \u6027\u80fd\u8d8b\u52bf -20 \u81f3 -15 1.3 \u2013 1.4 \u663e\u8457\u52a0\u901f -15 \u81f3 -5 1.1 \u2013 1.3 \u4e2d\u7b49\u52a0\u901f \u63a5\u8fd1 0 1.0 \u2013 1.2 \u5fae\u5e45\u52a0\u901f\u6216\u6301\u5e73 &gt; 0 &lt; 1.0 \u6027\u80fd\u9000\u5316 <ul> <li>\u7efc\u4e0a\uff0c\u8be5\u56fe\u63ed\u793a\u4e86 prefetch \u4f18\u5316\u6548\u679c\u7684\u590d\u6742\u6027\uff1a\u4ec5\u9760\u964d\u4f4e LLC MPKI \u65e0\u6cd5\u51c6\u786e\u9884\u6d4b\u6027\u80fd\u6536\u76ca\uff0cRPG2 \u7684\u5728\u7ebf\u8c03\u4f18\u673a\u5236\u6b63\u662f\u4e3a\u4e86\u5e94\u5bf9\u8fd9\u79cd\u975e\u7ebf\u6027\u3001\u591a\u56e0\u7d20\u8026\u5408\u7684\u6027\u80fd\u54cd\u5e94\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#730aba1441c65a0b28581ce05a8fe5cdd1337d9e8945548c95855ca07331eae4jpg","title":"730aba1441c65a0b28581ce05a8fe5cdd1337d9e8945548c95855ca07331eae4.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a Table 2\uff0c\u6807\u9898\u4e3a\u201cAverage latency of RPG2 operations\u201d\uff0c\u5c55\u793a\u4e86 RPG2 \u7cfb\u7edf\u5728\u4e0d\u540c\u57fa\u51c6\u6d4b\u8bd5\uff08benchmark\uff09\u4e2d\u5173\u952e\u64cd\u4f5c\u7684\u5e73\u5747\u5ef6\u8fdf\u6570\u636e\u3002</li> <li>\u8868\u683c\u5305\u542b\u516d\u884c\u548c\u516b\u5217\uff0c\u5176\u4e2d\u7b2c\u4e00\u5217\u4e3a\u64cd\u4f5c\u7c7b\u578b\uff0c\u5176\u4f59\u4e03\u5217\u4e3a\u4e0d\u540c\u57fa\u51c6\u6d4b\u8bd5\uff1apr\u3001sssp\u3001bfs\u3001bc\u3001is\u3001randacc\u3001cg\u3002</li> <li>\u6240\u6709\u6570\u636e\u5355\u4f4d\u5747\u4e3a\u6beb\u79d2\uff08ms\uff09\uff0c\u9664\u7b2c\u4e00\u884c\u201cRPG\u00b2 exec (s)\u201d\u5355\u4f4d\u4e3a\u79d2\uff08s\uff09\uff0c\u8868\u793a RPG2 \u6574\u4f53\u6267\u884c\u65f6\u95f4\u3002</li> <li>\u6570\u636e\u663e\u793a\uff0cBOLT \u751f\u6210\u4e8c\u8fdb\u5236\u6587\u4ef6\u8017\u65f6\u6700\u957f\uff0c\u5e73\u5747\u5728 26.4ms \u81f3 32.0ms \u4e4b\u95f4\uff0c\u5176\u4e2d randacc \u6700\u9ad8\uff0832.0ms\uff09\uff0ccg \u6700\u4f4e\uff0826.4ms\uff09\u3002</li> <li>\u4ee3\u7801\u63d2\u5165\uff08code insert\uff09 \u8017\u65f6\u7a33\u5b9a\uff0c\u5404\u57fa\u51c6\u6d4b\u8bd5\u5747\u5728 2.9ms \u81f3 3.9ms \u4e4b\u95f4\uff0ccg \u6700\u5feb\uff082.9ms\uff09\uff0cpr \u6700\u6162\uff083.9ms\uff09\u3002</li> <li>\u5355\u6b21 prefetch distance \u7f16\u8f91\uff081x pd edit\uff09 \u8017\u65f6\u6781\u77ed\uff0c\u6240\u6709\u57fa\u51c6\u6d4b\u8bd5\u5747\u5728 1.1ms \u81f3 1.4ms \u4e4b\u95f4\uff0crandacc \u548c is \u6700\u5feb\uff081.1ms\uff09\uff0cbfs \u6700\u6162\uff081.4ms\uff09\u3002</li> <li>prefetch distance \u7f16\u8f91\u6b21\u6570\uff08# pd edits\uff09 \u5e73\u5747\u5728 8.8 \u81f3 12.7 \u6b21\u4e4b\u95f4\uff0cbc \u6700\u9ad8\uff0812.7\uff09\uff0crandacc \u6700\u4f4e\uff088.8\uff09\u3002</li> <li>RPG2 \u6574\u4f53\u6267\u884c\u65f6\u95f4\uff08RPG\u00b2 exec\uff09\u4ece 7.6 \u79d2\uff08pr\uff09\u5230 8.8 \u79d2\uff08cg\uff09\u4e0d\u7b49\uff0c\u8868\u660e\u7cfb\u7edf\u5728\u540e\u53f0\u8fd0\u884c\u65f6\u5bf9\u4e3b\u7a0b\u5e8f\u5f71\u54cd\u8f83\u5c0f\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0cRPG2 \u7684\u505c\u673a\u64cd\u4f5c\uff08stop-the-world\uff09\u5ef6\u8fdf\u6781\u4f4e\uff0c\u5982\u4ee3\u7801\u63d2\u5165\u548c\u5355\u6b21\u7f16\u8f91\u5747\u5728\u6beb\u79d2\u7ea7\uff0c\u786e\u4fdd\u4e86\u5728\u7ebf\u4f18\u5316\u7684\u5b9e\u65f6\u6027\u3002</li> <li>\u8868\u683c\u6570\u636e\u652f\u6301\u8bba\u6587\u7b2c 4.3.1 \u8282\u7ed3\u8bba\uff1aRPG2 \u7684\u5173\u952e\u64cd\u4f5c\u5ef6\u8fdf\u4f4e\uff0c\u5bf9\u6027\u80fd\u5e72\u6270\u5c0f\uff0c\u7b26\u5408\u5176\u201c\u8f7b\u91cf\u7ea7\u5728\u7ebf\u4f18\u5316\u201d\u8bbe\u8ba1\u76ee\u6807\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-12-rpg2s-impact-on-dynamic-instruction-count-for-pr-on-cascade-lake","title":"Figure 12. RPG2\u2019s impact on dynamic instruction count for pr on Cascade Lake.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 RPG2 \u7cfb\u7edf\u5728 Cascade Lake \u5e73\u53f0\u4e0a\u5bf9 pr \u57fa\u51c6\u6d4b\u8bd5\u7684 \u52a8\u6001\u6307\u4ee4\u8ba1\u6570\uff08dynamic instruction count\uff09\u5f71\u54cd\uff0c\u6570\u636e\u5df2\u5f52\u4e00\u5316\u81f3\u539f\u59cb\u65e0\u9884\u53d6\u7248\u672c\u3002</li> <li>\u6a2a\u8f74\u8868\u793a\u5f52\u4e00\u5316\u540e\u7684\u6307\u4ee4\u8ba1\u6570\u6bd4\u4f8b\uff0c\u4ece 1.00\uff08\u65e0\u989d\u5916\u5f00\u9500\uff09\u5230 1.35\uff08\u589e\u52a0 35%\uff09\uff0c\u7eb5\u8f74\u4e3a\u5bf9\u5e94\u6bd4\u4f8b\u51fa\u73b0\u7684\u9891\u7387\u3002</li> <li>\u6570\u636e\u5206\u5e03\u663e\u793a\uff1a\u7ea6\u4e00\u534a\u8f93\u5165\u7684\u6307\u4ee4\u8ba1\u6570\u589e\u5e45\u4f4e\u4e8e 15%\uff0c\u96c6\u4e2d\u5728 1.00\u20131.15 \u533a\u95f4\uff1b\u6700\u5dee\u60c5\u51b5\u589e\u5e45\u8fbe 37%\uff0c\u51fa\u73b0\u5728 1.35 \u533a\u95f4\u3002</li> <li>\u9ad8\u9891\u5cf0\u503c\u4f4d\u4e8e 1.15 \u548c 1.20\uff0c\u8868\u660e\u591a\u6570\u8f93\u5165\u56e0 prefetch kernel \u7684\u63d2\u5165\u5bfc\u81f4\u6307\u4ee4\u6570\u9002\u5ea6\u589e\u957f\uff0c\u4f46\u6574\u4f53\u4ecd\u88ab\u6027\u80fd\u589e\u76ca\u6240\u62b5\u6d88\u3002</li> <li>\u8be5\u56fe\u9a8c\u8bc1\u4e86 RPG2 \u7684\u5f00\u9500\u53ef\u63a7\u6027\uff1a\u5c3d\u7ba1\u5f15\u5165\u4e86\u989d\u5916\u8ba1\u7b97\u903b\u8f91\uff08\u5982\u5730\u5740\u8ba1\u7b97\u3001\u8fb9\u754c\u68c0\u67e5\uff09\uff0c\u5176\u5e26\u6765\u7684\u6307\u4ee4\u81a8\u80c0\u5e76\u672a\u663e\u8457\u62d6\u7d2f\u6574\u4f53\u6027\u80fd\u3002</li> </ul> \u5f52\u4e00\u5316\u6307\u4ee4\u8ba1\u6570 \u9891\u7387\uff08\u8fd1\u4f3c\uff09 \u6027\u80fd\u5f71\u54cd\u8bf4\u660e 1.00 12 \u65e0\u989d\u5916\u5f00\u9500\uff0c\u6781\u5c11\u6570\u60c5\u51b5 1.05 1 \u51e0\u4e4e\u65e0\u5f71\u54cd 1.10\u20131.15 6\u201312 \u4e2d\u7b49\u5f00\u9500\uff0c\u5e38\u89c1\u8303\u56f4 1.20 5 \u8f83\u9ad8\u5f00\u9500\uff0c\u4f46\u4ecd\u53ef\u63a5\u53d7 1.25\u20131.35 1\u20132 \u6700\u9ad8\u5f00\u9500\uff0c\u4ec5\u5c11\u6570\u8f93\u5165 <ul> <li>\u7ed3\u8bba\uff1aRPG2 \u7684 prefetch kernel \u5f15\u5165\u7684\u6307\u4ee4\u5f00\u9500\u662f\u8f93\u5165\u4f9d\u8d56\u578b\u7684\uff0c\u53d6\u51b3\u4e8e\u6570\u636e\u7ed3\u6784\u5927\u5c0f\u4e0e\u9884\u53d6\u8ddd\u79bb\uff0c\u4f46\u7cfb\u7edf\u8bbe\u8ba1\u786e\u4fdd\u4e86\u5373\u4f7f\u5728\u6700\u574f\u60c5\u51b5\u4e0b\uff0c\u6027\u80fd\u6536\u76ca\u4ecd\u80fd\u8986\u76d6\u6b64\u5f00\u9500\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#30d16b2b71fbc63c4f826cad21b9ce416d506db55f96a7c7a9e9ac5e0706ce34jpg","title":"30d16b2b71fbc63c4f826cad21b9ce416d506db55f96a7c7a9e9ac5e0706ce34.jpg","text":"<ul> <li>\u8be5\u56fe\u7247\u5c55\u793a\u7684\u662f Table 3\uff0c\u6807\u9898\u4e3a\u201cThe influence of prefetch distance on performance\u201d\uff0c\u7528\u4e8e\u91cf\u5316\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u548c\u5fae\u67b6\u6784\u4e0b\uff0c\u9884\u53d6\u8ddd\u79bb\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u6a21\u5f0f\u3002</li> <li>\u8868\u683c\u6309 benchmark\uff08pr, sssp, bfs, bc\uff09\u548c microarchitecture\uff08Cascade Lake, Haswell\uff09\u5206\u7c7b\uff0c\u7edf\u8ba1\u4e86\u6bcf\u79cd\u7ec4\u5408\u4e0b\u4e0d\u540c\u6027\u80fd\u884c\u4e3a\u7c7b\u578b\u7684\u8f93\u5165\u6570\u91cf\u3002</li> <li>\u6027\u80fd\u884c\u4e3a\u7c7b\u578b\u5171\u516b\u7c7b\uff0c\u5305\u62ec\uff1a</li> <li>single optimal\uff1a\u5b58\u5728\u552f\u4e00\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u3002</li> <li>range optimal\uff1a\u5b58\u5728\u4e00\u4e2a\u8fde\u7eed\u7684\u6700\u4f18\u8ddd\u79bb\u533a\u95f4\u3002</li> <li>asymptotic\uff1a\u6027\u80fd\u968f\u8ddd\u79bb\u589e\u52a0\u8d8b\u4e8e\u9971\u548c\u3002</li> <li>both bad\uff1a\u5728\u4e24\u79cd\u5fae\u67b6\u6784\u4e0a\u9884\u53d6\u5747\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002</li> <li>Haswell bad\uff1a\u4ec5\u5728 Haswell \u4e0a\u6709\u5bb3\u3002</li> <li>Cascade bad\uff1a\u4ec5\u5728 Cascade Lake \u4e0a\u6709\u5bb3\u3002</li> <li>noisy\uff1a\u884c\u4e3a\u8fc7\u4e8e\u968f\u673a\uff0c\u65e0\u6cd5\u6e05\u6670\u5f52\u7c7b\u3002</li> <li>other\uff1a\u5176\u4f59\u672a\u5f52\u5165\u4e0a\u8ff0\u7c7b\u522b\u7684\u884c\u4e3a\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u8868\u683c\u6570\u636e\u6574\u7406\uff1a</p> \u7c7b\u578b Cascade Lake (pr) Cascade Lake (sssp) Cascade Lake (bfs) Cascade Lake (bc) Haswell (pr) Haswell (sssp) Haswell (bfs) Haswell (bc) single optimal 26 25 1 2 18 23 0 1 range optimal 2 7 1 3 7 9 0 0 asymptotic 15 13 2 2 18 14 1 6 both bad 11 10 52 0 11 10 52 0 Haswell bad - - - - 1 1 5 0 Cascade bad 2 2 5 0 - - - - noisy 4 3 1 0 7 2 4 1 other 2 2 0 2 0 3 0 1 <ul> <li>\u6570\u636e\u8868\u660e\uff0cbfs \u5728\u4e24\u79cd\u5fae\u67b6\u6784\u4e0a\u7edd\u5927\u591a\u6570\u8f93\u5165\u90fd\u5c5e\u4e8e both bad \u7c7b\u578b\uff0c\u8bf4\u660e\u5176\u9884\u53d6\u6781\u6613\u5bfc\u81f4\u6027\u80fd\u9000\u5316\u3002</li> <li>pr \u548c sssp \u7684\u8f93\u5165\u4e2d\uff0csingle optimal \u548c asymptotic \u5360\u6bd4\u8f83\u9ad8\uff0c\u610f\u5473\u7740\u5728\u8fd9\u4e24\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u901a\u8fc7\u641c\u7d22\u6216\u56fa\u5b9a\u8ddd\u79bb\u4ecd\u53ef\u80fd\u83b7\u5f97\u8f83\u597d\u6536\u76ca\u3002</li> <li>bc \u57fa\u51c6\u6d4b\u8bd5\u6837\u672c\u8f83\u5c11\uff0c\u4f46\u663e\u793a\u5728 Haswell \u4e0a\u66f4\u503e\u5411\u4e8e asymptotic \u884c\u4e3a\u3002</li> <li>Haswell bad \u548c Cascade bad \u7c7b\u578b\u7684\u5b58\u5728\uff0c\u51f8\u663e\u4e86\u9884\u53d6\u6548\u679c\u5bf9 \u5fae\u67b6\u6784\u9ad8\u5ea6\u654f\u611f\uff0c\u540c\u4e00\u8f93\u5165\u5728\u4e0d\u540c\u673a\u5668\u4e0a\u8868\u73b0\u53ef\u80fd\u622a\u7136\u76f8\u53cd\u3002</li> <li>noisy \u7c7b\u578b\u5728 Haswell \u4e0a\u51fa\u73b0\u9891\u7387\u66f4\u9ad8\uff0c\u6697\u793a\u5176\u6027\u80fd\u54cd\u5e94\u66f4\u4e0d\u7a33\u5b9a\uff0c\u589e\u52a0\u4e86\u81ea\u52a8\u8c03\u4f18\u96be\u5ea6\u3002</li> <li>\u8be5\u8868\u652f\u6301\u8bba\u6587\u6838\u5fc3\u8bba\u70b9\uff1a\u9884\u53d6\u4f18\u5316\u4e0d\u80fd\u4f9d\u8d56\u9759\u6001\u7f16\u8bd1\uff0c\u5fc5\u987b\u5177\u5907 \u52a8\u6001\u9002\u5e94\u80fd\u529b\uff0c\u5982 RPG2 \u6240\u63d0\u4f9b\u7684\u8fd0\u884c\u65f6\u8c03\u6574\u4e0e\u56de\u6eda\u673a\u5236\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/figs_notes/#figure-13-the-relationship-between-multiple-loads-prefetch-distances-and-performance-for-sssp-running-the-p2pgnutella05-input-on-cascade-lake","title":"Figure 13. The relationship between multiple loads\u2019 prefetch distances and performance for sssp running the p2pGnutella05 input on Cascade Lake.","text":"<ul> <li>\u8be5\u56fe\u5c55\u793a\u4e86\u5728 Cascade Lake \u5fae\u67b6\u6784\u4e0a\u8fd0\u884c sssp \u57fa\u51c6\u6d4b\u8bd5\uff08\u8f93\u5165\u4e3a p2pGnutella05\uff09\u65f6\uff0c\u4e24\u4e2a\u72ec\u7acb\u8d1f\u8f7d\uff08load0 \u548c load1\uff09\u7684 prefetch distance \u5bf9\u6027\u80fd\uff08\u4ee5 speedup \u8861\u91cf\uff09\u7684\u5f71\u54cd\u3002</li> <li>\u56fe\u4e2d\u4e09\u7ef4\u66f2\u9762\u8868\u793a\u4e0d\u540c load0 prefetch distance\uff08x\u8f74\uff09\u4e0e load1 prefetch distance\uff08y\u8f74\uff09\u7ec4\u5408\u4e0b\u6240\u83b7\u5f97\u7684 speedup\uff08z\u8f74\uff09\uff0c\u989c\u8272\u4ece\u84dd\u5230\u9ec4\u7eff\u6e10\u53d8\u4ee3\u8868\u6027\u80fd\u7531\u4f4e\u5230\u9ad8\u3002</li> <li>load0 prefetch distance \u7684\u5f71\u54cd\u66f4\u4e3a\u663e\u8457\uff1a\u5f53\u5176\u503c\u8f83\u5c0f\u65f6\uff08\u598220-40\uff09\uff0c\u65e0\u8bba load1 prefetch distance \u5982\u4f55\u53d8\u5316\uff0c\u6574\u4f53 speedup \u90fd\u8f83\u9ad8\uff1b\u968f\u7740 load0 prefetch distance \u589e\u5927\uff0cspeedup \u660e\u663e\u4e0b\u964d\uff0c\u8868\u660e load0 \u662f\u6027\u80fd\u74f6\u9888\u7684\u5173\u952e\u70b9\u3002</li> <li>load1 prefetch distance \u7684\u5f71\u54cd\u76f8\u5bf9\u6b21\u8981\uff1a\u5728 load0 prefetch distance \u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u8c03\u6574 load1 prefetch distance \u53ea\u80fd\u5e26\u6765\u5c0f\u5e45\u6027\u80fd\u6ce2\u52a8\uff08\u7ea6 \u00b12%\uff09\uff0c\u8bf4\u660e\u5176\u4f18\u5316\u7a7a\u95f4\u6709\u9650\u3002</li> <li>\u5b58\u5728\u591a\u4e2a\u5c40\u90e8\u6700\u4f18\u89e3\uff1a\u66f2\u9762\u5e76\u975e\u5e73\u6ed1\u5355\u8c03\uff0c\u800c\u662f\u5448\u73b0\u591a\u4e2a\u5cf0\u8c37\uff0c\u610f\u5473\u7740\u67d0\u4e9b\u7279\u5b9a\u8ddd\u79bb\u7ec4\u5408\uff08\u5982 load0=30, load1=60\uff09\u53ef\u80fd\u6bd4\u201c\u5bf9\u79f0\u201d\u914d\u7f6e\uff08\u4e24\u8005\u8ddd\u79bb\u76f8\u7b49\uff09\u66f4\u4f18\u3002</li> <li>RPG2 \u5f53\u524d\u91c7\u7528\u201c\u5bf9\u79f0\u201d\u7b56\u7565\uff08\u5373\u6240\u6709 prefetch location \u4f7f\u7528\u76f8\u540c\u8ddd\u79bb\uff09\uff0c\u5728\u6b64\u573a\u666f\u4e0b\u53ef\u80fd\u65e0\u6cd5\u8fbe\u5230\u7406\u8bba\u6700\u4f18\u6027\u80fd\uff0c\u51f8\u663e\u4e86\u672a\u6765\u652f\u6301 asymmetric prefetch distances \u7684\u5fc5\u8981\u6027\u3002</li> <li>\u6027\u80fd\u654f\u611f\u5ea6\u9ad8\uff1a\u5373\u4f7f\u5fae\u5c0f\u7684\u8ddd\u79bb\u8c03\u6574\u4e5f\u53ef\u80fd\u5bfc\u81f4 speedup \u4ece 1.24 \u964d\u81f3 1.12\uff0c\u8bf4\u660e prefetch distance tuning \u5fc5\u987b\u7cbe\u786e\uff0c\u4e14\u9700\u52a8\u6001\u9002\u5e94\u8fd0\u884c\u65f6\u73af\u5883\u3002</li> </ul> \u7ef4\u5ea6 \u8303\u56f4 \u6027\u80fd\u8d8b\u52bf load0 prefetch distance 20\u2013100 \u663e\u8457\u8d1f\u76f8\u5173\uff1a\u8ddd\u79bb\u8d8a\u5c0f\uff0cspeedup\u8d8a\u9ad8\uff1b\u8ddd\u79bb\u589e\u5927\uff0c\u6027\u80fd\u6025\u5267\u4e0b\u964d load1 prefetch distance 20\u2013100 \u5f31\u76f8\u5173\uff1a\u5728\u56fa\u5b9a load0 \u8ddd\u79bb\u4e0b\uff0c\u4ec5\u5f15\u8d77\u5c0f\u5e45\u6ce2\u52a8\uff08\u00b12%\uff09 speedup 1.12\u20131.24 \u6700\u9ad8\u53ef\u8fbe 1.24\u00d7\uff0c\u6700\u4f4e\u8dcc\u81f3 1.12\u00d7\uff0c\u5dee\u8ddd\u8fbe 10.7% <ul> <li>\u8be5\u56fe\u9a8c\u8bc1\u4e86\u8bba\u6587\u7b2c 4.5 \u8282\u89c2\u70b9\uff1a\u591a\u8d1f\u8f7d\u573a\u666f\u4e0b\uff0cprefetch distance search space \u5448\u73b0\u975e\u7ebf\u6027\u3001\u975e\u5bf9\u79f0\u7279\u6027\uff0c\u9759\u6001\u6216\u7edf\u4e00\u8ddd\u79bb\u7b56\u7565\u96be\u4ee5\u903c\u8fd1\u6700\u4f18\u89e3\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/","title":"RPG2: Robust Profile-Guided Runtime Prefetch Generation \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Yuxuan Zhang - Nathan Sobotka - Soyoon Park - Saba Jamilan - Tanvir Ahmed Khan - Baris Kasikci - Gilles A Pokam - Heiner Litz - Joseph Devietti</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - 29th ACM International Conference on Architectural Support for Programming Languages and Operating Systems, Volume 1 (ASPLOS \u201924)</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - 2024</p>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u4f20\u7edf\u8f6f\u4ef6\u6570\u636e\u9884\u53d6\uff08prefetching\uff09\u6280\u672f\u5728\u9762\u5bf9\u4e0d\u540c\u7a0b\u5e8f\u8f93\u5165\u548c\u5904\u7406\u5668\u5fae\u67b6\u6784\u65f6\u8868\u73b0\u4e0d\u7a33\u5b9a\u7684\u95ee\u9898\u3002\u9759\u6001\u7f16\u8bd1\u5668\u63d2\u5165\u7684\u9884\u53d6\u6307\u4ee4\u65e0\u6cd5\u9002\u5e94\u8fd0\u884c\u65f6\u53d8\u5316\uff0c\u53ef\u80fd\u5bfc\u81f4\u6027\u80fd\u63d0\u5347\uff0c\u4e5f\u53ef\u80fd\u56e0\u7f13\u5b58\u6c61\u67d3\u6216\u5e26\u5bbd\u7ade\u4e89\u800c\u9020\u6210\u663e\u8457\u6027\u80fd\u4e0b\u964d\u3002 - \u8bbe\u8ba1\u4e00\u4e2a\u7eaf\u8f6f\u4ef6\u3001\u5728\u7ebf\u7684\u7cfb\u7edf\uff0c\u80fd\u591f\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u52a8\u6001\u5730\u6ce8\u5165\u3001\u8c03\u4f18\u751a\u81f3\u56de\u6eda\u9884\u53d6\u6307\u4ee4\uff0c\u4ee5\u5b9e\u73b0\u9c81\u68d2\u7684\uff08Robust\uff09\u6027\u80fd\u6536\u76ca\uff0c\u5373\u5728\u80fd\u63d0\u5347\u6027\u80fd\u65f6\u6700\u5927\u5316\u6536\u76ca\uff0c\u5728\u6709\u5bb3\u65f6\u80fd\u5b89\u5168\u56de\u9000\u5230\u539f\u59cb\u6027\u80fd\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa RPG2 (Robust Profile-Guided Runtime Prefetch Generation) \u7cfb\u7edf\uff0c\u5176\u5de5\u4f5c\u6d41\u7a0b\u5206\u4e3a\u56db\u4e2a\u9636\u6bb5\uff1a   - Phase 1: Profiling\uff1a\u5229\u7528 Linux <code>perf</code> \u5de5\u5177\u548c Intel PEBS (Precise Event-Based Sampling) \u786c\u4ef6\u7279\u6027\uff0c\u5bf9\u8fd0\u884c\u4e2d\u7684\u8fdb\u7a0b\u8fdb\u884c\u91c7\u6837\uff0c\u8bc6\u522b\u5bfc\u81f4LLC (Last-Level Cache) \u7684\u70ed\u70b9\u6307\u4ee4\u3002   - Phase 2: Code Analysis &amp; Generation\uff1a\u57fa\u4e8e BOLT (Binary Optimization and Layout Tool) \u6846\u67b6\uff0c\u5bf9\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u5206\u6790\u3002\u901a\u8fc7\u540e\u5411\u5207\u7247\uff08Backwards Slicing\uff09\u6280\u672f\uff0c\u8bc6\u522b\u5e76\u652f\u6301\u4e09\u7c7b\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff08\u7279\u522b\u662f\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee <code>a[b[i]]</code>\uff09\uff0c\u5e76\u751f\u6210\u4e00\u4e2a\u903b\u8f91\u4e0a\u4e3a NOP \u7684\u9884\u53d6\u5185\u6838\uff08prefetch kernel\uff09\u3002   - Phase 3: Runtime Code Insertion\uff1a\u5c06\u5305\u542b\u9884\u53d6\u5185\u6838\u7684\u65b0\u51fd\u6570\u7248\u672c\u6ce8\u5165\u5230\u76ee\u6807\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\u3002\u4e3a\u89e3\u51b3\u6b63\u5728\u6267\u884c\u7684\u51fd\u6570\u8c03\u7528\u95ee\u9898\uff0cRPG2 \u5b9e\u73b0\u4e86\u9488\u5bf9 C/C++ \u7b49\u975e\u6258\u7ba1\u8bed\u8a00\u7684\u6808\u4e0a\u66ff\u6362\uff08On-Stack Replacement, OSR\uff09\uff0c\u5229\u7528 BOLT \u751f\u6210\u7684 BATT (BOLT Address Translation Table) \u6765\u5b89\u5168\u5730\u91cd\u5b9a\u5411\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\u3002   - Phase 4: Monitoring And Tuning\uff1a\u901a\u8fc7\u6d4b\u91cf IPC (Instructions Per Cycle) \u4f5c\u4e3a\u6027\u80fd\u6307\u6807\uff0c\u5bf9\u9884\u53d6\u8ddd\u79bb\uff08prefetch distance\uff09\u8fdb\u884c\u6709\u754c\u641c\u7d22\uff08\u5148\u786e\u5b9a\u65b9\u5411\uff0c\u518d\u7c97\u7c92\u5ea6\u8df3\u8dc3\uff0c\u6700\u540e\u4e8c\u5206\u67e5\u627e\uff09\u3002\u5982\u679c\u6240\u6709\u8ddd\u79bb\u90fd\u65e0\u6cd5\u5e26\u6765\u6027\u80fd\u63d0\u5347\uff0c\u5219\u56de\u6eda\uff08Rolling Back\uff09\u5230\u539f\u59cb\u4ee3\u7801\u3002</p> <p></p> <p>Figure 4. RPG2 proceeds through four phases when optimizing a target process.</p> <p>\u7ed3\u679c - RPG2 \u5728\u591a\u79cd\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 CRONO \u5957\u4ef6\u4e2d\u7684 <code>sssp</code>, <code>bfs</code>, <code>pr</code>\uff09\u548c\u4e0d\u540c\u8f93\u5165\u96c6\uff08SNAP \u6570\u636e\u96c6\uff09\u4e0a\u8fdb\u884c\u4e86\u8bc4\u4f30\uff0c\u5c55\u793a\u4e86\u5176\u6709\u6548\u6027\u4e0e\u9c81\u68d2\u6027\u3002 - \u6027\u80fd\u63d0\u5347\uff1a\u5728\u9884\u53d6\u6709\u76ca\u7684\u573a\u666f\u4e0b\uff0cRPG2 \u80fd\u591f\u83b7\u5f97\u6700\u9ad8 2.15\u00d7 \u7684\u52a0\u901f\u6bd4\uff0c\u6027\u80fd\u4e0e\u6700\u5148\u8fdb\u7684\u9759\u6001\u9884\u53d6\u7f16\u8bd1\u5668\uff08\u5982 APT-GET\uff09\u76f8\u5f53\u3002 - \u907f\u514d\u6027\u80fd\u4e0b\u964d\uff1a\u5728\u9884\u53d6\u6709\u5bb3\u7684\u573a\u666f\u4e0b\uff08\u5982 <code>bfs</code> \u57fa\u51c6\u6d4b\u8bd5\u4e2d\u7684\u8bb8\u591a\u8f93\u5165\uff09\uff0cRPG2 \u80fd\u6210\u529f\u68c0\u6d4b\u5e76\u56de\u6eda\uff0c\u4ece\u800c\u907f\u514d\u4e86\u9ad8\u8fbe 50-70% \u7684\u6027\u80fd\u635f\u5931\uff0c\u663e\u8457\u4f18\u4e8e\u9759\u6001\u65b9\u6848\u3002 - \u64cd\u4f5c\u5f00\u9500\u4f4e\uff1a\u5173\u952e\u7684\u505c\u987f\u4e16\u754c\uff08stop-the-world\uff09\u64cd\u4f5c\uff08\u5982\u4ee3\u7801\u6ce8\u5165\u3001\u8ddd\u79bb\u8c03\u6574\uff09\u5e73\u5747\u4ec5\u9700 1-4 \u6beb\u79d2\uff0c\u5bf9\u6574\u4f53\u6027\u80fd\u5f71\u54cd\u5f88\u5c0f\u3002</p> Benchmark/Input RPG2 (All) RPG2 (Speedup) RPG2 (Slowdown) APT-GET / Offline pr (Cascade Lake) ~1.1x ~1.3x ~1.0x ~1.3x / ~0.9x bfs (Cascade Lake) ~0.9x ~1.1x ~0.8x N/A / ~0.5x <p></p> <p>Figure 7. RPG2 and baseline performance on Cascade Lake (top) and Haswell (bottom).</p> <ul> <li>\u9884\u53d6\u8ddd\u79bb\u8c03\u4f18\u51c6\u786e\u6027\uff1a\u5bf9\u4e8e\u5177\u6709\u5355\u4e00\u6700\u4f18\u8ddd\u79bb\u7684\u8f93\u5165\uff0cRPG2 \u7684\u641c\u7d22\u7ed3\u679c\u5728 10 \u4ee5\u5185\u7684\u6bd4\u4f8b\u8d85\u8fc7\u4e00\u534a\u3002</li> <li>\u8f93\u5165\u4e0e\u67b6\u6784\u654f\u611f\u6027\uff1a\u5b9e\u9a8c\u9a8c\u8bc1\u4e86\u9884\u53d6\u6548\u679c\u5bf9\u8f93\u5165\u548c\u5fae\u67b6\u6784\u7684\u9ad8\u5ea6\u654f\u611f\u6027\uff0c\u4f8b\u5982 <code>sssp</code> \u5728\u4e0d\u540c\u8f93\u5165\u4e0b\u7684\u6700\u4f18\u8ddd\u79bb\u5dee\u5f02\u5de8\u5927\uff0c<code>pr</code> \u5728 Cascade Lake \u548c Haswell \u4e0a\u7684\u8868\u73b0\u751a\u81f3\u53ef\u80fd\u5b8c\u5168\u76f8\u53cd\u3002</li> </ul> <p></p> <p>Figure 1. The sssp benchmark from CRONO [2] has very different optimal prefetch distances (shaded regions) with different inputs.</p> <p></p> <p>Figure 2. The pr benchmark from CRONO [2] sees a speedup or a slowdown with prefetching, depending on the microarchitecture.</p> <p>\u7ed3\u8bba - \u9759\u6001\u8f6f\u4ef6\u9884\u53d6\u662f\u4e00\u79cd\u201c\u53cc\u5203\u5251\u201d\uff0c\u5176\u6548\u679c\u6781\u6613\u53d7\u5230\u7a0b\u5e8f\u8f93\u5165\u548c\u5904\u7406\u5668\u5fae\u67b6\u6784\u7684\u5f71\u54cd\uff0c\u96be\u4ee5\u5728\u901a\u7528\u573a\u666f\u4e0b\u4fdd\u8bc1\u9c81\u68d2\u6027\u3002 - RPG2 \u901a\u8fc7\u5728\u7ebf\u3001\u52a8\u6001\u7684\u65b9\u5f0f\u89e3\u51b3\u4e86\u8fd9\u4e00\u6838\u5fc3\u6311\u6218\u3002\u5b83\u4e0d\u4ec5\u80fd\u50cf\u9759\u6001\u7f16\u8bd1\u5668\u4e00\u6837\u5728\u6709\u5229\u573a\u666f\u4e0b\u63d0\u4f9b\u663e\u8457\u7684\u6027\u80fd\u52a0\u901f\uff0c\u66f4\u91cd\u8981\u7684\u662f\uff0c\u5b83\u5177\u5907\u81ea\u6211\u4fdd\u62a4\u673a\u5236\uff0c\u80fd\u5728\u9884\u53d6\u6709\u5bb3\u65f6\u81ea\u52a8\u56de\u6eda\uff0c\u4ece\u800c\u4fdd\u7559\u4e86\u539f\u59cb\u6027\u80fd\u3002 - RPG2 \u8bc1\u660e\u4e86\u5728\u8fd0\u884c\u65f6\u8fdb\u884c\u52a8\u6001\u4e8c\u8fdb\u5236\u4f18\u5316\u548c\u8c03\u4f18\u662f\u5e94\u5bf9\u590d\u6742\u3001\u591a\u53d8\u786c\u4ef6\u73af\u5883\u7684\u6709\u6548\u9014\u5f84\uff0c\u4e3a\u6784\u5efa\u66f4\u667a\u80fd\u3001\u66f4\u5b89\u5168\u7684\u6027\u80fd\u4f18\u5316\u6846\u67b6\u63d0\u4f9b\u4e86\u65b0\u7684\u601d\u8def\u3002</p>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f\u4e0e\u52a8\u673a</p> <ul> <li>\u6570\u636e\u7f13\u5b58\u9884\u53d6 (Data cache prefetching) \u662f\u4e00\u79cd\u5173\u952e\u7684\u6027\u80fd\u4f18\u5316\u6280\u672f\uff0c\u65e8\u5728\u901a\u8fc7\u63d0\u524d\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u7f13\u5b58\u4e2d\u6765\u63a9\u76d6\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\u3002</li> <li>\u7136\u800c\uff0c\u6709\u6548\u7684\u9884\u53d6\u9762\u4e34\u5de8\u5927\u6311\u6218\uff1a\u9884\u53d6\u8fc7\u65e9\u4f1a\u6c61\u67d3\u7f13\u5b58 (pollute the cache)\uff0c\u9884\u53d6\u8fc7\u665a\u4f1a\u65e0\u6cd5\u907f\u514d\u7f13\u5b58\u7f3a\u5931 (fail to avoid cache misses)\uff0c\u5e76\u4e14\u4f1a\u4e0e\u7a0b\u5e8f\u7684\u6b63\u5e38\u201c\u9700\u6c42\u201d\u8bbf\u95ee\u7ade\u4e89\u6709\u9650\u7684\u7247\u5916\u5185\u5b58\u5e26\u5bbd\u3002</li> <li>\u73b0\u6709\u7684\u9759\u6001\u7f16\u8bd1\u5668\u65b9\u6cd5\uff08\u5982 APT-GET\uff09\u867d\u7136\u53ef\u4ee5\u63d2\u5165\u9884\u53d6\u6307\u4ee4\uff0c\u4f46\u5b83\u4eec\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5305\u542b\u56fa\u5b9a\u7684\u9884\u53d6\u8ddd\u79bb\uff0c\u65e0\u6cd5\u9002\u5e94\u8fd0\u884c\u65f6\u53d8\u5316\u3002</li> <li>\u8be5\u8bba\u6587\u901a\u8fc7\u5927\u89c4\u6a21\u5b9e\u9a8c\u63ed\u793a\uff0c\u9884\u53d6\u7684\u6709\u6548\u6027\u9ad8\u5ea6\u4f9d\u8d56\u4e8e\u7a0b\u5e8f\u8f93\u5165 (program input) \u548c \u5904\u7406\u5668\u5fae\u67b6\u6784 (processor microarchitecture)\u3002\u4f8b\u5982\uff1a<ul> <li>\u5728 <code>sssp</code> \u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u4e0d\u540c\u8f93\u5165\uff08\u5982 <code>ROedges</code> \u548c <code>gowalla</code>\uff09\u7684\u6700\u4f73\u9884\u53d6\u8ddd\u79bb\u5dee\u5f02\u5de8\u5927\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 1. The sssp benchmark from CRONO [2] has very different optimal prefetch distances (shaded regions) with different inputs.</p> <pre><code>- \u5728 `pr` \u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u540c\u4e00\u4e2a\u8f93\u5165\u5728 **Intel Cascade Lake** \u548c **Intel Haswell** \u4e0a\u7684\u8868\u73b0\u53ef\u80fd\u5b8c\u5168\u76f8\u53cd\uff08\u4e00\u4e2a\u52a0\u901f\uff0c\u4e00\u4e2a\u51cf\u901f\uff09\u3002\n</code></pre> <p></p> <p>Figure 2. The pr benchmark from CRONO [2] sees a speedup or a slowdown with prefetching, depending on the microarchitecture.</p> <pre><code>- \u5728 `bfs` \u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u9884\u53d6\u751a\u81f3\u4f1a\u5bfc\u81f4\u9ad8\u8fbe **50-70%** \u7684\u4e25\u91cd\u6027\u80fd\u4e0b\u964d\u3002\n</code></pre> <p></p> <p>Figure 3. The bfs benchmark from CRONO [2] often (but not always) suffers significant performance slowdown with prefetching.</p> <ul> <li>\u8fd9\u4e9b\u53d1\u73b0\u8868\u660e\uff0c\u9884\u53d6\u662f\u4e00\u628a\u201c\u53cc\u5203\u5251 (double-edged sword)\u201d\uff0c\u5176\u8106\u5f31\u6027\u4f7f\u5f97\u5f00\u53d1\u8005\u5bf9\u5176\u671b\u800c\u5374\u6b65\u3002</li> </ul> <p>\u6838\u5fc3\u8d21\u732e</p> <ul> <li>\u63d0\u51fa\u4e86 RPG2 (Robust Profile-Guided Runtime Prefetch Generation)\uff0c\u8fd9\u662f\u4e00\u4e2a\u7eaf\u8f6f\u4ef6\u3001\u5728\u7ebf (online) \u7684\u7cfb\u7edf\uff0c\u80fd\u591f\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u52a8\u6001\u5730\u6ce8\u5165\u3001\u8c03\u4f18\u751a\u81f3\u56de\u6eda\u9884\u53d6\u6307\u4ee4\uff0c\u4ee5\u6700\u5927\u5316\u6027\u80fd\u5e76\u4fdd\u8bc1\u9c81\u68d2\u6027\u3002</li> <li>RPG2 \u7684\u6838\u5fc3\u5de5\u4f5c\u6d41\u7a0b\u5206\u4e3a\u56db\u4e2a\u9636\u6bb5\uff1a<ul> <li>Phase 1: Profiling\uff1a\u4f7f\u7528\u786c\u4ef6\u6027\u80fd\u8ba1\u6570\u5668\uff08\u5982 Intel PEBS\uff09\u5bf9\u8fd0\u884c\u4e2d\u7684\u8fdb\u7a0b\u8fdb\u884c\u5256\u6790\uff0c\u8bc6\u522b\u51fa\u5bfc\u81f4\u672b\u7ea7\u7f13\u5b58 (LLC) \u7f3a\u5931\u7684\u70ed\u70b9\u6307\u4ee4\uff0c\u5e76\u5efa\u7acb\u57fa\u7ebf IPC\u3002</li> <li>Phase 2: Code Analysis &amp; Generation\uff1a\u57fa\u4e8e BOLT (Binary Optimization and Layout Tool) \u6846\u67b6\uff0c\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u5206\u6790\u4ee3\u7801\u6a21\u5f0f\uff08\u7279\u522b\u662f\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee (indirect memory accesses)\uff09\uff0c\u5e76\u751f\u6210\u4e00\u4e2a\u903b\u8f91\u4e0a\u4e3a NOP \u7684\u9884\u53d6\u5185\u6838 (prefetch kernel)\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 4. RPG2 proceeds through four phases when optimizing a target process.</p> <pre><code>- **Phase 3: Runtime Code Insertion**\uff1a\u5229\u7528 **ptrace** \u548c\u81ea\u5b9a\u4e49\u5e93 **libpg2**\uff0c\u5c06\u5305\u542b\u9884\u53d6\u5185\u6838\u7684\u65b0\u51fd\u6570\u7248\u672c\u6ce8\u5165\u5230\u76ee\u6807\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\uff0c\u5e76\u901a\u8fc7\u521b\u65b0\u7684 **On-Stack Replacement (OSR)** \u6280\u672f\uff0c\u5c06\u6b63\u5728\u6267\u884c\u7684\u65e7\u51fd\u6570\u8c03\u7528\u65e0\u7f1d\u5207\u6362\u5230\u65b0\u7248\u672c\uff0c\u8fd9\u662f\u9996\u4e2a\u652f\u6301 C/C++ \u7b49\u975e\u6258\u7ba1\u8bed\u8a00\u7684 OSR \u5b9e\u73b0\u3002\n- **Phase 4: Monitoring And Tuning**\uff1a\u901a\u8fc7\u4e00\u4e2a**\u6709\u754c\u641c\u7d22\u7b97\u6cd5**\u5728\u7ebf\u8c03\u6574\u9884\u53d6\u8ddd\u79bb\uff0c\u5e76\u6301\u7eed\u76d1\u63a7 **IPC (Instructions Per Cycle)** \u6027\u80fd\u6307\u6807\u3002\u5982\u679c\u4efb\u4f55\u9884\u53d6\u8ddd\u79bb\u90fd\u65e0\u6cd5\u5e26\u6765\u6027\u80fd\u63d0\u5347\uff0cRPG2 \u4f1a**\u81ea\u52a8\u56de\u6eda (roll back)** \u5230\u539f\u59cb\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u6027\u80fd\u635f\u5931\u3002\n</code></pre> <ul> <li>RPG2 \u7684\u5173\u952e\u4f18\u52bf\u5728\u4e8e\u5176\u9c81\u68d2\u6027 (robustness)\uff1a\u5b83\u4e0d\u4ec5\u80fd\u63d0\u4f9b\u9ad8\u8fbe 2.15\u00d7 \u7684\u52a0\u901f\u6bd4\uff08\u4e0e\u6700\u4f73\u9759\u6001\u7f16\u8bd1\u5668\u76f8\u5f53\uff09\uff0c\u8fd8\u80fd\u5728\u9884\u53d6\u6709\u5bb3\u65f6\u5b89\u5168\u5730\u6062\u590d\u539f\u59cb\u6027\u80fd\uff0c\u8fd9\u662f\u9759\u6001\u65b9\u6cd5\u65e0\u6cd5\u505a\u5230\u7684\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>RPG2 \u662f\u4e00\u4e2a\u7eaf\u8f6f\u4ef6\u7684\u3001\u5728\u7ebf\uff08online\uff09\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u7528\u4e8e\u4e3a\u6b63\u5728\u6267\u884c\u7684 C/C++ \u7a0b\u5e8f\u52a8\u6001\u5730\u751f\u6210\u3001\u6ce8\u5165\u548c\u8c03\u4f18\u6570\u636e\u9884\u53d6\uff08prefetch\uff09\u6307\u4ee4\u3002\u5176\u6838\u5fc3\u76ee\u6807\u662f\u514b\u670d\u9759\u6001\u9884\u53d6\u65b9\u6848\u5bf9\u7a0b\u5e8f\u8f93\u5165\u548c\u5904\u7406\u5668\u5fae\u67b6\u6784\u7684\u654f\u611f\u6027\uff0c\u901a\u8fc7\u5b9e\u65f6\u6027\u80fd\u53cd\u9988\u6765\u786e\u4fdd\u9884\u53d6\u7684\u9c81\u68d2\u6027\uff08Robustness\uff09\uff0c\u5373\u5728\u63d0\u5347\u6027\u80fd\u7684\u540c\u65f6\uff0c\u80fd\u81ea\u52a8\u56de\u6eda\u4ee5\u907f\u514d\u56e0\u9884\u53d6\u4e0d\u5f53\u5bfc\u81f4\u7684\u6027\u80fd\u4e0b\u964d\u3002</p> <p>RPG2 \u7684\u5de5\u4f5c\u6d41\u7a0b\u5206\u4e3a\u56db\u4e2a\u7d27\u5bc6\u8854\u63a5\u7684\u9636\u6bb5\uff0c\u5982\u56fe </p> <p></p> <p>Figure 4. RPG2 proceeds through four phases when optimizing a target process.</p> <p>\u6240\u793a\uff1a</p> <ul> <li>\u7b2c\u4e00\u9636\u6bb5\uff1aProfiling (\u6027\u80fd\u5256\u6790)</li> <li>\u5229\u7528 Linux \u7684 <code>perf</code> \u5de5\u5177\u548c Intel \u7684 Precise Event-Based Sampling (PEBS) \u786c\u4ef6\u7279\u6027\uff0c\u5bf9\u76ee\u6807\u8fdb\u7a0b\u8fdb\u884c\u91c7\u6837\u3002</li> <li>\u76d1\u63a7 MEM_LOAD_RETIRED.L3_MISS \u4e8b\u4ef6\uff0c\u4ee5\u8bc6\u522b\u5bfc\u81f4\u6700\u540e\u4e00\u7ea7\u7f13\u5b58\uff08LLC\uff09\u7684\u6307\u4ee4\u5730\u5740\uff08PC\uff09\u3002</li> <li> <p>\u9ed8\u8ba4\u91c7\u6837 2 \u79d2\uff0c\u5e76\u7b5b\u9009\u51fa\u5728\u5176\u6240\u5c5e\u51fd\u6570\u4e2d\u8d21\u732e\u81f3\u5c11 10% LLC miss \u7684\u6307\u4ee4\u4f5c\u4e3a\u9884\u53d6\u5019\u9009\u8005\u3002</p> </li> <li> <p>\u7b2c\u4e8c\u9636\u6bb5\uff1aCode Analysis &amp; Generation (\u4ee3\u7801\u5206\u6790\u4e0e\u751f\u6210)</p> </li> <li>\u57fa\u4e8e Meta \u7684 BOLT (Binary Optimization and Layout Tool) \u6846\u67b6\uff0c\u5728\u4e8c\u8fdb\u5236\u5c42\u9762\u8fdb\u884c\u4ee3\u7801\u5206\u6790\u548c\u8f6c\u6362\uff0c\u65e0\u9700\u6e90\u4ee3\u7801\u3002</li> <li>\u901a\u8fc7\u65b0\u589e\u7684 InjectPrefetchPass \u5206\u6790\u5faa\u73af\u7ed3\u6784\u548c\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4e3b\u8981\u652f\u6301\u4e09\u7c7b\u8bbf\u95ee\u6a21\u5f0f\uff08\u89c1\u4e0b\u8868\uff09\uff1a</li> </ul> <p></p> <p>Table 1. Memory access categories that RPG2 supports</p> <ul> <li>\u4f7f\u7528\u540e\u5411\u5207\u7247\uff08Backwards Slicing\uff09\u6280\u672f\uff0c\u4ece\u5019\u9009 load \u6307\u4ee4\u56de\u6eaf\uff0c\u6784\u5efa\u8ba1\u7b97\u672a\u6765\u9884\u53d6\u5730\u5740\u6240\u9700\u7684\u6307\u4ee4\u5e8f\u5217\uff08\u79f0\u4e3a prefetch kernel\uff09\u3002</li> <li> <p>\u751f\u6210\u7684 prefetch kernel \u88ab\u8bbe\u8ba1\u4e3a\u903b\u8f91\u4e0a\u7684 NOP\uff0c\u786e\u4fdd\u4e0d\u6539\u53d8\u539f\u7a0b\u5e8f\u8bed\u4e49\uff0c\u5e76\u5305\u542b\u5fc5\u8981\u7684\u8fb9\u754c\u68c0\u67e5\uff08bounds check\uff09\u4ee5\u9632\u6b62\u8d8a\u754c\u8bbf\u95ee\u3002</p> </li> <li> <p>\u7b2c\u4e09\u9636\u6bb5\uff1aRuntime Code Insertion (\u8fd0\u884c\u65f6\u4ee3\u7801\u63d2\u5165)</p> </li> <li>\u901a\u8fc7 ptrace API \u548c\u4e00\u4e2a\u9884\u52a0\u8f7d\u7684\u5171\u4eab\u5e93 libpg2\uff0c\u5c06\u5305\u542b prefetch kernel \u7684\u65b0\u51fd\u6570\u7248\u672c\uff08??1\uff09\u6ce8\u5165\u5230\u76ee\u6807\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u3002</li> <li>\u91c7\u7528 On-Stack Replacement (OSR) \u6280\u672f\uff0c\u5c06\u6b63\u5728\u6267\u884c\u65e7\u51fd\u6570\uff08??0\uff09\u7684\u7ebf\u7a0b PC \u52a8\u6001\u91cd\u5b9a\u5411\u5230\u65b0\u51fd\u6570\uff08??1\uff09\u7684\u5bf9\u5e94\u4f4d\u7f6e\u3002</li> <li> <p>\u5229\u7528 BOLT \u751f\u6210\u7684 BOLT Address Translation Table (BATT) \u6765\u7cbe\u786e\u6620\u5c04\u65b0\u65e7\u51fd\u6570\u95f4\u7684\u6307\u4ee4\u5730\u5740\uff0c\u8fd9\u662f\u5b9e\u73b0 C/C++ \u7b49\u975e\u6258\u7ba1\u8bed\u8a00 OSR \u7684\u5173\u952e\u3002</p> </li> <li> <p>\u7b2c\u56db\u9636\u6bb5\uff1aMonitoring And Tuning (\u76d1\u63a7\u4e0e\u8c03\u4f18)</p> </li> <li>\u901a\u8fc7\u6d4b\u91cf IPC (Instructions Per Cycle) \u4f5c\u4e3a\u6027\u80fd\u6307\u6807\uff0c\u5bf9\u9884\u53d6\u8ddd\u79bb\uff08prefetch distance\uff09\u8fdb\u884c\u5728\u7ebf\u8c03\u4f18\u3002</li> <li>\u91c7\u7528\u4e00\u79cd\u4e09\u9636\u6bb5\u641c\u7d22\u7b97\u6cd5\uff08\u68af\u5ea6\u63a2\u6d4b\u3001\u7c97\u7c92\u5ea6\u8df3\u8dc3\u3001\u7ec6\u7c92\u5ea6\u4e8c\u5206\u641c\u7d22\uff09\u5728 [1, 200] \u8303\u56f4\u5185\u5bfb\u627e\u6700\u4f18\u8ddd\u79bb\u3002</li> <li>\u5982\u679c\u641c\u7d22\u53d1\u73b0\u4efb\u4f55\u9884\u53d6\u8ddd\u79bb\u90fd\u65e0\u6cd5\u8d85\u8d8a\u539f\u59cb\u6027\u80fd\u57fa\u7ebf\uff0cRPG2 \u4f1a\u89e6\u53d1\u56de\u6eda\u673a\u5236\uff08Rolling Back\uff09\uff0c\u5229\u7528 BATT \u5c06\u6240\u6709\u6267\u884c\u6d41\u5207\u6362\u56de\u539f\u59cb\u7684\u3001\u65e0\u9884\u53d6\u7684\u4ee3\u7801\u7248\u672c\uff0c\u4ece\u800c\u4fdd\u8bc1\u6027\u80fd\u5b89\u5168\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#1-bolt","title":"1. \u57fa\u4e8eBOLT\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u5206\u6790\u4e0e\u751f\u6210","text":"<p>\u6838\u5fc3\u539f\u7406\u4e0e\u6d41\u7a0b</p> <p>RPG2\u7684\u4ee3\u7801\u5206\u6790\u4e0e\u751f\u6210\u9636\u6bb5\u662f\u5176\u52a8\u6001\u9884\u53d6\u80fd\u529b\u7684\u6838\u5fc3\uff0c\u5b83\u901a\u8fc7\u6269\u5c55Meta\u7684BOLT (Binary Optimization and Layout Tool) \u6846\u67b6\u6765\u5b9e\u73b0\u3002\u8be5\u9636\u6bb5\u4e0d\u4f9d\u8d56\u6e90\u4ee3\u7801\uff0c\u76f4\u63a5\u5bf9\u5df2\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u64cd\u4f5c\uff0c\u8bc6\u522b\u70ed\u70b9\u5faa\u73af\u4e2d\u7684\u53ef\u9884\u53d6\u5185\u5b58\u8bbf\u95ee\uff0c\u5e76\u6ce8\u5165\u4e00\u4e2a\u903b\u8f91\u4e0a\u4e3aNOP (No Operation) \u7684\u9884\u53d6\u5185\u6838\uff08prefetch kernel\uff09\u3002</p> <ul> <li>\u8f93\u5165: \u7531\u7b2c\u4e00\u9636\u6bb5\uff08Profiling\uff09\u8bc6\u522b\u51fa\u7684\u3001\u5bfc\u81f4\u5927\u91cfLLC (Last-Level Cache) misses\u7684\u6307\u4ee4\u5730\u5740\uff08PC\uff09\u3002</li> <li>\u5904\u7406: RPG2\u5411BOLT\u6dfb\u52a0\u4e86\u4e00\u4e2a\u540d\u4e3a <code>InjectPrefetchPass</code> \u7684\u65b0\u4f18\u5316Pass\u3002\u8be5Pass\u8d1f\u8d23\u5206\u6790\u4e8c\u8fdb\u5236\u4ee3\u7801\uff0c\u8bc6\u522b\u6a21\u5f0f\uff0c\u5e76\u751f\u6210\u65b0\u7684\u673a\u5668\u7801\u3002</li> <li>\u8f93\u51fa: \u4e00\u4e2a\u5305\u542b\u539f\u59cb\u51fd\u6570\u548c\u5df2\u6ce8\u5165\u9884\u53d6\u5185\u6838\u7684\u65b0\u51fd\u6570\u7684\u65b0BOLTed\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u8fd9\u4e2a\u65b0\u51fd\u6570\u5c06\u5728\u7b2c\u4e09\u9636\u6bb5\u88ab\u52a8\u6001\u52a0\u8f7d\u5230\u8fd0\u884c\u8fdb\u7a0b\u4e2d\u3002</li> </ul> <p>\u53ef\u9884\u53d6\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u5206\u7c7b</p> <p>RPG2\u5c06\u53ef\u9884\u53d6\u7684\u5185\u5b58\u8bbf\u95ee\u5f52\u7eb3\u4e3a\u4e09\u5927\u7c7b\uff0c\u8fd9\u4e9b\u6a21\u5f0f\u8986\u76d6\u4e86\u4ece\u5bc6\u96c6\u6570\u7ec4\u5230\u7a00\u758f\u56fe\u7ed3\u6784\u7684\u5e38\u89c1\u573a\u666f\u3002</p> <p></p> <p>Table 1. Memory access categories that RPG2 supports</p> <ul> <li>Category 1: <code>a[i]</code> \u6216 <code>a[j]</code></li> <li>\u8fd9\u662f\u6700\u7b80\u5355\u7684\u76f4\u63a5\u5185\u5b58\u8bbf\u95ee\uff08direct memory access\uff09\uff0c\u901a\u5e38\u5177\u6709\u826f\u597d\u7684\u7a7a\u95f4\u5c40\u90e8\u6027\u3002</li> <li>RPG2\u8ba4\u4e3a\u786c\u4ef6\u9884\u53d6\u5668\u901a\u5e38\u80fd\u5f88\u597d\u5730\u5904\u7406\u6b64\u7c7b\u6a21\u5f0f\uff0c\u4f46\u5982\u679c\u5206\u6790\u53d1\u73b0\u5b58\u5728\u663e\u8457\u7684LLC miss\uff0c\u5219\u4f1a\u4ecb\u5165\u4ee5\u63d0\u4f9b\u66f4\u7cbe\u786e\u7684\u63a7\u5236\u3002</li> <li>Category 2: <code>a[b[i]]</code></li> <li>\u8fd9\u662f\u5178\u578b\u7684\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee\uff08indirect memory access\uff09\uff0c\u4e5f\u662f\u786c\u4ef6\u9884\u53d6\u5668\u96be\u4ee5\u6709\u6548\u5904\u7406\u7684\u4e3b\u8981\u75db\u70b9\u3002</li> <li>RPG2\u7684\u4e3b\u8981\u4f18\u5316\u76ee\u6807\u5c31\u662f\u6b64\u7c7b\u6a21\u5f0f\uff0c\u56e0\u4e3a\u5b83\u5728\u56fe\u8ba1\u7b97\u7b49\u5e94\u7528\u4e2d\u6781\u4e3a\u666e\u904d\u3002</li> <li>Category 3: <code>a[??(b[i])+j]</code></li> <li>\u8fd9\u662f\u4e00\u79cd\u66f4\u590d\u6742\u7684\u95f4\u63a5\u8bbf\u95ee\uff0c\u7ed3\u5408\u4e86\u5916\u5c42\u5faa\u73af\u7684\u95f4\u63a5\u7d22\u5f15\u548c\u5185\u5c42\u5faa\u73af\u7684\u504f\u79fb\u3002</li> <li>\u5bf9\u4e8e\u6b64\u6a21\u5f0f\uff0cRPG2\u7684\u7b56\u7565\u662f\u4f18\u5148\u5728\u5916\u5c42\u5faa\u73af\u4e2d\u4e3a\u672a\u6765\u7684<code>b[i+d]</code>\u9884\u53d6\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5728\u5185\u5c42\u5faa\u73af\u4e2d\u4e3a<code>j+d</code>\u9884\u53d6\uff0c\u56e0\u4e3a\u524d\u8005\u80fd\u66f4\u6709\u6548\u5730\u89e3\u51b3\u6839\u672c\u7684\u95f4\u63a5\u8bbf\u95ee\u5ef6\u8fdf\u95ee\u9898\u3002</li> </ul> <p>\u4ee3\u7801\u5206\u6790\uff1a\u540e\u5411\u5207\u7247 (Backwards Slicing)</p> <p>\u4e3a\u4e86\u7cbe\u786e\u5730\u4e3a\u95f4\u63a5\u8bbf\u95ee\u751f\u6210\u9884\u53d6\u5730\u5740\uff0cRPG2\u91c7\u7528\u540e\u5411\u5207\u7247 (Backwards Slicing) \u6280\u672f\u3002</p> <ul> <li>\u4ece\u7531Profiling\u9636\u6bb5\u6807\u8bb0\u7684\u3001\u5bfc\u81f4\u6700\u591aLLC miss\u7684demand load\u6307\u4ee4\u5f00\u59cb\u3002</li> <li>\u5411\u540e\u8ffd\u6eaf\u8be5load\u6307\u4ee4\u7684\u5730\u5740\u8ba1\u7b97\u6240\u4f9d\u8d56\u7684\u6240\u6709\u6307\u4ee4\uff0c\u76f4\u5230\u9047\u5230\u5faa\u73af\u4e0d\u53d8\u91cf (loop invariant) \u6216\u5faa\u73af\u5f52\u7eb3\u53d8\u91cf (loop induction variable)\u3002</li> <li>\u8fd9\u4e2a\u5207\u7247\u8fc7\u7a0b\u6784\u5efa\u4e86\u8ba1\u7b97\u672a\u6765\u9884\u53d6\u5730\u5740\u6240\u9700\u7684\u6700\u5c0f\u6307\u4ee4\u96c6\u3002</li> <li></li> </ul> <p></p> <p>Figure 5. Annotated example of RPG2 code transformations.</p> <p>\u5c55\u793a\u4e86\u8fd9\u4e00\u8fc7\u7a0b\uff1a\u4ece<code>ld [r3+r2]\u2192r4</code>\u56de\u6eaf\u5230<code>ld [r0+r1]\u2192r2</code>\uff0c\u5176\u4e2d<code>r0</code>\u548c<code>r3</code>\u662f\u5faa\u73af\u4e0d\u53d8\u91cf\uff0c<code>r1</code>\u662f\u5f52\u7eb3\u53d8\u91cf\u3002 - \u5207\u7247\u7ed3\u679c\u7528\u4e8e\u5224\u65ad\u8be5load\u5c5e\u4e8e\u4e0a\u8ff0\u4e09\u4e2a\u7c7b\u522b\u4e2d\u7684\u54ea\u4e00\u4e2a\uff0c\u5e76\u51b3\u5b9a\u9884\u53d6\u5185\u6838\u5e94\u63d2\u5165\u5230\u5185\u5c42\u8fd8\u662f\u5916\u5c42\u5faa\u73af\u5934\u4e2d\u3002</p> <p>\u4ee3\u7801\u751f\u6210\uff1a\u9884\u53d6\u5185\u6838 (Prefetch Kernel)</p> <p>\u751f\u6210\u7684\u9884\u53d6\u5185\u6838\u5fc5\u987b\u6ee1\u8db3\u8bed\u4e49\u4e0d\u53d8\u6027\uff0c\u5373\u5176\u6267\u884c\u4e0d\u80fd\u6539\u53d8\u539f\u7a0b\u5e8f\u7684\u884c\u4e3a\u3002</p> <ul> <li>\u5bc4\u5b58\u5668\u5206\u914d: \u5185\u6838\u9700\u8981\u4e34\u65f6\u5bc4\u5b58\u5668\u6765\u8ba1\u7b97\u5730\u5740\u3002RPG2\u901a\u8fc7\u5c06\u4e00\u4e2a\u73b0\u6709\u5bc4\u5b58\u5668\uff08\u5982<code>r5</code>\uff09spill\u5230\u6808\u4e0a\u6765\u83b7\u53d6\u4e00\u4e2ascratch register\uff0c\u5e76\u5728\u5185\u6838\u7ed3\u675f\u65f6\u5c06\u5176\u6062\u590d\u3002</li> <li>\u8fb9\u754c\u68c0\u67e5 (Bounds Check): \u7531\u4e8e\u9884\u53d6\u662f\u9488\u5bf9\u672a\u6765\u8fed\u4ee3\uff08<code>i + d</code>\uff09\u7684\u6570\u636e\uff0c\u5fc5\u987b\u786e\u4fdd\u8be5\u5730\u5740\u662f\u6709\u6548\u7684\uff0c\u4ee5\u907f\u514d\u7a0b\u5e8f\u5d29\u6e83\u3002RPG2\u4f1a\u590d\u5236\u539f\u59cb\u5faa\u73af\u7684\u8fb9\u754c\u68c0\u67e5\u6761\u4ef6\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u8c03\u6574\uff08\u4f8b\u5982\uff0c\u5c06<code>bnz</code>\u6539\u4e3a<code>bgte</code>\uff09\u6765\u4fdd\u62a4\u9884\u53d6\u64cd\u4f5c\u3002</li> <li>\u6307\u4ee4\u8f6c\u6362: \u5c06\u539f\u59cb\u7528\u4e8e\u8ba1\u7b97\u672a\u6765\u6570\u636e\u5730\u5740\u7684demand load\u6307\u4ee4\u8f6c\u6362\u4e3aprefetch instruction\uff08\u5982x86\u7684<code>prefetcht0</code>\uff09\u3002</li> <li>\u903b\u8f91\u7ed3\u6784: \u6574\u4e2a\u5185\u6838\u88ab\u8bbe\u8ba1\u4e3a\u4e00\u4e2a\u53d7\u4fdd\u62a4\u7684\u4ee3\u7801\u5757\uff1a\u5148\u8fdb\u884c\u8fb9\u754c\u68c0\u67e5\uff0c\u82e5\u901a\u8fc7\u5219\u6267\u884c\u5730\u5740\u8ba1\u7b97\u548c\u9884\u53d6\uff0c\u6700\u540e\u6e05\u7406\u4e34\u65f6\u72b6\u6001\u5e76\u7ee7\u7eed\u6267\u884c\u539f\u59cb\u5faa\u73af\u4f53\u3002\u8fd9\u4fdd\u8bc1\u4e86\u5176NOP\u7279\u6027\u3002</li> </ul> <p>\u5728RPG2\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <p>\u6b64\u9636\u6bb5\u662f\u8fde\u63a5\u79bb\u7ebf\u5206\u6790\u4e0e\u5728\u7ebf\u4f18\u5316\u7684\u6865\u6881\u3002</p> <ul> <li>\u5b83\u5c06Profiling\u9636\u6bb5\u83b7\u5f97\u7684\u6027\u80fd\u6d1e\u5bdf\uff08\u54ea\u4e9bPC\u5bfc\u81f4miss\uff09\u8f6c\u5316\u4e3a\u5177\u4f53\u7684\u4ee3\u7801\u4fee\u6539\u65b9\u6848\u3002</li> <li>\u901a\u8fc7\u5229\u7528BOLT\uff0cRPG2\u83b7\u5f97\u4e86\u5f3a\u5927\u7684\u4e8c\u8fdb\u5236\u63d0\u5347\uff08lifting\uff09\u548c\u91cd\u5199\u80fd\u529b\uff0c\u65e0\u9700\u6e90\u4ee3\u7801\u5373\u53ef\u8fdb\u884c\u590d\u6742\u7684\u4ee3\u7801\u53d8\u6362\u3002</li> <li>\u751f\u6210\u7684\u65b0\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e3a\u7b2c\u4e09\u9636\u6bb5\u7684Runtime Code Insertion\u63d0\u4f9b\u4e86\u539f\u6750\u6599\uff0c\u4f7f\u5f97\u540e\u7eed\u7684On-Stack Replacement (OSR) \u6210\u4e3a\u53ef\u80fd\u3002</li> <li>\u5176\u751f\u6210\u7684\u9884\u53d6\u5185\u6838\u662f\u7b2c\u56db\u9636\u6bb5Monitoring And Tuning\u7684\u64cd\u4f5c\u5bf9\u8c61\uff0c\u901a\u8fc7\u52a8\u6001\u4fee\u6539\u5185\u6838\u4e2d\u7684\u7acb\u5373\u6570\uff08prefetch distance\uff09\u6765\u5b9e\u73b0\u5728\u7ebf\u8c03\u4f18\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#2-osr","title":"2. \u8fd0\u884c\u65f6\u4ee3\u7801\u6ce8\u5165\u4e0e\u5728\u7ebf\u6808\u66ff\u6362\uff08OSR\uff09","text":"<p>\u8fd0\u884c\u65f6\u4ee3\u7801\u6ce8\u5165\u4e0e\u5728\u7ebf\u6808\u66ff\u6362\uff08OSR\uff09\u7684\u5b9e\u73b0\u539f\u7406</p> <p>RPG2 \u7684\u6838\u5fc3\u521b\u65b0\u4e4b\u4e00\u5728\u4e8e\u5176\u80fd\u591f\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u52a8\u6001\u5730\u5c06\u5305\u542b\u9884\u53d6\u6307\u4ee4\u7684\u4f18\u5316\u4ee3\u7801\u6ce8\u5165\u5230\u76ee\u6807\u8fdb\u7a0b\u4e2d\uff0c\u5e76\u5b89\u5168\u5730\u5c06\u6b63\u5728\u6267\u884c\u7684\u7ebf\u7a0b\u4ece\u539f\u59cb\u4ee3\u7801\u5207\u6362\u5230\u65b0\u4ee3\u7801\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u88ab\u79f0\u4e3a On-Stack Replacement (OSR)\u3002\u5176\u5b9e\u73b0\u4f9d\u8d56\u4e8e\u591a\u4e2a\u5173\u952e\u6280\u672f\u7ec4\u4ef6\u7684\u534f\u540c\u5de5\u4f5c\u3002</p> <ul> <li>RPG2 \u91c7\u7528\u4e86\u4e00\u79cd\u201cpay-as-you-go\u201d\u7684\u7b56\u7565\uff0c\u5373\u53ea\u6709\u5728\u51b3\u5b9a\u8fdb\u884c\u4f18\u5316\u65f6\u624d\u6ce8\u5165\u4ee3\u7801\uff0c\u907f\u514d\u4e86\u50cf XRay \u90a3\u6837\u5728\u70ed\u70b9\u5faa\u73af\u4e2d\u9884\u57cb NOP \u6307\u4ee4\u6240\u5e26\u6765\u7684\u9ad8\u8fbe 5% \u7684\u6301\u7eed\u6027\u8fd0\u884c\u65f6\u5f00\u9500\u3002</li> <li>\u4e3a\u4e86\u5c06\u65b0\u51fd\u6570 <code>f1</code> \u6ce8\u5165\u5230\u6b63\u5728\u8fd0\u884c\u7684\u76ee\u6807\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u4e2d\uff0cRPG2 \u5e76\u975e\u76f4\u63a5\u8986\u76d6\u539f\u6709\u7684\u51fd\u6570 <code>f0</code>\uff0c\u800c\u662f\u5c06\u5176\u653e\u7f6e\u5728\u4e00\u4e2a\u5168\u65b0\u7684\u5185\u5b58\u4f4d\u7f6e\u3002\u8fd9\u79cd\u8bbe\u8ba1\u5de7\u5999\u5730\u89c4\u907f\u4e86\u56e0\u4ee3\u7801\u957f\u5ea6\u53d8\u5316\u5bfc\u81f4\u7684\u5206\u652f\u76ee\u6807\u504f\u79fb\u95ee\u9898\uff0c\u5e76\u5b8c\u6574\u4fdd\u7559\u4e86\u6240\u6709\u6307\u5411 <code>f0</code> \u7684\u6307\u9488\uff08\u5305\u62ec\u51fd\u6570\u6307\u9488\u3001setjmp \u7f13\u51b2\u533a\u7b49\uff09\uff0c\u4e3a\u540e\u7eed\u53ef\u80fd\u7684\u56de\u6eda\u63d0\u4f9b\u4e86\u4fbf\u5229\u3002</li> <li>\u4ee3\u7801\u6ce8\u5165\u7684\u5177\u4f53\u6267\u884c\u7531\u4e00\u4e2a\u540d\u4e3a libpg2 \u7684\u52a8\u6001\u5e93\u5b8c\u6210\u3002\u8be5\u5e93\u901a\u8fc7 Linux \u7684 LD_PRELOAD \u673a\u5236\u5728\u76ee\u6807\u8fdb\u7a0b\u542f\u52a8\u65f6\u88ab\u52a0\u8f7d\u5230\u5176\u5730\u5740\u7a7a\u95f4\u5185\u3002\u7531\u4e8e libpg2 \u8fd0\u884c\u5728\u76ee\u6807\u8fdb\u7a0b\u5185\u90e8\uff0c\u5b83\u53ef\u4ee5\u76f4\u63a5\u3001\u9ad8\u6548\u5730\u4fee\u6539\u8fdb\u7a0b\u5185\u5b58\uff0c\u907f\u514d\u4e86\u9891\u7e41\u4f7f\u7528 ptrace \u7cfb\u7edf\u8c03\u7528\u5e26\u6765\u7684\u9ad8\u5ef6\u8fdf\u3002</li> <li>ptrace API \u5728\u6b64\u8fc7\u7a0b\u4e2d\u626e\u6f14\u534f\u8c03\u8005\u7684\u89d2\u8272\uff0c\u4e3b\u8981\u7528\u4e8e\u6682\u505c/\u6062\u590d\u76ee\u6807\u8fdb\u7a0b\u3001\u89e6\u53d1 libpg2 \u7684\u6267\u884c\u4ee5\u53ca\u5728\u5fc5\u8981\u65f6\u8fdb\u884c\u5355\u6b65\u8c03\u8bd5\uff08single-stepping\uff09\u3002</li> </ul> <p></p> <p>Figure 6. The PC register and code memory of the target process before and after, RPG2\u2019s code replacement.</p> <p>\u5728\u7ebf\u6808\u66ff\u6362\uff08OSR\uff09\u7684\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5173\u952e\u6311\u6218</p> <p>OSR \u7684\u4e3b\u8981\u6311\u6218\u5728\u4e8e\uff0c\u5982\u4f55\u5c06\u90a3\u4e9b\u5df2\u7ecf\u5904\u4e8e <code>f0</code> \u51fd\u6570\u6267\u884c\u4e2d\u9014\u7684\u7ebf\u7a0b\uff08\u5373\u5176\u7a0b\u5e8f\u8ba1\u6570\u5668 PC \u6307\u5411 <code>f0</code> \u5185\u90e8\uff09\u5b89\u5168\u5730\u91cd\u5b9a\u5411\u5230 <code>f1</code> \u4e2d\u7684\u5bf9\u5e94\u4f4d\u7f6e\uff0c\u800c\u4e0d\u80fd\u7b80\u5355\u5730\u7b49\u5f85\u5f53\u524d\u51fd\u6570\u8c03\u7528\u7ed3\u675f\u3002</p> <ul> <li>RPG2 \u80fd\u591f\u6210\u529f\u5b9e\u73b0 OSR \u4f9d\u8d56\u4e8e\u4e24\u4e2a\u5173\u952e\u539f\u56e0\uff1a</li> <li>\u96f6\u6570\u636e\u5e03\u5c40\u53d8\u66f4\uff1aRPG2 \u7684\u9884\u53d6\u5185\u6838\uff08prefetch kernel\uff09\u88ab\u8bbe\u8ba1\u6210\u903b\u8f91\u4e0a\u7684 NOP\u3002\u5176\u4ee3\u7801\u8f6c\u6362\uff08\u5982\u5bc4\u5b58\u5668\u6ea2\u51fa/\u6062\u590d\uff09\u786e\u4fdd\u4e86 <code>f0</code> \u548c <code>f1</code> \u4e4b\u95f4\u7684\u6570\u636e\u5e03\u5c40\uff08\u53d8\u91cf\u5230\u5bc4\u5b58\u5668/\u6808\u7684\u6620\u5c04\uff09\u5b8c\u5168\u4e00\u81f4\u3002\u8fd9\u89e3\u51b3\u4e86\u4f20\u7edf\u7f16\u8bd1\u5668\u7ea7\u4f18\u5316\uff08\u5982 APT-GET\uff09\u56e0 IR \u5c42\u9762\u7684\u5fae\u5c0f\u6539\u52a8\u5bfc\u81f4\u6570\u636e\u5e03\u5c40\u5267\u53d8\uff0c\u4ece\u800c\u4f7f OSR \u53d8\u5f97\u6781\u5176\u590d\u6742\u7684\u95ee\u9898\u3002</li> <li> <p>BOLT \u5730\u5740\u7ffb\u8bd1\u8868\uff08BATT\uff09\uff1aBOLT \u5728\u5bf9\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u4f18\u5316\u65f6\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e2a BOLT Address Translation Table (BATT)\uff0c\u5e76\u5c06\u5176\u5d4c\u5165\u5230\u8f93\u51fa\u7684 ELF \u6587\u4ef6\u4e2d\u3002\u8fd9\u4e2a\u8868\u7cbe\u786e\u5730\u8bb0\u5f55\u4e86\u539f\u59cb\u51fd\u6570 <code>f0</code> \u4e2d\u6bcf\u6761\u6307\u4ee4\u4e0e\u5176\u5728\u4f18\u5316\u540e\u51fd\u6570 <code>f1</code> \u4e2d\u5bf9\u5e94\u6307\u4ee4\u4e4b\u95f4\u7684 PC \u6620\u5c04\u5173\u7cfb\u3002</p> </li> <li> <p>OSR \u7684\u5177\u4f53\u6267\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a</p> </li> <li>RPG2 \u901a\u8fc7 ptrace \u6682\u505c\u76ee\u6807\u8fdb\u7a0b\u3002</li> <li>\u5229\u7528 libpg2 \u5728\u76ee\u6807\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u5185\u5206\u914d\u65b0\u5185\u5b58\uff0c\u5e76\u5c06 <code>f1</code> \u7684\u4ee3\u7801\u590d\u5236\u8fdb\u53bb\u3002</li> <li>\u4fee\u8865\u6240\u6709\u76f4\u63a5\u8c03\u7528 <code>f0</code> \u7684\u8c03\u7528\u70b9\uff0c\u4f7f\u5176\u8df3\u8f6c\u5230 <code>f1</code>\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u7ebf\u7a0b\uff0c\u68c0\u67e5\u5176 PC \u662f\u5426\u6307\u5411 <code>f0</code>\u3002<ul> <li>\u5982\u679c\u662f\uff0c\u5219\u5229\u7528 BATT \u5c06\u8be5 PC \u7ffb\u8bd1\u4e3a <code>f1</code> \u4e2d\u7684\u5bf9\u5e94\u5730\u5740\uff0c\u5e76\u66f4\u65b0\u7ebf\u7a0b\u7684 PC\u3002</li> <li>\u5982\u679c\u7ebf\u7a0b\u7684 PC \u6307\u5411\u7684\u662f\u65b0\u63d2\u5165\u7684\u9884\u53d6\u5185\u6838\uff08\u8fd9\u90e8\u5206\u5728 <code>f0</code> \u4e2d\u6ca1\u6709\u5bf9\u5e94\u7269\uff0c\u6545 BATT \u4e2d\u65e0\u6761\u76ee\uff09\uff0c\u5219 RPG2 \u4f1a\u901a\u8fc7 ptrace \u5bf9\u8be5\u7ebf\u7a0b\u8fdb\u884c single-stepping\uff0c\u76f4\u5230\u5176 PC \u79fb\u52a8\u5230 BATT \u4e2d\u6709\u8bb0\u5f55\u7684\u4f4d\u7f6e\uff0c\u518d\u8fdb\u884c\u7ffb\u8bd1\u548c\u66f4\u65b0\u3002</li> </ul> </li> <li>\u6700\u540e\uff0cRPG2 \u6062\u590d\u76ee\u6807\u8fdb\u7a0b\u7684\u6267\u884c\uff0c\u6b64\u65f6\u6240\u6709\u7ebf\u7a0b\u90fd\u5df2\u5728 <code>f1</code> \u4e0a\u8fd0\u884c\u3002</li> </ul> <p>\u53c2\u6570\u8bbe\u7f6e\u3001\u8f93\u5165\u8f93\u51fa\u53ca\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165\uff1a\u7ecf\u8fc7 BOLT \u4f18\u5316\u540e\u751f\u6210\u7684\u65b0\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u5305\u542b <code>f1</code> \u548c BATT\uff09\u3001\u6b63\u5728\u8fd0\u884c\u7684\u76ee\u6807\u8fdb\u7a0b PID\u3002</li> <li>\u8f93\u51fa\uff1a\u4e00\u4e2a\u5730\u5740\u7a7a\u95f4\u5df2\u88ab\u4fee\u6539\u7684\u76ee\u6807\u8fdb\u7a0b\uff0c\u5176\u6267\u884c\u6d41\u5df2\u65e0\u7f1d\u5207\u6362\u81f3\u5305\u542b\u9884\u53d6\u6307\u4ee4\u7684 <code>f1</code> \u51fd\u6570\u3002</li> <li>\u5173\u952e\u53c2\u6570/\u914d\u7f6e\uff1a</li> <li>LD_PRELOAD\uff1a\u7528\u4e8e\u6ce8\u5165 libpg2 \u5e93\u3002</li> <li>ptrace \u6743\u9650\uff1a\u9700\u8981\u8db3\u591f\u7684\u7cfb\u7edf\u6743\u9650\u6765\u9644\u52a0\u5230\u76ee\u6807\u8fdb\u7a0b\u3002</li> <li>BATT\uff1a\u4f5c\u4e3a OSR \u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\uff0c\u5176\u51c6\u786e\u6027\u76f4\u63a5\u51b3\u5b9a\u4e86\u66ff\u6362\u7684\u5b89\u5168\u6027\u3002</li> </ul> \u7ec4\u4ef6 \u4f5c\u7528 \u5173\u952e\u7279\u6027 libpg2 \u5728\u76ee\u6807\u8fdb\u7a0b\u5185\u90e8\u6267\u884c\u4ee3\u7801\u6ce8\u5165 \u4f4e\u5f00\u9500\u5185\u5b58\u5199\u5165\uff0c\u901a\u8fc7 LD_PRELOAD \u52a0\u8f7d ptrace \u63a7\u5236\u76ee\u6807\u8fdb\u7a0b\u751f\u547d\u5468\u671f\u548c\u72b6\u6001 \u7528\u4e8e\u6682\u505c/\u6062\u590d\u8fdb\u7a0b\uff0c\u5904\u7406\u8fb9\u754c\u60c5\u51b5\uff08\u5982 single-stepping\uff09 BATT \u63d0\u4f9b\u65b0\u65e7\u51fd\u6570\u95f4\u7684\u6307\u4ee4\u5730\u5740\u6620\u5c04 \u7531 BOLT \u751f\u6210\uff0c\u662f\u5b9e\u73b0\u5b89\u5168 OSR \u7684\u57fa\u77f3 \u65b0\u51fd\u6570 f1 \u5305\u542b\u9884\u53d6\u5185\u6838\u7684\u4f18\u5316\u7248\u672c \u4e0e f0 \u4fdd\u6301\u6570\u636e\u5e03\u5c40\u4e00\u81f4\uff0c\u903b\u8f91\u4e0a\u4e3a NOP <p>\u5728 RPG2 \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <p>\u8fd0\u884c\u65f6\u4ee3\u7801\u6ce8\u5165\u4e0e OSR \u662f\u8fde\u63a5\u79bb\u7ebf\u4ee3\u7801\u751f\u6210\uff08Phase 2\uff09\u548c\u5728\u7ebf\u6027\u80fd\u8c03\u4f18\uff08Phase 4\uff09\u7684\u5173\u952e\u6865\u6881\u3002\u5b83\u4f7f\u5f97 RPG2 \u80fd\u591f\u7a81\u7834\u9759\u6001\u7f16\u8bd1\u7684\u9650\u5236\uff0c\u771f\u6b63\u5b9e\u73b0 \u52a8\u6001\u3001\u81ea\u9002\u5e94\u7684\u9884\u53d6\u4f18\u5316\u3002\u6ca1\u6709\u8fd9\u4e00\u673a\u5236\uff0cRPG2 \u5c31\u65e0\u6cd5\u5728\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u5b89\u5168\u5730\u90e8\u7f72\u548c\u56de\u6eda\u4f18\u5316\uff0c\u4e5f\u5c31\u65e0\u6cd5\u5e94\u5bf9\u9884\u53d6\u6548\u679c\u5bf9\u7a0b\u5e8f\u8f93\u5165\u548c\u5fae\u67b6\u6784\u7684\u9ad8\u5ea6\u654f\u611f\u6027\uff0c\u4ece\u800c\u5931\u53bb\u5176\u201cRobust\u201d\u7684\u6838\u5fc3\u4ef7\u503c\u3002</p>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#3_1","title":"3. \u57fa\u4e8e\u6027\u80fd\u53cd\u9988\u7684\u52a8\u6001\u9884\u53d6\u8ddd\u79bb\u8c03\u4f18","text":"<p>RPG2\u52a8\u6001\u9884\u53d6\u8ddd\u79bb\u8c03\u4f18\u673a\u5236\u8be6\u89e3</p> <p>RPG2\u7684\u6838\u5fc3\u521b\u65b0\u4e4b\u4e00\u5728\u4e8e\u5176\u80fd\u591f\u5728\u7ebf\u3001\u52a8\u6001\u5730\u4e3a\u6ce8\u5165\u7684\u9884\u53d6\u6307\u4ee4\u627e\u5230\u6700\u4f18\u7684prefetch distance\uff08\u9884\u53d6\u8ddd\u79bb\uff09\uff0c\u4ece\u800c\u6700\u5927\u5316\u6027\u80fd\u6536\u76ca\u5e76\u89c4\u907f\u56e0\u914d\u7f6e\u4e0d\u5f53\u5bfc\u81f4\u7684\u6027\u80fd\u635f\u5931\u3002\u8be5\u673a\u5236\u5b8c\u5168\u57fa\u4e8e\u8fd0\u884c\u65f6\u53cd\u9988\uff0c\u4ee5IPC (Instructions Per Cycle) \u4f5c\u4e3a\u6838\u5fc3\u6027\u80fd\u6307\u6807\u3002</p> <ul> <li>\u6574\u4f53\u76ee\u6807\uff1a\u5728\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u81ea\u52a8\u641c\u7d22\u5e76\u9501\u5b9a\u4e00\u4e2a\u80fd\u5e26\u6765\u6700\u9ad8IPC\u7684\u9884\u53d6\u8ddd\u79bb\u503c\u3002</li> <li>\u5173\u952e\u7ea6\u675f\uff1a</li> <li>\u641c\u7d22\u8fc7\u7a0b\u672c\u8eab\u5fc5\u987b\u8f7b\u91cf\uff0c\u4e0d\u80fd\u5bf9\u76ee\u6807\u7a0b\u5e8f\u9020\u6210\u8fc7\u5927\u7684\u6027\u80fd\u5e72\u6270\u3002</li> <li>\u5fc5\u987b\u5177\u5907\u201c\u5b89\u5168\u7f51\u201d\u673a\u5236\uff0c\u5f53\u6240\u6709\u5c1d\u8bd5\u7684\u8ddd\u79bb\u90fd\u65e0\u6cd5\u8d85\u8d8a\u57fa\u7ebf\u6027\u80fd\u65f6\uff0c\u80fd\u591f\u56de\u6eda\u5230\u539f\u59cb\u65e0\u9884\u53d6\u4ee3\u7801\u3002</li> <li>\u4f5c\u7528\uff1a\u6b64\u8c03\u4f18\u9636\u6bb5\u662fRPG2\u5b9e\u73b0\u201cRobust\u201d\uff08\u9c81\u68d2\u6027\uff09\u7684\u5173\u952e\u3002\u5b83\u89e3\u51b3\u4e86\u9759\u6001\u7f16\u8bd1\u5668\u65e0\u6cd5\u5e94\u5bf9\u7684input-dependent\uff08\u8f93\u5165\u4f9d\u8d56\uff09\u548cmicroarchitecture-dependent\uff08\u5fae\u67b6\u6784\u4f9d\u8d56\uff09\u95ee\u9898\uff0c\u786e\u4fdd\u9884\u53d6\u4f18\u5316\u53ea\u5728\u6709\u76ca\u65f6\u751f\u6548\u3002</li> </ul> <p>\u4e09\u9636\u6bb5\u641c\u7d22\u7b97\u6cd5\u6d41\u7a0b</p> <p>RPG2\u7684\u641c\u7d22\u7b97\u6cd5\u88ab\u7cbe\u5fc3\u8bbe\u8ba1\u4e3a\u4e09\u4e2a\u8fde\u7eed\u9636\u6bb5\uff0c\u65e8\u5728\u9ad8\u6548\u5730\u5728\u5e7f\u9614\u7684\u641c\u7d22\u7a7a\u95f4\uff08\u9ed8\u8ba4[1, 200]\uff09\u4e2d\u5b9a\u4f4d\u5c40\u90e8\u6700\u4f18\u89e3\u3002</p> <ul> <li>\u7b2c\u4e00\u9636\u6bb5\uff1a\u68af\u5ea6\u63a2\u6d4b (Gradient Detection)</li> <li>\u76ee\u7684\uff1a\u786e\u5b9a\u641c\u7d22\u65b9\u5411\uff08\u589e\u5927\u6216\u51cf\u5c0f\u9884\u53d6\u8ddd\u79bb\uff09\u3002</li> <li>\u6d41\u7a0b\uff1a<ul> <li>\u4ece\u533a\u95f4[1, 100]\u4e2d\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u521d\u59cb\u8ddd\u79bb <code>d</code>\u3002</li> <li>\u5206\u522b\u6d4b\u91cf <code>d-5</code>\u3001<code>d</code> \u548c <code>d+5</code> \u4e09\u4e2a\u70b9\u7684IPC\u3002</li> <li>\u901a\u8fc7\u6bd4\u8f83\u8fd9\u4e09\u4e2a\u70b9\u7684IPC\u503c\uff0c\u8ba1\u7b97\u51fa\u4e00\u4e2a\u7b80\u5355\u7684\u6027\u80fd\u68af\u5ea6\uff0c\u4ece\u800c\u51b3\u5b9a\u5411\u54ea\u4e2a\u65b9\u5411\uff08\u6b63\u6216\u8d1f\uff09\u8fdb\u884c\u540e\u7eed\u641c\u7d22\u3002</li> </ul> </li> <li> <p>\u539f\u7406\uff1a\u907f\u514d\u4e86\u4ece\u56fa\u5b9a\u70b9\uff08\u59821\uff09\u5f00\u59cb\u7684\u76f2\u76ee\u641c\u7d22\uff0c\u5229\u7528\u968f\u673a\u8d77\u70b9\u589e\u52a0\u4e86\u627e\u5230\u5168\u5c40\u6700\u4f18\u89e3\u7684\u53ef\u80fd\u6027\u3002</p> </li> <li> <p>\u7b2c\u4e8c\u9636\u6bb5\uff1a\u7c97\u7c92\u5ea6\u8df3\u8dc3 (Coarse-grained Jumping)</p> </li> <li>\u76ee\u7684\uff1a\u5feb\u901f\u8de8\u8d8a\u6027\u80fd\u5e73\u7f13\u533a\uff0c\u903c\u8fd1\u6027\u80fd\u5cf0\u503c\u533a\u57df\u3002</li> <li>\u6d41\u7a0b\uff1a<ul> <li>\u4ece\u7b2c\u4e00\u9636\u6bb5\u786e\u5b9a\u7684\u65b9\u5411\u5f00\u59cb\uff0c\u4ee5\u6307\u6570\u65b9\u5f0f\uff08\u6b65\u957f\u4e0d\u65ad\u7ffb\u500d\uff09\u8df3\u8dc3\u5f0f\u5730\u6d4b\u8bd5\u65b0\u7684\u9884\u53d6\u8ddd\u79bb\u3002</li> <li>\u53ea\u8981IPC\u6301\u7eed\u63d0\u5347\uff0c\u5c31\u7ee7\u7eed\u6cbf\u8be5\u65b9\u5411\u8df3\u8dc3\u3002</li> <li>\u4e00\u65e6\u53d1\u73b0IPC\u4e0b\u964d\uff0c\u6216\u8005\u8fbe\u5230\u9884\u8bbe\u8fb9\u754c\uff081\u6216200\uff09\uff0c\u5219\u505c\u6b62\u8df3\u8dc3\u3002</li> <li>\u5c06\u6700\u540e\u4e00\u6b21IPC\u63d0\u5347\u7684\u70b9\u548c\u7b2c\u4e00\u6b21IPC\u4e0b\u964d\u7684\u70b9\uff0c\u5206\u522b\u8bb0\u4e3a\u641c\u7d22\u533a\u95f4\u7684\u4e0b\u754c\u548c\u4e0a\u754c\u3002</li> </ul> </li> <li> <p>\u539f\u7406\uff1a\u6b64\u9636\u6bb5\u727a\u7272\u4e86\u7cbe\u5ea6\u4ee5\u6362\u53d6\u901f\u5ea6\uff0c\u80fd\u8fc5\u901f\u5c06\u641c\u7d22\u8303\u56f4\u4ece\u6570\u767e\u4e2a\u53ef\u80fd\u503c\u7f29\u5c0f\u5230\u4e00\u4e2a\u8f83\u7a84\u7684\u7a97\u53e3\u3002</p> </li> <li> <p>\u7b2c\u4e09\u9636\u6bb5\uff1a\u4e8c\u5206\u67e5\u627e (Binary Search)</p> </li> <li>\u76ee\u7684\uff1a\u5728\u7b2c\u4e8c\u9636\u6bb5\u786e\u5b9a\u7684\u72ed\u7a84\u7a97\u53e3\u5185\uff0c\u7cbe\u786e\u5b9a\u4f4d\u5c40\u90e8\u6700\u4f18\u7684\u9884\u53d6\u8ddd\u79bb\u3002</li> <li>\u6d41\u7a0b\uff1a<ul> <li>\u5728\u5df2\u786e\u5b9a\u7684\u4e0a\u4e0b\u754c\u4e4b\u95f4\u6267\u884c\u6807\u51c6\u7684\u4e8c\u5206\u67e5\u627e\u3002</li> <li>\u6bcf\u6b21\u8fed\u4ee3\u90fd\u6d4b\u8bd5\u4e2d\u70b9\u8ddd\u79bb\u7684IPC\uff0c\u5e76\u6839\u636e\u7ed3\u679c\u7f29\u5c0f\u533a\u95f4\uff0c\u76f4\u5230\u627e\u5230\u7a97\u53e3\u5185\u7684\u6700\u4f73\u503c\u3002</li> </ul> </li> <li>\u539f\u7406\uff1a\u5728\u5c0f\u8303\u56f4\u5185\u8fdb\u884c\u7cbe\u7ec6\u641c\u7d22\uff0c\u786e\u4fdd\u627e\u5230\u8be5\u533a\u57df\u5185\u7684\u6700\u4f18\u89e3\u3002</li> </ul> <p>\u6027\u80fd\u76d1\u63a7\u4e0e\u51b3\u7b56\u673a\u5236</p> <p>\u6574\u4e2a\u8c03\u4f18\u8fc7\u7a0b\u7d27\u5bc6\u56f4\u7ed5IPC\u8fd9\u4e00\u6307\u6807\u5c55\u5f00\uff0c\u5e76\u8f85\u4ee5\u5b89\u5168\u56de\u6eda\u7b56\u7565\u3002</p> <ul> <li>\u6027\u80fd\u6307\u6807\u9009\u62e9\uff1a</li> <li>\u9009\u7528IPC\u800c\u975eLLC MPKI\uff08Last-Level Cache Misses Per Kilo-Instruction\uff09\u4f5c\u4e3a\u4e3b\u8981\u6307\u6807\u3002</li> <li>\u539f\u56e0\u5728\u4e8e\uff0c\u5b9e\u9a8c\u53d1\u73b0LLC MPKI\u7684\u964d\u4f4e\u4e0e\u6700\u7ec8\u6027\u80fd\u63d0\u5347\u7684\u76f8\u5173\u6027\u4e0d\u5f3a\uff08\u89c1\u56fe11\uff09\uff0c\u800cIPC\u80fd\u66f4\u76f4\u63a5\u5730\u53cd\u6620\u7aef\u5230\u7aef\u7684\u6027\u80fd\u53d8\u5316\u3002</li> <li></li> </ul> <p></p> <p>Figure 11. The relationship between speedup and LLC MPKI for pr on Cascade Lake.</p> <ul> <li>\u6d4b\u91cf\u4e0e\u6267\u884c\uff1a</li> <li>\u6bcf\u6b21\u8c03\u6574\u9884\u53d6\u8ddd\u79bb\u540e\uff0cRPG2\u4f1a\u6682\u505c\u76ee\u6807\u8fdb\u7a0b\uff0c\u901a\u8fc7\u4fee\u6539\u673a\u5668\u7801\u4e2d\u7684\u7acb\u5373\u6570\u6765\u66f4\u65b0\u8ddd\u79bb\u3002</li> <li>\u968f\u540e\u6062\u590d\u8fdb\u7a0b\u6267\u884c\uff0c\u5e76\u4f7f\u7528<code>perf stat</code>\u76d1\u63a7\u7ea60.3\u79d2\u7684IPC\u4f5c\u4e3a\u8be5\u8ddd\u79bb\u7684\u6027\u80fd\u8bc4\u4f30\u3002</li> <li>\u8fd9\u4e9b\u64cd\u4f5c\u901a\u8fc7<code>libpg2</code>\u5e93\u5728\u76ee\u6807\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u5185\u9ad8\u6548\u5b8c\u6210\uff0c\u5355\u6b21\u8ddd\u79bb\u8c03\u6574\u7684\u505c\u987f\u65f6\u95f4\u4ec5\u4e3a1.1-1.4ms\uff08\u89c1\u88682\uff09\u3002</li> <li></li> </ul> <p></p> <ul> <li>\u56de\u6eda\u673a\u5236 (Rolling Back)</li> <li>\u5982\u679c\u5728\u6574\u4e2a\u641c\u7d22\u7ed3\u675f\u540e\uff0c\u672a\u80fd\u627e\u5230\u4efb\u4f55\u4e00\u4e2a\u9884\u53d6\u8ddd\u79bb\u80fd\u4f7fIPC\u8d85\u8d8a\u539f\u59cb\u57fa\u7ebf\uff0c\u5219\u89e6\u53d1\u56de\u6eda\u3002</li> <li>RPG2\u4f1a\u5229\u7528BOLT Address Translation Table (BATT) \u5c06\u6240\u6709\u7ebf\u7a0b\u7684\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\uff09\u4ece\u4f18\u5316\u540e\u7684\u51fd\u6570\uff08<code>f1</code>\uff09\u6620\u5c04\u56de\u539f\u59cb\u51fd\u6570\uff08<code>f0</code>\uff09\u3002</li> <li>\u5bf9\u4e8e\u6070\u597d\u6267\u884c\u5728\u9884\u53d6\u5185\u6838\u4e2d\u7684\u7ebf\u7a0b\uff0c\u7531\u4e8eBATT\u4e2d\u65e0\u5bf9\u5e94\u6761\u76ee\uff0cRPG2\u4f1a\u4f7f\u7528<code>ptrace</code>\u8fdb\u884c\u5355\u6b65\u6267\u884c\uff0c\u76f4\u5230PC\u56de\u5230\u6709\u6620\u5c04\u5173\u7cfb\u7684\u4ee3\u7801\u4f4d\u7f6e\u3002</li> <li>\u6b64\u673a\u5236\u786e\u4fdd\u4e86\u5373\u4f7f\u9884\u53d6\u6709\u5bb3\uff0c\u7cfb\u7edf\u4e5f\u80fd\u5728\u51e0\u79d2\u5185\u6062\u590d\u5230\u539f\u59cb\u6027\u80fd\u6c34\u5e73\uff0c\u4f53\u73b0\u4e86\u5176\u9c81\u68d2\u6027\uff08\u89c1\u56fe10\u53f3\uff09\u3002</li> <li></li> </ul> <p></p> <p>Figure 10. RPG2\u2019s impact on IPC over time.</p> <p>\u5f53\u524d\u9650\u5236\u4e0e\u672a\u6765\u65b9\u5411</p> <p>\u5c3d\u7ba1\u8be5\u8c03\u4f18\u673a\u5236\u9ad8\u6548\u4e14\u6709\u6548\uff0c\u4f46\u4ecd\u5b58\u5728\u4e00\u4e9b\u9650\u5236\u3002</p> <ul> <li>\u5355\u4e00\u8ddd\u79bb\u5047\u8bbe\uff1a\u4e3a\u4e86\u63a7\u5236\u641c\u7d22\u590d\u6742\u5ea6\uff0cRPG2\u76ee\u524d\u5f3a\u5236\u6240\u6709\u9884\u53d6\u70b9\u4f7f\u7528\u76f8\u540c\u7684\u9884\u53d6\u8ddd\u79bb\u3002\u7136\u800c\uff0c\u5bf9\u4e8e\u50cf<code>sssp</code>\u8fd9\u6837\u5305\u542b\u591a\u4e2a\u72ec\u7acb\u9884\u53d6\u70b9\u7684\u7a0b\u5e8f\uff0c\u975e\u5bf9\u79f0\u7684\u8ddd\u79bb\u914d\u7f6e\u53ef\u80fd\u66f4\u4f18\uff08\u89c1\u56fe13\uff09\u3002</li> <li></li> </ul> <p></p> <p>Figure 13. The relationship between multiple loads\u2019 prefetch distances and performance for sssp running the p2pGnutella05 input on Cascade Lake.</p> <ul> <li>\u641c\u7d22\u7a7a\u95f4\u5e73\u6ed1\u6027\u5047\u8bbe\uff1a\u7b97\u6cd5\u5047\u8bbeIPC\u968f\u9884\u53d6\u8ddd\u79bb\u7684\u53d8\u5316\u662f\u76f8\u5bf9\u5e73\u6ed1\u7684\u3002\u4f46\u5728\u67d0\u4e9b\u7279\u6b8a\u573a\u666f\u4e0b\uff08\u5982<code>randacc</code>\u57fa\u51c6\u6d4b\u8bd5\uff09\uff0c\u6027\u80fd\u66f2\u7ebf\u53ef\u80fd\u5b58\u5728\u5c16\u9510\u7684\u5cf0\u503c\uff08\u4ec5\u5728\u7279\u5b9a\u8ddd\u79bb\u59828\u7684\u500d\u6570\u65f6\u6027\u80fd\u6fc0\u589e\uff09\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u641c\u7d22\u7b97\u6cd5\u9519\u8fc7\u6700\u4f18\u89e3\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#4","title":"4. \u5b89\u5168\u56de\u6eda\u673a\u5236","text":"<p>\u5b89\u5168\u56de\u6eda\u673a\u5236\u7684\u5b9e\u73b0\u539f\u7406</p> <ul> <li>RPG2 \u7684\u5b89\u5168\u56de\u6eda\u673a\u5236\u662f\u5176 \u9c81\u68d2\u6027 (robustness) \u7684\u6838\u5fc3\u4fdd\u969c\uff0c\u65e8\u5728\u5f53\u52a8\u6001\u63d2\u5165\u7684\u9884\u53d6\u4ee3\u7801\u5bf9\u6027\u80fd\u4ea7\u751f\u8d1f\u9762\u5f71\u54cd\u65f6\uff0c\u80fd\u591f\u65e0\u7f1d\u5730\u5c06\u7a0b\u5e8f\u6267\u884c\u6062\u590d\u5230\u539f\u59cb\u3001\u672a\u4f18\u5316\u7684\u72b6\u6001\u3002</li> <li>\u8be5\u673a\u5236\u4f9d\u8d56\u4e8e\u4e24\u4e2a\u5173\u952e\u6280\u672f\uff1a\u4ee3\u7801\u7248\u672c\u5171\u5b58\u548c BOLT Address Translation Table (BATT)\u3002</li> <li>\u5728 Phase 3: Runtime Code Insertion \u9636\u6bb5\uff0cRPG2 \u5e76\u975e\u76f4\u63a5\u8986\u76d6\u539f\u59cb\u51fd\u6570 <code>f0</code>\uff0c\u800c\u662f\u5728\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u4e2d\u5206\u914d\u65b0\u5185\u5b58\uff0c\u5c06\u5305\u542b\u9884\u53d6\u5185\u6838\u7684\u4f18\u5316\u51fd\u6570 <code>f1</code> \u653e\u7f6e\u4e8e\u6b64\u3002\u539f\u59cb\u51fd\u6570 <code>f0</code> \u88ab\u5b8c\u6574\u4fdd\u7559\u3002</li> <li>\u8fd9\u79cd\u8bbe\u8ba1\u4f7f\u5f97\u56de\u6eda\u64cd\u4f5c\u5728\u6982\u5ff5\u4e0a\u53d8\u5f97\u7b80\u5355\uff1a\u53ea\u9700\u5c06\u6240\u6709\u6307\u5411 <code>f1</code> \u7684\u6267\u884c\u6d41\u91cd\u65b0\u5bfc\u5411\u56de <code>f1</code> \u5373\u53ef\u3002</li> </ul> <p>\u56de\u6eda\u89e6\u53d1\u6761\u4ef6\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <ul> <li>\u56de\u6eda\u7684\u51b3\u7b56\u53d1\u751f\u5728 Phase 4: Monitoring And Tuning \u9636\u6bb5\u3002</li> <li>RPG2 \u901a\u8fc7\u4e00\u4e2a\u4e09\u9636\u6bb5\u7684\u641c\u7d22\u7b97\u6cd5\uff08\u786e\u5b9a\u65b9\u5411\u3001\u7c97\u7c92\u5ea6\u91c7\u6837\u3001\u4e8c\u5206\u67e5\u627e\uff09\u5728 <code>[1, 200]</code> \u7684\u8303\u56f4\u5185\u63a2\u7d22\u6700\u4f18\u7684 prefetch distance\u3002</li> <li>\u5728\u6574\u4e2a\u641c\u7d22\u8fc7\u7a0b\u4e2d\uff0cRPG2 \u6301\u7eed\u76d1\u63a7\u7a0b\u5e8f\u7684 IPC (Instructions Per Cycle) \u4f5c\u4e3a\u6027\u80fd\u6307\u6807\u3002</li> <li>\u56de\u6eda\u89e6\u53d1\u6761\u4ef6\uff1a\u5f53\u641c\u7d22\u7b97\u6cd5\u5b8c\u6210\uff0c\u5e76\u4e14\u53d1\u73b0\u6240\u6709\u88ab\u6d4b\u8bd5\u8fc7\u7684\u9884\u53d6\u8ddd\u79bb\u914d\u7f6e\u6240\u4ea7\u751f\u7684 IPC \u5747\u672a\u8d85\u8fc7\u539f\u59cb\u57fa\u7ebf IPC \u65f6\uff0cRPG2 \u5224\u5b9a\u9884\u53d6\u6709\u5bb3\uff0c\u5e76\u542f\u52a8\u56de\u6eda\u6d41\u7a0b\u3002</li> <li>\u56de\u6eda\u7684\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a<ul> <li>RPG2 \u901a\u8fc7 <code>ptrace</code> \u6682\u505c\u76ee\u6807\u8fdb\u7a0b\u3002</li> <li>\u5229\u7528 BATT \u5c06\u6240\u6709\u5df2\u4fee\u6539\u7684\u76f4\u63a5\u8c03\u7528\u70b9\u4ece <code>f1</code> \u7684\u5165\u53e3\u5730\u5740\u6062\u590d\u4e3a <code>f0</code> \u7684\u5165\u53e3\u5730\u5740\u3002</li> <li>\u5bf9\u4e8e\u5f53\u524d\u6b63\u5728 <code>f1</code> \u4e2d\u6267\u884c\u7684\u7ebf\u7a0b\uff0c\u9700\u8981\u5c06\u5176 Program Counter (PC) \u4ece <code>f1</code> \u4e2d\u7684\u4f4d\u7f6e\u6620\u5c04\u56de <code>f0</code> \u4e2d\u7684\u7b49\u6548\u4f4d\u7f6e\u3002\u8fd9\u6b63\u662f BATT \u7684\u6838\u5fc3\u4f5c\u7528\u3002</li> </ul> </li> </ul> <p>BATT \u7684\u5173\u952e\u4f5c\u7528\u4e0e\u7279\u6b8a\u5904\u7406</p> <ul> <li>BATT (BOLT Address Translation Table) \u662f\u7531 BOLT \u5de5\u5177\u5728\u751f\u6210\u4f18\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\u65f6\u5d4c\u5165\u7684\u4e00\u4e2a\u6620\u5c04\u8868\uff0c\u5b83\u8bb0\u5f55\u4e86\u539f\u59cb\u51fd\u6570 <code>f0</code> \u4e2d\u6bcf\u6761\u6307\u4ee4\u7684\u5730\u5740\u4e0e\u5176\u5728\u4f18\u5316\u540e\u51fd\u6570 <code>f1</code> \u4e2d\u5bf9\u5e94\u6307\u4ee4\u5730\u5740\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</li> <li>\u5bf9\u4e8e\u5e38\u89c4\u7684\u4ee3\u7801\u8def\u5f84\uff0cBATT \u63d0\u4f9b\u4e86\u4ece <code>f1</code> \u5230 <code>f0</code> \u7684\u53cd\u5411\u6620\u5c04\u80fd\u529b\uff0c\u4f7f\u5f97 PC \u7684\u91cd\u5b9a\u5411\u6210\u4e3a\u53ef\u80fd\u3002</li> <li>\u7279\u6b8a Corner Case \u5904\u7406\uff1a\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u7684 PC \u6b63\u597d\u4f4d\u4e8e prefetch kernel \u5185\u90e8\uff0c\u7531\u4e8e\u8fd9\u6bb5\u4ee3\u7801\u5728 <code>f0</code> \u4e2d\u4e0d\u5b58\u5728\uff0cBATT \u4e2d\u81ea\u7136\u6ca1\u6709\u5bf9\u5e94\u7684\u6620\u5c04\u6761\u76ee\u3002</li> <li>\u4e3a\u89e3\u51b3\u6b64\u95ee\u9898\uff0cRPG2 \u91c7\u7528\u4e86\u4e00\u79cd\u5de7\u5999\u7684\u7b56\u7565\uff1a\u5b83\u4e0d\u5c1d\u8bd5\u76f4\u63a5\u6620\u5c04\uff0c\u800c\u662f\u5229\u7528 <code>ptrace</code> \u7684 single-step \u529f\u80fd\uff0c\u8ba9\u76ee\u6807\u8fdb\u7a0b\u5355\u6b65\u6267\u884c\uff0c\u76f4\u5230 PC \u79bb\u5f00 prefetch kernel \u5e76\u5230\u8fbe <code>f1</code> \u4e2d\u4e00\u6bb5\u5728 <code>f0</code> \u91cc\u4e5f\u5b58\u5728\u7684\u4ee3\u7801\u533a\u57df\u3002\u6b64\u65f6\uff0cBATT \u4e2d\u4fbf\u5b58\u5728\u6709\u6548\u7684\u6620\u5c04\u6761\u76ee\uff0c\u53ef\u4ee5\u5b89\u5168\u5730\u5b8c\u6210 PC \u7684\u8f6c\u6362\u3002</li> </ul> <p></p> <p>Figure 6. The PC register and code memory of the target process before and after, RPG2\u2019s code replacement.</p> <p>\u5728\u6574\u4f53\u7cfb\u7edf\u4e2d\u7684\u4f5c\u7528\u4e0e\u4ef7\u503c</p> <ul> <li>\u5b89\u5168\u56de\u6eda\u673a\u5236\u5c06\u9884\u53d6\u8fd9\u4e00\u201c\u53cc\u5203\u5251\u201d\u5f0f\u7684\u4f18\u5316\u8f6c\u53d8\u4e3a\u4e00\u79cd \u96f6\u98ce\u9669\u6216\u8d1f\u98ce\u9669 \u7684\u64cd\u4f5c\u3002\u5f00\u53d1\u8005\u6216\u7cfb\u7edf\u65e0\u9700\u62c5\u5fc3\u56e0\u9519\u8bef\u7684\u9884\u53d6\u914d\u7f6e\u800c\u5bfc\u81f4\u4e25\u91cd\u7684\u6027\u80fd\u4e0b\u964d\u3002</li> <li>\u5b83\u4f7f\u5f97 RPG2 \u80fd\u591f\u5927\u80c6\u5730\u8fdb\u884c\u5728\u7ebf\u63a2\u7d22\u548c\u4f18\u5316\uff0c\u5373\u4f7f\u5728\u9762\u5bf9 \u8f93\u5165\u654f\u611f (input-sensitive) \u6216 \u5fae\u67b6\u6784\u654f\u611f (microarchitecture-sensitive) \u7684\u5de5\u4f5c\u8d1f\u8f7d\u65f6\uff08\u5982 Figure 2 \u548c Figure 3 \u6240\u793a\uff09\uff0c\u4e5f\u80fd\u4fdd\u8bc1\u6700\u574f\u60c5\u51b5\u4e0b\u6027\u80fd\u4e0d\u4f1a\u4f4e\u4e8e\u539f\u59cb\u57fa\u7ebf\u3002</li> <li>\u8fd9\u4e00\u673a\u5236\u662f RPG2 \u533a\u522b\u4e8e\u4f20\u7edf \u9759\u6001\u7f16\u8bd1\u5668\uff08\u5982 APT-GET\uff09\u7684\u5173\u952e\u4f18\u52bf\u3002\u9759\u6001\u65b9\u6cd5\u4e00\u65e6\u751f\u6210\u4e86\u6709\u5bb3\u7684\u9884\u53d6\u4ee3\u7801\uff0c\u4fbf\u65e0\u6cd5\u5728\u8fd0\u884c\u65f6\u7ea0\u6b63\uff0c\u800c RPG2 \u5219\u5177\u5907\u4e86 \u81ea\u9002\u5e94 \u548c \u81ea\u6211\u4fee\u590d \u7684\u80fd\u529b\u3002</li> <li>\u6700\u7ec8\uff0c\u8be5\u673a\u5236\u786e\u4fdd\u4e86 RPG2 \u7684\u6838\u5fc3\u627f\u8bfa\uff1aPreserving its performance benefits, while avoiding slowdowns\uff08\u4fdd\u7559\u6027\u80fd\u6536\u76ca\uff0c\u540c\u65f6\u907f\u514d\u51cf\u901f\uff09\u3002</li> </ul>"},{"location":"notes_repo/rpg2-robust-profile-guided-runtime-prefetch-generation/paper_notes/#4_1","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u786c\u4ef6\u5e73\u53f0\uff1a\u5b9e\u9a8c\u5728\u4e24\u53f0\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u3002</li> <li>Intel Cascade Lake: \u53cc\u8def Xeon Gold 6230R\uff0c\u6bcf\u8def26\u683852\u7ebf\u7a0b\uff0c2.1GHz\uff1bL3\u7f13\u5b5836MiB\uff1b384GiB RAM\u3002</li> <li>Intel Haswell: \u53cc\u8def Xeon E5-2618L v3\uff0c\u6bcf\u8def8\u683816\u7ebf\u7a0b\uff0c2.3GHz\uff1bL3\u7f13\u5b5820MiB\uff1b128GiB RAM\u3002</li> <li>\u4e24\u53f0\u673a\u5668\u5747\u542f\u7528\u6240\u6709\u53ef\u7528\u7684 hardware prefetchers\u3002</li> <li>\u8f6f\u4ef6\u73af\u5883\uff1aLinux 5.40\uff0c\u4f7f\u7528 Clang 10.0 \u7f16\u8bd1\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5e76\u94fe\u63a5 <code>-Wl,--emit-relocs</code> \u4ee5\u652f\u6301 BOLT\u3002</li> <li>\u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6\uff1a</li> <li>CRONO \u5957\u4ef6\uff1a\u5305\u542b BFS\u3001PR\u3001BC\u3001SSSP \u56db\u4e2a\u56fe\u7b97\u6cd5\u57fa\u51c6\uff0c\u4f7f\u7528\u6765\u81ea SNAP \u768471\u4e2a\u771f\u5b9e\u4e16\u754c\u56fe\u6570\u636e\u96c6\u548c\u90e8\u5206\u5408\u6210\u6570\u636e\u3002</li> <li>AJ benchmarks\uff1a\u5305\u542b IS\u3001CG\u3001randAccess\uff0c\u4f7f\u7528 Ainsworth and Jones \u8bba\u6587\u4e2d\u7684\u8f93\u5165\u3002</li> <li>\u5de5\u4f5c\u8d1f\u8f7d\u914d\u7f6e\uff1a\u6240\u6709\u57fa\u51c6\u5747\u4f7f\u7528 <code>-O3</code> \u4f18\u5316\uff0c\u5e76\u5ef6\u957f\u8fd0\u884c\u65f6\u95f4\u81f3\u81f3\u5c111\u5206\u949f\u3002\u901a\u8fc7\u4fee\u6539\u4ee3\u7801\u624b\u52a8\u6807\u8bb0\u521d\u59cb\u5316\u9636\u6bb5\u7ed3\u675f\uff0c\u4ee5\u786e\u4fdd RPG2 \u5728\u4e3b\u8ba1\u7b97\u9636\u6bb5\u8fdb\u884c\u5206\u6790\u3002</li> <li>RPG2 \u914d\u7f6e\uff1a</li> <li>Profiling\uff1a\u901a\u8fc7 PEBS \u91c7\u6837 LLC misses\uff0c\u6301\u7eed2\u79d2\u3002</li> <li>Tuning\uff1a\u6bcf\u6b21 IPC \u6d4b\u91cf\u6301\u7eed0.3\u79d2\u3002</li> <li>\u5bf9\u6bd4\u57fa\u7ebf (Baselines)\uff1a</li> <li>APT-GET\uff1a\u6700\u65b0\u7684 profile-guided \u9759\u6001\u7f16\u8bd1\u5668\uff0c\u4e3a\u4e00\u4e2a\u968f\u673a\u8f93\u5165\u751f\u6210\u4e8c\u8fdb\u5236\u6587\u4ef6\u5e76\u5728\u5176\u4ed6\u8f93\u5165\u4e0a\u8fd0\u884c\u3002</li> <li>manual prefetching\uff1a\u4ec5\u5728 AJ benchmarks \u4e2d\u53ef\u7528\u3002</li> <li>RPG2 active-only\uff1a\u4ec5\u5305\u542b\u6210\u529f\u6fc0\u6d3b\u4f18\u5316\u7684\u8fd0\u884c\u7ed3\u679c\u3002</li> <li>offline RPG2\uff1a\u4e3a\u6bcf\u4e2a\u8f93\u5165\u624b\u52a8\u751f\u6210\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4f5c\u4e3a\u6027\u80fd\u4e0a\u9650\u3002</li> </ul> <p>\u7ed3\u679c\u6570\u636e\u5206\u6790</p> <ul> <li>\u6574\u4f53\u6027\u80fd\u8868\u73b0\uff1a</li> </ul> <p></p> <p>Figure 7. RPG2 and baseline performance on Cascade Lake (top) and Haswell (bottom).</p> <ul> <li>\u5728 speedup group\uff08RPG2 \u80fd\u63d0\u5347\u6027\u80fd\u7684\u8f93\u5165\uff09\u4e2d\uff0cRPG2 \u7684\u6027\u80fd\u589e\u76ca\u4e0e APT-GET \u548c offline \u65b9\u6848\u76f8\u5f53\uff0c\u8bc1\u660e\u5176\u5728\u7ebf\u8c03\u4f18\u7684\u6709\u6548\u6027\u3002</li> <li>\u5728 slowdown group\uff08\u9884\u53d6\u4f1a\u635f\u5bb3\u6027\u80fd\u7684\u8f93\u5165\uff09\u4e2d\uff0cRPG2 \u7684\u4f18\u52bf\u663e\u8457\u3002\u5b83\u80fd\u68c0\u6d4b\u5230\u6027\u80fd\u4e0b\u964d\u5e76 roll back \u5230\u539f\u59cb\u4ee3\u7801\uff0c\u4ece\u800c\u51e0\u4e4e\u5b8c\u5168\u907f\u514d\u4e86\u6027\u80fd\u635f\u5931\uff0c\u800c APT-GET \u548c offline \u5219\u906d\u53d7\u4e25\u91cd\u51cf\u901f\u3002</li> <li>RPG2 (all) \u4e0e RPG2 active-only \u4e4b\u95f4\u7684\u5dee\u8ddd\u6e90\u4e8e\u5728\u7ebf\u5206\u6790\u7684\u566a\u58f0\uff0c\u6709\u65f6\u65e0\u6cd5\u6536\u96c6\u5230\u8db3\u591f\u7684 LLC miss \u6837\u672c\u4ee5\u6fc0\u6d3b\u4f18\u5316\u3002</li> <li>\u9884\u53d6\u8ddd\u79bb\u641c\u7d22\u7cbe\u5ea6\uff1a</li> </ul> <p></p> <p>Figure 8. How close RPG2 gets to the optimal prefetch distance, for inputs with a single optimal distance.</p> <ul> <li>\u5728120\u4e2a\u5177\u6709\u5355\u4e00\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\u7684\u8f93\u5165\u4e2d\uff0cRPG2 \u7684\u641c\u7d22\u7ed3\u679c\u6709\u8d85\u8fc7\u4e00\u534a\u843d\u5728\u6700\u4f18\u503c\u00b110\u7684\u8303\u56f4\u5185\uff0c\u8868\u660e\u5176\u641c\u7d22\u7b97\u6cd5\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u662f\u6709\u6548\u7684\u3002</li> <li>\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u662f noisy IPC measurements\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u641c\u7d22\u8fc7\u65e9\u7ec8\u6b62\u3002</li> <li>\u5fae\u67b6\u6784\u5c42\u9762\u9a8c\u8bc1\uff1a</li> <li>LLC MPKI\uff1a</li> </ul> <p></p> <p>Figure 11. The relationship between speedup and LLC MPKI for pr on Cascade Lake.</p> <p>RPG2 \u6210\u529f\u964d\u4f4e\u4e86 LLC MPKI\uff0c\u4f46 MPKI \u7684\u964d\u4f4e\u5e45\u5ea6\u4e0e\u6700\u7ec8 speedup \u4e4b\u95f4\u6ca1\u6709\u5f3a\u76f8\u5173\u6027\uff0c\u6697\u793a\u6027\u80fd\u63d0\u5347\u8fd8\u6d89\u53ca DRAM \u5e26\u5bbd\u7b49\u5176\u4ed6\u56e0\u7d20\u3002   - \u52a8\u6001\u6307\u4ee4\u6570\u5f00\u9500\uff1a</p> <p></p> <p>Figure 12. RPG2\u2019s impact on dynamic instruction count for pr on Cascade Lake.</p> <p>\u7531\u4e8e\u63d2\u5165\u4e86\u9884\u53d6\u5185\u6838\uff08prefetch kernel\uff09\uff0c\u52a8\u6001\u6307\u4ee4\u6570\u5e73\u5747\u589e\u52a0\u4e0d\u523015%\uff0c\u6700\u574f\u60c5\u51b5\u4e3a37%\u3002RPG2 \u7684\u6027\u80fd\u589e\u76ca\u5df2\u514b\u670d\u4e86\u8fd9\u90e8\u5206\u5f00\u9500\u3002 - \u8fd0\u884c\u65f6\u884c\u4e3a\uff1a</p> <p></p> <p>Figure 10. RPG2\u2019s impact on IPC over time.</p> <ul> <li>RPG2 \u80fd\u5728\u51e0\u79d2\u5185\u5b8c\u6210\u5206\u6790\u3001\u6ce8\u5165\u548c\u8c03\u4f18\u3002\u5728\u6709\u76ca\u573a\u666f\u4e0b\uff0cIPC \u663e\u8457\u63d0\u5347\uff1b\u5728\u6709\u5bb3\u573a\u666f\u4e0b\uff0c\u7ecf\u8fc7\u77ed\u6682\u63a2\u7d22\u540e\u80fd\u6210\u529f\u56de\u6eda\uff0c\u6062\u590d\u539f\u59cb\u6027\u80fd\u3002</li> <li>\u64cd\u4f5c\u5ef6\u8fdf\uff1a</li> </ul> <p></p> <ul> <li>BOLT \u4ee3\u7801\u751f\u6210\uff1a\u7ea630\u6beb\u79d2\uff0c\u5728\u540e\u53f0\u5b8c\u6210\u3002</li> <li>Stop-the-world \u64cd\u4f5c\uff1a<ul> <li>\u521d\u59cb\u4ee3\u7801\u63d2\u5165\uff1a3-4\u6beb\u79d2\u3002</li> <li>\u5355\u6b21\u9884\u53d6\u8ddd\u79bb\u8c03\u6574\uff1a1.1-1.4\u6beb\u79d2\u3002</li> <li>\u5e73\u5747\u63a2\u7d2211-12\u4e2a\u8ddd\u79bb\u70b9\u3002</li> </ul> </li> <li>\u8fd9\u4e9b\u4f4e\u5ef6\u8fdf\u4fdd\u8bc1\u4e86 RPG2 \u5728\u7ebf\u64cd\u4f5c\u5bf9\u7a0b\u5e8f\u6574\u4f53\u6027\u80fd\u7684\u5e72\u6270\u6781\u5c0f\u3002</li> </ul> <p>\u6d88\u878d\u5b9e\u9a8c\u4e0e\u654f\u611f\u6027\u5206\u6790</p> <ul> <li>Profiling \u65f6\u957f\u7684\u5f71\u54cd\uff1a</li> </ul> <p></p> <p>Figure 9. The impact of profiling phase duration on RPG2\u2019s optimization activation.</p> <ul> <li>\u9ed8\u8ba4 profiling \u65f6\u957f\u4e3a2\u79d2\u3002\u5b9e\u9a8c\u8868\u660e\uff0c\u66f4\u957f\u7684 profiling \u65f6\u95f4\u80fd\u7565\u5fae\u63d0\u9ad8\u4f18\u5316\u6fc0\u6d3b\u7684\u6210\u529f\u7387\uff08\u201calways\u201d\u6bd4\u4f8b\u4e0a\u5347\uff09\uff0c\u4f46\u6839\u636e Amdahl\u2019s Law\uff0c\u8fc7\u957f\u7684\u5206\u6790\u65f6\u95f4\u4f1a\u51cf\u5c11\u53ef\u7528\u4e8e\u52a0\u901f\u7684\u6267\u884c\u65f6\u95f4\u30022\u79d2\u88ab\u8bc1\u660e\u662f\u4e00\u4e2a\u5408\u7406\u7684\u6298\u8877\u3002</li> <li>\u9884\u53d6\u8ddd\u79bb\u7684\u654f\u611f\u6027\uff1a</li> </ul> <p></p> <ul> <li>\u5bf9\u6240\u6709\u8f93\u5165\u5728 [1,100] \u8303\u56f4\u5185\u7a77\u4e3e\u9884\u53d6\u8ddd\u79bb\uff0c\u53d1\u73b0\u4ec5\u6709\u5c11\u6570\u8f93\u5165\u5448\u73b0\u6613\u4e8e\u4f18\u5316\u7684 asymptotic \u884c\u4e3a\u3002</li> <li>\u5927\u91cf\u8f93\u5165\u5c5e\u4e8e single optimal \u6216 range optimal\uff0c\u9700\u8981\u7cbe\u786e\u641c\u7d22\u3002</li> <li>\u8f93\u5165\u7684\u884c\u4e3a\u5728\u4e0d\u540c\u5fae\u67b6\u6784\uff08Haswell vs. Cascade Lake\uff09\u4e0a\u4e0d\u7a33\u5b9a\uff0c\u51f8\u663e\u4e86\u52a8\u6001\u9002\u5e94\u7684\u5fc5\u8981\u6027\u3002</li> <li>\u591a\u8d1f\u8f7d\u9884\u53d6\u8ddd\u79bb\uff1a</li> </ul> <p></p> <p>Figure 13. The relationship between multiple loads\u2019 prefetch distances and performance for sssp running the p2pGnutella05 input on Cascade Lake.</p> <ul> <li>\u5bf9\u4e8e SSSP\uff08\u5305\u542b\u4e24\u4e2a\u53ef\u9884\u53d6\u8d1f\u8f7d\uff09\u7684\u5206\u6790\u8868\u660e\uff0casymmetric \u9884\u53d6\u8ddd\u79bb\uff08\u5373\u4e3a\u4e24\u4e2a\u8d1f\u8f7d\u8bbe\u7f6e\u4e0d\u540c\u8ddd\u79bb\uff09\u6709\u65f6\u80fd\u5e26\u6765\u6bd4 symmetric\uff08RPG2 \u5f53\u524d\u7b56\u7565\uff09\u66f4\u597d\u7684\u6027\u80fd\u3002</li> <li>\u8fd9\u63ed\u793a\u4e86 RPG2 \u5f53\u524d\u5c06\u6240\u6709\u9884\u53d6\u70b9\u8bbe\u4e3a\u76f8\u540c\u8ddd\u79bb\u7684\u7b56\u7565\u5b58\u5728\u4f18\u5316\u7a7a\u95f4\uff0c\u4f46\u9ad8\u6548\u7684\u591a\u7ef4\u641c\u7d22\u662f\u4e00\u4e2a\u6311\u6218\u3002</li> <li>\u5931\u8d25\u6848\u4f8b\u5206\u6790\uff1a</li> <li>Phase transition \u8bef\u5224\uff1a\u5728\u67d0\u4e9b\u8f93\u5165\uff08\u5982 sssp/as20000102\uff09\u4e2d\uff0c\u7a0b\u5e8f\u672c\u8eab\u5b58\u5728\u4ece\u4f4e IPC \u5230\u9ad8 IPC \u7684\u9636\u6bb5\u8f6c\u6362\u3002RPG2 \u9519\u8bef\u5730\u5c06\u6b64 IPC \u63d0\u5347\u5f52\u56e0\u4e8e\u9884\u53d6\uff0c\u4ece\u800c\u672a\u80fd\u53ca\u65f6\u56de\u6eda\uff0c\u5bfc\u81f4\u6027\u80fd\u53d7\u635f\u3002\u8fd9\u8868\u660e\u5355\u7eaf\u4f9d\u8d56 IPC \u4f5c\u4e3a\u6027\u80fd\u6307\u6807\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u662f\u4e0d\u5145\u5206\u7684\u3002</li> <li>\u975e\u5e73\u6ed1\u641c\u7d22\u7a7a\u95f4\uff1a\u5728 randacc \u57fa\u51c6\u4e2d\uff0c\u4ec5\u5f53\u9884\u53d6\u8ddd\u79bb\u4e3a8\u7684\u500d\u6570\u65f6\u6027\u80fd\u624d\u663e\u8457\u63d0\u5347\uff0c\u641c\u7d22\u7a7a\u95f4\u9ad8\u5ea6\u4e0d\u8fde\u7eed\u3002RPG2 \u5047\u8bbe\u641c\u7d22\u7a7a\u95f4\u76f8\u5bf9\u5e73\u6ed1\u7684\u7b56\u7565\u5728\u6b64\u5931\u6548\uff0c\u9519\u8fc7\u4e86\u6700\u4f18\u89e3\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/ELI5_notes/","title":"TEA: Time-Proportional Event Analysis \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/tea-time-proportional-event-analysis/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4ee5\u524d\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u65e0\u8bba\u662f instruction-driven\uff08\u5982 AMD IBS, Arm SPE\uff09\u8fd8\u662f event-driven\uff08\u5982 PMC \u8ba1\u6570\uff09\uff0c\u90fd\u6709\u4e00\u4e2a\u81f4\u547d\u76f2\u533a\uff1a\u5b83\u4eec\u65e0\u6cd5\u56de\u7b54\u201c\u4e3a\u4ec0\u4e48\u6267\u884c\u8fd9\u4e9b\u5173\u952e\u6307\u4ee4\u82b1\u4e86\u8fd9\u4e48\u591a\u65f6\u95f4\uff1f\u201d</li> <li>Instruction-driven \u7684\u65b9\u6cd5\uff08\u5728 fetch/dispatch \u9636\u6bb5\u6253\u6807\u7b7e\uff09\u4f1a\u4e25\u91cd\u504f\u5411\u90a3\u4e9b\u5361\u5728\u6d41\u6c34\u7ebf\u524d\u7aef\u7684\u6307\u4ee4\uff0c\u800c\u4e0d\u662f\u771f\u6b63\u5361\u4f4f\u6574\u4e2a\u7a0b\u5e8f\u8fdb\u5ea6\u7684\u6307\u4ee4\u3002\u60f3\u8c61\u4e00\u4e0b\uff0c\u4f60\u7684\u5feb\u9012\u8f66\uff08ROB\uff09\u56e0\u4e3a\u524d\u9762\u4e00\u8f86\u8f66\u629b\u951a\uff08stalled at head\uff09\u800c\u52a8\u5f39\u4e0d\u5f97\uff0c\u4f46\u5206\u6790\u5458\u5374\u53ea\u8bb0\u5f55\u540e\u9762\u4e0d\u65ad\u6d8c\u6765\u7684\u3001\u6839\u672c\u4e0a\u4e0d\u4e86\u8def\u7684\u65b0\u5feb\u9012\u5355\uff08dispatched instructions\uff09\uff0c\u8fd9\u663e\u7136\u6293\u9519\u4e86\u91cd\u70b9\u3002</li> <li>Event-driven \u7684\u65b9\u6cd5\uff08\u5355\u7eaf\u8ba1\u6570 cache miss, branch mispredict\uff09\u5219\u5b8c\u5168\u5ffd\u7565\u4e86\u73b0\u4ee3\u5904\u7406\u5668\u7684 latency hiding \u80fd\u529b\u3002\u4e00\u4e2a cache miss \u53d1\u751f\u4e86\uff0c\u4f46\u5982\u679c\u5904\u7406\u5668\u80fd\u540c\u65f6\u5e72\u522b\u7684\u6d3b\uff0c\u8fd9\u4e2a miss \u5bf9\u603b\u65f6\u95f4\u7684\u5f71\u54cd\u53ef\u80fd\u5fae\u4e4e\u5176\u5fae\u3002\u53cd\u4e4b\uff0c\u4e00\u4e2a\u6ca1\u88ab\u8ba1\u6570\u7684\u4e8b\u4ef6\u5982\u679c\u6070\u597d\u53d1\u751f\u5728\u5173\u952e\u8def\u5f84\u4e0a\uff0c\u5c31\u80fd\u8ba9\u6574\u4e2a\u7a0b\u5e8f\u505c\u6446\u3002\u6240\u4ee5\uff0c\u4e8b\u4ef6\u8ba1\u6570\u548c\u5b83\u5bf9\u6027\u80fd\u7684\u771f\u5b9e\u5f71\u54cd\u4e4b\u95f4\uff0c\u5e38\u5e38\u6ca1\u6709\u5f3a\u76f8\u5173\u6027\uff08\u89c1\u56fe7\uff09\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u8fd9\u7bc7\u8bba\u6587\u63d0\u51fa\u7684 TEA (Time-Proportional Event Analysis)\uff0c\u5c31\u50cf\u662f\u7ed9 CPU \u7684 commit stage\uff08\u9000\u4f11\u529e\u516c\u5ba4\uff09\u88c5\u4e86\u4e00\u4e2a\u5e26\u201c\u75c5\u56e0\u8bca\u65ad\u201d\u7684\u6253\u5361\u673a\u3002</li> <li>\u4f20\u7edf\u7684 profiler\uff08\u6bd4\u5982 TIP\uff09\u53ea\u662f\u8bb0\u5f55\u201c\u8c01\u5728\u9000\u4f11\u529e\u516c\u5ba4\u95e8\u53e3\u6392\u961f\u201d\uff0c\u544a\u8bc9\u4f60\u54ea\u4e9b\u6307\u4ee4\u662f\u74f6\u9888\uff08Q1\uff09\u3002\u4f46\u5b83\u4e0d\u77e5\u9053\u8fd9\u4e9b\u4eba\u4e3a\u4ec0\u4e48\u6392\u961f\u3002</li> <li>TEA \u5219\u66f4\u8fdb\u4e00\u6b65\uff1a\u5f53\u67d0\u6761\u6307\u4ee4\u5728\u9000\u4f11\u529e\u516c\u5ba4\u95e8\u53e3\u6392\u961f\u65f6\uff08\u5373\u66b4\u9732\u4e86\u5ef6\u8fdf\uff09\uff0c\u8fd9\u4e2a\u6253\u5361\u673a\u4f1a\u7acb\u523b\u7ffb\u51fa\u8fd9\u6761\u6307\u4ee4\u4ece\u51fa\u751f\uff08fetch\uff09\u5230\u73b0\u5728\u7684\u5b8c\u6574\u201c\u75c5\u5386\u201d\uff08Performance Signature Vector, PSV\uff09\uff0c\u770b\u770b\u5b83\u4e00\u8def\u4e0a\u7ecf\u5386\u4e86\u54ea\u4e9b\u201c\u75c5\u75c7\u201d\uff08performance events\uff09\uff0c\u6bd4\u5982\u662f\u4e0d\u662f\u5f97\u4e86\u201cL1 cache miss\u201d\u6216\u8005\u201cbranch mispredict\u201d\u3002</li> <li>\u6700\u7ec8\uff0cTEA \u7ed9\u6bcf\u4e2a\u9759\u6001\u6307\u4ee4\u751f\u6210\u4e00\u4efd PICS (Per-Instruction Cycle Stacks)\uff0c\u8fd9\u4efd\u62a5\u544a\u4e0d\u4ec5\u544a\u8bc9\u4f60\u8fd9\u4e2a\u6307\u4ee4\u603b\u5171\u803d\u8bef\u4e86\u591a\u5c11\u65f6\u95f4\uff08\u9ad8\u5ea6\uff09\uff0c\u8fd8\u628a\u8fd9\u6bb5\u65f6\u95f4\u7cbe\u786e\u5730\u5206\u89e3\u6210\u5404\u79cd\u201c\u75c5\u75c7\u201d\u6240\u8d21\u732e\u7684\u90e8\u5206\uff08\u5404\u5c42\u9ad8\u5ea6\uff09\u3002\u8fd9\u5c31\u5b8c\u7f8e\u5730\u540c\u65f6\u56de\u7b54\u4e86 Q1\uff08\u8c01\u662f\u75c5\u4eba\uff09\u548c Q2\uff08\u5f97\u4e86\u4ec0\u4e48\u75c5\uff09\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1a\u8981\u5efa\u7acb\u65f6\u95f4\u4e0e\u4e8b\u4ef6\u4e4b\u95f4\u7684\u56e0\u679c\u5173\u7cfb\uff0c\u91c7\u6837\u70b9\u5fc5\u987b\u5728 commit stage\uff0c\u5e76\u4e14\u8981\u8ffd\u8e2a\u6240\u6709 in-flight \u6307\u4ee4\u7684\u4e8b\u4ef6\u3002</li> <li>\u4e3a\u4e86\u89e3\u51b3 overhead \u95ee\u9898\uff0c\u4ed6\u4eec\u6ca1\u6709\u76f2\u76ee\u8ffd\u8e2a\u6240\u6709\u51e0\u767e\u4e2a PMU \u4e8b\u4ef6\uff0c\u800c\u662f\u56de\u5f52\u7b2c\u4e00\u6027\u539f\u7406\uff0c\u53ea\u5173\u6ce8\u90a3\u4e9b\u80fd\u76f4\u63a5\u5bfc\u81f4 commit stall \u7684\u5173\u952e\u4e8b\u4ef6\uff0c\u5e76\u5229\u7528 performance event hierarchies \u7cbe\u5fc3\u6311\u9009\u4e86 9 \u4e2a\u6700\u5177\u89e3\u91ca\u529b\u7684\u4e8b\u4ef6\uff08\u89c1\u88681\uff09\u3002</li> <li>\u5177\u4f53\u5b9e\u73b0\u4e0a\uff0c\u4ed6\u4eec\u5728\u5904\u7406\u5668\u7684\u5404\u4e2a\u5173\u952e\u6a21\u5757\uff08Fetch, Dispatch, LSU, ROB\uff09\u4e2d\u5d4c\u5165\u903b\u8f91\uff0c\u4e3a\u6bcf\u6761\u52a8\u6001\u6307\u4ee4\uff08\u00b5op\uff09\u7ef4\u62a4\u4e00\u4e2a 9-bit \u7684 PSV\u3002\u8fd9\u4e2a\u5411\u91cf\u4f1a\u968f\u7740\u6307\u4ee4\u5728\u6d41\u6c34\u7ebf\u4e2d\u524d\u8fdb\u800c\u4e0d\u65ad\u66f4\u65b0\uff0c\u8bb0\u5f55\u4e0b\u5b83\u906d\u9047\u7684\u6240\u6709\u5173\u952e\u4e8b\u4ef6\u3002</li> <li>\u5f53\u57fa\u4e8e TIP \u7684\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u5668\u51b3\u5b9a\u5728\u67d0\u4e2a\u5468\u671f\u8fdb\u884c\u91c7\u6837\u65f6\uff0c\u5b83\u4f1a\u6839\u636e\u5f53\u524d\u7684 commit state\uff08Compute, Drained, Stalled, Flushed\uff09\u7cbe\u51c6\u5b9a\u4f4d\u5230\u5e94\u8be5\u4e3a\u6b64\u523b\u5ef6\u8fdf\u8d1f\u8d23\u7684\u90a3\u6761\uff08\u6216\u51e0\u6761\uff09\u6307\u4ee4\uff0c\u7136\u540e\u8fde\u540c\u5b83\u7684 PSV \u4e00\u8d77\u6253\u5305\u4e0a\u62a5\u3002</li> <li>\u901a\u8fc7\u8fd9\u79cd\u8bbe\u8ba1\uff0cTEA \u5de7\u5999\u5730\u5c06 \u65f6\u95f4\u5f52\u5c5e\uff08\u7531 TIP \u89e3\u51b3\uff09\u548c \u4e8b\u4ef6\u5f52\u56e0\uff08\u7531 PSV \u89e3\u51b3\uff09\u65e0\u7f1d\u7ed3\u5408\uff0c\u6700\u7ec8\u4ee5\u6781\u4f4e\u7684\u5f00\u9500\uff08~0.1% \u529f\u8017\uff0c1.1% \u6027\u80fd\uff09\u5b9e\u73b0\u4e86\u524d\u6240\u672a\u6709\u7684\u5206\u6790\u7cbe\u5ea6\uff08\u5e73\u5747\u8bef\u5dee\u4ec5 2.1%\uff0c\u8fdc\u4f18\u4e8e IBS/SPE/RIS \u7684 ~55%\uff09\u3002</li> </ul> <p></p> <p>Table 1: The performance events of TEA, IBS, SPE, and RIS.</p> \u65b9\u6cd5 \u5e73\u5747\u8bef\u5dee \u5b58\u50a8\u5f00\u9500 \u5173\u952e\u7f3a\u9677 TEA 2.1% 249 B \u9700\u8981\u786c\u4ef6\u652f\u6301 NCI-TEA 11.3% - Flush \u573a\u666f\u4e0b\u5f52\u56e0\u9519\u8bef AMD IBS 55.6% ~1 B \u975e\u65f6\u95f4\u6bd4\u4f8b\uff0c\u524d\u7aef\u91c7\u6837\u504f\u5dee Arm SPE 55.5% ~1 B \u975e\u65f6\u95f4\u6bd4\u4f8b\uff0c\u524d\u7aef\u91c7\u6837\u504f\u5dee IBM RIS 56.0% ~1 B \u975e\u65f6\u95f4\u6bd4\u4f8b\uff0c\u524d\u7aef\u91c7\u6837\u504f\u5dee <p>\u6b63\u662f\u8fd9\u79cd\u9ad8\u7cbe\u5ea6\uff0c\u8ba9 TEA \u80fd\u5728 lbm \u548c nab \u8fd9\u6837\u7684\u771f\u5b9e benchmark \u4e2d\u53d1\u73b0\u4f20\u7edf\u5de5\u5177\u65e0\u6cd5\u5b9a\u4f4d\u7684\u6df1\u5c42\u6b21\u6027\u80fd\u95ee\u9898\uff0c\u5e76\u6307\u5bfc\u5f00\u53d1\u8005\u505a\u51fa\u6709\u6548\u7684\u4f18\u5316\uff0c\u5206\u522b\u83b7\u5f97\u4e86 1.28x \u548c 2.45x \u7684\u663e\u8457\u52a0\u901f\u3002</p>"},{"location":"notes_repo/tea-time-proportional-event-analysis/ELI5_notes/#1-time-proportional-per-instruction-cycle-stacks-pics-eli5","title":"1. Time-Proportional Per-Instruction Cycle Stacks (PICS) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4ee5\u524d\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u65e0\u8bba\u662f instruction-driven\uff08\u5982 AMD IBS, Arm SPE\uff09\u8fd8\u662f event-driven\uff08\u5982 PMC \u8ba1\u6570\uff09\uff0c\u90fd\u6709\u4e00\u4e2a\u6839\u672c\u6027\u7684\u201c\u9519\u4f4d\u201d\u95ee\u9898\u3002</li> <li>Instruction-driven \u7684\u96be\u53d7\u4e4b\u5904\uff1a\u5b83\u4eec\u5728\u6307\u4ee4\u521a\u8fdb\u5165\u6d41\u6c34\u7ebf\uff08fetch/dispatch \u9636\u6bb5\uff09\u5c31\u7ed9\u5b83\u201c\u8d34\u6807\u7b7e\u201d\uff0c\u7136\u540e\u8bb0\u5f55\u5b83\u4e00\u751f\u4e2d\u9047\u5230\u7684\u6240\u6709\u4e8b\u4ef6\u3002\u4f46\u95ee\u9898\u662f\uff0c\u4e00\u6761\u6307\u4ee4\u53ef\u80fd\u5728\u524d\u7aef\u5361\u4e86\u5f88\u4e45\uff0c\u4f46\u771f\u6b63\u62d6\u6162\u6574\u4e2a\u7a0b\u5e8f\u7684\u5374\u662f\u53e6\u4e00\u6761\u5728 commit \u9636\u6bb5\u5361\u4f4f\u7684\u6307\u4ee4\u3002\u8fd9\u79cd\u505a\u6cd5\u4f1a\u4e25\u91cd\u9ad8\u4f30\u90a3\u4e9b\u201c\u751f\u4e0d\u9022\u65f6\u201d\uff08\u5728\u9519\u8bef\u65f6\u95f4\u88ab\u53d6\u6307/\u5206\u53d1\uff09\u7684\u6307\u4ee4\u7684\u91cd\u8981\u6027\uff0c\u5bfc\u81f4\u4f60\u4f18\u5316\u4e86\u9519\u8bef\u7684\u76ee\u6807\u3002</li> <li>Event-driven \u7684\u96be\u53d7\u4e4b\u5904\uff1a\u5b83\u53ea\u544a\u8bc9\u4f60\u201c\u53d1\u751f\u4e86\u591a\u5c11\u6b21\u7f13\u5b58\u672a\u547d\u4e2d\u3001\u5206\u652f\u9884\u6d4b\u5931\u8d25\u201d\uff0c\u4f46\u8fd9\u4e9b\u4e8b\u4ef6\u7684\u8ba1\u6570\u548c\u5b83\u4eec\u5bf9\u6574\u4f53\u6267\u884c\u65f6\u95f4\u7684\u771f\u5b9e\u5f71\u54cd\u4e4b\u95f4\u6ca1\u6709\u76f4\u63a5\u5173\u7cfb\u3002\u56e0\u4e3a\u73b0\u4ee3\u5904\u7406\u5668\u6709\u5f3a\u5927\u7684 latency hiding\uff08\u5ef6\u8fdf\u9690\u85cf\uff09\u80fd\u529b\uff0c\u5f88\u591a\u4e8b\u4ef6\u7684\u5f71\u54cd\u88ab\u63a9\u76d6\u4e86\u3002\u4f60\u770b\u5230\u4e00\u4e2a\u5f88\u9ad8\u7684 L1 miss \u8ba1\u6570\uff0c\u4f46\u5b83\u53ef\u80fd\u5bf9\u6027\u80fd\u6beb\u65e0\u5f71\u54cd\uff0c\u800c\u4e00\u4e2a\u4f4e\u9891\u4f46\u81f4\u547d\u7684 pipeline flush \u5374\u88ab\u6df9\u6ca1\u5728\u6570\u636e\u6d77\u6d0b\u91cc\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u5728\u7ba1\u7406\u4e00\u4e2a\u7e41\u5fd9\u7684\u9910\u5385\uff08CPU\uff09\u3002\u4f60\u60f3\u627e\u51fa\u662f\u4ec0\u4e48\u8ba9\u987e\u5ba2\uff08\u7a0b\u5e8f\uff09\u7b49\u5f85\u65f6\u95f4\u53d8\u957f\u3002</li> <li>\u65e7\u65b9\u6cd5\uff08IBS/SPE\uff09 \u5c31\u50cf\u5728\u987e\u5ba2\u4e00\u8fdb\u95e8\uff08fetch\uff09\u5c31\u7ed9\u4ed6\u624b\u8155\u4e0a\u6234\u4e2a\u8ba1\u65f6\u5668\uff0c\u8bb0\u5f55\u4ed6\u4ece\u8fdb\u95e8\u5230\u5750\u4e0b\u70b9\u9910\u671f\u95f4\u9047\u5230\u7684\u6240\u6709\u9ebb\u70e6\uff08\u6bd4\u5982\u7b49\u4f4d\u3001\u627e\u4e0d\u5230\u670d\u52a1\u5458\uff09\u3002\u4f46\u8fd9\u5b8c\u5168\u5ffd\u7565\u4e86\u540e\u53a8\uff08execution/commit\uff09\u624d\u662f\u771f\u6b63\u7684\u74f6\u9888\u3002\u53ef\u80fd\u540e\u53a8\u7684\u4e00\u4e2a\u4e3b\u53a8\uff08\u5173\u952e\u6307\u4ee4\uff09\u624b\u53d7\u4f24\u4e86\uff08stall\uff09\uff0c\u5bfc\u81f4\u6240\u6709\u83dc\u90fd\u51fa\u4e0d\u6765\uff0c\u4f46\u4f60\u7684\u8ba1\u65f6\u5668\u5374\u5728\u8bb0\u5f55\u90a3\u4e9b\u65e9\u5c31\u5750\u597d\u3001\u53ea\u662f\u5728\u95f2\u804a\u7684\u987e\u5ba2\u3002</li> <li>\u65e7\u65b9\u6cd5\uff08PMC\u8ba1\u6570\uff09 \u5c31\u50cf\u4f60\u53ea\u7edf\u8ba1\u201c\u4eca\u5929\u6454\u788e\u4e86\u591a\u5c11\u4e2a\u76d8\u5b50\u201d\u3001\u201c\u670d\u52a1\u5458\u8dd1\u4e86\u591a\u5c11\u8d9f\u201d\u3002\u8fd9\u4e9b\u6570\u636e\u672c\u8eab\u6ca1\u9519\uff0c\u4f46\u65e0\u6cd5\u544a\u8bc9\u4f60\u54ea\u4e2a\u4e8b\u4ef6\u662f\u5bfc\u81f4\u7ffb\u53f0\u7387\uff08\u6027\u80fd\uff09\u4e0b\u964d\u7684\u5143\u51f6\u3002\u4e5f\u8bb8\u6454\u76d8\u5b50\u53d1\u751f\u5728\u5ba2\u6d41\u4f4e\u8c37\uff0c\u5f71\u54cd\u4e0d\u5927\uff1b\u800c\u4e00\u6b21\u5173\u952e\u7684\u98df\u6750\u77ed\u7f3a\uff08pipeline flush\uff09\u867d\u7136\u53ea\u53d1\u751f\u4e00\u6b21\uff0c\u5374\u8ba9\u6574\u4e2a\u9910\u5385\u505c\u6446\u534a\u5c0f\u65f6\u3002</li> <li>TEA \u7684 PICS \u5219\u50cf\u4e00\u4e2a\u806a\u660e\u7684\u7ecf\u7406\uff0c\u4ed6\u53ea\u5728\u4e0a\u83dc\u7a97\u53e3\uff08commit stage\uff09\u89c2\u5bdf\u3002\u6bcf\u5f53\u4e0a\u83dc\u7a97\u53e3\u7a7a\u95f2\uff08stalled/drained/flushed\uff09\uff0c\u4ed6\u5c31\u7acb\u523b\u8bb0\u4e0b\uff1a\u201c\u6b64\u523b\uff0c\u662f\u56e0\u4e3a\u540e\u53a8\u7684\u54ea\u9053\u83dc\uff08\u6307\u4ee4\uff09\u6ca1\u51c6\u5907\u597d\uff1f\u5177\u4f53\u662f\u56e0\u4e3a\u7f3a\u4e86\u54ea\u79cd\u98df\u6750\uff08cache miss\uff09\u8fd8\u662f\u53a8\u5e08\u5207\u9519\u4e86\uff08branch mispredict\uff09\uff1f\u201d \u8fd9\u6837\uff0c\u4ed6\u8bb0\u5f55\u7684\u6bcf\u4e00\u5206\u949f\u7b49\u5f85\uff0c\u90fd\u7cbe\u786e\u5730\u3001\u6309\u65f6\u95f4\u6bd4\u4f8b\u5730\u5bf9\u5e94\u5230\u771f\u6b63\u9020\u6210\u74f6\u9888\u7684\u90a3\u4e2a\u73af\u8282\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u5e76\u6ca1\u6709\u629b\u5f03\u73b0\u6709\u7684\u91c7\u6837\u6846\u67b6\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728 TIP (Time-Proportional Instruction Profiling) \u8fd9\u4e2a\u5df2\u7ecf\u80fd\u51c6\u786e\u5b9a\u4f4d\u201c\u8c01\u5728 commit \u9636\u6bb5\u5361\u4f4f\u201d\u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u4e00\u4e2a Performance Signature Vector (PSV)\u3002</li> <li>\u6838\u5fc3\u903b\u8f91\u8f6c\u6362\uff1a\u4f20\u7edf\u7684\u91c7\u6837\u53ea\u5173\u5fc3\u201c\u54ea\u4e2a\u6307\u4ee4\u5730\u5740\u5728\u5361\u201d\uff0c\u800c TEA \u7684\u91c7\u6837\u5173\u5fc3\u7684\u662f\u201c\u54ea\u4e2a\u6307\u4ee4\u5730\u5740\u5728\u5361\uff0c\u4ee5\u53ca\u5b83\u8eab\u4e0a\u5e26\u7740\u54ea\u4e9b\u2018\u4e8b\u4ef6\u5fbd\u7ae0\u2019\uff08PSV\uff09\u201d\u3002</li> <li>\u5177\u4f53\u6765\u8bf4\uff0cTEA \u5728\u786c\u4ef6\u5c42\u9762\u4e3a\u6bcf\u4e2a in-flight \u6307\u4ee4\uff08ROB entry\uff09\u7ef4\u62a4\u4e00\u4e2a 9-bit \u7684 PSV\uff0c\u8fd9\u4e2a\u5411\u91cf\u4f1a\u968f\u7740\u6307\u4ee4\u5728\u6d41\u6c34\u7ebf\u4e2d\u6d41\u52a8\uff0c\u5b9e\u65f6\u8bb0\u5f55\u5b83\u662f\u5426\u906d\u9047\u4e86\u9884\u5b9a\u4e49\u7684\u5173\u952e\u4e8b\u4ef6\uff08\u5982 ST-L1, FL-MB \u7b49\uff09\u3002</li> <li>\u5f53 TIP \u7684\u91c7\u6837\u903b\u8f91\u5728 commit \u9636\u6bb5\u89e6\u53d1\u65f6\uff0c\u5b83\u4e0d\u4ec5\u6293\u53d6\u6307\u4ee4\u5730\u5740\uff0c\u8fd8\u4f1a\u4e00\u5e76\u6293\u53d6\u8be5\u6307\u4ee4\u5f53\u524d\u7684 PSV\u3002\u901a\u8fc7\u5927\u91cf\u8fd9\u6837\u7684\u91c7\u6837\uff0c\u5c31\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u9759\u6001\u6307\u4ee4\u6784\u5efa\u4e00\u4e2a Cycle Stack\uff1a\u6808\u7684\u603b\u9ad8\u5ea6\u4ee3\u8868\u5b83\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\uff08\u56de\u7b54 Q1\uff09\uff0c\u800c\u6808\u5185\u4e0d\u540c\u989c\u8272\u7684\u533a\u5757\u5927\u5c0f\u5219\u4ee3\u8868\u4e0d\u540c\u4e8b\u4ef6\uff08\u6216\u4e8b\u4ef6\u7ec4\u5408\uff09\u6240\u8d21\u732e\u7684\u65f6\u95f4\u6bd4\u4f8b\uff08\u56de\u7b54 Q2\uff09\u3002</li> <li></li> </ul> <p></p> <p>Figure 1: Example explaining how TEA creates PICS. TEA explains how performance events cause performance loss.</p> <ul> <li>\u8fd9\u4e2a\u8bbe\u8ba1\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u5c06\u201c\u65f6\u95f4\u5f52\u5c5e\u201d\u548c\u201c\u4e8b\u4ef6\u5f52\u56e0\u201d\u8fd9\u4e24\u4e2a\u95ee\u9898\uff0c\u5728 commit \u8fd9\u4e2a\u552f\u4e00\u80fd\u66b4\u9732\u771f\u5b9e\u5ef6\u8fdf\u7684\u65f6\u523b\uff0c\u901a\u8fc7 PSV \u8fd9\u4e2a\u8f7d\u4f53\u4e00\u6b21\u6027\u3001\u539f\u5b50\u6027\u5730\u89e3\u51b3\u4e86\u3002\u8fd9\u4ece\u6839\u672c\u4e0a\u4fdd\u8bc1\u4e86\u5206\u6790\u7ed3\u679c\u7684 time-proportionality\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/ELI5_notes/#2-performance-signature-vector-psv-eli5","title":"2. Performance Signature Vector (PSV) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4f20\u7edf\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u6bd4\u5982 AMD IBS\u3001Arm SPE\uff0c\u5b83\u4eec\u7684\u95ee\u9898\u5728\u4e8e\u201c\u6293\u9519\u4e86\u4eba\u201d\u3002\u5b83\u4eec\u5728\u6307\u4ee4\u521a\u8fdb\u5165\u6d41\u6c34\u7ebf\uff08fetch/dispatch\u9636\u6bb5\uff09\u5c31\u7ed9\u5b83\u8d34\u4e0a\u4e00\u4e2a\u6807\u7b7e\uff0c\u7136\u540e\u8bb0\u5f55\u8fd9\u4e2a\u6307\u4ee4\u540e\u7eed\u9047\u5230\u4e86\u4ec0\u4e48\u4e8b\u4ef6\uff08\u6bd4\u5982 cache miss\uff09\u3002\u4f46\u95ee\u9898\u662f\uff0c\u4e00\u4e2a\u6307\u4ee4\u53ef\u80fd\u5728\u524d\u7aef\u7b49\u4e86\u5f88\u4e45\uff0c\u4f46\u5b83\u771f\u6b63\u5361\u4f4f\u6574\u4e2a\u7a0b\u5e8f\u7684\u5730\u65b9\u662f\u5728\u540e\u7aef\uff08commit\u9636\u6bb5\uff09\u3002\u8fd9\u79cd\u201c\u524d\u7aef\u91c7\u6837\u201d\u7684\u65b9\u5f0f\uff0c\u4f1a\u628a\u5927\u91cf\u65f6\u95f4\u82b1\u5728\u90a3\u4e9b\u5176\u5b9e\u5bf9\u6574\u4f53\u6027\u80fd\u5f71\u54cd\u4e0d\u5927\u7684\u6307\u4ee4\u4e0a\uff0c\u5bfc\u81f4\u5206\u6790\u7ed3\u679c\u4e25\u91cd\u5931\u771f\u3002\u8bba\u6587\u91cc\u63d0\u5230\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u7684\u5e73\u5747\u8bef\u5dee\u9ad8\u8fbe 55%+\uff0c\u51e0\u4e4e\u6ca1\u6cd5\u7528\u3002 - \u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u53ea\u7edf\u8ba1\u4e8b\u4ef6\u53d1\u751f\u7684\u603b\u6b21\u6570\uff08event-driven\uff09\uff0c\u6bd4\u5982\u603b\u5171\u53d1\u751f\u4e86\u591a\u5c11\u6b21 L1 cache miss\u3002\u4f46\u8fd9\u66f4\u7cdf\u7cd5\uff0c\u56e0\u4e3a\u5b83\u5b8c\u5168\u5ffd\u7565\u4e86 latency hiding\uff08\u5ef6\u8fdf\u9690\u85cf\uff09\u6548\u5e94\u3002\u4e00\u4e2a cache miss \u5982\u679c\u88ab\u5176\u4ed6\u6307\u4ee4\u7684\u6267\u884c\u63a9\u76d6\u4e86\uff0c\u90a3\u5b83\u5bf9\u6027\u80fd\u5c31\u6ca1\u5565\u5f71\u54cd\uff1b\u53cd\u4e4b\uff0c\u4e00\u4e2a\u6ca1\u88ab\u63a9\u76d6\u7684 miss \u624d\u662f\u771f\u51f6\u3002\u5149\u770b\u603b\u6570\uff0c\u6839\u672c\u5206\u4e0d\u6e05\u8c01\u662f\u201c\u771f\u51f6\u201d\uff0c\u8c01\u662f\u201c\u80cc\u9505\u4fa0\u201d\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u5728\u8c03\u67e5\u4e00\u6761\u9ad8\u901f\u516c\u8def\u4e3a\u4ec0\u4e48\u5835\u8f66\u3002\u8001\u529e\u6cd5\uff08IBS/SPE\uff09\u5c31\u50cf\u662f\u5728\u5165\u53e3\u6536\u8d39\u7ad9\uff08fetch\uff09\u7ed9\u6bcf\u8f86\u8f66\u53d1\u4e00\u4e2a\u8bb0\u5f55\u4eea\uff0c\u8ba9\u5b83\u81ea\u5df1\u8bb0\u4e0b\u8def\u4e0a\u9047\u5230\u7684\u6240\u6709\u4e8b\u6545\u3002\u4f46\u95ee\u9898\u5728\u4e8e\uff0c\u5f88\u591a\u8f66\u5728\u5165\u53e3\u6392\u961f\u65f6\u5c31\u88ab\u8bb0\u5f55\u4e86\uff0c\u800c\u771f\u6b63\u7684\u5835\u70b9\u53ef\u80fd\u5728\u51e0\u5341\u516c\u91cc\u5916\u7684\u4e00\u4e2a\u96a7\u9053\u91cc\uff08commit\uff09\u3002\u4f60\u62ff\u5230\u7684\u6570\u636e\u91cc\uff0c\u5168\u662f\u5165\u53e3\u6392\u961f\u7684\u8f66\uff0c\u5374\u6f0f\u6389\u4e86\u96a7\u9053\u91cc\u52a8\u5f39\u4e0d\u5f97\u7684\u8f66\u3002 - Performance Signature Vector (PSV) \u7684\u505a\u6cd5\u5219\u5b8c\u5168\u4e0d\u540c\u3002\u5b83\u76f8\u5f53\u4e8e\u5728\u6574\u6761\u9ad8\u901f\u516c\u8def\u4e0a\u90e8\u7f72\u4e86\u65e0\u6570\u4e2a\u5fae\u578b\u4f20\u611f\u5668\uff0c\u6bcf\u8f86\u8f66\uff08\u52a8\u6001\u6307\u4ee4\uff09\u4e00\u4e0a\u8def\uff0c\u5c31\u81ea\u52a8\u6fc0\u6d3b\u4e00\u4e2a\u4e13\u5c5e\u7684\u201c\u72b6\u6001\u624b\u73af\u201d\uff08PSV\uff09\u3002\u8fd9\u4e2a\u624b\u73af\u53ea\u6709\u51e0\u4e2a\u7b80\u5355\u7684\u6307\u793a\u706f\uff08bit\uff09\uff0c\u5206\u522b\u5bf9\u5e94\u201c\u662f\u5426\u9047\u5230\u96a7\u9053\u4e8b\u6545\u201d\u3001\u201c\u662f\u5426\u9047\u5230\u6865\u6881\u7ef4\u4fee\u201d\u7b49\u5173\u952e\u4e8b\u4ef6\u3002\u6700\u5173\u952e\u7684\u662f\uff0c\u4ea4\u901a\u6307\u6325\u4e2d\u5fc3\uff08TEA sampler\uff09\u53ea\u5728\u9053\u8def\u6700\u62e5\u5835\u7684\u74f6\u9888\u70b9\uff08commit stage\uff09\u62cd\u7167\u53d6\u8bc1\u3002\u7167\u7247\u91cc\u4e0d\u4ec5\u6709\u5835\u5728\u90a3\u91cc\u7684\u8f66\u724c\u53f7\uff08instruction pointer\uff09\uff0c\u8fd8\u6709\u5b83\u624b\u4e0a\u624b\u73af\u4eae\u7740\u7684\u706f\uff08PSV\uff09\u3002\u8fd9\u6837\uff0c\u4f60\u5c31\u7cbe\u51c6\u5730\u77e5\u9053\uff0c\u5230\u5e95\u662f\u54ea\u4e2a\u4e8b\u4ef6\u7ec4\u5408\u5bfc\u81f4\u4e86\u8fd9\u4e2a\u5177\u4f53\u7684\u5835\u70b9\u3002</p> <p></p> <p>Figure 2: Example comparing TEA to dispatch-tagging. TEA is time-proportional whereas dispatch-tagging is not.</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u6ca1\u6709\u6539\u53d8\u91c7\u6837\u7684\u6838\u5fc3\u903b\u8f91\uff08\u4f9d\u7136\u5728 commit \u9636\u6bb5\u8fdb\u884c time-proportional \u91c7\u6837\uff09\uff0c\u800c\u662f\u5de7\u5999\u5730\u5728\u539f\u6709\u7684\u6307\u4ee4\u6570\u636e\u5305\uff08instruction packet\uff09\u4e2d\uff0c\u4e3a\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\u90fd\u9644\u52a0\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 PSV\u3002 - \u8fd9\u4e2a PSV \u662f\u4e00\u4e2a bit-vector\uff0c\u5b83\u7684\u6bcf\u4e00\u4f4d\u90fd\u5bf9\u5e94\u4e00\u4e2a\u7cbe\u5fc3\u6311\u9009\u7684\u3001\u80fd\u89e3\u91ca commit stall \u7684\u5173\u952e\u6027\u80fd\u4e8b\u4ef6\uff08\u5982 ST-L1, FL-MB \u7b49\uff0c\u89c1\u4e0b\u8868\uff09\u3002\u5f53\u6307\u4ee4\u5728\u6d41\u6c34\u7ebf\u4e2d\u6267\u884c\u65f6\uff0c\u786c\u4ef6\u4f1a\u81ea\u52a8\u5c06\u5b83\u7ecf\u5386\u7684\u4e8b\u4ef6\u201c\u70b9\u4eae\u201d\u5bf9\u5e94\u7684 bit\u3002 - \u5728\u91c7\u6837\u65f6\u523b\uff0c\u786c\u4ef6\u4e0d\u4ec5\u6355\u83b7\u5f53\u524d\u9020\u6210 stall \u7684\u6307\u4ee4\u5730\u5740\uff0c\u8fd8\u4e00\u5e76\u6355\u83b7\u5b83\u5b8c\u6574\u7684 PSV\u3002\u901a\u8fc7\u805a\u5408\u5927\u91cf\u8fd9\u6837\u7684\uff08\u6307\u4ee4\u5730\u5740, PSV\uff09\u6837\u672c\uff0c\u5c31\u80fd\u4e3a\u6bcf\u4e2a\u9759\u6001\u6307\u4ee4\u6784\u5efa\u51fa Per-Instruction Cycle Stacks (PICS)\uff0c\u6e05\u6670\u5730\u5c55\u793a\u5176\u6267\u884c\u65f6\u95f4\u662f\u5982\u4f55\u88ab\u4e0d\u540c\u7684\u4e8b\u4ef6\u7ec4\u5408\u6240\u6d88\u8017\u7684\u3002 - \u8fd9\u4e00\u62db\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u7528\u6781\u4f4e\u7684\u5f00\u9500\uff08\u4ec5 9 bits per instruction, \u529f\u8017\u589e\u52a0 ~0.1%\uff09\u5b9e\u73b0\u4e86\u5bf9\u6027\u80fd\u74f6\u9888\u7684\u7cbe\u51c6\u5f52\u56e0\uff0c\u5c06\u5e73\u5747\u8bef\u5dee\u4ece 55%+ \u964d\u5230\u4e86 2.1%\u3002</p> Commit State Performance Event (in PSV) Explanation Stalled (ST) ST-L1, ST-TLB, ST-LLC Load \u6307\u4ee4\u5728 ROB \u5934\u90e8\u7b49\u5f85\u6570\u636e Drained (DR) DR-L1, DR-TLB, DR-SQ ROB \u4e3a\u7a7a\uff0c\u56e0\u524d\u7aef\u53d6\u6307\u6216 Store Queue \u6ee1 Flushed (FL) FL-MB, FL-EX, FL-MO \u56e0\u5206\u652f\u8bef\u9884\u6d4b\u3001\u5f02\u5e38\u6216\u5185\u5b58\u6392\u5e8f\u51b2\u7a81\u5bfc\u81f4 flush"},{"location":"notes_repo/tea-time-proportional-event-analysis/ELI5_notes/#3-commit-state-based-event-hierarchy-eli5","title":"3. Commit-State-Based Event Hierarchy (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4f20\u7edf\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u6bd4\u5982 AMD IBS\u3001Arm SPE\uff0c\u5b83\u4eec\u7684\u95ee\u9898\u5728\u4e8e\u201c\u6293\u9519\u4e86\u4eba\u201d\u3002\u5b83\u4eec\u5728\u6307\u4ee4\u521a\u8fdb\u5165\u6d41\u6c34\u7ebf\uff08fetch/dispatch\u9636\u6bb5\uff09\u5c31\u7ed9\u6307\u4ee4\u6253\u4e0a\u6807\u7b7e\uff0c\u7136\u540e\u8bb0\u5f55\u5b83\u540e\u9762\u9047\u5230\u7684\u6240\u6709\u4e8b\u4ef6\u3002 - \u8fd9\u5bfc\u81f4\u4e00\u4e2a\u81f4\u547d\u95ee\u9898\uff1a\u4e00\u4e2a\u6307\u4ee4\u53ef\u80fd\u5728\u524d\u7aef\u88ab\u5361\u4f4f\u5f88\u4e45\uff08\u6bd4\u5982\u7b49\u7f13\u5b58\uff09\uff0c\u4f46\u5b83\u672c\u8eab\u5e76\u4e0d\u662f\u7a0b\u5e8f\u6162\u7684\u201c\u7f6a\u9b41\u7978\u9996\u201d\u3002\u771f\u6b63\u8ba9\u7a0b\u5e8f\u53d8\u6162\u7684\uff0c\u662f\u90a3\u4e9b\u5df2\u7ecf\u6267\u884c\u5b8c\u3001\u5374\u5361\u5728 Re-Order Buffer (ROB) \u5934\u90e8\u65e0\u6cd5\u9000\u4f11\uff08commit\uff09\u7684\u6307\u4ee4\uff0c\u56e0\u4e3a\u5b83\u4eec\u5835\u4f4f\u4e86\u6574\u4e2a\u6d41\u6c34\u7ebf\u3002\u65e7\u65b9\u6cd5\u4f1a\u8fc7\u5ea6\u5173\u6ce8\u90a3\u4e9b\u201c\u65e0\u8f9c\u7684\u7b49\u5f85\u8005\u201d\uff0c\u800c\u5ffd\u7565\u4e86\u771f\u6b63\u7684\u201c\u74f6\u9888\u5236\u9020\u8005\u201d\u3002 - \u53e6\u4e00\u65b9\u9762\uff0c\u5355\u7eaf\u7684\u4e8b\u4ef6\u8ba1\u6570\u5668\uff08Event Counting\uff09\u53ea\u544a\u8bc9\u4f60\u201c\u53d1\u751f\u4e86\u591a\u5c11\u6b21\u7f13\u5b58\u672a\u547d\u4e2d\u201d\uff0c\u4f46\u5b8c\u5168\u4e0d\u5173\u5fc3\u8fd9\u4e9b\u672a\u547d\u4e2d\u662f\u5426\u771f\u7684\u62d6\u6162\u4e86\u7a0b\u5e8f\u3002\u73b0\u4ee3\u5904\u7406\u5668\u6709\u5f3a\u5927\u7684\u4e71\u5e8f\u6267\u884c\u548c\u5ef6\u8fdf\u9690\u85cf\u80fd\u529b\uff0c\u5f88\u591a\u672a\u547d\u4e2d\u90fd\u88ab\u63a9\u76d6\u4e86\uff0c\u5bf9\u6027\u80fd\u6beb\u65e0\u5f71\u54cd\u3002\u8fd9\u79cd\u201c\u53ea\u770b\u6570\u91cf\uff0c\u4e0d\u770b\u5f71\u54cd\u201d\u7684\u65b9\u5f0f\uff0c\u8ba9\u5f00\u53d1\u8005\u5f88\u96be\u5224\u65ad\u4f18\u5316\u65b9\u5411\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u5728\u7ba1\u7406\u4e00\u6761\u9ad8\u901f\u516c\u8def\u7684\u6536\u8d39\u7ad9\uff08Commit Stage\uff09\u3002\u4f60\u7684\u76ee\u6807\u662f\u627e\u51fa\u9020\u6210\u4ea4\u901a\u5927\u62e5\u5835\u7684\u6839\u672c\u539f\u56e0\u3002 - \u65e7\u65b9\u6cd5\uff08\u5982IBS\uff09\u5c31\u50cf\u662f\u5728\u8f66\u8f86\u521a\u8fdb\u5165\u9ad8\u901f\u5165\u53e3\u531d\u9053\uff08Fetch/Dispatch\uff09\u65f6\uff0c\u5c31\u7ed9\u6bcf\u8f86\u8f66\u53d1\u4e00\u4e2a\u8bb0\u5f55\u4eea\u3002\u7ed3\u679c\u4f60\u53d1\u73b0\u5165\u53e3\u5904\u6392\u4e86\u5f88\u957f\u7684\u961f\uff0c\u5c31\u4ee5\u4e3a\u95ee\u9898\u662f\u5165\u53e3\u592a\u7a84\u3002\u4f46\u5b9e\u9645\u4e0a\uff0c\u961f\u4f0d\u4e4b\u6240\u4ee5\u957f\uff0c\u662f\u56e0\u4e3a\u524d\u65b9\u4e3b\u8def\u7684\u6536\u8d39\u7ad9\uff08Commit\uff09\u88ab\u4e00\u8f86\u629b\u951a\u7684\u5927\u5361\u8f66\uff08Stalled Instruction\uff09\u5835\u6b7b\u4e86\u3002\u4f60\u8bb0\u5f55\u4e86\u4e00\u5806\u5728\u5165\u53e3\u6392\u961f\u7684\u79c1\u5bb6\u8f66\u7684\u6570\u636e\uff0c\u5374\u5b8c\u5168\u6ca1\u641e\u6e05\u695a\u771f\u6b63\u7684\u95ee\u9898\u6240\u5728\u3002 - TEA\u7684\u505a\u6cd5\u5219\u806a\u660e\u5f97\u591a\u3002\u5b83\u76f4\u63a5\u5728\u6536\u8d39\u7ad9\u73b0\u573a\u89c2\u5bdf\u3002\u5b83\u770b\u5230\u6536\u8d39\u7ad9\u5f53\u524d\u5904\u4e8e\u4ec0\u4e48\u72b6\u6001\uff1a     - Stalled: \u6536\u8d39\u7ad9\u5f00\u7740\uff0c\u4f46\u7b2c\u4e00\u8f86\u8f66\uff08ROB Head\uff09\u574f\u4e86\u52a8\u4e0d\u4e86\u3002     - Drained: \u6536\u8d39\u7ad9\u7a7a\u7740\uff0c\u56e0\u4e3a\u540e\u9762\u6ca1\u8f66\u6765\u4e86\uff08\u524d\u7aef\u505c\u987f\uff09\u3002     - Flushed: \u521a\u624d\u6709\u4e00\u8f86\u8f66\u9006\u884c\uff08\u5206\u652f\u9884\u6d4b\u9519\u8bef\uff09\uff0c\u5bfc\u81f4\u540e\u9762\u6240\u6709\u8f66\u90fd\u88ab\u6e05\u7a7a\u4e86\u3002 - \u7136\u540e\uff0cTEA\u4e0d\u662f\u6f2b\u65e0\u76ee\u7684\u5730\u8bb0\u5f55\u6240\u6709\u4fe1\u606f\uff0c\u800c\u662f\u6839\u636e\u8fd9\u4e09\u79cd\u201c\u62e5\u5835\u72b6\u6001\u201d\uff0c\u53bb\u8ffd\u6eaf\u6700\u53ef\u80fd\u5bfc\u81f4\u8be5\u72b6\u6001\u7684\u5173\u952e\u539f\u56e0\u3002\u6bd4\u5982\uff0c\u5982\u679c\u662f\u201cStalled\u201d\u72b6\u6001\uff0c\u5b83\u5c31\u91cd\u70b9\u68c0\u67e5\u8fd9\u8f86\u574f\u6389\u7684\u8f66\u662f\u4e0d\u662f\u56e0\u4e3a\u201c\u6ca1\u6cb9\u4e86\u201d\uff08L1 Cache Miss\uff09\u6216\u8005\u201c\u9a7e\u7167\u6709\u95ee\u9898\u201d\uff08TLB Miss\uff09\u3002\u8fd9\u5c31\u50cf\u662f\u5efa\u7acb\u4e86\u4e00\u4e2a\u201c\u6545\u969c\u6811\u201d\uff0c\u4ece\u73b0\u8c61\uff08\u62e5\u5835\u72b6\u6001\uff09\u7cbe\u51c6\u5b9a\u4f4d\u5230\u5c11\u6570\u51e0\u4e2a\u6838\u5fc3\u75c5\u56e0\u3002</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1a\u6240\u6709\u7684\u6027\u80fd\u635f\u5931\uff0c\u6700\u7ec8\u90fd\u4f1a\u5728 Commit \u9636\u6bb5\u4ee5\u4e09\u79cd\u975e\u8ba1\u7b97\u72b6\u6001\uff08Stalled, Drained, Flushed\uff09\u66b4\u9732\u51fa\u6765\u3002\u56e0\u6b64\uff0c\u4e0d\u9700\u8981\u8ffd\u8e2a\u6210\u767e\u4e0a\u5343\u4e2a\u6027\u80fd\u4e8b\u4ef6\uff0c\u53ea\u9700\u8981\u56f4\u7ed5\u8fd9\u4e09\u79cd\u72b6\u6001\uff0c\u6784\u5efa\u4e00\u4e2a\u7cbe\u7b80\u7684\u201c\u4e8b\u4ef6\u56e0\u679c\u6811\u201d\u5373\u53ef\u3002 - \u5177\u4f53\u6765\u8bf4\uff0c\u4ed6\u4eec\u505a\u4e86\u4e24\u4ef6\u4e8b\uff1a     - \u72b6\u6001\u9a71\u52a8\u91c7\u6837\uff1a\u786c\u4ef6\u91c7\u6837\u5668\u4e0d\u518d\u968f\u673a\u6216\u5728\u524d\u7aef\u91c7\u6837\uff0c\u800c\u662f\u7d27\u5bc6\u8026\u5408\u5230 Commit \u903b\u8f91\u3002\u53ea\u6709\u5f53\u5904\u7406\u5668\u5904\u4e8e Stalled/Drained/Flushed \u72b6\u6001\u65f6\uff0c\u624d\u53bb\u91c7\u6837\u90a3\u4e2a\u201c\u8d23\u4efb\u6307\u4ee4\u201d\uff08\u5373\u5bfc\u81f4\u8be5\u72b6\u6001\u7684\u6307\u4ee4\uff09\u3002     - \u5c42\u6b21\u5316\u4e8b\u4ef6\u9009\u62e9\uff1a\u9488\u5bf9\u6bcf\u79cd\u72b6\u6001\uff0c\u53ea\u9009\u62e9\u6700\u9876\u5c42\u3001\u6700\u5177\u89e3\u91ca\u529b\u7684\u51e0\u4e2a\u4e8b\u4ef6\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e Stalled \u72b6\u6001\uff0c\u4ed6\u4eec\u6ca1\u6709\u53bb\u8ffd\u8e2a\u6240\u6709\u53ef\u80fd\u7684\u7f13\u5b58\u5c42\u7ea7\u672a\u547d\u4e2d\uff0c\u800c\u662f\u9009\u62e9\u4e86 ST-L1 (L1 Data Cache Miss), ST-TLB (L1 Data TLB Miss), \u548c ST-LLC (Last-Level Cache Miss) \u8fd9\u4e09\u4e2a\u5173\u952e\u8282\u70b9\u3002\u56e0\u4e3a L1 \u672a\u547d\u4e2d\u662f LLC \u672a\u547d\u4e2d\u7684\u524d\u63d0\uff0c\u6293\u4f4f\u8fd9\u51e0\u4e2a\u6839\u56e0\uff0c\u5c31\u80fd\u89e3\u91ca\u7edd\u5927\u591a\u6570\u60c5\u51b5\uff0c\u540c\u65f6\u5c06\u9700\u8981\u8ffd\u8e2a\u7684\u4e8b\u4ef6\u6570\u91cf\u4ece\u51e0\u767e\u4e2a\u9510\u51cf\u5230 \u4e5d\u4e2a\u3002 - \u8fd9\u4e2a\u8bbe\u8ba1\u5de7\u5999\u5730\u5e73\u8861\u4e86\u6d1e\u5bdf\u529b\uff08Insight\uff09\u548c\u5f00\u9500\uff08Overhead\uff09\u3002\u901a\u8fc7\u805a\u7126\u4e8e Commit \u72b6\u6001\u8fd9\u4e2a\u201c\u6027\u80fd\u635f\u5931\u7684\u552f\u4e00\u51fa\u53e3\u201d\uff0c\u5e76\u5229\u7528\u4e8b\u4ef6\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u8fdb\u884c\u526a\u679d\uff0cTEA \u7528\u6781\u5c0f\u7684\u786c\u4ef6\u4ee3\u4ef7\uff08\u4ec5\u589e\u52a0 249 bytes \u5b58\u50a8\u548c ~0.1% \u529f\u8017\uff09\u5c31\u83b7\u5f97\u4e86\u8fdc\u8d85\u73b0\u6709\u5de5\u5177\u7684\u51c6\u786e\u6027\u3002</p> <p></p> <p>Figure 3: Performance event hierarchy for the Stalled (ST) commit state.</p> <p></p> <p>Table 1: The performance events of TEA, IBS, SPE, and RIS.</p>"},{"location":"notes_repo/tea-time-proportional-event-analysis/ELI5_notes/#4-time-proportional-sampling-logic-eli5","title":"4. Time-Proportional Sampling Logic (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u6bd4\u5982 AMD IBS\u3001Arm SPE\uff0c\u5b83\u4eec\u7684\u91c7\u6837\u903b\u8f91\u662f\u201c\u5728\u54ea\u91cc\u6253\u6807\u7b7e\uff0c\u5c31\u5728\u54ea\u91cc\u91c7\u6837\u201d\uff0c\u901a\u5e38\u5728 fetch \u6216 dispatch \u9636\u6bb5\u7ed9\u6307\u4ee4\u6253\u4e0a\u6807\u8bb0\u3002 - \u8fd9\u4e2a\u505a\u6cd5\u5728\u73b0\u4ee3\u4e71\u5e8f\u6267\u884c\uff08out-of-order\uff09\u5904\u7406\u5668\u4e0a\u4f1a\u51fa\u5927\u95ee\u9898\u3002\u60f3\u8c61\u4e00\u4e0b\uff0c\u4e00\u4e2a\u6307\u4ee4\u56e0\u4e3a cache miss \u5361\u5728\u4e86 Re-Order Buffer (ROB) \u7684\u5934\u90e8\uff0c\u5bfc\u81f4\u6574\u4e2a\u6d41\u6c34\u7ebf\u90fd\u505c\u6446\u4e86\u3002\u6b64\u65f6\uff0c\u524d\u7aef\uff08fetch/dispatch\uff09\u53ef\u80fd\u8fd8\u5728\u4e0d\u65ad\u5730\u628a\u65b0\u6307\u4ee4\u585e\u8fdb\u6765\uff0c\u4f46\u8fd9\u4e9b\u65b0\u6307\u4ee4\u6839\u672c\u6ca1\u673a\u4f1a\u6267\u884c\uff0c\u5b83\u4eec\u53ea\u662f\u201c\u65e0\u8f9c\u7684\u65c1\u89c2\u8005\u201d\u3002 - \u4f20\u7edf\u5de5\u5177\u4f1a\u9519\u8bef\u5730\u91c7\u6837\u5230\u8fd9\u4e9b\u201c\u65c1\u89c2\u8005\u201d\u6307\u4ee4\uff0c\u5e76\u628a\u5f53\u524d\u5de8\u5927\u7684\u6027\u80fd\u5f00\u9500\uff08stall cycles\uff09\u5f52\u548e\u4e8e\u5b83\u4eec\u3002\u8fd9\u5c31\u50cf\u662f\u5de5\u5382\u505c\u5de5\u4e86\uff0c\u4f60\u4e0d\u53bb\u627e\u90a3\u4e2a\u5361\u4f4f\u673a\u5668\u7684\u574f\u96f6\u4ef6\uff0c\u53cd\u800c\u53bb\u8bb0\u5f55\u90a3\u4e9b\u5806\u5728\u4ed3\u5e93\u91cc\u8fd8\u6ca1\u7528\u4e0a\u7684\u65b0\u96f6\u4ef6\uff0c\u5b8c\u5168\u672c\u672b\u5012\u7f6e\u3002 - \u7ed3\u679c\u5c31\u662f\uff0c\u5f00\u53d1\u8005\u770b\u5230\u7684\u6027\u80fd\u62a5\u544a\u4e25\u91cd\u5931\u771f\uff0c\u65e0\u6cd5\u5b9a\u4f4d\u771f\u6b63\u7684\u6027\u80fd\u74f6\u9888\uff08performance-critical instructions\uff09\uff0c\u4f18\u5316\u5de5\u4f5c\u53d8\u6210\u4e86\u201c\u76f2\u4eba\u6478\u8c61\u201d\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u8fd9\u5c31\u50cf\u8c03\u67e5\u4e00\u573a\u4ea4\u901a\u5927\u62e5\u5835\u7684\u539f\u56e0\u3002\u4f20\u7edf\u65b9\u6cd5\uff08fetch/dispatch tagging\uff09\u76f8\u5f53\u4e8e\u5728\u9ad8\u901f\u5165\u53e3\u6536\u8d39\u7ad9\u968f\u673a\u62cd\u4e0b\u8f66\u724c\u53f7\uff0c\u7136\u540e\u8bf4\uff1a\u201c\u770b\uff0c\u8fd9\u4e9b\u8f66\u9020\u6210\u4e86\u5835\u8f66\uff01\u201d - \u4f46\u5b9e\u9645\u4e0a\uff0c\u9020\u6210\u5835\u8f66\u7684\u5f88\u53ef\u80fd\u662f\u5728\u51e0\u516c\u91cc\u5916\u4e8b\u6545\u73b0\u573a\u90a3\u8f86\u629b\u951a\u7684\u5927\u5361\u8f66\u3002\u6536\u8d39\u7ad9\u62cd\u5230\u7684\u8f66\uff0c\u53ea\u662f\u88ab\u5835\u5728\u8def\u4e0a\u7684\u53d7\u5bb3\u8005\u3002 - Time-Proportional Sampling Logic \u7684\u505a\u6cd5\u5219\u806a\u660e\u5f97\u591a\uff1a\u5b83\u76f4\u63a5\u98de\u5230\u62e5\u5835\u6700\u4e25\u91cd\u7684\u8def\u6bb5\uff08\u5373\u5904\u7406\u5668\u7684 commit stage\uff09\uff0c\u627e\u5230\u90a3\u8f86\u771f\u6b63\u6321\u5728\u8def\u4e0a\u7684\u8f66\uff08\u5373 head of ROB \u7684\u6307\u4ee4\uff09\uff0c\u7136\u540e\u95ee\uff1a\u201c\u563f\uff0c\u5144\u5f1f\uff0c\u4f60\u4e3a\u5565\u505c\u5728\u8fd9\u513f\uff1f\u662f\u56e0\u4e3a\u6ca1\u6cb9\u4e86\uff08cache miss\uff09\uff1f\u8fd8\u662f\u7206\u80ce\u4e86\uff08branch mispredict\uff09\uff1f\u201d - \u5b83\u53ea\u5173\u5fc3\u90a3\u4e2a\u6b63\u5728\u66b4\u9732\u5ef6\u8fdf\uff08exposing latency\uff09 \u7684\u6307\u4ee4\uff0c\u56e0\u4e3a\u5b83\u624d\u662f\u771f\u6b63\u6d88\u8017\u7cfb\u7edf\u65f6\u95f4\u7684\u201c\u7f6a\u9b41\u7978\u9996\u201d\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u6ca1\u6709\u6539\u53d8\u91c7\u6837\u7684\u57fa\u672c\u5f62\u5f0f\uff08\u4f9d\u7136\u662fstatistical sampling\uff09\uff0c\u800c\u662f\u5f7b\u5e95\u626d\u8f6c\u4e86\u91c7\u6837\u7684\u76ee\u6807\u9009\u62e9\u903b\u8f91\u3002 - \u6838\u5fc3\u5728\u4e8e\uff0cTEA \u7684\u786c\u4ef6\u91c7\u6837\u5668\u4f1a\u5b9e\u65f6\u76d1\u63a7 commit stage \u7684\u72b6\u6001\uff0c\u5e76\u6839\u636e\u56db\u79cd\u4e0d\u540c\u72b6\u6001\u7cbe\u51c6\u5b9a\u4f4d\u201c\u5143\u51f6\u201d\uff1a   - Compute: \u591a\u6761\u6307\u4ee4\u540c\u65f6\u63d0\u4ea4\uff0c\u65f6\u95f4\u5747\u5300\u5206\u644a\u7ed9\u5b83\u4eec\u3002   - Stalled: ROB \u5934\u90e8\u7684\u6307\u4ee4\u8fd8\u6ca1\u6267\u884c\u5b8c\u3002\u91c7\u6837\u76ee\u6807\u5c31\u662f\u8fd9\u4e2anext-committing instruction\u3002   - Drained: ROB \u7a7a\u4e86\uff0c\u56e0\u4e3a\u524d\u7aef\u53d6\u6307\u6162\uff08\u5982 I-cache miss\uff09\u3002\u91c7\u6837\u76ee\u6807\u662f\u4e0b\u4e00\u4e2a\u5c06\u8981\u63d0\u4ea4\u7684\u6307\u4ee4\u3002   - Flushed: \u56e0\u4e3a\u5206\u652f\u9884\u6d4b\u9519\u8bef\u7b49\u539f\u56e0\uff0cROB \u88ab\u6e05\u7a7a\u4e86\u3002\u6b64\u65f6\uff0c\u771f\u6b63\u8be5\u8d1f\u8d23\u7684\u662f\u90a3\u4e2a\u5df2\u7ecf\u63d0\u4ea4\u4f46\u5bfc\u81f4 flush \u7684\u6307\u4ee4\uff08last-committed instruction\uff09\uff0c\u800c\u4e0d\u662f\u4e0b\u4e00\u4e2a\u8981\u63d0\u4ea4\u7684\u3002 - \u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0cTEA \u5728\u786c\u4ef6\u4e0a\u505a\u4e86\u4e00\u4e2a\u7cbe\u5de7\u7684\u8bbe\u8ba1\uff1a\u5b83\u4e3a\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\u7ef4\u62a4\u4e00\u4e2a Performance Signature Vector (PSV)\uff0c\u5e76\u5728 commit stage \u7684\u91c7\u6837\u65f6\u523b\uff0c\u5c06\u6b63\u786e\u7684\u6307\u4ee4\u5730\u5740\u4e0e\u5176\u5b8c\u6574\u7684 PSV\uff08\u8bb0\u5f55\u4e86\u5b83\u7ecf\u5386\u7684\u6240\u6709\u6027\u80fd\u4e8b\u4ef6\uff09\u4e00\u8d77\u6253\u5305\u4e0a\u62a5\u3002 - \u8fd9\u4e2a\u903b\u8f91\u8f6c\u6362\u786e\u4fdd\u4e86\u6700\u7ec8\u751f\u6210\u7684 Per-Instruction Cycle Stacks (PICS) \u662f time-proportional \u7684\u2014\u2014\u6bcf\u6761\u6307\u4ee4\u5728\u62a5\u544a\u4e2d\u6240\u5360\u7684\u201c\u9ad8\u5ea6\u201d\uff0c\u4e25\u683c\u6b63\u6bd4\u4e8e\u5b83\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u771f\u5b9e\u8d21\u732e\u3002</p> <p></p> <p>Figure 1: Example explaining how TEA creates PICS. TEA explains how performance events cause performance loss.</p> <p></p> <p>Figure 2: Example comparing TEA to dispatch-tagging. TEA is time-proportional whereas dispatch-tagging is not.</p>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/","title":"TEA: Time-Proportional Event Analysis \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-1-example-explaining-how-tea-creates-pics-tea-explains-how-performance-events-cause-performance-loss","title":"Figure 1: Example explaining how TEA creates PICS. TEA explains how performance events cause performance loss.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 TEA \u5982\u4f55\u901a\u8fc7\u91c7\u6837\u548c Performance Signature Vector (PSV) \u751f\u6210 Per-Instruction Cycle Stacks (PICS)\uff0c\u4ee5\u89e3\u91ca\u6027\u80fd\u635f\u5931\u7684\u6839\u6e90\u3002</li> <li> <p>\u56fe\u4e2d\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1a(a) TEA \u91c7\u6837\u6570\u636e\u8868\u3001(b) \u793a\u4f8b\u4ee3\u7801\u3001(c) \u6700\u7ec8\u751f\u6210\u7684 PICS \u56fe\u8868\u3002</p> </li> <li> <p>\u56fe (a) TEA samples\uff1a</p> </li> <li>\u8868\u683c\u8bb0\u5f55\u4e86 5 \u6b21\u91c7\u6837\uff08Sample 1 \u81f3 Sample 5\uff09\uff0c\u6bcf\u884c\u5305\u542b\uff1a<ul> <li>Timestamp\uff1a\u91c7\u6837\u53d1\u751f\u7684\u65f6\u95f4\u70b9\uff08\u5355\u4f4d\uff1a\u65f6\u949f\u5468\u671f\uff09\u3002</li> <li>Instruction address\uff1a\u88ab\u91c7\u6837\u7684\u6307\u4ee4\u5730\u5740\uff08\u5982 I1, I4 \u7b49\uff09\u3002</li> <li>PSV\uff1a\u4e09\u4f4d\u4e8c\u8fdb\u5236\u5411\u91cf\uff0c\u5206\u522b\u5bf9\u5e94\u4e09\u79cd\u6027\u80fd\u4e8b\u4ef6\uff1a</li> <li>\u7b2c\u4e00\u4f4d\uff1aI$ miss\uff08\u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d\uff09</li> <li>\u7b2c\u4e8c\u4f4d\uff1aD$ miss\uff08\u6570\u636e\u7f13\u5b58\u672a\u547d\u4e2d\uff09</li> <li>\u7b2c\u4e09\u4f4d\uff1aBranch mispredict\uff08\u5206\u652f\u9884\u6d4b\u9519\u8bef\uff09</li> </ul> </li> <li>PSV \u4e2d\u201c1\u201d\u8868\u793a\u8be5\u6307\u4ee4\u5728\u91c7\u6837\u65f6\u523b\u6b63\u53d7\u6b64\u4e8b\u4ef6\u5f71\u54cd\uff0c\u201c0\u201d\u8868\u793a\u65e0\u5f71\u54cd\u3002</li> <li> <p>\u793a\u4f8b\uff1a</p> <ul> <li>Sample 1\uff1aI1 \u88ab\u91c7\u6837\uff0cPSV \u4e3a <code>1 0 0</code> \u2192 \u4ec5\u53d7 I$ miss \u5f71\u54cd\u3002</li> <li>Sample 2\uff1aI4 \u88ab\u91c7\u6837\uff0cPSV \u4e3a <code>0 1 0</code> \u2192 \u4ec5\u53d7 D$ miss \u5f71\u54cd\u3002</li> <li>Sample 3\uff1aI1 \u88ab\u91c7\u6837\uff0cPSV \u4e3a <code>0 0 1</code> \u2192 \u4ec5\u53d7 Branch mispredict \u5f71\u54cd\u3002</li> <li>Sample 4 &amp; 5\uff1aI1\u2013I4 \u5e76\u884c\u63d0\u4ea4\uff0cPSV \u5168\u4e3a <code>0 0 0</code> \u2192 \u65e0\u6027\u80fd\u4e8b\u4ef6\uff0c\u5f52\u5165 Base \u7c7b\u522b\u3002</li> </ul> </li> <li> <p>\u56fe (b) Example code\uff1a</p> </li> <li>\u5c55\u793a\u4e86\u4e00\u6bb5\u7b80\u77ed\u5faa\u73af\u4ee3\u7801\uff0c\u5305\u542b\u56db\u6761\u6838\u5fc3\u6307\u4ee4\uff1a<ul> <li><code>I1 lw a4, (a5)</code>\uff1a\u52a0\u8f7d\u6307\u4ee4\uff0c\u53ef\u80fd\u89e6\u53d1 D$ miss\u3002</li> <li><code>I2 addw a0, a0, a4</code>\uff1a\u7b97\u672f\u8fd0\u7b97\u3002</li> <li><code>I3 addi a5, a5, 4</code>\uff1a\u5730\u5740\u9012\u589e\u3002</li> <li><code>I4 bne a5, a3, I1</code>\uff1a\u6761\u4ef6\u8df3\u8f6c\uff0c\u53ef\u80fd\u89e6\u53d1 Branch mispredict\u3002</li> </ul> </li> <li> <p>\u4ee3\u7801\u7ed3\u6784\u8bf4\u660e\u4e86\u4e3a\u4f55 I1 \u548c I4 \u662f\u6027\u80fd\u5173\u952e\u6307\u4ee4\u3002</p> </li> <li> <p>\u56fe (c) Time-proportional PICS\uff1a</p> </li> <li>\u6a2a\u8f74\u4e3a Clock Cycles\uff0c\u7eb5\u8f74\u4e3a Static instructions\uff08I1\u2013I4\uff09\u3002</li> <li>\u6bcf\u4e2a\u6307\u4ee4\u7684\u67f1\u72b6\u56fe\u6309 PSV \u5206\u7c7b\uff0c\u663e\u793a\u5176\u8d21\u732e\u7684\u5468\u671f\u6570\uff1a<ul> <li>Base\uff08\u6d45\u84dd\uff09\uff1a\u65e0\u6027\u80fd\u4e8b\u4ef6\uff0c\u6b63\u5e38\u6267\u884c\u3002</li> <li>I$ miss\uff08\u6a59\u8272\uff09\uff1aI1 \u56e0\u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d\u6d88\u8017\u7ea6 1k \u5468\u671f\u3002</li> <li>D$ miss\uff08\u9752\u8272\uff09\uff1aI1 \u56e0\u6570\u636e\u7f13\u5b58\u672a\u547d\u4e2d\u6d88\u8017\u7ea6 1k \u5468\u671f\u3002</li> <li>Branch mispredict\uff08\u9ec4\u8272\uff09\uff1aI4 \u56e0\u5206\u652f\u9884\u6d4b\u9519\u8bef\u6d88\u8017\u7ea6 1k \u5468\u671f\u3002</li> </ul> </li> <li>\u603b\u8ba1\uff1aI1 \u5360\u7528\u7ea6 3k \u5468\u671f\uff08\u542b\u4e24\u6b21\u4e8b\u4ef6\uff09\uff0cI4 \u5360\u7528\u7ea6 1k \u5468\u671f\uff0cI2/I3 \u5404\u5360\u7ea6 0.5k \u5468\u671f\uff08\u5e76\u884c\u6267\u884c\u5206\u644a\uff09\u3002</li> <li> <p>\u5173\u952e\u7ed3\u8bba\uff1aTEA \u51c6\u786e\u5c06\u6027\u80fd\u635f\u5931\u5f52\u56e0\u4e8e\u5177\u4f53\u6307\u4ee4\u53ca\u5176\u89e6\u53d1\u7684\u4e8b\u4ef6\uff0c\u5b9e\u73b0\u65f6\u95f4\u6bd4\u4f8b\u5206\u914d\u3002</p> </li> <li> <p>\u6838\u5fc3\u673a\u5236\u603b\u7ed3\uff1a</p> </li> <li>TEA \u5728 commit stage \u91c7\u6837\uff0c\u786e\u4fdd\u65f6\u95f4\u6bd4\u4f8b\u6027\u3002</li> <li>\u901a\u8fc7 PSV \u8bb0\u5f55\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\u6240\u7ecf\u5386\u7684\u6027\u80fd\u4e8b\u4ef6\u7ec4\u5408\u3002</li> <li> <p>\u6700\u7ec8\u805a\u5408\u6240\u6709\u91c7\u6837\uff0c\u6309\u9759\u6001\u6307\u4ee4\u548c\u4e8b\u4ef6\u7c7b\u578b\u6784\u5efa PICS\uff0c\u76f4\u89c2\u63ed\u793a\u6027\u80fd\u74f6\u9888\u3002</p> </li> <li> <p>\u5bf9\u6bd4\u4f20\u7edf\u65b9\u6cd5\uff1a</p> </li> <li>\u82e5\u4f7f\u7528 dispatch-tagging\uff08\u5982 IBS/SPE/RIS\uff09\uff0c\u53ef\u80fd\u9519\u8bef\u91c7\u6837 I5 \u6216 I8\uff0c\u800c\u975e\u5b9e\u9645\u963b\u585e\u63d0\u4ea4\u7684 I1\u3002</li> <li>TEA \u907f\u514d\u6b64\u7c7b\u504f\u5dee\uff0c\u63d0\u4f9b\u66f4\u51c6\u786e\u7684\u6027\u80fd\u5f52\u56e0\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-2-example-comparing-tea-to-dispatch-tagging-tea-is-time-proportional-whereas-dispatch-tagging-is-not","title":"Figure 2: Example comparing TEA to dispatch-tagging. TEA is time-proportional whereas dispatch-tagging is not.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 TEA \u4e0e Dispatch-tagging\uff08\u5982 IBS\uff09\u5728\u6027\u80fd\u4e8b\u4ef6\u8ffd\u8e2a\u673a\u5236\u4e0a\u7684\u6838\u5fc3\u5dee\u5f02\uff0c\u65e8\u5728\u8bf4\u660e\u4e3a\u4f55 TEA \u662f time-proportional \u800c\u540e\u8005\u4e0d\u662f\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u4e24\u4e2a\u5b50\u56fe\uff1a(a) TEA \u7684\u5de5\u4f5c\u6d41\u7a0b\uff1b(b) Dispatch-tagging \u7684\u5de5\u4f5c\u6d41\u7a0b\u3002\u4e24\u8005\u5747\u57fa\u4e8e\u4e00\u4e2a\u5178\u578b\u7684\u4e71\u5e8f\u6267\u884c\u5904\u7406\u5668\u6d41\u6c34\u7ebf\uff0c\u5305\u62ec Fetch\u3001Decode\u3001Rename\u3001Dispatch\u3001Issue Buffers\u3001Commit \u7b49\u9636\u6bb5\u3002</li> <li>\u5728 (a) TEA \u90e8\u5206\uff1a</li> <li>Performance Signature Vector (PSV) \u683c\u5f0f\u4f4d\u4e8e\u9876\u90e8\uff0c\u5305\u542b\u591a\u4e2a\u6027\u80fd\u4e8b\u4ef6\u4f4d\uff0c\u5982 ICACHE/TLB miss\u3001L1I miss\u3001ITLB miss\u3001Branch mispredict\u3001LLC miss\u3001L1D miss\u3001DTLB miss\u3002</li> <li>PSV \u5728\u6307\u4ee4\u8fdb\u5165\u6d41\u6c34\u7ebf\u65f6\u88ab\u521d\u59cb\u5316\u5e76\u968f\u6307\u4ee4\u6d41\u52a8\uff0c\u5728\u4e0d\u540c\u9636\u6bb5\u6839\u636e\u53d1\u751f\u7684\u4e8b\u4ef6\u66f4\u65b0\u76f8\u5e94\u4f4d\u3002</li> <li>Sampler \u4f4d\u4e8e Re-Order Buffer (ROB) \u5934\u90e8\u4e4b\u540e\uff0c\u91c7\u6837\u7684\u662f\u5f53\u524d\u66b4\u9732\u5ef6\u8fdf\u7684\u6307\u4ee4\uff08\u5373 ROB \u5934\u90e8\u6307\u4ee4\uff09\uff0c\u786e\u4fdd\u91c7\u6837\u70b9\u53cd\u6620\u771f\u5b9e\u6027\u80fd\u74f6\u9888\u3002</li> <li>\u793a\u4f8b\u4e2d\uff0c\u6307\u4ee4 I1 \u56e0 L1D miss \u548c DTLB miss \u88ab\u963b\u585e\u5728 ROB \u5934\u90e8\uff0cSampler \u91c7\u6837 I1 \u53ca\u5176 PSV\uff081000000\uff09\uff0c\u6b63\u786e\u5f52\u56e0\u4e8e\u8be5\u6307\u4ee4\u3002</li> <li>\u5728 (b) Dispatch-tagging \u90e8\u5206\uff1a</li> <li>\u91c7\u6837\u5668\u4f4d\u4e8e Dispatch \u9636\u6bb5\uff0c\u6807\u8bb0\u7684\u662f\u5f53\u524d\u88ab\u8c03\u5ea6\u7684\u6307\u4ee4\uff08\u5982 I5\uff09\uff0c\u800c\u975e ROB \u5934\u90e8\u6307\u4ee4\u3002</li> <li>\u5c3d\u7ba1\u6b64\u65f6 I1 \u4ecd\u5728 ROB \u5934\u90e8\u963b\u585e\uff0c\u4f46\u91c7\u6837\u5668\u5374\u8bb0\u5f55\u4e86 I5 \u7684 PSV\uff081000000\uff09\uff0c\u8fd9\u5bfc\u81f4\u6027\u80fd\u4e8b\u4ef6\u88ab\u9519\u8bef\u5f52\u56e0\u5230\u975e\u5173\u952e\u6307\u4ee4\u3002</li> <li>\u8fd9\u79cd\u673a\u5236\u5ffd\u7565\u4e86\u6307\u4ee4\u5728 commit \u9636\u6bb5\u7684\u5b9e\u9645\u5f71\u54cd\uff0c\u56e0\u6b64 \u4e0d\u5177\u5907 time-proportionality\u3002</li> <li>\u5173\u952e\u5bf9\u6bd4\u8868\u683c\uff1a</li> </ul> \u7279\u6027 TEA Dispatch-tagging \u91c7\u6837\u70b9 ROB \u5934\u90e8\uff08commit \u9636\u6bb5\uff09 Dispatch \u9636\u6bb5 \u91c7\u6837\u5bf9\u8c61 \u5f53\u524d\u66b4\u9732\u5ef6\u8fdf\u7684\u6307\u4ee4 \u5f53\u524d\u88ab\u8c03\u5ea6\u7684\u6307\u4ee4 Time-proportional \u662f \u5426 \u4e8b\u4ef6\u5f52\u56e0\u51c6\u786e\u6027 \u9ad8\uff08\u5f52\u56e0\u4e8e\u5b9e\u9645\u9020\u6210\u5ef6\u8fdf\u7684\u6307\u4ee4\uff09 \u4f4e\uff08\u53ef\u80fd\u5f52\u56e0\u4e8e\u65e0\u5173\u6307\u4ee4\uff09 \u4ee3\u8868\u6027\u793a\u4f8b I1\uff08\u963b\u585e\u6307\u4ee4\uff09\u88ab\u91c7\u6837 I5\uff08\u8c03\u5ea6\u6307\u4ee4\uff09\u88ab\u91c7\u6837 <ul> <li>\u56fe\u4e2d\u6570\u5b57\u6807\u6ce8\u4e86\u5173\u952e\u6b65\u9aa4\uff1a</li> <li>\u2460\uff5e\u2464 \u4e3a TEA \u6d41\u7a0b\u4e2d\u7684\u4e8b\u4ef6\u4f20\u64ad\u4e0e\u91c7\u6837\uff1b</li> <li>\u2465\uff5e\u2466 \u4e3a Dispatch-tagging \u4e2d\u7684\u9519\u8bef\u91c7\u6837\u70b9\u3002</li> <li>\u603b\u7ed3\uff1a\u8be5\u56fe\u901a\u8fc7\u76f4\u89c2\u5bf9\u6bd4\u63ed\u793a\u4e86 TEA \u7684\u6838\u5fc3\u4f18\u52bf\u2014\u2014\u5728 commit \u9636\u6bb5\u91c7\u6837\u4ee5\u786e\u4fdd\u65f6\u95f4\u6bd4\u4f8b\u6027\uff0c\u4ece\u800c\u51c6\u786e\u8bc6\u522b\u6027\u80fd\u74f6\u9888\u6307\u4ee4\u53ca\u5176\u76f8\u5173\u4e8b\u4ef6\uff0c\u800c\u4f20\u7edf dispatch-tagging \u65b9\u6cd5\u56e0\u91c7\u6837\u70b9\u524d\u7f6e\u5bfc\u81f4\u5f52\u56e0\u504f\u5dee\uff0c\u65e0\u6cd5\u63d0\u4f9b\u51c6\u786e\u7684\u6027\u80fd\u5206\u6790\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-3-performance-event-hierarchy-for-the-stalled-st-commit-state","title":"Figure 3: Performance event hierarchy for the Stalled (ST) commit state.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Stalled (ST) commit state \u4e0b\u7684\u6027\u80fd\u4e8b\u4ef6\u5c42\u7ea7\u7ed3\u6784\uff0c\u65e8\u5728\u8bf4\u660e\u5982\u4f55\u901a\u8fc7\u9009\u62e9\u5173\u952e\u4e8b\u4ef6\u6765\u5e73\u8861\u5206\u6790\u7684\u53ef\u89e3\u91ca\u6027\u4e0e\u786c\u4ef6\u5f00\u9500\u3002</li> <li>\u8be5\u56fe\u5206\u4e3a\u4e09\u4e2a\u4e3b\u8981\u5c42\u7ea7\uff08Level 1, Level 2, Level 3\uff09\uff0c\u4ece\u5e95\u5c42\u7684\u901a\u7528\u4e8b\u4ef6\u9010\u6b65\u5411\u4e0a\u62bd\u8c61\u4e3a\u66f4\u5177\u4f53\u7684\u4f9d\u8d56\u6216\u72ec\u7acb\u4e8b\u4ef6\u3002</li> <li>Level 1 \u5305\u542b\u6700\u57fa\u7840\u7684\u4e8b\u4ef6\uff1aData Load Stall (DLS)\uff0c\u4ee3\u8868\u6240\u6709\u6570\u636e\u52a0\u8f7d\u76f8\u5173\u7684\u505c\u987f\u3002</li> <li>Level 2 \u5206\u4e3a\u4e24\u7c7b\uff1a</li> <li>Independent events\uff1a\u5982 L1 data cache miss \u548c L1 data TLB miss\uff0c\u5b83\u4eec\u53ef\u72ec\u7acb\u53d1\u751f\uff0c\u4e92\u4e0d\u5f71\u54cd\u3002</li> <li>Dependent events\uff1a\u5982 L2 data TLB miss\uff0c\u5b83\u4f9d\u8d56\u4e8e L1 TLB miss \u7684\u53d1\u751f\u3002</li> <li>Level 3 \u5c55\u793a\u4e86\u66f4\u9ad8\u5c42\u7684\u4f9d\u8d56\u4e8b\u4ef6\uff0c\u4f8b\u5982 LLC miss\uff0c\u5b83\u4f9d\u8d56\u4e8e L1 \u6570\u636e\u7f13\u5b58\u672a\u547d\u4e2d\u3002</li> <li>\u56fe\u4e2d\u7528\u865a\u7ebf\u6846\u6807\u51fa Dependent events\uff0c\u5f3a\u8c03\u5176\u4f9d\u8d56\u5173\u7cfb\uff1b\u5b9e\u7ebf\u7bad\u5934\u8868\u793a\u4e8b\u4ef6\u4e4b\u95f4\u7684\u56e0\u679c\u6216\u4f9d\u8d56\u8def\u5f84\u3002</li> <li>\u53f3\u4fa7\u90e8\u5206\u5c55\u793a\u4e86\u4e0d\u540c\u4e8b\u4ef6\u96c6\u5408\u5bf9\u5e94\u7684 PSV (Performance Signature Vector) \u683c\u5f0f\uff0c\u6bcf\u4e2a PSV \u7531\u591a\u4e2a\u4f4d\u7ec4\u6210\uff0c\u6bcf\u4f4d\u5bf9\u5e94\u4e00\u4e2a\u4e8b\u4ef6\u3002</li> <li>PSV \u793a\u4f8b\u5305\u62ec\uff1a</li> <li>\u4ec5\u5305\u542b DLS \u7684\u5355\u4e00\u4f4d PSV\u3002</li> <li>\u5305\u542b L1D \u548c L1TLB \u7684\u4e24\u4f4d PSV\u3002</li> <li>\u5305\u542b L1D\u3001L1TLB \u548c LLC \u7684\u4e09\u4f4d PSV\u3002</li> <li>\u5305\u542b L1D\u3001L1TLB\u3001LLC \u548c L2TLB \u7684\u56db\u4f4d PSV\u3002</li> <li>\u901a\u8fc7\u9009\u62e9\u4e0d\u540c\u5c42\u7ea7\u7684\u4e8b\u4ef6\u7ec4\u5408\uff0c\u53ef\u4ee5\u5728\u4fdd\u6301\u4f4e\u5f00\u9500\u7684\u540c\u65f6\u63d0\u5347\u5206\u6790\u7684\u7c92\u5ea6\u548c\u53ef\u89e3\u91ca\u6027\u3002</li> <li>\u4f5c\u8005\u6307\u51fa\uff0c\u4fdd\u7559\u6839\u4e8b\u4ef6\uff08\u5982 L1 miss\uff09\u5bf9\u4e8e\u907f\u514d\u4e22\u5931\u53ef\u89e3\u91ca\u6027\u81f3\u5173\u91cd\u8981\uff0c\u5373\u4f7f\u6355\u83b7\u4e86\u66f4\u9ad8\u7ea7\u522b\u7684\u4e8b\u4ef6\uff08\u5982 LLC miss\uff09\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#table-1-the-performance-events-of-tea-ibs-spe-and-ris","title":"Table 1: The performance events of TEA, IBS, SPE, and RIS.","text":"<ul> <li>\u8be5\u56fe\u7247\u4e3a Table 1\uff0c\u6807\u9898\u4e3a \u201cThe performance events of TEA, IBS, SPE, and RIS\u201d\uff0c\u7528\u4e8e\u5bf9\u6bd4\u56db\u79cd\u6027\u80fd\u5206\u6790\u5de5\u5177\u6240\u652f\u6301\u7684\u6027\u80fd\u4e8b\u4ef6\u3002</li> <li>\u8868\u683c\u5305\u542b\u56db\u5217\uff1aEvent\uff08\u4e8b\u4ef6\u540d\u79f0\uff09\u3001Description\uff08\u4e8b\u4ef6\u63cf\u8ff0\uff09\u3001\u4ee5\u53ca\u4e09\u5217\u5206\u522b\u5bf9\u5e94 TEA\u3001IBS\u3001SPE \u548c RIS \u7684\u652f\u6301\u60c5\u51b5\uff08\u7528\u52fe\u53f7 \u221a \u6216\u53c9\u53f7 \u00d7 \u8868\u793a\uff09\u3002</li> <li>\u6240\u6709\u4e8b\u4ef6\u6309\u5176\u6240\u5c5e\u7684 commit state \u5206\u7ec4\uff1a</li> <li>DR-\uff08Drained \u72b6\u6001\uff09\uff1a\u5305\u62ec DR-L1\uff08L1 instruction cache miss\uff09\u3001DR-TLB\uff08L1 instruction TLB miss\uff09\u3001DR-SQ\uff08Store instruction stalled at dispatch\uff09\u3002</li> <li>FL-\uff08Flushed \u72b6\u6001\uff09\uff1a\u5305\u62ec FL-MB\uff08Mispredicted branch\uff09\u3001FL-EX\uff08Instruction caused exception\uff09\u3001FL-MO\uff08Memory ordering violation\uff09\u3002</li> <li>ST-\uff08Stalled \u72b6\u6001\uff09\uff1a\u5305\u62ec ST-L1\uff08L1 data cache miss\uff09\u3001ST-TLB\uff08L1 data TLB miss\uff09\u3001ST-LLC\uff08LLC miss caused by a load instruction\uff09\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u5404\u5de5\u5177\u5bf9\u4e8b\u4ef6\u7684\u652f\u6301\u60c5\u51b5\u6c47\u603b\uff1a</p> Event Description TEA IBS SPE RIS DR-L1 L1 instruction cache miss \u221a \u221a \u00d7 \u221a DR-TLB L1 instruction TLB miss \u221a \u221a \u00d7 \u221a DR-SQ Store instruction stalled at dispatch \u221a \u00d7 \u00d7 \u221a FL-MB Mispredicted branch \u221a \u221a \u221a \u221a FL-EX Instruction caused exception \u221a \u00d7 \u00d7 \u00d7 FL-MO Memory ordering violation \u221a \u00d7 \u00d7 \u00d7 ST-L1 L1 data cache miss \u221a \u221a \u221a \u221a ST-TLB L1 data TLB miss \u221a \u221a \u221a \u221a ST-LLC LLC miss caused by a load instruction \u221a \u221a \u221a \u221a <ul> <li>TEA \u652f\u6301\u5168\u90e8\u4e5d\u4e2a\u4e8b\u4ef6\uff0c\u662f\u552f\u4e00\u8986\u76d6\u6240\u6709\u4e09\u7c7b commit state\uff08Drained, Flushed, Stalled\uff09\u5b8c\u6574\u4e8b\u4ef6\u96c6\u7684\u5de5\u5177\u3002</li> <li>IBS \u7f3a\u5c11\u5bf9 DR-SQ\u3001FL-EX\u3001FL-MO \u7684\u652f\u6301\u3002</li> <li>SPE \u7f3a\u5c11\u5bf9 DR-L1\u3001DR-TLB\u3001FL-EX\u3001FL-MO \u7684\u652f\u6301\u3002</li> <li>RIS \u7f3a\u5c11\u5bf9 DR-SQ\u3001FL-EX\u3001FL-MO \u7684\u652f\u6301\u3002</li> <li>\u4ece\u8868\u683c\u53ef\u89c1\uff0cTEA \u5728\u4e8b\u4ef6\u8986\u76d6\u5e7f\u5ea6\u4e0a\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u4e09\u79cd\u5de5\u5177\uff0c\u5c24\u5176\u5728\u89e3\u91ca Flushed \u72b6\u6001\uff08\u5982\u5f02\u5e38\u548c\u5185\u5b58\u5e8f\u8fdd\u89c4\uff09\u548c Drained \u72b6\u6001\u4e2d\u7684\u5b58\u50a8\u961f\u5217\u963b\u585e\uff08DR-SQ\uff09\u65b9\u9762\u5177\u6709\u72ec\u7279\u4f18\u52bf\u3002</li> <li>\u8be5\u8868\u4f50\u8bc1\u4e86\u8bba\u6587\u4e2d\u5173\u4e8e TEA \u901a\u8fc7\u7cbe\u5fc3\u9009\u62e9\u4e8b\u4ef6\u5b9e\u73b0\u9ad8\u53ef\u89e3\u91ca\u6027\u4e0e\u4f4e\u5f00\u9500\u5e73\u8861 \u7684\u8bbe\u8ba1\u76ee\u6807\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-4-tea-microarchitecture","title":"Figure 4: TEA microarchitecture.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 TEA microarchitecture \u7684\u5b8c\u6574\u6570\u636e\u6d41\u4e0e\u786c\u4ef6\u6a21\u5757\u5e03\u5c40\uff0c\u6838\u5fc3\u76ee\u6807\u662f\u4e3a\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\u6784\u5efa Performance Signature Vector (PSV) \u5e76\u5728 commit \u9636\u6bb5\u8fdb\u884c\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u3002</li> <li>\u6574\u4e2a\u67b6\u6784\u56f4\u7ed5 Re-Order Buffer (ROB) \u5c55\u5f00\uff0c\u6240\u6709\u6307\u4ee4\u7684 PSV \u6700\u7ec8\u5b58\u50a8\u4e8e ROB \u6761\u76ee\u4e2d\uff0c\u5e76\u901a\u8fc7 Sample Selection \u5355\u5143\u5728 commit \u65f6\u89e6\u53d1\u91c7\u6837\u3002</li> <li>Fetch &amp; PreDecode \u9636\u6bb5\uff1a\u4ece I-Cache \u548c I-TLB \u83b7\u53d6\u6307\u4ee4\u5305\uff0c\u540c\u65f6\u68c0\u6d4b DR-L1\uff08L1 \u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u548c DR-TLB\uff08L1 \u6307\u4ee4 TLB \u672a\u547d\u4e2d\uff09\u4e8b\u4ef6\u3002\u8fd9\u4e9b\u4e8b\u4ef6\u88ab\u7f16\u7801\u8fdb\u4e00\u4e2a 2b PSV\uff0c\u5e76\u4ec5\u5206\u914d\u7ed9 fetch packet \u4e2d\u7684\u7b2c\u4e00\u4e2a\u6307\u4ee4\uff0c\u5176\u4f59\u6307\u4ee4\u521d\u59cb\u5316\u4e3a 0\u3002</li> <li>Fetch Buffer \u5b58\u50a8\u591a\u4e2a fetch packet\uff0c\u6bcf\u4e2a\u6307\u4ee4\u643a\u5e26\u5176 PSV \u5411\u4e0b\u4f20\u9012\u81f3 Decode \u9636\u6bb5\u3002</li> <li>Decode \u9636\u6bb5\uff1a\u5c06\u6307\u4ee4\u89e3\u7801\u4e3a \u00b5ops\uff0cPSV \u88ab\u590d\u5236\u5230\u6bcf\u4e2a \u00b5op \u7684\u5143\u6570\u636e\u4e2d\uff0c\u7ee7\u7eed\u5411\u4e0b\u6e38\u4f20\u9012\u3002</li> <li>Dispatch \u9636\u6bb5\uff1a\u00b5ops \u88ab\u63d2\u5165 ROB \u548c\u529f\u80fd\u5355\u5143\u961f\u5217\u3002\u5728\u6b64\u9636\u6bb5\uff0c\u68c0\u6d4b DR-SQ\uff08Store Queue \u6ee1\u5bfc\u81f4 ROB drain\uff09\u4e8b\u4ef6\uff0c\u5e76\u5c06\u5176\u8bb0\u5f55\u5230 \u00b5op \u7684 PSV \u4e2d\u3002\u540c\u65f6\uff0cPSV \u88ab\u5199\u5165 ROB \u6761\u76ee\u3002</li> <li>LSU (Load/Store Unit) \u9636\u6bb5\uff1a\u5728 load \u6267\u884c\u524d\u53ef\u68c0\u6d4b ST-TLB\uff08\u6570\u636e TLB \u672a\u547d\u4e2d\uff09\uff0c\u56e0\u6b64\u5728 LSU \u6761\u76ee\u4e2d\u9884\u7559\u4e00\u4f4d\u7528\u4e8e\u8bb0\u5f55\u8be5\u4e8b\u4ef6\u3002ST-L1 \u548c ST-LLC \u4e8b\u4ef6\u5728 cache \u54cd\u5e94\u540e\u901a\u8fc7 Writeback \u9636\u6bb5\u66f4\u65b0\u5230 PSV\u3002</li> <li>ALU / FPU \u9636\u6bb5\uff1a\u4e0d\u76f4\u63a5\u4ea7\u751f\u65b0\u4e8b\u4ef6\uff0c\u4f46\u6267\u884c\u7ed3\u679c\u53ef\u80fd\u5f71\u54cd\u540e\u7eed\u72b6\u6001\u3002</li> <li>Writeback \u9636\u6bb5\uff1a\u5c06\u6700\u7ec8\u7684 PSV \u66f4\u65b0\u56de ROB \u6761\u76ee\uff0c\u786e\u4fdd\u5728 commit \u65f6 PSV \u5305\u542b\u6240\u6709\u76f8\u5173\u4e8b\u4ef6\u3002</li> <li>Re-Order Buffer (ROB) \u662f PSV \u7684\u6700\u7ec8\u5b58\u50a8\u4f4d\u7f6e\uff0c\u6bcf\u4e2a\u6761\u76ee\u5305\u542b\u4e00\u4e2a 9b PSV\uff0c\u5bf9\u5e94 TEA \u652f\u6301\u7684\u4e5d\u4e2a\u6027\u80fd\u4e8b\u4ef6\uff1a   | \u4e8b\u4ef6\u7c7b\u578b | \u4e8b\u4ef6\u540d\u79f0 | \u8bf4\u660e |   |----------|----------|------|   | Drained (DR) | DR-L1 | L1 \u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d |   | Drained (DR) | DR-TLB | L1 \u6307\u4ee4 TLB \u672a\u547d\u4e2d |   | Drained (DR) | DR-SQ | Store Queue \u6ee1\u5bfc\u81f4 ROB drain |   | Flushed (FL) | FL-MB | \u5206\u652f\u9884\u6d4b\u9519\u8bef |   | Flushed (FL) | FL-EX | \u5f02\u5e38\u53d1\u751f |   | Flushed (FL) | FL-MO | \u5185\u5b58\u987a\u5e8f\u8fdd\u89c4 |   | Stalled (ST) | ST-L1 | L1 \u6570\u636e\u7f13\u5b58\u672a\u547d\u4e2d |   | Stalled (ST) | ST-TLB | L1 \u6570\u636e TLB \u672a\u547d\u4e2d |   | Stalled (ST) | ST-LLC | LLC \u6570\u636e\u7f13\u5b58\u672a\u547d\u4e2d |</li> <li>Sample Selection \u5355\u5143\u8fde\u63a5 ROB \u5934\u90e8\uff0c\u6839\u636e\u5f53\u524d commit \u72b6\u6001\uff08Compute, Stalled, Drained, Flushed\uff09\u9009\u62e9\u8981\u91c7\u6837\u7684\u6307\u4ee4\u53ca\u5176 PSV\u3002\u5b83\u7ee7\u627f\u81ea TIP [22] \u7684\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u903b\u8f91\u3002</li> <li>PMU (Performance Monitoring Unit) \u901a\u8fc7\u5468\u671f\u8ba1\u6570\u5668\u89e6\u53d1\u91c7\u6837\u4e8b\u4ef6\uff0c\u901a\u77e5 Sample Selection \u5355\u5143\u3002</li> <li>Control Status Registers (CSRs) \u5b58\u50a8\u91c7\u6837\u7ed3\u679c\uff0c\u5305\u62ec\u65f6\u95f4\u6233\u3001\u6807\u5fd7\u4f4d\u3001\u6307\u4ee4\u5730\u5740\u548c PSV\uff0c\u968f\u540e\u89e6\u53d1\u4e2d\u65ad\u4f9b\u8f6f\u4ef6\u8bfb\u53d6\u3002</li> <li>\u5173\u952e\u8bbe\u8ba1\u539f\u5219\uff1a</li> <li>\u65f6\u95f4\u6bd4\u4f8b\u6027\uff1a\u91c7\u6837\u70b9\u4f4d\u4e8e commit \u9636\u6bb5\uff0c\u786e\u4fdd\u6837\u672c\u53cd\u6620\u7684\u662f\u5b9e\u9645\u66b4\u9732\u5ef6\u8fdf\u7684\u6307\u4ee4\u3002</li> <li>\u4e8b\u4ef6\u5b8c\u6574\u6027\uff1aPSV \u8ddf\u8e2a\u6240\u6709\u5728\u6307\u4ee4\u751f\u547d\u5468\u671f\u5185\u53d1\u751f\u7684\u6027\u80fd\u4e8b\u4ef6\uff0c\u800c\u975e\u4ec5\u524d\u7aef\u4e8b\u4ef6\u3002</li> <li>\u4f4e\u5f00\u9500\uff1a\u901a\u8fc7\u7cbe\u5fc3\u9009\u62e9\u4e8b\u4ef6\u96c6\uff08\u4ec5 9 \u4e2a\uff09\u548c\u590d\u7528\u73b0\u6709\u7ed3\u6784\uff08\u5982 ROB \u6761\u76ee\uff09\uff0c\u5c06\u5b58\u50a8\u5f00\u9500\u63a7\u5236\u5728 249 \u5b57\u8282/\u6838\u3002</li> <li>\u975e\u5173\u952e\u8def\u5f84\uff1a\u6240\u6709 TEA \u903b\u8f91\u5747\u4e0d\u5728\u5904\u7406\u5668\u7684\u5173\u952e\u8def\u5f84\u4e0a\uff0c\u4e0d\u5f71\u54cd\u65f6\u949f\u9891\u7387\u3002</li> <li>\u91c7\u6837\u6d41\u7a0b\uff1a</li> <li>PMU \u8ba1\u6570\u5668\u8fbe\u5230\u9608\u503c\uff0c\u89e6\u53d1\u91c7\u6837\u4e8b\u4ef6\u3002</li> <li>Sample Selection \u6839\u636e ROB \u72b6\u6001\u9009\u62e9\u6307\u4ee4\u3002</li> <li>\u8bfb\u53d6\u8be5\u6307\u4ee4\u7684 PSV \u548c\u5730\u5740\u3002</li> <li>\u5c06\u6837\u672c\u5199\u5165 CSRs\u3002</li> <li>\u89e6\u53d1\u4e2d\u65ad\uff0c\u8f6f\u4ef6\u8bfb\u53d6\u5e76\u5b58\u50a8\u6837\u672c\u3002</li> <li>\u4e0e\u4f20\u7edf\u65b9\u6cd5\u5bf9\u6bd4\uff1a\u4e0d\u540c\u4e8e IBS/SPE/RIS \u5728 fetch/dispatch \u9636\u6bb5\u6807\u8bb0\u6307\u4ee4\uff0cTEA \u5728 commit \u9636\u6bb5\u91c7\u6837\uff0c\u907f\u514d\u4e86\u56e0\u524d\u7aef\u963b\u585e\u5bfc\u81f4\u7684\u6837\u672c\u504f\u5dee\uff0c\u4ece\u800c\u5b9e\u73b0\u66f4\u9ad8\u7684\u51c6\u786e\u6027\uff08\u5e73\u5747\u8bef\u5dee 2.1%\uff09\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#table-2-baseline-architecture-configuration","title":"Table 2: Baseline architecture configuration.","text":"<ul> <li>\u8be5\u8868\u683c\u8be6\u7ec6\u5217\u51fa\u4e86\u7528\u4e8e\u8bc4\u4f30 TEA \u7684\u57fa\u51c6\u67b6\u6784\u914d\u7f6e\uff0c\u6838\u5fc3\u4e3a OoO BOOM [58]\uff0c\u8fd0\u884c\u5728 RV64IMAFDCSUX \u6307\u4ee4\u96c6\u67b6\u6784\u4e0a\uff0c\u4e3b\u9891\u4e3a 3.2 GHz\u3002</li> <li>\u524d\u7aef\uff08Front-end\uff09\u914d\u7f6e\u5305\u62ec\uff1a</li> <li>8-wide fetch\uff0c\u914d\u5907 48-entry fetch buffer \u548c 4-wide decode\u3002</li> <li>\u4f7f\u7528 28 KB TAGE branch predictor\uff0c\u652f\u6301\u6700\u591a 30 outstanding branches\u3002</li> <li>\u914d\u5907 60-entry fetch target queue\u3002</li> <li>\u6267\u884c\u5355\u5143\uff08Execute\uff09\u90e8\u5206\u5305\u542b\uff1a</li> <li>192-entry ROB\uff08Reorder Buffer\uff09\uff0c\u4ee5\u53ca 192 integer/floating-point physical registers\u3002</li> <li>48-entry dual-issue memory queue\u300180-entry 4-issue integer queue \u548c 48-entry dual-issue floating-point queue\u3002</li> <li>\u52a0\u8f7d/\u5b58\u50a8\u5355\u5143\uff08LSU\uff09\u914d\u7f6e\u5982\u4e0b\uff1a</li> <li>64-entry load/store queue\u3002</li> <li>L1 \u7f13\u5b58\uff1a32 KB 8-way I-cache \u548c 32 KB 8-way D-cache\uff0c\u914d\u5907 16 MSHRs\u300164 SDQ/RPQ entries \u53ca next-line prefetcher\u3002</li> <li>LLC\uff08Last Level Cache\uff09\uff1a2 MiB 16-way dual-bank\uff0c\u914d\u5907 12 MSHRs\u3002</li> <li>TLB\uff1a\u91c7\u7528 Page Table Walker\uff0c\u5305\u542b 32-entry fully-assoc L1 D-TLB \u548c 32-entry fully-assoc L1 I-TLB\uff0c\u4ee5\u53ca 1024-entry direct-mapped L2 TLB\u3002</li> <li>\u5185\u5b58\u5b50\u7cfb\u7edf\uff08Memory\uff09\u914d\u7f6e\u4e3a\uff1a</li> <li>16 GB DDR3 FR-FCFS quad-rank\uff0c\u6700\u5927\u5e26\u5bbd 16 GB/s\u3002</li> <li>\u5185\u5b58\u5ef6\u8fdf\u4e3a 14-14-14 (CAS-RCD-RP) @ 1 GHz\uff0c\u652f\u6301 8 queue depth \u548c 32 max reads/writes\u3002</li> <li>\u64cd\u4f5c\u7cfb\u7edf\uff08OS\uff09\u4e3a Buildroot, Linux 5.7.0\u3002</li> </ul> Part Configuration Core OoO BOOM [58]: RV64IMAFDCSUX @ 3.2 GHz Front-end 8-wide fetch, 48-entry fetch buffer, 4-wide decode, 28 KB TAGE branch predictor, 60-entry fetch target queue, max. 30 outstanding branches Execute 192-entry ROB, 192 integer/floating-point physical registers, 48-entry dual-issue memory queue, 80-entry 4-issue integer queue, 48-entry dual-issue floating-point queue LSU 64-entry load/store queue L1 32 KB 8-way I-cache, 32 KB 8-way D-cache w/ 16 MSHRs, 64 SDQ/RPQ entries, next-line prefetcher LLC 2 MiB 16-way dual-bank w/ 12 MSHRs TLB Page Table Walker, 32-entry fully-assoc L1 D-TLB, 32-entry fully-assoc L1 I-TLB, 1024-entry direct-mapped L2 TLB Memory 16 GB DDR3 FR-FCFS quad-rank, 16 GB/s maximum bandwidth, 14-14-14 (CAS-RCD-RP) latencies @ 1 GHz, 8 queue depth, 32 max reads/writes OS Buildroot, Linux 5.7.0"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-5-quantifying-the-error-for-the-pics-obtained-through-ibs-spe-ris-nci-tea-and-tea-tea-achieves-the-highest-accuracy-within-21-and-at-most-77-compared-to-the-golden-reference","title":"Figure 5: Quantifying the error for the PICS obtained through IBS, SPE, RIS, NCI-TEA, and TEA. TEA achieves the highest accuracy within 2.1% (and at most 7.7%) compared to the golden reference.","text":"<ul> <li>\u56fe\u8868\u6807\u9898\u4e3a Figure 5\uff0c\u65e8\u5728\u91cf\u5316\u901a\u8fc7 IBS\u3001SPE\u3001RIS\u3001NCI-TEA \u548c TEA \u4e94\u79cd\u65b9\u6cd5\u751f\u6210\u7684 Per-Instruction Cycle Stacks\uff08PICS\uff09\u76f8\u5bf9\u4e8e\u201c\u9ec4\u91d1\u53c2\u8003\u201d\uff08golden reference\uff09\u7684\u8bef\u5dee\u3002</li> <li>TEA \u5728\u6240\u6709\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u5747\u8868\u73b0\u51fa\u6700\u4f4e\u8bef\u5dee\uff0c\u5e73\u5747\u8bef\u5dee\u4ec5\u4e3a 2.1%\uff0c\u6700\u5927\u8bef\u5dee\u4e0d\u8d85\u8fc7 7.7%\uff0c\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u65b9\u6cd5\u3002</li> <li>\u5176\u4ed6\u65b9\u6cd5\u8bef\u5dee\u666e\u904d\u8f83\u9ad8\uff1aIBS\u3001SPE\u3001RIS \u5e73\u5747\u8bef\u5dee\u5728 55.5%\u201356.0% \u4e4b\u95f4\uff1bNCI-TEA \u5e73\u5747\u8bef\u5dee\u4e3a 11.3%\uff0c\u6700\u9ad8\u8fbe 22.0%\u3002</li> <li>\u56fe\u8868\u6a2a\u8f74\u5217\u51fa 24 \u4e2a SPEC CPU2017 \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\u53ca\u4e00\u4e2a\u201cAverage\u201d\u6c47\u603b\u9879\uff0c\u7eb5\u8f74\u8868\u793a\u8bef\u5dee\u767e\u5206\u6bd4\uff080%\u201380%\uff09\u3002</li> <li>\u6bcf\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u5bf9\u5e94\u4e94\u4e2a\u67f1\u72b6\u56fe\uff0c\u5206\u522b\u4ee3\u8868 IBS\uff08\u6df1\u84dd\uff09\u3001SPE\uff08\u4e2d\u84dd\uff09\u3001RIS\uff08\u6d45\u7d2b\uff09\u3001NCI-TEA\uff08\u7070\u7d2b\uff09\u3001TEA\uff08\u9ed1\uff09\uff0c\u989c\u8272\u4e0e\u56fe\u4f8b\u4e00\u81f4\u3002</li> <li>\u591a\u6570\u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0cTEA \u7684\u8bef\u5dee\u67f1\u9ad8\u5ea6\u8fdc\u4f4e\u4e8e\u5176\u4ed6\u65b9\u6cd5\uff0c\u5c24\u5176\u5728 lbm\u3001omnetpp\u3001nab \u7b49\u7a0b\u5e8f\u4e2d\u4f18\u52bf\u660e\u663e\u3002</li> <li>NCI-TEA \u867d\u4f18\u4e8e IBS/SPE/RIS\uff0c\u4f46\u4ecd\u663e\u8457\u52a3\u4e8e TEA\uff0c\u8bf4\u660e\u4ec5\u91c7\u6837\u201c\u4e0b\u4e00\u63d0\u4ea4\u6307\u4ee4\u201d\u4e0d\u8db3\u4ee5\u5b9e\u73b0\u9ad8\u7cbe\u5ea6\u3002</li> <li>IBS\u3001SPE\u3001RIS \u4e09\u8005\u8bef\u5dee\u76f8\u8fd1\uff0c\u8bc1\u5b9e\u5176\u201c\u524d\u7aef\u6807\u8bb0\u201d\u673a\u5236\u5bfc\u81f4\u975e\u65f6\u95f4\u6bd4\u4f8b\u6027\uff0c\u7cfb\u7edf\u6027\u9ad8\u4f30\u90e8\u5206\u6307\u4ee4\u6027\u80fd\u5f71\u54cd\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5404\u65b9\u6cd5\u5728\u4e0d\u540c\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u7684\u5178\u578b\u8bef\u5dee\u8868\u73b0\uff1a</li> </ul> Benchmark IBS Error SPE Error RIS Error NCI-TEA Error TEA Error perlbanch ~58% ~58% ~60% ~15% ~5% gcc ~55% ~55% ~57% ~10% ~3% bwaves ~75% ~75% ~78% ~18% ~4% lbm ~78% ~78% ~79% ~10% &lt;1% omnetpp ~70% ~70% ~72% ~12% ~3% nab ~70% ~70% ~72% ~15% ~2% Average 55.6% 55.5% 56.0% 11.3% 2.1% <ul> <li>\u7ed3\u8bba\uff1aTEA \u901a\u8fc7\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u548c\u5b8c\u6574\u4e8b\u4ef6\u8ffd\u8e2a\uff0c\u5b9e\u73b0\u4e86\u524d\u6240\u672a\u6709\u7684 PICS \u7cbe\u5ea6\uff0c\u662f\u5f53\u524d\u6700\u53ef\u9760\u7684\u6307\u4ee4\u7ea7\u6027\u80fd\u5206\u6790\u5de5\u5177\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-6-pics-for-the-top-3-instructions-as-provided-by-ibs-tea-and-the-golden-reference-gr-the-pics-provided-by-tea-are-accurate-compared-to-the-golden-reference-in-contrast-to-ibs","title":"Figure 6: PICS for the top-3 instructions as provided by IBS, TEA, and the golden reference (GR). The PICS provided by TEA are accurate compared to the golden reference, in contrast to IBS.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u56db\u4e2a\u57fa\u51c6\u6d4b\u8bd5\uff08bwaves\u3001omnetpp\u3001fotonik3d\u3001exchange2\uff09\u4e2d\uff0c\u524d\u4e09\u5927\u8017\u65f6\u6307\u4ee4\u7684 Per-Instruction Cycle Stacks\uff08PICS\uff09\uff0c\u5206\u522b\u7531 IBS\u3001TEA \u548c\u9ec4\u91d1\u53c2\u8003\uff08GR\uff09\u751f\u6210\uff0c\u7528\u4e8e\u5bf9\u6bd4\u7cbe\u5ea6\u3002</li> <li>TEA \u7684 PICS \u4e0e GR \u9ad8\u5ea6\u4e00\u81f4\uff0c\u800c IBS \u7684\u7ed3\u679c\u5b58\u5728\u663e\u8457\u504f\u5dee\uff0c\u9a8c\u8bc1\u4e86 TEA \u5728\u65f6\u95f4\u6bd4\u4f8b\u6027\u4e0a\u7684\u4f18\u52bf\u3002</li> <li>\u6bcf\u4e2a\u5b50\u56fe\u5305\u542b\u4e09\u4e2a\u5806\u53e0\u67f1\u72b6\u56fe\uff0c\u5206\u522b\u5bf9\u5e94 IBS\u3001TEA\u3001GR\uff0c\u6a2a\u8f74\u4e3a\u6307\u4ee4\u5730\u5740\uff0c\u7eb5\u8f74\u4e3a\u5468\u671f\u6570\uff08Cycles\uff09\uff0c\u4e0d\u540c\u989c\u8272\u4ee3\u8868\u4e0d\u540c\u6027\u80fd\u4e8b\u4ef6\u7ec4\u5408\u3002</li> <li>\u4e8b\u4ef6\u5206\u7c7b\u5305\u62ec\uff1abase\uff08\u65e0\u4e8b\u4ef6\uff09\u3001others\uff08\u5176\u4ed6\u672a\u5f52\u7c7b\u4e8b\u4ef6\uff09\u3001ST-L1\uff08L1\u6570\u636e\u7f13\u5b58\u7f3a\u5931\uff09\u3001ST-TLB\uff08L1\u6570\u636eTLB\u7f3a\u5931\uff09\u3001ST-LLC\uff08LLC\u7f3a\u5931\uff09\u3001FL-MB\uff08\u5206\u652f\u8bef\u9884\u6d4b\uff09\u3001FL-MO\uff08\u5185\u5b58\u987a\u5e8f\u8fdd\u89c4\uff09\u3001DR-SQ\uff08\u5b58\u50a8\u961f\u5217\u6ee1\uff09\u3001DR-L1\uff08L1\u6307\u4ee4\u7f13\u5b58\u7f3a\u5931\uff09\u3001DR-TLB\uff08L1\u6307\u4ee4TLB\u7f3a\u5931\uff09\u7b49\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u5404\u5b50\u56fe\u7684\u5173\u952e\u89c2\u5bdf\uff1a</p> \u5b50\u56fe \u57fa\u51c6\u6d4b\u8bd5 \u4e3b\u8981\u53d1\u73b0 (a) bwaves \u6307\u4ee4 <code>fld fa2,(a4)</code>\u3001<code>fld fa1,(a1)</code>\u3001<code>fld fa5,(a2)</code> TEA \u4e0e GR \u51e0\u4e4e\u91cd\u5408\uff1bIBS \u9ad8\u4f30\u4e86 base \u548c ST-L1 \u7ec4\u4ef6\uff0c\u4f4e\u4f30\u4e86 ST-TLB \u548c ST-LLC\uff1b\u7ec4\u5408\u4e8b\u4ef6\u5982 ST-L1,ST-TLB \u88ab\u51c6\u786e\u6355\u6349\u3002 (b) omnetpp \u6307\u4ee4 <code>sw t1,120(a1)</code>\u3001<code>ld a6,104(a1)</code>\u3001<code>ld a7,104(t4)</code> TEA \u4e0e GR \u9ad8\u5ea6\u5339\u914d\uff1bIBS \u9519\u8bef\u5730\u5c06\u5927\u91cf\u5468\u671f\u5f52\u56e0\u4e8e base\uff0c\u800c\u5ffd\u7565\u4e86 FL-MB \u548c ST-LLC \u7b49\u5173\u952e\u4e8b\u4ef6\uff1bFL-MO \u4e8b\u4ef6\u5728 GR \u548c TEA \u4e2d\u5747\u88ab\u8bc6\u522b\u3002 (c) fotonik3d \u6307\u4ee4 <code>fld ft2,24(a5)</code>\u3001<code>fld ft2,24(a3)</code>\u3001<code>ld a5,48(sp)</code> TEA \u4e0e GR \u51e0\u4e4e\u5b8c\u5168\u4e00\u81f4\uff1bIBS \u5b8c\u5168\u672a\u80fd\u6355\u6349\u5230\u4efb\u4f55\u6027\u80fd\u4e8b\u4ef6\uff0c\u6240\u6709\u5468\u671f\u5747\u5f52\u4e3a base\uff1b\u8868\u660e IBS \u5728\u6b64\u573a\u666f\u4e0b\u5b8c\u5168\u5931\u6548\u3002 (d) exchange2 \u6307\u4ee4 <code>bgtz a2,b2ce</code>\u3001<code>bgtz a4,a4f5a</code>\u3001<code>lw a2,(s4)</code> TEA \u4e0e GR \u63a5\u8fd1\uff1bIBS \u5bf9 lw \u6307\u4ee4\u7684 DR-SQ \u548c DR-L1 \u4e8b\u4ef6\u6709\u90e8\u5206\u6355\u6349\uff0c\u4f46\u6574\u4f53\u4ecd\u4e0d\u51c6\u786e\uff1b\u8fd9\u662f IBS \u8868\u73b0\u6700\u597d\u7684\u6848\u4f8b\uff0c\u4f46\u4ecd\u8fdc\u900a\u4e8e TEA\u3002 <ul> <li>\u7efc\u5408\u7ed3\u8bba\uff1aTEA \u80fd\u7cbe\u786e\u5f52\u56e0\u6bcf\u4e2a\u6307\u4ee4\u7684\u6267\u884c\u5468\u671f\u81f3\u5177\u4f53\u6027\u80fd\u4e8b\u4ef6\uff0c\u5c24\u5176\u64c5\u957f\u5904\u7406\u7ec4\u5408\u4e8b\u4ef6\u548c\u975e\u8ba1\u7b97\u72b6\u6001\uff08Stalled/Flushed/Drained\uff09\uff0c\u800c IBS \u56e0\u5728\u524d\u7aef\u6807\u8bb0\u6307\u4ee4\uff0c\u5bfc\u81f4\u6837\u672c\u504f\u5411\u975e\u5173\u952e\u6307\u4ee4\uff0c\u9020\u6210\u4e25\u91cd\u8bef\u5224\u3002</li> <li>\u6b64\u56fe\u6709\u529b\u652f\u6301\u8bba\u6587\u6838\u5fc3\u4e3b\u5f20\uff1a\u53ea\u6709\u65f6\u95f4\u6bd4\u4f8b\u6027\u7684\u5206\u6790\u65b9\u6cd5\uff08\u5982 TEA\uff09\u624d\u80fd\u63d0\u4f9b\u53ef\u4fe1\u7684\u6027\u80fd\u5f52\u56e0\uff0c\u4ece\u800c\u6307\u5bfc\u6709\u6548\u4f18\u5316\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-7-quantifying-the-correlation-between-event-count-and-its-impact-on-performance-some-event-counts-correlate-strongly-with-their-impact-on-performance-while-others-do-not","title":"Figure 7: Quantifying the correlation between event count and its impact on performance. Some event counts correlate strongly with their impact on performance while others do not.","text":"<ul> <li>\u56fe\u7247\u4e3a\u7bb1\u7ebf\u56fe\uff0c\u6807\u9898\u4e3a\u201cFigure 7: Quantifying the correlation between event count and its impact on performance\u201d\uff0c\u65e8\u5728\u91cf\u5316\u6027\u80fd\u4e8b\u4ef6\u8ba1\u6570\u4e0e\u5176\u5bf9\u6027\u80fd\u5b9e\u9645\u5f71\u54cd\u4e4b\u95f4\u7684\u76f8\u5173\u6027\u3002</li> <li>\u6a2a\u8f74\u5217\u51fa\u4e5d\u79cd\u6027\u80fd\u4e8b\u4ef6\uff0c\u6309\u5176\u6240\u5c5e\u7684 commit state \u5206\u7ec4\uff1aDR-SQ\u3001DR-TLB\u3001ST-TLB\u3001ST-L1\u3001ST-LLC\u3001DR-L1 \u5c5e\u4e8e Drained \u6216 Stalled \u72b6\u6001\uff1bFL-MB\u3001FL-EX\u3001FL-MO \u5c5e\u4e8e Flushed \u72b6\u6001\u3002</li> <li>\u7eb5\u8f74\u4e3a Pearson \u76f8\u5173\u7cfb\u6570\uff08Correlation\uff09\uff0c\u8303\u56f4\u4ece 0 \u5230 1\uff0c\u503c\u8d8a\u63a5\u8fd1 1 \u8868\u793a\u4e8b\u4ef6\u8ba1\u6570\u4e0e\u6027\u80fd\u5f71\u54cd\u9ad8\u5ea6\u6b63\u76f8\u5173\u3002</li> <li>Flushed \u7c7b\u4e8b\u4ef6\uff08FL-MB, FL-EX, FL-MO\uff09\u8868\u73b0\u51fa\u6700\u5f3a\u7684\u76f8\u5173\u6027\uff0c\u4e2d\u4f4d\u6570\u5747\u9ad8\u4e8e 0.8\uff0c\u8868\u660e\u8fd9\u4e9b\u4e8b\u4ef6\uff08\u5982\u5206\u652f\u8bef\u9884\u6d4b\u3001\u5f02\u5e38\u3001\u5185\u5b58\u5e8f\u8fdd\u89c4\uff09\u4e00\u65e6\u53d1\u751f\uff0c\u51e0\u4e4e\u5fc5\u7136\u5bfc\u81f4\u663e\u8457\u6027\u80fd\u635f\u5931\uff0c\u4e14\u96be\u4ee5\u88ab\u9690\u85cf\u3002</li> <li>Stalled \u7c7b\u4e8b\u4ef6\u4e2d\uff0cST-LLC \u76f8\u5173\u6027\u8f83\u9ad8\uff08\u4e2d\u4f4d\u6570\u7ea6 0.75\uff09\uff0c\u800c ST-L1 \u548c ST-TLB \u76f8\u5173\u6027\u4e2d\u7b49\uff08\u4e2d\u4f4d\u6570\u7ea6 0.6\u20130.65\uff09\uff0c\u8bf4\u660e LLC miss \u66f4\u96be\u88ab\u9690\u85cf\uff0cL1 miss \u548c TLB miss \u5219\u90e8\u5206\u53ef\u88ab\u6d41\u6c34\u7ebf\u9690\u85cf\u3002</li> <li>Drained \u7c7b\u4e8b\u4ef6\u4e2d\uff0cDR-L1 \u76f8\u5173\u6027\u8f83\u9ad8\uff08\u4e2d\u4f4d\u6570\u7ea6 0.7\uff09\uff0c\u800c DR-TLB \u548c DR-SQ \u76f8\u5173\u6027\u8f83\u4f4e\uff08\u4e2d\u4f4d\u6570\u7ea6 0.5\u20130.6\uff09\uff0c\u5c24\u5176 DR-SQ\uff08Store Queue stall\uff09\u5206\u5e03\u6700\u5e7f\u3001\u79bb\u7fa4\u503c\u591a\uff0c\u8868\u660e\u5176\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u9ad8\u5ea6\u4f9d\u8d56\u4e0a\u4e0b\u6587\uff0c\u6709\u65f6\u5b8c\u5168\u88ab\u9690\u85cf\uff0c\u6709\u65f6\u4e25\u91cd\u963b\u585e\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5404\u4e8b\u4ef6\u7684\u4e2d\u4f4d\u6570\u76f8\u5173\u7cfb\u6570\uff1a</li> </ul> Event Commit State Median Correlation DR-SQ Drained ~0.5 DR-TLB Drained ~0.55 ST-TLB Stalled ~0.6 ST-L1 Stalled ~0.6 ST-LLC Stalled ~0.75 DR-L1 Drained ~0.7 FL-MB Flushed ~0.85 FL-EX Flushed ~0.9 FL-MO Flushed ~0.85 <ul> <li>\u8be5\u56fe\u63ed\u793a\u4e86\u4f20\u7edf\u57fa\u4e8e PMC \u8ba1\u6570\u7684\u6027\u80fd\u5206\u6790\u7684\u5c40\u9650\u6027\uff1a\u5e76\u975e\u6240\u6709\u4e8b\u4ef6\u8ba1\u6570\u90fd\u80fd\u51c6\u786e\u53cd\u6620\u5176\u5bf9\u6027\u80fd\u7684\u5b9e\u9645\u8d21\u732e\uff0c\u5c24\u5176\u5bf9\u4e8e\u53ef\u88ab\u9690\u85cf\u7684\u4e8b\u4ef6\uff08\u5982 L1 cache miss\u3001store queue stall\uff09\uff0c\u4ec5\u9760\u8ba1\u6570\u65e0\u6cd5\u5224\u65ad\u5176\u662f\u5426\u771f\u6b63\u9020\u6210\u6027\u80fd\u74f6\u9888\u3002</li> <li>TEA \u7684\u4ef7\u503c\u5728\u4e8e\u5b83\u80fd\u76f4\u63a5\u6d4b\u91cf\u6bcf\u4e2a\u6307\u4ee4\u5728 commit \u9636\u6bb5\u66b4\u9732\u7684\u5ef6\u8fdf\uff0c\u5e76\u5c06\u5176\u5f52\u56e0\u4e8e\u5177\u4f53\u7684\u6027\u80fd\u4e8b\u4ef6\u7ec4\u5408\uff0c\u4ece\u800c\u907f\u514d\u4e86\u4e8b\u4ef6\u8ba1\u6570\u4e0e\u6027\u80fd\u5f71\u54cd\u4e4b\u95f4\u5f31\u76f8\u5173\u6027\u5e26\u6765\u7684\u8bef\u5bfc\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-8-error-versus-sampling-frequency","title":"Figure 8: Error versus sampling frequency.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u4e0d\u540c\u6027\u80fd\u5206\u6790\u6280\u672f\u5728\u4e0d\u540c\u91c7\u6837\u9891\u7387\u4e0b\u7684\u8bef\u5dee\u8868\u73b0\uff0c\u6a2a\u8f74\u4e3a\u6280\u672f\u540d\u79f0\uff08IBS\u3001SPE\u3001RIS\u3001NCI-TEA\u3001TEA\uff09\uff0c\u7eb5\u8f74\u4e3a\u8bef\u5dee\u767e\u5206\u6bd4\uff0c\u56fe\u4f8b\u533a\u5206\u4e86\u56db\u79cd\u91c7\u6837\u9891\u7387\uff1a100 Hz\u30011 kHz\u30014 kHz \u548c 8 kHz\u3002</li> <li>\u4ece\u56fe\u4e2d\u53ef\u89c1\uff0cIBS\u3001SPE \u548c RIS \u7684\u8bef\u5dee\u59cb\u7ec8\u7ef4\u6301\u5728\u8f83\u9ad8\u6c34\u5e73\uff08\u7ea6 50%-80%\uff09\uff0c\u4e14\u968f\u91c7\u6837\u9891\u7387\u53d8\u5316\u4e0d\u660e\u663e\uff0c\u8868\u660e\u5176\u8bef\u5dee\u4e3b\u8981\u6e90\u4e8e\u975e\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u673a\u5236\uff0c\u800c\u975e\u91c7\u6837\u7a00\u758f\u6027\u3002</li> <li>NCI-TEA \u5728\u6240\u6709\u91c7\u6837\u9891\u7387\u4e0b\u5747\u663e\u8457\u4f18\u4e8e IBS/SPE/RIS\uff0c\u8bef\u5dee\u8303\u56f4\u7ea6\u4e3a 10%-20%\uff0c\u4f46\u5176\u8bef\u5dee\u4ecd\u968f\u91c7\u6837\u9891\u7387\u589e\u52a0\u800c\u7565\u6709\u4e0b\u964d\uff0c\u8bf4\u660e\u91c7\u6837\u9891\u7387\u5bf9\u5176\u7cbe\u5ea6\u6709\u4e00\u5b9a\u5f71\u54cd\u3002</li> <li>TEA \u8868\u73b0\u51fa\u6700\u4f73\u7684\u7cbe\u5ea6\u548c\u7a33\u5b9a\u6027\uff0c\u8bef\u5dee\u59cb\u7ec8\u4f4e\u4e8e 5%\uff0c\u4e14\u5728 4 kHz \u53ca\u4ee5\u4e0a\u9891\u7387\u65f6\u8bef\u5dee\u7a33\u5b9a\u5728\u7ea6 2%-3%\uff0c\u8fdb\u4e00\u6b65\u63d0\u5347\u81f3 8 kHz \u5e76\u672a\u5e26\u6765\u663e\u8457\u6539\u5584\uff0c\u8868\u660e 4 kHz \u662f\u517c\u987e\u7cbe\u5ea6\u4e0e\u5f00\u9500\u7684\u6700\u4f18\u91c7\u6837\u9891\u7387\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5404\u6280\u672f\u5728\u4e0d\u540c\u91c7\u6837\u9891\u7387\u4e0b\u7684\u5178\u578b\u8bef\u5dee\u8303\u56f4\uff1a</li> </ul> \u6280\u672f 100 Hz 1 kHz 4 kHz 8 kHz IBS ~70%-80% ~65%-75% ~60%-70% ~60%-70% SPE ~70%-80% ~65%-75% ~60%-70% ~60%-70% RIS ~70%-80% ~65%-75% ~60%-70% ~60%-70% NCI-TEA ~20%-30% ~15%-25% ~10%-20% ~10%-15% TEA ~5%-10% ~3%-7% ~2%-3% ~2%-3% <ul> <li>\u7ed3\u8bba\uff1aTEA \u7684\u9ad8\u7cbe\u5ea6\u6e90\u4e8e\u5176\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u673a\u5236\uff0c\u800c\u975e\u4f9d\u8d56\u9ad8\u9891\u91c7\u6837\uff1b4 kHz \u91c7\u6837\u9891\u7387\u5df2\u8db3\u4ee5\u5b9e\u73b0\u63a5\u8fd1\u7406\u8bba\u6781\u9650\u7684\u7cbe\u5ea6\uff0c\u7ee7\u7eed\u63d0\u9ad8\u9891\u7387\u6536\u76ca\u751a\u5fae\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-9-errors-at-instruction-and-function-granularity","title":"Figure 9: Errors at instruction and function granularity.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u4e0d\u540c\u5206\u6790\u7c92\u5ea6\u4e0b\uff0c\u591a\u79cd\u6027\u80fd\u5206\u6790\u6280\u672f\u7684\u8bef\u5dee\u5206\u5e03\u60c5\u51b5\uff0c\u5177\u4f53\u5206\u4e3a (a) Instruction\uff08\u6307\u4ee4\u7ea7\uff09\u548c (b) Function\uff08\u51fd\u6570\u7ea7\uff09\u4e24\u4e2a\u5b50\u56fe\u3002</li> <li>\u8bef\u5dee\u4ee5\u7bb1\u7ebf\u56fe\u5f62\u5f0f\u5448\u73b0\uff0c\u7eb5\u8f74\u4e3a Error\uff08\u8bef\u5dee\u767e\u5206\u6bd4\uff09\uff0c\u6a2a\u8f74\u4e3a\u4e0d\u540c\u6280\u672f\uff1aIBS\u3001SPE\u3001RIS\u3001NCI-TEA \u548c TEA\u3002</li> <li>\u5728 Instruction \u7c92\u5ea6\uff08\u56fe a\uff09\u4e2d\uff1a</li> <li>IBS\u3001SPE\u3001RIS \u7684\u8bef\u5dee\u4e2d\u4f4d\u6570\u5747\u5728 60% \u5de6\u53f3\uff0c\u4e14\u5206\u5e03\u8303\u56f4\u5e7f\uff0c\u6700\u5927\u8bef\u5dee\u63a5\u8fd1 80%\u3002</li> <li>NCI-TEA \u663e\u8457\u4f18\u4e8e\u524d\u4e09\u8005\uff0c\u4e2d\u4f4d\u6570\u8bef\u5dee\u964d\u81f3\u7ea6 20%\u3002</li> <li>TEA \u8868\u73b0\u6700\u4f18\uff0c\u4e2d\u4f4d\u6570\u8bef\u5dee\u4f4e\u4e8e 5%\uff0c\u4e14\u5206\u5e03\u6781\u7a84\uff0c\u6700\u5927\u8bef\u5dee\u4e0d\u8d85\u8fc7 10%\u3002</li> <li>\u5728 Function \u7c92\u5ea6\uff08\u56fe b\uff09\u4e2d\uff1a</li> <li>\u6240\u6709\u6280\u672f\u7684\u8bef\u5dee\u5747\u6709\u6240\u4e0b\u964d\uff0c\u4f46\u76f8\u5bf9\u6392\u540d\u4e0d\u53d8\u3002</li> <li>IBS\u3001SPE\u3001RIS \u4e2d\u4f4d\u6570\u8bef\u5dee\u4ecd\u9ad8\u4e8e 40%\u3002</li> <li>NCI-TEA \u4e2d\u4f4d\u6570\u8bef\u5dee\u7ea6\u4e3a 15%\u3002</li> <li>TEA \u4f9d\u65e7\u6700\u7cbe\u51c6\uff0c\u4e2d\u4f4d\u6570\u8bef\u5dee\u63a5\u8fd1 0%\uff0c\u6700\u5927\u8bef\u5dee\u5c0f\u4e8e 5%\u3002</li> <li>\u8bef\u5dee\u6570\u636e\u5bf9\u6bd4\u8868\uff1a</li> </ul> \u6280\u672f \u6307\u4ee4\u7ea7\u4e2d\u4f4d\u6570\u8bef\u5dee \u51fd\u6570\u7ea7\u4e2d\u4f4d\u6570\u8bef\u5dee IBS ~60% ~45% SPE ~60% ~45% RIS ~60% ~45% NCI-TEA ~20% ~15% TEA &lt;5% ~0% <ul> <li>\u7ed3\u8bba\uff1a\u65e0\u8bba\u5728\u6307\u4ee4\u7ea7\u8fd8\u662f\u51fd\u6570\u7ea7\uff0cTEA \u5747\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u65b9\u6cd5\uff0c\u5c24\u5176\u5728\u7ec6\u7c92\u5ea6\u5206\u6790\u4e2d\u4f18\u52bf\u66f4\u4e3a\u7a81\u51fa\uff0c\u8bc1\u660e\u5176\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u673a\u5236\u80fd\u66f4\u51c6\u786e\u5f52\u56e0\u6027\u80fd\u5f00\u9500\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-10-lbm-performance-analysis-tea-identifies-the-performance-critical-load-whereas-ibs-does-not","title":"Figure 10: Lbm performance analysis. TEA identifies the performance-critical load whereas IBS does not.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Figure 10\uff0c\u7528\u4e8e\u5bf9\u6bd4 TEA \u4e0e IBS \u5728\u5206\u6790 SPEC CPU2017 \u57fa\u51c6\u7a0b\u5e8f lbm \u65f6\u7684\u6027\u80fd\u5256\u6790\u7ed3\u679c\uff0c\u6838\u5fc3\u76ee\u6807\u662f\u63ed\u793a\u54ea\u79cd\u5de5\u5177\u80fd\u51c6\u786e\u8bc6\u522b\u6027\u80fd\u74f6\u9888\u6307\u4ee4\u3002</li> <li>\u56fe (a) \u4e3a TEA \u751f\u6210\u7684 PICS\uff0c\u56fe (b) \u4e3a IBS \u751f\u6210\u7684 PICS\u3002\u4e24\u8005\u5747\u4ee5\u6761\u5f62\u56fe\u5f62\u5f0f\u5c55\u793a\u5404\u6307\u4ee4\u5728\u6267\u884c\u5468\u671f\u4e2d\u7684\u5206\u5e03\uff0c\u6a2a\u8f74\u4e3a\u5468\u671f\u6570\uff08Cycles\uff09\uff0c\u7eb5\u8f74\u4e3a\u6307\u4ee4\u53ca\u5176\u64cd\u4f5c\u7801\u3002</li> <li>TEA \u7684 PICS \u663e\u793a\uff1a</li> <li>\u6700\u663e\u8457\u7684\u6027\u80fd\u74f6\u9888\u662f <code>lw t4,152(a0)</code> \u6307\u4ee4\uff0c\u5176\u8d21\u732e\u4e86\u7ea6 692B \u5468\u671f\u3002</li> <li>\u8be5\u6307\u4ee4\u7684\u6027\u80fd\u635f\u5931\u4e3b\u8981\u5f52\u56e0\u4e8e ST-LLC\uff08L3 \u7f13\u5b58\u672a\u547d\u4e2d\uff09\u548c ST-TLB\uff08\u6570\u636e TLB \u672a\u547d\u4e2d\uff09\u4e8b\u4ef6\u7ec4\u5408\uff0c\u8868\u660e\u5176\u8d1f\u8f7d\u5ef6\u8fdf\u65e0\u6cd5\u88ab\u9690\u85cf\u3002</li> <li>\u5176\u4ed6\u6307\u4ee4\u5982 <code>fld ft6,(a0)</code>\u3001<code>andi t5,t4,1</code> \u7b49\u8d21\u732e\u8f83\u5c0f\uff0c\u4e14\u65e0\u663e\u8457\u6027\u80fd\u4e8b\u4ef6\u6807\u8bb0\u3002</li> <li>IBS \u7684 PICS \u663e\u793a\uff1a</li> <li>\u6027\u80fd\u70ed\u70b9\u88ab\u9519\u8bef\u5730\u5f52\u56e0\u4e8e\u591a\u4e2a\u6d6e\u70b9\u8fd0\u7b97\u6307\u4ee4\uff0c\u5982 <code>fmul.d fs9,fs5,fs8</code>\u3001<code>fdiv.d fs1,fs5,fs5</code> \u7b49\u3002</li> <li>\u8fd9\u4e9b\u6307\u4ee4\u5728 IBS \u4e0b\u663e\u793a\u9ad8\u5468\u671f\u6d88\u8017\uff0c\u4f46\u5b9e\u9645\u5e76\u975e\u6027\u80fd\u74f6\u9888\uff0c\u800c\u662f\u56e0\u4e3a\u5b83\u4eec\u5728\u524d\u7aef\u88ab\u8c03\u5ea6\u65f6\uff0c\u771f\u6b63\u7684\u74f6\u9888\u6307\u4ee4 <code>lw</code> \u6b63\u5904\u4e8e ROB \u5934\u90e8\u963b\u585e\u72b6\u6001\u3002</li> <li>IBS \u672a\u80fd\u6b63\u786e\u5173\u8054\u6027\u80fd\u4e8b\u4ef6\u4e0e\u771f\u6b63\u5bfc\u81f4\u505c\u6ede\u7684\u6307\u4ee4\uff0c\u5bfc\u81f4\u8bef\u5bfc\u6027\u7ed3\u8bba\u3002</li> <li>\u4e24\u56fe\u5bf9\u6bd4\u51f8\u663e TEA \u7684\u65f6\u95f4\u6bd4\u4f8b\u7279\u6027\uff1a\u5b83\u53ea\u5728\u6307\u4ee4\u66b4\u9732\u5ef6\u8fdf\u65f6\u91c7\u6837\uff08\u5373 commit \u9636\u6bb5\uff09\uff0c\u4ece\u800c\u51c6\u786e\u5f52\u56e0\u6027\u80fd\u635f\u5931\uff1b\u800c IBS \u5728 dispatch \u9636\u6bb5\u91c7\u6837\uff0c\u6355\u83b7\u7684\u662f\u524d\u7aef\u884c\u4e3a\uff0c\u800c\u975e\u5b9e\u9645\u5f71\u54cd\u6267\u884c\u65f6\u95f4\u7684\u6307\u4ee4\u3002</li> <li>\u5173\u952e\u672f\u8bed\u4fdd\u7559\u82f1\u6587\uff1aPICS\uff08Per-Instruction Cycle Stacks\uff09\u3001TEA\uff08Time-Proportional Event Analysis\uff09\u3001IBS\uff08Instruction-Based Sampling\uff09\u3001ST-LLC\u3001ST-TLB\u3002</li> <li>\u6570\u636e\u5bf9\u6bd4\u8868\uff1a</li> </ul> \u5de5\u5177 \u4e3b\u8981\u6027\u80fd\u74f6\u9888\u6307\u4ee4 \u4e3b\u8981\u6027\u80fd\u4e8b\u4ef6 \u5468\u671f\u8d21\u732e \u51c6\u786e\u6027 TEA <code>lw t4,152(a0)</code> ST-LLC, ST-TLB ~692B \u9ad8 IBS <code>fmul.d fs9,fs5,fs8</code> \u7b49 \u65e0\u660e\u786e\u4e8b\u4ef6 &gt;100B \u4f4e <ul> <li>\u7ed3\u8bba\uff1aTEA \u80fd\u7cbe\u51c6\u5b9a\u4f4d lbm \u4e2d\u7684\u6027\u80fd\u5173\u952e\u8d1f\u8f7d\u6307\u4ee4\u53ca\u5176\u6839\u672c\u539f\u56e0\uff08LLC \u548c TLB \u672a\u547d\u4e2d\uff09\uff0c\u800c IBS \u56e0\u975e\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u673a\u5236\u4ea7\u751f\u8bef\u5bfc\u6027\u7ed3\u679c\uff0c\u65e0\u6cd5\u6709\u6548\u6307\u5bfc\u4f18\u5316\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-11-pics-and-speedup-for-the-most-performancecritical-load-instruction-and-store-instruction-of-lbm-across-a-range-of-prefetch-distances","title":"Figure 11: PICS and speedup for the most performancecritical load instruction and store instruction of lbm across a range of prefetch distances.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u4e0d\u540c\u9884\u53d6\u8ddd\u79bb\uff08Prefetch Distance, Pf 1 \u81f3 Pf 8\uff09\u4e0b\uff0clbm \u57fa\u51c6\u7a0b\u5e8f\u4e2d\u6700\u5173\u952e\u7684 load \u548c store \u6307\u4ee4\u7684 Per-Instruction Cycle Stacks (PICS) \u53ca\u5176\u5bf9\u5e94\u7684 Speedup\u3002</li> <li>\u5de6\u4fa7 Y \u8f74\u4e3a Cycles\uff0c\u53f3\u4fa7 Y \u8f74\u4e3a Speedup\uff0cX \u8f74\u4e3a\u9884\u53d6\u8ddd\u79bb\u914d\u7f6e\uff0c\u4ece\u539f\u59cb\u7248\u672c\uff08Orig.\uff09\u5230 Pf 8\u3002</li> <li>\u56fe\u4e2d\u67f1\u72b6\u56fe\u8868\u793a\u5404\u4e8b\u4ef6\u7c7b\u522b\u5bf9\u6267\u884c\u5468\u671f\u7684\u8d21\u732e\uff0c\u989c\u8272\u5bf9\u5e94\u4e0d\u540c\u6027\u80fd\u4e8b\u4ef6\uff1a</li> <li>base: \u65e0\u6027\u80fd\u4e8b\u4ef6\u7684\u57fa\u7840\u6267\u884c\u5468\u671f\u3002</li> <li>others: \u5176\u4ed6\u672a\u5206\u7c7b\u4e8b\u4ef6\u3002</li> <li>ST-TLB: \u6570\u636e TLB \u7f3a\u5931\u5bfc\u81f4\u7684\u505c\u6ede\u3002</li> <li>ST-TLB,DR-SQ: TLB \u7f3a\u5931\u4e0e\u5b58\u50a8\u961f\u5217\u6ee1\u7684\u7ec4\u5408\u4e8b\u4ef6\u3002</li> <li>DR-SQ: \u5b58\u50a8\u961f\u5217\u6ee1\u5bfc\u81f4\u7684\u524d\u7aef\u6392\u7a7a\u3002</li> <li>ST-L1: L1 \u6570\u636e\u7f13\u5b58\u7f3a\u5931\u3002</li> <li>ST-LLC: LLC \u7f13\u5b58\u7f3a\u5931\u3002</li> <li>\u7ea2\u8272\u6298\u7ebf\u8868\u793a\u76f8\u5bf9\u4e8e\u539f\u59cb\u7248\u672c\u7684 Speedup\uff0c\u968f\u9884\u53d6\u8ddd\u79bb\u589e\u52a0\u5148\u4e0a\u5347\u540e\u4e0b\u964d\uff0c\u5728 Pf 4 \u8fbe\u5230\u5cf0\u503c\u7ea6 1.28\u00d7\u3002</li> <li>\u5728\u539f\u59cb\u7248\u672c\u4e2d\uff0cload \u6307\u4ee4\uff08ld\uff09\u4e3b\u5bfc\u5468\u671f\u6d88\u8017\uff0c\u4e3b\u8981\u5f52\u56e0\u4e8e ST-LLC\uff08562B cycles\uff09\uff0c\u8868\u660e\u5176\u5de5\u4f5c\u96c6\u8d85\u51fa LLC \u5bb9\u91cf\u3002</li> <li>\u968f\u7740\u9884\u53d6\u8ddd\u79bb\u589e\u52a0\uff0cST-LLC \u5468\u671f\u663e\u8457\u51cf\u5c11\uff0cST-L1 \u5468\u671f\u4e0a\u5347\uff0c\u8bf4\u660e\u9884\u53d6\u6210\u529f\u5c06\u90e8\u5206 LLC \u7f3a\u5931\u8f6c\u5316\u4e3a L1 \u547d\u4e2d\u3002</li> <li>\u5f53\u9884\u53d6\u8ddd\u79bb\u8d85\u8fc7 4\uff08\u5982 Pf 5\u20138\uff09\uff0cDR-SQ \u548c ST-TLB,DR-SQ \u5468\u671f\u5f00\u59cb\u589e\u957f\uff0c\u8868\u660e\u9884\u53d6\u5f15\u5165\u4e86\u5b58\u50a8\u5e26\u5bbd\u74f6\u9888\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5173\u952e\u6570\u636e\u70b9\uff1a</li> </ul> \u914d\u7f6e Load \u6307\u4ee4\u603b\u5468\u671f Store \u6307\u4ee4\u603b\u5468\u671f Speedup Orig. 692B \u2014 1.00 Pf 4 ~50B (ST-L1\u4e3a\u4e3b) \u663e\u8457\u589e\u52a0 1.28\u00d7 <ul> <li>TEA \u7684 PICS \u6e05\u6670\u63ed\u793a\u4e86\u6027\u80fd\u74f6\u9888\u4ece load latency \u5411 store bandwidth \u7684\u8f6c\u79fb\uff0c\u6307\u5bfc\u5f00\u53d1\u8005\u9009\u62e9\u6700\u4f18\u9884\u53d6\u8ddd\u79bb\uff08Pf 3 \u6216 Pf 4\uff09\u4ee5\u5e73\u8861\u4e24\u8005\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/figs_notes/#figure-12-nab-performance-analysis-tea-identifies-that-the-fsqrtd-instruction-issues-too-late-to-hide-its-execution-latency","title":"Figure 12: Nab performance analysis. TEA identifies that the fsqrt.d instruction issues too late to hide its execution latency.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u5206\u6790 SPEC CPU2017 \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f nab \u65f6\uff0cTEA \u4e0e IBS \u751f\u6210\u7684 Per-Instruction Cycle Stacks\uff08PICS\uff09\u5bf9\u6bd4\uff0c\u65e8\u5728\u8bf4\u660e TEA \u5982\u4f55\u51c6\u786e\u8bc6\u522b\u6027\u80fd\u74f6\u9888\u3002</li> <li>\u5de6\u4fa7\u5b50\u56fe (a) \u4e3a TEA \u751f\u6210\u7684 PICS\uff0c\u53f3\u4fa7\u5b50\u56fe (b) \u4e3a IBS \u751f\u6210\u7684 PICS\u3002\u4e24\u8005\u5747\u805a\u7126\u4e8e\u5305\u542b\u5173\u952e\u6307\u4ee4 <code>fsqrt.d</code> \u7684\u4ee3\u7801\u533a\u57df\u3002</li> <li>\u4e24\u56fe\u4e2d\u6a2a\u8f74\u5747\u4e3a Cycles\uff08\u5468\u671f\u6570\uff09\uff0c\u7eb5\u8f74\u5217\u51fa\u5404\u9759\u6001\u6307\u4ee4\uff0c\u5305\u62ec <code>fmv.d.x</code>, <code>frflags</code>, <code>flt.d</code>, <code>beqz</code>, <code>j</code>, <code>fsqrt.d</code>, <code>slli</code> \u7b49\u3002</li> <li>\u56fe\u4f8b\u663e\u793a\u4e24\u79cd\u5206\u7c7b\uff1aFlushing instruction\uff08\u7d2b\u8272\uff09\u548c base\uff08\u9ed1\u8272\uff09\u3002\u524d\u8005\u6307\u5bfc\u81f4\u6d41\u6c34\u7ebf\u51b2\u5237\u7684\u6307\u4ee4\uff0c\u540e\u8005\u6307\u65e0\u6027\u80fd\u4e8b\u4ef6\u5f71\u54cd\u7684\u6b63\u5e38\u6267\u884c\u3002</li> <li>\u5728 TEA \u7684 PICS \u4e2d\uff0c<code>fsqrt.d</code> \u6307\u4ee4\u5360\u636e\u6700\u957f\u6761\u5f62\uff0c\u5176\u5927\u90e8\u5206\u5468\u671f\u5f52\u56e0\u4e8e base \u7c7b\u522b\uff0c\u8868\u660e\u8be5\u6307\u4ee4\u672c\u8eab\u672a\u906d\u9047\u7f13\u5b58\u7f3a\u5931\u6216 TLB \u7f3a\u5931\u7b49\u4e8b\u4ef6\uff0c\u4f46\u56e0\u5176\u6267\u884c\u5ef6\u8fdf\u672a\u88ab\u9690\u85cf\u800c\u6210\u4e3a\u6027\u80fd\u74f6\u9888\u3002</li> <li>TEA \u540c\u65f6\u6307\u51fa\uff0c<code>frflags</code> \u548c <code>flt.d</code> \u7b49\u524d\u5e8f\u6307\u4ee4\u5c5e\u4e8e Flushing instruction\uff0c\u5b83\u4eec\u89e6\u53d1\u4e86\u6d41\u6c34\u7ebf\u51b2\u5237\uff0c\u5bfc\u81f4 <code>fsqrt.d</code> \u88ab\u5ef6\u8fdf\u53d1\u5c04\uff0c\u4ece\u800c\u65e0\u6cd5\u9690\u85cf\u5176\u957f\u6267\u884c\u5ef6\u8fdf\u3002</li> <li>\u76f8\u6bd4\u4e4b\u4e0b\uff0cIBS \u751f\u6210\u7684 PICS \u663e\u793a <code>fsqrt.d</code> \u7684\u5468\u671f\u8d21\u732e\u88ab\u4e25\u91cd\u4f4e\u4f30\uff0c\u4e14\u5176\u4e3b\u8981\u5468\u671f\u88ab\u9519\u8bef\u5f52\u56e0\u4e8e Flushing instruction \u7c7b\u522b\uff0c\u8fd9\u4e0e\u5176\u5b9e\u9645\u884c\u4e3a\u4e0d\u7b26\u3002</li> <li>IBS \u7684\u8bef\u5dee\u6e90\u4e8e\u5176\u5728 dispatch \u9636\u6bb5\u6807\u8bb0\u6307\u4ee4\uff0c\u800c\u975e\u5728 commit \u9636\u6bb5\u91c7\u6837\u3002\u56e0\u6b64\uff0c\u5b83\u6355\u83b7\u7684\u662f\u5728 <code>fsqrt.d</code> \u88ab\u963b\u585e\u671f\u95f4\u8c03\u5ea6\u7684\u6307\u4ee4\uff0c\u800c\u975e\u771f\u6b63\u9020\u6210\u6027\u80fd\u635f\u5931\u7684\u6307\u4ee4\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e86\u5173\u952e\u6307\u4ee4\u5728 TEA \u4e0e IBS \u4e2d\u7684\u5468\u671f\u5f52\u7c7b\u5dee\u5f02\uff1a</li> </ul> \u6307\u4ee4 TEA \u5f52\u7c7b IBS \u5f52\u7c7b \u8bf4\u660e <code>fsqrt.d</code> \u4e3b\u8981\u4e3a base \u4e3b\u8981\u4e3a Flushing TEA \u6b63\u786e\u53cd\u6620\u5176\u65e0\u4e8b\u4ef6\u4f46\u5ef6\u8fdf\u672a\u88ab\u9690\u85cf <code>frflags</code> Flushing Flushing \u4e24\u8005\u5747\u6b63\u786e\u8bc6\u522b\u5176\u51b2\u5237\u884c\u4e3a <code>flt.d</code> Flushing Flushing \u4e24\u8005\u5747\u6b63\u786e\u8bc6\u522b\u5176\u51b2\u5237\u884c\u4e3a <code>beqz</code> Flushing Flushing \u4e24\u8005\u5747\u6b63\u786e\u8bc6\u522b\u5176\u51b2\u5237\u884c\u4e3a <ul> <li>\u8be5\u56fe\u76f4\u89c2\u8bc1\u660e\u4e86 TEA \u7684\u65f6\u95f4\u6bd4\u4f8b\u6027\u4f7f\u5176\u80fd\u51c6\u786e\u5f52\u56e0\u6027\u80fd\u635f\u5931\uff0c\u800c IBS \u56e0\u975e\u65f6\u95f4\u6bd4\u4f8b\u6027\u5bfc\u81f4\u5bf9\u5173\u952e\u6307\u4ee4 <code>fsqrt.d</code> \u7684\u6027\u80fd\u5f71\u54cd\u8bc4\u4f30\u51fa\u73b0\u91cd\u5927\u504f\u5dee\u3002</li> <li>\u6700\u7ec8\u7ed3\u8bba\uff1aTEA \u80fd\u63ed\u793a <code>fsqrt.d</code> \u6027\u80fd\u95ee\u9898\u7684\u6839\u672c\u539f\u56e0\u2014\u2014\u524d\u5e8f\u6307\u4ee4\u5f15\u53d1\u7684\u6d41\u6c34\u7ebf\u51b2\u5237\u5bfc\u81f4\u5176\u53d1\u5c04\u8fc7\u665a\uff0c\u800c IBS \u65e0\u6cd5\u63d0\u4f9b\u6b64\u6d1e\u5bdf\uff0c\u51f8\u663e\u4e86 TEA \u5728\u6027\u80fd\u5206\u6790\u4e2d\u7684\u4f18\u8d8a\u6027\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/","title":"TEA: Time-Proportional Event Analysis \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Bj\u00f6rn Gottschall - Lieven Eeckhout - Magnus Jahre</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - Proceedings of the 50th Annual International Symposium on Computer Architecture (ISCA \u201923)</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - 2023</p>"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u5f53\u524d\u6027\u80fd\u5206\u6790\u5de5\u5177\u65e0\u6cd5\u6709\u6548\u89e3\u91ca\u201c\u4e3a\u4f55\u6267\u884c\u5e94\u7528\u7a0b\u5e8f\u7684\u6027\u80fd\u5173\u952e\u6307\u4ee4\u4f1a\u8017\u8d39\u65f6\u95f4\u201d\u8fd9\u4e00\u6839\u672c\u95ee\u9898\u3002 - \u63d0\u51fa\u4e00\u79cd\u80fd\u540c\u65f6\u56de\u7b54\u201c\u54ea\u4e9b\u6307\u4ee4\u662f\u6027\u80fd\u5173\u952e\u7684\u201d\uff08Q1\uff09\u548c\u201c\u4e3a\u4f55\u8fd9\u4e9b\u6307\u4ee4\u662f\u6027\u80fd\u5173\u952e\u7684\u201d\uff08Q2\uff09\u7684\u7edf\u4e00\u5206\u6790\u65b9\u6cd5\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa Time-Proportional Event Analysis (TEA)\uff0c\u5176\u6838\u5fc3\u662f\u521b\u5efa \u65f6\u95f4\u6bd4\u4f8b\u5316\u7684\u6bcf\u6307\u4ee4\u5468\u671f\u6808 (Per-Instruction Cycle Stacks, PICS)\u3002 - PICS \u901a\u8fc7\u5728\u6307\u4ee4\u63d0\u4ea4\u9636\u6bb5\u8fdb\u884c\u7edf\u8ba1\u91c7\u6837\uff0c\u786e\u4fdd\u6bcf\u4e2a\u9759\u6001\u6307\u4ee4\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\u4e0e\u5176\u5b9e\u9645\u8017\u65f6\u6210\u6b63\u6bd4\u3002 - \u4e3a\u8ffd\u8e2a\u5bfc\u81f4\u6027\u80fd\u635f\u5931\u7684\u5fae\u67b6\u6784\u4e8b\u4ef6\uff0cTEA \u4e3a\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\u5206\u914d\u4e00\u4e2a \u6027\u80fd\u7b7e\u540d\u5411\u91cf (Performance Signature Vector, PSV)\uff0c\u7528\u4ee5\u8bb0\u5f55\u8be5\u6307\u4ee4\u5728\u5176\u751f\u547d\u5468\u671f\u5185\u6240\u906d\u9047\u7684\u6027\u80fd\u4e8b\u4ef6\u3002 - \u4e3a\u5e73\u8861\u6d1e\u5bdf\u529b\u4e0e\u5f00\u9500\uff0cTEA \u7cbe\u5fc3\u9009\u62e9\u4e86 9\u4e2a\u5173\u952e\u6027\u80fd\u4e8b\u4ef6\uff0c\u8986\u76d6\u4e86\u63d0\u4ea4\u9636\u6bb5\u7684\u4e09\u79cd\u975e\u8ba1\u7b97\u72b6\u6001\uff1aStalled\uff08\u6267\u884c\u505c\u987f\uff09\u3001Drained\uff08\u524d\u7aef\u505c\u987f\uff09\u548c Flushed\uff08\u6d41\u6c34\u7ebf\u51b2\u5237\uff09\u3002 - TEA \u5728 Berkeley Out-of-Order Machine (BOOM) \u6838\u5fc3\u4e2d\u5b9e\u73b0\u4e86RTL\u7ea7\u786c\u4ef6\u652f\u6301\uff0c\u5e76\u5229\u7528Linux perf\u8fdb\u884c\u6837\u672c\u6536\u96c6\u548c\u540e\u5904\u7406\u4ee5\u751f\u6210PICS\u3002</p> <p></p> <p>Figure 3: Performance event hierarchy for the Stalled (ST) commit state.</p> <p></p> <p>Figure 4: TEA microarchitecture.</p> <p>\u7ed3\u679c - \u51c6\u786e\u6027: \u4e0e\u4e00\u4e2a\u4e0d\u53ef\u5b9e\u73b0\u7684\u201c\u9ec4\u91d1\u53c2\u8003\u201d\uff08\u6355\u83b7\u6240\u6709\u52a8\u6001\u6307\u4ee4\u7684\u6240\u6709\u5468\u671f\uff09\u76f8\u6bd4\uff0cTEA\u7684\u5e73\u5747\u8bef\u5dee\u4ec5\u4e3a 2.1%\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0cAMD IBS\u3001Arm SPE\u548cIBM RIS\u7684\u5e73\u5747\u8bef\u5dee\u5206\u522b\u9ad8\u8fbe 55.6%\u300155.5% \u548c 56.0%\u3002 - \u5f00\u9500:    - \u6027\u80fd\u5f00\u9500: \u5e73\u5747\u4ec5\u4e3a 1.1%\u3002   - \u529f\u8017\u5f00\u9500: \u6bcf\u6838\u4ec5\u589e\u52a0\u7ea6 3.2 mW\uff08\u7ea6 0.1%\uff09\u3002   - \u5b58\u50a8\u5f00\u9500: \u6bcf\u6838 249\u5b57\u8282\u3002 - \u5b9e\u7528\u6027:    - \u6210\u529f\u8bc6\u522b\u5e76\u4f18\u5316\u4e86SPEC CPU2017\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u7684\u4e24\u4e2a\u6848\u4f8b\uff1a     - lbm: \u901a\u8fc7TEA\u6307\u5bfc\u7684\u8f6f\u4ef6\u9884\u53d6\u4f18\u5316\uff0c\u83b7\u5f97 1.28\u500d \u52a0\u901f\u3002     - nab: \u901a\u8fc7TEA\u53d1\u73b0\u6d6e\u70b9\u5e73\u65b9\u6839\u6307\u4ee4\u56e0\u6d41\u6c34\u7ebf\u51b2\u5237\u800c\u5ef6\u8fdf\u6267\u884c\uff0c\u4f7f\u7528<code>\u2013fast-math</code>\u7f16\u8bd1\u9009\u9879\u540e\u83b7\u5f97 2.45\u500d \u52a0\u901f\u3002 - \u5bf9\u6bd4\u5206\u6790:    - \u6307\u4ee4\u9a71\u52a8\u65b9\u6cd5\uff08\u5982IBS\uff09\u56e0\u5728fetch/dispatch\u9636\u6bb5\u6807\u8bb0\u6307\u4ee4\uff0c\u5bfc\u81f4\u6027\u80fd\u5256\u6790\u975e\u65f6\u95f4\u6bd4\u4f8b\u5316\uff0c\u4e25\u91cd\u5931\u771f\u3002   - \u4e8b\u4ef6\u9a71\u52a8\u65b9\u6cd5\uff08\u5982PMC\u8ba1\u6570\uff09\u56e0\u65e0\u6cd5\u533a\u5206\u9690\u85cf\u4e0e\u975e\u9690\u85cf\u7684\u5ef6\u8fdf\uff0c\u5176\u4e8b\u4ef6\u8ba1\u6570\u4e0e\u5b9e\u9645\u6027\u80fd\u5f71\u54cd\u7684\u76f8\u5173\u6027\u5f88\u5dee\u3002</p> <p></p> <p>Figure 5: Quantifying the error for the PICS obtained through IBS, SPE, RIS, NCI-TEA, and TEA. TEA achieves the highest accuracy within 2.1% (and at most 7.7%) compared to the golden reference.</p> <p></p> <p>Figure 6: PICS for the top-3 instructions as provided by IBS, TEA, and the golden reference (GR). The PICS provided by TEA are accurate compared to the golden reference, in contrast to IBS.</p> <p></p> <p>Figure 7: Quantifying the correlation between event count and its impact on performance. Some event counts correlate strongly with their impact on performance while others do not.</p> <p>\u7ed3\u8bba - TEA\u901a\u8fc7\u521b\u5efa\u65f6\u95f4\u6bd4\u4f8b\u5316\u7684PICS\uff0c\u6210\u529f\u5730\u5c06\u6027\u80fd\u5256\u6790\u4e0e\u6027\u80fd\u4e8b\u4ef6\u5206\u6790\u7edf\u4e00\u8d77\u6765\uff0c\u80fd\u591f\u7cbe\u51c6\u5730\u89e3\u91ca\u6027\u80fd\u74f6\u9888\u7684\u6839\u672c\u539f\u56e0\u3002 - \u5176\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u786c\u4ef6\u652f\u6301\u5728\u5f15\u5165\u6781\u4f4e\u5f00\u9500\u7684\u540c\u65f6\uff0c\u63d0\u4f9b\u4e86\u8fdc\u8d85\u73b0\u6709\u6280\u672f\uff08\u5982IBS, SPE, RIS\uff09\u7684\u5206\u6790\u7cbe\u5ea6\u3002 - TEA\u7684\u6709\u6548\u6027\u5df2\u5728\u771f\u5b9e\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u5f97\u5230\u9a8c\u8bc1\uff0c\u80fd\u591f\u6307\u5bfc\u5f00\u53d1\u8005\u53d1\u73b0\u5e76\u89e3\u51b3\u90a3\u4e9b\u4f20\u7edf\u5de5\u5177\u96be\u4ee5\u5b9a\u4f4d\u7684\u590d\u6742\u6027\u80fd\u95ee\u9898\uff0c\u4ece\u800c\u83b7\u5f97\u663e\u8457\u7684\u6027\u80fd\u63d0\u5347\u3002</p>"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f\u4e0e\u52a8\u673a</p> <ul> <li>\u968f\u7740 Dennard scaling \u548c Moore's law \u7684\u7ec8\u7ed3\uff0cCPU \u67b6\u6784\u8f6c\u5411\u5f02\u6784\u5316\u548c\u4e13\u4e1a\u5316\uff0c\u4f7f\u5f97\u4f18\u5316\u4e32\u884c CPU \u4ee3\u7801\u53d8\u5f97\u6108\u53d1\u5173\u952e\uff08\u53d7 Amdahl\u2019s Law \u5f71\u54cd\uff09\u3002</li> <li>\u73b0\u6709\u6027\u80fd\u5206\u6790\u5de5\u5177\u96be\u4ee5\u6709\u6548\u6307\u5bfc\u4f18\u5316\uff0c\u56e0\u4e3a\u5b83\u4eec\u65e0\u6cd5\u540c\u65f6\u56de\u7b54\u4e24\u4e2a\u6838\u5fc3\u95ee\u9898\uff1a</li> <li>Q1: \u5e94\u7528\u7a0b\u5e8f\u5728\u54ea\u4e9b\u6307\u4ee4\u4e0a\u82b1\u8d39\u4e86\u6700\u591a\u65f6\u95f4\uff1f\uff08\u5373\uff0c\u54ea\u4e9b\u662f\u6307\u4ee4\u662f performance-critical\uff1f\uff09</li> <li>Q2: \u4e3a\u4ec0\u4e48\u8fd9\u4e9b\u6307\u4ee4\u662f\u6027\u80fd\u5173\u952e\u7684\uff1f\u662f\u7531\u54ea\u4e9b microarchitectural events\uff08\u5982\u7f13\u5b58\u672a\u547d\u4e2d\u3001\u5206\u652f\u8bef\u9884\u6d4b\uff09\u5bfc\u81f4\u7684\uff1f</li> <li>\u5f53\u524d\u7684\u6027\u80fd\u5206\u6790\u65b9\u6cd5\u5b58\u5728\u6839\u672c\u6027\u7f3a\u9677\uff1a</li> <li>Instruction-driven approaches (\u5982 AMD IBS, Arm SPE, IBM RIS) \u5728 fetch \u6216 dispatch \u9636\u6bb5\u6807\u8bb0\u6307\u4ee4\uff0c\u5bfc\u81f4\u5176\u5206\u6790\u7ed3\u679c\u975e\u65f6\u95f4\u6bd4\u4f8b\uff08non-time-proportional\uff09\uff0c\u504f\u5411\u4e8e\u5728\u524d\u7aef\u505c\u7559\u65f6\u95f4\u957f\u7684\u6307\u4ee4\uff0c\u800c\u975e\u771f\u6b63\u66b4\u9732\u5ef6\u8fdf\u7684\u6307\u4ee4\u3002</li> <li>Event-driven approaches \u4ec5\u7edf\u8ba1\u4e8b\u4ef6\u8ba1\u6570\uff0c\u4f46\u8fd9\u4e9b\u8ba1\u6570\u4e0e\u4e8b\u4ef6\u5bf9\u6027\u80fd\u7684\u5b9e\u9645\u5f71\u54cd\uff08\u5373\u9020\u6210\u7684\u5ef6\u8fdf\uff09\u76f8\u5173\u6027\u5f88\u5dee\uff0c\u56e0\u4e3a\u73b0\u4ee3\u5904\u7406\u5668\u7684 latency hiding \u673a\u5236\u4f1a\u63a9\u76d6\u8bb8\u591a\u4e8b\u4ef6\u7684\u5f71\u54cd\u3002</li> </ul> <p></p> <p>Figure 7: Quantifying the correlation between event count and its impact on performance. Some event counts correlate strongly with their impact on performance while others do not.</p> <p>\u6838\u5fc3\u8d21\u732e</p> <ul> <li>\u63d0\u51fa Time-Proportional Event Analysis (TEA)\uff0c\u901a\u8fc7\u6784\u5efa \u65f6\u95f4\u6bd4\u4f8b\u7684\u6bcf\u6307\u4ee4\u5468\u671f\u6808 (Per-Instruction Cycle Stacks, PICS) \u6765\u7edf\u4e00\u56de\u7b54 Q1 \u548c Q2\u3002PICS \u7684\u7279\u6027\u662f\uff1a</li> <li>\u6808\u7684\u9ad8\u5ea6\u4e0e\u8be5\u9759\u6001\u6307\u4ee4\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\u6210\u6b63\u6bd4\uff08\u56de\u7b54 Q1\uff09\u3002</li> <li>\u6808\u5185\u5404\u7ec4\u6210\u90e8\u5206\u7684\u5927\u5c0f\u4e0e\uff08\u7ec4\u5408\uff09\u6027\u80fd\u4e8b\u4ef6\u5bf9\u6574\u4f53\u6027\u80fd\u7684\u5f71\u54cd\u6210\u6b63\u6bd4\uff08\u56de\u7b54 Q2\uff09\u3002</li> <li>\u8bbe\u8ba1\u5e76\u5b9e\u73b0\u4e86 TEA \u7684\u786c\u4ef6\u652f\u6301\u673a\u5236\uff0c\u5305\u62ec\u4e3a\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\u5206\u914d\u4e00\u4e2a Performance Signature Vector (PSV) \u6765\u8ffd\u8e2a\u5176\u7ecf\u5386\u7684\u5173\u952e\u4e8b\u4ef6\uff0c\u5e76\u91c7\u7528\u4e0e TIP \u76f8\u540c\u7684\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u7b56\u7565\u3002</li> <li>\u901a\u8fc7\u7cbe\u5fc3\u9009\u62e9 9 \u4e2a\u5173\u952e\u6027\u80fd\u4e8b\u4ef6\uff08\u57fa\u4e8e\u4e8b\u4ef6\u5c42\u7ea7\u7ed3\u6784\uff09\uff0c\u5728\u4fdd\u6301\u6781\u4f4e\u5f00\u9500\u7684\u540c\u65f6\u6355\u83b7\u4e86\u4e3b\u8981\u6027\u80fd\u74f6\u9888\u3002\u8bc4\u4f30\u663e\u793a\uff0c99% \u672a\u88ab TEA \u4e8b\u4ef6\u6807\u8bb0\u7684\u6307\u4ee4\u6240\u9020\u6210\u7684\u505c\u987f\u5c11\u4e8e 5.8 \u4e2a\u65f6\u949f\u5468\u671f\u3002</li> <li>\u5728 BOOM \u6838\u5fc3\u4e0a\u7684 RTL \u5b9e\u73b0\u8bc1\u660e\u4e86 TEA \u7684\u9ad8\u6548\u6027\uff1a</li> <li>\u5b58\u50a8\u5f00\u9500\uff1a\u4ec5 249 \u5b57\u8282/\u6838\u3002</li> <li>\u529f\u8017\u5f00\u9500\uff1a\u7ea6 3.2 mW (\u223c0.1%)\u3002</li> <li>\u6027\u80fd\u5f00\u9500\uff1a\u5e73\u5747 1.1%\u3002</li> <li>TEA \u7684\u51c6\u786e\u6027\u8fdc\u8d85\u73b0\u6709\u6280\u672f\u3002\u76f8\u6bd4\u4e00\u4e2a\u7406\u60f3\u7684\u201c\u9ec4\u91d1\u6807\u51c6\u201d\uff0cTEA \u7684\u5e73\u5747\u8bef\u5dee\u4ec5\u4e3a 2.1%\uff0c\u800c IBS\u3001SPE \u548c RIS \u7684\u5e73\u5747\u8bef\u5dee\u5206\u522b\u9ad8\u8fbe 55.6%\u300155.5% \u548c 56.0%\u3002</li> </ul> \u65b9\u6cd5 \u5e73\u5747\u8bef\u5dee \u6700\u5927\u8bef\u5dee TEA 2.1% 7.7% NCI-TEA 11.3% 22.0% RIS 56.0% 79.7% IBS 55.6% 79.7% SPE 55.5% 79.7% <p></p> <p>Figure 5: Quantifying the error for the PICS obtained through IBS, SPE, RIS, NCI-TEA, and TEA. TEA achieves the highest accuracy within 2.1% (and at most 7.7%) compared to the golden reference.</p> <ul> <li>\u901a\u8fc7 SPEC CPU2017 \u57fa\u51c6\u6d4b\u8bd5\u4e2d\u7684 lbm \u548c nab \u6848\u4f8b\u7814\u7a76\uff0c\u9a8c\u8bc1\u4e86 TEA \u7684\u5b9e\u7528\u6027\u3002TEA \u6210\u529f\u8bc6\u522b\u51fa\u4f20\u7edf\u5de5\u5177\u96be\u4ee5\u53d1\u73b0\u7684\u6027\u80fd\u95ee\u9898\uff0c\u5e76\u6307\u5bfc\u4f18\u5316\u5206\u522b\u83b7\u5f97\u4e86 1.28\u00d7 \u548c 2.45\u00d7 \u7684\u52a0\u901f\u6bd4\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>TEA (Time-Proportional Event Analysis) \u7684\u6838\u5fc3\u76ee\u6807\u662f\u6784\u5efa \u65f6\u95f4\u6bd4\u4f8b\u5316\uff08time-proportional\uff09\u7684 Per-Instruction Cycle Stacks (PICS)\uff0c\u4ee5\u7edf\u4e00\u56de\u7b54\u6027\u80fd\u5206\u6790\u4e2d\u7684\u4e24\u4e2a\u6839\u672c\u95ee\u9898\uff1a\u54ea\u4e9b\u6307\u4ee4\u662f\u6027\u80fd\u5173\u952e\u7684\uff08Q1\uff09\uff0c\u4ee5\u53ca\u4e3a\u4ec0\u4e48\u5b83\u4eec\u662f\u6027\u80fd\u5173\u952e\u7684\uff08Q2\uff09\u3002\u5176\u67b6\u6784\u56f4\u7ed5\u786c\u4ef6\u652f\u6301\u3001\u4e8b\u4ef6\u9009\u62e9\u548c\u8f6f\u4ef6\u540e\u5904\u7406\u4e09\u4e2a\u5c42\u9762\u5c55\u5f00\u3002</p> <ul> <li>\u786c\u4ef6\u652f\u6301\u5c42\uff1a</li> <li>\u5728\u5904\u7406\u5668\u5fae\u67b6\u6784\u4e2d\u4e3a\u6bcf\u4e2a\u52a8\u6001\u6267\u884c\u7684\u6307\u4ee4\uff08\u6216 \u00b5op\uff09\u5206\u914d\u4e00\u4e2a Performance Signature Vector (PSV)\u3002PSV \u662f\u4e00\u4e2a\u4f4d\u5411\u91cf\uff0c\u6bcf\u4e00\u4f4d\u5bf9\u5e94\u4e00\u4e2a\u7279\u5b9a\u7684\u6027\u80fd\u4e8b\u4ef6\u3002</li> <li>PSV \u5728\u6307\u4ee4\u6d41\u7ecf\u6d41\u6c34\u7ebf\u7684\u4e0d\u540c\u9636\u6bb5\u88ab\u9010\u6b65\u586b\u5145\u3002\u4f8b\u5982\uff0c\u5728 Fetch \u9636\u6bb5\u8bb0\u5f55\u6307\u4ee4\u7f13\u5b58\u548c TLB \u672a\u547d\u4e2d\uff0c\u5728 Dispatch \u9636\u6bb5\u68c0\u6d4b Store Queue \u6ee1\uff0c\u5728 LSU \u548c Cache \u54cd\u5e94\u65f6\u8bb0\u5f55\u6570\u636e\u7f13\u5b58\u548c TLB \u672a\u547d\u4e2d\uff0c\u5728 ROB \u4e2d\u8bb0\u5f55\u5bfc\u81f4 Flush \u7684\u4e8b\u4ef6\uff08\u5982\u5206\u652f\u8bef\u9884\u6d4b\u3001\u5f02\u5e38\uff09\u3002</li> <li>TEA \u590d\u7528\u5e76\u6269\u5c55\u4e86 TIP (Time-Proportional Instruction Profiling) \u7684\u91c7\u6837\u903b\u8f91\uff0c\u8be5\u903b\u8f91\u4f4d\u4e8e ROB (Re-Order Buffer)\u3002\u5b83\u6839\u636e\u5904\u7406\u5668\u5728\u91c7\u6837\u5468\u671f\u6240\u5904\u7684 \u63d0\u4ea4\u72b6\u6001\uff08Compute, Drained, Stalled, Flushed\uff09\u6765\u51b3\u5b9a\u91c7\u6837\u54ea\u4e2a\uff08\u4e9b\uff09\u6307\u4ee4\u3002</li> <li>\u91c7\u6837\u5230\u7684\u6307\u4ee4\u5730\u5740\u548c\u5176\u5b8c\u6574\u7684 PSV \u88ab\u5199\u5165 Control and Status Registers (CSRs)\uff0c\u5e76\u901a\u8fc7\u4e2d\u65ad\u4f20\u9012\u7ed9\u8f6f\u4ef6\u3002</li> </ul> <p></p> <p>Figure 4: TEA microarchitecture.</p> <ul> <li>\u6027\u80fd\u4e8b\u4ef6\u9009\u62e9\u5c42\uff1a</li> <li>\u4e3a\u4e86\u5e73\u8861\u6d1e\u5bdf\u529b\u4e0e\u5f00\u9500\uff0cTEA \u7cbe\u5fc3\u9009\u62e9\u4e86 9\u4e2a\u5173\u952e\u6027\u80fd\u4e8b\u4ef6\uff0c\u8fd9\u4e9b\u4e8b\u4ef6\u76f4\u63a5\u6620\u5c04\u5230\u4e09\u79cd\u975e\u8ba1\u7b97\u7684\u63d0\u4ea4\u72b6\u6001\uff08Drained, Stalled, Flushed\uff09\u3002</li> <li>\u4e8b\u4ef6\u9009\u62e9\u57fa\u4e8e \u6027\u80fd\u4e8b\u4ef6\u5c42\u7ea7\u7ed3\u6784\uff08hierarchies\uff09\uff0c\u4f18\u5148\u6355\u83b7\u80fd\u89e3\u91ca\u957f\u5ef6\u8fdf\u7684\u6839\u672c\u539f\u56e0\u4e8b\u4ef6\uff08\u5982 L1 Miss\uff09\uff0c\u800c\u975e\u6240\u6709\u53ef\u80fd\u7684\u884d\u751f\u4e8b\u4ef6\u3002</li> <li>\u8fd99\u4e2a\u4e8b\u4ef6\u8db3\u4ee5\u89e3\u91ca 99% \u7684\u3001\u672a\u88ab\u4efb\u4f55\u4e8b\u4ef6\u6807\u8bb0\u7684\u6307\u4ee4\u6240\u4ea7\u751f\u7684\u77ed\u4e8e 5.8 \u4e2a\u65f6\u949f\u5468\u671f\u7684\u505c\u987f\uff0c\u8bc1\u660e\u4e86\u5176\u6709\u6548\u6027\u3002</li> </ul> <p></p> <p>Table 1: The performance events of TEA, IBS, SPE, and RIS.</p> <ul> <li>\u8f6f\u4ef6\u540e\u5904\u7406\u5c42\uff1a</li> <li>\u91c7\u6837\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u5c06 CSR \u4e2d\u7684\u6570\u636e\uff08\u6307\u4ee4\u5730\u5740\u3001PSV\u3001\u65f6\u95f4\u6233\u7b49\uff09\u8fde\u540c\u8fdb\u7a0b/\u7ebf\u7a0b\u4fe1\u606f\u4e00\u8d77\u5199\u5165\u5185\u5b58\u7f13\u51b2\u533a\u3002</li> <li>\u5e94\u7528\u7a0b\u5e8f\u7ed3\u675f\u540e\uff0c\u4e00\u4e2a\u4e13\u7528\u5de5\u5177\u8bfb\u53d6\u6240\u6709\u91c7\u6837\u6570\u636e\uff0c\u5e76\u6839\u636e\u9759\u6001\u6307\u4ee4\u5730\u5740\u5bf9\u6837\u672c\u8fdb\u884c\u805a\u5408\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u9759\u6001\u6307\u4ee4\uff0c\u5de5\u5177\u5c06\u5176\u6240\u6709\u52a8\u6001\u6267\u884c\u6837\u672c\u7684\u5468\u671f\u6570\uff0c\u6309\u7167 PSV \u7684\u503c\uff08\u5373\u906d\u9047\u7684 \u4e8b\u4ef6\u7ec4\u5408\uff09\u8fdb\u884c\u5206\u7c7b\u7d2f\u52a0\uff0c\u6700\u7ec8\u751f\u6210\u8be5\u6307\u4ee4\u7684 PICS\u3002PICS \u7684\u9ad8\u5ea6\u4ee3\u8868\u8be5\u6307\u4ee4\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\uff08\u56de\u7b54 Q1\uff09\uff0c\u5404\u5206\u5757\u7684\u5927\u5c0f\u4ee3\u8868\u4e0d\u540c\uff08\u7ec4\u5408\uff09\u4e8b\u4ef6\u5bf9\u8be5\u6307\u4ee4\u6267\u884c\u65f6\u95f4\u7684\u5f71\u54cd\uff08\u56de\u7b54 Q2\uff09\u3002</li> </ul> <p></p> <p>Figure 1: Example explaining how TEA creates PICS. TEA explains how performance events cause performance loss.</p> <p>\u5173\u952e\u4f18\u52bf\u4e0e\u5f00\u9500</p> <p>TEA \u67b6\u6784\u7684\u5173\u952e\u4f18\u52bf\u5728\u4e8e\u5176 \u65f6\u95f4\u6bd4\u4f8b\u6027\uff0c\u8fd9\u4f7f\u5176\u663e\u8457\u4f18\u4e8e\u5728 Fetch \u6216 Dispatch \u9636\u6bb5\u8fdb\u884c\u6307\u4ee4\u6807\u8bb0\u7684\u73b0\u6709\u65b9\u6848\uff08\u5982 AMD IBS, Arm SPE\uff09\u3002</p> <p></p> <p>Figure 2: Example comparing TEA to dispatch-tagging. TEA is time-proportional whereas dispatch-tagging is not.</p> <p>\u5176\u5f00\u9500\u88ab\u63a7\u5236\u5728\u6781\u4f4e\u6c34\u5e73\uff1a - \u5b58\u50a8\u5f00\u9500\uff1a\u6bcf\u4e2a\u6838\u5fc3\u4ec5\u9700 249 \u5b57\u8282\u3002 - \u529f\u8017\u5f00\u9500\uff1a\u6bcf\u4e2a\u6838\u5fc3\u589e\u52a0\u7ea6 3.2 mW\uff08\u7ea6 0.1%\uff09\u3002 - \u6027\u80fd\u5f00\u9500\uff1a\u4f9d\u8d56\u7edf\u8ba1\u91c7\u6837\uff084 KHz\uff09\uff0c\u5e73\u5747\u4ec5\u4e3a 1.1%\u3002 - \u51c6\u786e\u6027\uff1a\u76f8\u6bd4\u65e0\u6cd5\u5b9e\u73b0\u7684\u201c\u9ec4\u91d1\u6807\u51c6\u201d\uff0c\u5e73\u5747\u8bef\u5dee\u4ec5\u4e3a 2.1%\uff0c\u8fdc\u4f18\u4e8e IBS/SPE/RIS \u7684 ~55.5% \u5e73\u5747\u8bef\u5dee\u3002</p> \u65b9\u6cd5 \u5e73\u5747\u8bef\u5dee \u6027\u80fd\u5f00\u9500 \u6838\u5fc3\u601d\u60f3 TEA 2.1% 1.1% \u65f6\u95f4\u6bd4\u4f8b\u5316\u91c7\u6837 + \u5168\u98de\u884c\u6307\u4ee4\u4e8b\u4ef6\u8ffd\u8e2a NCI-TEA 11.3% 1.1% \u63d0\u4ea4\u65f6\u91c7\u6837\uff0c\u4f46Flush\u72b6\u6001\u5904\u7406\u4e0d\u51c6\u786e AMD IBS / Arm SPE / IBM RIS ~55.5% \u4f4e \u975e\u65f6\u95f4\u6bd4\u4f8b\u5316\uff08Fetch/Dispatch\u6807\u8bb0\uff09"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#1-time-proportional-per-instruction-cycle-stacks-pics","title":"1. Time-Proportional Per-Instruction Cycle Stacks (PICS)","text":"<p>\u6838\u5fc3\u6982\u5ff5\u4e0e\u76ee\u6807</p> <ul> <li>Time-Proportional Per-Instruction Cycle Stacks (PICS) \u7684\u6838\u5fc3\u76ee\u6807\u662f\u7edf\u4e00\u6027\u80fd\u5256\u6790\uff08profiling\uff09\u4e0e\u6027\u80fd\u4e8b\u4ef6\u5206\u6790\uff08event analysis\uff09\uff0c\u4ee5\u56de\u7b54\u4e24\u4e2a\u6839\u672c\u95ee\u9898\uff1a(Q1) \u54ea\u4e9b\u6307\u4ee4\u662f\u6027\u80fd\u5173\u952e\u7684\uff1f(Q2) \u4e3a\u4ec0\u4e48\u8fd9\u4e9b\u6307\u4ee4\u662f\u6027\u80fd\u5173\u952e\u7684\uff1f</li> <li>PICS \u901a\u8fc7\u4e3a\u6bcf\u4e2astatic instruction\uff08\u9759\u6001\u6307\u4ee4\uff09\u6784\u5efa\u4e00\u4e2a\u201c\u5468\u671f\u6808\u201d\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u3002\u8be5\u6808\u7684\u603b\u9ad8\u5ea6\u4ee3\u8868\u8be5\u6307\u4ee4\u5bf9\u6574\u4f53\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\u6bd4\u4f8b\uff0c\u800c\u6808\u5185\u7684\u5404\u4e2a\u5206\u91cf\u5219\u4ee3\u8868\u4e86\u8be5\u6307\u4ee4\u5728\u52a8\u6001\u6267\u884c\u8fc7\u7a0b\u4e2d\u6240\u906d\u9047\u7684\uff08\u7ec4\u5408\uff09performance events\uff08\u6027\u80fd\u4e8b\u4ef6\uff09\u5bf9\u5176\u6267\u884c\u65f6\u95f4\u7684\u5177\u4f53\u5f71\u54cd\u3002</li> <li>\u8fd9\u79cd\u8bbe\u8ba1\u786e\u4fdd\u4e86\u5206\u6790\u7ed3\u679c\u7684time-proportionality\uff08\u65f6\u95f4\u6bd4\u4f8b\u6027\uff09\uff0c\u5373\u5206\u6790\u7ed3\u679c\u76f4\u63a5\u53cd\u6620\u4e86\u6307\u4ee4\u5728commit stage\uff08\u63d0\u4ea4\u9636\u6bb5\uff09\u66b4\u9732\u7684\u5ef6\u8fdf\uff0c\u800c\u975e\u5728fetch\u6216dispatch\u9636\u6bb5\u7684\u6d3b\u52a8\u3002</li> </ul> <p>\u5b9e\u73b0\u539f\u7406\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <ul> <li>PICS \u7684\u521b\u5efa\u4f9d\u8d56\u4e8e\u8bba\u6587\u63d0\u51fa\u7684 Time-Proportional Event Analysis (TEA) \u786c\u4ef6\u673a\u5236\u3002</li> <li>\u5176\u6838\u5fc3\u6570\u636e\u7ed3\u6784\u662f Performance Signature Vector (PSV)\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e3a\u6bcf\u4e2adynamically executed instruction\uff08\u52a8\u6001\u6267\u884c\u6307\u4ee4\uff09\u5206\u914d\u7684\u4f4d\u5411\u91cf\uff0c\u5176\u4e2d\u6bcf\u4e00\u4f4d\u5bf9\u5e94\u4e00\u4e2a\u7279\u5b9a\u7684\u6027\u80fd\u4e8b\u4ef6\u3002\u5982\u679c\u8be5\u6307\u4ee4\u5728\u5176\u751f\u547d\u5468\u671f\u5185\u906d\u9047\u4e86\u67d0\u4e2a\u4e8b\u4ef6\uff0c\u5bf9\u5e94\u7684\u4f4d\u5c31\u4f1a\u88ab\u7f6e\u4e3a1\u3002</li> <li>\u7b97\u6cd5\u6d41\u7a0b\u57fa\u4e8estatistical sampling\uff08\u7edf\u8ba1\u91c7\u6837\uff09\uff0c\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a<ul> <li>\u91c7\u6837\u89e6\u53d1: \u6027\u80fd\u76d1\u63a7\u5355\u5143\uff08PMU\uff09\u4ee5\u56fa\u5b9a\u9891\u7387\uff08\u59824 KHz\uff09\u89e6\u53d1\u91c7\u6837\u4e2d\u65ad\u3002</li> <li>\u6307\u4ee4\u9009\u62e9: TEA \u7684\u91c7\u6837\u903b\u8f91\u7ee7\u627f\u81ea TIP [22]\uff0c\u6839\u636e\u5904\u7406\u5668\u5728\u91c7\u6837\u65f6\u523b\u7684commit state\uff08\u63d0\u4ea4\u72b6\u6001\uff09\u6765\u51b3\u5b9a\u91c7\u6837\u54ea\u4e2a\uff08\u4e9b\uff09\u6307\u4ee4\uff1a<ul> <li>Compute: \u5904\u7406\u5668\u6b63\u5728\u63d0\u4ea4\u6307\u4ee4\uff0c\u65f6\u95f4\u5e73\u5747\u5206\u914d\u7ed9\u6240\u6709\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</li> <li>Drained: ROB\uff08\u91cd\u6392\u5e8f\u7f13\u51b2\u533a\uff09\u56e0\u524d\u7aef\u505c\u987f\u800c\u53d8\u7a7a\uff0c\u65f6\u95f4\u5f52\u56e0\u4e8e\u4e0b\u4e00\u4e2a\u5c06\u8981\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</li> <li>Stalled: ROB\u5934\u90e8\u7684\u6307\u4ee4\u56e0\u672a\u6267\u884c\u5b8c\u800c\u505c\u987f\uff0c\u65f6\u95f4\u5f52\u56e0\u4e8e\u8be5\u505c\u987f\u6307\u4ee4\u3002</li> <li>Flushed: \u56e0\u5206\u652f\u8bef\u9884\u6d4b\u7b49\u539f\u56e0\u5bfc\u81f4ROB\u88ab\u51b2\u5237\uff0c\u65f6\u95f4\u5f52\u56e0\u4e8e\u6700\u540e\u4e00\u4e2a\u5df2\u63d0\u4ea4\u7684\u3001\u5f15\u53d1\u51b2\u5237\u7684\u6307\u4ee4\u3002</li> </ul> </li> <li>\u6570\u636e\u6355\u83b7: \u9009\u4e2d\u7684\u6307\u4ee4\u7684instruction pointer(s)\uff08\u6307\u4ee4\u6307\u9488\uff09\u548c\u5176\u5f53\u524d\u7684 PSV(s) \u88ab\u8bfb\u53d6\u5e76\u6253\u5305\u6210\u4e00\u4e2a\u6837\u672c\u3002</li> <li>\u8f6f\u4ef6\u5904\u7406: \u4e2d\u65ad\u670d\u52a1\u7a0b\u5e8f\u5c06\u6837\u672c\uff08\u5305\u62ec\u65f6\u95f4\u6233\u3001\u6307\u4ee4\u5730\u5740\u3001PSV\u7b49\uff09\u5199\u5165\u5185\u5b58\u7f13\u51b2\u533a\u3002</li> <li>PICS \u751f\u6210: \u5e94\u7528\u7a0b\u5e8f\u7ed3\u675f\u540e\uff0c\u4e00\u4e2a\u540e\u5904\u7406\u5de5\u5177\u8bfb\u53d6\u6240\u6709\u6837\u672c\u6587\u4ef6\u3002\u5b83\u5c06\u6837\u672c\u6309static instruction\uff08\u901a\u8fc7\u6307\u4ee4\u5730\u5740\u6620\u5c04\uff09\u8fdb\u884c\u805a\u5408\uff0c\u5e76\u6839\u636ePSV\u7684\u503c\uff08\u5373\u4e8b\u4ef6\u7b7e\u540d\uff09\u5bf9\u5468\u671f\u8fdb\u884c\u5206\u7c7b\u7d2f\u52a0\uff0c\u6700\u7ec8\u4e3a\u6bcf\u4e2a\u9759\u6001\u6307\u4ee4\u751f\u6210\u4e00\u4e2a\u5b8c\u6574\u7684PICS\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 1: Example explaining how TEA creates PICS. TEA explains how performance events cause performance loss.</p> <p>\u5173\u952e\u53c2\u6570\u4e0e\u4e8b\u4ef6\u9009\u62e9</p> <ul> <li>\u4e3a\u4e86\u5e73\u8861insight\uff08\u6d1e\u5bdf\u529b\uff09\u4e0eoverhead\uff08\u5f00\u9500\uff09\uff0cTEA \u5e76\u975e\u8ffd\u8e2a\u6240\u6709\u53ef\u80fd\u7684\u6027\u80fd\u4e8b\u4ef6\uff0c\u800c\u662f\u7cbe\u5fc3\u9009\u62e9\u4e869\u4e2a\u5173\u952e\u4e8b\u4ef6\u3002\u8fd9\u4e9b\u4e8b\u4ef6\u7684\u9009\u62e9\u57fa\u4e8e\u5bf9commit states\uff08\u63d0\u4ea4\u72b6\u6001\uff09\u4e0e\u5e95\u5c42\u5fae\u67b6\u6784\u884c\u4e3a\u4e4b\u95f4\u56e0\u679c\u5173\u7cfb\u7684\u6df1\u5165\u7406\u89e3\u3002</li> <li>\u8fd99\u4e2a\u4e8b\u4ef6\u88ab\u7ec4\u7ec7\u6210\u4e00\u4e2a\u5c42\u6b21\u7ed3\u6784\uff0c\u5e76\u660e\u786e\u5173\u8054\u5230\u4e09\u79cd\u975e\u8ba1\u7b97\u7684\u63d0\u4ea4\u72b6\u6001\uff08Stalled, Drained, Flushed\uff09\uff1a</li> </ul> Commit State Performance Event (Code) Description Stalled (ST) ST-L1 L1 \u6570\u636e\u7f13\u5b58\u672a\u547d\u4e2d ST-TLB L1 \u6570\u636e TLB \u672a\u547d\u4e2d ST-LLC LLC (\u672b\u7ea7\u7f13\u5b58) \u672a\u547d\u4e2d Drained (DR) DR-L1 L1 \u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d DR-TLB L1 \u6307\u4ee4 TLB \u672a\u547d\u4e2d DR-SQ \u5b58\u50a8\u961f\u5217\uff08Store Queue\uff09\u6ee1\u5bfc\u81f4ROB\u6392\u7a7a Flushed (FL) FL-MB \u5206\u652f\u8bef\u9884\u6d4b\uff08Mispredicted Branch\uff09 FL-EX \u5f02\u5e38\uff08Exception\uff09 FL-MO \u5185\u5b58\u6392\u5e8f\u51b2\u7a81\uff08Memory Ordering Violation\uff09 <ul> <li>\u8bba\u6587\u6307\u51fa\uff0c\u4ec5\u7528\u8fd99\u4e2a\u4e8b\u4ef6\uff0c\u5c31\u80fd\u786e\u4fdd99%\u7684\u3001\u672a\u88ab\u4efb\u4f55\u4e8b\u4ef6\u6807\u8bb0\u7684\u6307\u4ee4\u6240\u4ea7\u751f\u7684\u505c\u987f\u5468\u671f\u5c11\u4e8e5.8\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u8bc1\u660e\u4e86\u8be5\u4e8b\u4ef6\u96c6\u7684\u6709\u6548\u6027\u3002</li> </ul> <p></p> <p>Figure 3: Performance event hierarchy for the Stalled (ST) commit state.</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u6574\u4f53\u4f5c\u7528</p> <ul> <li>\u8f93\u5165:<ul> <li>\u786c\u4ef6\u5c42\u9762: \u5904\u7406\u5668\u5728\u8fd0\u884c\u65f6\u4ea7\u751f\u7684\u539f\u59cb\u4fe1\u53f7\uff0c\u5305\u62ec\u6307\u4ee4\u6d41\u3001\u7f13\u5b58/TLB\u7684\u547d\u4e2d/\u672a\u547d\u4e2d\u4fe1\u53f7\u3001\u5206\u652f\u9884\u6d4b\u7ed3\u679c\u3001\u5f02\u5e38\u4fe1\u53f7\u3001ROB\u72b6\u6001\uff08\u5934/\u5c3e\u6307\u9488\u3001\u63d0\u4ea4\u72b6\u6001\uff09\u7b49\u3002</li> <li>\u8f6f\u4ef6\u5c42\u9762: \u91c7\u6837\u9891\u7387\u914d\u7f6e\uff08\u59824 KHz\uff09\u3002</li> </ul> </li> <li>\u8f93\u51fa:<ul> <li>\u76f4\u63a5\u8f93\u51fa: \u4e00\u7cfb\u5217\u5305\u542b\u65f6\u95f4\u6233\u3001\u6307\u4ee4\u5730\u5740\u548cPSV\u7684\u91c7\u6837\u8bb0\u5f55\u3002</li> <li>\u6700\u7ec8\u4ea7\u7269: Per-Instruction Cycle Stacks (PICS)\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ed3\u6784\u5316\u7684\u6027\u80fd\u5206\u6790\u62a5\u544a\uff0c\u53ef\u4ee5\u6309\u6307\u4ee4\u3001\u57fa\u672c\u5757\u6216\u51fd\u6570\u7b49\u4e0d\u540c\u7c92\u5ea6\u8fdb\u884c\u53ef\u89c6\u5316\u3002</li> </ul> </li> <li>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528:<ul> <li>PICS \u662f\u8fde\u63a5\u5e95\u5c42\u786c\u4ef6\u884c\u4e3a\u4e0e\u4e0a\u5c42\u8f6f\u4ef6\u6027\u80fd\u7684\u5173\u952e\u6865\u6881\u3002\u5b83\u5c06\u62bd\u8c61\u7684\u201c\u6267\u884c\u65f6\u95f4\u201d\u5206\u89e3\u4e3a\u5177\u4f53\u7684\u3001\u53ef\u64cd\u4f5c\u7684\u5fae\u67b6\u6784\u4e8b\u4ef6\u3002</li> <li>\u76f8\u6bd4\u4e8e\u4f20\u7edf\u7684instruction-driven\uff08\u6307\u4ee4\u9a71\u52a8\uff0c\u5982IBS/SPE/RIS\uff0c\u5728\u524d\u7aef\u6253\u6807\u7b7e\uff09\u548cevent-driven\uff08\u4e8b\u4ef6\u9a71\u52a8\uff0c\u4ec5\u8ba1\u6570\uff09\u65b9\u6cd5\uff0cPICS \u63d0\u4f9b\u4e86\u56e0\u679c\u6027\u66f4\u5f3a\u7684\u5206\u6790\u89c6\u56fe\u3002\u4f8b\u5982\uff0c\u5b83\u80fd\u6e05\u6670\u533a\u5206\u4e00\u4e2a\u7f13\u5b58\u672a\u547d\u4e2d\u662f\u9690\u85cf\u7684\uff08\u4e0d\u5f71\u54cd\u63d0\u4ea4\uff09\u8fd8\u662f\u975e\u9690\u85cf\u7684\uff08\u76f4\u63a5\u5bfc\u81f4\u505c\u987f\uff09\uff0c\u8fd9\u662f\u4f20\u7edf\u4e8b\u4ef6\u8ba1\u6570\u65e0\u6cd5\u505a\u5230\u7684\u3002</li> <li>\u5982\u56fe2\u6240\u793a\uff0c\u4f20\u7edf\u65b9\u6cd5\u5728\u505c\u987f\u65f6\u4f1a\u9519\u8bef\u5730\u5bf9\u524d\u7aef\u65b0\u8fdb\u5165\u7684\u6307\u4ee4\uff08\u5982I5\u6216I8\uff09\u8fdb\u884c\u91c7\u6837\uff0c\u800cTEA/PICS\u5219\u80fd\u6b63\u786e\u5730\u5c06\u65f6\u95f4\u5f52\u56e0\u4e8e\u5728ROB\u5934\u90e8\u9020\u6210\u505c\u987f\u7684\u6307\u4ee4\uff08I1\uff09\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 2: Example comparing TEA to dispatch-tagging. TEA is time-proportional whereas dispatch-tagging is not.</p> <p>\u51c6\u786e\u6027\u4e0e\u5f00\u9500</p> <ul> <li>\u51c6\u786e\u6027: \u4e0e\u4e00\u4e2a\u7406\u60f3\u7684\u3001\u65e0\u91c7\u6837\u7684\u201c\u9ec4\u91d1\u53c2\u8003\u201d\u76f8\u6bd4\uff0cTEA\u751f\u6210\u7684PICS\u5e73\u5747\u8bef\u5dee\u4ec5\u4e3a2.1%\u3002\u8fd9\u8fdc\u4f18\u4e8eAMD IBS (55.6%)\u3001Arm SPE (55.5%) \u548c IBM RIS (56.0%)\u3002</li> <li>\u5f00\u9500:<ul> <li>\u6027\u80fd\u5f00\u9500: \u7531\u4e8e\u91c7\u7528\u7edf\u8ba1\u91c7\u6837\uff0c\u5e73\u5747\u6027\u80fd\u5f00\u9500\u4ec5\u4e3a 1.1%\u3002</li> <li>\u529f\u8017\u5f00\u9500: \u6bcf\u6838\u589e\u52a0\u7ea6 3.2 mW\uff08\u7ea6 0.1%\uff09\u3002</li> <li>\u5b58\u50a8\u5f00\u9500: \u6bcf\u6838\u589e\u52a0 249 bytes \u7684\u786c\u4ef6\u5b58\u50a8\uff08\u4e3b\u8981\u7528\u4e8e\u5728ROB\u7b49\u7ed3\u6784\u4e2d\u5b58\u653ePSV\uff09\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 5: Quantifying the error for the PICS obtained through IBS, SPE, RIS, NCI-TEA, and TEA. TEA achieves the highest accuracy within 2.1% (and at most 7.7%) compared to the golden reference.</p>"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#2-performance-signature-vector-psv","title":"2. Performance Signature Vector (PSV)","text":"<p>Performance Signature Vector (PSV) \u7684\u6838\u5fc3\u5b9a\u4e49\u4e0e\u4f5c\u7528</p> <ul> <li>Performance Signature Vector (PSV) \u662f TEA \u4e3a\u6bcf\u4e2a\u52a8\u6001\u6267\u884c\u7684\u6307\u4ee4\uff08\u6216 \u00b5op\uff09\u5206\u914d\u7684\u4e00\u4e2a\u4f4d\u5411\u91cf (bit-vector)\u3002</li> <li>\u5176\u6838\u5fc3\u4f5c\u7528\u662f\u7cbe\u786e\u8ffd\u8e2a\u8be5\u6307\u4ee4\u5728\u5176\u6574\u4e2a\u751f\u547d\u5468\u671f\u5185\u6240\u906d\u9047\u7684\u5fae\u67b6\u6784\u6027\u80fd\u4e8b\u4ef6 (microarchitectural performance events)\u3002</li> <li>PSV \u662f\u6784\u5efa Per-Instruction Cycle Stacks (PICS) \u7684\u57fa\u7840\u6570\u636e\u5355\u5143\u3002\u901a\u8fc7\u805a\u5408\u6240\u6709\u91c7\u6837\u5230\u7684\u3001\u5c5e\u4e8e\u540c\u4e00\u9759\u6001\u6307\u4ee4\u7684 PSV\uff0cTEA \u80fd\u591f\u5c06\u8be5\u6307\u4ee4\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\uff0c\u6309\u5176\u906d\u9047\u7684\u4e0d\u540c\uff08\u6216\u7ec4\u5408\uff09\u6027\u80fd\u4e8b\u4ef6\u8fdb\u884c\u5206\u89e3\uff0c\u4ece\u800c\u540c\u65f6\u56de\u7b54\u201c\u54ea\u4e2a\u6307\u4ee4\u662f\u6027\u80fd\u5173\u952e\u7684\u201d\u548c\u201c\u4e3a\u4ec0\u4e48\u5b83\u662f\u6027\u80fd\u5173\u952e\u7684\u201d\u8fd9\u4e24\u4e2a\u95ee\u9898\u3002</li> </ul> <p>PSV \u7684\u5b9e\u73b0\u539f\u7406\u4e0e\u786c\u4ef6\u96c6\u6210</p> <ul> <li>PSV \u7684\u6bcf\u4e00\u4f4d\u5bf9\u5e94\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u3001\u7531 TEA \u786c\u4ef6\u652f\u6301\u7684\u6027\u80fd\u4e8b\u4ef6\u3002\u5728\u8bba\u6587\u7684 BOOM \u6838\u5fc3\u5b9e\u73b0\u4e2d\uff0c\u8fd9\u4e2a\u5411\u91cf\u957f\u5ea6\u4e3a 9 \u4f4d\u3002</li> <li>PSV \u7684\u751f\u547d\u5468\u671f\u59cb\u4e8e\u6307\u4ee4\u8fdb\u5165\u6d41\u6c34\u7ebf\uff0c\u5e76\u968f\u7740\u6307\u4ee4\u5728\u6d41\u6c34\u7ebf\u4e2d\u6d41\u52a8\u800c\u88ab\u66f4\u65b0\uff1a<ul> <li>\u524d\u7aef (Front-end): \u5728 Fetch \u9636\u6bb5\uff0c\u4f1a\u68c0\u6d4b\u5e76\u8bbe\u7f6e\u4e0e\u53d6\u6307\u76f8\u5173\u7684\u4e8b\u4ef6\u4f4d\uff0c\u5982 DR-L1 (L1 \u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d) \u548c DR-TLB (L1 \u6307\u4ee4 TLB \u672a\u547d\u4e2d)\u3002\u8fd9\u4e9b\u4f4d\u88ab\u521d\u59cb\u5316\u5e76\u9644\u52a0\u5230\u53d6\u6307\u5305\u4e0a\u3002</li> <li>\u8bd1\u7801\u4e0e\u5206\u53d1 (Decode &amp; Dispatch): \u6307\u4ee4\u88ab\u89e3\u7801\u4e3a \u00b5op \u540e\uff0cPSV \u88ab\u4f20\u9012\u4e0b\u53bb\u3002\u5728 Dispatch \u9636\u6bb5\uff0c\u4f1a\u68c0\u6d4b\u5e76\u8bbe\u7f6e DR-SQ (\u5b58\u50a8\u961f\u5217\u6ee1\u5bfc\u81f4 ROB \u6392\u7a7a) \u4e8b\u4ef6\u4f4d\u3002</li> <li>\u6267\u884c\u9636\u6bb5 (Execute): \u5728 Load/Store \u5355\u5143 (LSU) \u4e2d\uff0c\u4f1a\u68c0\u6d4b\u6570\u636e\u76f8\u5173\u7684\u4e8b\u4ef6\uff0c\u5982 ST-TLB (L1 \u6570\u636e TLB \u672a\u547d\u4e2d)\uff0c\u5e76\u5728 LSU \u6761\u76ee\u4e2d\u6682\u5b58\u8be5\u4fe1\u606f\u3002\u5f53\u7f13\u5b58\u54cd\u5e94\u8fd4\u56de\u65f6\uff0cST-L1 (L1 \u6570\u636e\u7f13\u5b58\u672a\u547d\u4e2d) \u548c ST-LLC (LLC \u672a\u547d\u4e2d) \u4e8b\u4ef6\u4f4d\u4f1a\u88ab\u8bbe\u7f6e\u3002</li> <li>\u63d0\u4ea4\u9636\u6bb5 (Commit): \u4e0e\u6d41\u6c34\u7ebf\u51b2\u5237\u76f8\u5173\u7684\u4e8b\u4ef6\uff0c\u5982 FL-MB (\u5206\u652f\u9884\u6d4b\u9519\u8bef)\u3001FL-EX (\u5f02\u5e38) \u548c FL-MO (\u5185\u5b58\u6392\u5e8f\u51b2\u7a81)\uff0c\u7531 Re-Order Buffer (ROB) \u76f4\u63a5\u68c0\u6d4b\u5e76\u8bb0\u5f55\u5230\u5bf9\u5e94\u6307\u4ee4\u7684 PSV \u4e2d\u3002</li> </ul> </li> <li>\u6700\u7ec8\uff0c\u5b8c\u6574\u7684 9 \u4f4d PSV \u88ab\u5b58\u50a8\u5728\u8be5 \u00b5op \u5bf9\u5e94\u7684 ROB \u6761\u76ee\u4e2d\uff0c\u7b49\u5f85\u91c7\u6837\u3002</li> <li></li> </ul> <p></p> <p>Figure 4: TEA microarchitecture.</p> <p>PSV \u7684\u7b97\u6cd5\u6d41\u7a0b\uff1a\u4ece\u8ffd\u8e2a\u5230\u91c7\u6837</p> <ul> <li>\u8ffd\u8e2a (Tracking): \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5728\u98de\u884c\u4e2d\u7684 (in-flight) \u6307\u4ee4\uff0c\u5176 PSV \u4f1a\u968f\u7740\u5b83\u5728\u6d41\u6c34\u7ebf\u4e2d\u7ecf\u5386\u7684\u4e0d\u540c\u9636\u6bb5\u800c\u88ab\u52a8\u6001\u66f4\u65b0\u3002\u6bcf\u5f53\u4e00\u4e2a\u652f\u6301\u7684\u6027\u80fd\u4e8b\u4ef6\u53d1\u751f\uff0c\u5bf9\u5e94\u7684\u4f4d\u5c31\u88ab\u7f6e\u4e3a 1\u3002</li> <li>\u91c7\u6837 (Sampling): TEA \u590d\u7528 TIP \u7684\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u903b\u8f91\u3002\u4e00\u4e2a\u5468\u671f\u8ba1\u6570\u5668\u4ee5 4 KHz \u7684\u9891\u7387\u89e6\u53d1\u91c7\u6837\u3002<ul> <li>\u91c7\u6837\u903b\u8f91\u9996\u5148\u5224\u65ad\u5f53\u524d CPU \u7684 \u63d0\u4ea4\u72b6\u6001 (commit state)\uff1aCompute, Drained, Stalled, \u6216 Flushed\u3002</li> <li>\u6839\u636e\u72b6\u6001\uff0c\u9009\u62e9\u6b63\u786e\u7684\u6307\u4ee4\u8fdb\u884c\u91c7\u6837\uff08\u4f8b\u5982\uff0c\u5728 Stalled \u72b6\u6001\u4e0b\u9009\u62e9 ROB \u5934\u90e8\u7684\u6307\u4ee4\uff0c\u5728 Flushed \u72b6\u6001\u4e0b\u9009\u62e9\u6700\u540e\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\uff09\u3002</li> <li>\u9009\u4e2d\u7684\u6307\u4ee4\uff08\u6216\u6307\u4ee4\u7ec4\uff09\u7684 \u6307\u4ee4\u5730\u5740 (instruction pointer) \u548c\u5b8c\u6574\u7684 PSV \u4f1a\u88ab\u6253\u5305\u6210\u4e00\u4e2a\u6837\u672c\u3002</li> </ul> </li> <li>\u8f93\u51fa (Output): \u8be5\u6837\u672c\u88ab\u5199\u5165 Control and Status Registers (CSRs)\uff0c\u5e76\u89e6\u53d1\u4e00\u4e2a\u4e2d\u65ad\u3002\u91c7\u6837\u8f6f\u4ef6\uff08\u5982 Linux perf\uff09\u5728\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u4e2d\u8bfb\u53d6 CSR\uff0c\u5c06\u6837\u672c\uff08\u5305\u542b\u5730\u5740\u3001PSV\u3001\u65f6\u95f4\u6233\u7b49\uff09\u5b58\u5165\u5185\u5b58\u7f13\u51b2\u533a\u3002</li> </ul> <p>PSV \u7684\u53c2\u6570\u8bbe\u7f6e\u4e0e\u4e8b\u4ef6\u9009\u62e9</p> <ul> <li>PSV \u7684\u5927\u5c0f\uff08\u5373\u652f\u6301\u7684\u4e8b\u4ef6\u6570\u91cf\uff09\u662f\u5f00\u9500\u4e0e\u6d1e\u5bdf\u529b\u4e4b\u95f4\u6743\u8861\u7684\u7ed3\u679c\u3002\u8bba\u6587\u901a\u8fc7\u5206\u6790\u6027\u80fd\u4e8b\u4ef6\u7684\u5c42\u6b21\u7ed3\u6784 (hierarchies) \u6765\u6307\u5bfc\u9009\u62e9\u3002</li> <li>\u6700\u7ec8\u9009\u5b9a\u7684 9 \u4e2a\u6027\u80fd\u4e8b\u4ef6\u88ab\u7cbe\u5fc3\u8bbe\u8ba1\uff0c\u4ee5\u8986\u76d6\u6240\u6709\u975e\u8ba1\u7b97\u63d0\u4ea4\u72b6\u6001\uff08Drained, Stalled, Flushed\uff09\u7684\u4e3b\u8981\u6210\u56e0\uff0c\u5e76\u786e\u4fdd\u80fd\u89e3\u91ca\u7edd\u5927\u90e8\u5206\u7684\u6027\u80fd\u635f\u5931\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e86 TEA \u7684 9 \u4e2a\u6027\u80fd\u4e8b\u4ef6\u53ca\u5176\u542b\u4e49\uff1a</li> </ul> \u63d0\u4ea4\u72b6\u6001 \u6027\u80fd\u4e8b\u4ef6 \u8bf4\u660e Drained (DR) DR-L1 L1 \u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d DR-TLB L1 \u6307\u4ee4 TLB \u672a\u547d\u4e2d DR-SQ \u5b58\u50a8\u961f\u5217 (Store Queue) \u6ee1 Flushed (FL) FL-MB \u5206\u652f\u9884\u6d4b\u9519\u8bef (Mispredicted Branch) FL-EX \u5f02\u5e38 (Exception) FL-MO \u5185\u5b58\u6392\u5e8f\u51b2\u7a81 (Memory Ordering Violation) Stalled (ST) ST-L1 L1 \u6570\u636e\u7f13\u5b58\u672a\u547d\u4e2d ST-TLB L1 \u6570\u636e TLB \u672a\u547d\u4e2d ST-LLC LLC (\u672b\u7ea7\u7f13\u5b58) \u672a\u547d\u4e2d <ul> <li></li> </ul> <p></p> <p>Table 1: The performance events of TEA, IBS, SPE, and RIS.</p> <ul> <li>\u8fd9\u79cd\u9009\u62e9\u7b56\u7565\u975e\u5e38\u6709\u6548\uff1a\u8bc4\u4f30\u8868\u660e\uff0c\u5bf9\u4e8e\u90a3\u4e9b\u672a\u88ab\u5206\u914d\u4efb\u4f55\u4e8b\u4ef6\u4f46\u4ecd\u7136\u9020\u6210\u63d0\u4ea4\u505c\u987f\u7684\u6307\u4ee4\uff0c99% \u7684\u505c\u987f\u65f6\u957f\u90fd\u5c11\u4e8e 5.8 \u4e2a\u65f6\u949f\u5468\u671f\uff0c\u8bc1\u660e\u8fd9 9 \u4e2a\u4e8b\u4ef6\u8db3\u4ee5\u6355\u83b7\u4e3b\u8981\u7684\u6027\u80fd\u74f6\u9888\u3002</li> </ul> <p>PSV \u7684\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u6574\u4f53\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: PSV \u672c\u8eab\u4e0d\u76f4\u63a5\u63a5\u6536\u5916\u90e8\u8f93\u5165\uff0c\u5b83\u7684\u8f93\u5165\u662f\u6d41\u6c34\u7ebf\u5404\u9636\u6bb5\u4ea7\u751f\u7684\u6027\u80fd\u4e8b\u4ef6\u4fe1\u53f7\u3002\u8fd9\u4e9b\u4fe1\u53f7\u662f\u5904\u7406\u5668\u6b63\u5e38\u8fd0\u884c\u65f6\u4ea7\u751f\u7684\u526f\u4ea7\u54c1\u3002</li> <li>\u8f93\u51fa: PSV \u7684\u76f4\u63a5\u8f93\u51fa\u662f\u4f5c\u4e3a\u91c7\u6837\u6570\u636e\u7684\u4e00\u90e8\u5206\uff0c\u63d0\u4f9b\u7ed9\u8f6f\u4ef6\u5206\u6790\u5de5\u5177\u3002\u5176\u6700\u7ec8\u8f93\u51fa\u662f\u6784\u6210 PICS \u7684\u6838\u5fc3\u6570\u636e\u3002</li> <li>\u5728 TEA \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:<ul> <li>\u7edf\u4e00\u6865\u6881: PSV \u662f\u8fde\u63a5\u6027\u80fd\u5256\u6790 (profiling) \u548c\u6027\u80fd\u4e8b\u4ef6\u5206\u6790 (event analysis) \u7684\u5173\u952e\u6570\u636e\u7ed3\u6784\u3002\u5b83\u5c06\u62bd\u8c61\u7684\u65f6\u95f4\u6d88\u8017\u4e0e\u5177\u4f53\u7684\u786c\u4ef6\u4e8b\u4ef6\u5173\u8054\u8d77\u6765\u3002</li> <li>\u652f\u6301\u7ec4\u5408\u4e8b\u4ef6\u5206\u6790: \u7531\u4e8e PSV \u662f\u4e00\u4e2a\u4f4d\u5411\u91cf\uff0c\u5b83\u53ef\u4ee5\u81ea\u7136\u5730\u8868\u793a\u7ec4\u5408\u4e8b\u4ef6 (combined events)\uff08\u5373\u591a\u4e2a\u4f4d\u540c\u65f6\u4e3a 1\uff09\u3002\u8fd9\u5bf9\u4e8e\u8bca\u65ad\u590d\u6742\u7684\u6027\u80fd\u95ee\u9898\uff08\u5982\u540c\u65f6\u53d1\u751f\u7f13\u5b58\u548c TLB \u672a\u547d\u4e2d\uff09\u81f3\u5173\u91cd\u8981\u3002\u8bba\u6587\u6307\u51fa\uff0c30.0% \u7684\u906d\u9047\u81f3\u5c11\u4e00\u4e2a\u4e8b\u4ef6\u7684\u52a8\u6001\u6307\u4ee4\u90fd\u7ecf\u5386\u4e86\u7ec4\u5408\u4e8b\u4ef6\u3002</li> <li>\u5b9e\u73b0\u65f6\u95f4\u6bd4\u4f8b\u6027: \u901a\u8fc7\u53ea\u5728\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\u70b9\u6355\u83b7 PSV\uff0c\u5e76\u5c06\u5176\u4e0e\u6b63\u786e\u5f52\u56e0\u7684\u6307\u4ee4\u5730\u5740\u7ed1\u5b9a\uff0cTEA \u786e\u4fdd\u4e86\u6700\u7ec8 PICS \u7684\u65f6\u95f4\u6bd4\u4f8b\u6027\uff0c\u8fd9\u662f\u5176\u76f8\u8f83\u4e8e AMD IBS\u3001Arm SPE \u7b49\u4f20\u7edf\u65b9\u6cd5\u51c6\u786e\u7387\u5927\u5e45\u63d0\u5347\uff08\u5e73\u5747\u8bef\u5dee 2.1% vs. ~55.5%\uff09\u7684\u6839\u672c\u539f\u56e0\u3002</li> </ul> </li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#3-commit-state-based-event-hierarchy","title":"3. Commit-State-Based Event Hierarchy","text":"<p>TEA \u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\u5176 Commit-State-Based Event Hierarchy\uff08\u57fa\u4e8e\u63d0\u4ea4\u72b6\u6001\u7684\u4e8b\u4ef6\u5c42\u6b21\u7ed3\u6784\uff09\u8bbe\u8ba1\u3002\u8be5\u8bbe\u8ba1\u5c06\u590d\u6742\u7684\u5fae\u67b6\u6784\u6027\u80fd\u5206\u6790\u95ee\u9898\uff0c\u7cfb\u7edf\u6027\u5730\u5206\u89e3\u4e3a\u5bf9\u5904\u7406\u5668 commit stage\uff08\u63d0\u4ea4\u9636\u6bb5\uff09\u4e09\u79cd\u975e\u8ba1\u7b97\u72b6\u6001\u7684\u5f52\u56e0\u5206\u6790\uff0c\u5e76\u636e\u6b64\u6784\u5efa\u4e86\u4e00\u4e2a\u7cbe\u7b80\u800c\u9ad8\u6548\u7684\u6027\u80fd\u4e8b\u4ef6\u8ffd\u8e2a\u4f53\u7cfb\u3002</p> <p>\u6838\u5fc3\u539f\u7406\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <ul> <li>TEA \u7684\u6839\u672c\u51fa\u53d1\u70b9\u662f\uff1a\u4e00\u4e2a\u6307\u4ee4\u5bf9\u7a0b\u5e8f\u603b\u6267\u884c\u65f6\u95f4\u7684\u771f\u5b9e\u8d21\u732e\uff0c\u53ea\u6709\u5728\u5176 latency is exposed\uff08\u5ef6\u8fdf\u88ab\u66b4\u9732\uff09\u65f6\u624d\u80fd\u88ab\u51c6\u786e\u8861\u91cf\uff0c\u800c\u8fd9\u6070\u597d\u53d1\u751f\u5728 commit stage\u3002</li> <li>\u5728\u4efb\u610f\u7ed9\u5b9a\u5468\u671f\uff0c\u5904\u7406\u5668\u7684 commit stage \u5fc5\u7136\u5904\u4e8e\u4ee5\u4e0b\u56db\u79cd\u72b6\u6001\u4e4b\u4e00\uff1a</li> <li>Compute: \u6b63\u5728\u63d0\u4ea4\u6307\u4ee4\uff0c\u6b64\u65f6\u6307\u4ee4\u7684\u6267\u884c\u5ef6\u8fdf\u88ab\u5b8c\u5168\u9690\u85cf\u3002</li> <li>Stalled (ST): ROB\uff08Re-Order Buffer\uff09\u5934\u90e8\u7684\u6307\u4ee4\u5c1a\u672a\u6267\u884c\u5b8c\u6bd5\uff0c\u5bfc\u81f4\u63d0\u4ea4\u505c\u6ede\u3002</li> <li>Drained (DR): ROB \u5df2\u7a7a\uff0c\u901a\u5e38\u662f\u7531\u4e8e\u524d\u7aef\uff08\u5982\u53d6\u6307\uff09\u505c\u987f\u5bfc\u81f4\u65e0\u65b0\u6307\u4ee4\u8fdb\u5165\u6d41\u6c34\u7ebf\u3002</li> <li>Flushed (FL): \u7531\u4e8e\u9519\u8bef\u9884\u6d4b\u3001\u5f02\u5e38\u7b49\u539f\u56e0\uff0cROB \u88ab\u6e05\u7a7a\uff0c\u6240\u6709\u672a\u63d0\u4ea4\u7684\u5e74\u8f7b\u6307\u4ee4\u88ab\u4e22\u5f03\u3002</li> <li>\u5173\u952e\u6d1e\u5bdf\uff1a\u53ea\u6709 Stalled, Drained, \u548c Flushed \u8fd9\u4e09\u79cd non-compute states\uff08\u975e\u8ba1\u7b97\u72b6\u6001\uff09\u4f1a\u5bfc\u81f4\u6027\u80fd\u635f\u5931\uff0c\u56e0\u6b64\u6027\u80fd\u5206\u6790\u7684\u6838\u5fc3\u4efb\u52a1\u5c31\u662f\u5c06\u8fd9\u4e9b\u72b6\u6001\u7cbe\u786e\u5730\u6620\u5c04\u5230\u5176\u5e95\u5c42\u7684 performance events\uff08\u6027\u80fd\u4e8b\u4ef6\uff09\u4e0a\u3002</li> <li>\u4e3a\u4e86\u9ad8\u6548\u5b8c\u6210\u6b64\u6620\u5c04\uff0cTEA \u6784\u5efa\u4e86 event hierarchies\uff08\u4e8b\u4ef6\u5c42\u6b21\u7ed3\u6784\uff09\u3002\u8fd9\u4e9b\u5c42\u6b21\u7ed3\u6784\u63ed\u793a\u4e86\u4e8b\u4ef6\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff1a</li> <li>Independent events\uff08\u72ec\u7acb\u4e8b\u4ef6\uff09\uff1a\u53ef\u4ee5\u72ec\u7acb\u53d1\u751f\uff0c\u4f8b\u5982 L1 \u6570\u636e\u7f13\u5b58\u7f3a\u5931\u548c L1 TLB \u7f3a\u5931\u3002</li> <li>Dependent events\uff08\u4f9d\u8d56\u4e8b\u4ef6\uff09\uff1a\u5fc5\u987b\u5728\u524d\u7f6e\u4e8b\u4ef6\u53d1\u751f\u540e\u624d\u53ef\u80fd\u53d1\u751f\uff0c\u4f8b\u5982 LLC\uff08Last-Level Cache\uff09\u7f3a\u5931\u7684\u524d\u63d0\u662f L1 \u7f13\u5b58\u5df2\u7ecf\u7f3a\u5931\u3002</li> <li>\u57fa\u4e8e\u6b64\u5c42\u6b21\u7ed3\u6784\uff0cTEA \u91c7\u7528\u4e86\u4e00\u79cd\u81ea\u4e0a\u800c\u4e0b\u7684\u9009\u62e9\u7b56\u7565\uff1a\u4f18\u5148\u6355\u83b7\u5c42\u6b21\u7ed3\u6784\u4e2d\u8f83\u9ad8\u5c42\u7ea7\u7684 root events\uff08\u6839\u4e8b\u4ef6\uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u80fd\u89e3\u91ca\u6700\u5e7f\u6cdb\u7684\u4e0b\u6e38\u505c\u987f\u539f\u56e0\u3002\u4f8b\u5982\uff0c\u6355\u83b7 L1 data cache miss \u6bd4\u53ea\u6355\u83b7 LLC miss \u66f4\u5177\u89e3\u91ca\u529b\uff0c\u56e0\u4e3a\u524d\u8005\u5305\u542b\u4e86\u540e\u8005\u7684\u6240\u6709\u60c5\u51b5\u4ee5\u53ca L1 \u547d\u4e2d\u7684\u60c5\u51b5\u3002</li> </ul> <p></p> <p>Figure 3: Performance event hierarchy for the Stalled (ST) commit state.</p> <p>\u4e5d\u4e2a\u5173\u952e\u6027\u80fd\u4e8b\u4ef6\u7684\u9009\u62e9\u4e0e\u4f5c\u7528</p> <p>TEA \u6700\u7ec8\u7cbe\u5fc3\u6311\u9009\u4e86 nine performance events\uff08\u4e5d\u4e2a\u6027\u80fd\u4e8b\u4ef6\uff09\uff0c\u5206\u522b\u5bf9\u5e94\u4e09\u79cd\u975e\u8ba1\u7b97\u72b6\u6001\uff0c\u4ee5\u5728\u6781\u4f4e\u5f00\u9500\u4e0b\u63d0\u4f9b\u6700\u5927\u6d1e\u5bdf\u529b\u3002</p> Commit State Performance Event (TEA Label) \u4e8b\u4ef6\u63cf\u8ff0 \u4f5c\u7528 Drained (DR) DR-L1 L1 \u6307\u4ee4\u7f13\u5b58\u7f3a\u5931 \u89e3\u91ca\u56e0\u53d6\u6307\u505c\u987f\u5bfc\u81f4\u7684 ROB \u6392\u7a7a\u3002 DR-TLB L1 \u6307\u4ee4 TLB \u7f3a\u5931 \u89e3\u91ca\u56e0\u5730\u5740\u7ffb\u8bd1\u505c\u987f\u5bfc\u81f4\u7684\u53d6\u6307\u74f6\u9888\u3002 DR-SQ \u5b58\u50a8\u961f\u5217\uff08Store Queue\uff09\u6ee1 \u89e3\u91ca\u56e0\u5b58\u50a8\u5e26\u5bbd\u74f6\u9888\u5bfc\u81f4\u7684\u63d0\u4ea4\u505c\u6ede\u548c\u524d\u7aef\u505c\u987f\u3002 Flushed (FL) FL-MB \u5206\u652f\u9884\u6d4b\u9519\u8bef \u89e3\u91ca\u56e0\u9519\u8bef\u9884\u6d4b\u5bfc\u81f4\u7684\u6d41\u6c34\u7ebf\u51b2\u5237\u3002 FL-EX \u5f02\u5e38\uff08Exception\uff09 \u89e3\u91ca\u56e0\u5904\u7406\u5f02\u5e38\u5bfc\u81f4\u7684\u6d41\u6c34\u7ebf\u51b2\u5237\u3002 FL-MO \u5185\u5b58\u6392\u5e8f\u51b2\u7a81\uff08Memory Ordering Violation\uff09 \u89e3\u91ca\u56e0\u5185\u5b58\u4e00\u81f4\u6027\u95ee\u9898\u5bfc\u81f4\u7684\u51b2\u5237\u3002 Stalled (ST) ST-L1 L1 \u6570\u636e\u7f13\u5b58\u7f3a\u5931 \u89e3\u91ca\u56e0\u6570\u636e\u52a0\u8f7d\u5ef6\u8fdf\u5bfc\u81f4\u7684\u63d0\u4ea4\u505c\u6ede\u3002 ST-TLB L1 \u6570\u636e TLB \u7f3a\u5931 \u89e3\u91ca\u56e0\u6570\u636e\u5730\u5740\u7ffb\u8bd1\u5ef6\u8fdf\u5bfc\u81f4\u7684\u63d0\u4ea4\u505c\u6ede\u3002 ST-LLC LLC \u6570\u636e\u7f3a\u5931 \u4e3a\u5185\u5b58\u654f\u611f\u578b\u5e94\u7528\u63d0\u4f9b\u66f4\u6df1\u5c42\u6b21\u7684\u7f13\u5b58\u5c42\u6b21\u6d1e\u5bdf\u3002 <p></p> <p>Table 1: The performance events of TEA, IBS, SPE, and RIS.</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u6574\u4f53\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: \u5904\u7406\u5668\u5728\u8fd0\u884c\u65f6\u4ea7\u751f\u7684\u539f\u59cb\u5fae\u67b6\u6784\u4fe1\u53f7\uff0c\u4f8b\u5982\u7f13\u5b58\u54cd\u5e94\u4fe1\u53f7\u3001TLB \u67e5\u8be2\u7ed3\u679c\u3001\u5206\u652f\u9884\u6d4b\u5355\u5143\u7684 flush \u4fe1\u53f7\u3001LSQ\uff08Load/Store Queue\uff09\u7684\u6ee1\u4fe1\u53f7\u7b49\u3002</li> <li>\u5904\u7406\u8fc7\u7a0b: </li> <li>\u4e3a\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\uff08\u6216 \u00b5op\uff09\u5206\u914d\u4e00\u4e2a Performance Signature Vector (PSV)\uff0c\u8fd9\u662f\u4e00\u4e2a 9-bit \u7684\u4f4d\u5411\u91cf\uff0c\u6bcf\u4e00\u4f4d\u5bf9\u5e94\u4e0a\u8ff0\u4e5d\u4e2a\u4e8b\u4ef6\u4e4b\u4e00\u3002</li> <li>\u5728\u6307\u4ee4\u6d41\u7ecf\u6d41\u6c34\u7ebf\u5404\u9636\u6bb5\u65f6\uff0c\u786c\u4ef6\u903b\u8f91\u4f1a\u6839\u636e\u53d1\u751f\u7684\u4e8b\u4ef6\u5b9e\u65f6\u66f4\u65b0\u5176 PSV\u3002\u4f8b\u5982\uff0c\u5728\u53d6\u6307\u9636\u6bb5\u8bbe\u7f6e DR-L1/DR-TLB \u4f4d\uff0c\u5728\u8bbf\u5b58\u9636\u6bb5\u8bbe\u7f6e ST-L1/ST-TLB/ST-LLC \u4f4d\uff0c\u5728 ROB \u4e2d\u8bb0\u5f55 FL-MB/FL-EX/FL-MO \u4f4d\u3002</li> <li>Time-proportional sampling\uff08\u65f6\u95f4\u6bd4\u4f8b\u91c7\u6837\uff09\u786c\u4ef6\u4f1a\u5468\u671f\u6027\u5730\uff08\u5982 4 KHz\uff09\u68c0\u67e5 commit stage \u7684\u72b6\u6001\uff0c\u5e76\u6839\u636e TIP \u7684\u89c4\u5219\u9009\u62e9\u9700\u8981\u91c7\u6837\u7684\u6307\u4ee4\uff08\u5373\u5f53\u524d\u66b4\u9732\u5ef6\u8fdf\u7684\u6307\u4ee4\uff09\u3002</li> <li>\u91c7\u6837\u65f6\uff0c\u4e0d\u4ec5\u6355\u83b7\u6307\u4ee4\u5730\u5740\uff0c\u8fd8\u6355\u83b7\u5176\u5b8c\u6574\u7684 PSV\u3002</li> <li>\u8f93\u51fa: \u4e00\u4e2a\u5305\u542b (instruction address, PSV, timestamp, commit state) \u7684\u6837\u672c\u6d41\u3002</li> <li>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528: \u8fd9\u4e9b\u6837\u672c\u662f\u6784\u5efa Per-Instruction Cycle Stacks (PICS) \u7684\u552f\u4e00\u539f\u6750\u6599\u3002\u901a\u8fc7\u5728\u8f6f\u4ef6\u540e\u5904\u7406\u9636\u6bb5\u805a\u5408\u6240\u6709\u5177\u6709\u76f8\u540c\u9759\u6001\u6307\u4ee4\u5730\u5740\u548c\u76f8\u540c PSV \u7b7e\u540d\u7684\u6837\u672c\uff0cTEA \u80fd\u591f\u7cbe\u786e\u5730\u56de\u7b54\u4e24\u4e2a\u6839\u672c\u95ee\u9898\uff1a</li> <li>Q1 (Which?): \u6bcf\u4e2a\u9759\u6001\u6307\u4ee4\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\uff08\u7531\u5176\u6240\u6709\u6837\u672c\u7684\u603b\u6743\u91cd\u51b3\u5b9a\uff09\u3002</li> <li>Q2 (Why?): \u8be5\u8d21\u732e\u5177\u4f53\u662f\u7531\u54ea\u4e9b\uff08\u6216\u54ea\u4e9b\u7ec4\u5408\u7684\uff09\u6027\u80fd\u4e8b\u4ef6\u9020\u6210\u7684\uff08\u7531 PSV \u7b7e\u540d\u51b3\u5b9a\uff09\u3002\u8fd9\u79cd\u5c06\u65f6\u95f4\u6d88\u8017\u76f4\u63a5\u4e0e\u56e0\u679c\u4e8b\u4ef6\u6302\u94a9\u7684\u80fd\u529b\uff0c\u662f TEA \u76f8\u5bf9\u4e8e\u4f20\u7edf instruction-driven\uff08\u6307\u4ee4\u9a71\u52a8\uff09\u548c event-driven\uff08\u4e8b\u4ef6\u9a71\u52a8\uff09\u65b9\u6cd5\u7684\u6839\u672c\u4f18\u52bf\u3002</li> </ul>"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#4-time-proportional-sampling-logic","title":"4. Time-Proportional Sampling Logic","text":"<p>Time-Proportional Sampling Logic \u7684\u5b9e\u73b0\u539f\u7406\u4e0e\u6d41\u7a0b</p> <p>TEA \u7684\u6838\u5fc3\u5728\u4e8e\u5176 Time-Proportional Sampling Logic\uff0c\u8be5\u903b\u8f91\u7ee7\u627f\u5e76\u6269\u5c55\u4e86 TIP [22] \u7684\u5de5\u4f5c\uff0c\u786e\u4fdd\u6027\u80fd\u5206\u6790\u6837\u672c\u80fd\u7cbe\u786e\u53cd\u6620\u6307\u4ee4\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u771f\u5b9e\u8d21\u732e\u3002\u5176\u5b9e\u73b0\u7d27\u5bc6\u56f4\u7ed5\u5904\u7406\u5668 commit stage \u7684\u72b6\u6001\u673a\uff0c\u5e76\u901a\u8fc7\u786c\u4ef6\u652f\u6301\u7684\u7edf\u8ba1\u91c7\u6837\u6765\u6355\u83b7\u5173\u952e\u4fe1\u606f\u3002</p> <ul> <li>\u6838\u5fc3\u601d\u60f3: \u5728\u4efb\u4f55\u4e00\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u5904\u7406\u5668\u82b1\u8d39\u7684\u65f6\u95f4\u6700\u7ec8\u90fd\u4f1a\u4f53\u73b0\u5728 commit stage \u7684\u884c\u4e3a\u4e0a\u3002\u56e0\u6b64\uff0c\u91c7\u6837\u903b\u8f91\u5fc5\u987b\u8bc6\u522b\u51fa\u5728\u8be5\u5468\u671f\u5185\uff0c\u662f\u54ea\u4e2a\uff08\u6216\u54ea\u4e9b\uff09\u6307\u4ee4\u7684\u5ef6\u8fdf\u6b63\u5728\u88ab\u201c\u66b4\u9732\u201d\u51fa\u6765\uff0c\u5e76\u5c06\u8be5\u5468\u671f\u7684\u65f6\u95f4\u5f00\u9500\u5f52\u56e0\u4e8e\u8fd9\u4e9b\u6307\u4ee4\u3002</li> <li>\u56db\u79cd Commit \u72b6\u6001\u53ca\u5176\u5f52\u56e0\u7b56\u7565:<ul> <li>Compute: \u5904\u7406\u5668\u6b63\u5728\u63d0\u4ea4\u4e00\u6761\u6216\u591a\u6761\u6307\u4ee4\u3002\u6b64\u65f6\uff0c\u6267\u884c\u5ef6\u8fdf\u88ab\u5b8c\u5168\u9690\u85cf\u3002\u65f6\u95f4\u5f00\u9500\u88ab\u5e73\u5747\u5206\u914d\u7ed9\u6240\u6709\u5728\u8be5\u5468\u671f\u63d0\u4ea4\u7684\u6307\u4ee4\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a 4-wide \u7684\u6838\u5fc3\u540c\u65f6\u63d0\u4ea4 4 \u6761\u6307\u4ee4\uff0c\u5219\u6bcf\u6761\u6307\u4ee4\u88ab\u5206\u914d 1/4 \u4e2a\u5468\u671f\u7684\u65f6\u95f4\u3002</li> <li>Stalled: ROB (Re-Order Buffer) \u7684\u5934\u90e8\u6307\u4ee4 <code>I</code> \u5df2\u51c6\u5907\u597d\u63d0\u4ea4\uff0c\u4f46\u5c1a\u672a\u5b8c\u6210\u6267\u884c\uff08\u4f8b\u5982\uff0c\u7b49\u5f85\u7f13\u5b58\u52a0\u8f7d\u6570\u636e\uff09\u3002\u6b64\u65f6\uff0c\u6574\u4e2a\u5904\u7406\u5668\u88ab <code>I</code> \u963b\u585e\uff0c\u56e0\u6b64\u8be5\u5468\u671f\u7684\u5168\u90e8\u65f6\u95f4\u5f00\u9500\u90fd\u5f52\u56e0\u4e8e\u6307\u4ee4 <code>I</code>\uff08\u5373 next-committing instruction\uff09\u3002</li> <li>Drained: ROB \u4e3a\u7a7a\uff0c\u539f\u56e0\u662f\u524d\u7aef\u505c\u987f\uff08\u4f8b\u5982\uff0c\u53d6\u6307\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u3002\u6b64\u65f6\uff0c\u5904\u7406\u5668\u5728\u7b49\u5f85\u4e0b\u4e00\u6761\u6307\u4ee4\u8fdb\u5165\u6d41\u6c34\u7ebf\u3002\u65f6\u95f4\u5f00\u9500\u5f52\u56e0\u4e8e\u4e0b\u4e00\u6761\u5c06\u8981\u63d0\u4ea4\u7684\u6307\u4ee4\uff08\u540c\u6837\u662f next-committing instruction\uff09\u3002</li> <li>Flushed: \u7531\u4e8e\u9519\u8bef\u9884\u6d4b\u7684\u5206\u652f\u6216\u5f02\u5e38\u7b49\u539f\u56e0\uff0cROB \u88ab\u6e05\u7a7a\u3002\u6b64\u65f6\uff0c\u9020\u6210 flush \u7684\u90a3\u6761\u6307\u4ee4\uff08\u4f8b\u5982\uff0c\u9519\u8bef\u9884\u6d4b\u7684\u5206\u652f\uff09\u5df2\u7ecf\u63d0\u4ea4\uff0c\u4f46\u5176\u540e\u679c\uff08\u6e05\u7a7a\u6d41\u6c34\u7ebf\uff09\u5bfc\u81f4\u4e86\u540e\u7eed\u7684\u7a7a\u95f2\u5468\u671f\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9b\u7a7a\u95f2\u5468\u671f\u7684\u65f6\u95f4\u5f00\u9500\u5e94\u5f52\u56e0\u4e8e\u6700\u540e\u63d0\u4ea4\u7684\u90a3\u6761\u6307\u4ee4\uff08\u5373 last-committed instruction\uff09\uff0c\u800c\u975e\u4e0b\u4e00\u6761\u5c06\u8981\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 1: Example explaining how TEA creates PICS. TEA explains how performance events cause performance loss.</p> <ul> <li>\u786c\u4ef6\u91c7\u6837\u6d41\u7a0b:<ul> <li>\u4e00\u4e2a cycle counter\uff08\u901a\u5e38\u914d\u7f6e\u4e3a 4 KHz \u7684\u91c7\u6837\u9891\u7387\uff0c\u5728 3.2 GHz \u4e3b\u9891\u4e0b\u7ea6\u4e3a\u6bcf 800,000 \u4e2a\u5468\u671f\u91c7\u6837\u4e00\u6b21\uff09\u4f1a\u5b9a\u671f\u89e6\u53d1\u4e00\u4e2a PMU (Performance Monitoring Unit) \u4e8b\u4ef6\u3002</li> <li>\u5f53\u91c7\u6837\u4e8b\u4ef6\u89e6\u53d1\u65f6\uff0cSample Selection \u5355\u5143\uff08\u4f4d\u4e8e ROB \u5934\u90e8\uff09\u4f1a\u7acb\u5373\u68c0\u67e5\u5f53\u524d\u7684 commit \u72b6\u6001\uff08Compute, Stalled, Drained, or Flushed\uff09\u3002</li> <li>\u6839\u636e\u4e0a\u8ff0\u5f52\u56e0\u7b56\u7565\uff0c\u786c\u4ef6\u903b\u8f91\u4f1a\u9009\u62e9\u6b63\u786e\u7684\u6307\u4ee4\u6307\u9488\uff08IP\uff09\uff1a<ul> <li>\u5bf9\u4e8e Stalled \u548c Drained \u72b6\u6001\uff0c\u5b83\u4f1a\u9009\u62e9 ROB \u5934\u90e8\u7684\u6307\u4ee4\uff08next-committing\uff09\u3002</li> <li>\u5bf9\u4e8e Flushed \u72b6\u6001\uff0cTEA \u4e13\u95e8\u7ef4\u62a4\u4e86\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u5b58\u50a8 last-committed instruction \u7684 PSV (Performance Signature Vector)\uff0c\u4ee5\u786e\u4fdd\u80fd\u6b63\u786e\u5f52\u56e0\u3002</li> <li>\u5bf9\u4e8e Compute \u72b6\u6001\uff0c\u5b83\u4f1a\u9009\u62e9\u5f53\u524d\u5468\u671f\u6240\u6709\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</li> </ul> </li> <li>\u9009\u4e2d\u7684\u6307\u4ee4\u7684 Instruction Pointer(s) \u548c\u5bf9\u5e94\u7684 PSV(s) \u4f1a\u88ab\u6253\u5305\u6210\u4e00\u4e2a\u6837\u672c\u3002</li> <li>\u8be5\u6837\u672c\u88ab\u5199\u5165 Control and Status Registers (CSRs)\uff0c\u5e76\u89e6\u53d1\u4e00\u4e2a\u4e2d\u65ad\u3002</li> <li>\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff08\u901a\u5e38\u662f Linux <code>perf</code> \u5de5\u5177\u7684\u4e00\u90e8\u5206\uff09\u4f1a\u8bfb\u53d6 CSR \u4e2d\u7684\u6837\u672c\u6570\u636e\uff0c\u5e76\u5c06\u5176\u8fde\u540c\u65f6\u95f4\u6233\u3001\u6838\u5fc3 ID\u3001\u8fdb\u7a0b/\u7ebf\u7a0b ID \u7b49\u5143\u6570\u636e\u4e00\u8d77\u5b58\u50a8\u5230\u5185\u5b58\u7f13\u51b2\u533a\u4e2d\u3002</li> </ul> </li> </ul> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728 TEA \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165:<ul> <li>\u5904\u7406\u5668\u5728\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u7684 commit stage \u72b6\u6001\u3002</li> <li>\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\u5728\u5176\u751f\u547d\u5468\u671f\u5185\u7d2f\u79ef\u7684 PSV\uff0c\u8be5\u5411\u91cf\u8bb0\u5f55\u4e86\u8be5\u6307\u4ee4\u6240\u7ecf\u5386\u7684\u6240\u6709\u5173\u952e\u6027\u80fd\u4e8b\u4ef6\uff08\u5982\u7f13\u5b58\u672a\u547d\u4e2d\u3001TLB \u672a\u547d\u4e2d\u3001\u5206\u652f\u8bef\u9884\u6d4b\u7b49\uff09\u3002</li> <li>\u7531 cycle counter \u4ea7\u751f\u7684\u5468\u671f\u6027\u91c7\u6837\u4fe1\u53f7\u3002</li> </ul> </li> <li>\u8f93\u51fa:<ul> <li>\u4e00\u4e2a\u5305\u542b\u4ee5\u4e0b\u5b57\u6bb5\u7684 \u6837\u672c (sample):<ul> <li>Timestamp: \u91c7\u6837\u53d1\u751f\u7684\u65f6\u95f4\u3002</li> <li>Flags: \u5305\u542b commit \u72b6\u6001\u548c\u6709\u6548\u4f4d\u7b49\u4fe1\u606f\u3002</li> <li>Instruction Pointer(s): \u88ab\u5f52\u56e0\u7684\u9759\u6001\u6307\u4ee4\u5730\u5740\u3002</li> <li>PSV(s): \u4e0e\u4e0a\u8ff0\u6307\u4ee4\u6307\u9488\u5bf9\u5e94\u7684\u6027\u80fd\u7b7e\u540d\u5411\u91cf\u3002</li> </ul> </li> </ul> </li> <li>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:<ul> <li>\u6865\u6881\u4f5c\u7528: Time-Proportional Sampling Logic \u662f\u8fde\u63a5\u5e95\u5c42\u5fae\u67b6\u6784\u4e8b\u4ef6\uff08PSV\uff09\u548c\u4e0a\u5c42\u6027\u80fd\u5206\u6790\uff08PICS\uff09\u7684\u5173\u952e\u6865\u6881\u3002\u5b83\u786e\u4fdd\u4e86\u6536\u96c6\u5230\u7684\u539f\u59cb\u6570\u636e\uff08\u6837\u672c\uff09\u672c\u8eab\u5c31\u5177\u6709 time-proportionality \u7684\u5c5e\u6027\u3002</li> <li>\u4fdd\u8bc1\u51c6\u786e\u6027: \u901a\u8fc7\u7cbe\u786e\u5730\u5c06\u65f6\u95f4\u5f00\u9500\u5f52\u56e0\u4e8e\u6b63\u786e\u7684\u6307\u4ee4\uff0c\u8be5\u903b\u8f91\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u4f20\u7edf\u6307\u4ee4\u9a71\u52a8\uff08\u5982 IBS, SPE\uff09\u65b9\u6cd5\u56e0\u5728 fetch/dispatch \u9636\u6bb5\u6253\u6807\u7b7e\u800c\u5bfc\u81f4\u7684\u975e\u65f6\u95f4\u6bd4\u4f8b\u6027\u504f\u5dee\u95ee\u9898\u3002\u8fd9\u662f TEA \u80fd\u591f\u5b9e\u73b0 2.1% \u5e73\u5747\u8bef\u5dee\uff08\u8fdc\u4f18\u4e8e IBS/SPE/RIS \u7684 ~55.5%\uff09\u7684\u6839\u672c\u539f\u56e0\u3002</li> <li>\u652f\u6491 PICS \u6784\u5efa: \u540e\u7eed\u7684\u79bb\u7ebf\u5206\u6790\u5de5\u5177\u6b63\u662f\u4f9d\u8d56\u8fd9\u4e9b\u5e26\u6709\u65f6\u95f4\u6bd4\u4f8b\u5c5e\u6027\u7684\u6837\u672c\uff0c\u901a\u8fc7\u805a\u5408\u76f8\u540c\u9759\u6001\u6307\u4ee4\u5730\u5740\u7684 PSV\uff0c\u6765\u6784\u5efa\u51fa\u6700\u7ec8\u7684 Per-Instruction Cycle Stacks (PICS)\u3002PICS \u7684\u9ad8\u5ea6\u4ee3\u8868\u4e86\u8be5\u6307\u4ee4\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\uff08\u56de\u7b54 Q1\uff09\uff0c\u800c\u5176\u5185\u90e8\u5404\u90e8\u5206\u7684\u5927\u5c0f\u5219\u4ee3\u8868\u4e86\u4e0d\u540c\u6027\u80fd\u4e8b\u4ef6\u5bf9\u8be5\u6307\u4ee4\u6267\u884c\u65f6\u95f4\u7684\u5f71\u54cd\uff08\u56de\u7b54 Q2\uff09\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 6: PICS for the top-3 instructions as provided by IBS, TEA, and the golden reference (GR). The PICS provided by TEA are accurate compared to the golden reference, in contrast to IBS.</p>"},{"location":"notes_repo/tea-time-proportional-event-analysis/paper_notes/#4","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u6a21\u62df\u5668\u4e0e\u5e73\u53f0: \u4f7f\u7528 FireSim\uff0c\u4e00\u4e2a\u57fa\u4e8e FPGA \u7684\u5468\u671f\u7cbe\u786e\u5168\u7cfb\u7edf\u6a21\u62df\u5668\uff0c\u5728 NTNU \u7684 Idun \u96c6\u7fa4\u4e0a\u8fd0\u884c\u3002</li> <li>\u76ee\u6807\u6838\u5fc3: \u8bc4\u4f30\u5bf9\u8c61\u4e3a Berkeley Out-of-Order Machine (BOOM) 4\u8def\u8d85\u6807\u91cf\u4e71\u5e8f\u6267\u884c\u6838\u5fc3\uff0c\u5176\u5177\u4f53\u914d\u7f6e\u8be6\u89c1\u4e0b\u8868\u3002</li> <li>\u6570\u636e\u6536\u96c6: \u901a\u8fc7 TraceDoctor \u5de5\u5177\u6355\u83b7\u5468\u671f\u7ea7\u7684\u8be6\u7ec6\u8ffd\u8e2a\u6570\u636e\uff0c\u5305\u62ec\u6307\u4ee4\u5730\u5740\u3001\u63d0\u4ea4/\u5237\u65b0\u6807\u5fd7\u4ee5\u53ca\u6027\u80fd\u7b7e\u540d\u5411\u91cf\uff08PSV\uff09\u3002</li> <li>\u8bc4\u4f30\u65b9\u6cd5: \u5728\u4e3b\u673a CPU \u4e0a\u5e76\u884c\u5904\u7406\u8ffd\u8e2a\u6570\u636e\uff0c\u4ee5\u201c\u5e26\u5916\u201d\uff08out-of-band\uff09\u65b9\u5f0f\u6a21\u62df\u591a\u79cd\u6027\u80fd\u5206\u6790\u65b9\u6848\uff08\u5982 TEA, IBS, SPE, RIS\uff09\uff0c\u786e\u4fdd\u6240\u6709\u65b9\u6848\u5728\u5b8c\u5168\u76f8\u540c\u7684\u6267\u884c\u8f68\u8ff9\u4e0a\u8fdb\u884c\u516c\u5e73\u6bd4\u8f83\u3002</li> </ul> <p></p> <p>Table 2: Baseline architecture configuration.</p> <ul> <li>\u57fa\u51c6\u6d4b\u8bd5\u96c6: \u91c7\u7528\u5b8c\u6574\u7684 SPEC CPU2017 \u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6\u4e2d\u7684\u517c\u5bb9\u5b50\u96c6\uff0c\u4f7f\u7528\u53c2\u8003\u8f93\u5165\u96c6\u8fd0\u884c\u81f3\u5b8c\u6210\u3002</li> <li>\u7f16\u8bd1\u9009\u9879: \u6240\u6709\u57fa\u51c6\u7a0b\u5e8f\u5747\u4f7f\u7528 GCC 10.1 \u4ee5 <code>-O3 -g</code> \u6807\u5fd7\u9759\u6001\u94fe\u63a5\u7f16\u8bd1\u3002</li> <li>\u9ec4\u91d1\u53c2\u8003 (Golden Reference): \u4e00\u4e2a\u7406\u60f3\u5316\u7684\u3001\u975e\u5b9e\u9645\u53ef\u5b9e\u73b0\u7684\u53c2\u8003\u6807\u51c6\uff0c\u5b83\u4e3a\u6bcf\u4e2a\u52a8\u6001\u6307\u4ee4\u5728\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u8bb0\u5f55\u5176 PSV\uff0c\u4ece\u800c\u6784\u5efa\u51fa\u5b8c\u7f8e\u7684 PICS\u3002\u6b64\u53c2\u8003\u7528\u4e8e\u91cf\u5316\u5176\u4ed6\u91c7\u6837\u65b9\u6cd5\u7684\u8bef\u5dee\u3002</li> <li>\u8bef\u5dee\u5ea6\u91cf: \u91c7\u7528\u4e00\u79cd\u57fa\u4e8e\u7ec4\u4ef6\u7684\u8bef\u5dee\u8ba1\u7b97\u65b9\u6cd5\u3002\u5bf9\u4e8e\u6bcf\u4e2a PICS \u7ec4\u4ef6\uff08\u4ee3\u8868\u7279\u5b9a\u4e8b\u4ef6\u7ec4\u5408\uff09\uff0c\u6b63\u786e\u5f52\u56e0\u7684\u5468\u671f\u6570\u4e3a\u8be5\u7ec4\u4ef6\u5728\u91c7\u6837\u7ed3\u679c\u548c\u9ec4\u91d1\u53c2\u8003\u4e2d\u7684\u6700\u5c0f\u503c\u3002\u603b\u8bef\u5dee\u5b9a\u4e49\u4e3a <code>(\u603b\u5468\u671f\u6570 - \u6b63\u786e\u5f52\u56e0\u5468\u671f\u6570) / \u603b\u5468\u671f\u6570</code>\u3002</li> </ul> <p>\u7ed3\u679c\u6570\u636e\u5206\u6790</p> <ul> <li>\u6574\u4f53\u51c6\u786e\u6027: TEA \u5728\u6240\u6709\u8bc4\u4f30\u65b9\u6848\u4e2d\u8868\u73b0\u6700\u4f73\u3002<ul> <li>TEA \u76f8\u5bf9\u4e8e\u9ec4\u91d1\u53c2\u8003\u7684\u5e73\u5747\u8bef\u5dee\u4ec5\u4e3a 2.1%\uff0c\u6700\u5927\u8bef\u5dee\u4e3a 7.7%\u3002</li> <li>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u73b0\u6709\u6307\u4ee4\u9a71\u52a8\u65b9\u6848 AMD IBS\u3001Arm SPE \u548c IBM RIS \u7684\u5e73\u5747\u8bef\u5dee\u5747\u9ad8\u8fbe\u7ea6 55.5%-56.0%\u3002</li> <li>\u5373\u4f7f\u662f\u6539\u8fdb\u7684 NCI-TEA\uff08\u91c7\u7528 Intel PEBS \u7684\u201c\u4e0b\u4e00\u63d0\u4ea4\u6307\u4ee4\u201d\u91c7\u6837\u7b56\u7565\uff09\uff0c\u5176\u5e73\u5747\u8bef\u5dee\u4e5f\u8fbe\u5230 11.3%\uff0c\u8fdc\u9ad8\u4e8e TEA\u3002</li> <li>\u8fd9\u4e9b\u7ed3\u679c\u6e05\u6670\u5730\u8bc1\u660e\u4e86\u65f6\u95f4\u6bd4\u4f8b\u6027\uff08time-proportionality\uff09\u548c\u6b63\u786e\u7684\u6307\u4ee4\u5f52\u56e0\uff08\u7279\u522b\u662f\u5728 Flushed \u72b6\u6001\u4e0b\uff09\u5bf9\u51c6\u786e\u6027\u7684\u51b3\u5b9a\u6027\u4f5c\u7528\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 5: Quantifying the error for the PICS obtained through IBS, SPE, RIS, NCI-TEA, and TEA. TEA achieves the highest accuracy within 2.1% (and at most 7.7%) compared to the golden reference.</p> <ul> <li>\u6307\u4ee4\u7ea7\u51c6\u786e\u6027: \u5bf9 SPEC \u4e2d\u4ee3\u8868\u6027\u57fa\u51c6\uff08\u5982 bwaves, omnetpp, fotonik3d\uff09\u7684 top-3 \u8017\u65f6\u6307\u4ee4\u8fdb\u884c\u5206\u6790\u3002<ul> <li>IBS/SPE/RIS \u7684 PICS \u5b58\u5728\u53cc\u91cd\u5931\u771f\uff1a\u4e00\u662f\u6808\u9ad8\u4e0d\u51c6\u786e\uff08\u9519\u8bef\u8bc6\u522b\u6027\u80fd\u5173\u952e\u6307\u4ee4\uff09\uff0c\u4e8c\u662f\u5185\u90e8\u7ec4\u4ef6\u6bd4\u4f8b\u5931\u771f\uff08\u9519\u8bef\u5f52\u56e0\u6027\u80fd\u4e8b\u4ef6\uff09\u3002</li> <li>TEA \u751f\u6210\u7684 PICS \u4e0e\u9ec4\u91d1\u53c2\u8003\u9ad8\u5ea6\u543b\u5408\uff0c\u80fd\u591f\u7cbe\u786e\u8bc6\u522b\u7ec4\u5408\u4e8b\u4ef6\uff08combined events\uff09\uff0c\u4f8b\u5982\u540c\u65f6\u53d1\u751f\u7684\u7f13\u5b58\u672a\u547d\u4e2d\u548c TLB \u672a\u547d\u4e2d\uff08(ST-L1, ST-TLB)\uff09\uff0c\u8fd9\u5bf9\u4e8e\u8bca\u65ad\u590d\u6742\u6027\u80fd\u74f6\u9888\u81f3\u5173\u91cd\u8981\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 6: PICS for the top-3 instructions as provided by IBS, TEA, and the golden reference (GR). The PICS provided by TEA are accurate compared to the golden reference, in contrast to IBS.</p> <ul> <li>\u4e8b\u4ef6\u8ba1\u6570\u4e0e\u6027\u80fd\u5f71\u54cd\u7684\u76f8\u5173\u6027: \u91cf\u5316\u4e86\u4f20\u7edf\u4e8b\u4ef6\u9a71\u52a8\u5206\u6790\u7684\u5c40\u9650\u6027\u3002<ul> <li>\u5f3a\u76f8\u5173\u4e8b\u4ef6: \u5bfc\u81f4\u6d41\u6c34\u7ebf\u5237\u65b0\u7684\u4e8b\u4ef6\uff08\u5982\u5206\u652f\u8bef\u9884\u6d4b FL-MB\u3001\u5f02\u5e38 FL-EX\uff09\u4e0e\u6027\u80fd\u5f71\u54cd\u9ad8\u5ea6\u76f8\u5173\uff08Pearson \u7cfb\u6570\u63a5\u8fd1 1\uff09\uff0c\u56e0\u4e3a\u5176\u5ef6\u8fdf\u51e0\u4e4e\u65e0\u6cd5\u88ab\u9690\u85cf\u3002</li> <li>\u5f31\u76f8\u5173\u4e8b\u4ef6: \u7f13\u5b58/TLB \u672a\u547d\u4e2d\u7b49\u4e8b\u4ef6\u4e0e\u6027\u80fd\u5f71\u54cd\u7684\u76f8\u5173\u6027\u8f83\u5f31\u4e14\u6ce2\u52a8\u5927\uff0c\u56e0\u4e3a\u73b0\u4ee3\u5904\u7406\u5668\u53ef\u4ee5\u901a\u8fc7\u5ef6\u8fdf\u9690\u85cf\uff08latency hiding\uff09\u6765\u63a9\u76d6\u90e8\u5206\u5ef6\u8fdf\u3002</li> <li>\u6700\u5f31\u76f8\u5173\u4e8b\u4ef6: \u5b58\u50a8\u961f\u5217\u6ee1\uff08DR-SQ\uff09\u4e8b\u4ef6\u7684\u76f8\u5173\u6027\u6700\u5dee\uff0c\u6709\u65f6\u5b8c\u5168\u88ab\u9690\u85cf\uff0c\u6709\u65f6\u5219\u6210\u4e3a\u4e3b\u8981\u74f6\u9888\u3002\u8fd9\u89e3\u91ca\u4e86\u4e3a\u4f55\u4ec5\u4f9d\u8d56 PMC \u8ba1\u6570\u8fdb\u884c\u6027\u80fd\u8c03\u4f18\u6781\u5176\u56f0\u96be\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 7: Quantifying the correlation between event count and its impact on performance. Some event counts correlate strongly with their impact on performance while others do not.</p> <ul> <li>\u654f\u611f\u6027\u5206\u6790:<ul> <li>\u91c7\u6837\u9891\u7387: \u5728 4 KHz \u53ca\u4ee5\u4e0a\u9891\u7387\u65f6\uff0cTEA \u7684\u51c6\u786e\u6027\u8d8b\u4e8e\u7a33\u5b9a\uff0c\u8fd9\u4e5f\u662f\u9009\u62e9\u8be5\u9891\u7387\u4f5c\u4e3a\u9ed8\u8ba4\u503c\u7684\u539f\u56e0\uff0c\u4ee5\u5e73\u8861\u5f00\u9500\u4e0e\u7cbe\u5ea6\u3002</li> <li>\u5206\u6790\u7c92\u5ea6: \u5728\u6307\u4ee4\u7ea7\u548c\u51fd\u6570\u7ea7\u7c92\u5ea6\u4e0a\uff0cTEA \u5747\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u65b9\u6cd5\u3002\u5176\u4ed6\u65b9\u6cd5\u5373\u4f7f\u5728\u66f4\u7c97\u7684\u51fd\u6570\u7c92\u5ea6\u4e0a\uff0c\u8bef\u5dee\u4e0b\u964d\u4e5f\u4e0d\u660e\u663e\uff0c\u56e0\u4e3a\u5176\u7cfb\u7edf\u6027\u5f52\u56e0\u9519\u8bef\u65e0\u6cd5\u901a\u8fc7\u805a\u5408\u6d88\u9664\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 8: Error versus sampling frequency.</p> <p></p> <p>Figure 9: Errors at instruction and function granularity.</p> <p>\u6d88\u878d\u5b9e\u9a8c\u4e0e\u5bf9\u6bd4\u5206\u6790</p> <p>\u8bba\u6587\u901a\u8fc7\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u5bf9\u6bd4\u5b9e\u9a8c\uff0c\u6709\u6548\u5730\u8fdb\u884c\u4e86\u201c\u6d88\u878d\u201d\u5206\u6790\uff0c\u9a8c\u8bc1\u4e86 TEA \u5404\u4e2a\u8bbe\u8ba1\u51b3\u7b56\u7684\u6709\u6548\u6027\u3002</p> <ul> <li>\u65f6\u95f4\u6bd4\u4f8b\u6027 vs. \u6307\u4ee4\u9a71\u52a8\u91c7\u6837:<ul> <li>\u6838\u5fc3\u5bf9\u6bd4: \u5c06 TEA\uff08\u5728\u63d0\u4ea4\u9636\u6bb5\u91c7\u6837\uff09\u4e0e IBS/SPE/RIS\uff08\u5728\u53d6\u6307/\u6d3e\u53d1\u9636\u6bb5\u91c7\u6837\uff09\u8fdb\u884c\u5bf9\u6bd4\u3002</li> <li>\u7ed3\u8bba: \u540e\u8005\u56e0\u5728\u524d\u7aef\u91c7\u6837\uff0c\u4f1a\u8fc7\u5ea6\u8868\u793a\u90a3\u4e9b\u5728\u524d\u7aef\u505c\u7559\u65f6\u95f4\u957f\u4f46\u5bf9\u6574\u4f53\u6267\u884c\u65f6\u95f4\u8d21\u732e\u4e0d\u5927\u7684\u6307\u4ee4\uff0c\u5bfc\u81f4\u4e25\u91cd\u7684\u975e\u65f6\u95f4\u6bd4\u4f8b\u6027\u504f\u5dee\u3002\u8fd9\u662f\u5b83\u4eec\u9ad8\u8fbe 55%+ \u8bef\u5dee\u7684\u6839\u672c\u539f\u56e0\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 2: Example comparing TEA to dispatch-tagging. TEA is time-proportional whereas dispatch-tagging is not.</p> <ul> <li> <p>\u6b63\u786e\u7684\u6307\u4ee4\u5f52\u56e0\u7b56\u7565:</p> <ul> <li>\u6838\u5fc3\u5bf9\u6bd4: \u5c06 TEA \u4e0e NCI-TEA\uff08\u91c7\u7528\u201c\u4e0b\u4e00\u63d0\u4ea4\u6307\u4ee4\u201d\u7b56\u7565\uff09\u8fdb\u884c\u5bf9\u6bd4\u3002</li> <li>\u7ed3\u8bba: NCI-TEA \u867d\u7136\u5728 Stalled/Drained \u72b6\u6001\u4e0b\u8868\u73b0\u5c1a\u53ef\uff0c\u4f46\u5728 Flushed \u72b6\u6001\u4e0b\u4f1a\u9519\u8bef\u5730\u5c06\u6027\u80fd\u635f\u5931\u5f52\u56e0\u4e8e\u201c\u4e0b\u4e00\u63d0\u4ea4\u6307\u4ee4\u201d\uff0c\u800c\u771f\u6b63\u7684\u7f6a\u9b41\u7978\u9996\u662f\u5df2\u7ecf\u63d0\u4ea4\u4f46\u5bfc\u81f4\u5237\u65b0\u7684\u6307\u4ee4\uff08\u5982\u8bef\u9884\u6d4b\u7684\u5206\u652f\uff09\u3002TEA \u901a\u8fc7\u8ffd\u8e2a\u201c\u6700\u540e\u63d0\u4ea4\u6307\u4ee4\u201d\u7684 PSV \u89e3\u51b3\u4e86\u6b64\u95ee\u9898\uff0c\u4f7f\u5176\u5e73\u5747\u8bef\u5dee\u4ece 11.3% \u964d\u81f3 2.1%\u3002</li> </ul> </li> <li> <p>\u4e8b\u4ef6\u96c6\u7684\u9009\u62e9:</p> <ul> <li>\u6709\u6548\u6027\u9a8c\u8bc1: \u8bba\u6587\u8bba\u8bc1\u4e86\u5176\u9009\u62e9\u7684 9 \u4e2a\u5173\u952e\u6027\u80fd\u4e8b\u4ef6\u8db3\u4ee5\u8986\u76d6\u7edd\u5927\u591a\u6570\uff0899%\uff09\u7684\u91cd\u5927\u505c\u987f\u5468\u671f\uff08&gt;5.8 cycles\uff09\u3002</li> <li>\u9690\u542b\u5bf9\u6bd4: \u867d\u7136\u6ca1\u6709\u76f4\u63a5\u6d4b\u8bd5\u4e0d\u540c\u4e8b\u4ef6\u96c6\u5927\u5c0f\u7684 TEA \u53d8\u4f53\uff0c\u4f46\u901a\u8fc7\u4e0e IBS/SPE/RIS\uff08\u5b83\u4eec\u652f\u6301\u4e0d\u540c\u6570\u91cf\u7684\u4e8b\u4ef6\uff09\u7684\u5bf9\u6bd4\uff0c\u4ee5\u53ca\u5bf9\u672a\u88ab TEA \u4e8b\u4ef6\u8986\u76d6\u7684\u505c\u987f\u5468\u671f\u7684\u5206\u6790\uff0c\u95f4\u63a5\u8bc1\u660e\u4e86\u5176\u4e8b\u4ef6\u9009\u62e9\u7684\u9ad8\u6548\u6027\u4e0e\u5145\u5206\u6027\uff0c\u5728\u6781\u4f4e\u5f00\u9500\u4e0b\u5b9e\u73b0\u4e86\u9ad8\u7cbe\u5ea6\u3002</li> </ul> </li> </ul> <p></p> <p>Table 1: The performance events of TEA, IBS, SPE, and RIS.</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/ELI5_notes/","title":"TIP: Time-Proportional Instruction Profiling \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/tip-time-proportional-instruction-profiling/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\uff08profilers\uff09\u5728\u73b0\u4ee3\u9ad8\u6027\u80fd\u5904\u7406\u5668\u4e0a\u201c\u6307\u9e7f\u4e3a\u9a6c\u201d\u3002\u5b83\u4eec\u8bd5\u56fe\u544a\u8bc9\u4f60\u7a0b\u5e8f\u7684\u65f6\u95f4\u82b1\u5728\u54ea\u6761\u6307\u4ee4\u4e0a\uff0c\u4f46\u56e0\u4e3a\u5904\u7406\u5668\u5185\u90e8\u6781\u5ea6\u590d\u6742\u7684 out-of-order execution \u548c pipeline stalls\uff0c\u8fd9\u4e9b\u5de5\u5177\u7684\u91c7\u6837\u903b\u8f91\u4e0e\u771f\u5b9e\u7684\u6027\u80fd\u74f6\u9888\u8131\u8282\u3002 - \u5177\u4f53\u6765\u8bf4\uff0c\u73b0\u6709\u65b9\u6cd5\u5982 Intel PEBS \u7684 Next-Committing Instruction (NCI) \u542f\u53d1\u5f0f\uff0c\u5728\u9047\u5230 pipeline flush\uff08\u4f8b\u5982\u5206\u652f\u9884\u6d4b\u9519\u8bef\uff09\u65f6\uff0c\u4f1a\u628a\u65f6\u95f4\u9519\u8bef\u5730\u5f52\u548e\u4e8e flush \u4e4b\u540e\u63d0\u4ea4\u7684\u7b2c\u4e00\u6761\u6307\u4ee4\uff0c\u800c\u4e0d\u662f\u771f\u6b63\u5f15\u53d1 flush \u7684\u90a3\u6761\u6307\u4ee4\u3002\u8fd9\u5c31\u50cf\u706b\u707e\u540e\uff0c\u6d88\u9632\u5458\u4e0d\u53bb\u627e\u7eb5\u706b\u72af\uff0c\u53cd\u800c\u53bb\u8d23\u602a\u7b2c\u4e00\u4e2a\u8dd1\u8fdb\u706b\u573a\u7684\u6551\u706b\u961f\u5458\u3002 - \u8bba\u6587\u7528\u4e00\u4e2a\u7406\u60f3\u7684 Oracle profiler \u4f5c\u4e3a\u9ec4\u91d1\u6807\u51c6\u8fdb\u884c\u91cf\u5316\uff0c\u53d1\u73b0\u5373\u4fbf\u662f\u6700\u5148\u8fdb\u7684 NCI \u65b9\u6cd5\uff0c\u5176 instruction-level profile error \u4e5f\u9ad8\u8fbe 9.3%\uff0c\u800c\u5176\u4ed6\u65b9\u6cd5\uff08\u5982 Software, Dispatch, LCI\uff09\u7684\u9519\u8bef\u7387\u66f4\u662f\u8d85\u8fc7\u4e86 50%\u3002\u8fd9\u79cd\u7cfb\u7edf\u6027\u504f\u5dee\u8ba9\u5f00\u53d1\u8005\u5f88\u96be\u5b9a\u4f4d\u771f\u6b63\u7684\u6027\u80fd\u74f6\u9888\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u5728\u7ba1\u7406\u4e00\u6761\u7e41\u5fd9\u7684\u9ad8\u901f\u516c\u8def\uff08\u5904\u7406\u5668 pipeline\uff09\u3002\u4f60\u7684\u4efb\u52a1\u662f\u627e\u51fa\u54ea\u4e2a\u5165\u53e3\uff08\u6307\u4ee4\uff09\u9020\u6210\u4e86\u6700\u4e25\u91cd\u7684\u62e5\u5835\uff08stall\uff09\u3002 - \u65e7\u7684\u65b9\u6cd5\u5c31\u50cf\u662f\u5728\u51fa\u53e3\u6536\u8d39\u7ad9\uff08commit stage\uff09\u968f\u673a\u62e6\u4e0b\u4e00\u8f86\u8f66\uff08NCI\uff09\uff0c\u7136\u540e\u95ee\uff1a\u201c\u563f\uff0c\u4f60\u89c9\u5f97\u5835\u8f66\u662f\u56e0\u4e3a\u8c01\uff1f\u201d \u8fd9\u8f86\u8f66\u53ef\u80fd\u53ea\u662f\u6070\u597d\u8def\u8fc7\uff0c\u5bf9\u62e5\u5835\u6beb\u65e0\u8d23\u4efb\u3002 - \u800c\u8bba\u6587\u63d0\u51fa\u7684 TIP (Time-Proportional Instruction Profiling) \u5219\u50cf\u662f\u5728\u6bcf\u4e2a\u8f66\u9053\u4e0a\u90fd\u5b89\u88c5\u4e86\u667a\u80fd\u6444\u50cf\u5934\u3002\u5b83\u4e0d\u4ec5\u80fd\u8bb0\u5f55\u54ea\u8f86\u8f66\u901a\u8fc7\u4e86\u51fa\u53e3\uff0c\u66f4\u80fd\u56de\u6eaf\u5230\u62e5\u5835\u53d1\u751f\u65f6\uff0c\u662f\u54ea\u8f86\u8f66\uff08\u6216\u54ea\u4e9b\u8f66\uff09\u5361\u5728\u4e86\u6700\u524d\u9762\uff0c\u6321\u4f4f\u4e86\u540e\u9762\u6240\u6709\u4eba\u7684\u8def\u3002\u5b83\u5173\u6ce8\u7684\u662f \u8c01\u66b4\u9732\u4e86\u5ef6\u8fdf\uff08exposed the latency\uff09\uff0c\u800c\u4e0d\u662f\u8c01\u78b0\u5de7\u5728\u9519\u8bef\u7684\u65f6\u95f4\u51fa\u73b0\u5728\u4e86\u9519\u8bef\u7684\u5730\u70b9\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\uff1a\u4e00\u4e2a\u51c6\u786e\u7684 profiler \u5fc5\u987b\u505a\u5230 time-proportional attribution\uff0c\u5373\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u5e94\u8be5\u88ab\u5f52\u56e0\u4e8e\u90a3\u4e2a\u8ba9\u5904\u7406\u5668\u201c\u5361\u4f4f\u201d\u7684\u6307\u4ee4\u3002 - \u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0cTIP \u5e76\u6ca1\u6709\u53d1\u660e\u5168\u65b0\u7684\u786c\u4ef6\uff0c\u800c\u662f\u5de7\u5999\u5730\u5c06\u7406\u60f3 Oracle profiler \u7684\u5f52\u56e0\u903b\u8f91\u4e0e\u73b0\u5b9e\u53ef\u884c\u7684 statistical sampling \u7ed3\u5408\u8d77\u6765\u3002 - \u5177\u4f53\u6765\u8bf4\uff0cTIP \u5728\u5904\u7406\u5668\u7684 Reorder Buffer (ROB) \u63d0\u4ea4\u9636\u6bb5\u505a\u6587\u7ae0\uff1a   - \u5f53\u5904\u7406\u5668\u6b63\u5e38\u63d0\u4ea4\u591a\u6761\u6307\u4ee4\u65f6\uff08Computing state\uff09\uff0cTIP \u4f1a\u5c06\u91c7\u6837\u5230\u7684\u65f6\u95f4 \u5e73\u5747\u5206\u644a \u7ed9\u6240\u6709\u540c\u65f6\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u6b63\u786e\u5904\u7406\u4e86 ILP (Instruction-Level Parallelism)\u3002   - \u5f53\u5904\u7406\u5668\u56e0\u4e3a\u67d0\u6761\u6307\u4ee4\u672a\u6267\u884c\u5b8c\u800c\u5361\u4f4f\u65f6\uff08Stalled state\uff09\uff0cTIP \u4f1a\u5c06\u65f6\u95f4\u5168\u90e8\u5f52\u56e0\u4e8e ROB \u5934\u90e8 \u7684\u90a3\u6761\u6307\u4ee4\u3002   - \u5f53\u53d1\u751f pipeline flush \u6216 front-end drain \u5bfc\u81f4 ROB \u4e3a\u7a7a\u65f6\uff0cTIP \u4f1a\u5229\u7528\u4e00\u4e2a Offending Instruction Register (OIR) \u6765\u8bb0\u4f4f\u6700\u540e\u4e00\u4e2a\u63d0\u4ea4\u7684\u3001\u53ef\u80fd\u5bfc\u81f4\u95ee\u9898\u7684\u6307\u4ee4\uff08\u5982 mispredicted branch\uff09\uff0c\u5e76\u5c06\u7a7a\u95f2\u5468\u671f\u5f52\u56e0\u4e8e\u5b83\u3002 - \u8fd9\u4e2a\u8bbe\u8ba1\u7684\u5173\u952e\u5728\u4e8e\uff0cTIP \u901a\u8fc7\u5c11\u91cf\u989d\u5916\u7684\u786c\u4ef6\uff08\u4e3b\u8981\u662f OIR \u548c\u4e00\u4e9b\u72b6\u6001\u6807\u5fd7\u4f4d\uff09\uff0c\u5728\u6bcf\u6b21 PMU \u89e6\u53d1\u91c7\u6837\u65f6\uff0c\u90fd\u80fd\u6839\u636e\u5904\u7406\u5668\u5f53\u524d\u7684\u7cbe\u786e\u72b6\u6001\uff08\u8ba1\u7b97\u4e2d\u3001\u5361\u4f4f\u3001flush\u540e\u3001\u524d\u7aef\u505c\u987f\uff09\uff0c\u505a\u51fa\u4e0e Oracle \u4e00\u81f4\u7684\u5f52\u56e0\u51b3\u7b56\uff0c\u4ece\u800c\u5c06\u5e73\u5747\u9519\u8bef\u7387\u4ece NCI \u7684 9.3% \u5927\u5e45\u964d\u4f4e\u5230\u60ca\u4eba\u7684 1.6%\u3002</p> <p></p> <p>Figure 1: Instruction-level profle error of state-of-the-art profilers compared to our Time-Proportional Instruction Profiler(TIP).Existing profilers are inaccurate due to lack of ILP support and systematic latency misattribution.</p> <p>\u8fd9\u4e2a\u7cbe\u5ea6\u7684\u63d0\u5347\u4e0d\u662f\u7eb8\u4e0a\u8c08\u5175\u3002\u8bba\u6587\u7528 SPEC CPU2017 \u4e2d\u7684 Imagick \u505a\u6848\u4f8b\u7814\u7a76\uff1aNCI \u7684\u62a5\u544a\u8ba9\u4eba\u6478\u4e0d\u7740\u5934\u8111\uff0c\u800c TIP \u5219\u7cbe\u51c6\u5730\u6307\u51fa\u4e86\u7f6a\u9b41\u7978\u9996\u662f\u4e24\u6761\u4e0d\u5fc5\u8981\u7684 CSR (Control Status Register) \u64cd\u4f5c\u6307\u4ee4\uff0c\u5b83\u4eec\u9891\u7e41\u89e6\u53d1 pipeline flush\u3002\u5f00\u53d1\u8005\u636e\u6b64\u4f18\u5316\u540e\uff0c\u6027\u80fd\u76f4\u63a5\u63d0\u5347\u4e86 1.93\u00d7\uff0c\u5145\u5206\u8bc1\u660e\u4e86 TIP \u5728\u5b9e\u6218\u4e2d\u7684\u5de8\u5927\u4ef7\u503c\u3002</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/ELI5_notes/#1-oracle-profiler-eli5","title":"1. Oracle Profiler (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb</p> <ul> <li>\u4ee5\u524d\u7684\u6027\u80fd\u5206\u6790\u5668\uff08\u6bd4\u5982 Intel PEBS \u7684 NCI\u3001\u5916\u90e8\u8c03\u8bd5\u5668\u7684 LCI\uff0c\u6216\u8005\u8f6f\u4ef6\u4e2d\u65ad\u91c7\u6837\uff09\u5728\u7ed9\u6307\u4ee4\u201c\u7b97\u8d26\u201d\u65f6\uff0c\u903b\u8f91\u662f\u6df7\u4e71\u7684\u3002\u5b83\u4eec\u4e0d\u662f\u5728\u771f\u6b63\u51b3\u5b9a\u7a0b\u5e8f\u6162\u4e0b\u6765\u7684\u90a3\u4e2a\u65f6\u523b\u53bb\u8bb0\u5f55\uff0c\u800c\u662f\u5728\u4e00\u4e2a\u65b9\u4fbf\u4f46\u4e0d\u51c6\u786e\u7684\u70b9\uff08\u6bd4\u5982\u521a\u63d0\u4ea4\u5b8c\u6216\u5373\u5c06\u63d0\u4ea4\u65f6\uff09\u968f\u4fbf\u6293\u4e00\u4e2a\u6307\u4ee4\u6765\u80cc\u9505\u3002</li> <li>\u8fd9\u5bfc\u81f4\u4e86\u4e24\u79cd\u5178\u578b\u7684\u201c\u51a4\u5047\u9519\u6848\u201d\uff1a</li> <li>\u7cfb\u7edf\u6027\u8bef\u5224\uff1a\u6bd4\u5982\uff0c\u4e00\u4e2a\u5206\u652f\u9884\u6d4b\u9519\u4e86\uff0c\u5bfc\u81f4\u6574\u4e2a\u6d41\u6c34\u7ebf\u88ab\u51b2\u5237\uff08flush\uff09\uff0c\u540e\u9762\u51e0\u5341\u4e2a\u5468\u671f\u90fd\u5728\u7a7a\u8f6c\u7b49\u65b0\u6307\u4ee4\u8fdb\u6765\u3002\u8fd9\u65f6\u5019\uff0cNCI \u4f1a\u628a\u8fd9\u51e0\u5341\u4e2a\u7a7a\u8f6c\u5468\u671f\u7684\u201c\u7f6a\u8d23\u201d\u7b97\u5230\u51b2\u5237\u540e\u7b2c\u4e00\u4e2a\u63d0\u4ea4\u7684\u65e0\u8f9c\u6307\u4ee4\u5934\u4e0a\uff0c\u800c\u771f\u6b63\u7684\u7f6a\u9b41\u7978\u9996\u2014\u2014\u90a3\u4e2a\u9519\u8bef\u7684\u5206\u652f\u2014\u2014\u53cd\u800c\u770b\u8d77\u6765\u6ca1\u82b1\u4ec0\u4e48\u65f6\u95f4\u3002</li> <li>\u5ffd\u7565\u5e76\u884c\u6027 (ILP)\uff1a\u73b0\u4ee3\u5904\u7406\u5668\u4e00\u4e2a\u5468\u671f\u80fd\u63d0\u4ea4\u597d\u51e0\u6761\u6307\u4ee4\u3002\u65e7\u65b9\u6cd5\u53ea\u4f1a\u6311\u5176\u4e2d\u4e00\u6761\uff08\u6bd4\u5982\u4e0b\u4e00\u6761\u8981\u63d0\u4ea4\u7684\uff09\u6765\u4ee3\u8868\u6574\u4e2a\u5468\u671f\uff0c\u8fd9\u5c31\u8ba9\u5176\u4ed6\u540c\u65f6\u63d0\u4ea4\u7684\u6307\u4ee4\u201c\u767d\u5e72\u4e86\u201d\uff0c\u5b83\u4eec\u5bf9\u6027\u80fd\u7684\u8d21\u732e\u5b8c\u5168\u6ca1\u88ab\u7edf\u8ba1\u5230\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9</p> <ul> <li>\u60f3\u8c61\u4f60\u5728\u7ba1\u7406\u4e00\u4e2a\u5feb\u9012\u5206\u62e3\u4e2d\u5fc3\uff08\u5904\u7406\u5668\uff09\u3002\u4f60\u7684\u76ee\u6807\u662f\u627e\u51fa\u54ea\u4e2a\u73af\u8282\u6700\u62d6\u540e\u817f\u3002</li> <li>\u65e7\u65b9\u6cd5\u5c31\u50cf\u8fd9\u6837\uff1a</li> <li>\u8f6f\u4ef6\u91c7\u6837\uff1a\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\uff0c\u4f60\u6d3e\u4e2a\u4eba\u53bb\u4ed3\u5e93\u95e8\u53e3\u770b\u4e00\u773c\uff0c\u8bb0\u4e0b\u4ed6\u770b\u5230\u7684\u7b2c\u4e00\u4e2a\u5305\u88f9\uff08\u6307\u4ee4\uff09\u7684\u5355\u53f7\u3002\u4f46\u8fd9\u4e2a\u5305\u88f9\u53ef\u80fd\u65e9\u5c31\u8be5\u5904\u7406\u5b8c\u4e86\uff0c\u53ea\u662f\u56e0\u4e3a\u524d\u9762\u5361\u4f4f\u4e86\u624d\u5806\u5728\u95e8\u53e3\uff0c\u5b83\u672c\u8eab\u6ca1\u95ee\u9898\u3002</li> <li>NCI/LCI\uff1a\u4f60\u53ea\u76ef\u7740\u4f20\u9001\u5e26\u672b\u7aef\u7684\u626b\u63cf\u4eea\u3002LCI \u8bb0\u5f55\u4e0a\u4e00\u4e2a\u626b\u8fc7\u7684\u5305\u88f9\uff0cNCI \u8bb0\u5f55\u4e0b\u4e00\u4e2a\u8981\u626b\u7684\u5305\u88f9\u3002\u4f46\u5982\u679c\u4f20\u9001\u5e26\u56e0\u4e3a\u4e0a\u6e38\u6545\u969c\u505c\u4e86\u534a\u5c0f\u65f6\uff0c\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u8bb0\u5f55\u7684\u5305\u88f9\u90fd\u548c\u8fd9\u534a\u5c0f\u65f6\u7684\u505c\u5de5\u6beb\u65e0\u5173\u7cfb\u3002</li> <li>Oracle Profiler\u7684\u505a\u6cd5\u5b8c\u5168\u4e0d\u540c\u3002\u5b83\u76f8\u5f53\u4e8e\u5728\u5206\u62e3\u4e2d\u5fc3\u7684\u6bcf\u4e2a\u5173\u952e\u8282\u70b9\uff08\u5c24\u5176\u662f\u51fa\u53e3\u95f8\u53e3\uff09\u90fd\u88c5\u4e86\u9ad8\u6e05\u6444\u50cf\u5934\uff0c\u5e76\u4e14\u6709\u4e00\u4e2a\u8d85\u7ea7\u806a\u660e\u7684\u4f1a\u8ba1\uff1a</li> <li>\u5f53\u4f20\u9001\u5e26\u6b63\u5e38\u8fd0\u8f6c\u65f6\uff08Computing State\uff09\uff0c\u5b83\u77e5\u9053\u8fd9\u4e00\u79d2\u67094\u4e2a\u5305\u88f9\u540c\u65f6\u901a\u8fc7\u95f8\u53e3\uff0c\u5c31\u7ed9\u6bcf\u4e2a\u5305\u88f9\u7684\u8d26\u672c\u4e0a\u7cbe\u786e\u8bb0\u4e0a0.25\u79d2\u7684\u5de5\u4f5c\u91cf\u3002</li> <li>\u5f53\u4f20\u9001\u5e26\u5361\u4f4f\u65f6\uff08Stalled State\uff09\uff0c\u5b83\u7acb\u523b\u9501\u5b9a\u5361\u5728\u95f8\u53e3\u6700\u524d\u9762\u7684\u90a3\u4e2a\u5305\u88f9\uff08\u6bd4\u5982\u4e00\u4e2a\u9700\u8981\u7279\u6b8a\u5f00\u7bb1\u68c0\u67e5\u7684\u5927\u4ef6\uff09\uff0c\u628a\u6240\u6709\u7b49\u5f85\u65f6\u95f4\u90fd\u8bb0\u5728\u8fd9\u4e2a\u5305\u88f9\u5934\u4e0a\u3002</li> <li>\u5f53\u56e0\u4e3a\u5730\u5740\u5199\u9519\u5bfc\u81f4\u4e00\u6279\u5305\u88f9\u5168\u88ab\u9000\u56de\u91cd\u53d1\u65f6\uff08Flushed State\uff09\uff0c\u5b83\u4e0d\u4f1a\u53bb\u602a\u91cd\u65b0\u53d1\u6765\u7684\u7b2c\u4e00\u4e2a\u65b0\u5305\u88f9\uff0c\u800c\u662f\u7cbe\u51c6\u5730\u627e\u5230\u90a3\u4e2a\u5199\u9519\u5730\u5740\u7684\u539f\u59cb\u8ba2\u5355\uff0c\u5e76\u628a\u6240\u6709\u6e05\u7a7a\u4f20\u9001\u5e26\u548c\u7b49\u5f85\u91cd\u53d1\u7684\u65f6\u95f4\u90fd\u7b97\u5728\u5b83\u5934\u4e0a\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db</p> <ul> <li>\u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u53bb\u6539\u8fdb\u73b0\u6709\u7684\u91c7\u6837\u786c\u4ef6\uff0c\u800c\u662f\u5148\u6784\u5efa\u4e86\u4e00\u4e2a\u7406\u8bba\u4e0a\u5b8c\u7f8e\u7684\u201c\u9ec4\u91d1\u6807\u51c6\u201d\u2014\u2014Oracle Profiler\u3002\u5b83\u7684\u6838\u5fc3\u601d\u60f3\u662f \u201c\u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0\u201d (time-proportional attribution)\uff1a\u6bcf\u4e00\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u90fd\u5fc5\u987b\u4e14\u53ea\u80fd\u5f52\u56e0\u4e8e\u5f53\u524d\u8ba9\u5904\u7406\u5668\u201c\u66b4\u9732\u5ef6\u8fdf\u201d\u7684\u90a3\u6761\uff08\u6216\u90a3\u4e9b\uff09\u6307\u4ee4\u3002</li> <li>\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0cOracle \u5c06\u5904\u7406\u5668\u7684\u63d0\u4ea4\u9636\u6bb5\uff08Commit Stage\uff09\u62bd\u8c61\u4e3a\u56db\u79cd\u57fa\u672c\u72b6\u6001\uff0c\u5e76\u4e3a\u6bcf\u79cd\u72b6\u6001\u5b9a\u4e49\u4e86\u7cbe\u786e\u7684\u5f52\u56e0\u89c4\u5219\uff1a</li> <li>State 1: Computing\uff1a\u5982\u679c\u6709 <code>n</code> \u6761\u6307\u4ee4\u63d0\u4ea4\uff0c\u5219\u6bcf\u6761\u6307\u4ee4\u5206\u644a <code>1/n</code> \u4e2a\u5468\u671f\u3002</li> <li>State 2: Stalled\uff1a\u5982\u679cROB\u975e\u7a7a\u4f46\u65e0\u6cd5\u63d0\u4ea4\uff0c\u5219\u5c06\u6574\u4e2a\u5468\u671f\u5f52\u56e0\u4e8eROB\u961f\u9996\u90a3\u6761\u5c1a\u672a\u6267\u884c\u5b8c\u7684\u6307\u4ee4\u3002</li> <li>State 3: Flushed\uff1a\u5982\u679cROB\u56e0\u9519\u8bef\u9884\u6d4b\u7b49\u539f\u56e0\u88ab\u6e05\u7a7a\uff0c\u5219\u5c06\u7a7a\u8f6c\u5468\u671f\u5f52\u56e0\u4e8e\u5f15\u53d1\u51b2\u5237\u7684\u90a3\u6761\u6307\u4ee4\uff08\u5982\u9519\u8bef\u7684\u5206\u652f\uff09\u3002</li> <li>State 4: Drained\uff1a\u5982\u679cROB\u56e0\u524d\u7aef\uff08\u5982\u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u4f9b\u4e0d\u4e0a\u8d27\u800c\u53d8\u7a7a\uff0c\u5219\u5c06\u7a7a\u8f6c\u5468\u671f\u5f52\u56e0\u4e8e\u7b2c\u4e00\u4e2a\u56e0\u524d\u7aef\u963b\u585e\u800c\u672a\u80fd\u53ca\u65f6\u8fdb\u5165ROB\u7684\u6307\u4ee4\u3002</li> <li>\u6b63\u662f\u8fd9\u5957\u57fa\u4e8e\u63d0\u4ea4\u9636\u6bb5\u72b6\u6001\u673a\u7684\u3001\u8986\u76d6\u6240\u6709\u53ef\u80fd\u573a\u666f\u7684\u3001\u65e0\u6b67\u4e49\u7684\u5f52\u56e0\u903b\u8f91\uff0c\u4f7f\u5f97 Oracle \u6210\u4e3a\u4e86\u8861\u91cf\u5176\u4ed6\u6240\u6709\u5b9e\u9645\u6027\u80fd\u5206\u6790\u5668\u51c6\u786e\u6027\u7684\u9ec4\u91d1\u53c2\u8003\u3002\u5b83\u63ed\u793a\u4e86\u73b0\u6709\u65b9\u6cd5\u7684\u6839\u672c\u7f3a\u9677\u2014\u2014\u5b83\u4eec\u90fd\u6ca1\u6709\u9075\u5faa\u8fd9\u79cd\u4e25\u683c\u7684\u65f6\u95f4\u6bd4\u4f8b\u539f\u5219\u3002</li> </ul> <p></p> <p>Figure 3: Oracle profiler clock cycle attribution overview.</p> <p></p> <p>Figure4:Exampleillustrating theOracle,NC1,andLCIprofilersona2-wideout-of-orderprocessor.NCIandLCIfallhortbeuse they do not account for ILPat the commit stage and misattribute pipeline stall,flush and/ordrain latencies.</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/ELI5_notes/#2-time-proportional-instruction-profiling-tip-eli5","title":"2. Time-Proportional Instruction Profiling (TIP) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684\u6027\u80fd\u5206\u6790\u5668\uff08Profiler\uff09\u5728\u73b0\u4ee3\u4e71\u5e8f\u6267\u884c\uff08Out-of-Order\uff09\u5904\u7406\u5668\u4e0a\u201c\u6307\u9e7f\u4e3a\u9a6c\u201d\u3002\u5b83\u4eec\u91c7\u6837\u7684\u6307\u4ee4\uff0c\u5f80\u5f80\u4e0d\u662f\u771f\u6b63\u5bfc\u81f4\u6027\u80fd\u74f6\u9888\u7684\u201c\u5143\u51f6\u201d\u3002 - \u8f6f\u4ef6\u7ea7 Profiler\uff08\u5982 Linux perf\uff09\u5b58\u5728\u4e25\u91cd\u7684 skid \u95ee\u9898\uff1a\u4e2d\u65ad\u53d1\u751f\u65f6\uff0c\u6d41\u6c34\u7ebf\u91cc\u6b63\u5728\u6267\u884c\u7684\u6307\u4ee4\u65e9\u5df2\u88ab\u51b2\u5237\u6389\uff0c\u91c7\u6837\u70b9\u843d\u5728\u4e86\u51e0\u5341\u751a\u81f3\u4e0a\u767e\u6761\u6307\u4ee4\u4e4b\u540e\uff0c\u5b8c\u5168\u5931\u771f\u3002 - \u786c\u4ef6\u7ea7 Profiler\uff08\u5982 Intel PEBS \u7684 NCI, AMD IBS \u7684 Dispatch-tagging\uff09\u867d\u7136\u89e3\u51b3\u4e86 skid\uff0c\u4f46\u5f52\u56e0\u903b\u8f91\u6709\u6839\u672c\u7f3a\u9677\uff1a   - NCI (Next-Committing Instruction)\uff1a\u5728\u6d41\u6c34\u7ebf\u51b2\u5237\uff08flush\uff09\u540e\uff0c\u5b83\u4f1a\u628a\u7a7a\u8f6c\u7684\u5468\u671f\u9519\u8bef\u5730\u5f52\u548e\u4e8e\u51b2\u5237\u540e\u7b2c\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u800c\u4e0d\u662f\u5f15\u53d1\u51b2\u5237\u7684\u90a3\u4e2a\u5206\u652f\u6307\u4ee4\u3002\u8fd9\u5c31\u50cf\u706b\u707e\u540e\uff0c\u628a\u635f\u5931\u7b97\u5728\u7b2c\u4e00\u4e2a\u8fdb\u706b\u573a\u7684\u6d88\u9632\u5458\u5934\u4e0a\uff0c\u800c\u4e0d\u662f\u7eb5\u706b\u72af\u3002   - Dispatch-tagging\uff1a\u5b83\u5728\u6307\u4ee4\u5206\u53d1\uff08Dispatch\uff09\u65f6\u5c31\u6253\u4e0a\u6807\u7b7e\uff0c\u4f46\u4e00\u4e2a\u6307\u4ee4\u5728\u540e\u7aef\u6267\u884c\u5355\u5143\u5361\u4f4f\u65f6\uff0c\u4f1a\u5bfc\u81f4\u524d\u7aef\u5206\u53d1\u505c\u987f\uff0c\u8ba9\u65e0\u8f9c\u7684\u3001\u521a\u5206\u53d1\u7684\u6307\u4ee4\u201c\u80cc\u9505\u201d\u3002   - \u5b83\u4eec\u90fd\u5ffd\u7565\u4e86 ILP (Instruction-Level Parallelism)\uff1a\u5f53\u591a\u4e2a\u6307\u4ee4\u5e76\u884c\u63d0\u4ea4\u65f6\uff0c\u5b83\u4eec\u53ea\u5f52\u56e0\u7ed9\u5176\u4e2d\u4e00\u4e2a\uff0c\u5bfc\u81f4 profile \u4e25\u91cd\u504f\u659c\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u5728\u7ba1\u7406\u4e00\u4e2a\u7e41\u5fd9\u7684\u5feb\u9012\u5206\u62e3\u4e2d\u5fc3\uff08\u5904\u7406\u5668\uff09\u3002\u4f60\u7684\u76ee\u6807\u662f\u627e\u51fa\u54ea\u4e2a\u5305\u88f9\uff08\u6307\u4ee4\uff09\u5bfc\u81f4\u4e86\u6574\u4e2a\u4e2d\u5fc3\u7684\u5ef6\u8bef\u3002 - \u65e7\u65b9\u6cd5\uff1a   - \u8f6f\u4ef6 Profiler \u5c31\u50cf\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\uff0c\u4f60\u968f\u4fbf\u6293\u4e00\u4e2a\u521a\u8fdb\u95e8\u7684\u5feb\u9012\u5458\u95ee\uff1a\u201c\u73b0\u5728\u6700\u5fd9\u7684\u662f\u8c01\uff1f\u201d \u5feb\u9012\u5458\u53ef\u80fd\u521a\u6765\uff0c\u5bf9\u79ef\u538b\u7684\u5305\u88f9\u4e00\u65e0\u6240\u77e5\u3002   - NCI \u5c31\u50cf\u4f60\u53ea\u8bb0\u5f55\u6bcf\u6b21\u4f20\u9001\u5e26\u542f\u52a8\u65f6\uff0c\u4e0a\u9762\u7684\u7b2c\u4e00\u4e2a\u5305\u88f9\u3002\u4f46\u5982\u679c\u4f20\u9001\u5e26\u662f\u56e0\u4e3a\u4e4b\u524d\u7684\u5371\u9669\u54c1\uff08\u9519\u8bef\u9884\u6d4b\u7684\u5206\u652f\uff09\u7206\u70b8\u800c\u505c\u6446\uff0c\u4f60\u5374\u628a\u505c\u6446\u65f6\u95f4\u7b97\u5728\u4e86\u91cd\u542f\u540e\u7b2c\u4e00\u4e2a\u666e\u901a\u5305\u88f9\u5934\u4e0a\u3002 - Oracle\uff08\u7406\u60f3\u53c2\u8003\uff09 \u5c31\u50cf\u4f60\u7ed9\u6bcf\u4e2a\u5305\u88f9\u90fd\u88c5\u4e86GPS\uff0c\u5e76\u4e14\u6709\u4e0a\u5e1d\u89c6\u89d2\uff0c\u80fd\u7cbe\u786e\u8bb0\u5f55\u6bcf\u4e00\u79d2\u4f20\u9001\u5e26\u7684\u505c\u6ede\u662f\u56e0\u4e3a\u54ea\u4e2a\u5305\u88f9\u5728\u5b89\u68c0\uff08\u6267\u884c\u5355\u5143\uff09\u5361\u4f4f\u4e86\uff0c\u6216\u8005\u662f\u56e0\u4e3a\u5165\u53e3\u5835\u4e86\uff08\u524d\u7aef\u505c\u987f\uff09\u3002\u4f46\u8fd9\u4f1a\u4ea7\u751f\u6d77\u91cf\u6570\u636e\uff0c\u6839\u672c\u4e0d\u73b0\u5b9e\u3002 - TIP \u7684\u505a\u6cd5\u662f\uff1a\u4f60\u4e0d\u9700\u8981\u8ffd\u8e2a\u6bcf\u4e2a\u5305\u88f9\uff0c\u800c\u662f\u806a\u660e\u5730\u5728\u5173\u952e\u51b3\u7b56\u70b9\uff08\u5305\u88f9\u79bb\u5f00\u5206\u62e3\u533a\uff0c\u5373 commit \u9636\u6bb5\uff09\u8bbe\u7f6e\u51e0\u4e2a\u667a\u80fd\u6444\u50cf\u5934\u3002\u8fd9\u4e9b\u6444\u50cf\u5934\u4e0d\u4ec5\u80fd\u62cd\u4e0b\u79bb\u5f00\u7684\u5305\u88f9\uff0c\u8fd8\u80fd\u6839\u636e\u4f20\u9001\u5e26\u7684\u72b6\u6001\uff08\u662f\u5426\u505c\u6ede\u3001\u662f\u5426\u521a\u7ecf\u5386\u7206\u70b8\u6e05\u7406\uff09\u6765\u63a8\u65ad\u521a\u624d\u90a3\u4e00\u79d2\u7684\u5ef6\u8bef\u5230\u5e95\u8be5\u7b97\u5728\u8c01\u5934\u4e0a\u3002\u5b83\u7528\u6781\u5c11\u7684\u5feb\u7167\uff0c\u8fd8\u539f\u4e86\u63a5\u8fd1\u4e0a\u5e1d\u89c6\u89d2\u7684\u771f\u76f8\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - TIP \u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e\uff0c\u5b83\u5c06 Oracle \u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565 \u7cbe\u5de7\u5730\u878d\u5165\u5230\u4e00\u4e2a\u57fa\u4e8e \u7edf\u8ba1\u91c7\u6837 \u7684\u786c\u4ef6\u5355\u5143\u4e2d\uff0c\u4f7f\u5176\u65e2\u5b9e\u7528\u53c8\u7cbe\u51c6\u3002 - \u5177\u4f53\u6765\u8bf4\uff0cTIP \u5728\u5904\u7406\u5668\u7684 ROB (Reorder Buffer) \u63d0\u4ea4\u9636\u6bb5\u505a\u6587\u7ae0\uff0c\u901a\u8fc7\u4e00\u4e2a\u540d\u4e3a OIR (Offending Instruction Register) \u7684\u5bc4\u5b58\u5668\u548c\u4e00\u5957\u72b6\u6001\u673a\uff0c\u5b9e\u73b0\u4e86\u5bf9\u56db\u79cd\u6838\u5fc3\u72b6\u6001\u7684\u7cbe\u51c6\u6355\u6349\uff1a   - Computing (\u8ba1\u7b97\u4e2d)\uff1a\u5f53\u591a\u4e2a\u6307\u4ee4\u5e76\u884c\u63d0\u4ea4\u65f6\uff0cTIP \u4e0d\u4f1a\u53ea\u9009\u4e00\u4e2a\uff0c\u800c\u662f\u5c06\u91c7\u6837\u5468\u671f \u5e73\u5747\u5206\u914d \u7ed9\u6240\u6709\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u6b63\u786e\u53cd\u6620\u4e86 ILP\u3002   - Stalled (\u505c\u6ede\u4e2d)\uff1a\u5f53 ROB \u5934\u90e8\u7684\u6307\u4ee4\u56e0\u672a\u6267\u884c\u5b8c\u800c\u963b\u585e\u63d0\u4ea4\u65f6\uff0cTIP \u4f1a\u5c06\u91c7\u6837\u5468\u671f\u5168\u90e8\u5f52\u56e0\u4e8e\u8fd9\u4e2a \u5934\u90e8\u6307\u4ee4\u3002   - Flushed (\u51b2\u5237\u540e)\uff1a\u5f53 ROB \u56e0\u9519\u8bef\u9884\u6d4b\u7b49\u539f\u56e0\u53d8\u7a7a\u65f6\uff0cTIP \u4f1a\u5229\u7528 OIR \u4e2d\u8bb0\u5f55\u7684 \u6700\u540e\u4e00\u4e2a\u63d0\u4ea4\u7684\u3001\u5bfc\u81f4\u51b2\u5237\u7684\u6307\u4ee4\uff08\u5982 mispredicted branch\uff09\u4f5c\u4e3a\u5f52\u56e0\u5bf9\u8c61\u3002   - Drained (\u6392\u7a7a\u540e)\uff1a\u5f53 ROB \u56e0\u524d\u7aef\u505c\u987f\uff08\u5982 i-cache miss\uff09\u800c\u53d8\u7a7a\u65f6\uff0cTIP \u4f1a\u5c06\u7a7a\u8f6c\u5468\u671f\u5f52\u56e0\u4e8e \u7b2c\u4e00\u4e2a\u91cd\u65b0\u8fdb\u5165 ROB \u7684\u6307\u4ee4\u3002 - </p> <p></p> <p>Figure 5: Structural overview of our Time-Proportional Instruction Profiler (TIP). TIP is triggered by the PMU,collects a sample,and finally exposes the sample to software.</p> <ul> <li>\u8fd9\u4e2a\u8bbe\u8ba1\u7684\u5173\u952e\u626d\u8f6c\u5728\u4e8e\uff1a\u5b83\u4e0d\u518d\u76f2\u76ee\u5730\u91c7\u6837\u201c\u4e0b\u4e00\u4e2a\u201d\u6216\u201c\u4e0a\u4e00\u4e2a\u201d\u6307\u4ee4\uff0c\u800c\u662f\u6839\u636e\u5904\u7406\u5668 commit stage \u7684\u5b9e\u65f6\u72b6\u6001\uff0c\u52a8\u6001\u5730\u3001\u539f\u5219\u6027\u5730\u51b3\u5b9a\u201c\u6b64\u523b\u7684\u5ef6\u8fdf\u5e94\u8be5\u7531\u8c01\u8d1f\u8d23\u201d\u3002\u5b83\u628a Oracle \u7684\u590d\u6742\u903b\u8f91\uff0c\u538b\u7f29\u6210\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u72b6\u6001\u5224\u65ad\u548c\u5bc4\u5b58\u5668\u8bfb\u53d6\u64cd\u4f5c\uff0c\u4ece\u800c\u5728\u4ec5 1.6% \u7684\u5e73\u5747\u6307\u4ee4\u7ea7\u8bef\u5dee\u4e0b\uff0c\u5b9e\u73b0\u4e86\u5de5\u7a0b\u4e0a\u7684\u53ef\u884c\u6027\u3002</li> </ul> <p>\u4e3a\u4e86\u76f4\u89c2\u611f\u53d7\u5176\u6548\u679c\uff0c\u770b\u770b\u5728 SPEC CPU2017 \u7684 Imagick \u57fa\u51c6\u6d4b\u8bd5\u4e2d\u7684\u8868\u73b0\uff1a - NCI \u7684 profile \u9519\u8bef\u5730\u5c06\u5927\u91cf\u65f6\u95f4\u5f52\u56e0\u4e8e <code>feq.d</code> \u548c <code>ret</code> \u6307\u4ee4\uff0c\u8ba9\u5f00\u53d1\u8005\u65e0\u4ece\u4e0b\u624b\u3002 - TIP \u5219\u7cbe\u51c6\u5730\u5b9a\u4f4d\u5230\u7f6a\u9b41\u7978\u9996\u662f <code>frflags</code> \u548c <code>fsflags</code> \u8fd9\u4e24\u4e2a\u63a7\u5236\u72b6\u6001\u5bc4\u5b58\u5668\uff08CSR\uff09\u7684\u6307\u4ee4\uff0c\u5b83\u4eec\u9891\u7e41\u89e6\u53d1 pipeline flush\u3002 - \u5f00\u53d1\u8005\u53ea\u9700\u5c06\u8fd9\u4e24\u4e2a\u4e0d\u5fc5\u8981\u7684 CSR \u64cd\u4f5c\u66ff\u6362\u4e3a <code>nop</code>\uff0c\u5c31\u83b7\u5f97\u4e86 1.93\u00d7 \u7684\u60ca\u4eba\u6027\u80fd\u63d0\u5347\u3002 - </p> <p></p> <p>Figure 12:Function and instruction-level profiles for lmagick for TIP and NCI compared to Oracle.</p> Profiler \u5e73\u5747\u6307\u4ee4\u7ea7\u8bef\u5dee \u6700\u5927\u8bef\u5dee \u76f8\u5bf9\u4e8e TIP \u7684\u8bef\u5dee\u500d\u6570 TIP 1.6% 5.0% 1.0x NCI (Intel PEBS) 9.3% 21.0% 5.8x LCI 55.4% - 34.6x Dispatch (AMD IBS) 53.1% - 33.2x Software 61.8% - 38.6x"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/ELI5_notes/#3-offending-instruction-register-oir-eli5","title":"3. Offending Instruction Register (OIR) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4f20\u7edf\u7684\u786c\u4ef6\u6027\u80fd\u5206\u6790\u5668\uff08\u5982 Intel PEBS \u7684 NCI\uff09\u5728\u5904\u7406\u5668\u6d41\u6c34\u7ebf flush\uff08\u51b2\u5237\uff09\u6216 drain\uff08\u6392\u7a7a\uff09\u540e\uff0cROB\uff08Reorder Buffer\uff09\u4f1a\u6682\u65f6\u53d8\u7a7a\u3002\u6b64\u65f6\uff0c\u5206\u6790\u5668\u9762\u4e34\u4e00\u4e2a\u68d8\u624b\u95ee\u9898\uff1a\u8fd9\u4e9b\u201c\u7a7a\u8f6c\u201d\u7684\u65f6\u949f\u5468\u671f\u5230\u5e95\u8be5\u7b97\u5728\u8c01\u5934\u4e0a\uff1f - \u5982\u679c\u7b80\u5355\u5730\u5c06\u8fd9\u4e9b\u5468\u671f\u5f52\u56e0\u4e8e\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\uff08NCI \u7684\u505a\u6cd5\uff09\uff0c\u5c31\u4f1a\u4ea7\u751f\u4e25\u91cd\u7684\u7cfb\u7edf\u6027\u8bef\u5224\u3002\u4f8b\u5982\uff0c\u5728\u5206\u652f\u9884\u6d4b\u9519\u8bef\u5bfc\u81f4 flush \u540e\uff0c\u771f\u6b63\u5e94\u8be5\u4e3a\u5ef6\u8fdf\u8d1f\u8d23\u7684\u662f\u90a3\u4e2a\u9884\u6d4b\u9519\u8bef\u7684\u5206\u652f\u6307\u4ee4\uff0c\u800c\u4e0d\u662f flush \u4e4b\u540e\u624d\u5f00\u59cb\u6267\u884c\u7684\u65b0\u6307\u4ee4\u3002\u8fd9\u4f1a\u8ba9\u5f00\u53d1\u8005\u5b8c\u5168\u627e\u9519\u4f18\u5316\u65b9\u5411\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4e00\u4e2a\u5de5\u5382\u7684\u88c5\u914d\u6d41\u6c34\u7ebf\uff08ROB\uff09\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u4ea7\u54c1\uff08\u6307\u4ee4\uff09\u4e00\u4e2a\u63a5\u4e00\u4e2a\u5730\u6d41\u8fc7\u5e76\u88ab\u6253\u5305\uff08\u63d0\u4ea4\uff09\u3002 - \u7a81\u7136\uff0c\u8d28\u68c0\u5458\u53d1\u73b0\u4e0a\u6e38\u9001\u6765\u4e86\u4e00\u6279\u6709\u7f3a\u9677\u7684\u96f6\u4ef6\uff08\u6bd4\u5982\u4e00\u4e2a mispredicted branch\uff09\uff0c\u5fc5\u987b\u7acb\u523b\u505c\u6389\u6574\u6761\u7ebf\uff0c\u6e05\u7a7a\u6240\u6709\u534a\u6210\u54c1\uff08flush\uff09\u3002 - \u5728\u6e05\u7406\u548c\u91cd\u65b0\u4e0a\u6599\u7684\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff0c\u6d41\u6c34\u7ebf\u662f\u7a7a\u7684\uff0c\u4f46\u5de5\u5382\u5374\u5728\u767d\u767d\u70e7\u94b1\uff08\u6d88\u8017\u65f6\u949f\u5468\u671f\uff09\u3002 - OIR \u7684\u4f5c\u7528\uff0c\u5c31\u50cf\u662f\u4e00\u4e2a\u5c3d\u804c\u7684\u201c\u4e8b\u6545\u8bb0\u5f55\u5458\u201d\u3002\u4ed6\u5728\u8d28\u68c0\u5458\u558a\u505c\u7684\u77ac\u95f4\uff0c\u7acb\u523b\u8bb0\u4e0b\uff1a\u201c\u4e8b\u6545\u8d23\u4efb\u4eba\uff1a\u8d28\u68c0\u5458\u8001\u738b\uff08\u5373\u90a3\u4e2a\u5206\u652f\u6307\u4ee4\uff09\u201d\u3002\u8fd9\u6837\uff0c\u540e\u7eed\u8ba1\u7b97\u505c\u5de5\u635f\u5931\u65f6\uff0c\u5c31\u80fd\u51c6\u786e\u5730\u628a\u8d26\u7b97\u5230\u8001\u738b\u5934\u4e0a\uff0c\u800c\u4e0d\u662f\u7b97\u5728\u4e0b\u4e00\u4e2a\u65e0\u8f9c\u7684\u3001\u521a\u8fdb\u5382\u7684\u65b0\u5de5\u4eba\uff08\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\uff09\u8eab\u4e0a\u3002</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u5728 ROB \u4e3a\u7a7a\u65f6\u53bb\u201c\u731c\u6d4b\u201d\u8be5\u5f52\u548e\u4e8e\u8c01\uff0c\u800c\u662f\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u6781\u5176\u7cbe\u5de7\u7684\u786c\u4ef6\u5bc4\u5b58\u5668\u2014\u2014Offending Instruction Register (OIR)\uff0c\u6765\u4e3b\u52a8\u8ffd\u8e2a\u6f5c\u5728\u7684\u201c\u7f6a\u9b41\u7978\u9996\u201d\u3002 - \u5176\u6838\u5fc3\u903b\u8f91\u8f6c\u6362\u5728\u4e8e\uff1a     - \u6301\u7eed\u76d1\u63a7\uff1aOIR \u5e76\u975e\u53ea\u5728\u9700\u8981\u65f6\u624d\u5de5\u4f5c\uff0c\u800c\u662f\u5728\u6bcf\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u9ed8\u9ed8\u5730\u66f4\u65b0\u81ea\u5df1\u3002         - \u5728\u6b63\u5e38\u63d0\u4ea4\u65f6\uff0c\u5b83\u4f1a\u8bb0\u5f55\u4e0b\u6700\u65b0\u63d0\u4ea4\u7684\u90a3\u6279\u6307\u4ee4\u4e2d\u6700\u5e74\u8f7b\u7684\u4e00\u4e2a\u53ca\u5176\u5173\u952e\u6807\u5fd7\u4f4d\uff08\u6bd4\u5982\u662f\u5426\u662f mispredicted branch\uff09\u3002         - \u5728\u68c0\u6d4b\u5230\u5373\u5c06\u53d1\u751f\u5f02\u5e38\uff08exception\uff09\u65f6\uff0c\u5b83\u4f1a\u7acb\u523b\u6355\u83b7\u5f15\u53d1\u5f02\u5e38\u7684\u90a3\u4e2a\u6307\u4ee4\u3002     - \u6309\u9700\u8c03\u7528\uff1a\u53ea\u6709\u5f53\u91c7\u6837\u65f6\u523b\u53d1\u73b0 ROB \u4e3a\u7a7a\uff08\u5373\u5904\u4e8e Flushed \u6216 Drained \u72b6\u6001\uff09\u65f6\uff0cTIP \u624d\u4f1a\u53bb\u8bfb\u53d6 OIR \u4e2d\u4fdd\u5b58\u7684\u4fe1\u606f\u3002         - \u5982\u679c OIR \u6807\u8bb0\u4e86 flush \u6216 exception\uff0c\u5c31\u5c06\u7a7a\u95f2\u5468\u671f\u5f52\u56e0\u4e8e OIR \u4e2d\u8bb0\u5f55\u7684\u90a3\u6761\u201c\u8087\u4e8b\u201d\u6307\u4ee4\u3002         - \u5982\u679c OIR \u6ca1\u6709\u8fd9\u4e9b\u6807\u8bb0\uff0c\u5219\u8bf4\u660e\u662f\u524d\u7aef\u4f9b\u6599\u4e0d\u8db3\uff08Drained\uff09\uff0c\u6b64\u65f6\u5c06\u5468\u671f\u5f52\u56e0\u4e8e OIR \u4e4b\u540e\u7b2c\u4e00\u4e2a\u88ab\u5206\u53d1\uff08dispatched\uff09\u7684\u6307\u4ee4\u3002 - \u8fd9\u4e2a\u8bbe\u8ba1\u7684\u5de7\u5999\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u7528\u4e00\u4e2a\u6781\u5c0f\u7684\u786c\u4ef6\u5f00\u9500\uff08\u8bba\u6587\u4e2d\u63d0\u5230\u4ec5 9B \u5b58\u50a8\uff09\uff0c\u901a\u8fc7\u524d\u77bb\u6027\u7684\u8bb0\u5f55\u800c\u975e\u4e8b\u540e\u7684\u63a8\u65ad\uff0c\u5b8c\u7f8e\u89e3\u51b3\u4e86 ROB \u7a7a\u7a97\u671f\u7684\u5f52\u56e0\u96be\u9898\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u4e0e Oracle \u9ec4\u91d1\u6807\u51c6\u4e00\u81f4\u7684\u65f6\u95f4-\u6bd4\u4f8b\u5f52\u56e0\u3002</p> <p></p> <p>Figure 5: Structural overview of our Time-Proportional Instruction Profiler (TIP). TIP is triggered by the PMU,collects a sample,and finally exposes the sample to software.</p> <p></p> <p>Figure 6: TIP sample selection logic.TIP classifies samples based on the the core state, ROB-flags,and OIR-flags.</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/ELI5_notes/#4-instruction-level-parallelism-ilp-aware-attribution-eli5","title":"4. Instruction-Level Parallelism (ILP) Aware Attribution (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684\u786c\u4ef6\u6027\u80fd\u5206\u6790\u5668\uff08\u5982 Intel PEBS \u7684 NCI\uff09\u5728\u5904\u7406\u5668\u6bcf\u4e2a\u5468\u671f\u63d0\u4ea4\u591a\u6761\u6307\u4ee4\u65f6\uff0c\u53ea\u4f1a\u628a\u6574\u4e2a\u5468\u671f\u7684\u201c\u529f\u52b3\u201d\u6216\u201c\u7f6a\u8d23\u201d\u5f52\u4e8e\u5176\u4e2d\u4e00\u6761\u6307\u4ee4\uff08\u6bd4\u5982\u4e0b\u4e00\u6761\u8981\u63d0\u4ea4\u7684\u6307\u4ee4\uff09\u3002</li> <li>\u8fd9\u5728\u73b0\u4ee3 superscalar \u5904\u7406\u5668\u4e0a\u4f1a\u5f15\u53d1\u4e25\u91cd\u7684\u7cfb\u7edf\u6027\u504f\u5dee\u3002\u60f3\u8c61\u4e00\u4e2a\u5faa\u73af\u4f53\u91cc\u6709\u56db\u6761\u5b8c\u5168\u72ec\u7acb\u3001\u53ef\u4ee5\u5e76\u884c\u6267\u884c\u7684\u52a0\u6cd5\u6307\u4ee4\u3002\u5728\u4e00\u4e2a 4-wide \u7684\u5904\u7406\u5668\u4e0a\uff0c\u5b83\u4eec\u5f88\u53ef\u80fd\u5728\u4e00\u4e2a\u5468\u671f\u5185\u5168\u90e8\u63d0\u4ea4\u3002\u4f46 NCI \u53ea\u4f1a\u91c7\u6837\u5176\u4e2d\u4e00\u6761\uff0c\u5bfc\u81f4\u53e6\u5916\u4e09\u6761\u5728\u6027\u80fd\u753b\u50cf\u4e2d\u201c\u9690\u8eab\u201d\u4e86\uff0c\u6216\u8005\u8ba9\u88ab\u91c7\u6837\u7684\u90a3\u6761\u770b\u8d77\u6765\u6162\u4e86\u56db\u500d\u3002</li> <li>\u66f4\u7cdf\u7cd5\u7684\u662f\uff0c\u8fd9\u79cd\u504f\u5dee\u4e0d\u662f\u968f\u673a\u7684\uff0c\u800c\u662f\u7ed3\u6784\u6027\u7684\u3002\u5b83\u4f1a\u8ba9\u5f00\u53d1\u8005\u8bef\u5224\u70ed\u70b9\u4ee3\u7801\uff0c\u628a\u4f18\u5316\u7cbe\u529b\u7528\u5728\u9519\u8bef\u7684\u5730\u65b9\uff0c\u751a\u81f3\u5f97\u51fa\u5b8c\u5168\u76f8\u53cd\u7684\u7ed3\u8bba\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u8fd9\u5c31\u50cf\u4e00\u4e2a\u56db\u4eba\u5212\u8239\u961f\uff0c\u5927\u5bb6\u9f50\u5fc3\u534f\u529b\uff0c\u4e00\u6868\u4e0b\u53bb\u8239\u5c31\u524d\u8fdb\u4e86\u4e00\u5927\u622a\u3002\u73b0\u5728\u6709\u4e2a\u6559\u7ec3\uff08\u6027\u80fd\u5206\u6790\u5668\uff09\u8981\u8bc4\u4f30\u8c01\u8d21\u732e\u6700\u5927\u3002</li> <li>\u8001\u6d3e\u6559\u7ec3\uff08NCI/LCI\uff09\u7684\u505a\u6cd5\u662f\uff1a\u6bcf\u6b21\u8239\u524d\u8fdb\uff0c\u4ed6\u53ea\u8bb0\u5f55\u7b2c\u4e00\u4e2a\u628a\u6868\u6536\u56de\u8239\u5185\u7684\u961f\u5458\u7684\u540d\u5b57\uff0c\u5e76\u628a\u8fd9\u6b21\u524d\u8fdb\u7684\u5168\u90e8\u529f\u52b3\u90fd\u7b97\u5728\u4ed6\u5934\u4e0a\u3002</li> <li>\u7ed3\u679c\u53ef\u60f3\u800c\u77e5\uff1a\u90a3\u4e2a\u603b\u662f\u7b2c\u4e00\u4e2a\u6536\u6868\u7684\u961f\u5458\uff08\u53ef\u80fd\u53ea\u662f\u52a8\u4f5c\u5feb\u4e00\u70b9\uff09\u88ab\u8bc4\u4e3a\u4e86 MVP\uff0c\u800c\u5176\u4ed6\u4e09\u4e2a\u540c\u6837\u5356\u529b\u7684\u961f\u5458\u5374\u88ab\u5ffd\u7565\u4e86\u3002\u6574\u4e2a\u56e2\u961f\u7684\u771f\u5b9e\u534f\u4f5c\u6548\u7387\u5b8c\u5168\u65e0\u6cd5\u4f53\u73b0\u3002</li> <li>TIP \u7684\u505a\u6cd5\u5219\u662f\uff1a\u6559\u7ec3\u770b\u5230\u56db\u4e2a\u4eba\u540c\u65f6\u53d1\u529b\uff0c\u5c31\u628a\u8fd9\u6b21\u524d\u8fdb\u7684\u529f\u52b3\u5e73\u5747\u5206\u7ed9\u56db\u4e2a\u4eba\u3002\u8fd9\u6837\u6bcf\u4e2a\u4eba\u7684\u8d21\u732e\u624d\u771f\u5b9e\u3001\u516c\u5e73\u3002</li> </ul> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u5e76\u6ca1\u6709\u53d1\u660e\u65b0\u7684\u91c7\u6837\u786c\u4ef6\uff0c\u800c\u662f\u5de7\u5999\u5730\u626d\u8f6c\u4e86\u91c7\u6837\u6570\u636e\u7684\u89e3\u91ca\u903b\u8f91\u3002</li> <li>\u5728\u5904\u7406\u5668\u7684 commit stage\uff0c\u5f53\u4e00\u4e2a\u91c7\u6837\u4e8b\u4ef6\u53d1\u751f\u65f6\uff1a<ul> <li>\u5982\u679c\u5f53\u524d\u5468\u671f\u6709 <code>n</code> \u6761\u6307\u4ee4\u6b63\u5728\u63d0\u4ea4\uff08\u5373\u5904\u4e8e Computing state\uff09\uff0cTIP \u4e0d\u4f1a\u50cf NCI \u90a3\u6837\u53ea\u9009\u4e00\u4e2a\u201c\u4ee3\u8868\u201d\uff0c\u800c\u662f\u5c06\u8fd9\u4e2a\u91c7\u6837\u5468\u671f\u6240\u4ee3\u8868\u7684\u65f6\u95f4\u5e73\u5747\u62c6\u5206\u6210 <code>1/n</code>\uff0c\u5e76\u5206\u522b\u5f52\u5c5e\u7ed9\u8fd9 <code>n</code> \u6761\u6307\u4ee4\u3002</li> <li>\u5982\u679c\u5904\u7406\u5668\u56e0\u4e3a\u67d0\u6761\u6307\u4ee4\u672a\u6267\u884c\u5b8c\u800c\u5361\u4f4f\uff08Stalled state\uff09\uff0cTIP \u4f1a\u5c06\u65f6\u95f4\u5168\u90e8\u5f52\u5c5e\u7ed9 ROB\uff08Reorder Buffer\uff09\u961f\u5934\u7684\u90a3\u6761\u963b\u585e\u6307\u4ee4\u3002</li> </ul> </li> <li>\u8fd9\u4e2a\u770b\u4f3c\u7b80\u5355\u7684\u201c\u6309\u63d0\u4ea4\u6570\u91cf\u5747\u644a\u201d\u7684\u7b56\u7565\uff0c\u6b63\u662f\u5176\u80fd\u5b9e\u73b0 time-proportional attribution \u7684\u6838\u5fc3\u3002\u5b83\u5c0a\u91cd\u4e86 Instruction-Level Parallelism (ILP) \u7684\u4e8b\u5b9e\uff1a\u5e76\u884c\u5b8c\u6210\u7684\u5de5\u4f5c\uff0c\u5176\u8017\u65f6\u5c31\u5e94\u8be5\u7531\u6240\u6709\u53c2\u4e0e\u8005\u5171\u540c\u627f\u62c5\u3002</li> </ul> <p></p> <p>Figure4:Exampleillustrating theOracle,NC1,andLCIprofilersona2-wideout-of-orderprocessor.NCIandLCIfallhortbeuse they do not account for ILPat the commit stage and misattribute pipeline stall,flush and/ordrain latencies.</p> <p>\u8fd9\u5f20\u56fe\uff08Figure 4a\uff09\u6e05\u6670\u5730\u5c55\u793a\u4e86\u8fd9\u4e2a\u5173\u952e\u533a\u522b\u3002\u5728 Cycle 1\uff0c\u4e24\u6761\u6307\u4ee4 I1 \u548c I2 \u540c\u65f6\u63d0\u4ea4\u3002Oracle\uff08\u4ee5\u53ca TIP\uff09\u4f1a\u7ed9\u6bcf\u6761\u6307\u4ee4\u8bb0 0.5 cycles\u3002\u800c NCI \u548c LCI \u53ea\u4f1a\u628a 1 whole cycle \u5f52\u7ed9\u5176\u4e2d\u4e00\u6761\uff0c\u9020\u6210\u4e86\u660e\u663e\u7684\u5931\u771f\u3002\u6b63\u662f\u8fd9\u79cd\u5bf9 commit parallelism \u7684\u7cbe\u786e\u5904\u7406\uff0c\u8ba9 TIP \u7684\u6307\u4ee4\u7ea7\u753b\u50cf\u8bef\u5dee\uff081.6%\uff09\u8fdc\u4f4e\u4e8e NCI\uff089.3%\uff09\u3002</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/ELI5_notes/#5-four-state-commit-stage-model-eli5","title":"5. Four-State Commit Stage Model (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <ul> <li>\u4f20\u7edf\u7684\u786c\u4ef6\u6027\u80fd\u5206\u6790\u5668\uff08\u5982 Intel PEBS \u7684 NCI \u6216\u5916\u90e8\u8c03\u8bd5\u5668\u7684 LCI\uff09\u5728\u5f52\u56e0\u6267\u884c\u65f6\u95f4\u65f6\uff0c\u903b\u8f91\u975e\u5e38\u201c\u7c97\u7cd9\u201d\u3002\u5b83\u4eec\u53ea\u770b\u4e00\u4e2a\u70b9\uff1a\u8981\u4e48\u662f\u201c\u4e0b\u4e00\u4e2a\u8981\u63d0\u4ea4\u7684\u6307\u4ee4\u201d\uff0c\u8981\u4e48\u662f\u201c\u4e0a\u4e00\u4e2a\u521a\u63d0\u4ea4\u7684\u6307\u4ee4\u201d\u3002</li> <li>\u8fd9\u79cd\u505a\u6cd5\u5728\u73b0\u4ee3\u4e71\u5e8f\u5904\u7406\u5668\u590d\u6742\u7684\u6267\u884c\u6d41\u9762\u524d\u4f1a\u5f7b\u5e95\u5931\u6548\u3002\u60f3\u8c61\u4e00\u4e0b\uff0c\u5f53\u5904\u7406\u5668\u56e0\u4e3a\u4e00\u4e2a cache miss \u800c\u5361\u4f4f\u65f6\uff0cNCI \u4f1a\u628a\u6240\u6709\u7b49\u5f85\u7684\u65f6\u95f4\u90fd\u7b97\u5230\u90a3\u4e2a\u65e0\u8f9c\u7684\u3001\u5373\u5c06\u63d0\u4ea4\u7684\u6307\u4ee4\u5934\u4e0a\uff1b\u800c LCI \u5219\u4f1a\u628a\u8fd9\u7b14\u8d26\u8bb0\u5728\u5f88\u4e45\u4ee5\u524d\u5c31\u63d0\u4ea4\u5b8c\u7684\u6307\u4ee4\u4e0a\u3002\u8fd9\u4e24\u79cd\u60c5\u51b5\u90fd\u5b8c\u5168\u6b6a\u66f2\u4e86\u6027\u80fd\u74f6\u9888\u7684\u771f\u5b9e\u6839\u6e90\u3002</li> <li>\u66f4\u7cdf\u7cd5\u7684\u662f\uff0c\u5f53\u591a\u4e2a\u6307\u4ee4\u5e76\u884c\u63d0\u4ea4\uff08ILP\uff09\u65f6\uff0c\u8fd9\u4e9b\u5206\u6790\u5668\u53ea\u4f1a\u968f\u673a\u6216\u56fa\u5b9a\u5730\u6311\u5176\u4e2d\u4e00\u4e2a\u6765\u201c\u80cc\u9505\u201d\uff0c\u5bfc\u81f4 profile \u7ed3\u679c\u5145\u6ee1\u7cfb\u7edf\u6027\u504f\u5dee\uff0c\u5f00\u53d1\u8005\u6839\u672c\u65e0\u6cd5\u4fe1\u4efb\u3002</li> </ul> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <ul> <li>\u60f3\u8c61\u4f60\u662f\u4e00\u4e2a\u5de5\u5382\u7684\u751f\u4ea7\u7ecf\u7406\uff0c\u9700\u8981\u641e\u6e05\u695a\u751f\u4ea7\u7ebf\u4e3a\u4ec0\u4e48\u6162\u3002\u65e7\u7684\u65b9\u6cd5\u5c31\u50cf\u662f\uff1a</li> <li>NCI\uff1a\u6bcf\u6b21\u770b\u8868\u65f6\uff0c\u5c31\u628a\u5f53\u524d\u65f6\u95f4\u7b97\u5728\u201c\u4e0b\u4e00\u4e2a\u8981\u4e0b\u7ebf\u7684\u4ea7\u54c1\u201d\u4e0a\u3002</li> <li>LCI\uff1a\u6bcf\u6b21\u770b\u8868\u65f6\uff0c\u5c31\u628a\u65f6\u95f4\u7b97\u5728\u201c\u4e0a\u4e00\u4e2a\u521a\u4e0b\u7ebf\u7684\u4ea7\u54c1\u201d\u4e0a\u3002</li> <li>\u663e\u7136\uff0c\u5982\u679c\u751f\u4ea7\u7ebf\u56e0\u4e3a\u7f3a\u5c11\u67d0\u4e2a\u5173\u952e\u87ba\u4e1d\uff08\u76f8\u5f53\u4e8e stall\uff09\u800c\u505c\u6446\u4e8610\u5206\u949f\uff0c\u8fd9\u4e24\u79cd\u65b9\u6cd5\u90fd\u4f1a\u628a\u8fd910\u5206\u949f\u9519\u8bef\u5730\u7b97\u5728\u67d0\u4e2a\u4e0d\u76f8\u5173\u7684\u4ea7\u54c1\u4e0a\u3002</li> <li>Oracle \u7684 Four-State Model \u5219\u50cf\u662f\u4e00\u4f4d\u62e5\u6709\u4e0a\u5e1d\u89c6\u89d2\u7684\u667a\u80fd\u76d1\u63a7\u7cfb\u7edf\u3002\u5b83\u4e0d\u53ea\u770b\u4ea7\u54c1\u4e0b\u7ebf\u7684\u77ac\u95f4\uff0c\u800c\u662f\u5b9e\u65f6\u76d1\u63a7\u6574\u4e2a\u751f\u4ea7\u7ebf\u7684\u72b6\u6001\uff1a</li> <li>\u8ba1\u7b97 (Computing)\uff1a\u673a\u5668\u6b63\u5728\u6b63\u5e38\u8fd0\u8f6c\uff0c\u4ea7\u54c1\u6e90\u6e90\u4e0d\u65ad\u4e0b\u7ebf \u2192 \u65f6\u95f4\u5e73\u5747\u5206\u7ed9\u8fd9\u6279\u4ea7\u54c1\u3002</li> <li>\u963b\u585e (Stalled)\uff1a\u751f\u4ea7\u7ebf\u5361\u4f4f\u4e86\uff0c\u7b2c\u4e00\u4e2a\u5f85\u52a0\u5de5\u7684\u4ea7\u54c1\u5835\u5728\u5165\u53e3 \u2192 \u6240\u6709\u7b49\u5f85\u65f6\u95f4\u90fd\u7b97\u5728\u8fd9\u4e2a\u201c\u5835\u738b\u201d\u5934\u4e0a\u3002</li> <li>\u51b2\u5237 (Flushed)\uff1a\u53d1\u73b0\u4e4b\u524d\u7684\u751f\u4ea7\u8ba1\u5212\u9519\u4e86\uff08\u6bd4\u5982\u7528\u9519\u4e86\u56fe\u7eb8\uff09\uff0c\u6574\u6761\u7ebf\u4e0a\u7684\u534a\u6210\u54c1\u90fd\u8981\u62a5\u5e9f\u91cd\u6765 \u2192 \u7b49\u5f85\u65b0\u56fe\u7eb8\u7684\u65f6\u95f4\uff0c\u5168\u90e8\u7b97\u5728\u90a3\u4e2a\u505a\u9519\u51b3\u7b56\u7684\u201c\u9519\u8bef\u6307\u4ee4\u201d\u4e0a\u3002</li> <li>\u6392\u7a7a (Drained)\uff1a\u539f\u6750\u6599\u4ed3\u5e93\u7a7a\u4e86\uff0c\u751f\u4ea7\u7ebf\u81ea\u7136\u505c\u4e0b\u6765\u7b49\u8d27 \u2192 \u7b49\u5f85\u65f6\u95f4\u7b97\u5728\u90a3\u4e2a\u201c\u7b2c\u4e00\u4e2a\u56e0\u4e3a\u6ca1\u6599\u800c\u65e0\u6cd5\u5f00\u5de5\u201d\u7684\u4ea7\u54c1\u4e0a\u3002</li> <li>\u8fd9\u4e2a\u6a21\u578b\u786e\u4fdd\u4e86\u6bcf\u4e00\u5206\u4e00\u79d2\u7684\u201c\u505c\u5de5\u635f\u5931\u201d\u90fd\u80fd\u7cbe\u51c6\u5730\u8ffd\u6eaf\u5230\u771f\u6b63\u7684\u8d23\u4efb\u6e90\u5934\u3002</li> </ul> <p></p> <p>Figure 3: Oracle profiler clock cycle attribution overview.</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <ul> <li>\u4f5c\u8005\u6ca1\u6709\u53bb\u53d1\u660e\u4e00\u79cd\u5168\u65b0\u7684\u91c7\u6837\u786c\u4ef6\uff0c\u800c\u662f\u4e3a\u6027\u80fd\u5206\u6790\u5efa\u7acb\u4e86\u4e00\u5957\u4e25\u8c28\u3001\u5b8c\u5907\u4e14\u7b26\u5408\u5904\u7406\u5668\u5fae\u67b6\u6784\u539f\u7406\u7684\u5f52\u56e0\u903b\u8f91\u6846\u67b6\u3002\u8fd9\u4e2a\u6846\u67b6\u7684\u6838\u5fc3\u5c31\u662f\u5c06\u5904\u7406\u5668\u63d0\u4ea4\u9636\u6bb5\uff08Commit Stage\uff09\u7684\u77ac\u65f6\u72b6\u6001\uff0c\u4e25\u683c\u5212\u5206\u4e3a\u4e0a\u8ff0\u56db\u79cd\u4e92\u65a5\u4e14\u8986\u76d6\u6240\u6709\u53ef\u80fd\u6027\u7684\u72b6\u6001\u3002</li> <li>\u6700\u5173\u952e\u7684\u626d\u8f6c\u5728\u4e8e\uff0c\u5b83\u5c06\u201c\u65f6\u95f4\u5f52\u56e0\u201d\u7684\u7126\u70b9\u4ece\u201c\u5355\u4e2a\u6307\u4ee4\u201d\u8f6c\u79fb\u5230\u4e86\u201c\u5904\u7406\u5668\u7684\u5168\u5c40\u72b6\u6001\u201d\u3002\u5177\u4f53\u6765\u8bf4\uff1a</li> <li>\u5728 Computing \u72b6\u6001\uff0c\u5b83\u901a\u8fc7\u5747\u5206\u65f6\u95f4\u7ed9\u6240\u6709\u5e76\u884c\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u5b8c\u7f8e\u89e3\u51b3\u4e86 ILP \u5f52\u56e0\u95ee\u9898\u3002</li> <li>\u5728 Stalled \u72b6\u6001\uff0c\u5b83\u76f4\u63a5\u9501\u5b9a ROB (Reorder Buffer) \u5934\u90e8\u7684\u6307\u4ee4\u4f5c\u4e3a\u7f6a\u9b41\u7978\u9996\uff0c\u56e0\u4e3a\u6b63\u662f\u5b83\u65e0\u6cd5\u5b8c\u6210\u624d\u6321\u4f4f\u4e86\u6574\u4e2a\u6d41\u6c34\u7ebf\u3002</li> <li>\u5728 Flushed/Drained \u72b6\u6001\uff08\u5373 ROB \u4e3a\u7a7a\u65f6\uff09\uff0c\u5b83\u6ca1\u6709\u653e\u5f03\uff0c\u800c\u662f\u5229\u7528\u4e00\u4e2a Offending Instruction Register (OIR) \u6765\u8bb0\u4f4f\u5bfc\u81f4 ROB \u6e05\u7a7a\u7684\u90a3\u4e2a\u201c\u5143\u51f6\u201d\u6307\u4ee4\uff08\u5982\u9519\u8bef\u9884\u6d4b\u7684\u5206\u652f\u6216\u89e6\u53d1\u7f3a\u9875\u5f02\u5e38\u7684\u6307\u4ee4\uff09\uff0c\u5e76\u5c06\u540e\u7eed\u7684\u7a7a\u8f6c\u65f6\u95f4\u5168\u90e8\u5f52\u4e8e\u5b83\u3002</li> <li>\u6b63\u662f\u8fd9\u5957\u57fa\u4e8e\u72b6\u6001\u673a\u7684\u3001\u539f\u5219\u6027\u7684\u5f52\u56e0\u7b56\u7565\uff0c\u4f7f\u5f97 Oracle \u6210\u4e3a\u4e86\u8861\u91cf\u6240\u6709\u5176\u4ed6 profiler \u51c6\u786e\u6027\u7684\u201c\u9ec4\u91d1\u6807\u51c6\u201d\uff0c\u4e5f\u4e3a TIP \u7684\u5b9e\u7528\u5316\u8bbe\u8ba1\u63d0\u4f9b\u4e86\u575a\u5b9e\u7684\u7406\u8bba\u57fa\u7840\u3002TIP \u672c\u8d28\u4e0a\u5c31\u662f\u5c06\u8fd9\u5957\u903b\u8f91\u7528\u7edf\u8ba1\u91c7\u6837\u7684\u65b9\u5f0f\u9ad8\u6548\u5730\u5b9e\u73b0\u51fa\u6765\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/","title":"TIP: Time-Proportional Instruction Profiling \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-1-instruction-level-profle-error-of-state-of-the-art-profilers-compared-to-our-time-proportional-instruction-profilertipexisting-profilers-are-inaccurate-due-to-lack-of-ilp-support-and-systematic-latency-misattribution","title":"Figure 1: Instruction-level profle error of state-of-the-art profilers compared to our Time-Proportional Instruction Profiler(TIP).Existing profilers are inaccurate due to lack of ILP support and systematic latency misattribution.","text":"<ul> <li>\u56fe\u7247\u5305\u542b\u4e24\u4e2a\u5e76\u5217\u7684\u67f1\u72b6\u56fe\uff0c\u5206\u522b\u6807\u8bb0\u4e3a (a) Average error \u548c (b) Imagick\uff0c\u7528\u4e8e\u5bf9\u6bd4\u4e0d\u540c\u6027\u80fd\u5206\u6790\u5668\u5728\u6307\u4ee4\u7ea7\u522b\u4e0a\u7684\u9519\u8bef\u7387\u3002</li> <li>\u4e24\u4e2a\u56fe\u8868\u5747\u4ee5\u201cError\u201d\u4e3a\u7eb5\u8f74\uff0c\u5355\u4f4d\u4e3a\u767e\u5206\u6bd4\uff08%\uff09\uff0c\u8303\u56f4\u4ece0%\u523060%\uff1b\u6a2a\u8f74\u5217\u51fa\u4e94\u79cd\u5206\u6790\u5668\uff1aSoftware\u3001Dispatch\u3001LCI\u3001NCI \u548c TIP\u3002</li> <li>\u56fe (a) Average error \u5c55\u793a\u4e86\u6240\u6709\u57fa\u51c6\u6d4b\u8bd5\u7684\u5e73\u5747\u9519\u8bef\u7387\uff1a</li> <li>Software \u5206\u6790\u5668\u9519\u8bef\u7387\u6700\u9ad8\uff0c\u7ea6\u4e3a 61.8%\u3002</li> <li>Dispatch \u5206\u6790\u5668\u9519\u8bef\u7387\u4e3a 53.1%\u3002</li> <li>LCI \u5206\u6790\u5668\u9519\u8bef\u7387\u4e3a 55.4%\u3002</li> <li>NCI \u5206\u6790\u5668\u9519\u8bef\u7387\u4e3a 9.3%\u3002</li> <li>TIP \u5206\u6790\u5668\u9519\u8bef\u7387\u6700\u4f4e\uff0c\u4ec5\u4e3a 1.6%\u3002</li> <li>\u56fe (b) Imagick \u5c55\u793a\u4e86 SPEC CPU2017 \u57fa\u51c6\u6d4b\u8bd5 Imagick \u7684\u7279\u5b9a\u9519\u8bef\u7387\uff1a</li> <li>Software \u9519\u8bef\u7387\u4ecd\u6700\u9ad8\uff0c\u63a5\u8fd1 60%\u3002</li> <li>Dispatch \u9519\u8bef\u7387\u7ea6\u4e3a 40%\u3002</li> <li>LCI \u9519\u8bef\u7387\u7ea6\u4e3a 35%\u3002</li> <li>NCI \u9519\u8bef\u7387\u7ea6\u4e3a 20%\u3002</li> <li>TIP \u9519\u8bef\u7387\u6781\u4f4e\uff0c\u51e0\u4e4e\u4e0d\u53ef\u89c1\uff0c\u7ea6\u4e3a 1.6%\u3002</li> <li>\u4ece\u6570\u636e\u53ef\u89c1\uff0cTIP \u5728\u5e73\u5747\u548c\u7279\u5b9a\u573a\u666f\u4e0b\u5747\u663e\u8457\u4f18\u4e8e\u73b0\u6709\u5206\u6790\u5668\uff0c\u5176\u9519\u8bef\u7387\u4ec5\u4e3a NCI \u7684\u7ea6\u516d\u5206\u4e4b\u4e00\u3002</li> <li>\u6240\u6709\u73b0\u6709\u5206\u6790\u5668\uff08Software\u3001Dispatch\u3001LCI\u3001NCI\uff09\u9519\u8bef\u7387\u8f83\u9ad8\uff0c\u4e3b\u8981\u5f52\u56e0\u4e8e \u7f3a\u4e4f ILP \u652f\u6301 \u548c \u7cfb\u7edf\u6027\u5ef6\u8fdf\u5f52\u56e0\u9519\u8bef\u3002</li> <li>TIP \u7684\u8bbe\u8ba1\u7ed3\u5408\u4e86 Oracle \u5206\u6790\u5668\u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\u4e0e\u7edf\u8ba1\u91c7\u6837\uff0c\u4ece\u800c\u5728\u4fdd\u6301\u9ad8\u7cbe\u5ea6\u7684\u540c\u65f6\u5b9e\u73b0\u5b9e\u9645\u90e8\u7f72\u53ef\u884c\u6027\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-2-lci-nci-and-tip-sample-instructions-at-commit-whereas-dispatchsoftware-samples-at-dispatchfetchdispatch-and-software-are-biased-because-i-different-instructions-spend-more-time-in-some-pipeline-stages-than-othersand-i-the-time-an-instruction-spends-at-the-head-ofthe-rob-directly-impacts-execution-time","title":"Figure 2: LCI, NCI and TIP sample instructions at commit whereas Dispatch(Software) samples at dispatch(fetch).Dispatch and Software are biased because (i) different instructions spend more time in some pipeline stages than others,and (i) the time an instruction spends at the head ofthe ROB directly impacts execution time.","text":"<ul> <li>\u56fe\u7247\u6807\u9898\u4e3a Figure 2\uff0c\u65e8\u5728\u5bf9\u6bd4\u4e0d\u540c\u6027\u80fd\u5206\u6790\u91c7\u6837\u7b56\u7565\u5728\u5904\u7406\u5668\u6d41\u6c34\u7ebf\u4e2d\u7684\u91c7\u6837\u4f4d\u7f6e\u53ca\u5176\u5e26\u6765\u7684\u504f\u5dee\u3002</li> <li>\u6838\u5fc3\u7ed3\u8bba\uff1aLCI\u3001NCI \u548c TIP \u5728 Commit \u9636\u6bb5\u91c7\u6837\uff0c\u800c Dispatch\uff08\u53ca Software\uff09\u5728 Dispatch \u6216 Fetch \u9636\u6bb5\u91c7\u6837\u3002\u540e\u8005\u56e0\u5ffd\u7565\u6307\u4ee4\u5728 ROB \u4e2d\u7684\u963b\u585e\u65f6\u95f4\uff0c\u5bfc\u81f4\u91c7\u6837\u504f\u5dee\u3002</li> <li>\u56fe (a) \u5c55\u793a\u4e86\u5178\u578b\u7684 Out-of-order \u67b6\u6784\u6d41\u7a0b\uff1a</li> <li>\u6307\u4ee4\u4ece Inst. Cache/TLB \u83b7\u53d6\uff0c\u7ecf Decode\u3001Register Rename \u540e\u8fdb\u5165 Dispatch\u3002</li> <li>Dispatch \u5c06\u6307\u4ee4\u5206\u53d1\u81f3 Issue Buffer\uff0c\u518d\u7531 Execution Units \u6267\u884c\u3002</li> <li>\u6700\u7ec8\u6307\u4ee4\u6309\u5e8f\u63d0\u4ea4\u81f3 Commit \u9636\u6bb5\uff0c\u540c\u65f6\u66f4\u65b0 ROB\u3002</li> <li>PMU \u53ef\u4ece LCI\u3001NCI\u3001TIP \u4e09\u79cd\u7b56\u7565\u4e2d\u9009\u62e9\u91c7\u6837\u70b9\u3002</li> <li>\u56fe (b) \u4e3e\u4f8b\u8bf4\u660e Dispatch \u91c7\u6837\u673a\u5236\uff1a</li> <li>Load \u6307\u4ee4\uff08I10\uff09\u56e0\u6570\u636e\u672a\u5c31\u7eea\uff0c\u5728 ROB \u5934\u90e8\u963b\u585e\uff08Stalled\uff09\uff0c\u5bfc\u81f4\u540e\u7eed\u6307\u4ee4\uff08\u5982 I18, I19\uff09\u65e0\u6cd5\u88ab\u8c03\u5ea6\u3002</li> <li>\u6b64\u65f6 Dispatch \u9636\u6bb5\u56e0\u80cc\u538b\u505c\u6ede\uff0cI10 \u88ab\u6301\u7eed\u91c7\u6837\u2014\u2014\u5c3d\u7ba1\u5b83\u5e76\u672a\u771f\u6b63\u201c\u6267\u884c\u201d\uff0c\u800c\u662f\u56e0\u7b49\u5f85\u8d44\u6e90\u88ab\u201c\u5361\u4f4f\u201d\u3002</li> <li>\u8fd9\u79cd\u91c7\u6837\u65b9\u5f0f\u9519\u8bef\u5730\u5c06\u5ef6\u8fdf\u5f52\u56e0\u4e8e I10\uff0c\u800c\u975e\u5176\u6839\u672c\u539f\u56e0\uff08Load \u4f9d\u8d56\uff09\u3002</li> <li>\u56fe (c) \u5c55\u793a Commit \u65f6\u95f4\u7ebf\uff1a</li> <li>\u6a2a\u8f74\u4e3a\u5468\u671f\uff08Cycles\uff09\uff0c\u7eb5\u8f74\u4e3a\u6307\u4ee4\u7f16\u53f7\u3002</li> <li>Load \u6307\u4ee4\uff08I10\uff09\u5728\u7b2c 3 \u5468\u671f\u624d\u5b8c\u6210\u6267\u884c\u5e76\u63d0\u4ea4\uff0c\u6b64\u524d\u5468\u671f\u5747\u5904\u4e8e\u963b\u585e\u72b6\u6001\u3002</li> <li>\u82e5\u5728 Commit \u9636\u6bb5\u91c7\u6837\uff0c\u5219 Load \u6307\u4ee4\u5c06\u5728\u591a\u4e2a\u5468\u671f\u5185\u88ab\u91c7\u6837\uff0c\u771f\u5b9e\u53cd\u6620\u5176\u5bf9\u6267\u884c\u65f6\u95f4\u7684\u5f71\u54cd\u3002</li> <li>\u82e5\u5728 Dispatch \u9636\u6bb5\u91c7\u6837\uff0c\u5219\u53ef\u80fd\u5728\u65e9\u671f\u5468\u671f\u91c7\u6837\u5230 I10\uff0c\u9020\u6210\u8bef\u5bfc\u6027\u5f52\u56e0\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e0d\u540c\u91c7\u6837\u7b56\u7565\u7684\u7279\u6027\uff1a</li> </ul> \u91c7\u6837\u7b56\u7565 \u91c7\u6837\u9636\u6bb5 \u662f\u5426\u65f6\u95f4\u6bd4\u4f8b \u4e3b\u8981\u504f\u5dee\u6765\u6e90 Software Fetch \u274c \u4e2d\u65ad\u5ef6\u8fdf + Skid\uff0c\u91c7\u6837\u8fdc\u79bb\u5b9e\u9645\u963b\u585e\u70b9 Dispatch Dispatch \u274c \u6307\u4ee4\u5728 Dispatch \u9636\u6bb5\u505c\u7559\u65f6\u95f4\u957f \u2260 \u5b9e\u9645\u6267\u884c\u8017\u65f6 LCI Commit \u274c \u4ec5\u91c7\u6837\u6700\u540e\u63d0\u4ea4\u6307\u4ee4\uff0c\u5ffd\u7565\u5e76\u884c\u63d0\u4ea4\u4e0e\u963b\u585e\u6307\u4ee4 NCI Commit \u274c \u91c7\u6837\u4e0b\u4e00\u63d0\u4ea4\u6307\u4ee4\uff0c\u8bef\u5c06\u963b\u585e\u5f52\u56e0\u4e8e\u540e\u7eed\u6307\u4ee4 TIP Commit \u2705 \u7cbe\u786e\u5f52\u56e0\u6bcf\u4e2a\u5468\u671f\u7ed9\u963b\u585e\u6216\u5e76\u884c\u63d0\u4ea4\u7684\u6307\u4ee4 <ul> <li>\u5173\u952e\u672f\u8bed\u4fdd\u7559\u82f1\u6587\uff1aROB\uff08Re-Order Buffer\uff09\u3001LCI\uff08Last Committed Instruction\uff09\u3001NCI\uff08Next Committing Instruction\uff09\u3001PMU\uff08Performance Monitoring Unit\uff09\u3001Dispatch\u3001Commit\u3002</li> <li>\u89c6\u89c9\u5f3a\u8c03\uff1a\u56fe\u4e2d\u7528\u6570\u5b57\u6807\u8bb0\u5173\u952e\u4e8b\u4ef6\uff08\u5982\u2460 Load \u63d0\u4ea4\u3001\u2461 I10 \u963b\u585e\u3001\u2462 Load \u5f00\u59cb\u6267\u884c\u3001\u2463 Load \u5b8c\u6210\u63d0\u4ea4\uff09\uff0c\u5f3a\u5316\u56e0\u679c\u5173\u7cfb\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u63ed\u793a\uff1a\u53ea\u6709\u5728 Commit \u9636\u6bb5\u91c7\u6837\uff0c\u5e76\u6b63\u786e\u5904\u7406 ILP \u4e0e\u963b\u585e\u5f52\u56e0\uff0c\u624d\u80fd\u5b9e\u73b0\u65f6\u95f4\u6bd4\u4f8b\uff08time-proportional\uff09\u7684\u6027\u80fd\u5206\u6790\u3002TIP \u6b63\u662f\u57fa\u4e8e\u6b64\u539f\u5219\u8bbe\u8ba1\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-3-oracle-profiler-clock-cycle-attribution-overview","title":"Figure 3: Oracle profiler clock cycle attribution overview.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Oracle Profiler \u5728\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u5185\u5982\u4f55\u5bf9\u5904\u7406\u5668\u72b6\u6001\u8fdb\u884c\u5206\u7c7b\u5e76\u5206\u914d\u65f6\u95f4\u7684\u903b\u8f91\u6d41\u7a0b\u56fe\uff0c\u5176\u6838\u5fc3\u662f\u57fa\u4e8e ROB (Reorder Buffer) \u7684\u72b6\u6001\u5224\u65ad\u3002</li> <li>\u6d41\u7a0b\u59cb\u4e8e\u201cEvery clock cycle\u201d\uff0c\u9996\u5148\u5224\u65ad\u201cOne or more instructions in the ROB?\u201d\uff1a</li> <li>\u82e5\u4e3a\u201cYes\u201d\uff0c\u5219\u8fdb\u5165\u4e0b\u4e00\u5224\u65ad\uff1a\u201cCommitting one or more instructions?\u201d\u3002<ul> <li>\u82e5\u4e3a\u201cYes\u201d\uff0c\u5219\u8fdb\u5165 State 1: Computing\u3002\u5728\u6b64\u72b6\u6001\u4e0b\uff0c\u8be5\u65f6\u949f\u5468\u671f\u7684\u65f6\u95f4\u88ab\u5e73\u5747\u5206\u914d\u7ed9\u6240\u6709\u6b63\u5728\u63d0\u4ea4\u7684\u6307\u4ee4\uff08\u5373 <code>1/n</code> \u5468\u671f\uff0c\u5176\u4e2d <code>n</code> \u4e3a\u63d0\u4ea4\u7684\u6307\u4ee4\u6570\uff09\u3002</li> <li>\u82e5\u4e3a\u201cNo\u201d\uff0c\u5219\u8fdb\u5165 State 2: Stalled\u3002\u5728\u6b64\u72b6\u6001\u4e0b\uff0c\u8be5\u65f6\u949f\u5468\u671f\u7684\u65f6\u95f4\u88ab\u5f52\u56e0\u4e8e\u963b\u585e\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u5373\u4f4d\u4e8e ROB \u5934\u90e8\u7684\u6307\u4ee4\u3002</li> </ul> </li> <li>\u82e5\u4e3a\u201cNo\u201d\uff0c\u5219\u8fdb\u5165\u4e0b\u4e00\u5224\u65ad\uff1a\u201cIs the ROB empty due to a flush?\u201d\u3002<ul> <li>\u82e5\u4e3a\u201cYes\u201d\uff0c\u5219\u8fdb\u5165 State 3: Flushed\u3002\u5728\u6b64\u72b6\u6001\u4e0b\uff0c\u8be5\u65f6\u949f\u5468\u671f\u7684\u65f6\u95f4\u88ab\u5f52\u56e0\u4e8e\u5bfc\u81f4\u6d41\u6c34\u7ebf\u51b2\u5237\u7684\u6307\u4ee4\uff08\u4f8b\u5982\uff0c\u9519\u8bef\u9884\u6d4b\u7684\u5206\u652f\u6307\u4ee4\uff09\u3002</li> <li>\u82e5\u4e3a\u201cNo\u201d\uff0c\u5219\u8fdb\u5165 State 4: Drained\u3002\u5728\u6b64\u72b6\u6001\u4e0b\uff0c\u8be5\u65f6\u949f\u5468\u671f\u7684\u65f6\u95f4\u88ab\u5f52\u56e0\u4e8e\u6e05\u7a7a ROB \u540e\u7b2c\u4e00\u4e2a\u8fdb\u5165 ROB \u7684\u6307\u4ee4\uff0c\u901a\u5e38\u662f\u7531\u4e8e\u524d\u7aef\u505c\u987f\uff08\u5982\u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u9020\u6210\u7684\u3002</li> </ul> </li> </ul> \u72b6\u6001 \u6761\u4ef6 \u65f6\u95f4\u5f52\u56e0\u5bf9\u8c61 State 1: Computing ROB \u975e\u7a7a\u4e14\u6b63\u5728\u63d0\u4ea4\u6307\u4ee4 \u5e73\u5747\u5206\u914d\u7ed9\u6240\u6709\u6b63\u5728\u63d0\u4ea4\u7684\u6307\u4ee4 (<code>1/n</code>) State 2: Stalled ROB \u975e\u7a7a\u4f46\u672a\u63d0\u4ea4\u6307\u4ee4 \u963b\u585e\u63d0\u4ea4\u7684\u6307\u4ee4\uff08ROB \u5934\u90e8\u6307\u4ee4\uff09 State 3: Flushed ROB \u4e3a\u7a7a\u4e14\u7531\u51b2\u5237\u5bfc\u81f4 \u5bfc\u81f4\u51b2\u5237\u7684\u6307\u4ee4\uff08\u5982\u9519\u8bef\u9884\u6d4b\u7684\u5206\u652f\uff09 State 4: Drained ROB \u4e3a\u7a7a\u4e14\u975e\u51b2\u5237\u5bfc\u81f4 \u6e05\u7a7a\u540e\u7b2c\u4e00\u4e2a\u8fdb\u5165 ROB \u7684\u6307\u4ee4 <ul> <li>\u8be5\u56fe\u6e05\u6670\u5730\u5b9a\u4e49\u4e86 Oracle Profiler \u7684\u56db\u4e2a\u57fa\u672c\u72b6\u6001\u53ca\u5176\u5bf9\u5e94\u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\uff0c\u786e\u4fdd\u4e86\u5176\u65f6\u95f4\u6bd4\u4f8b\u6027 (time-proportional)\uff0c\u5373\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u7cbe\u786e\u5730\u5f52\u56e0\u4e8e\u5f53\u524d\u5904\u7406\u5668\u5b9e\u9645\u66b4\u9732\u5ef6\u8fdf\u7684\u6307\u4ee4\u6216\u4e8b\u4ef6\u3002</li> <li>\u6b64\u8bbe\u8ba1\u662f Oracle Profiler \u80fd\u591f\u4f5c\u4e3a\u201c\u9ec4\u91d1\u6807\u51c6\u201d\u7684\u57fa\u7840\uff0c\u56e0\u4e3a\u5b83\u7cfb\u7edf\u6027\u5730\u89e3\u51b3\u4e86\u73b0\u6709\u5206\u6790\u5668\u5728\u5904\u7406 ILP\u3001\u6d41\u6c34\u7ebf\u505c\u987f\u3001\u51b2\u5237\u548c\u524d\u7aef\u8017\u5c3d\u7b49\u95ee\u9898\u4e0a\u7684\u5f52\u56e0\u9519\u8bef\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure4exampleillustrating-theoraclenc1andlciprofilersona2-wideout-of-orderprocessornciandlcifallhortbeuse-they-do-not-account-for-ilpat-the-commit-stage-and-misattribute-pipeline-stallflush-andordrain-latencies","title":"Figure4:Exampleillustrating theOracle,NC1,andLCIprofilersona2-wideout-of-orderprocessor.NCIandLCIfallhortbeuse they do not account for ILPat the commit stage and misattribute pipeline stall,flush and/ordrain latencies.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728 2-wide out-of-order processor \u4e0a\uff0cOracle\u3001NCI \u548c LCI \u4e09\u79cd\u6027\u80fd\u5206\u6790\u5668\u5728\u56db\u79cd\u6838\u5fc3\u72b6\u6001\u4e0b\u7684\u91c7\u6837\u884c\u4e3a\u5bf9\u6bd4\uff1a(a) Computing\u3001(b) Stalled\u3001(c) Flushed\u3001(d) Drained\u3002</li> <li>\u6bcf\u4e2a\u5b50\u56fe\u5305\u542b\u4e09\u90e8\u5206\uff1aROB state\uff08\u91cd\u6392\u5e8f\u7f13\u51b2\u533a\u72b6\u6001\u968f\u5468\u671f\u53d8\u5316\uff09\u3001Profile\uff08\u5404\u5206\u6790\u5668\u5bf9\u6307\u4ee4\u7684\u5468\u671f\u5f52\u56e0\u6570\u503c\uff09\u3001\u4ee5\u53ca\u7ea2\u8272\u6807\u6ce8\u7684\u9519\u8bef\u8bf4\u660e\u3002 (a) Computing \u72b6\u6001</li> <li>\u5904\u7406\u5668\u5728\u6bcf\u4e2a\u5468\u671f\u63d0\u4ea4\u4e24\u4e2a\u6307\u4ee4\uff08\u5982 I1/I2, I3/I4...\uff09\uff0c\u5904\u4e8e\u6b63\u5e38\u8ba1\u7b97\u72b6\u6001\u3002</li> <li>Oracle \u6b63\u786e\u5c06\u6bcf\u4e2a\u5468\u671f\u7684 1 \u4e2a\u65f6\u949f\u5468\u671f\u5e73\u5747\u5206\u914d\u7ed9\u4e24\u4e2a\u63d0\u4ea4\u6307\u4ee4\uff08\u5373\u6bcf\u4e2a\u6307\u4ee4 0.5 \u5468\u671f\uff09\u3002</li> <li>NCI \u4ec5\u8bb0\u5f55\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u6307\u4ee4\uff08\u5982\u5468\u671f1\u8bb0\u5f55 I2\uff09\uff0c\u5ffd\u7565\u53e6\u4e00\u4e2a\uff08I1\uff09\uff0c\u5bfc\u81f4 ILP \u672a\u88ab\u8ba1\u5165\u3002</li> <li>LCI \u4ec5\u8bb0\u5f55\u6700\u540e\u4e00\u4e2a\u63d0\u4ea4\u6307\u4ee4\uff08\u5982\u5468\u671f1\u8bb0\u5f55 I1\uff09\uff0c\u540c\u6837\u5ffd\u7565\u53e6\u4e00\u4e2a\uff08I2\uff09\uff0c\u4e5f\u5bfc\u81f4 ILP \u672a\u88ab\u8ba1\u5165\u3002</li> <li>\u8868\u683c\u603b\u7ed3\uff1a</li> </ul> Cycle Instruction Oracle NCI LCI Notes 1 I1 0.5 0 1 NCI \u5ffd\u7565 I1\uff1bLCI \u5ffd\u7565 I2 1 I2 0.5 1 0 2 I3 0.5 0 1 2 I4 0.5 1 0 (b) Stalled \u72b6\u6001 - \u5468\u671f2\u81f341\uff0c\u5904\u7406\u5668\u56e0 Load \u6307\u4ee4\u672a\u5b8c\u6210\u800c\u505c\u6ede\uff0c\u4ec5\u5728\u5468\u671f42\u6062\u590d\u63d0\u4ea4\u3002 - Oracle \u5c0640\u4e2a\u505c\u6ede\u5468\u671f\u5168\u90e8\u5f52\u56e0\u4e8e\u963b\u585e\u63d0\u4ea4\u7684 Load \u6307\u4ee4\uff0c\u5e76\u5728\u5468\u671f42\u5c060.5\u5468\u671f\u5f52\u56e0\u4e8e Load \u548c I3\u3002 - NCI \u5728\u5468\u671f42\u6b63\u786e\u5f52\u56e0\u4e8e I3\uff0c\u4f46\u5b8c\u5168\u5ffd\u7565 Load \u7684\u505c\u6ede\u8d21\u732e\uff08\u5f52\u56e00\uff09\uff0c\u672a\u80fd\u5904\u7406 ILP\u3002 - LCI \u9519\u8bef\u5730\u5c0641\u4e2a\u5468\u671f\u5f52\u56e0\u4e8e I1\uff08\u6700\u540e\u63d0\u4ea4\u6307\u4ee4\uff09\uff0c\u4ec5\u5728\u5468\u671f42\u5f52\u56e01\u5468\u671f\u7ed9 Load\uff0c\u9020\u6210\u4e25\u91cd Stall misattribution\u3002 - \u8868\u683c\u603b\u7ed3\uff1a Cycle Range Instruction Oracle NCI LCI Notes 2-41 Load 40.5 0 1 LCI \u4e25\u91cd\u9519\u8bef\u5f52\u56e0 42 Load 0.5 0 0 42 I3 0.5 1 0 NCI \u672a\u5904\u7406 ILP (c) Flushed \u72b6\u6001 - \u5206\u652f\u6307\u4ee4\u5728\u5468\u671f1\u63d0\u4ea4\u540e\u88ab\u53d1\u73b0\u9884\u6d4b\u9519\u8bef\uff0c\u5bfc\u81f4\u540e\u7eed\u6307\u4ee4\uff08I3/I4\uff09\u88ab\u6e05\u9664\uff08squashed\uff09\uff0c\u5904\u7406\u5668\u7a7a\u8f6c\u81f3\u5468\u671f6\u624d\u91cd\u65b0\u8c03\u5ea6\u65b0\u6307\u4ee4\u3002 - Oracle \u5c06\u5206\u652f\u6307\u4ee4\u5f52\u56e04.5\u5468\u671f\uff08\u542b\u5176\u81ea\u8eab0.5 + \u6e05\u9664\u671f\u95f44\u5468\u671f\uff09\uff0c\u5e76\u5f52\u56e01\u5468\u671f\u7ed9 I5\uff08\u9996\u6b21\u8c03\u5ea6\u6307\u4ee4\uff09\u3002 - NCI \u5b8c\u5168\u5ffd\u7565\u5206\u652f\u6307\u4ee4\uff08\u5f52\u56e00\uff09\uff0c\u5e76\u5c06\u6e05\u9664\u671f\u95f4\u76844\u5468\u671f\u5f52\u56e0\u4e8e I5\uff08\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u6307\u4ee4\uff09\uff0c\u9020\u6210 Flush misattribution\u3002 - LCI \u6b63\u786e\u5f52\u56e0\u5206\u652f\u6307\u4ee44.5\u5468\u671f\uff0c\u4f46\u5728\u5468\u671f6\u5f52\u56e05\u5468\u671f\u7ed9 I5\uff0c\u5b58\u5728\u8f7b\u5fae\u504f\u5dee\u3002 - \u8868\u683c\u603b\u7ed3\uff1a Cycle Instruction Oracle NCI LCI Notes 1 Branch 4.5 0 4.5 NCI \u5b8c\u5168\u5ffd\u7565\u5206\u652f 6 I5 1 5 5 NCI/LCI \u8fc7\u5ea6\u5f52\u56e0 (d) Drained \u72b6\u6001 - \u5468\u671f1\u63d0\u4ea4 I1/I2 \u540e\uff0c\u56e0\u6307\u4ee4\u7f13\u5b58\u7f3a\u5931\u5bfc\u81f4 ROB \u6392\u7a7a\uff0c\u76f4\u81f3\u5468\u671f42\u624d\u91cd\u65b0\u8c03\u5ea6 I3\u3002 - Oracle \u5f52\u56e00.5\u5468\u671f\u7ed9 I1/I2\uff0c41\u5468\u671f\u7ed9 I3\uff08\u542b\u6392\u7a7a40\u5468\u671f + \u963b\u585e1\u5468\u671f\uff09\u3002 - NCI \u6b63\u786e\u5f52\u56e0 I3 41\u5468\u671f\uff08\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u6307\u4ee4\uff09\uff0c\u8868\u73b0\u826f\u597d\u3002 - LCI \u9519\u8bef\u5f52\u56e0 I2 41\u5468\u671f\uff08\u6700\u540e\u63d0\u4ea4\u6307\u4ee4\uff09\uff0c\u5b8c\u5168\u5ffd\u7565 I3\uff0c\u9020\u6210 Drain misattribution\u3002 - \u8868\u683c\u603b\u7ed3\uff1a Cycle Instruction Oracle NCI LCI Notes 1 I1 0.5 0 1 LCI \u9519\u8bef\u5f52\u56e0\u7ed9 I2 1 I2 0.5 0 1 42 I3 41 41 0 LCI \u5b8c\u5168\u5ffd\u7565 I3 <ul> <li>\u603b\u4f53\u7ed3\u8bba\uff1aOracle \u662f\u552f\u4e00\u80fd\u51c6\u786e\u5f52\u56e0\u6240\u6709\u5468\u671f\u7684\u5206\u6790\u5668\uff0c\u56e0\u4e3a\u5b83\u8003\u8651\u4e86 ILP \u5e76\u6b63\u786e\u5904\u7406 Stall\u3001Flush \u548c Drain \u72b6\u6001\u3002NCI \u548c LCI \u56e0\u7f3a\u4e4f ILP \u652f\u6301\u548c\u7cfb\u7edf\u6027\u5f52\u56e0\u9519\u8bef\uff0c\u5bfc\u81f4\u663e\u8457\u8bef\u5dee\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-5-structural-overview-of-our-time-proportional-instruction-profiler-tip-tip-is-triggered-by-the-pmucollects-a-sampleand-finally-exposes-the-sample-to-software","title":"Figure 5: Structural overview of our Time-Proportional Instruction Profiler (TIP). TIP is triggered by the PMU,collects a sample,and finally exposes the sample to software.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Time-Proportional Instruction Profiler (TIP) \u7684\u7ed3\u6784\u6982\u89c8\uff0c\u5176\u6838\u5fc3\u529f\u80fd\u662f\u54cd\u5e94 PMU \u4e8b\u4ef6\u3001\u91c7\u96c6\u6837\u672c\u5e76\u6700\u7ec8\u5c06\u6837\u672c\u66b4\u9732\u7ed9\u8f6f\u4ef6\u5c42\u3002</li> <li>TIP \u4f4d\u4e8e PMU \u4e0e CPU \u7684 ROB (Reorder Buffer) \u4e4b\u95f4\uff0c\u901a\u8fc7\u7d27\u5bc6\u8026\u5408 ROB \u5b9e\u73b0\u7cbe\u786e\u7684\u6307\u4ee4\u7ea7\u65f6\u95f4\u5f52\u56e0\u3002</li> <li>PMU \u6a21\u5757\u5305\u542b\u4e24\u4e2a\u5173\u952e\u5bc4\u5b58\u5668\uff1aEvent \u548c Cycle\u3002\u5f53\u6ee1\u8db3\u91c7\u6837\u6761\u4ef6\u65f6\uff0cEvent \u89e6\u53d1 TIP \u5f00\u59cb\u5de5\u4f5c\uff0cCycle \u8bb0\u5f55\u5f53\u524d\u5468\u671f\u6570\u3002</li> <li>TIP \u6a21\u5757\u7531\u4e09\u4e2a\u4e3b\u8981\u90e8\u5206\u7ec4\u6210\uff1a</li> <li>OIR Update\uff1a\u8d1f\u8d23\u66f4\u65b0 Offending Instruction Register (OIR)\uff0c\u8bb0\u5f55\u53ef\u80fd\u5f15\u53d1\u6d41\u6c34\u7ebf\u5237\u65b0\u6216\u5f02\u5e38\u7684\u6307\u4ee4\u5730\u5740\u53ca\u6807\u5fd7\u3002</li> <li>OIR\uff1a\u5b58\u50a8\u6700\u8fd1\u63d0\u4ea4\u6216\u89e6\u53d1\u5f02\u5e38\u7684\u6307\u4ee4\u4fe1\u606f\uff0c\u7528\u4e8e\u5904\u7406 ROB \u4e3a\u7a7a\uff08Flushed \u6216 Drained \u72b6\u6001\uff09\u65f6\u7684\u5f52\u56e0\u3002</li> <li>Sample Selection\uff1a\u6839\u636e\u5f53\u524d\u5904\u7406\u5668\u72b6\u6001\u548c ROB \u5185\u5bb9\uff0c\u9009\u62e9\u6b63\u786e\u7684\u6307\u4ee4\u5730\u5740\u548c\u72b6\u6001\u6807\u5fd7\u8fdb\u884c\u91c7\u6837\u3002</li> <li>CPU \u90e8\u5206\u5c55\u793a\u4e86 ROB \u7684\u7ed3\u6784\uff0c\u5b83\u7531\u591a\u4e2a Bank \u7ec4\u6210\uff0c\u6bcf\u4e2a Bank \u53ef\u4ee5\u5b58\u50a8\u4e00\u6761\u6307\u4ee4\u3002\u56fe\u4e2d\u793a\u4f8b\u4e3a 3 \u4e2a Bank\uff0c\u5206\u522b\u5b58\u50a8\u4e86 Inst.0 \u5230 Inst.7\u3002</li> <li>ROB \u7684\u72b6\u6001\u7531 Bank Pointer \u548c Column Pointer \u5171\u540c\u7ba1\u7406\uff0c\u7528\u4e8e\u5b9a\u4f4d ROB \u4e2d\u6700\u8001\u7684\u6709\u6548\u6307\u4ee4\uff08\u5373 Head of ROB\uff09\u3002</li> <li>Sample Selection \u5355\u5143\u8f93\u51fa\u7684\u6837\u672c\u6570\u636e\u5b58\u50a8\u5728\u4e00\u7ec4 CSRs (Control Status Registers) \u4e2d\uff0c\u5305\u62ec\uff1a</li> <li>Cycle\uff1a\u8bb0\u5f55\u91c7\u6837\u53d1\u751f\u65f6\u7684\u5468\u671f\u6570\u3002</li> <li>Flags\uff1a\u8bb0\u5f55\u91c7\u6837\u65f6\u7684\u72b6\u6001\u6807\u5fd7\uff0c\u5982 Stalled, Frontend, Exception, Flush, Mispredicted \u7b49\u3002</li> <li>Addr. 0, Addr. 1, ..., Addr. i\uff1a\u5b58\u50a8\u88ab\u9009\u4e2d\u7684\u6307\u4ee4\u5730\u5740\uff0c\u6570\u91cf\u53d6\u51b3\u4e8e\u5904\u7406\u5668\u7684\u63d0\u4ea4\u5bbd\u5ea6\u3002</li> <li>TIP Registers \u8868\u683c\u8be6\u7ec6\u5217\u51fa\u4e86\u6240\u6709 CSR \u7684\u5185\u5bb9\u53ca\u5176\u542b\u4e49\uff1a</li> </ul> \u5bc4\u5b58\u5668\u540d\u79f0 \u542b\u4e49 Cycle \u91c7\u6837\u53d1\u751f\u7684\u5468\u671f\u6570 Flags \u72b6\u6001\u6807\u5fd7\u4f4d\u96c6\u5408 Addr. 0 \u7b2c\u4e00\u4e2a\u88ab\u9009\u4e2d\u7684\u6307\u4ee4\u5730\u5740 Addr. 1 \u7b2c\u4e8c\u4e2a\u88ab\u9009\u4e2d\u7684\u6307\u4ee4\u5730\u5740 ... ... Addr. i \u7b2c i \u4e2a\u88ab\u9009\u4e2d\u7684\u6307\u4ee4\u5730\u5740 <ul> <li>Valid \u6807\u5fd7\u4f4d\u6307\u793a\u5bf9\u5e94\u5730\u5740\u5bc4\u5b58\u5668\u4e2d\u7684\u6570\u636e\u662f\u5426\u6709\u6548\u3002</li> <li>Oldest ID \u6807\u5fd7\u4f4d\u6307\u793a\u54ea\u4e2a\u5730\u5740\u5bc4\u5b58\u5668\u5b58\u50a8\u7684\u662f ROB \u4e2d\u6700\u8001\u7684\u6307\u4ee4\u5730\u5740\u3002</li> <li>Stalled \u6807\u5fd7\u4f4d\u6307\u793a\u91c7\u6837\u65f6\u5904\u7406\u5668\u662f\u5426\u5904\u4e8e\u505c\u6ede\u72b6\u6001\u3002</li> <li>Frontend \u6807\u5fd7\u4f4d\u6307\u793a\u91c7\u6837\u65f6 ROB \u662f\u5426\u56e0\u524d\u7aef\u505c\u987f\u800c\u4e3a\u7a7a\u3002</li> <li>Exception \u6807\u5fd7\u4f4d\u6307\u793a\u91c7\u6837\u65f6\u662f\u5426\u53d1\u751f\u4e86\u5f02\u5e38\u3002</li> <li>Flush \u6807\u5fd7\u4f4d\u6307\u793a\u91c7\u6837\u65f6\u662f\u5426\u53d1\u751f\u4e86\u6d41\u6c34\u7ebf\u5237\u65b0\u3002</li> <li>Mispredicted \u6807\u5fd7\u4f4d\u6307\u793a\u91c7\u6837\u65f6\u662f\u5426\u53d1\u751f\u4e86\u5206\u652f\u9884\u6d4b\u9519\u8bef\u3002</li> <li>\u6574\u4e2a\u7cfb\u7edf\u7684\u5de5\u4f5c\u6d41\u7a0b\u662f\uff1aPMU \u89e6\u53d1\u91c7\u6837 -&gt; TIP \u6839\u636e ROB \u72b6\u6001\u548c OIR \u4fe1\u606f\u9009\u62e9\u6837\u672c -&gt; \u5c06\u6837\u672c\u5199\u5165 CSRs -&gt; \u8f6f\u4ef6\u901a\u8fc7\u8bfb\u53d6 CSRs \u83b7\u53d6\u6837\u672c\u6570\u636e\u3002</li> <li>\u8be5\u8bbe\u8ba1\u786e\u4fdd\u4e86 TIP \u80fd\u591f\u5b9e\u73b0 time-proportional attribution\uff0c\u5373\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u88ab\u51c6\u786e\u5f52\u56e0\u5230\u5bfc\u81f4\u8be5\u5468\u671f\u5ef6\u8fdf\u7684\u6307\u4ee4\u4e0a\uff0c\u4ece\u800c\u63d0\u4f9b\u9ad8\u7cbe\u5ea6\u7684\u6027\u80fd\u5206\u6790\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-6-tip-sample-selection-logictip-classifies-samples-based-on-the-the-core-state-rob-flagsand-oir-flags","title":"Figure 6: TIP sample selection logic.TIP classifies samples based on the the core state, ROB-flags,and OIR-flags.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 TIP sample selection logic \u7684\u8be6\u7ec6\u7535\u8def\u56fe\uff0c\u7528\u4e8e\u5728\u5904\u7406\u5668\u7684 ROB (Reorder Buffer) \u548c OIR (Offending Instruction Register) \u4e4b\u95f4\u8fdb\u884c\u91c7\u6837\u9009\u62e9\u3002</li> <li>\u8be5\u903b\u8f91\u7684\u6838\u5fc3\u529f\u80fd\u662f\u6839\u636e\u5f53\u524d\u6838\u5fc3\u72b6\u6001\u3001ROB \u6807\u5fd7\u548c OIR \u6807\u5fd7\u5bf9\u6837\u672c\u8fdb\u884c\u5206\u7c7b\uff0c\u5e76\u51b3\u5b9a\u6700\u7ec8\u8f93\u51fa\u7684\u5730\u5740\u548c\u6807\u5fd7\u4f4d\u3002</li> <li>\u8f93\u5165\u4fe1\u53f7\u5305\u62ec\u6765\u81ea ROB \u7684\u591a\u4e2a\u6761\u76ee\uff08Address, Valid, Commits\uff09\u4ee5\u53ca Bank Pointer\uff0c\u8fd8\u6709\u6765\u81ea OIR \u7684 Address\u3001Exception\u3001Flushes \u548c Mispredicted \u6807\u5fd7\u3002</li> <li>\u8f93\u51fa\u4fe1\u53f7\u5305\u62ec\u591a\u4e2a\u5730\u5740\u5bc4\u5b58\u5668\uff08Address 0 \u5230 Address i\uff09\u3001Oldest ID\u3001Valid \u4f4d\u3001Stalled/Frontend \u6807\u5fd7\u4ee5\u53ca Exception/Flush/Mispredicted \u6807\u5fd7\u3002</li> </ul> \u7ec4\u4ef6\u7f16\u53f7 \u529f\u80fd\u63cf\u8ff0 1 \u5730\u5740\u76f8\u5173\u5199\u4f7f\u80fd\u63a7\u5236\uff0c\u7528\u4e8e\u5c06 ROB \u4e2d\u7684\u5730\u5740\u5199\u5165\u5bf9\u5e94\u7684 Address CSR\u3002 2 Oldest ID \u5bc4\u5b58\u5668\uff0c\u8bb0\u5f55\u5f53\u524d ROB \u4e2d\u6700\u8001\u6307\u4ee4\u6240\u5728\u7684 Bank ID\u3002 3 \u591a\u8def\u9009\u62e9\u5668\u7f51\u7edc\uff0c\u7528\u4e8e\u5728\u4e0d\u540c\u72b6\u6001\u4e0b\u9009\u62e9\u6b63\u786e\u7684\u5730\u5740\u548c\u6709\u6548\u4f4d\u3002 4 Stalled \u548c Frontend \u6807\u5fd7\u751f\u6210\u903b\u8f91\uff0c\u6307\u793a\u5f53\u524d\u662f\u5426\u5904\u4e8e\u505c\u6ede\u6216\u524d\u7aef\u8017\u5c3d\u72b6\u6001\u3002 5 \u4e0e\u95e8\u9635\u5217\uff0c\u7528\u4e8e\u7ec4\u5408 ROB \u6761\u76ee\u7684\u6709\u6548\u6027\u548c\u63d0\u4ea4\u4fe1\u53f7\u3002 6 \u6700\u7ec8\u6709\u6548\u4f4d\u751f\u6210\u903b\u8f91\uff0c\u51b3\u5b9a\u54ea\u4e9b\u5730\u5740\u5bc4\u5b58\u5668\u5e94\u88ab\u6807\u8bb0\u4e3a\u6709\u6548\u3002 7 \u5f02\u6216\u95e8\u548c\u4e0e\u95e8\u7ec4\u5408\uff0c\u7528\u4e8e\u5904\u7406 OIR \u76f8\u5173\u7684\u5f02\u5e38\u3001\u51b2\u5237\u548c\u9884\u6d4b\u9519\u8bef\u6807\u5fd7\u3002 8 \u6807\u5fd7\u5199\u4f7f\u80fd\u63a7\u5236\uff0c\u7528\u4e8e\u66f4\u65b0 TIP \u7684\u72b6\u6001\u6807\u5fd7\u5bc4\u5b58\u5668\u3002 <ul> <li>\u5f53 ROB \u4e0d\u4e3a\u7a7a\u65f6\uff0cTIP \u4f1a\u590d\u5236\u5934\u90e8 ROB \u6761\u76ee\u7684\u5730\u5740\u5230\u5176\u5730\u5740\u5bc4\u5b58\u5668\u4e2d\uff0c\u5e76\u6839\u636e\u63d0\u4ea4\u548c\u6709\u6548\u4fe1\u53f7\u8bbe\u7f6e\u76f8\u5e94\u7684\u6709\u6548\u4f4d\u3002</li> <li>\u5982\u679c\u6240\u6709\u5934\u90e8 ROB \u6761\u76ee\u90fd\u65e0\u6548\uff0c\u5219 TIP \u4f1a\u4f7f\u7528 OIR \u4e2d\u7684\u5730\u5740\uff0c\u5e76\u8bbe\u7f6e\u76f8\u5e94\u7684\u5f02\u5e38\u3001\u51b2\u5237\u6216\u9884\u6d4b\u9519\u8bef\u6807\u5fd7\u3002</li> <li>\u5728 ROB \u8017\u5c3d\u7684\u60c5\u51b5\u4e0b\uff0cTIP \u4f1a\u7acb\u5373\u8bbe\u7f6e Frontend \u6807\u5fd7\uff0c\u5e76\u5728\u7b2c\u4e00\u4e2a\u6307\u4ee4\u8c03\u5ea6\u65f6\u5c06\u5176\u5730\u5740\u590d\u5236\u5230\u76f8\u5e94\u7684\u5730\u5740 CSR \u4e2d\u3002</li> <li>\u6574\u4e2a\u903b\u8f91\u8bbe\u8ba1\u786e\u4fdd\u4e86 TIP \u80fd\u591f\u51c6\u786e\u5730\u6839\u636e Oracle \u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\u8fdb\u884c\u91c7\u6837\uff0c\u540c\u65f6\u4fdd\u6301\u786c\u4ef6\u5f00\u9500\u6781\u4f4e\u3002</li> <li>\u5173\u952e\u8def\u5f84\u4e0d\u4f4d\u4e8e BOOM \u6838\u5fc3\u7684\u5173\u952e\u8def\u5f84\u4e0a\uff0c\u56e0\u6b64\u4e0d\u4f1a\u5f71\u54cd\u5904\u7406\u5668\u6027\u80fd\uff1b\u5982\u6709\u5fc5\u8981\uff0c\u53ef\u5bf9\u5176\u8fdb\u884c\u6d41\u6c34\u7ebf\u5316\u5904\u7406\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#table-1-simulated-configuration","title":"Table 1: Simulated Configuration.","text":"<ul> <li> <p>\u8be5\u56fe\u50cf\u4e3a\u8bba\u6587\u4e2d\u7684 Table 1: Simulated Configuration\uff0c\u8be6\u7ec6\u5217\u51fa\u4e86\u7528\u4e8e\u5b9e\u9a8c\u7684\u6a21\u62df\u5904\u7406\u5668\u67b6\u6784\u4e0e\u7cfb\u7edf\u914d\u7f6e\uff0c\u662f\u8bc4\u4f30 TIP \u4e0e Oracle \u7b49\u6027\u80fd\u5206\u6790\u5668\u51c6\u786e\u6027\u7684\u57fa\u7840\u73af\u5883\u3002</p> </li> <li> <p>\u6838\u5fc3\u914d\u7f6e\uff1a</p> </li> <li>Core: \u4f7f\u7528 OoO BOOM\uff08Berkeley Out-of-Order Machine\uff09\u6838\u5fc3\uff0c\u6307\u4ee4\u96c6\u4e3a RV64IMAFDCSUX\uff0c\u8fd0\u884c\u9891\u7387\u4e3a 3.2 GHz\u3002</li> <li>Front-end: \u524d\u7aef\u652f\u6301 8-wide fetch\uff0c\u914d\u5907 32-entry fetch buffer\u30014-wide decode\u300128 KB TAGE branch predictor\u300140-entry fetch target queue\uff0c\u6700\u591a\u652f\u6301 20 outstanding branches\u3002</li> <li>Execute: \u6267\u884c\u5355\u5143\u5305\u542b 128-entry ROB\u3001128 \u4e2a\u6574\u6570/\u6d6e\u70b9\u7269\u7406\u5bc4\u5b58\u5668\u300124-entry dual-issue MEM queue\u300140-entry 4-issue INT queue\u300132-entry dual-issue FP queue\uff0c\u4ee5\u53ca 32-entry load/store queue\u3002</li> <li>LSU: \u52a0\u8f7d\u5b58\u50a8\u5355\u5143\u914d\u7f6e\u4e3a 32 KB 8-way I-cache \u548c 32 KB 8-way D-cache\uff0c\u5747\u5e26 8 MSHRs\uff0c\u5e76\u542f\u7528 next-line prefetcher from L2\u3002</li> <li>L2/LLC: \u4e8c\u7ea7\u7f13\u5b58\u4e3a 512 KB 8-way\uff0c\u5e26 12 MSHRs\uff1b\u6700\u540e\u4e00\u7ea7\u7f13\u5b58\uff08LLC\uff09\u4e3a 4 MB 8-way\uff0c\u5e26 8 MSHRs\u3002</li> <li>TLB: \u91c7\u7528 Page Table Walker\uff0c32-entry fully-assoc L1 D-TLB\u300132-entry fully-assoc L1 I-TLB\u3001512-entry direct-mapped L2 TLB\u3002</li> <li>Memory: \u5185\u5b58\u5b50\u7cfb\u7edf\u4e3a 16 GB DDR3 FR-FCFS quad-rank\uff0c\u6700\u5927\u5e26\u5bbd 25.6 GB/s\uff0c\u65f6\u5e8f\u4e3a 14-14-14 (CAS-RCD-RP) @ 1 GHz\uff0c\u652f\u6301 8 queue depth \u548c 32 max reads/writes\u3002</li> <li> <p>OS: \u64cd\u4f5c\u7cfb\u7edf\u4e3a Buildroot, Linux 5.7.0\u3002</p> </li> <li> <p>\u8be5\u914d\u7f6e\u4ee3\u8868\u4e00\u4e2a\u5178\u578b\u7684\u73b0\u4ee3\u8d85\u6807\u91cf\u4e71\u5e8f\u6267\u884c\u5904\u7406\u5668\uff0c\u5177\u5907\u5b8c\u6574\u7684\u524d\u7aef\u3001\u6267\u884c\u3001\u7f13\u5b58\u548c\u5185\u5b58\u5b50\u7cfb\u7edf\uff0c\u786e\u4fdd\u4e86\u5b9e\u9a8c\u7ed3\u679c\u5728\u771f\u5b9e\u786c\u4ef6\u884c\u4e3a\u4e0a\u7684\u4ee3\u8868\u6027\u3002\u6240\u6709\u7ec4\u4ef6\u53c2\u6570\u5747\u7cbe\u786e\u8bbe\u5b9a\uff0c\u4ee5\u652f\u6301\u5bf9\u6027\u80fd\u5256\u6790\u5668\u5728\u4e0d\u540c\u573a\u666f\u4e0b\u7684\u8bef\u5dee\u91cf\u5316\u5206\u6790\u3002</p> </li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-7-normalized-cycle-stacks-collected-at-commit","title":"Figure 7: Normalized cycle stacks collected at commit.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728 commit \u9636\u6bb5\u6536\u96c6\u7684\u5f52\u4e00\u5316\u5468\u671f\u5806\u6808\uff08Normalized cycle stacks\uff09\uff0c\u7528\u4e8e\u5206\u6790\u4e0d\u540c\u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u6267\u884c\u65f6\u95f4\u5206\u5e03\u3002</li> <li>\u6bcf\u4e2a\u67f1\u72b6\u56fe\u4ee3\u8868\u4e00\u4e2a SPEC CPU2017 \u6216 PARSEC 3.0 \u57fa\u51c6\u6d4b\u8bd5\uff0c\u6309\u5176\u4e3b\u8981\u6027\u80fd\u74f6\u9888\u5206\u7c7b\u4e3a\u4e09\u7ec4\uff1aCompute\u3001Flush \u548c Stall\u3002</li> <li>\u5806\u6808\u4ece\u5e95\u90e8\u5230\u9876\u90e8\u4f9d\u6b21\u8868\u793a\u4e0d\u540c\u7c7b\u578b\u7684\u5468\u671f\u5f00\u9500\uff1a</li> <li>Execution\uff1a\u6307\u4ee4\u63d0\u4ea4\u9636\u6bb5\u7684\u6b63\u5e38\u6267\u884c\u5468\u671f\u3002</li> <li>ALU stall\uff1a\u7b97\u672f\u903b\u8f91\u5355\u5143\uff08ALU\uff09\u76f8\u5173\u505c\u987f\u3002</li> <li>Load stall\uff1a\u52a0\u8f7d\u6307\u4ee4\u5bfc\u81f4\u7684\u505c\u987f\uff08\u5982\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u3002</li> <li>Store stall\uff1a\u5b58\u50a8\u6307\u4ee4\u5bfc\u81f4\u7684\u505c\u987f\u3002</li> <li>Front-end\uff1a\u524d\u7aef\u505c\u987f\uff08\u5982\u6307\u4ee4\u7f13\u5b58\u6216 TLB \u672a\u547d\u4e2d\uff09\u3002</li> <li>Mispredict\uff1a\u5206\u652f\u9884\u6d4b\u9519\u8bef\u5bfc\u81f4\u7684\u6d41\u6c34\u7ebf\u51b2\u5237\u3002</li> <li>Misc. flush\uff1a\u5176\u4ed6\u7c7b\u578b\u7684\u6d41\u6c34\u7ebf\u51b2\u5237\uff08\u5982\u5f02\u5e38\u3001\u540c\u6b65\u6307\u4ee4\u7b49\uff09\u3002</li> </ul> \u57fa\u51c6\u6d4b\u8bd5 \u7c7b\u522b \u4e3b\u8981\u5f00\u9500\u7279\u5f81 x264 Compute \u6267\u884c\u5468\u671f\u5360\u6bd4\u9ad8\uff0c\u5c11\u91cf\u524d\u7aef\u548c\u8d1f\u8f7d\u505c\u987f namd Compute \u6267\u884c\u5468\u671f\u4e3a\u4e3b\uff0c\u5c11\u91cf ALU \u548c\u8d1f\u8f7d\u505c\u987f leela Compute \u6267\u884c\u5468\u671f\u5360\u4e3b\u5bfc\uff0c\u5c11\u91cf\u8d1f\u8f7d\u548c\u524d\u7aef\u505c\u987f imagick Flush \u660e\u663e\u7684 Mispredict \u548c Misc. flush \u5360\u6bd4\u9ad8\uff0c\u6267\u884c\u5468\u671f\u6b21\u4e4b nab Flush Mispredict \u548c Misc. flush \u5360\u6bd4\u663e\u8457 perlbench Flush Mispredict \u548c Misc. flush \u5360\u6bd4\u8f83\u9ad8 fluidanimate Flush Mispredict \u548c Misc. flush \u5360\u6bd4\u9ad8 blackscholes Flush Mispredict \u548c Misc. flush \u5360\u6bd4\u9ad8 povray Flush Mispredict \u548c Misc. flush \u5360\u6bd4\u9ad8 bodytrack Flush Mispredict \u548c Misc. flush \u5360\u6bd4\u9ad8 gcc Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 canneal Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 lbm Stall Load stall \u5360\u6bd4\u6781\u9ad8\uff0c\u5176\u6b21\u662f ALU stall mcf Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 fotonik3d Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 bwaves Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 omnetpp Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 roms Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 streamcluster Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 xalancbmk Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 wrf Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 parest Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 cactuBSSN Stall Load stall \u548c Front-end \u5360\u6bd4\u9ad8 <ul> <li>Compute \u7c7b\u578b\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 x264, namd, leela\uff09\u4e3b\u8981\u6d88\u8017\u5728\u6307\u4ee4\u6267\u884c\u4e0a\uff0c\u8868\u660e\u5176\u8ba1\u7b97\u5bc6\u96c6\u4e14\u6d41\u6c34\u7ebf\u6548\u7387\u8f83\u9ad8\u3002</li> <li>Flush \u7c7b\u578b\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 imagick, nab, perlbench\uff09\u8868\u73b0\u51fa\u8f83\u9ad8\u7684 Mispredict \u548c Misc. flush \u5f00\u9500\uff0c\u8bf4\u660e\u5176\u63a7\u5236\u6d41\u590d\u6742\uff0c\u5206\u652f\u9884\u6d4b\u5931\u8d25\u9891\u7e41\u3002</li> <li>Stall \u7c7b\u578b\u57fa\u51c6\u6d4b\u8bd5\uff08\u5982 gcc, canneal, lbm\uff09\u5219\u4ee5 Load stall \u548c Front-end \u4e3a\u4e3b\u8981\u74f6\u9888\uff0c\u53cd\u6620\u5176\u5185\u5b58\u8bbf\u95ee\u5bc6\u96c6\u6216\u524d\u7aef\u4f9b\u7ed9\u4e0d\u8db3\u3002</li> <li>\u8be5\u56fe\u76f4\u89c2\u63ed\u793a\u4e86\u4e0d\u540c\u5de5\u4f5c\u8d1f\u8f7d\u5728\u5904\u7406\u5668\u5fae\u67b6\u6784\u5c42\u9762\u7684\u884c\u4e3a\u5dee\u5f02\uff0c\u4e3a\u6027\u80fd\u8c03\u4f18\u63d0\u4f9b\u4f9d\u636e\u3002\u4f8b\u5982\uff0c\u9488\u5bf9 Flush \u7c7b\u578b\u5e94\u4f18\u5316\u5206\u652f\u9884\u6d4b\uff0c\u800c Stall \u7c7b\u578b\u5219\u9700\u5173\u6ce8\u5185\u5b58\u5b50\u7cfb\u7edf\u6216\u6307\u4ee4\u9884\u53d6\u7b56\u7565\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure8functio-elerorsfortederentprofs-ncindecuateatthefuctioleliftar-and-dispatch-are-largely-inaccurate-figure-9-basic-block-levelerrorsforthe-diferent-profilerssoftwareand-dispatcharenotshownbecauseoftheirhigherror-tiptip-ilpand-nciare-accurateat-the-basic-block-level-whereas-lciand-softwareand-dispatch-arenot","title":"Figure8:Functio-elerorsfortederentprofs.-,NCI,ndecuateatthefuctioleliftar and Dispatch are largely inaccurate. Figure 9: Basic-block-levelerrorsforthe diferent profilers.(Softwareand Dispatcharenotshownbecauseoftheirhigherror TIP,TIP-ILP,and NCIare accurateat the basic block level, whereas LCI(and Softwareand Dispatch) arenot.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u4e0d\u540c\u6027\u80fd\u5206\u6790\u5668\u5728\u57fa\u672c\u5757\u7ea7\u522b\uff08Basic-block-level\uff09\u7684\u914d\u7f6e\u9519\u8bef\u7387\uff0c\u6a2a\u8f74\u6309\u57fa\u51c6\u6d4b\u8bd5\u5206\u7c7b\u4e3a Compute\u3001Flush\u3001Stall \u4ee5\u53ca Average \u56db\u7ec4\uff0c\u7eb5\u8f74\u4e3a\u9519\u8bef\u767e\u5206\u6bd4\uff08Error %\uff09\uff0c\u56fe\u4f8b\u5305\u542b\u56db\u79cd\u5206\u6790\u5668\uff1aLCI\u3001NCI\u3001TIP-ILP \u548c TIP\u3002</li> <li>TIP \u5728\u6240\u6709\u7c7b\u522b\u4e2d\u5747\u8868\u73b0\u6700\u4f18\uff0c\u5e73\u5747\u9519\u8bef\u7387\u6700\u4f4e\uff0c\u5c24\u5176\u5728 Stall \u7c7b\u522b\u4e2d\u663e\u8457\u4f18\u4e8e\u5176\u4ed6\u5206\u6790\u5668\uff0c\u4f8b\u5982\u5728 <code>lbm</code> \u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0cTIP \u9519\u8bef\u7387\u63a5\u8fd1 0%\uff0c\u800c LCI \u9ad8\u8fbe 56%\u3002</li> <li>LCI \u5728 Stall \u7c7b\u522b\u4e2d\u9519\u8bef\u7387\u6781\u9ad8\uff0c\u5982 <code>lbm</code> \u8fbe\u5230 56%\uff0c<code>streamcluster</code> \u8fbe\u5230 33%\uff0c\u8868\u660e\u5176\u5728\u5904\u7406\u957f\u5ef6\u8fdf\u6307\u4ee4\uff08\u5982 LLC \u7f3a\u5931\uff09\u65f6\u7cfb\u7edf\u6027\u5730\u5c06\u65f6\u95f4\u5f52\u56e0\u4e8e\u9519\u8bef\u7684\u57fa\u672c\u5757\u3002</li> <li>NCI \u8868\u73b0\u7a33\u5b9a\u4f46\u4e0d\u5982 TIP\uff0c\u5e73\u5747\u9519\u8bef\u7387\u7ea6\u4e3a 2.3%\uff0c\u5728\u90e8\u5206\u57fa\u51c6\u6d4b\u8bd5\u5982 <code>gcc</code> \u548c <code>xalancbmk</code> \u4e2d\u7565\u9ad8\u4e8e TIP-ILP\u3002</li> <li>TIP-ILP \u4ecb\u4e8e NCI \u4e0e TIP \u4e4b\u95f4\uff0c\u5e73\u5747\u9519\u8bef\u7387\u4e3a 1.2%\uff0c\u8bf4\u660e\u5373\u4f7f\u5ffd\u7565 ILP\uff08Instruction-Level Parallelism\uff09\uff0c\u5176\u51c6\u786e\u6027\u4ecd\u4f18\u4e8e\u4f20\u7edf\u65b9\u6cd5\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5404\u5206\u6790\u5668\u5728\u4e0d\u540c\u7c7b\u522b\u4e0b\u7684\u5e73\u5747\u9519\u8bef\u7387\uff1a</li> </ul> \u5206\u6790\u5668 Compute \u5e73\u5747\u9519\u8bef\u7387 Flush \u5e73\u5747\u9519\u8bef\u7387 Stall \u5e73\u5747\u9519\u8bef\u7387 Overall \u5e73\u5747\u9519\u8bef\u7387 LCI ~5% ~8% ~25% 11.9% NCI ~1% ~2% ~4% 2.3% TIP-ILP ~0.5% ~1% ~2% 1.2% TIP ~0.3% ~0.5% ~0.8% 0.7% <ul> <li>\u5173\u952e\u7ed3\u8bba\uff1aTIP \u662f\u552f\u4e00\u5728\u57fa\u672c\u5757\u7ea7\u522b\u4fdd\u6301\u9ad8\u51c6\u786e\u6027\u7684\u5206\u6790\u5668\uff0cLCI \u56e0\u65e0\u6cd5\u6b63\u786e\u5f52\u56e0\u6d41\u6c34\u7ebf\u505c\u987f\u5bfc\u81f4\u4e25\u91cd\u8bef\u5dee\uff0cTIP-ILP \u548c NCI \u867d\u53ef\u63a5\u53d7\uff0c\u4f46\u7cbe\u5ea6\u4e0d\u53ca TIP\u3002\u8be5\u7ed3\u679c\u5f3a\u5316\u4e86\u7ec6\u7c92\u5ea6\u5206\u6790\u5bf9\u8bc6\u522b\u6027\u80fd\u74f6\u9888\u7684\u91cd\u8981\u6027\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-0instruction-levelerrorsforthe-different-profilerssoftwaredispatchandlciareomitted-becauseoftheirlarge-errors-tip-is-the-only-accurate-profiler-at-the-instruction-level","title":"Figure 0:Instruction-levelerrorsforthe different profilers.(Software,Dispatch,andLCIareomitted becauseoftheirlarge errors.) TIP is the only accurate profiler at the instruction level.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728\u6307\u4ee4\u7ea7\u522b\u4e0a\uff0c\u4e09\u79cd\u4e0d\u540c\u6027\u80fd\u5206\u6790\u5668\uff08NCI\u3001TIP-ILP\u3001TIP\uff09\u7684\u9519\u8bef\u7387\u5bf9\u6bd4\uff0c\u6a2a\u8f74\u6309\u57fa\u51c6\u6d4b\u8bd5\u5206\u7c7b\u4e3a Compute\u3001Flush\u3001Stall \u4e09\u7c7b\uff0c\u4ee5\u53ca\u603b\u4f53\u5e73\u5747\u503c\uff08Average\uff09\uff0c\u7eb5\u8f74\u4e3a\u9519\u8bef\u7387\u767e\u5206\u6bd4\u3002</li> <li>TIP \u5728\u6240\u6709\u7c7b\u522b\u4e2d\u5747\u8868\u73b0\u51fa\u6700\u4f4e\u7684\u9519\u8bef\u7387\uff0c\u662f\u552f\u4e00\u5728\u6307\u4ee4\u7ea7\u522b\u4fdd\u6301\u9ad8\u7cbe\u5ea6\u7684\u5206\u6790\u5668\uff0c\u5176\u5e73\u5747\u9519\u8bef\u7387\u4ec5\u4e3a 1.6%\u3002</li> <li>TIP-ILP \u867d\u7136\u4f18\u4e8e NCI\uff0c\u4f46\u56e0\u672a\u8003\u8651\u6307\u4ee4\u7ea7\u5e76\u884c\uff08ILP\uff09\uff0c\u5728 Compute \u7c7b\u522b\u4e2d\u9519\u8bef\u7387\u663e\u8457\u4e0a\u5347\uff0c\u5e73\u5747\u9519\u8bef\u7387\u4e3a 7.2%\u3002</li> <li>NCI \u9519\u8bef\u7387\u6700\u9ad8\uff0c\u5c24\u5176\u5728 Flush \u7c7b\u522b\u4e2d\u8868\u73b0\u6700\u5dee\uff0c\u5e73\u5747\u9519\u8bef\u7387\u8fbe 9.3%\uff0c\u8bf4\u660e\u5176\u5728\u5904\u7406\u6d41\u6c34\u7ebf\u51b2\u5237\u65f6\u5b58\u5728\u7cfb\u7edf\u6027\u5f52\u56e0\u9519\u8bef\u3002</li> <li>\u5404\u7c7b\u522b\u7684\u5177\u4f53\u9519\u8bef\u7387\u6570\u636e\u5982\u4e0b\u8868\u6240\u793a\uff1a</li> </ul> \u57fa\u51c6\u6d4b\u8bd5 NCI \u9519\u8bef\u7387 TIP-ILP \u9519\u8bef\u7387 TIP \u9519\u8bef\u7387 exchange2 ~15% ~10% ~5% x264 ~8% ~5% ~3% deepsjeng ~10% ~7% ~4% namd ~12% ~8% ~5% leela ~14% ~9% ~6% swaptions ~10% ~6% ~4% imagick ~18% ~10% ~6% nab ~12% ~8% ~5% perlbench ~14% ~9% ~6% fluidanimate ~10% ~7% ~4% blackscholes ~10% ~6% ~4% povray ~10% ~6% ~4% bodytrack ~10% ~6% ~4% gcc ~10% ~7% ~5% canneal ~5% ~4% ~2% lbm ~5% ~4% ~2% mcf ~5% ~4% ~2% fotonik3d ~5% ~4% ~2% bwaves ~5% ~4% ~2% omnetpp ~5% ~4% ~2% roms ~5% ~4% ~2% streamcluster ~10% ~7% ~4% xalancbmk ~5% ~4% ~2% wrf ~5% ~4% ~2% parest ~5% ~4% ~2% cam4 ~5% ~4% ~2% cactuBSSN ~5% ~4% ~2% Compute \u5e73\u5747 ~10% ~7% ~4% Flush \u5e73\u5747 ~14% ~9% ~6% Stall \u5e73\u5747 ~6% ~5% ~3% All \u5e73\u5747 9.3% 7.2% 1.6% <ul> <li>\u56fe\u8868\u53f3\u4e0b\u89d2\u7684 \u201cAll\u201d \u67f1\u72b6\u56fe\u6e05\u6670\u663e\u793a\uff1aTIP \u7684\u5e73\u5747\u9519\u8bef\u7387\u8fdc\u4f4e\u4e8e NCI \u548c TIP-ILP\uff0c\u9a8c\u8bc1\u4e86\u5176\u5728\u6307\u4ee4\u7ea7\u5f52\u56e0\u4e0a\u7684\u4f18\u8d8a\u6027\u3002</li> <li>\u8be5\u56fe\u7701\u7565\u4e86 Software\u3001Dispatch \u548c LCI \u5206\u6790\u5668\uff0c\u56e0\u5176\u9519\u8bef\u7387\u8fc7\u9ad8\uff08\u5206\u522b\u8fbe 61.8%\u300153.1%\u300155.4%\uff09\uff0c\u65e0\u6cd5\u5728\u76f8\u540c\u5c3a\u5ea6\u4e0b\u6709\u6548\u6bd4\u8f83\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figuresensitivityanalysesatsacuracycontinuestomeasurablyimprovebeyond4khzunliketheotherproflersbperdic-samplingisonlyslightlymoreinacuratethanrandomsamplingwhilebeingsimplertoimplementinhardwarecmakingncicommitparallelism-aware-increases-profile-errorin-contrast-to-tip","title":"Figure:Sensitivityanalyses.(a)T'sacuracycontinuestomeasurablyimprovebeyond4KHzunliketheotherproflers.(b)Perdic samplingisonlyslightlymoreinacuratethanrandomsamplingwhilebeingsimplertoimplementinhardware.(c)MakingNCIcommitparallelism-aware increases profile error,in contrast to TIP.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u4e09\u4e2a\u5b50\u56fe\uff0c\u5206\u522b\u5bf9\u5e94\u8bba\u6587\u4e2d\u5173\u4e8e TIP \u4e0e\u73b0\u6709 Profiler \u7684\u654f\u611f\u6027\u5206\u6790\u7ed3\u679c\uff0c\u65e8\u5728\u9a8c\u8bc1 TIP \u5728\u4e0d\u540c\u91c7\u6837\u7b56\u7565\u548c\u8bbe\u8ba1\u53d8\u4f53\u4e0b\u7684\u8868\u73b0\u3002</li> <li>\u5b50\u56fe (a) \u805a\u7126\u4e8e\u91c7\u6837\u9891\u7387\u5bf9\u8bef\u5dee\u7684\u5f71\u54cd\u3002\u6a2a\u8f74\u4e3a\u4e09\u79cd Profiler\uff1aNCI\u3001TIP-ILP \u548c TIP\uff1b\u7eb5\u8f74\u4e3a Profile Error\uff08\u767e\u5206\u6bd4\uff09\u3002\u4e0d\u540c\u989c\u8272\u67f1\u72b6\u56fe\u4ee3\u8868\u4ece 100 Hz \u5230 20 kHz \u7684\u91c7\u6837\u9891\u7387\u3002\u7ed3\u679c\u663e\u793a\uff1a</li> <li>TIP \u7684\u8bef\u5dee\u968f\u91c7\u6837\u9891\u7387\u63d0\u5347\u6301\u7eed\u4e0b\u964d\uff0c\u5c24\u5176\u5728 4 kHz \u4ee5\u4e0a\u4ecd\u663e\u8457\u6539\u5584\uff0c\u4f8b\u5982 gcc \u5728 4 kHz \u65f6\u8bef\u5dee\u4e3a 5.0%\uff0c\u5728 20 kHz \u65f6\u964d\u81f3 2.6%\u3002</li> <li>NCI \u548c TIP-ILP \u5728 4 kHz \u540e\u8bef\u5dee\u8d8b\u4e8e\u9971\u548c\uff0c\u8868\u660e\u5176\u65e0\u6cd5\u4ece\u66f4\u9ad8\u91c7\u6837\u7387\u4e2d\u83b7\u76ca\u3002</li> <li> <p>\u6b64\u73b0\u8c61\u5f52\u56e0\u4e8e TIP \u5bf9 ILP \u7684\u6b63\u786e\u5904\u7406\u2014\u2014\u5b83\u5c06\u9ad8\u5e76\u884c\u63d0\u4ea4\u5468\u671f\u7684\u6837\u672c\u6309\u6bd4\u4f8b\u5206\u914d\u7ed9\u591a\u4e2a\u6307\u4ee4\uff0c\u800c\u5176\u4ed6\u65b9\u6cd5\u4ec5\u5f52\u56e0\u4e8e\u5355\u4e2a\u6307\u4ee4\u3002</p> </li> <li> <p>\u5b50\u56fe (b) \u6bd4\u8f83\u5468\u671f\u6027\u91c7\u6837\u4e0e\u968f\u673a\u91c7\u6837\u7684\u8bef\u5dee\u5dee\u5f02\u3002\u6a2a\u8f74\u5217\u51fa 27 \u4e2a SPEC CPU2017 \u548c PARSEC \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u5e76\u6309\u6267\u884c\u7279\u5f81\u5206\u4e3a Compute\u3001Flush\u3001Stall \u4e09\u7c7b\uff0c\u6700\u540e\u662f\u5e73\u5747\u503c\u3002\u6df1\u8272\u67f1\u4e3a\u5468\u671f\u6027\u91c7\u6837\uff0c\u6d45\u8272\u67f1\u4e3a\u968f\u673a\u91c7\u6837\u3002\u5173\u952e\u53d1\u73b0\u5305\u62ec\uff1a</p> </li> <li>\u5927\u591a\u6570\u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u4e24\u79cd\u91c7\u6837\u65b9\u5f0f\u8bef\u5dee\u63a5\u8fd1\uff0c\u5e73\u5747\u8bef\u5dee\u4ece\u5468\u671f\u6027\u7684 1.6% \u964d\u81f3\u968f\u673a\u7684 1.1%\u3002</li> <li>\u5c11\u6570 Stall-intensive \u57fa\u51c6\u5982 streamcluster\u3001lbm\u3001fotonik3d \u663e\u793a\u66f4\u660e\u663e\u5dee\u5f02\uff0c\u56e0\u5176\u5177\u6709\u91cd\u590d\u6027\u65f6\u95f4\u884c\u4e3a\uff0c\u6613\u53d7\u5468\u671f\u91c7\u6837\u504f\u5dee\u5f71\u54cd\u3002</li> <li> <p>\u8bba\u6587\u6307\u51fa\uff0c\u5c3d\u7ba1\u968f\u673a\u91c7\u6837\u7565\u4f18\uff0c\u4f46\u786c\u4ef6\u5b9e\u73b0\u66f4\u590d\u6742\uff0c\u6545\u63a8\u8350\u4f7f\u7528\u5468\u671f\u6027\u91c7\u6837\u3002</p> </li> <li> <p>\u5b50\u56fe (c) \u5c55\u793a\u5f15\u5165\u5e76\u884c\u611f\u77e5\u673a\u5236\u540e NCI \u7684\u8bef\u5dee\u53d8\u5316\u3002\u91c7\u7528\u7bb1\u7ebf\u56fe\u5f62\u5f0f\uff0c\u6bd4\u8f83\u56db\u79cd\u914d\u7f6e\uff1aNCI+ILP\u3001NCI\u3001TIP-ILP\u3001TIP\u3002\u6570\u636e\u663e\u793a\uff1a</p> </li> <li>NCI+ILP \u7684\u5e73\u5747\u8bef\u5dee\u9ad8\u8fbe 19.3%\uff0c\u8fdc\u9ad8\u4e8e\u539f\u59cb NCI \u7684 9.3%\uff0c\u4e5f\u9ad8\u4e8e TIP-ILP \u7684 7.2% \u548c TIP \u7684 1.6%\u3002</li> <li>\u8bef\u5dee\u4e0a\u5347\u7684\u539f\u56e0\u5728\u4e8e\uff1aNCI+ILP \u5728\u957f\u5ef6\u8fdf\u505c\u987f\uff08\u5982 LLC miss\uff09\u540e\u9519\u8bef\u5730\u5c06\u6837\u672c\u5747\u5206\u7ed9\u5373\u5c06\u63d0\u4ea4\u7684 n \u6761\u6307\u4ee4\uff0c\u800c\u975e\u50cf TIP \u90a3\u6837\u5f52\u56e0\u4e8e\u5bfc\u81f4\u505c\u987f\u7684\u6307\u4ee4\u672c\u8eab\u3002</li> <li>\u8fd9\u4e00\u7ed3\u679c\u5f3a\u8c03\uff1a\u4ec5\u6dfb\u52a0 ILP \u652f\u6301\u4e0d\u8db3\u4ee5\u63d0\u5347\u51c6\u786e\u6027\uff0c\u5fc5\u987b\u5efa\u7acb\u5728\u6b63\u786e\u7684\u65f6\u5e8f\u5f52\u56e0\u539f\u5219\u4e4b\u4e0a\uff0c\u8fd9\u6b63\u662f TIP \u7684\u6838\u5fc3\u4f18\u52bf\u3002</li> </ul> Profiler Avg Error (%) Key Insight NCI 9.3 \u672a\u8003\u8651 ILP\uff0c\u4e14\u9519\u8bef\u5f52\u56e0 flush/stall TIP-ILP 7.2 \u6b63\u786e\u5f52\u56e0 flush\uff0c\u4f46\u5ffd\u7565 ILP \u5bfc\u81f4\u504f\u7f6e TIP 1.6 \u540c\u65f6\u652f\u6301 ILP \u4e0e\u6b63\u786e\u65f6\u5e8f\u5f52\u56e0\uff0c\u8bef\u5dee\u6700\u4f4e NCI+ILP 19.3 \u5f15\u5165 ILP \u4f46\u65e0\u6b63\u786e\u5f52\u56e0\u903b\u8f91\uff0c\u8bef\u5dee\u53cd\u800c\u6076\u5316 <ul> <li>\u603b\u7ed3\uff1a\u8be5\u56fe\u901a\u8fc7\u4e09\u7ec4\u5b9e\u9a8c\u6709\u529b\u652f\u6491\u4e86\u8bba\u6587\u6838\u5fc3\u4e3b\u5f20\u2014\u2014TIP \u7684\u51c6\u786e\u6027\u6e90\u4e8e\u5176\u201c\u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0\u201d\u539f\u5219\u4e0e ILP \u610f\u8bc6\u7684\u7ed3\u5408\uff0c\u800c\u73b0\u6709\u65b9\u6cd5\u5373\u4f7f\u5c1d\u8bd5\u6539\u8fdb\uff08\u5982\u589e\u52a0 ILP \u652f\u6301\uff09\uff0c\u82e5\u7f3a\u4e4f\u6839\u672c\u6027\u5f52\u56e0\u673a\u5236\uff0c\u53cd\u800c\u4f1a\u52a0\u5267\u8bef\u5dee\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-12function-and-instruction-level-profiles-for-lmagick-for-tip-and-nci-compared-to-oracle","title":"Figure 12:Function and instruction-level profiles for lmagick for TIP and NCI compared to Oracle.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728 SPEC CPU2017 \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f Imagick \u4e2d\uff0c\u9488\u5bf9 ceil \u51fd\u6570\u7684\u6027\u80fd\u5256\u6790\u7ed3\u679c\uff0c\u5bf9\u6bd4\u4e86\u4e09\u79cd\u5256\u6790\u5668\uff1aOracle\uff08\u9ec4\u91d1\u6807\u51c6\uff09\u3001TIP\uff08\u672c\u6587\u63d0\u51fa\uff09\u548c NCI\uff08Intel PEBS \u4f7f\u7528\u7684\u542f\u53d1\u5f0f\u65b9\u6cd5\uff09\u3002</li> <li>\u5206\u6790\u5206\u4e3a\u4e24\u4e2a\u5c42\u7ea7\uff1a\u51fd\u6570\u7ea7\uff08Function-Level Profile\uff09\u548c\u6307\u4ee4\u7ea7\uff08Instruction-Level Profile\uff09\uff0c\u65e8\u5728\u63ed\u793a\u4e0d\u540c\u5256\u6790\u5668\u5728\u5b9a\u4f4d\u6027\u80fd\u74f6\u9888\u65f6\u7684\u51c6\u786e\u6027\u5dee\u5f02\u3002 \u51fd\u6570\u7ea7\u5256\u6790\uff08\u56fe\u2460\uff09</li> <li>\u6b64\u90e8\u5206\u663e\u793a\u4e86 Imagick \u5e94\u7528\u4e2d\u51e0\u4e2a\u6700\u70ed\u51fd\u6570\u6240\u5360\u7684\u8fd0\u884c\u65f6\u95f4\u767e\u5206\u6bd4\u3002</li> <li>\u4e09\u4e2a\u5256\u6790\u5668\u7684\u7ed3\u679c\u9ad8\u5ea6\u4e00\u81f4\uff0c\u8868\u660e\u5728\u51fd\u6570\u7c92\u5ea6\u4e0a\uff0c\u5b83\u4eec\u90fd\u80fd\u51c6\u786e\u53cd\u6620\u6574\u4f53\u6027\u80fd\u5206\u5e03\u3002</li> <li>\u5173\u952e\u6570\u636e\u5982\u4e0b\uff1a</li> </ul> \u51fd\u6570\u540d Oracle (%) TIP (%) NCI (%) MeanSh.. 25.25% 25.25% 25.16% floor 21.90% 21.95% 21.95% ceil 21.57% 21.63% 21.63% Morpho.. 18.53% 18.56% 18.56% <ul> <li>\u7ed3\u8bba\uff1a\u6240\u6709\u5256\u6790\u5668\u5728\u51fd\u6570\u7ea7\u5747\u8868\u73b0\u826f\u597d\uff0c\u8bef\u5dee\u6781\u5c0f\uff08\u5e73\u5747\u7ea6 0.3%-0.6%\uff09\uff0c\u65e0\u6cd5\u5e2e\u52a9\u5f00\u53d1\u8005\u8bc6\u522b\u5177\u4f53\u6027\u80fd\u95ee\u9898\u3002 \u6307\u4ee4\u7ea7\u5256\u6790\uff08\u56fe\u2461\u3001\u2462\uff09</li> <li>\u6b64\u90e8\u5206\u6df1\u5165\u5230 ceil \u51fd\u6570\u5185\u90e8\uff0c\u5c55\u793a\u5404\u6307\u4ee4\u6240\u5360\u8be5\u51fd\u6570\u5185\u6267\u884c\u65f6\u95f4\u7684\u767e\u5206\u6bd4\u3002</li> <li>Oracle \u548c TIP \u7684\u7ed3\u679c\u9ad8\u5ea6\u543b\u5408\uff0c\u800c NCI \u5219\u51fa\u73b0\u663e\u8457\u504f\u5dee\uff0c\u5c24\u5176\u5728\u5173\u952e\u6307\u4ee4\u4e0a\u3002 ceil \u51fd\u6570\u5165\u53e3\u5904\u6307\u4ee4\uff08\u56fe\u2461\uff09</li> <li>frflags \u548c fsflags \u662f\u6d6e\u70b9\u72b6\u6001\u5bc4\u5b58\u5668\u64cd\u4f5c\u6307\u4ee4\uff0c\u7528\u4e8e\u5c4f\u853d\u51fd\u6570\u5185\u7684\u72b6\u6001\u53d8\u66f4\u3002</li> <li>Oracle \u548c TIP \u5747\u6b63\u786e\u6307\u51fa\u8fd9\u4e9b\u6307\u4ee4\u6d88\u8017\u4e86\u7ea6 24.99% \u548c 24.91% \u7684\u51fd\u6570\u65f6\u95f4\u3002</li> <li>NCI \u5374\u5c06\u5927\u90e8\u5206\u65f6\u95f4\u9519\u8bef\u5f52\u56e0\u4e8e\u540e\u7eed\u6307\u4ee4 feq.d\uff0828.80%\uff09\uff0c\u800c\u4f4e\u4f30\u4e86 frflags/fsflags\uff08\u4ec5 11.51%/11.53%\uff09\u3002</li> <li>\u8fd9\u79cd\u9519\u8bef\u5f52\u56e0\u4f1a\u5bfc\u81f4\u5f00\u53d1\u8005\u8bef\u5224\u4e3a\u6d6e\u70b9\u6bd4\u8f83\u5355\u5143\uff08feq.d\uff09\u6216\u8fd4\u56de\u5730\u5740\u9884\u6d4b\u5668\uff08ret\uff09\u662f\u74f6\u9888\u3002 ceil \u51fd\u6570\u51fa\u53e3\u5904\u6307\u4ee4\uff08\u56fe\u2462\uff09</li> <li>\u5728\u51fd\u6570\u672b\u5c3e\uff0cret \u6307\u4ee4\u7684\u65f6\u95f4\u5f52\u56e0\u4e5f\u5b58\u5728\u5de8\u5927\u5dee\u5f02\u3002</li> <li>Oracle \u548c TIP \u5747\u5c06\u5176\u5f52\u56e0\u4e3a 9.61% \u548c 9.63%\u3002</li> <li>NCI \u5219\u9519\u8bef\u5730\u5c06\u5176\u5f52\u56e0\u4e3a 23.09%\uff0c\u51e0\u4e4e\u7ffb\u500d\u3002</li> <li>\u8fd9\u8fdb\u4e00\u6b65\u8bf4\u660e NCI \u5728\u5904\u7406\u6d41\u6c34\u7ebf\u5237\u65b0\uff08\u5982\u7531 frflags/fsflags \u5f15\u53d1\uff09\u540e\uff0c\u4f1a\u9519\u8bef\u5730\u5c06\u5ef6\u8fdf\u5f52\u56e0\u7ed9\u201c\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u6307\u4ee4\u201d\u3002 \u6838\u5fc3\u53d1\u73b0</li> <li>TIP \u80fd\u591f\u7cbe\u786e\u8bc6\u522b\u51fa frflags \u548c fsflags \u662f\u6027\u80fd\u74f6\u9888\uff0c\u800c NCI \u4f1a\u8bef\u5bfc\u5f00\u53d1\u8005\u5173\u6ce8\u9519\u8bef\u7684\u6307\u4ee4\u3002</li> <li>\u5b9e\u9645\u4f18\u5316\u4e2d\uff0c\u79fb\u9664\u8fd9\u4e9b\u4e0d\u5fc5\u8981\u7684\u72b6\u6001\u5bc4\u5b58\u5668\u64cd\u4f5c\uff08\u66ff\u6362\u4e3a nop\uff09\uff0c\u53ef\u5e26\u6765 1.93\u00d7 \u7684\u6027\u80fd\u63d0\u5347\uff0c\u9a8c\u8bc1\u4e86 TIP \u7684\u5b9e\u7528\u4ef7\u503c\u3002</li> <li>\u8be5\u6848\u4f8b\u51f8\u663e\u4e86\u6307\u4ee4\u7ea7\u5256\u6790\u7cbe\u5ea6\u7684\u91cd\u8981\u6027\uff1a\u51fd\u6570\u7ea7\u5256\u6790\u65e0\u6cd5\u5b9a\u4f4d\u95ee\u9898\uff0c\u800c\u4f4e\u7cbe\u5ea6\u7684\u6307\u4ee4\u7ea7\u5256\u6790\uff08\u5982 NCI\uff09\u4f1a\u63d0\u4f9b\u9519\u8bef\u6307\u5f15\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/figs_notes/#figure-13-time-breakdown-for-the-four-most-runtimeintensive-functions-in-lmagick-comparing-the-original-to-our-optimized-versionthe-193x-speed-up-is-primarily-due-improved-processor-utilization","title":"Figure 13: Time breakdown for the four most runtimeintensive functions in lmagick comparing the original to our optimized version.The 1.93x speed-up is primarily due improved processor utilization.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 SPEC CPU2017 \u57fa\u51c6\u6d4b\u8bd5 Imagick \u4e2d\u56db\u4e2a\u6700\u8017\u65f6\u51fd\u6570\uff08MeanShiftImage\u3001floor\u3001ceil\u3001MorphologyApply\uff09\u5728\u539f\u59cb\u7248\u672c\uff08Orig.\uff09\u4e0e\u4f18\u5316\u7248\u672c\uff08Opt.\uff09\u4e0b\u7684\u65f6\u95f4\u5206\u89e3\u5bf9\u6bd4\uff0c\u65e8\u5728\u8bf4\u660e TIP \u8bc6\u522b\u51fa\u7684\u6027\u80fd\u74f6\u9888\u53ca\u5176\u4f18\u5316\u6548\u679c\u3002</li> <li>\u8be5\u56fe\u91c7\u7528\u5806\u53e0\u67f1\u72b6\u56fe\u5f62\u5f0f\uff0c\u7eb5\u8f74\u4e3a\u6267\u884c\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u6a2a\u8f74\u4e3a\u51fd\u6570\u540d\u79f0\u3002\u6bcf\u4e2a\u67f1\u5b50\u6309\u4e0d\u540c\u6027\u80fd\u4e8b\u4ef6\u7c7b\u578b\u5206\u5c42\u7740\u8272\uff0c\u53f3\u4fa7\u56fe\u4f8b\u6807\u660e\u4e86\u5404\u989c\u8272\u5bf9\u5e94\u7684\u5177\u4f53\u4e8b\u4ef6\u3002</li> <li>\u5173\u952e\u53d1\u73b0\uff1a\u4f18\u5316\u7248\u672c\u6574\u4f53\u6267\u884c\u65f6\u95f4\u663e\u8457\u7f29\u77ed\uff0c\u5c24\u5176\u5728 floor \u548c ceil \u51fd\u6570\u4e2d\u8868\u73b0\u6700\u4e3a\u7a81\u51fa\uff0c\u8fd9\u76f4\u63a5\u9a8c\u8bc1\u4e86 TIP \u6307\u51fa\u7684 frflags/fsflags \u6307\u4ee4\u5bfc\u81f4\u9891\u7e41 Misc. flush \u662f\u6027\u80fd\u74f6\u9888\u3002</li> <li>\u4f18\u5316\u540e\uff0cMisc. flush \u7c7b\u522b\u5728 floor \u548c ceil \u4e2d\u51e0\u4e4e\u6d88\u5931\uff0c\u8868\u660e\u79fb\u9664\u4e0d\u5fc5\u8981\u7684\u6d6e\u70b9\u72b6\u6001\u5bc4\u5b58\u5668\u64cd\u4f5c\u6709\u6548\u6d88\u9664\u4e86\u6d41\u6c34\u7ebf\u51b2\u5237\u5f00\u9500\u3002</li> <li>\u5728 MeanShiftImage \u51fd\u6570\u4e2d\uff0c\u867d\u7136\u672a\u76f4\u63a5\u4fee\u6539\u5176\u4ee3\u7801\uff0c\u4f46\u56e0\u8c03\u7528\u7684 ceil \u548c floor \u88ab\u4f18\u5316\uff0c\u5176\u6267\u884c\u65f6\u95f4\u4e5f\u5927\u5e45\u4e0b\u964d\uff08\u4ece\u7ea6 300s \u964d\u81f3 200s\uff09\uff0c\u4f53\u73b0\u4e86\u4f18\u5316\u7684\u7ea7\u8054\u6548\u5e94\u3002</li> <li>ALU stall \u548c Load stall \u5728\u4f18\u5316\u540e\u4e5f\u6709\u6240\u51cf\u5c11\uff0c\u8bf4\u660e\u5904\u7406\u5668\u80fd\u66f4\u6709\u6548\u5730\u9690\u85cf\u5ef6\u8fdf\uff0cIPC \u4ece 1.2 \u63d0\u5347\u81f3 2.3\uff0c\u8fdb\u4e00\u6b65\u63d0\u5347\u4e86\u6574\u4f53\u6548\u7387\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u4e86\u5404\u51fd\u6570\u5728\u4f18\u5316\u524d\u540e\u7684\u6267\u884c\u65f6\u95f4\u53d8\u5316\uff1a</li> </ul> \u51fd\u6570\u540d \u539f\u59cb\u7248\u672c\u65f6\u95f4 (s) \u4f18\u5316\u7248\u672c\u65f6\u95f4 (s) \u65f6\u95f4\u51cf\u5c11\u6bd4\u4f8b MeanShiftImage ~300 ~200 ~33% floor ~250 ~50 ~80% ceil ~200 ~50 ~75% MorphologyApply ~200 ~200 \u65e0\u660e\u663e\u53d8\u5316 <ul> <li>\u603b\u4f53\u800c\u8a00\uff0c\u8be5\u56fe\u76f4\u89c2\u8bc1\u660e\u4e86 TIP \u7684\u51c6\u786e\u6027\u2014\u2014\u5b83\u4e0d\u4ec5\u5b9a\u4f4d\u5230\u5177\u4f53\u6307\u4ee4\u7ea7\u95ee\u9898\uff0c\u8fd8\u63ed\u793a\u4e86\u5176\u5bf9\u7cfb\u7edf\u7ea7\u6027\u80fd\u7684\u6df1\u8fdc\u5f71\u54cd\uff0c\u6700\u7ec8\u5b9e\u73b0\u4e86 1.93\u00d7 \u7684\u6574\u4f53\u6027\u80fd\u63d0\u5347\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/","title":"TIP: Time-Proportional Instruction Profiling \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Bjorn Gottschall - Lieven Eeckhout - Magnus Jahre</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - MICRO-54: 54th Annual IEEE/ACM International Symposium on Microarchitecture (MICRO '21)</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - 2021</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u73b0\u4ee3\u9ad8\u6027\u80fd\u5904\u7406\u5668\u4e0a\u6027\u80fd\u5206\u6790\u7684\u96be\u9898\uff0c\u5373\u73b0\u6709\u6027\u80fd\u5256\u6790\u5668\uff08profilers\uff09\u65e0\u6cd5\u53ef\u9760\u5730\u5c06\u6267\u884c\u65f6\u95f4\u5f52\u56e0\u4e8e\u6b63\u786e\u7684\u6307\u4ee4\u3002 - \u4e3a\u6027\u80fd\u5256\u6790\u9886\u57df\u5efa\u7acb\u4e00\u4e2a\u9ec4\u91d1\u6807\u51c6\uff08golden reference\uff09\uff0c\u4ee5\u91cf\u5316\u73b0\u6709\u5256\u6790\u6280\u672f\u7684\u8bef\u5dee\u3002 - \u63d0\u51fa\u4e00\u79cd\u65b0\u7684\u3001\u9ad8\u5ea6\u51c6\u786e\u4e14\u53ef\u5b9e\u9645\u90e8\u7f72\u7684\u6307\u4ee4\u7ea7\u6027\u80fd\u5256\u6790\u65b9\u6cd5\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa Oracle \u5256\u6790\u5668\uff1a\u4f5c\u4e3a\u7406\u8bba\u4e0a\u7684\u9ec4\u91d1\u6807\u51c6\uff0c\u5b83\u901a\u8fc7\u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0\uff08time-proportional attribution\uff09\u539f\u5219\uff0c\u5c06\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u7cbe\u786e\u5730\u5f52\u56e0\u4e8e\u5904\u7406\u5668\u66b4\u9732\u5176\u5ef6\u8fdf\u7684\u6307\u4ee4\u3002Oracle \u8003\u8651\u4e86\u56db\u79cd\u6838\u5fc3\u72b6\u6001\uff1a\u8ba1\u7b97\uff08Computing\uff09\u3001\u505c\u6ede\uff08Stalled\uff09\u3001\u5237\u65b0\uff08Flushed\uff09\u548c\u6392\u7a7a\uff08Drained\uff09\u3002 - \u91cf\u5316\u73b0\u6709\u5256\u6790\u5668\u7684\u8bef\u5dee\uff1a\u5229\u7528 Oracle \u4f5c\u4e3a\u57fa\u51c6\uff0c\u8bc4\u4f30\u4e86\u56db\u79cd\u4e3b\u6d41\u5256\u6790\u7b56\u7565\uff1a   - Software-level profiling (\u5982 Linux perf)   - Dispatch-tagging (\u5982 AMD IBS, Arm SPE)   - Last-Committing Instruction (LCI)   - Next-Committing Instruction (NCI) (\u5982 Intel PEBS) - \u8bbe\u8ba1\u5e76\u5b9e\u73b0 TIP (Time-Proportional Instruction Profiling)\uff1a\u5c06 Oracle \u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\u4e0e\u7edf\u8ba1\u91c7\u6837\u76f8\u7ed3\u5408\uff0c\u5728\u4fdd\u6301\u9ad8\u7cbe\u5ea6\u7684\u540c\u65f6\uff0c\u5c06\u6570\u636e\u91cf\u4ece Oracle \u7684 179 GB/s \u964d\u4f4e\u5230\u5b9e\u7528\u7684 192 KB/s\u3002 - \u5b9e\u9a8c\u9a8c\u8bc1\uff1a\u5728 Berkeley Out-of-Order Machine (BOOM) \u6838\u5fc3\u4e0a\u5b9e\u73b0\u4e86 TIP\uff0c\u5e76\u4f7f\u7528 FireSim \u5168\u7cfb\u7edf\u6a21\u62df\u5668\u5bf9 SPEC CPU2017 \u548c PARSEC \u57fa\u51c6\u6d4b\u8bd5\u5957\u4ef6\u8fdb\u884c\u4e86\u5b8c\u6574\u6a21\u62df\uff0c\u4ee5\u8bc4\u4f30\u5176\u51c6\u786e\u6027\u3002</p> <p></p> <p>Figure 3: Oracle profiler clock cycle attribution overview.</p> <p>\u7ed3\u679c - \u73b0\u6709\u5256\u6790\u5668\u5b58\u5728\u663e\u8457\u7cfb\u7edf\u6027\u8bef\u5dee\uff0c\u5176\u6839\u672c\u539f\u56e0\u5728\u4e8e\u5b83\u4eec\u4e0d\u662f\u65f6\u95f4\u6bd4\u4f8b\u7684\uff0c\u65e2\u4e0d\u8003\u8651\u6307\u4ee4\u7ea7\u5e76\u884c\uff08ILP\uff09\uff0c\u53c8\u4f1a\u7cfb\u7edf\u6027\u5730\u9519\u8bef\u5f52\u56e0\u5ef6\u8fdf\u3002 - \u6307\u4ee4\u7ea7\u5256\u6790\u8bef\u5dee\u5bf9\u6bd4\u5982\u4e0b\u8868\u6240\u793a\uff1a</p> \u5256\u6790\u5668\u7c7b\u578b \u5e73\u5747\u6307\u4ee4\u7ea7\u8bef\u5dee Software 61.8% Dispatch-tagging 53.1% LCI 55.4% NCI 9.3% TIP (\u672c\u6587\u63d0\u51fa) 1.6% <ul> <li>TIP \u7684\u7cbe\u5ea6\u8fdc\u8d85\u73b0\u6709\u6280\u672f\uff0c\u5c06\u5e73\u5747\u8bef\u5dee\u5206\u522b\u964d\u4f4e\u4e86 5.8\u00d7 (vs NCI)\u300134.6\u00d7 (vs LCI)\u300133.2\u00d7 (vs Dispatch) \u548c 38.6\u00d7 (vs Software)\u3002</li> <li>\u6848\u4f8b\u7814\u7a76\uff1a\u5728 SPEC CPU2017 \u7684 Imagick \u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0cTIP \u6210\u529f\u5b9a\u4f4d\u4e86\u7531 Control Status Register (CSR) \u6307\u4ee4\u5f15\u8d77\u7684\u6027\u80fd\u74f6\u9888\uff0c\u800c NCI \u5219\u9519\u8bef\u5730\u5c06\u65f6\u95f4\u5f52\u56e0\u4e8e\u540e\u7eed\u6307\u4ee4\u3002</li> <li>\u901a\u8fc7\u5c06\u4e0d\u5fc5\u8981\u7684 CSR \u6307\u4ee4\u66ff\u6362\u4e3a <code>nop</code>\uff0c\u7a0b\u5e8f\u6027\u80fd\u83b7\u5f97\u4e86 1.93\u00d7 \u7684\u663e\u8457\u63d0\u5347\uff0c\u8fd9\u8bc1\u660e\u4e86 TIP \u5728\u5b9e\u8df5\u4e2d\u53d1\u73b0\u5173\u952e\u4f18\u5316\u673a\u4f1a\u7684\u80fd\u529b\u3002</li> </ul> <p></p> <p>Figure 12:Function and instruction-level profiles for lmagick for TIP and NCI compared to Oracle.</p> <p>\u7ed3\u8bba - \u73b0\u6709\u786c\u4ef6\u6027\u80fd\u5256\u6790\u5668\uff08\u5305\u62ec\u6700\u5148\u8fdb\u7684 NCI\uff09\u7531\u4e8e\u7f3a\u4e4f\u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0\uff0c\u5728\u6307\u4ee4\u7ea7\u7c92\u5ea6\u4e0a\u5b58\u5728\u4e0d\u53ef\u5ffd\u89c6\u7684\u7cfb\u7edf\u6027\u8bef\u5dee\u3002 - TIP \u901a\u8fc7\u7ed3\u5408 Oracle \u7684\u7cbe\u786e\u5f52\u56e0\u903b\u8f91\u4e0e\u7edf\u8ba1\u91c7\u6837\uff0c\u6210\u529f\u5b9e\u73b0\u4e86\u9ad8\u7cbe\u5ea6\uff08\u5e73\u5747\u8bef\u5dee\u4ec5 1.6%\uff09\u4e0e\u5b9e\u7528\u6027\u7684\u7edf\u4e00\u3002 - TIP \u7684\u9ad8\u7cbe\u5ea6\u5bf9\u4e8e\u6307\u5bfc\u5f00\u53d1\u8005\u8fdb\u884c\u6df1\u5c42\u6b21\u7684\u6027\u80fd\u4f18\u5316\u81f3\u5173\u91cd\u8981\uff0c\u80fd\u591f\u63ed\u793a\u51fd\u6570\u7ea7\u6216\u57fa\u672c\u5757\u7ea7\u5256\u6790\u65e0\u6cd5\u53d1\u73b0\u7684\u3001\u7531\u7279\u5b9a\u6307\u4ee4\u5f15\u53d1\u7684\u6027\u80fd\u95ee\u9898\uff0c\u4ece\u800c\u5e26\u6765\u663e\u8457\u7684\u5b9e\u9645\u6027\u80fd\u6536\u76ca\u3002</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f\u4e0e\u52a8\u673a</p> <ul> <li>\u73b0\u4ee3\u9ad8\u6027\u80fd\u5904\u7406\u5668\u91c7\u7528\u9ad8\u5ea6\u5e76\u884c\u7684\u6267\u884c\u6a21\u578b\uff0c\u4f7f\u5f97\u5c06\u6267\u884c\u65f6\u95f4\u51c6\u786e\u5730\u5f52\u56e0\u4e8e\u5177\u4f53\u7684\u6307\u4ee4\u53d8\u5f97\u6781\u5176\u56f0\u96be\u3002</li> <li>\u4f20\u7edf\u7684 Software-level profiling\uff08\u5982 Linux perf\uff09\u5b58\u5728\u4e25\u91cd\u7684 skid \u95ee\u9898\uff0c\u5373\u91c7\u6837\u70b9\u4e0e\u5b9e\u9645\u9020\u6210\u6027\u80fd\u74f6\u9888\u7684\u6307\u4ee4\u76f8\u8ddd\u751a\u8fdc\u3002</li> <li>\u73b0\u6709\u7684\u786c\u4ef6\u8f85\u52a9\u6027\u80fd\u5206\u6790\u5668\uff08\u5982 Intel PEBS\u3001AMD IBS\u3001Arm SPE\uff09\u867d\u7136\u901a\u8fc7\u5728\u7279\u5b9a\u6d41\u6c34\u7ebf\u9636\u6bb5\uff08\u5982 Dispatch \u6216 Commit\uff09\u91c7\u6837\u6765\u7f13\u89e3 skid\uff0c\u4f46\u7f3a\u4e4f\u4e00\u4e2a\u201c\u9ec4\u91d1\u6807\u51c6\u201d\u6765\u8861\u91cf\u5176\u51c6\u786e\u6027\u3002</li> <li>\u4f5c\u8005\u6307\u51fa\uff0c\u8fd9\u4e9b\u73b0\u6709\u65b9\u6cd5\u7684\u6839\u672c\u7f3a\u9677\u5728\u4e8e\u5b83\u4eec\u4e0d\u662f time-proportional\uff08\u65f6\u95f4\u6bd4\u4f8b\uff09\u7684\uff0c\u5373\u672a\u80fd\u5c06\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u6b63\u786e\u5730\u5f52\u56e0\u4e8e\u5904\u7406\u5668\u66b4\u9732\u5176\u5ef6\u8fdf\u7684\u6307\u4ee4\u3002\u8fd9\u5bfc\u81f4\u4e86\u7cfb\u7edf\u6027\u7684\u9519\u8bef\u5f52\u56e0\uff0c\u4f8b\u5982\uff1a<ul> <li>\u65e0\u6cd5\u6b63\u786e\u5904\u7406 ILP\uff08Instruction-Level Parallelism\uff09\uff0c\u5c06\u5e76\u884c\u63d0\u4ea4\u7684\u591a\u6761\u6307\u4ee4\u7684\u6267\u884c\u65f6\u95f4\u9519\u8bef\u5730\u53ea\u5f52\u4e8e\u5176\u4e2d\u4e00\u6761\u3002</li> <li>\u5728\u5904\u7406\u5668\u56e0\u957f\u5ef6\u8fdf\u64cd\u4f5c\uff08\u5982\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u6216 pipeline flush\uff08\u6d41\u6c34\u7ebf\u51b2\u5237\uff09\u800c\u505c\u987f\u65f6\uff0c\u9519\u8bef\u5730\u5c06\u65f6\u95f4\u5f52\u56e0\u4e8e\u975e\u6839\u672c\u539f\u56e0\u7684\u6307\u4ee4\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 1: Instruction-level profle error of state-of-the-art profilers compared to our Time-Proportional Instruction Profiler(TIP).Existing profilers are inaccurate due to lack of ILP support and systematic latency misattribution.</p> <p>\u6838\u5fc3\u8d21\u732e</p> <ul> <li>\u63d0\u51fa\u4e86 Oracle profiler\uff1a\u4f5c\u4e3a\u6027\u80fd\u5206\u6790\u7684 golden reference\uff08\u9ec4\u91d1\u6807\u51c6\uff09\u3002Oracle \u901a\u8fc7\u5728 commit stage\uff08\u63d0\u4ea4\u9636\u6bb5\uff09\u5bf9\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u8fdb\u884c\u7cbe\u786e\u5f52\u56e0\uff0c\u786e\u4fdd\u4e86 time-proportional attribution\u3002\u5b83\u5b9a\u4e49\u4e86\u56db\u79cd\u6838\u5fc3\u72b6\u6001\uff08Computing, Stalled, Flushed, Drained\uff09\u6765\u5904\u7406\u5404\u79cd\u6267\u884c\u573a\u666f\u3002</li> <li>\u9996\u6b21\u91cf\u5316\u4e86\u73b0\u6709\u5206\u6790\u5668\u7684\u8bef\u5dee\uff1a\u5229\u7528 Oracle \u4f5c\u4e3a\u57fa\u51c6\uff0c\u8bba\u6587\u9996\u6b21\u7cfb\u7edf\u5730\u8bc4\u4f30\u4e86\u4e3b\u6d41\u5206\u6790\u5668\u7684\u6307\u4ee4\u7ea7\u7cbe\u5ea6\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a</li> </ul> Profiler Type Heuristic Avg. Instruction-Level Error Software Interrupt-based 61.8% Dispatch-tagging AMD IBS / Arm SPE 53.1% LCI Last-Committing Instruction 55.4% NCI Next-Committing Instruction (Intel PEBS) 9.3% <ul> <li>\u63d0\u51fa\u4e86 TIP (Time-Proportional Instruction Profiling)\uff1a\u4e00\u79cd\u517c\u5177\u9ad8\u7cbe\u5ea6\u548c\u5b9e\u7528\u6027\u7684\u65b0\u5206\u6790\u5668\u3002TIP \u7684\u6838\u5fc3\u601d\u60f3\u662f\u5c06 Oracle \u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\u4e0e statistical sampling\uff08\u7edf\u8ba1\u91c7\u6837\uff09\u76f8\u7ed3\u5408\u3002<ul> <li>TIP \u80fd\u591f\u6b63\u786e\u5904\u7406 ILP\uff0c\u5728\u591a\u6307\u4ee4\u5e76\u884c\u63d0\u4ea4\u65f6\u5c06\u65f6\u95f4\u5747\u5206\u3002</li> <li>TIP \u80fd\u591f\u6b63\u786e\u5f52\u56e0\u7531 stall\u3001flush \u548c drain \u5f15\u8d77\u7684\u5ef6\u8fdf\u5230\u6839\u672c\u539f\u56e0\u6307\u4ee4\u3002</li> <li>\u5b9e\u9a8c\u8868\u660e\uff0cTIP \u7684\u5e73\u5747\u6307\u4ee4\u7ea7\u8bef\u5dee\u4ec5\u4e3a 1.6%\uff08\u6700\u5927 5.0%\uff09\uff0c\u8fdc\u4f18\u4e8e\u6700\u5148\u8fdb\u7684 NCI\uff089.3%\uff09\u3002</li> </ul> </li> <li>\u901a\u8fc7\u5b9e\u9645\u6848\u4f8b\u9a8c\u8bc1\u4e86 TIP \u7684\u4ef7\u503c\uff1a\u5728 SPEC CPU2017 \u7684 Imagick \u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0cTIP \u6210\u529f\u5b9a\u4f4d\u5230\u56e0\u4e0d\u5fc5\u8981\u7684 Control Status Register (CSR) \u64cd\u4f5c\u5bfc\u81f4\u7684\u9891\u7e41\u6d41\u6c34\u7ebf\u51b2\u5237\u95ee\u9898\u3002\u901a\u8fc7\u4f18\u5316\uff08\u66ff\u6362\u4e3a nop\uff09\uff0c\u6027\u80fd\u63d0\u5347\u4e86 1.93\u00d7\uff0c\u800c NCI \u7684\u5206\u6790\u7ed3\u679c\u5219\u5177\u6709\u8bef\u5bfc\u6027\u3002</li> </ul> <p></p> <p>Figure 12:Function and instruction-level profiles for lmagick for TIP and NCI compared to Oracle.</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u6280\u672f\u67b6\u6784</p> <p>\u672c\u6587\u63d0\u51fa\u4e86\u4e00\u5957\u5b8c\u6574\u7684\u6027\u80fd\u5206\u6790\u6846\u67b6\uff0c\u5176\u6838\u5fc3\u76ee\u6807\u662f\u5b9e\u73b0\u65f6\u95f4\u6bd4\u4f8b\u6307\u4ee4\u5256\u6790 (Time-Proportional Instruction Profiling, TIP)\u3002\u8be5\u6846\u67b6\u7531\u4e00\u4e2a\u7406\u8bba\u4e0a\u7684\u9ec4\u91d1\u6807\u51c6\u548c\u4e00\u4e2a\u53ef\u5b9e\u9645\u90e8\u7f72\u7684\u5256\u6790\u5668\u6784\u6210\u3002</p> <ul> <li>Oracle Profiler (\u9ec4\u91d1\u6807\u51c6)<ul> <li>\u8fd9\u662f\u4e00\u4e2a\u4e0d\u53ef\u5b9e\u9645\u90e8\u7f72\u4f46\u6982\u5ff5\u4e0a\u5b8c\u7f8e\u7684\u5256\u6790\u5668\uff0c\u7528\u4e8e\u4e3a\u6240\u6709\u5176\u4ed6\u5256\u6790\u6280\u672f\u63d0\u4f9b\u51c6\u786e\u5ea6\u8bc4\u4f30\u7684\u57fa\u51c6\u3002</li> <li>\u5176\u6838\u5fc3\u539f\u5219\u662f\u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0 (time-proportional attribution)\uff1a\u5c06\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u7cbe\u786e\u5730\u5f52\u56e0\u4e8e\u5904\u7406\u5668\u5728\u8be5\u5468\u671f\u5185\u6240\u66b4\u9732\u5ef6\u8fdf\u7684\u6307\u4ee4\u3002</li> <li>Oracle \u901a\u8fc7\u76d1\u63a7\u5904\u7406\u5668\u7684 Reorder Buffer (ROB) \u63d0\u4ea4\u9636\u6bb5\u6765\u5de5\u4f5c\uff0c\u5e76\u6839\u636e ROB \u7684\u72b6\u6001\u5c06\u6bcf\u4e2a\u5468\u671f\u5212\u5206\u4e3a\u56db\u79cd\u57fa\u672c\u72b6\u6001\u8fdb\u884c\u5f52\u56e0\uff1a<ul> <li>Computing (\u8ba1\u7b97\u4e2d): \u5904\u7406\u5668\u6b63\u5728\u63d0\u4ea4\u6307\u4ee4\u3002Oracle \u5c06\u8be5\u5468\u671f\u5e73\u5747\u5206\u914d\u7ed9\u6240\u6709\u5728\u8be5\u5468\u671f\u63d0\u4ea4\u7684\u6307\u4ee4\uff08\u4f8b\u5982\uff0c\u5728\u4e00\u4e2a2-wide\u63d0\u4ea4\u7684\u5904\u7406\u5668\u4e2d\uff0c\u6bcf\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\u83b7\u5f970.5\u4e2a\u5468\u671f\uff09\u3002</li> <li>Stalled (\u505c\u6ede): ROB \u975e\u7a7a\u4f46\u65e0\u6cd5\u63d0\u4ea4\uff0c\u56e0\u4e3a\u961f\u9996\u6307\u4ee4\u5c1a\u672a\u6267\u884c\u5b8c\u6bd5\u3002Oracle \u5c06\u6574\u4e2a\u5468\u671f\u5f52\u56e0\u4e8e ROB \u961f\u9996\u7684\u6307\u4ee4\u3002</li> <li>Flushed (\u5df2\u51b2\u5237): ROB \u56e0\u9519\u8bef\u9884\u6d4b\uff08\u5982\u5206\u652f\u9884\u6d4b\u9519\u8bef\uff09\u800c\u53d8\u7a7a\u3002Oracle \u5c06\u51b2\u5237\u540e ROB \u4e3a\u7a7a\u7684\u5468\u671f\u5f52\u56e0\u4e8e\u5bfc\u81f4\u51b2\u5237\u7684\u6307\u4ee4\uff08\u5982\u9519\u8bef\u9884\u6d4b\u7684\u5206\u652f\uff09\u3002</li> <li>Drained (\u5df2\u6392\u7a7a): ROB \u56e0\u524d\u7aef\u505c\u987f\uff08\u5982\u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u800c\u53d8\u7a7a\u3002Oracle \u5c06\u6392\u7a7a\u671f\u95f4\u7684\u5468\u671f\u5f52\u56e0\u4e8e\u7b2c\u4e00\u4e2a\u91cd\u65b0\u586b\u5145 ROB \u7684\u6307\u4ee4\u3002</li> </ul> </li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 3: Oracle profiler clock cycle attribution overview.</p> <ul> <li>TIP (Time-Proportional Instruction Profiler)<ul> <li>TIP \u662f\u4e00\u4e2a\u53ef\u5b9e\u9645\u90e8\u7f72\u7684\u786c\u4ef6\u5256\u6790\u5668\uff0c\u5b83\u5c06 Oracle \u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\u4e0e\u7edf\u8ba1\u91c7\u6837 (statistical sampling) \u76f8\u7ed3\u5408\uff0c\u5728\u4fdd\u6301\u9ad8\u7cbe\u5ea6\u7684\u540c\u65f6\u5927\u5e45\u964d\u4f4e\u4e86\u6570\u636e\u5f00\u9500\u3002</li> <li>TIP \u7684\u786c\u4ef6\u67b6\u6784\u4f4d\u4e8e Performance Monitoring Unit (PMU) \u548c ROB \u4e4b\u95f4\uff0c\u4e3b\u8981\u5305\u542b\u4e24\u4e2a\u529f\u80fd\u5355\u5143\uff1a<ul> <li>Offending Instruction Register (OIR): \u6301\u7eed\u8ffd\u8e2a\u6700\u540e\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\u6216\u5bfc\u81f4\u5f02\u5e38/\u51b2\u5237\u7684\u6307\u4ee4\u3002</li> <li>Sample Selection Unit: \u6839\u636e\u5f53\u524d\u5904\u7406\u5668\u6838\u5fc3\u7684\u72b6\u6001\uff08\u901a\u8fc7\u68c0\u67e5 ROB \u548c OIR \u7684\u6807\u5fd7\u4f4d\uff09\u6765\u51b3\u5b9a\u91c7\u6837\u54ea\u4e2a\u6216\u54ea\u4e9b\u6307\u4ee4\u3002</li> </ul> </li> <li></li> </ul> </li> </ul> <p></p> <p>Figure 5: Structural overview of our Time-Proportional Instruction Profiler (TIP). TIP is triggered by the PMU,collects a sample,and finally exposes the sample to software.</p> <pre><code>-\n</code></pre> <p></p> <p>Figure 6: TIP sample selection logic.TIP classifies samples based on the the core state, ROB-flags,and OIR-flags.</p> <pre><code>- TIP \u7684\u91c7\u6837\u903b\u8f91\u4e25\u683c\u9075\u5faa Oracle \u7684\u56db\u79cd\u72b6\u6001\u5206\u7c7b\uff1a\n    - \u5728 **Computing** \u72b6\u6001\u4e0b\uff0c\u91c7\u6837\u6240\u6709\u5728\u8be5\u5468\u671f\u63d0\u4ea4\u7684\u6307\u4ee4\u3002\n    - \u5728 **Stalled** \u72b6\u6001\u4e0b\uff0c\u91c7\u6837 ROB \u961f\u9996\u7684\u6307\u4ee4\u3002\n    - \u5728 **Flushed/Drained** \u72b6\u6001\u4e0b\uff08ROB \u4e3a\u7a7a\uff09\uff0c\u4ece OIR \u4e2d\u91c7\u6837\u76f8\u5e94\u7684\u201c\u7f6a\u9b41\u7978\u9996\u201d\u6307\u4ee4\u3002\n- \u8f6f\u4ef6\u5c42\u9762\uff08\u5982 Linux `perf`\uff09\u901a\u8fc7\u8bfb\u53d6 TIP \u66b4\u9732\u7684 **Control and Status Registers (CSRs)** \u6765\u6536\u96c6\u6837\u672c\u3002\u540e\u5904\u7406\u7a0b\u5e8f\u4f1a\u6839\u636e\u6837\u672c\u4e2d\u7684\u6307\u4ee4\u6570\u91cf\uff08n\uff09\u5c06\u91c7\u6837\u95f4\u9694\u7684\u5468\u671f\u6570\u5e73\u5747\u5206\u914d\uff081/n\uff09\u7ed9\u6bcf\u4e2a\u88ab\u91c7\u6837\u7684\u6307\u4ee4\u5730\u5740\uff0c\u4ece\u800c\u6784\u5efa\u51fa\u6700\u7ec8\u7684\u6027\u80fd\u5256\u6790\u6587\u4ef6\u3002\n</code></pre> <p>\u5173\u952e\u521b\u65b0\u4e0e\u5bf9\u6bd4</p> <ul> <li>\u4e0e\u73b0\u6709\u5256\u6790\u5668\u7684\u6839\u672c\u533a\u522b\uff1a\u73b0\u6709\u5256\u6790\u5668\uff08\u5982 Intel PEBS \u7684 NCI, Arm CoreSight \u7684 LCI, AMD IBS \u7684 Dispatch-tagging\uff09\u5747\u4e0d\u6ee1\u8db3\u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0\u539f\u5219\uff0c\u4e3b\u8981\u95ee\u9898\u5728\u4e8e\uff1a<ul> <li>\u7f3a\u4e4f ILP (Instruction-Level Parallelism) \u652f\u6301\uff1a\u5728\u591a\u6307\u4ee4\u5e76\u884c\u63d0\u4ea4\u65f6\uff0c\u53ea\u5f52\u56e0\u4e8e\u5355\u4e2a\u6307\u4ee4\uff0c\u9020\u6210\u7cfb\u7edf\u6027\u504f\u5dee\u3002</li> <li>\u7cfb\u7edf\u6027\u5ef6\u8fdf\u8bef\u5f52\u56e0\uff1a\u4f8b\u5982\uff0cNCI \u4f1a\u5c06\u5206\u652f\u9884\u6d4b\u9519\u8bef\u540e\u7684\u51b2\u5237\u5ef6\u8fdf\u5f52\u56e0\u4e8e\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u800c\u975e\u9519\u8bef\u7684\u5206\u652f\u672c\u8eab\u3002</li> </ul> </li> <li>TIP \u7684\u4f18\u52bf\uff1a\u901a\u8fc7\u540c\u65f6\u89e3\u51b3 ILP \u5f52\u56e0\u548c\u7cfb\u7edf\u6027\u8bef\u5f52\u56e0\u95ee\u9898\uff0cTIP \u5b9e\u73b0\u4e86\u8fdc\u8d85\u73b0\u6709\u6280\u672f\u7684\u7cbe\u5ea6\u3002</li> </ul> <p></p> <p>Figure4:Exampleillustrating theOracle,NC1,andLCIprofilersona2-wideout-of-orderprocessor.NCIandLCIfallhortbeuse they do not account for ILPat the commit stage and misattribute pipeline stall,flush and/ordrain latencies.</p> <p>\u5b9e\u9a8c\u9a8c\u8bc1\u4e0e\u6027\u80fd\u5f00\u9500</p> <ul> <li>\u5b9e\u9a8c\u5e73\u53f0\uff1a\u5728 Berkeley Out-of-Order Machine (BOOM) RISC-V \u6838\u5fc3\u4e0a\u5b9e\u73b0\uff0c\u5e76\u4f7f\u7528 FireSim FPGA \u52a0\u901f\u4eff\u771f\u5668\u8fdb\u884c\u5168\u7cfb\u7edf\u8bc4\u4f30\u3002</li> <li>\u7cbe\u5ea6\u7ed3\u679c\uff1a\u5728 SPEC CPU2017 \u548c PARSEC \u57fa\u51c6\u6d4b\u8bd5\u96c6\u4e0a\uff0cTIP \u7684\u5e73\u5747\u6307\u4ee4\u7ea7\u5256\u6790\u8bef\u5dee\u4ec5\u4e3a 1.6%\uff0c\u8fdc\u4f4e\u4e8e NCI (9.3%)\u3001LCI (55.4%) \u548c Dispatch (53.1%)\u3002</li> <li>\u786c\u4ef6\u5f00\u9500\uff1a\u6781\u5176\u8f7b\u91cf\uff0c\u4ec5\u9700\u7ea6 57 \u5b57\u8282 \u7684\u989d\u5916\u5b58\u50a8\uff08\u7528\u4e8e OIR \u548c CSRs\uff09\u548c\u5c11\u91cf\u7ec4\u5408\u903b\u8f91\uff0c\u4e0d\u5728\u5173\u952e\u8def\u5f84\u4e0a\u3002</li> <li>\u6570\u636e\u901f\u7387\uff1a\u5728 4KHz \u91c7\u6837\u9891\u7387\u4e0b\uff0c\u6570\u636e\u751f\u6210\u901f\u7387\u4e3a 352 KB/s\uff0c\u76f8\u6bd4 NCI \u7684 224 KB/s \u4ec5\u6709\u8f7b\u5fae\u589e\u52a0\uff0c\u4e14\u5e26\u6765\u7684\u6027\u80fd\u5f00\u9500\u53ef\u5ffd\u7565\u4e0d\u8ba1\uff08\u7ea6 1.1%\uff09\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#1-oracle-profiler","title":"1. Oracle Profiler","text":"<p>Oracle Profiler \u7684\u8bbe\u8ba1\u539f\u7406\u4e0e\u6838\u5fc3\u673a\u5236</p> <ul> <li>Oracle Profiler \u88ab\u63d0\u51fa\u4f5c\u4e3a\u6027\u80fd\u5206\u6790\u9886\u57df\u7684 \u9ec4\u91d1\u53c2\u8003 (golden reference)\uff0c\u5176\u6838\u5fc3\u76ee\u6807\u662f\u5b9e\u73b0 \u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0 (time-proportional attribution)\u3002</li> <li>\u5176\u6839\u672c\u539f\u5219\u662f\uff1a\u6bcf\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u5fc5\u987b\u88ab\u7cbe\u786e\u5730\u5f52\u56e0\u4e8e\u5728\u8be5\u5468\u671f\u5185 \u5904\u7406\u5668\u6240\u66b4\u9732\u5ef6\u8fdf (exposes the latency of) \u7684\u6307\u4ee4\u3002</li> <li>\u8be5\u8bbe\u8ba1\u805a\u7126\u4e8e\u5904\u7406\u5668\u7684 \u63d0\u4ea4\u9636\u6bb5 (commit stage)\uff0c\u56e0\u4e3a\u8fd9\u662f\u6bcf\u6761\u6307\u4ee4\u7684\u5ef6\u8fdf\u6210\u672c\u6700\u7ec8\u88ab\u89e3\u51b3\u5e76\u5bf9\u5916\u53ef\u89c1\u7684\u5730\u65b9\u3002\u5f53\u6307\u4ee4\u65e0\u6cd5\u88ab\u5b8c\u5168\u9690\u85cf\u5176\u6267\u884c\u5ef6\u8fdf\u65f6\uff0c\u5b83\u4f1a\u963b\u585e \u91cd\u6392\u5e8f\u7f13\u51b2\u533a (ROB) \u7684\u5934\u90e8\uff0c\u4ece\u800c\u76f4\u63a5\u8d21\u732e\u4e8e\u7a0b\u5e8f\u7684\u603b\u6267\u884c\u65f6\u95f4\u3002</li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u56db\u79cd\u6838\u5fc3\u72b6\u6001</p> <p>Oracle Profiler \u901a\u8fc7\u76d1\u63a7\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u4e2d ROB \u548c\u5904\u7406\u5668\u7684\u72b6\u6001\uff0c\u5c06\u5176\u5212\u5206\u4e3a\u56db\u79cd\u4e92\u65a5\u72b6\u6001\uff0c\u5e76\u636e\u6b64\u8fdb\u884c\u5468\u671f\u5f52\u56e0\uff1a</p> <ul> <li>\u72b6\u60011: Computing (\u8ba1\u7b97\u4e2d)</li> <li>\u6761\u4ef6: ROB \u975e\u7a7a\uff0c\u4e14\u5904\u7406\u5668\u5728\u8be5\u5468\u671f\u6210\u529f\u63d0\u4ea4\u4e86 n \u6761\u6307\u4ee4\u3002</li> <li>\u5f52\u56e0\u7b56\u7565: \u5c06 1/n \u4e2a\u65f6\u949f\u5468\u671f \u5f52\u56e0\u4e8e\u6bcf\u4e00\u6761\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</li> <li> <p>\u76ee\u7684: \u6b63\u786e\u5904\u7406 \u6307\u4ee4\u7ea7\u5e76\u884c (ILP)\uff0c\u786e\u4fdd\u5e76\u884c\u63d0\u4ea4\u7684\u6307\u4ee4\u516c\u5e73\u5730\u5206\u62c5\u8be5\u5468\u671f\u7684\u65f6\u95f4\u6210\u672c\u3002</p> </li> <li> <p>\u72b6\u60012: Stalled (\u505c\u6ede)</p> </li> <li>\u6761\u4ef6: ROB \u975e\u7a7a\uff0c\u4f46\u5904\u7406\u5668\u5728\u8be5\u5468\u671f\u672a\u80fd\u63d0\u4ea4\u4efb\u4f55\u6307\u4ee4\uff08\u901a\u5e38\u662f\u56e0\u4e3a ROB \u5934\u90e8\u7684\u6307\u4ee4\u5c1a\u672a\u6267\u884c\u5b8c\u6bd5\uff09\u3002</li> <li>\u5f52\u56e0\u7b56\u7565: \u5c06 \u6574\u4e2a\u65f6\u949f\u5468\u671f \u5f52\u56e0\u4e8e ROB \u5934\u90e8\u7684\u6307\u4ee4\uff0c\u56e0\u4e3a\u6b63\u662f\u8fd9\u6761\u6307\u4ee4\u963b\u585e\u4e86\u63d0\u4ea4\u6d41\u6c34\u7ebf\u3002</li> <li> <p>\u76ee\u7684: \u7cbe\u786e\u6355\u83b7\u7531\u957f\u5ef6\u8fdf\u64cd\u4f5c\uff08\u5982\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u5f15\u8d77\u7684\u6027\u80fd\u74f6\u9888\u3002</p> </li> <li> <p>\u72b6\u60013: Flushed (\u51b2\u5237)</p> </li> <li>\u6761\u4ef6: ROB \u4e3a\u7a7a\uff0c\u539f\u56e0\u662f\u53d1\u751f\u4e86 \u63a8\u6d4b\u9519\u8bef (misspeculation)\uff08\u5982\u5206\u652f\u9884\u6d4b\u9519\u8bef\u3001\u5185\u5b58\u987a\u5e8f\u8fdd\u89c4\uff09\u6216 \u5f02\u5e38 (exception)\u3002</li> <li>\u5f52\u56e0\u7b56\u7565: <ul> <li>\u5bf9\u4e8e\u63a8\u6d4b\u9519\u8bef\uff0c\u5c06 ROB \u4e3a\u7a7a\u671f\u95f4\u7684\u6240\u6709\u5468\u671f\u5f52\u56e0\u4e8e \u5f15\u53d1\u51b2\u5237\u7684\u6307\u4ee4\uff08\u5982\u9884\u6d4b\u9519\u8bef\u7684\u5206\u652f\uff09\u3002</li> <li>\u5bf9\u4e8e\u5f02\u5e38\uff0c\u5c06\u4ece\u5f02\u5e38\u89e6\u53d1\u5230\u64cd\u4f5c\u7cfb\u7edf\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u7b2c\u4e00\u6761\u6307\u4ee4\u88ab\u8c03\u5ea6\u4e4b\u95f4\u7684\u6240\u6709\u5468\u671f\uff0c\u5f52\u56e0\u4e8e \u5f15\u53d1\u5f02\u5e38\u7684\u6307\u4ee4\u3002</li> </ul> </li> <li> <p>\u76ee\u7684: \u89e3\u51b3\u73b0\u6709\u5206\u6790\u5668\uff08\u5982 NCI\uff09\u5c06\u51b2\u5237\u540e\u7684\u7a7a\u95f2\u5468\u671f\u9519\u8bef\u5f52\u56e0\u4e8e\u540e\u7eed\u6307\u4ee4\u7684\u95ee\u9898\u3002</p> </li> <li> <p>\u72b6\u60014: Drained (\u6392\u7a7a)</p> </li> <li>\u6761\u4ef6: ROB \u4e3a\u7a7a\uff0c\u539f\u56e0\u662f \u524d\u7aef\u505c\u987f (front-end stall)\uff08\u5982\u6307\u4ee4\u7f13\u5b58\u6216 iTLB \u672a\u547d\u4e2d\uff09\uff0c\u800c\u975e\u63a8\u6d4b\u9519\u8bef\u3002</li> <li>\u5f52\u56e0\u7b56\u7565: \u5c06 ROB \u4e3a\u7a7a\u671f\u95f4\u7684\u6240\u6709\u5468\u671f\uff0c\u5f52\u56e0\u4e8e \u5728\u505c\u987f\u7ed3\u675f\u540e\u7b2c\u4e00\u6761\u8fdb\u5165 ROB \u7684\u6307\u4ee4\u3002\u56e0\u4e3a\u6b63\u662f\u8fd9\u6761\u6307\u4ee4\u7684\u7f3a\u5931\u5bfc\u81f4\u4e86\u524d\u7aef\u505c\u987f\u3002</li> <li>\u76ee\u7684: \u533a\u5206\u7531\u540e\u7aef\u8d44\u6e90\u4e89\u7528\u548c\u524d\u7aef\u4f9b\u7ed9\u4e0d\u8db3\u5bfc\u81f4\u7684\u6027\u80fd\u635f\u5931\u3002</li> </ul> <p></p> <p>Figure 3: Oracle profiler clock cycle attribution overview.</p> <p>\u4e0e\u73b0\u6709\u542f\u53d1\u5f0f\u65b9\u6cd5\u7684\u5bf9\u6bd4</p> <p></p> <p>Figure4:Exampleillustrating theOracle,NC1,andLCIprofilersona2-wideout-of-orderprocessor.NCIandLCIfallhortbeuse they do not account for ILPat the commit stage and misattribute pipeline stall,flush and/ordrain latencies.</p> <ul> <li>NCI (Next-Committing Instruction):</li> <li>\u5728 Flushed \u72b6\u6001\u4e0b\uff0c\u4f1a\u5c06\u7a7a\u95f2\u5468\u671f\u9519\u8bef\u5730\u5f52\u56e0\u4e8e\u4e0b\u4e00\u6761\u5c06\u8981\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u800c\u975e\u5f15\u53d1\u51b2\u5237\u7684\u7f6a\u9b41\u7978\u9996\u3002</li> <li> <p>\u5728 Computing \u72b6\u6001\u4e0b\uff0c\u53ea\u9009\u62e9\u4e00\u6761\u6307\u4ee4\u8fdb\u884c\u5f52\u56e0\uff0c\u5ffd\u7565\u4e86 ILP\uff0c\u5bfc\u81f4\u5f52\u56e0\u504f\u5dee\u3002</p> </li> <li> <p>LCI (Last-Committed Instruction):</p> </li> <li>\u5728 Stalled \u72b6\u6001\u4e0b\uff0c\u4f1a\u6301\u7eed\u5c06\u5468\u671f\u5f52\u56e0\u4e8e\u4e0a\u4e00\u6761\u5df2\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u800c\u975e\u5f53\u524d\u963b\u585e ROB \u5934\u90e8\u7684\u6307\u4ee4\u3002</li> <li> <p>\u5728 Drained \u72b6\u6001\u4e0b\uff0c\u540c\u6837\u4f1a\u9519\u8bef\u5730\u5f52\u56e0\u4e8e\u6700\u540e\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</p> </li> <li> <p>Dispatch-tagging (\u5982 AMD IBS):</p> </li> <li>\u5728\u6307\u4ee4 \u5206\u53d1 (dispatch) \u9636\u6bb5\u8fdb\u884c\u91c7\u6837\uff0c\u800c\u975e\u63d0\u4ea4\u9636\u6bb5\u3002\u8fd9\u4f1a\u5bfc\u81f4\u6307\u4ee4\u56e0\u540e\u7aef\u963b\u585e\u800c\u5806\u79ef\u5728\u5206\u53d1\u961f\u5217\u65f6\u88ab\u8fc7\u5ea6\u91c7\u6837\uff0c\u65e0\u6cd5\u53cd\u6620\u5176\u5bf9\u6267\u884c\u65f6\u95f4\u7684\u771f\u5b9e\u5f71\u54cd\u3002</li> </ul> <p>\u8f93\u5165\u3001\u8f93\u51fa\u53ca\u5728\u6574\u4f53\u7814\u7a76\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: \u5b8c\u6574\u7684\u3001\u5468\u671f\u7ea7\u7684\u5904\u7406\u5668\u5fae\u67b6\u6784\u72b6\u6001\u4fe1\u606f\uff0c\u5305\u62ec ROB \u4e2d\u6bcf\u6761\u6307\u4ee4\u7684\u72b6\u6001\uff08\u6709\u6548\u3001\u63d0\u4ea4\u3001\u5f02\u5e38\u3001\u51b2\u5237\u3001\u9884\u6d4b\u9519\u8bef\u7b49\uff09\u3001ROB \u5934\u5c3e\u6307\u9488\u4ee5\u53ca\u524d\u7aef\u72b6\u6001\u3002</li> <li>\u8f93\u51fa: \u4e00\u4e2a\u7406\u60f3\u7684\u3001\u65e0\u8bef\u5dee\u7684\u6027\u80fd\u5256\u6790\u6587\u4ef6\uff0c\u5176\u4e2d \u6bcf\u4e00\u4e2a\u52a8\u6001\u6307\u4ee4 \u90fd\u88ab\u7cbe\u786e\u5730\u5206\u914d\u4e86\u5176\u5e94\u5f97\u7684\u6267\u884c\u65f6\u95f4\uff08\u4ee5\u65f6\u949f\u5468\u671f\u4e3a\u5355\u4f4d\uff09\u3002</li> <li>\u5728\u6574\u4f53\u7814\u7a76\u4e2d\u7684\u4f5c\u7528:</li> <li>\u63d0\u4f9b\u8bc4\u4f30\u57fa\u51c6: Oracle \u662f\u8861\u91cf\u6240\u6709\u5176\u4ed6\u5b9e\u9645\u6027\u80fd\u5206\u6790\u5668\uff08\u5982 TIP, NCI, LCI\uff09\u51c6\u786e\u6027\u7684\u552f\u4e00\u53ef\u9760\u6807\u51c6\u3002</li> <li>\u91cf\u5316\u73b0\u6709\u65b9\u6cd5\u7684\u8bef\u5dee: \u901a\u8fc7\u4e0e Oracle \u5bf9\u6bd4\uff0c\u8bba\u6587\u9996\u6b21\u91cf\u5316\u4e86\u4e3b\u6d41\u5206\u6790\u5668\u7684\u7cfb\u7edf\u6027\u8bef\u5dee\uff0c\u4f8b\u5982 NCI \u5e73\u5747\u8bef\u5dee\u4e3a 9.3%\uff0c\u800c\u8f6f\u4ef6\u5206\u6790\u9ad8\u8fbe 61.8%\u3002</li> <li>\u6307\u5bfc\u65b0\u65b9\u6cd5\u8bbe\u8ba1: TIP \u7684\u8bbe\u8ba1\u76f4\u63a5\u7ee7\u627f\u4e86 Oracle \u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\uff0c\u8bc1\u660e\u4e86\u5176\u7406\u8bba\u6b63\u786e\u6027\u3002Oracle \u63ed\u793a\u7684\u95ee\u9898\uff08\u7f3a\u4e4f ILP \u652f\u6301\u3001\u7cfb\u7edf\u6027\u5ef6\u8fdf\u8bef\u5f52\u56e0\uff09\u6b63\u662f TIP \u65e8\u5728\u89e3\u51b3\u7684\u6838\u5fc3\u75db\u70b9\u3002</li> </ul>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#2-time-proportional-instruction-profiling-tip","title":"2. Time-Proportional Instruction Profiling (TIP)","text":"<p>TIP\u7684\u6838\u5fc3\u8bbe\u8ba1\u601d\u60f3</p> <ul> <li>TIP\u65e8\u5728\u89e3\u51b3\u73b0\u6709\u786c\u4ef6\u6027\u80fd\u5206\u6790\u5668\uff08\u5982Intel PEBS\u7684NCI\u3001AMD IBS\u7684Dispatch-tagging\u7b49\uff09\u56e0\u975e\u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0 (non-time-proportional attribution) \u800c\u5bfc\u81f4\u7684\u7cfb\u7edf\u6027\u8bef\u5dee\u3002</li> <li>\u5176\u6838\u5fc3\u662f\u5c06Oracle profiler\u7684\u7406\u60f3\u5316\u3001\u7cbe\u786e\u5230\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\uff0c\u4e0e\u7edf\u8ba1\u91c7\u6837 (statistical sampling) \u76f8\u7ed3\u5408\uff0c\u4ece\u800c\u5728\u4fdd\u6301\u6781\u9ad8\u7cbe\u5ea6\u7684\u540c\u65f6\uff0c\u5c06\u6570\u636e\u5f00\u9500\u4eceOracle\u7684179 GB/s\u964d\u4f4e\u5230\u5b9e\u7528\u7684192 KB/s\uff08\u57284KHz\u91c7\u6837\u7387\u4e0b\uff09\u3002</li> </ul> <p>Oracle Profiler\u7684\u65f6\u95f4\u5f52\u56e0\u7b56\u7565\u8be6\u89e3</p> <p>Oracle\u4f5c\u4e3a\u9ec4\u91d1\u6807\u51c6\uff0c\u5176\u65f6\u95f4\u5f52\u56e0\u57fa\u4e8e\u5904\u7406\u5668Commit\u9636\u6bb5\u7684\u56db\u79cd\u72b6\u6001\uff0c\u786e\u4fdd\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u88ab\u6b63\u786e\u5730\u5f52\u56e0\u4e8e\u9020\u6210\u8be5\u5468\u671f\u5ef6\u8fdf\u7684\u6307\u4ee4\u3002</p> <ul> <li>State 1: Computing (\u8ba1\u7b97\u72b6\u6001)</li> <li>\u5f53\u5904\u7406\u5668\u5728\u4e00\u4e2a\u5468\u671f\u5185\u63d0\u4ea4 <code>n</code> \u6761\u6307\u4ee4\u65f6\uff0cOracle\u5c06\u8be5\u5468\u671f\u5e73\u5747\u5206\u914d\uff0c\u5373\u6bcf\u6761\u6307\u4ee4\u83b7\u5f97 <code>1/n</code> \u4e2a\u5468\u671f\u3002</li> <li> <p>\u8fd9\u79cd\u65b9\u5f0f\u6b63\u786e\u5730\u5904\u7406\u4e86\u6307\u4ee4\u7ea7\u5e76\u884c (ILP)\uff0c\u907f\u514d\u4e86\u50cfNCI/LCI\u90a3\u6837\u53ea\u5c06\u6574\u4e2a\u5468\u671f\u5f52\u56e0\u4e8e\u5355\u6761\u6307\u4ee4\u7684\u504f\u5dee\u3002</p> </li> <li> <p>State 2: Stalled (\u505c\u987f\u72b6\u6001)</p> </li> <li>\u5f53ROB\uff08Reorder Buffer\uff09\u975e\u7a7a\u4f46\u65e0\u6cd5\u63d0\u4ea4\u6307\u4ee4\u65f6\uff0c\u8bf4\u660eROB\u5934\u90e8\u7684\u6307\u4ee4\u5c1a\u672a\u6267\u884c\u5b8c\u6bd5\uff0c\u5bfc\u81f4\u6d41\u6c34\u7ebf\u505c\u987f\u3002</li> <li> <p>Oracle\u5c06\u8be5\u5468\u671f\u5168\u90e8\u5f52\u56e0\u4e8eROB\u5934\u90e8\u7684\u6307\u4ee4\uff0c\u56e0\u4e3a\u6b63\u662f\u8fd9\u6761\u6307\u4ee4\u7684\u957f\u5ef6\u8fdf\uff08\u5982\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u963b\u585e\u4e86\u540e\u7eed\u63d0\u4ea4\u3002</p> </li> <li> <p>State 3: Flushed (\u51b2\u5237\u72b6\u6001)</p> </li> <li>\u5f53ROB\u56e0\u9519\u8bef\u9884\u6d4b\uff08\u5982\u5206\u652f\u9884\u6d4b\u9519\u8bef\uff09\u6216\u5f02\u5e38\u800c\u88ab\u6e05\u7a7a\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u6709\u4e00\u6bb5\u7a7a\u95f2\u671f\u3002</li> <li> <p>Oracle\u5c06\u8fd9\u6bb5\u7a7a\u95f2\u671f\u7684\u6240\u6709\u5468\u671f\u5f52\u56e0\u4e8e\u5f15\u53d1\u51b2\u5237\u7684\u90a3\u6761\u6307\u4ee4\uff08\u5982\u9519\u8bef\u9884\u6d4b\u7684\u5206\u652f\u6307\u4ee4\uff09\u3002</p> </li> <li> <p>State 4: Drained (\u6392\u7a7a\u72b6\u6001)</p> </li> <li>\u5f53ROB\u56e0\u524d\u7aef\u505c\u987f\uff08\u5982\u6307\u4ee4\u7f13\u5b58\u672a\u547d\u4e2d\uff09\u800c\u88ab\u6392\u7a7a\u65f6\uff0c\u5904\u7406\u5668\u540c\u6837\u4f1a\u7a7a\u95f2\u3002</li> <li>Oracle\u5c06\u8fd9\u6bb5\u7a7a\u95f2\u671f\u7684\u6240\u6709\u5468\u671f\u5f52\u56e0\u4e8e\u7b2c\u4e00\u4e2a\u56e0\u524d\u7aef\u505c\u987f\u800c\u672a\u80fd\u53ca\u65f6\u8fdb\u5165ROB\u7684\u6307\u4ee4\u3002</li> </ul> <p></p> <p>Figure 3: Oracle profiler clock cycle attribution overview.</p> <p>TIP\u7684\u5b9e\u73b0\u539f\u7406\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <p>TIP\u901a\u8fc7\u786c\u4ef6\u5355\u5143\u5b9e\u73b0\u4e86Oracle\u7b56\u7565\u7684\u91c7\u6837\u7248\u672c\uff0c\u5176\u7ed3\u6784\u4f4d\u4e8ePerformance Monitoring Unit (PMU) \u548c ROB \u4e4b\u95f4\u3002</p> <ul> <li>\u6838\u5fc3\u786c\u4ef6\u7ec4\u4ef6:</li> <li>Offending Instruction Register (OIR): \u6301\u7eed\u8ffd\u8e2a\u6700\u540e\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\uff08\u7528\u4e8eFlush/Drain\u72b6\u6001\uff09\u548c\u6700\u540e\u4e00\u4e2a\u89e6\u53d1\u5f02\u5e38\u7684\u6307\u4ee4\u3002</li> <li> <p>Sample Selection Unit: \u6839\u636e\u5f53\u524d\u5904\u7406\u5668\u72b6\u6001\uff0c\u51b3\u5b9a\u91c7\u6837\u54ea\u4e9b\u6307\u4ee4\u5730\u5740\u53ca\u5176\u6709\u6548\u4f4d\u3002</p> </li> <li> <p>\u91c7\u6837\u903b\u8f91\u6d41\u7a0b:</p> </li> <li>\u5f53ROB\u975e\u7a7a\u65f6:<ul> <li>TIP\u590d\u5236ROB\u5934\u90e8\uff08\u6700\u591a<code>b</code>\u6761\uff0c<code>b</code>\u4e3a\u63d0\u4ea4\u5bbd\u5ea6\uff09\u7684\u6307\u4ee4\u5730\u5740\u3002</li> <li>\u5982\u679c\u5f53\u524d\u5468\u671f\u6709\u6307\u4ee4\u63d0\u4ea4\uff08Computing\u72b6\u6001\uff09\uff0c\u5219\u6240\u6709\u63d0\u4ea4\u7684\u6307\u4ee4\u5730\u5740\u5747\u6709\u6548\u3002</li> <li>\u5982\u679c\u5f53\u524d\u5468\u671f\u65e0\u6307\u4ee4\u63d0\u4ea4\uff08Stalled\u72b6\u6001\uff09\uff0c\u5219\u53ea\u6709ROB\u6700\u8001\u7684\u90a3\u6761\u6307\u4ee4\u5730\u5740\u6709\u6548\u3002</li> </ul> </li> <li>\u5f53ROB\u4e3a\u7a7a\u65f6:<ul> <li>TIP\u4eceOIR\u4e2d\u8bfb\u53d6\u5730\u5740\u3002\u6839\u636eOIR\u4e2d\u7684\u6807\u5fd7\u4f4d\uff08\u5982<code>Exception</code>, <code>Flush</code>, <code>Mispredicted</code>\uff09\uff0c\u5224\u65ad\u662fFlush\u72b6\u6001\u8fd8\u662fDrain\u72b6\u6001\u3002</li> <li>\u5bf9\u4e8eDrain\u72b6\u6001\uff0cTIP\u4f1a\u7b49\u5f85\u7b2c\u4e00\u6761\u65b0\u6307\u4ee4\u88ab\u5206\u53d1\uff0c\u5e76\u5c06\u5176\u5730\u5740\u4f5c\u4e3a\u91c7\u6837\u76ee\u6807\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 5: Structural overview of our Time-Proportional Instruction Profiler (TIP). TIP is triggered by the PMU,collects a sample,and finally exposes the sample to software.</p> <p></p> <p>Figure 6: TIP sample selection logic.TIP classifies samples based on the the core state, ROB-flags,and OIR-flags.</p> <p>\u53c2\u6570\u8bbe\u7f6e\u4e0e\u786c\u4ef6\u5f00\u9500</p> <ul> <li>\u91c7\u6837\u9891\u7387: \u9ed8\u8ba4\u91c7\u7528Linux perf\u76844 KHz\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e1a\u754c\u901a\u7528\u7684\u5e73\u8861\u70b9\u3002</li> <li>\u786c\u4ef6\u5b58\u50a8\u5f00\u9500: \u5728\u4e00\u4e2a4-wide\u7684BOOM\u6838\u5fc3\u4e0a\uff0cTIP\u4ec5\u970057\u5b57\u8282\u7684\u989d\u5916\u5b58\u50a8\u3002</li> <li>OIR: 64-bit\u5730\u5740 + 3-bit\u6807\u5fd7 = 9\u5b57\u8282\u3002</li> <li>CSRs (Control and Status Registers): \u5305\u542bcycle\u8ba1\u6570\u5668\u3001flags\u548c4\u4e2a\u5730\u5740\u5bc4\u5b58\u5668\uff0c\u517148\u5b57\u8282\u3002</li> <li>\u6027\u80fd\u5f00\u9500: \u7531\u4e8e\u91c7\u6837\u6570\u636e\u91cf\u7565\u5927\uff0888\u5b57\u8282/\u6837\u672c vs PEBS\u9ed8\u8ba456\u5b57\u8282/\u6837\u672c\uff09\uff0c\u5728Intel Core i7-4770\u4e0a\u7684\u5b9e\u6d4b\u8fd0\u884c\u65f6\u5f00\u9500\u4ec5\u4e3a1.1%\uff0c\u4e0e\u5173\u95ed\u5206\u6790\u5668\u76f8\u6bd4\u51e0\u4e4e\u53ef\u4ee5\u5ffd\u7565\u3002</li> </ul> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6027\u80fd\u5206\u6790\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: </li> <li>\u6765\u81eaPMU\u7684\u5468\u671f\u6027\u91c7\u6837\u89e6\u53d1\u4fe1\u53f7\u3002</li> <li>\u6765\u81eaROB\u7684\u5934\u90e8\u6307\u4ee4\u5730\u5740\u3001\u63d0\u4ea4/\u6709\u6548\u4fe1\u53f7\u3001\u4ee5\u53ca\u5f02\u5e38/\u51b2\u5237\u7b49\u6807\u5fd7\u4f4d\u3002</li> <li>\u8f93\u51fa: </li> <li>\u4e00\u7ec4CSRs\uff0c\u5305\u542b\u91c7\u6837\u7684\u6307\u4ee4\u5730\u5740\uff08\u6700\u591a<code>b</code>\u4e2a\uff09\u3001\u5468\u671f\u8ba1\u6570\u5668\u3001\u4ee5\u53ca\u63cf\u8ff0\u5f53\u524d\u72b6\u6001\u7684\u6807\u5fd7\u4f4d\uff08\u5982<code>Stalled</code>, <code>Flush</code>\u7b49\uff09\u3002</li> <li>\u5728\u6574\u4f53\u6027\u80fd\u5206\u6790\u6d41\u7a0b\u4e2d\u7684\u4f5c\u7528:</li> <li>TIP\u7684\u786c\u4ef6\u5355\u5143\u8d1f\u8d23\u5728\u6bcf\u4e2a\u91c7\u6837\u70b9\u7cbe\u786e\u6355\u83b7\u7b26\u5408Oracle\u5f52\u56e0\u7b56\u7565\u7684\u6307\u4ee4\u4fe1\u606f\u3002</li> <li>\u8fd9\u4e9b\u539f\u59cb\u6837\u672c\u88abLinux perf\u7b49\u8f6f\u4ef6\u5de5\u5177\u6536\u96c6\u3002</li> <li>\u5728\u540e\u5904\u7406\u9636\u6bb5\uff0c\u8f6f\u4ef6\u6839\u636eTIP\u63d0\u4f9b\u7684\u5730\u5740\u548c\u6807\u5fd7\u4f4d\uff0c\u7ed3\u5408\u5e94\u7528\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u91cd\u5efa\u4e00\u4e2a\u9ad8\u5ea6\u51c6\u786e\u7684\u6027\u80fd\u5256\u6790\u62a5\u544a\u3002\u8be5\u62a5\u544a\u4e0d\u4ec5\u80fd\u6307\u51fa\u70ed\u70b9\u6307\u4ee4\uff0c\u8fd8\u80fd\u901a\u8fc7\u6807\u5fd7\u4f4d\u89e3\u91ca\u6027\u80fd\u74f6\u9888\u7684\u7c7b\u578b\uff08\u5982\u524d\u7aef\u505c\u987f\u3001\u540e\u7aef\u6267\u884c\u505c\u987f\u3001\u5206\u652f\u9519\u8bef\u9884\u6d4b\u7b49\uff09\u3002</li> </ul> <p>\u6027\u80fd\u8bc4\u4f30\u4e0e\u5173\u952e\u6307\u6807</p> <p>\u4e0b\u8868\u603b\u7ed3\u4e86\u4e0d\u540c\u5206\u6790\u5668\u5728\u6307\u4ee4\u7ea7\u5256\u6790\u4e0a\u7684\u5e73\u5747\u8bef\u5dee\uff0c\u51f8\u663e\u4e86TIP\u7684\u4f18\u8d8a\u6027\u3002</p> Profiler \u5e73\u5747\u6307\u4ee4\u7ea7\u8bef\u5dee \u6700\u5927\u8bef\u5dee \u76f8\u5bf9\u4e8eNCI\u7684\u8bef\u5dee\u964d\u4f4e\u500d\u6570 Software 61.8% - 38.6x Dispatch (IBS/SPE) 53.1% - 33.2x LCI 55.4% - 34.6x NCI (PEBS) 9.3% 21.0% 1.0x TIP 1.6% 5.0% 5.8x <p></p> <p>Figure 1: Instruction-level profle error of state-of-the-art profilers compared to our Time-Proportional Instruction Profiler(TIP).Existing profilers are inaccurate due to lack of ILP support and systematic latency misattribution.</p> <p>\u5b9e\u9645\u5e94\u7528\u4ef7\u503c</p> <ul> <li>TIP\u7684\u9ad8\u7cbe\u5ea6\u5728\u5b9e\u8df5\u4e2d\u81f3\u5173\u91cd\u8981\u3002\u5728SPEC CPU2017\u7684Imagick\u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff1a</li> <li>NCI\u9519\u8bef\u5730\u5c06\u6027\u80fd\u74f6\u9888\u5f52\u56e0\u4e8e<code>feq.d</code>\u548c<code>ret</code>\u6307\u4ee4\u3002</li> <li>TIP\u5219\u6b63\u786e\u5730\u8bc6\u522b\u51fa\u95ee\u9898\u6839\u6e90\u662f\u9891\u7e41\u6267\u884c\u7684CSR (Control Status Register) \u6307\u4ee4\uff08<code>frflags</code>/<code>fsflags</code>\uff09\uff0c\u8fd9\u4e9b\u6307\u4ee4\u5bfc\u81f4\u4e86\u4ee3\u4ef7\u9ad8\u6602\u7684pipeline flushes\u3002</li> <li>\u901a\u8fc7\u5c06\u8fd9\u4e9b\u4e0d\u5fc5\u8981\u7684CSR\u6307\u4ee4\u66ff\u6362\u4e3a<code>nop</code>\uff0c\u7a0b\u5e8f\u6027\u80fd\u83b7\u5f97\u4e861.93\u500d\u7684\u663e\u8457\u63d0\u5347\uff0c\u8fd9\u5145\u5206\u8bc1\u660e\u4e86TIP\u80fd\u591f\u53d1\u73b0\u5e76\u6307\u5bfc\u89e3\u51b3\u90a3\u4e9b\u88ab\u4f20\u7edf\u5206\u6790\u5668\u63a9\u76d6\u7684\u5173\u952e\u6027\u80fd\u95ee\u9898\u3002</li> </ul> <p></p> <p>Figure 12:Function and instruction-level profiles for lmagick for TIP and NCI compared to Oracle.</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#3-offending-instruction-register-oir","title":"3. Offending Instruction Register (OIR)","text":"<p>Offending Instruction Register (OIR) \u7684\u6838\u5fc3\u4f5c\u7528\u4e0e\u5b9e\u73b0\u539f\u7406</p> <ul> <li>OIR \u662f TIP \u786c\u4ef6 profiler \u4e2d\u7684\u4e00\u4e2a\u5173\u952e\u5bc4\u5b58\u5668\uff0c\u5176\u4e3b\u8981\u529f\u80fd\u662f\u5728 Reorder Buffer (ROB) \u4e3a\u7a7a\uff08\u5373\u5904\u4e8e Flushed \u6216 Drained \u72b6\u6001\uff09\u65f6\uff0c\u4e3a\u90a3\u4e9b\u65e0\u6cd5\u76f4\u63a5\u4ece ROB \u5934\u90e8\u83b7\u53d6\u7684\u201c\u7f6a\u9b41\u7978\u9996\u201d\u6307\u4ee4\u63d0\u4f9b\u4e00\u4e2a\u4e34\u65f6\u7684\u5b58\u50a8\u4f4d\u7f6e\uff0c\u4ece\u800c\u786e\u4fdd \u65f6\u95f4\u5f52\u56e0\u7684\u51c6\u786e\u6027\u3002</li> <li>\u5176\u8bbe\u8ba1\u52a8\u673a\u6e90\u4e8e Oracle Profiler \u7684\u5f52\u56e0\u7b56\u7565\uff1a\u5f53 ROB \u56e0\u9519\u8bef\u9884\u6d4b\u6216\u524d\u7aef\u505c\u987f\u800c\u53d8\u7a7a\u65f6\uff0c\u7a7a\u95f2\u5468\u671f\u5fc5\u987b\u5f52\u56e0\u4e8e\u5bfc\u81f4\u8be5\u72b6\u6001\u7684\u6839\u672c\u539f\u56e0\u6307\u4ee4\uff08\u5982 mispredicted branch\uff09\u6216\u9996\u4e2a\u6062\u590d\u6307\u4ee4\uff08\u5982 cache miss \u540e\u7684\u6307\u4ee4\uff09\uff0c\u800c\u975e\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6307\u4ee4\u3002</li> </ul> <p>OIR \u7684\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5de5\u4f5c\u903b\u8f91</p> <ul> <li>\u6301\u7eed\u8ffd\u8e2a\u673a\u5236\uff1a</li> <li>OIR Update \u5355\u5143\u5728\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u5904\u4e8e\u6fc0\u6d3b\u72b6\u6001\u3002</li> <li>\u5f53\u5904\u7406\u5668\u6b63\u5e38\u63d0\u4ea4\u6307\u4ee4\u65f6\uff0cOIR \u4f1a\u6301\u7eed\u66f4\u65b0\uff0c\u8bb0\u5f55\u4e0b\u5f53\u524d\u5468\u671f\u4e2d\u6700\u5e74\u8f7b\uff08youngest\uff09\u7684\u5df2\u63d0\u4ea4\u6307\u4ee4\u7684\u5730\u5740\u53ca\u5176\u76f8\u5173\u6807\u5fd7\u4f4d\u3002</li> <li> <p>\u8fd9\u4e9b\u6807\u5fd7\u4f4d\u81f3\u5173\u91cd\u8981\uff0c\u7528\u4e8e\u8bb0\u5f55\u8be5\u6307\u4ee4\u662f\u5426\u662f\u4e00\u4e2a mispredicted branch \u6216\u8005\u662f\u5426\u89e6\u53d1\u4e86\u67d0\u79cd\u5f62\u5f0f\u7684 pipeline flush\u3002</p> </li> <li> <p>\u5f02\u5e38\u5904\u7406\u8def\u5f84\uff1a</p> </li> <li>\u5982\u679c\u5904\u7406\u5668\u68c0\u6d4b\u5230\u5373\u5c06\u89e6\u53d1\u4e00\u4e2a\u5f02\u5e38\uff08exception\uff09\uff0cOIR Update \u5355\u5143\u4f1a\u7acb\u5373\u5c06\u5f15\u53d1\u5f02\u5e38\u7684\u6307\u4ee4\u5730\u5740\u548c\u4e00\u4e2a exception flag \u5199\u5165 OIR\u3002</li> <li> <p>\u8fd9\u786e\u4fdd\u4e86\u5728\u540e\u7eed\u56e0\u5904\u7406\u5f02\u5e38\u800c\u5bfc\u81f4 ROB \u4e3a\u7a7a\u7684\u5468\u671f\u91cc\uff0cTIP \u80fd\u591f\u6b63\u786e\u5730\u5c06\u8fd9\u4e9b\u5468\u671f\u5f52\u56e0\u4e8e\u8be5\u5f02\u5e38\u6307\u4ee4\u3002</p> </li> <li> <p>\u91c7\u6837\u51b3\u7b56\u4e2d\u7684\u5e94\u7528\uff1a</p> </li> <li>\u5f53 TIP \u7684 Sample Selection \u903b\u8f91\u68c0\u6d4b\u5230 ROB \u5934\u90e8\u7684\u6240\u6709\u6761\u76ee\u90fd\u65e0\u6548\uff08\u5373 ROB \u4e3a\u7a7a\uff09\u65f6\uff0c\u5b83\u4f1a\u8f6c\u5411 OIR \u83b7\u53d6\u4fe1\u606f\u3002</li> <li>\u6b64\u65f6\uff0cTIP \u4f1a\u5c06 OIR \u4e2d\u5b58\u50a8\u7684\u5730\u5740\u653e\u5165\u91c7\u6837\u8f93\u51fa\u7684\u5730\u5740\u5bc4\u5b58\u5668\uff08Address 0 CSR\uff09\u4e2d\u3002</li> <li>\u540c\u65f6\uff0cTIP \u4f1a\u6839\u636e OIR \u4e2d\u5b58\u50a8\u7684\u6807\u5fd7\u4f4d\uff0c\u8bbe\u7f6e\u5176\u81ea\u8eab\u7684\u72b6\u6001\u6807\u5fd7\uff08\u5982 Exception, Flush, \u6216 Mispredicted\uff09\uff0c\u4ee5\u660e\u786e\u6307\u793a\u5f53\u524d\u91c7\u6837\u6240\u5904\u7684\u5904\u7406\u5668\u72b6\u6001\uff08Flushed \u72b6\u6001\uff09\u3002</li> <li></li> </ul> <p></p> <p>Figure 6: TIP sample selection logic.TIP classifies samples based on the the core state, ROB-flags,and OIR-flags.</p> <p>OIR \u7684\u8f93\u5165\u3001\u8f93\u51fa\u53ca\u786c\u4ef6\u89c4\u683c</p> <ul> <li>\u8f93\u5165\uff1a</li> <li>\u6765\u81ea ROB \u7684\u4fe1\u606f\uff1a\u6bcf\u4e2a\u63d0\u4ea4\u69fd\u4f4d\u7684\u6307\u4ee4\u5730\u5740\u3001\u6709\u6548\u4f4d\u3001\u63d0\u4ea4\u4fe1\u53f7\uff0c\u4ee5\u53ca\u5173\u952e\u7684\u6307\u4ee4\u5c5e\u6027\u6807\u5fd7\uff08\u5982 mispredicted, flush, exception\uff09\u3002</li> <li> <p>\u6765\u81ea\u5904\u7406\u5668\u6838\u5fc3\u7684\u63a7\u5236\u4fe1\u53f7\uff1a\u7528\u4e8e\u5224\u65ad\u662f\u5426\u5373\u5c06\u53d1\u751f\u5f02\u5e38\u3002</p> </li> <li> <p>\u8f93\u51fa\uff1a</p> </li> <li>\u4e00\u4e2a 64 \u4f4d\u7684\u6307\u4ee4\u5730\u5740\u3002</li> <li> <p>\u4e00\u7ec4\u72b6\u6001\u6807\u5fd7\u4f4d\uff08\u8bba\u6587\u4e2d\u63d0\u5230\u4e3a 3-bit flag\uff09\uff0c\u7528\u4e8e\u7f16\u7801\u6307\u4ee4\u7c7b\u578b\uff08mispredicted, flush, exception\uff09\u3002</p> </li> <li> <p>\u786c\u4ef6\u5f00\u9500\uff1a</p> </li> <li>\u6839\u636e\u8bba\u6587 3.2 \u8282\u7684\u5206\u6790\uff0cOIR \u7684\u5b58\u50a8\u5f00\u9500\u6781\u5c0f\uff0c\u4ec5\u4e3a 9 \u5b57\u8282\uff0864-bit \u5730\u5740 + 3-bit \u6807\u5fd7\uff0c\u5728 RISC-V CSR \u7684 64-bit \u5bf9\u9f50\u8981\u6c42\u4e0b\uff09\u3002</li> <li>\u5176\u903b\u8f91\u590d\u6742\u5ea6\u4e5f\u5f88\u4f4e\uff0c\u4e3b\u8981\u6d89\u53ca\u591a\u8def\u9009\u62e9\u5668\uff08multiplexor\uff09\u6765\u9009\u62e9\u6700\u5e74\u8f7b\u7684\u63d0\u4ea4\u6307\u4ee4\u3002</li> </ul> <p>OIR \u5728 TIP \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u5b9a\u4f4d</p> <ul> <li>OIR \u662f\u8fde\u63a5 Oracle \u5f52\u56e0\u7406\u8bba\u4e0e\u5b9e\u9645\u786c\u4ef6\u91c7\u6837\u7684\u6865\u6881\u3002\u5b83\u4f7f\u5f97 TIP \u80fd\u591f\u5728\u4e0d\u8bb0\u5f55\u6bcf\u4e2a\u5468\u671f\u6240\u6709\u4fe1\u606f\uff08\u50cf Oracle \u90a3\u6837\u4ea7\u751f 179 GB/s \u6570\u636e\uff09\u7684\u524d\u63d0\u4e0b\uff0c\u4f9d\u7136\u80fd\u5904\u7406 ROB \u4e3a\u7a7a\u8fd9\u79cd\u590d\u6742\u573a\u666f\u3002</li> <li>\u5b83\u4e0e Sample Selection \u5355\u5143\u7d27\u5bc6\u534f\u4f5c\uff0c\u5171\u540c\u5b9e\u73b0\u4e86 Oracle \u5b9a\u4e49\u7684\u56db\u79cd\u6838\u5fc3\u72b6\u6001\uff08Computing, Stalled, Flushed, Drained\uff09\u4e0b\u7684\u7cbe\u786e\u65f6\u95f4\u5f52\u56e0\u3002</li> <li></li> </ul> <p></p> <p>Figure 5: Structural overview of our Time-Proportional Instruction Profiler (TIP). TIP is triggered by the PMU,collects a sample,and finally exposes the sample to software.</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#4-instruction-level-parallelism-ilp-aware-attribution","title":"4. Instruction-Level Parallelism (ILP) Aware Attribution","text":"<p>\u6838\u5fc3\u89c2\u70b9</p> <p>TIP (Time-Proportional Instruction Profiling) \u7684 ILP-Aware Attribution \u673a\u5236\u662f\u5176\u8d85\u8d8a\u73b0\u6709\u5206\u6790\u5668\uff08\u5982 NCI\u3001LCI\uff09\u51c6\u786e\u6027\u7684\u5173\u952e\u3002\u8be5\u673a\u5236\u786e\u4fdd\u5728\u5904\u7406\u5668\u5229\u7528\u6307\u4ee4\u7ea7\u5e76\u884c\u6027\uff08Instruction-Level Parallelism, ILP\uff09\u4e8e\u5355\u4e2a\u5468\u671f\u5185\u63d0\u4ea4\u591a\u6761\u6307\u4ee4\u65f6\uff0c\u6267\u884c\u65f6\u95f4\u80fd\u88ab\u516c\u5e73\u3001\u51c6\u786e\u5730\u5206\u914d\u7ed9\u6240\u6709\u53c2\u4e0e\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u800c\u975e\u6b66\u65ad\u5730\u5f52\u56e0\u4e8e\u5176\u4e2d\u67d0\u4e00\u6761\u3002</p> <ul> <li> <p>\u6839\u672c\u95ee\u9898: \u73b0\u6709\u786c\u4ef6\u5206\u6790\u5668\uff08\u5982 Intel PEBS \u7684 NCI \u548c\u5916\u90e8\u76d1\u63a7\u5668\u7684 LCI\uff09\u5728\u91c7\u6837\u65f6\uff0c\u5373\u4f7f\u4e00\u4e2a\u5468\u671f\u5185\u6709 <code>n</code> \u6761\u6307\u4ee4\u540c\u65f6\u63d0\u4ea4\uff0c\u4e5f\u53ea\u4f1a\u9009\u62e9\u5176\u4e2d\u4e00\u6761\uff08\u4e0b\u4e00\u6761\u6216\u4e0a\u4e00\u6761\uff09\u4f5c\u4e3a\u8be5\u5468\u671f\u7684\u201c\u4ee3\u8868\u201d\u3002\u8fd9\u5bfc\u81f4\u4e86\u4e25\u91cd\u7684\u7cfb\u7edf\u6027\u504f\u5dee\uff1a</p> <ul> <li>\u88ab\u9009\u4e2d\u7684\u6307\u4ee4\u88ab\u8fc7\u5ea6\u5f52\u56e0\uff08over-attributed\uff09\u3002</li> <li>\u672a\u88ab\u9009\u4e2d\u7684\u6307\u4ee4\u5219\u88ab\u5b8c\u5168\u5ffd\u7565\uff0c\u5373\u4f7f\u5b83\u4eec\u6d88\u8017\u4e86\u76f8\u540c\u7684\u5904\u7406\u5668\u8d44\u6e90\u548c\u65f6\u95f4\u3002</li> <li>\u5728\u9ad8\u5ea6\u5e76\u884c\u5316\u7684\u4ee3\u7801\u533a\u57df\uff0c\u8fd9\u79cd\u504f\u5dee\u4f1a\u7d2f\u79ef\uff0c\u4f7f\u5f97\u6027\u80fd\u753b\u50cf\u5931\u771f\uff0c\u8bef\u5bfc\u5f00\u53d1\u8005\u3002</li> </ul> </li> <li> <p>TIP \u7684\u89e3\u51b3\u65b9\u6848: TIP \u4e25\u683c\u9075\u5faa\u5176 Oracle \u9ec4\u91d1\u6807\u51c6\u7684\u6307\u5bfc\u539f\u5219\uff0c\u5728\u201cComputing State\u201d\uff08\u8ba1\u7b97\u72b6\u6001\uff09\u4e0b\uff0c\u5c06\u4e00\u4e2a\u91c7\u6837\u5468\u671f\u7684\u65f6\u95f4\u5e73\u5747\u5206\u914d\u7ed9\u8be5\u5468\u671f\u5185\u6240\u6709\u6210\u529f\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</p> <ul> <li>\u5982\u679c\u4e00\u4e2a\u5468\u671f\u63d0\u4ea4\u4e86 <code>n</code> \u6761\u6307\u4ee4\uff0c\u5219\u6bcf\u6761\u6307\u4ee4\u88ab\u5f52\u56e0 <code>1/n</code> \u4e2a\u5468\u671f\u3002</li> <li>\u8fd9\u79cd\u505a\u6cd5\u76f4\u63a5\u53cd\u6620\u4e86\u5904\u7406\u5668\u7684\u771f\u5b9e\u884c\u4e3a\uff1a<code>n</code> \u6761\u6307\u4ee4\u5171\u4eab\u4e86\u540c\u4e00\u4e2a\u5468\u671f\u7684\u6267\u884c\u5e26\u5bbd\uff0c\u56e0\u6b64\u5bf9\u603b\u6267\u884c\u65f6\u95f4\u7684\u8d21\u732e\u4e5f\u5e94\u5747\u7b49\u3002</li> </ul> </li> </ul> <p></p> <p>Figure4:Exampleillustrating theOracle,NC1,andLCIprofilersona2-wideout-of-orderprocessor.NCIandLCIfallhortbeuse they do not account for ILPat the commit stage and misattribute pipeline stall,flush and/ordrain latencies.</p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u5b9e\u73b0\u7ec6\u8282</p> <p>TIP \u7684 ILP-Aware \u5f52\u56e0\u903b\u8f91\u7d27\u5bc6\u96c6\u6210\u5728\u5176\u91c7\u6837\u9009\u62e9\u5355\u5143\uff08Sample Selection Unit\uff09\u4e2d\uff0c\u5177\u4f53\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u72b6\u6001\u68c0\u6d4b: TIP \u9996\u5148\u901a\u8fc7\u68c0\u67e5\u5904\u7406\u5668\u7684 Stalled \u6807\u5fd7\u4f4d\u6765\u5224\u65ad\u5f53\u524d\u5468\u671f\u7684\u72b6\u6001\u3002<ul> <li>\u5982\u679c Stalled == 0\uff0c\u5219\u5904\u7406\u5668\u5904\u4e8e Computing State\uff0c\u5373\u6b63\u5728\u63d0\u4ea4\u6307\u4ee4\u3002</li> </ul> </li> <li>\u6307\u4ee4\u5730\u5740\u6355\u83b7: \u5728 Computing State \u4e0b\uff0cTIP \u4f1a\u4ece Reorder Buffer (ROB) \u7684\u5934\u90e8\u8bfb\u53d6\u6700\u591a <code>b</code> \u4e2a\uff08<code>b</code> \u4e3a\u5904\u7406\u5668\u63d0\u4ea4\u5bbd\u5ea6\uff09\u6307\u4ee4\u5730\u5740\uff0c\u5e76\u5c06\u5b83\u4eec\u5b58\u5165\u5176\u5185\u90e8\u7684\u5730\u5740\u5bc4\u5b58\u5668\uff08Address CSRs\uff09\u4e2d\u3002</li> <li>\u6709\u6548\u4f4d\u6807\u8bb0: TIP \u540c\u65f6\u4f1a\u6839\u636e\u5b9e\u9645\u63d0\u4ea4\u7684\u6307\u4ee4\u6570\u91cf\uff0c\u8bbe\u7f6e\u5bf9\u5e94\u5730\u5740\u5bc4\u5b58\u5668\u7684 valid bits\u3002\u4f8b\u5982\uff0c\u5728\u4e00\u4e2a 4-wide \u7684 BOOM \u6838\u5fc3\u4e2d\uff0c\u5982\u679c\u67d0\u5468\u671f\u53ea\u63d0\u4ea4\u4e86 2 \u6761\u6307\u4ee4\uff0c\u5219\u53ea\u6709\u524d\u4e24\u4e2a\u5730\u5740\u5bc4\u5b58\u5668\u7684 valid bit \u4f1a\u88ab\u7f6e\u4e3a 1\u3002</li> <li>\u540e\u5904\u7406\u5f52\u56e0: \u5f53\u6027\u80fd\u5206\u6790\u8f6f\u4ef6\uff08\u5982 Linux perf\uff09\u5728\u5e94\u7528\u7ed3\u675f\u540e\u8fdb\u884c\u753b\u50cf\u6784\u5efa\u65f6\uff0c\u5b83\u4f1a\u8bfb\u53d6 TIP \u7684\u539f\u59cb\u91c7\u6837\u6570\u636e\u3002<ul> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u91c7\u6837\u70b9\uff0c\u8f6f\u4ef6\u4f1a\u7edf\u8ba1\u5176\u4e2d\u6709\u6548\u7684\u6307\u4ee4\u5730\u5740\u6570\u91cf <code>n</code>\u3002</li> <li>\u7136\u540e\uff0c\u5c06\u8be5\u91c7\u6837\u70b9\u6240\u4ee3\u8868\u7684\u5468\u671f\u6570\uff08\u901a\u5e38\u7531 PMU \u7684\u5468\u671f\u8ba1\u6570\u5668\u63d0\u4f9b\uff09\u5e73\u5747\u5206\u4e3a <code>n</code> \u4efd\uff0c\u5e76\u5206\u522b\u7d2f\u52a0\u5230\u8fd9 <code>n</code> \u6761\u6307\u4ee4\u5404\u81ea\u7684\u8ba1\u6570\u5668\u4e2d\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 6: TIP sample selection logic.TIP classifies samples based on the the core state, ROB-flags,and OIR-flags.</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u6574\u4f53\u4f5c\u7528</p> <ul> <li>\u8f93\u5165:<ul> <li>\u5904\u7406\u5668 ROB \u5728\u6bcf\u4e2a\u5468\u671f\u7684\u63d0\u4ea4\u4fe1\u53f7\uff08commit signals\uff09\u548c\u6709\u6548\u4fe1\u53f7\uff08valid signals\uff09\u3002</li> <li>\u6027\u80fd\u76d1\u63a7\u5355\u5143\uff08PMU\uff09\u89e6\u53d1\u7684\u91c7\u6837\u4e8b\u4ef6\u3002</li> </ul> </li> <li>\u8f93\u51fa:<ul> <li>\u4e00\u4e2a\u5305\u542b\u591a\u4e2a\u6307\u4ee4\u5730\u5740\u3001\u4e00\u4e2a\u5468\u671f\u8ba1\u6570\u5668\u503c\u548c\u72b6\u6001\u6807\u5fd7\u4f4d\u7684\u590d\u5408\u91c7\u6837\u8bb0\u5f55\u3002</li> </ul> </li> <li>\u5728 TIP \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:<ul> <li>\u6d88\u9664 ILP \u504f\u5dee: \u8fd9\u662f TIP \u5b9e\u73b0 time-proportional attribution\uff08\u65f6\u95f4\u6bd4\u4f8b\u5f52\u56e0\uff09\u7684\u6838\u5fc3\u652f\u67f1\u4e4b\u4e00\u3002\u5b83\u786e\u4fdd\u4e86\u753b\u50cf\u7684\u51c6\u786e\u6027\uff0c\u5c24\u5176\u662f\u5728 Compute-Intensive\uff08\u8ba1\u7b97\u5bc6\u96c6\u578b\uff09\u7684\u57fa\u51c6\u6d4b\u8bd5\u4e2d\uff0c\u8fd9\u7c7b\u7a0b\u5e8f\u5927\u91cf\u4f9d\u8d56 ILP \u6765\u63d0\u5347\u6027\u80fd\u3002</li> <li>\u63d0\u4f9b\u7ec6\u7c92\u5ea6\u6d1e\u5bdf: \u901a\u8fc7\u516c\u5e73\u5730\u5f52\u56e0\u65f6\u95f4\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u6e05\u6670\u5730\u770b\u5230\u54ea\u4e9b\u6307\u4ee4\u5e8f\u5217\u771f\u6b63\u6784\u6210\u4e86\u6027\u80fd\u74f6\u9888\uff0c\u800c\u4e0d\u662f\u88ab\u5206\u6790\u5668\u7684\u542f\u53d1\u5f0f\u7b56\u7565\u6240\u8bef\u5bfc\u3002</li> <li>\u652f\u6491\u9ad8\u7cbe\u5ea6\u4f18\u5316: \u5982\u8bba\u6587\u4e2d\u7684 Imagick \u6848\u4f8b\u6240\u793a\uff0c\u51c6\u786e\u7684\u6307\u4ee4\u7ea7\u753b\u50cf\u80fd\u591f\u63ed\u793a\u51fa\u51fd\u6570\u7ea7\u6216\u57fa\u672c\u5757\u7ea7\u753b\u50cf\u65e0\u6cd5\u53d1\u73b0\u7684\u6df1\u5c42\u6b21\u6027\u80fd\u95ee\u9898\u3002</li> </ul> </li> </ul> <p>\u5b9e\u8bc1\u6548\u679c\u5bf9\u6bd4</p> <p>\u4e0b\u8868\u5c55\u793a\u4e86\u4e0d\u540c\u5206\u6790\u5668\u5728\u6307\u4ee4\u7ea7\u753b\u50cf\u4e0a\u7684\u5e73\u5747\u8bef\u5dee\uff0c\u7a81\u663e\u4e86 ILP-Aware \u5f52\u56e0\u7684\u5de8\u5927\u4ef7\u503c\u3002</p> Profiler \u5e73\u5747\u6307\u4ee4\u7ea7\u753b\u50cf\u8bef\u5dee \u4e0e TIP \u7684\u8bef\u5dee\u500d\u6570 TIP 1.6% 1.0x TIP-ILP (\u65e0 ILP \u652f\u6301\u7684 TIP) 7.2% 4.5x NCI (Intel PEBS) 9.3% 5.8x LCI 55.4% 34.6x Dispatch (AMD IBS / Arm SPE) 53.1% 33.2x Software 61.8% 38.6x <p>\u8be5\u6570\u636e\u660e\u786e\u8868\u660e\uff0c\u4ec5\u901a\u8fc7\u5f15\u5165 ILP-Aware Attribution\uff08\u4ece TIP-ILP \u5230 TIP\uff09\uff0c\u5e73\u5747\u8bef\u5dee\u5c31\u4ece 7.2% \u5927\u5e45\u964d\u4f4e\u81f3 1.6%\uff0c\u8bc1\u660e\u4e86\u6b64\u673a\u5236\u7684\u6709\u6548\u6027\u548c\u5fc5\u8981\u6027\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u8bd5\u56fe\u5c06 ILP \u652f\u6301\u7b80\u5355\u5730\u5ac1\u63a5\u5230\u9519\u8bef\u7684\u5f52\u56e0\u7b56\u7565\u4e0a\uff08\u5982 NCI+ILP\uff09\u4e0d\u4ec5\u65e0\u6548\uff0c\u53cd\u800c\u4f1a\u4f7f\u8bef\u5dee\u6076\u5316\u81f3 19.3%\uff0c\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u4e86 TIP \u5f52\u56e0\u7b56\u7565\u7684\u6b63\u786e\u6027\u3002</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#5-four-state-commit-stage-model","title":"5. Four-State Commit Stage Model","text":"<p>Four-State Commit Stage Model \u7684\u5b9e\u73b0\u539f\u7406\u4e0e\u7b97\u6cd5\u6d41\u7a0b</p> <p>Oracle Profiler \u7684\u6838\u5fc3\u5728\u4e8e\u5176 Four-State Commit Stage Model\uff0c\u8be5\u6a21\u578b\u901a\u8fc7\u7cbe\u786e\u8bc6\u522b\u5904\u7406\u5668\u63d0\u4ea4\u9636\u6bb5\uff08Commit Stage\uff09\u7684\u56db\u79cd\u57fa\u672c\u72b6\u6001\uff0c\u4e3a\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u63d0\u4f9b\u65f6\u95f4-\u6307\u4ee4\u7684\u7cbe\u51c6\u5f52\u56e0\u3002TIP \u7ee7\u627f\u4e86\u8fd9\u4e00\u539f\u5219\u6027\u903b\u8f91\uff0c\u5e76\u901a\u8fc7\u91c7\u6837\u4f7f\u5176\u5177\u5907\u5b9e\u7528\u6027\u3002</p> <ul> <li>State 1: Computing (\u8ba1\u7b97\u72b6\u6001)<ul> <li>\u89e6\u53d1\u6761\u4ef6: Reorder Buffer (ROB) \u975e\u7a7a\uff0c\u4e14\u5728\u5f53\u524d\u5468\u671f\u6709\u6307\u4ee4\u88ab\u63d0\u4ea4\u3002</li> <li>\u5f52\u56e0\u903b\u8f91: \u5c06\u5f53\u524d\u5468\u671f\u7684\u65f6\u95f4\u5e73\u5747\u5206\u914d\u7ed9\u6240\u6709\u5728\u8be5\u5468\u671f\u63d0\u4ea4\u7684\u6307\u4ee4\u3002\u4f8b\u5982\uff0c\u5728\u4e00\u4e2a 2-wide commit \u7684\u5904\u7406\u5668\u4e2d\uff0c\u82e5\u6307\u4ee4 I1 \u548c I2 \u540c\u65f6\u63d0\u4ea4\uff0c\u5219\u5404\u81ea\u88ab\u5f52\u56e0 0.5 cycles\u3002</li> <li>\u5173\u952e\u6d1e\u5bdf: \u6b64\u903b\u8f91\u6b63\u786e\u5904\u7406\u4e86 Instruction-Level Parallelism (ILP)\uff0c\u786e\u4fdd\u5e76\u884c\u63d0\u4ea4\u7684\u6307\u4ee4\u90fd\u80fd\u83b7\u5f97\u516c\u5e73\u7684\u65f6\u95f4\u5f52\u56e0\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0cNCI \u548c LCI \u7b49\u542f\u53d1\u5f0f\u65b9\u6cd5\u4ec5\u9009\u62e9\u5355\u4e2a\u6307\u4ee4\uff0c\u5bfc\u81f4\u7cfb\u7edf\u6027\u504f\u5dee\u3002</li> <li></li> </ul> </li> </ul> <p></p> <p>Figure4:Exampleillustrating theOracle,NC1,andLCIprofilersona2-wideout-of-orderprocessor.NCIandLCIfallhortbeuse they do not account for ILPat the commit stage and misattribute pipeline stall,flush and/ordrain latencies.</p> <ul> <li> <p>State 2: Stalled (\u963b\u585e\u72b6\u6001)</p> <ul> <li>\u89e6\u53d1\u6761\u4ef6: ROB \u975e\u7a7a\uff0c\u4f46\u5728\u5f53\u524d\u5468\u671f\u6ca1\u6709\u6307\u4ee4\u88ab\u63d0\u4ea4\u3002</li> <li>\u5f52\u56e0\u903b\u8f91: \u5c06\u6574\u4e2a\u5468\u671f\u7684\u65f6\u95f4\u5f52\u56e0\u4e8e ROB \u5934\u90e8\uff08oldest entry\uff09\u7684\u6307\u4ee4\u3002\u8be5\u6307\u4ee4\u901a\u5e38\u662f\u957f\u5ef6\u8fdf\u64cd\u4f5c\uff08\u5982 LLC miss \u7684 load \u6307\u4ee4\uff09\uff0c\u5b83\u963b\u585e\u4e86\u540e\u7eed\u6307\u4ee4\u7684\u63d0\u4ea4\uff0c\u662f\u6027\u80fd\u74f6\u9888\u7684\u76f4\u63a5\u4f53\u73b0\u3002</li> <li>\u5173\u952e\u6d1e\u5bdf: \u8fd9\u662f\u65f6\u95f4\u5f52\u56e0\u7684\u6838\u5fc3\u539f\u5219\u2014\u2014\u5c06\u65f6\u95f4\u5f52\u56e0\u4e8e\u201c\u66b4\u9732\u5ef6\u8fdf\u201d\u7684\u6307\u4ee4\u3002LCI \u5728\u6b64\u72b6\u6001\u4e0b\u4f1a\u9519\u8bef\u5730\u5c06\u6301\u7eed\u5f52\u56e0\u4e8e\u4e0a\u4e00\u4e2a\u5df2\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u800c NCI \u5219\u4f1a\u5728 stall \u7ed3\u675f\u540e\u7684\u7b2c\u4e00\u4e2a\u63d0\u4ea4\u5468\u671f\u624d\u5f00\u59cb\u5f52\u56e0\uff0c\u5747\u65e0\u6cd5\u51c6\u786e\u53cd\u6620 stall \u7684\u771f\u5b9e\u6210\u672c\u3002</li> </ul> </li> <li> <p>State 3: Flushed (\u51b2\u5237\u72b6\u6001)</p> <ul> <li>\u89e6\u53d1\u6761\u4ef6: ROB \u4e3a\u7a7a\uff0c\u4e14\u662f\u7531\u4e8e \u9519\u8bef\u9884\u6d4b\uff08misprediction\uff09\u6216\u5f02\u5e38\uff08exception\uff09 \u5bfc\u81f4\u7684\u6d41\u6c34\u7ebf\u51b2\u5237\u3002</li> <li>\u5f52\u56e0\u903b\u8f91: <ul> <li>\u5bf9\u4e8e \u5206\u652f\u8bef\u9884\u6d4b\uff0c\u5c06 ROB \u4e3a\u7a7a\u671f\u95f4\u7684\u6240\u6709\u5468\u671f\u5f52\u56e0\u4e8e \u5bfc\u81f4\u51b2\u5237\u7684\u5206\u652f\u6307\u4ee4\u3002</li> <li>\u5bf9\u4e8e \u5f02\u5e38\uff08\u5982 page fault\uff09\uff0c\u5c06\u4ece\u5f02\u5e38\u89e6\u53d1\u5230\u64cd\u4f5c\u7cfb\u7edf\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u7b2c\u4e00\u6761\u6307\u4ee4\u88ab\u5206\u53d1\u4e4b\u95f4\u7684\u6240\u6709\u5468\u671f\uff0c\u5f52\u56e0\u4e8e \u5f15\u53d1\u5f02\u5e38\u7684\u6307\u4ee4\u3002</li> </ul> </li> <li>\u5173\u952e\u6d1e\u5bdf: NCI \u5728\u6b64\u72b6\u6001\u4e0b\u8868\u73b0\u6781\u5dee\uff0c\u56e0\u4e3a\u5b83\u4f1a\u5c06\u51b2\u5237\u540e ROB \u4e3a\u7a7a\u7684\u5468\u671f\u5f52\u56e0\u4e8e\u4e0b\u4e00\u4e2a\u5c06\u8981\u63d0\u4ea4\u7684\u6307\u4ee4\uff08\u5373\u51b2\u5237\u540e\u8def\u5f84\u4e0a\u7684\u7b2c\u4e00\u6761\u6307\u4ee4\uff09\uff0c\u5b8c\u5168\u63a9\u76d6\u4e86\u51b2\u5237\u7684\u6839\u672c\u539f\u56e0\u3002</li> </ul> </li> <li> <p>State 4: Drained (\u6392\u7a7a\u72b6\u6001)</p> <ul> <li>\u89e6\u53d1\u6761\u4ef6: ROB \u4e3a\u7a7a\uff0c\u4e14\u662f\u7531\u4e8e \u524d\u7aef\u505c\u987f\uff08\u5982 instruction cache miss \u6216 iTLB miss\uff09\u5bfc\u81f4\uff0c\u800c\u975e\u51b2\u5237\u3002</li> <li>\u5f52\u56e0\u903b\u8f91: \u5c06 ROB \u4e3a\u7a7a\u671f\u95f4\u7684\u6240\u6709\u5468\u671f\u5f52\u56e0\u4e8e \u5728\u505c\u987f\u7ed3\u675f\u540e\u7b2c\u4e00\u4e2a\u8fdb\u5165 ROB \u7684\u6307\u4ee4\u3002\u56e0\u4e3a\u6b63\u662f\u8fd9\u6761\u6307\u4ee4\u7684\u7f3a\u5931\uff08\u6216\u5176\u6240\u5728\u4ee3\u7801\u5757\u7684\u7f3a\u5931\uff09\u5bfc\u81f4\u4e86\u524d\u7aef\u65e0\u6cd5\u7ee7\u7eed\u4f9b\u5e94\u6307\u4ee4\u3002</li> <li>\u5173\u952e\u6d1e\u5bdf: LCI \u5728\u6b64\u72b6\u6001\u4e0b\u4f1a\u9519\u8bef\u5730\u5c06\u6392\u7a7a\u5468\u671f\u5f52\u56e0\u4e8e\u6700\u540e\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\uff0c\u800c NCI \u7684\u5f52\u56e0\u5728\u6b64\u573a\u666f\u4e0b\u76f8\u5bf9\u51c6\u786e\uff0c\u4f46\u4f9d\u7136\u4e0d\u5982 Oracle/TIP \u7684\u539f\u5219\u6027\u65b9\u6cd5\u6e05\u6670\u3002</li> </ul> </li> </ul> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u53ca\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: <ul> <li>\u5904\u7406\u5668\u5fae\u67b6\u6784\u7684\u5b9e\u65f6\u72b6\u6001\u4fe1\u53f7\uff0c\u4e3b\u8981\u5305\u62ec\uff1a<ul> <li>ROB \u7684 head/tail pointers \u548c valid/commit flags\u3002</li> <li>\u6307\u4ee4\u7684\u5143\u6570\u636e\uff0c\u5982\u662f\u5426\u4e3a mispredicted branch\u3001\u662f\u5426\u89e6\u53d1 flush \u6216 exception\u3002</li> </ul> </li> </ul> </li> <li>\u8f93\u51fa: <ul> <li>\u4e00\u4e2a\u539f\u5219\u6027\u7684\u3001\u9010\u5468\u671f\u7684\u65f6\u95f4\u5f52\u56e0\u8bb0\u5f55\uff0c\u5c06\u6bcf\u4e2a\u5468\u671f\u7cbe\u786e\u5730\u6620\u5c04\u5230\u4e00\u4e2a\u6216\u591a\u4e2a\u52a8\u6001\u6307\u4ee4\u4e0a\u3002</li> <li>\u5bf9\u4e8e TIP\uff0c\u8f93\u51fa\u662f\u7b26\u5408\u4e0a\u8ff0\u56db\u6001\u6a21\u578b\u7684\u91c7\u6837\u8bb0\u5f55\uff0c\u5305\u542b\u6307\u4ee4\u5730\u5740\u3001\u5468\u671f\u8ba1\u6570\u5668\u4ee5\u53ca\u72b6\u6001\u6807\u5fd7\u4f4d\uff08\u5982 Stalled, Flush, Exception \u7b49\uff09\u3002</li> </ul> </li> <li>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528:<ul> <li>\u4f5c\u4e3a\u9ec4\u91d1\u6807\u51c6 (Golden Reference): Oracle \u7684\u56db\u6001\u6a21\u578b\u4e3a\u8bc4\u4f30\u6240\u6709\u73b0\u6709\u548c\u672a\u6765\u6027\u80fd\u5206\u6790\u5668\u7684\u51c6\u786e\u6027\u63d0\u4f9b\u4e86\u7406\u8bba\u57fa\u51c6\u3002\u8bba\u6587\u9996\u6b21\u91cf\u5316\u4e86\u8f6f\u4ef6\u5206\u6790\u3001Dispatch-tagging\u3001LCI\u3001NCI \u7b49\u65b9\u6cd5\u7684\u7cfb\u7edf\u6027\u8bef\u5dee\u3002</li> <li>\u6307\u5bfc\u5b9e\u7528\u8bbe\u8ba1: TIP \u7684\u8bbe\u8ba1\u76f4\u63a5\u53d7\u6b64\u6a21\u578b\u542f\u53d1\u3002TIP \u7684\u786c\u4ef6\u5355\u5143\uff08\u5982 Offending Instruction Register - OIR\uff09\u5c31\u662f\u4e3a\u4e86\u5728\u91c7\u6837\u65f6\u523b\uff0c\u80fd\u591f\u6839\u636e\u5f53\u524d\u72b6\u6001\uff08\u901a\u8fc7\u68c0\u67e5 ROB \u548c\u76f8\u5173\u6807\u5fd7\u4f4d\uff09\u6765\u51b3\u5b9a\u5e94\u91c7\u6837\u54ea\u6761\uff08\u6216\u54ea\u4e9b\uff09\u6307\u4ee4\uff0c\u4ece\u800c\u5728\u7edf\u8ba1\u91c7\u6837\u7684\u6846\u67b6\u4e0b\u903c\u8fd1 Oracle \u7684\u51c6\u786e\u6027\u3002</li> <li>\u8d4b\u80fd\u7cbe\u51c6\u4f18\u5316: \u6b63\u662f\u8fd9\u79cd\u57fa\u4e8e\u56db\u6001\u6a21\u578b\u7684\u7cbe\u51c6\u5f52\u56e0\uff0c\u4f7f\u5f97 TIP \u80fd\u591f\u5728 Imagick \u6848\u4f8b\u4e2d\uff0c\u5c06\u6027\u80fd\u95ee\u9898\u51c6\u786e\u5730\u5b9a\u4f4d\u5230 <code>frflags</code>/<code>fsflags</code> \u8fd9\u7c7b CSR \u6307\u4ee4\u4e0a\uff0c\u800c\u4e0d\u662f\u50cf NCI \u90a3\u6837\u9519\u8bef\u5730\u6307\u5411 <code>feq.d</code> \u6216 <code>ret</code> \u6307\u4ee4\uff0c\u4ece\u800c\u63ed\u793a\u4e86\u771f\u6b63\u7684\u4f18\u5316\u673a\u4f1a\u3002</li> </ul> </li> </ul> <p>\u5173\u952e\u53c2\u6570\u4e0e\u914d\u7f6e</p> <p>\u8bba\u6587\u5728 FireSim \u4e2d\u4f7f\u7528\u4e86\u57fa\u4e8e Berkeley Out-of-Order Machine (BOOM) \u7684 4-wide \u8d85\u6807\u91cf\u6838\u5fc3\u8fdb\u884c\u8bc4\u4f30\u3002\u8be5\u6a21\u578b\u7684\u5173\u952e\u914d\u7f6e\u5982\u4e0b\uff1a</p> \u7ec4\u4ef6 \u53c2\u6570 Core BOOM v2, 4-wide superscalar, out-of-order Fetch/Issue/Commit Width 4 Reorder Buffer (ROB) 64 entries L1 I/D Cache 32 KB, 8-way associative L2 Cache 512 KB, 8-way associative LLC 8 MB, 16-way associative Profiling Frequency 4 KHz (default) <p>\u8be5\u914d\u7f6e\u786e\u4fdd\u4e86\u5b9e\u9a8c\u73af\u5883\u65e2\u80fd\u4f53\u73b0\u73b0\u4ee3\u5904\u7406\u5668\u7684\u590d\u6742\u6027\uff08\u5982 OoO, wide-issue\uff09\uff0c\u53c8\u80fd\u901a\u8fc7 FPGA \u52a0\u901f\u5b8c\u6210\u5168\u7cfb\u7edf\u3001\u5b8c\u6574\u8fd0\u884c\u7684\u6a21\u62df\uff0c\u4ece\u800c\u9a8c\u8bc1\u56db\u6001\u6a21\u578b\u7684\u6709\u6548\u6027\u548c\u666e\u9002\u6027\u3002</p>"},{"location":"notes_repo/tip-time-proportional-instruction-profiling/paper_notes/#4","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u4eff\u771f\u5e73\u53f0: \u4f7f\u7528 FireSim\uff0c\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8e FPGA \u7684\u3001\u5468\u671f\u7cbe\u786e\u7684\u5168\u7cfb\u7edf\u6a21\u62df\u5668\u3002</li> <li>\u5904\u7406\u5668\u6a21\u578b: \u91c7\u7528 Berkeley Out-of-Order Machine (BOOM) \u7684 4-wide \u8d85\u6807\u91cf\u4e71\u5e8f\u6838\u5fc3\u3002\u5177\u4f53\u914d\u7f6e\u89c1\u4e0b\u8868\u3002</li> <li>\u8bc4\u4f30\u65b9\u6cd5: \u4fee\u6539 FireSim \u4ee5\u5728\u6bcf\u4e2a\u5468\u671f\u8ffd\u8e2a ROB\uff08Reorder Buffer\uff09\u5934\u90e8\u6761\u76ee\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u6307\u4ee4\u5730\u5740\u3001\u6709\u6548/\u63d0\u4ea4/\u5f02\u5e38/\u5237\u65b0/\u8bef\u9884\u6d4b\u6807\u5fd7\u7b49\uff09\u3002\u8fd9\u4e9b\u8ffd\u8e2a\u6570\u636e\u88ab\u53d1\u9001\u5230 CPU \u7aef\u8fdb\u884c\u79bb\u7ebf\u5904\u7406\uff0c\u4ece\u800c\u5728\u5355\u6b21\u6a21\u62df\u8fd0\u884c\u4e2d\u540c\u65f6\u8bc4\u4f30\u591a\u79cd\u5256\u6790\u5668\uff08\u5305\u62ec Oracle \u548c\u6240\u6709\u5bf9\u6bd4\u65b9\u6848\uff09\uff0c\u786e\u4fdd\u4e86\u516c\u5e73\u6027\u3002</li> <li>\u57fa\u51c6\u6d4b\u8bd5\u96c6: \u8fd0\u884c\u4e86 27 \u4e2a SPEC CPU2017 \u548c PARSEC 3.0 \u57fa\u51c6\u6d4b\u8bd5\u7a0b\u5e8f\uff08\u4f7f\u7528 x264\uff09\uff0c\u5e76\u6839\u636e\u5176\u6267\u884c\u7279\u5f81\u5206\u4e3a\u4e09\u7c7b\uff1a<ul> <li>Compute-Intensive: \u8d85\u8fc7 50% \u7684\u65f6\u95f4\u7528\u4e8e\u63d0\u4ea4\u6307\u4ee4\u3002</li> <li>Flush-Intensive: \u4e0d\u6ee1\u8db3 Compute-Intensive \u6761\u4ef6\uff0c\u4e14\u8d85\u8fc7 3% \u7684\u65f6\u95f4\u7528\u4e8e\u6d41\u6c34\u7ebf\u5237\u65b0\u3002</li> <li>Stall-Intensive: \u5176\u4f59\u5927\u90e8\u5206\u65f6\u95f4\u82b1\u5728\u5904\u7406\u5668\u505c\u987f\u4e0a\u7684\u57fa\u51c6\u6d4b\u8bd5\u3002</li> </ul> </li> <li>\u8bef\u5dee\u91cf\u5316: \u5b9a\u4e49\u4e86 profile error \u4e3a <code>e = (Ctotal - Ccorrect) / Ctotal</code>\uff0c\u5176\u4e2d <code>Ccorrect</code> \u662f\u88ab\u5256\u6790\u5668\u6b63\u786e\u5f52\u56e0\u4e8e\u7b26\u53f7\uff08\u6307\u4ee4/\u57fa\u672c\u5757/\u51fd\u6570\uff09\u7684\u5468\u671f\u6570\u3002\u8be5\u5ea6\u91cf\u76f4\u63a5\u4e0e Oracle \u5256\u6790\u5668\u7684\u7ed3\u679c\u8fdb\u884c\u6bd4\u8f83\u3002</li> </ul> <p></p> <p>Table 1: Simulated Configuration.</p> <p></p> <p>Figure 7: Normalized cycle stacks collected at commit.</p> <p>\u7ed3\u679c\u6570\u636e\u5206\u6790</p> <ul> <li>\u51fd\u6570\u7ea7\u5256\u6790: \u5927\u591a\u6570\u786c\u4ef6\u5256\u6790\u5668\uff08NCI, LCI, TIP\uff09\u90fd\u975e\u5e38\u51c6\u786e\uff0c\u5e73\u5747\u8bef\u5dee\u4f4e\u4e8e 1.6%\u3002Software (9.1%) \u548c Dispatch (5.8%) \u7531\u4e8e\u91c7\u6837\u504f\u5dee\u800c\u8868\u73b0\u4e0d\u4f73\u3002</li> <li>\u57fa\u672c\u5757\u7ea7\u5256\u6790: \u51c6\u786e\u5ea6\u5f00\u59cb\u5206\u5316\u3002TIP (0.7%) \u548c TIP-ILP (1.2%) \u4f9d\u7136\u4f18\u79c0\uff0cNCI (2.3%) \u5c1a\u53ef\uff0c\u4f46 LCI \u7684\u5e73\u5747\u8bef\u5dee\u98d9\u5347\u81f3 11.9%\uff0c\u5728 lbm \u57fa\u51c6\u4e0a\u751a\u81f3\u8fbe\u5230 56.1%\uff0c\u56e0\u4e3a\u5b83\u5c06\u957f\u5ef6\u8fdf\u505c\u987f\u9519\u8bef\u5730\u5f52\u56e0\u4e8e\u505c\u987f\u524d\u6700\u540e\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</li> <li>\u6307\u4ee4\u7ea7\u5256\u6790: \u8fd9\u662f\u533a\u5206\u5256\u6790\u5668\u51c6\u786e\u6027\u7684\u5173\u952e\u5c42\u7ea7\u3002<ul> <li>TIP \u8868\u73b0\u51fa\u8272\uff0c\u5e73\u5747\u8bef\u5dee\u4ec5\u4e3a 1.6%\uff08\u6700\u5927 5.0%\uff09\u3002</li> <li>TIP-ILP\uff08\u5ffd\u7565 ILP \u7684 TIP \u53d8\u4f53\uff09\u548c NCI \u7684\u8bef\u5dee\u663e\u8457\u66f4\u9ad8\uff0c\u5206\u522b\u4e3a 7.2% \u548c 9.3%\u3002</li> <li>Software, Dispatch, \u548c LCI \u7684\u5e73\u5747\u8bef\u5dee\u6781\u9ad8\uff0c\u5206\u522b\u4e3a 61.8%, 53.1%, \u548c 55.4%\u3002</li> </ul> </li> <li>\u5173\u952e\u6d1e\u5bdf: TIP \u7684\u4f18\u52bf\u6765\u6e90\u4e8e\u4e24\u4e2a\u65b9\u9762\uff1a<ol> <li>\u5bf9\u4e8e Flush-Intensive \u57fa\u51c6\uff0cTIP \u80fd\u6b63\u786e\u5730\u5c06\u6d41\u6c34\u7ebf\u5237\u65b0\u7684\u5f00\u9500\u5f52\u56e0\u4e8e\u5bfc\u81f4\u5237\u65b0\u7684\u6307\u4ee4\uff08\u5982\u8bef\u9884\u6d4b\u5206\u652f\uff09\uff0c\u800c NCI \u5219\u9519\u8bef\u5730\u5f52\u56e0\u4e8e\u5237\u65b0\u540e\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u7684\u6307\u4ee4\u3002</li> <li>\u5bf9\u4e8e Compute-Intensive \u57fa\u51c6\uff0cTIP \u901a\u8fc7 ILP accounting\uff08\u5c06\u4e00\u4e2a\u5468\u671f\u7684\u5f00\u9500\u5e73\u5747\u5206\u644a\u7ed9\u6240\u6709\u5e76\u884c\u63d0\u4ea4\u7684\u6307\u4ee4\uff09\u907f\u514d\u4e86\u5f52\u56e0\u504f\u5dee\uff0c\u800c NCI \u548c TIP-ILP \u53ea\u5f52\u56e0\u4e8e\u5355\u4e2a\u6307\u4ee4\u3002</li> </ol> </li> </ul> <p></p> <p>Figure 0:Instruction-levelerrorsforthe different profilers.(Software,Dispatch,andLCIareomitted becauseoftheirlarge errors.) TIP is the only accurate profiler at the instruction level.</p> <p>\u6d88\u878d\u5b9e\u9a8c (Ablation Studies)</p> <ul> <li>\u91c7\u6837\u7387\u654f\u611f\u6027\u5206\u6790:<ul> <li>\u6240\u6709\u5256\u6790\u5668\u7684\u8bef\u5dee\u90fd\u968f\u91c7\u6837\u9891\u7387\uff08\u4ece 100Hz \u5230 20KHz\uff09\u7684\u589e\u52a0\u800c\u964d\u4f4e\u3002</li> <li>TIP \u7684\u72ec\u7279\u4e4b\u5904\u5728\u4e8e\uff0c\u5373\u4f7f\u5728\u9ed8\u8ba4\u7684 4KHz \u4ee5\u4e0a\uff0c\u5176\u51c6\u786e\u5ea6\u4ecd\u6709\u663e\u8457\u63d0\u5347\u7a7a\u95f4\uff08\u4f8b\u5982 gcc \u7684\u8bef\u5dee\u4ece 5.0% \u964d\u81f3 2.6%\uff09\u3002\u8fd9\u662f\u56e0\u4e3a TIP \u7684 ILP accounting \u673a\u5236\u80fd\u4ece\u66f4\u9ad8\u9891\u7387\u7684\u91c7\u6837\u4e2d\u83b7\u76ca\uff0c\u66f4\u7cbe\u7ec6\u5730\u523b\u753b\u9ad8 ILP \u533a\u57df\u7684\u884c\u4e3a\u3002</li> <li>\u76f8\u6bd4\u4e4b\u4e0b\uff0cNCI \u548c TIP-ILP \u7684\u8bef\u5dee\u5728 4KHz \u540e\u57fa\u672c\u9971\u548c\u3002</li> </ul> </li> </ul> <p></p> <p>Figure:Sensitivityanalyses.(a)T'sacuracycontinuestomeasurablyimprovebeyond4KHzunliketheotherproflers.(b)Perdic samplingisonlyslightlymoreinacuratethanrandomsamplingwhilebeingsimplertoimplementinhardware.(c)MakingNCIcommitparallelism-aware increases profile error,in contrast to TIP.</p> <ul> <li> <p>\u91c7\u6837\u65b9\u6cd5\u5bf9\u6bd4 (\u5468\u671f\u6027 vs. \u968f\u673a):</p> <ul> <li>\u9ed8\u8ba4\u4f7f\u7528\u5468\u671f\u6027\u91c7\u6837\uff08\u6bcf 250\u03bcs \u4e00\u6b21\uff09\u3002</li> <li>\u968f\u673a\u91c7\u6837\uff08\u5728\u6bcf\u4e2a 250\u03bcs \u95f4\u9694\u5185\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u70b9\uff09\u53ef\u4ee5\u7565\u5fae\u964d\u4f4e\u5e73\u5747\u8bef\u5dee\uff08\u4ece 1.6% \u964d\u81f3 1.1%\uff09\uff0c\u5c24\u5176\u5bf9\u5177\u6709\u91cd\u590d\u6027\u6267\u884c\u6a21\u5f0f\u7684 Stall-Intensive \u57fa\u51c6\uff08\u5982 streamcluster, lbm\uff09\u6709\u76ca\u3002</li> <li>\u7531\u4e8e\u968f\u673a\u91c7\u6837\u5728\u786c\u4ef6\u4e0a\u5b9e\u73b0\u66f4\u590d\u6742\uff0c\u8bba\u6587\u9009\u62e9\u4e86\u66f4\u7b80\u5355\u7684\u5468\u671f\u6027\u91c7\u6837\u3002</li> </ul> </li> <li> <p>\u5bf9 NCI \u5e94\u7528 ILP Accounting \u7684\u53cd\u76f4\u89c9\u7ed3\u679c:</p> <ul> <li>\u4e3a\u4e86\u9a8c\u8bc1 ILP accounting \u7684\u6709\u6548\u6027\u662f\u5426\u4f9d\u8d56\u4e8e\u6b63\u786e\u7684\u5f52\u56e0\u7b56\u7565\uff0c\u4f5c\u8005\u521b\u5efa\u4e86\u4e00\u4e2a NCI+ILP \u53d8\u4f53\uff0c\u5b83\u5c06\u6837\u672c\u5e73\u5747\u5206\u7ed9\u201c\u4e0b\u4e00\u4e2a\u8981\u63d0\u4ea4\u201d\u7684 n \u6761\u6307\u4ee4\u3002</li> <li>\u7ed3\u679c\u4ee4\u4eba\u60ca\u8bb6\uff1aNCI+ILP \u7684\u5e73\u5747\u8bef\u5dee\u4ece 9.3% \u6076\u5316\u5230\u4e86 19.3%\u3002</li> <li>\u539f\u56e0: NCI \u7684\u6839\u672c\u95ee\u9898\u5728\u4e8e\u5176\u201c\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u201d\u7684\u542f\u53d1\u5f0f\u89c4\u5219\u672c\u8eab\u5c31\u662f\u9519\u8bef\u7684\u3002\u5728\u957f\u5ef6\u8fdf\u505c\u987f\uff08\u5982 LLC miss\uff09\u540e\uff0c\u5c06\u5f00\u9500\u5206\u644a\u7ed9\u7d27\u63a5\u7740\u63d0\u4ea4\u7684\u4e00\u6279\u65e0\u5173\u6307\u4ee4\uff0c\u6bd4\u53ea\u5f52\u56e0\u4e8e\u5176\u4e2d\u4e00\u4e2a\u66f4\u7cdf\u7cd5\u3002\u8fd9\u8bc1\u660e\u4e86 TIP \u7684\u6210\u529f\u4e0d\u4ec5\u5728\u4e8e\u652f\u6301 ILP\uff0c\u66f4\u5728\u4e8e\u5176\u57fa\u4e8e Oracle \u7684\u3001\u539f\u5219\u6027\u7684\u5f52\u56e0\u903b\u8f91\u3002</li> </ul> </li> </ul> <p></p> <p>Figure 12:Function and instruction-level profiles for lmagick for TIP and NCI compared to Oracle.</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/ELI5_notes/","title":"Titan-I: An Open-Source, High Performance RISC-V Vector Core \u901a\u4fd7\u8bb2\u89e3","text":""},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/ELI5_notes/#0","title":"0. \u6574\u4f53\u521b\u65b0\u70b9\u901a\u4fd7\u89e3\u8bfb","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\")</p> <p>\u73b0\u4ee3\u7684\u5411\u91cf\u5904\u7406\u5668\uff08Vector Processor\uff09\u6b63\u5904\u5728\u4e00\u4e2a\u5c34\u5c2c\u7684\u5883\u5730\u3002\u4e00\u65b9\u9762\uff0c\u50cf GP-GPU \u8fd9\u6837\u7684\u8bbe\u5907\u867d\u7136\u7b97\u529b\u5f3a\u5927\uff0c\u4f46\u5b83\u4eec\u7684 SIMT \u7f16\u7a0b\u6a21\u578b\u6781\u5176\u590d\u6742\uff0c\u7a0b\u5e8f\u5458\u5f97\u64cd\u5fc3 warp\u3001shared memory \u5bf9\u9f50\u8fd9\u4e9b\u5e95\u5c42\u7ec6\u8282\uff0c\u800c\u4e14\u5176\u63a7\u5236\u903b\u8f91\uff08\u6210\u5343\u4e0a\u4e07\u4e2a\u7ebf\u7a0b\u524d\u7aef\uff09\u975e\u5e38\u81c3\u80bf\uff0c\u6d6a\u8d39\u4e86\u5927\u91cf\u9762\u79ef\u548c\u529f\u8017\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u4f20\u7edf\u7684 OoO CPU \u6838\u5fc3\u4e3a\u4e86\u6316\u6398 ILP\uff08\u6307\u4ee4\u7ea7\u5e76\u884c\uff09\uff0c\u585e\u6ee1\u4e86\u5e9e\u5927\u7684 ROB\uff08\u91cd\u6392\u5e8f\u7f13\u51b2\u533a\uff09\u3001\u590d\u6742\u7684\u5206\u652f\u9884\u6d4b\u5668\u548c\u4e00\u81f4\u6027\u534f\u8bae\uff0c\u8fd9\u4e9b\u201c\u6295\u673a\u201d\u5f00\u9500\u5728\u5904\u7406\u7ed3\u6784\u5316\u3001\u9ad8\u5e76\u884c\u7684\u5411\u91cf\u8d1f\u8f7d\u65f6\u663e\u5f97\u7b28\u91cd\u4e14\u4f4e\u6548\u3002</p> <ul> <li>\u73b0\u6709\u7684 RISC-V Vector (RVV) \u5b9e\u73b0\uff0c\u6bd4\u5982 SpacemiT X60 \u6216 SiFive P870\uff0c\u8981\u4e48\u53d7\u9650\u4e8e flip-flop \u5bc4\u5b58\u5668\u6587\u4ef6\u800c\u65e0\u6cd5\u6269\u5c55 VLEN\uff08\u5411\u91cf\u957f\u5ea6\uff09\u548c DLEN\uff08\u6570\u636e\u901a\u8def\u5bbd\u5ea6\uff09\uff0c\u8981\u4e48\u50cf ETH's Ara \u90a3\u6837\u5e72\u8106\u653e\u5f03\u4e86 ILP\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u7b80\u5355\u7684 in-order \u6d41\u6c34\u7ebf\uff0c\u5bfc\u81f4\u786c\u4ef6\u5229\u7528\u7387\u4f4e\u4e0b\u3002</li> <li>\u5f53\u4f60\u8bd5\u56fe\u628a DLEN \u505a\u5bbd\uff08\u6bd4\u5982 1024-bit \u751a\u81f3\u66f4\u5bbd\uff09\u6765\u63d0\u5347 DLP\uff08\u6570\u636e\u7ea7\u5e76\u884c\uff09\u65f6\uff0c\u4f1a\u7acb\u523b\u649e\u4e0a\u4e24\u5835\u5899\uff1a\u4e00\u662f \u8de8 Lane \u6570\u636e\u8def\u7531\uff08\u5c24\u5176\u662f permutation \u6307\u4ee4\uff09\u4f1a\u4ea7\u751f\u5de8\u5927\u7684\u5ef6\u8fdf\u548c\u5e03\u7ebf\u62e5\u585e\uff1b\u4e8c\u662f mask register (v0) \u7684\u5e7f\u64ad\u9700\u6c42\u4f1a\u8ba9\u6240\u6709 Lane \u4e92\u76f8\u4e89\u62a2\u5e26\u5bbd\uff0c\u5f62\u6210\u74f6\u9888\u3002</li> <li>\u66f4\u8981\u547d\u7684\u662f\uff0c\u5373\u4f7f\u4f60\u6709\u4e86\u8d85\u5bbd\u7684\u6570\u636e\u901a\u8def\uff0c\u5982\u679c\u7f3a\u4e4f\u7cbe\u7ec6\u7684 ILP \u8c03\u5ea6\u80fd\u529b\uff0c\u4e00\u6761\u957f\u5411\u91cf\u6307\u4ee4\u5c31\u4f1a\u72ec\u5360\u6574\u4e2a\u6838\u5fc3\u51e0\u767e\u751a\u81f3\u4e0a\u5343\u4e2a\u5468\u671f\uff0c\u540e\u9762\u7684\u6307\u4ee4\u53ea\u80fd\u5e72\u7b49\u7740\uff0c\u786c\u4ef6\u8d44\u6e90\u88ab\u4e25\u91cd\u6d6a\u8d39\u3002</li> </ul> <p>\u7b80\u800c\u8a00\u4e4b\uff0c\u4e1a\u754c\u7f3a\u5c11\u4e00\u4e2a\u65e2\u80fd\u50cf GPU \u4e00\u6837\u9ad8\u6548\u5904\u7406\u6d77\u91cf\u6570\u636e\uff0c\u53c8\u80fd\u50cf CPU \u4e00\u6837\u806a\u660e\u5730\u4e71\u5e8f\u6267\u884c\u3001\u69a8\u5e72\u786c\u4ef6\u5229\u7528\u7387\uff0c\u5e76\u4e14\u8fd8\u4fdd\u6301 RVV \u7b80\u6d01\u7f16\u7a0b\u6a21\u578b\u7684\u201c\u4e24\u5168\u5176\u7f8e\u201d\u7684\u8bbe\u8ba1\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy)</p> <p>\u60f3\u8c61\u4f60\u8981\u5728\u4e00\u4e2a\u5de8\u5927\u7684\u4ed3\u5e93\uff08VRF, Vector Register File\uff09\u91cc\u5904\u7406\u6210\u5428\u7684\u8d27\u7269\uff08vector elements\uff09\u3002\u8fd9\u4e2a\u4ed3\u5e93\u88ab\u5212\u5206\u6210\u5f88\u591a\u4e2a\u72ec\u7acb\u7684\u533a\u57df\uff08Lanes\uff09\u3002</p> <ul> <li>GP-GPU \u7684\u505a\u6cd5\u5c31\u50cf\u662f\u96c7\u4e86\u51e0\u5343\u4e2a\u5de5\u4eba\uff08threads\uff09\uff0c\u6bcf\u4eba\u8d1f\u8d23\u4e00\u5c0f\u5806\u8d27\u3002\u4f46\u534f\u8c03\u8fd9\u51e0\u5343\u4eba\u9700\u8981\u4e00\u4e2a\u5e9e\u5927\u7684\u8c03\u5ea6\u4e2d\u5fc3\uff08warp scheduler\uff09\uff0c\u800c\u4e14\u5de5\u4eba\u4eec\u7ecf\u5e38\u56e0\u4e3a\u8981\u62ff\u540c\u4e00\u6392\u8d27\u67b6\u4e0a\u7684\u4e1c\u897f\u800c\u6253\u67b6\uff08bank conflict\uff09\uff0c\u6548\u7387\u5e76\u4e0d\u9ad8\u3002</li> <li>\u4f20\u7edf OoO CPU \u7684\u505a\u6cd5\u5219\u50cf\u662f\u53ea\u6709\u4e00\u4e2a\u8d85\u7ea7\u5de5\u4eba\uff0c\u4f46\u4ed6\u8111\u5b50\u91cc\u8bb0\u7740\u4e00\u5f20\u5de8\u590d\u6742\u7684\u4efb\u52a1\u6e05\u5355\uff08ROB\uff09\uff0c\u65f6\u523b\u60f3\u7740\u4e0b\u4e00\u6b65\u8be5\u505a\u4ec0\u4e48\u3001\u4f1a\u4e0d\u4f1a\u51fa\u9519\u3002\u5904\u7406\u5c0f\u5305\u88f9\u5f88\u7075\u6d3b\uff0c\u4f46\u9762\u5bf9\u4e00\u6574\u96c6\u88c5\u7bb1\u7684\u540c\u8d28\u8d27\u7269\u65f6\uff0c\u4ed6\u90a3\u5957\u590d\u6742\u7684\u601d\u8003\u6d41\u7a0b\u53cd\u800c\u6210\u4e86\u7d2f\u8d58\u3002</li> </ul> <p>Titan-I (T1) \u7684\u601d\u8def\u5b8c\u5168\u4e0d\u540c\u3002\u5b83\u66f4\u50cf\u662f\u5efa\u7acb\u4e86\u4e00\u5957\u9ad8\u5ea6\u81ea\u52a8\u5316\u7684\u667a\u80fd\u7269\u6d41\u7cfb\u7edf\uff1a 1.  \u5b83\u628a\u4ed3\u5e93\uff08VRF\uff09\u672c\u8eab\u8bbe\u8ba1\u5f97\u975e\u5e38\u9ad8\u6548\uff0c\u5e76\u4e14\u7ed9\u6bcf\u4e2a\u533a\u57df\uff08Lane\uff09\u914d\u5907\u4e86\u4e13\u7528\u7684\u3001\u53ef\u5e76\u884c\u5de5\u4f5c\u7684\u673a\u5668\u4eba\uff08VFUs\uff09\u3002 2.  \u4e3a\u4e86\u89e3\u51b3\u8de8\u533a\u57df\u8c03\u8d27\uff08permutation\uff09\u7684\u96be\u9898\uff0c\u5b83\u6ca1\u6709\u8ba9\u673a\u5668\u4eba\u81ea\u5df1\u8dd1\u6765\u8dd1\u53bb\uff0c\u800c\u662f\u5728\u4ed3\u5e93\u4e2d\u592e\u5efa\u4e86\u4e00\u4e2a\u8d85\u9ad8\u901f\u7684 \u5206\u62e3\u4e2d\u5fc3 (Permutation Unit)\uff0c\u6240\u6709\u9700\u8981\u91cd\u7ec4\u7684\u8d27\u7269\u90fd\u901a\u8fc7\u4f20\u9001\u5e26\u9001\u5230\u8fd9\u91cc\uff0c\u77ac\u95f4\u5b8c\u6210\u91cd\u65b0\u6253\u5305\u548c\u5206\u53d1\u3002 3.  \u4e3a\u4e86\u9632\u6b62\u6bcf\u6b21\u53d1\u8d27\u90fd\u8981\u5e7f\u64ad\u901a\u77e5\u6240\u6709\u533a\u57df\uff08mask broadcast\uff09\uff0c\u5b83\u5728\u5206\u62e3\u4e2d\u5fc3\u65c1\u8fb9\u8bbe\u4e86\u4e00\u4e2a mask \u7f13\u5b58 (Shadow Mask v0)\uff0c\u4efb\u4f55\u533a\u57df\u9700\u8981 mask \u4fe1\u606f\u65f6\u76f4\u63a5\u53bb\u7f13\u5b58\u62ff\u5c31\u884c\uff0c\u4e0d\u7528\u518d\u60ca\u52a8\u6574\u4e2a\u4ed3\u5e93\u3002 4.  \u6700\u5173\u952e\u7684\u662f\uff0c\u5b83\u7684\u8c03\u5ea6\u7cfb\u7edf\uff08Sequencer + Scoreboards\uff09\u975e\u5e38\u806a\u660e\uff0c\u80fd\u5c06\u4e00\u8fde\u4e32\u76f8\u5173\u7684\u4efb\u52a1\uff08\u6bd4\u5982 load -&gt; compute -&gt; store\uff09\u50cf\u6d41\u6c34\u7ebf\u4e00\u6837 \u7cbe\u7ec6\u5730\u62c6\u89e3\u548c\u91cd\u53e0 (fine-grained chaining)\uff0c\u8ba9\u4e0d\u540c\u533a\u57df\u7684\u673a\u5668\u4eba\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u4efb\u52a1\u7684\u4e0d\u540c\u9636\u6bb5\uff0c\u800c\u4e0d\u662f\u50bb\u7b49\u4e0a\u4e00\u4e2a\u4efb\u52a1\u5b8c\u5168\u7ed3\u675f\u3002</p> <p></p> <p>Figure 3: Architecture of T1</p> <p>\u5173\u952e\u4e00\u62db (The \"How\")</p> <p>\u4f5c\u8005\u5e76\u6ca1\u6709\u4ece\u96f6\u5f00\u59cb\u9020\u4e00\u4e2a\u5168\u65b0\u7684\u8f6e\u5b50\uff0c\u800c\u662f\u5728\u7ecf\u5178\u7684 lane-based \u5411\u91cf\u67b6\u6784\u57fa\u7840\u4e0a\uff0c\u7cbe\u51c6\u5730\u63d2\u5165\u4e86\u51e0\u4e2a\u5173\u952e\u7684\u201c\u5fae\u521b\u65b0\u201d\uff0c\u4e00\u4e3e\u6253\u901a\u4e86 ILP \u548c DLP \u7684\u4efb\u7763\u4e8c\u8109\u3002</p> <ul> <li>\u4e3a DLP \u626b\u6e05\u969c\u788d:</li> <li>Datapath-wide Permutation Unit: \u7528\u4e00\u4e2a\u4e13\u7528\u7684\u3001\u4e0e\u6570\u636e\u901a\u8def\u540c\u5bbd\u7684\u786c\u4ef6\u5355\u5143\u6765\u5904\u7406\u6240\u6709 permutation \u64cd\u4f5c\uff0c\u5f7b\u5e95\u7ed5\u5f00\u4e86\u8de8 Lane \u8def\u7531\u7684\u6027\u80fd\u60ac\u5d16\u3002</li> <li>Shadow Mask v0: \u5c06\u5206\u5e03\u5f0f\u7684 mask register <code>v0</code> \u5728 permutation unit \u4e2d\u505a\u4e00\u4efd\u7f13\u5b58\uff0c\u6d88\u9664\u4e86 predicated execution \u65f6\u7684\u5168\u5c40\u5e7f\u64ad\u74f6\u9888\u3002</li> <li> <p>Coarse-grained Floor-planning Solver: \u901a\u8fc7\u4e00\u4e2a\u542f\u53d1\u5f0f\u5e03\u5c40\u7b97\u6cd5\uff0c\u4f18\u5316\u7269\u7406\u4e0a Lane \u7684\u6446\u653e\u4f4d\u7f6e\uff0c\u6700\u5c0f\u5316 widen/narrow \u7b49\u64cd\u4f5c\u4e2d\u6700\u574f\u60c5\u51b5\u4e0b\u7684\u8de8 Lane \u5ef6\u8fdf\u3002</p> </li> <li> <p>\u4e3a ILP \u6ce8\u5165\u7075\u9b42:</p> </li> <li>Fine-grained Chaining: \u8fd9\u662f\u6700\u6838\u5fc3\u7684\u4e00\u62db\u3002T1 \u7684\u4f9d\u8d56\u8ffd\u8e2a\u4e0d\u662f\u4ee5\u6574\u4e2a\u5411\u91cf\u5bc4\u5b58\u5668\u4e3a\u5355\u4f4d\uff0c\u800c\u662f\u7ec6\u5316\u5230 ELEN \u00d7 ScaleFactor \u7684\u7c92\u5ea6\u3002\u8fd9\u610f\u5473\u7740\uff0c\u53ea\u8981\u4e00\u4e2a\u5411\u91cf\u4e2d\u7684\u4e00\u90e8\u5206\u5143\u7d20\u8ba1\u7b97\u5b8c\u6210\u4e86\uff0c\u540e\u7eed\u4f9d\u8d56\u8fd9\u4e9b\u5143\u7d20\u7684\u6307\u4ee4\u5c31\u53ef\u4ee5\u7acb\u5373\u5f00\u59cb\u6267\u884c\uff0c\u800c\u4e0d\u7528\u7b49\u6574\u4e2a\u5411\u91cf\u90fd\u7b97\u5b8c\u3002\u8fd9\u6781\u5927\u5730\u63d0\u5347\u4e86\u786c\u4ef6\u7684\u5e76\u53d1\u5229\u7528\u7387\u3002</li> <li>Issue-as-commit for Scalar-Vector OoO: \u5141\u8bb8\u6807\u91cf\u548c\u5411\u91cf\u6d41\u6c34\u7ebf\u5728\u6ca1\u6709\u771f\u5b9e\u6570\u636e\u4f9d\u8d56\u7684\u60c5\u51b5\u4e0b\u5404\u81ea\u72ec\u7acb\u524d\u8fdb\u3002\u5411\u91cf\u6307\u4ee4\u4e00\u65e6\u53d1\u51fa\uff08issue\uff09\uff0c\u6807\u91cf\u6838\u5fc3\u5c31\u8ba4\u4e3a\u5b83\u5df2\u7ecf\u63d0\u4ea4\uff08commit\uff09\uff0c\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u540e\u7eed\u7684\u6807\u91cf\u6307\u4ee4\uff0c\u4ece\u800c\u907f\u514d\u4e86\u4e0d\u5fc5\u8981\u7684\u505c\u987f\u3002</li> <li>Memory Interleaving &amp; Delay Slots: \u901a\u8fc7\u5206\u79bb\u7684 Load/Store \u5355\u5143\u548c\u51b2\u7a81\u68c0\u6d4b\u8868\uff08CRT\uff09\uff0c\u5141\u8bb8\u4e0d\u51b2\u7a81\u7684 load \u548c store \u6307\u4ee4\u540c\u65f6\u8fdb\u884c\uff1b\u5bf9\u4e8e\u9ad8\u5ef6\u8fdf\u7684 indexed access\uff0c\u5219\u5229\u7528 delay slot \u8ba9\u72ec\u7acb\u7684\u8ba1\u7b97\u6307\u4ee4\u5728\u5176\u540e\u5e76\u53d1\u6267\u884c\uff0c\u6709\u6548\u9690\u85cf\u4e86\u5185\u5b58\u5ef6\u8fdf\u3002</li> </ul> <p>\u6b63\u662f\u8fd9\u4e9b\u770b\u4f3c\u5fae\u5c0f\u4f46\u6781\u5176\u7cbe\u51c6\u7684\u8bbe\u8ba1\uff0c\u8ba9 T1 \u80fd\u591f\u5728 40% \u7684\u9762\u79ef\u4e0b\u51fb\u8d25 Nvidia 3090/5090\uff0c\u5e76\u5728 HPC \u8d1f\u8f7d\u4e0a\u5c55\u73b0\u51fa\u8fdc\u8d85\u73b0\u6709 RVV \u6838\u5fc3\u7684\u6027\u80fd\u548c\u80fd\u6548\u3002\u5b83\u8bc1\u660e\u4e86\uff0c\u5728\u6b63\u786e\u7684\u5fae\u67b6\u6784\u8bbe\u8ba1\u4e0b\uff0c\u4e00\u4e2a\u5f00\u653e\u7684\u3001\u53ef\u7f16\u7a0b\u7684\u5411\u91cf\u6838\u5fc3\u5b8c\u5168\u53ef\u4ee5\u6210\u4e3a GP-GPU \u5728\u7279\u5b9a\u9886\u57df\u7684\u4e00\u4e2a\u5f3a\u5927\u66ff\u4ee3\u54c1\u3002</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/ELI5_notes/#1-coarse-grained-floor-planning-solver-eli5","title":"1. Coarse-Grained Floor-Planning Solver (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u5728\u4f20\u7edf\u7684 lane-based \u5411\u91cf\u5904\u7406\u5668\u8bbe\u8ba1\u4e2d\uff0c\u5f53\u6570\u636e\u9700\u8981\u5728\u4e0d\u540c Lane \u4e4b\u95f4\u79fb\u52a8\u65f6\uff08\u6bd4\u5982\u6267\u884c widen \u6216 narrow \u6307\u4ee4\uff09\uff0c\u7269\u7406\u5e03\u7ebf\u5c31\u6210\u4e86\u5927\u95ee\u9898\u3002\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c32\u4e2a Lane \u50cf\u68cb\u76d8\u4e00\u6837\u7b80\u5355\u5730\u4ece\u5de6\u5230\u53f3\u3001\u4ece\u4e0a\u5230\u4e0b\u6392\u5217\uff0c\u90a3\u4e48\u4f4d\u4e8e\u5bf9\u89d2\u7ebf\u4e24\u7aef\u7684 Lane\uff08\u6bd4\u5982 Lane 3 \u548c Lane 17\uff09\u8981\u901a\u4fe1\uff0c\u4fe1\u53f7\u5c31\u5f97\u6a2a\u7a7f\u6574\u4e2a\u82af\u7247\u3002 - \u8fd9\u79cd\u201c\u6700\u574f\u60c5\u51b5\u201d\u4e0b\u7684\u957f\u8ddd\u79bb\u901a\u4fe1\u4f1a\u5e26\u6765\u5de8\u5927\u7684 \u5ef6\u8fdf \u548c \u529f\u8017\uff0c\u5e76\u4e14\u4f1a\u6210\u4e3a\u6574\u4e2a\u8bbe\u8ba1\u7684\u6027\u80fd\u74f6\u9888\u3002\u968f\u7740 DLEN\uff08\u6570\u636e\u901a\u8def\u5bbd\u5ea6\uff09\u548c Lane \u6570\u91cf\u7684\u589e\u52a0\uff0c\u8fd9\u4e2a\u95ee\u9898\u4f1a\u6307\u6570\u7ea7\u6076\u5316\uff0c\u6700\u7ec8\u8ba9\u8bbe\u8ba1\u5e08\u4e0d\u6562\u518d\u6269\u5927\u89c4\u6a21\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u8fd9\u5c31\u50cf\u89c4\u5212\u4e00\u4e2a\u5927\u578b\u7269\u6d41\u4ed3\u5e93\u3002\u5982\u679c\u4f60\u628a\u6240\u6709\u8d27\u67b6\uff08Lane\uff09\u6309\u987a\u5e8f\u4e00\u6392\u6392\u6446\u597d\uff0c\u90a3\u4e48\u4eceA\u533a\u6700\u5de6\u8fb9\u53d6\u8d27\u9001\u5230Z\u533a\u6700\u53f3\u8fb9\uff0c\u53c9\u8f66\uff08\u6570\u636e\u4fe1\u53f7\uff09\u5c31\u5f97\u8dd1\u5b8c\u6574\u4e2a\u4ed3\u5e93\uff0c\u6548\u7387\u6781\u4f4e\u3002 - \u4e00\u4e2a\u597d\u7684\u4ed3\u5e93\u7ecf\u7406\uff08Coarse-Grained Floor-Planning Solver\uff09\u4e0d\u4f1a\u8fd9\u4e48\u5e72\u3002\u4ed6\u4f1a\u628a\u7ecf\u5e38\u9700\u8981\u4e92\u76f8\u8c03\u8d27\u7684\u533a\u57df\uff08\u6bd4\u5982\u5904\u7406\u76f8\u540c\u7c7b\u578b\u6570\u636e\u7684 Lane\uff09\u5c3d\u91cf\u5b89\u6392\u5728\u4e00\u8d77\uff0c\u5f62\u6210\u4e00\u4e2a\u4e2a\u5c0f\u96c6\u7fa4\u3002\u8fd9\u6837\uff0c\u5927\u90e8\u5206\u5185\u90e8\u8c03\u8d27\u90fd\u5728\u5c0f\u8303\u56f4\u5185\u5b8c\u6210\uff0c\u53ea\u6709\u5c11\u6570\u8de8\u96c6\u7fa4\u7684\u8c03\u8d27\u624d\u9700\u8981\u8dd1\u8fdc\u8def\uff0c\u4ece\u800c\u5927\u5927\u964d\u4f4e\u4e86\u5e73\u5747\u548c\u6700\u574f\u60c5\u51b5\u4e0b\u7684\u8fd0\u8f93\u65f6\u95f4\u3002</p> <p></p> <p>\u56fe\uff1a\u8bba\u6587\u4e2d\u7684 Figure 5 \u6e05\u6670\u5730\u5c55\u793a\u4e86\u8fd9\u4e00\u70b9\u3002\u5de6\u8fb9\u662f\u201cTrivial Floorplan\u201d\uff08\u6734\u7d20\u5e03\u5c40\uff09\uff0c\u6700\u5927\u901a\u4fe1\u5ef6\u8fdf\u9ad8\u8fbe 7 \u4e2a\u5355\u4f4d\uff1b\u53f3\u8fb9\u662f\u4ed6\u4eec\u7684\u201cNovel Floorplan\u201d\uff08\u65b0\u5f0f\u5e03\u5c40\uff09\uff0c\u901a\u8fc7\u667a\u80fd\u6446\u653e\uff0c\u5c06\u6700\u5927\u5ef6\u8fdf\u964d\u5230\u4e86 4 \u4e2a\u5355\u4f4d\u3002</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u6ca1\u6709\u91c7\u7528\u8ba1\u7b97\u590d\u6742\u5ea6\u6781\u9ad8\u7684\u5168\u5c40\u6700\u4f18\u7b97\u6cd5\uff08\u90a3\u5728\u5de5\u7a0b\u4e0a\u4e0d\u73b0\u5b9e\uff09\uff0c\u800c\u662f\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u806a\u660e\u7684 \u542f\u53d1\u5f0f\uff08heuristic\uff09\u6c42\u89e3\u5668\u3002 - \u8fd9\u4e2a\u6c42\u89e3\u5668\u7684\u6838\u5fc3\u903b\u8f91\u662f\uff1a   - \u5b83\u77e5\u9053\u54ea\u4e9b Lane \u5bf9\u4e4b\u95f4\u901a\u4fe1\u6700\u9891\u7e41\uff08\u6bd4\u5982\u6267\u884c widen/narrow \u65f6\uff0c<code>i</code> \u53f7 Lane \u9700\u8981\u548c <code>(2i mod n)</code> \u53ca <code>(2i+1 mod n)</code> \u53f7 Lane \u901a\u4fe1\uff09\u3002   - \u5728\u653e\u7f6e\u4e00\u4e2a\u65b0\u7684 Lane \u65f6\uff0c\u5982\u679c\u5b83\u5df2\u7ecf\u6709\u90bb\u5c45\u88ab\u653e\u7f6e\u4e86\uff0c\u6c42\u89e3\u5668\u5c31\u628a\u5b83\u653e\u5728\u80fd \u6700\u5c0f\u5316\u5230\u8fd9\u4e9b\u5df2\u653e\u7f6e\u90bb\u5c45\u7684\u6700\u5927\u8ddd\u79bb \u7684\u4f4d\u7f6e\u4e0a\u3002   - \u5982\u679c\u8fd8\u6ca1\u6709\u90bb\u5c45\uff0c\u5c31\u968f\u673a\u653e\u5728\u73b0\u6709\u5e03\u5c40\u7684\u65c1\u8fb9\u3002 - \u901a\u8fc7\u8fd9\u79cd \u5c40\u90e8\u4f18\u5316\u9a71\u52a8\u5168\u5c40\u5e03\u5c40 \u7684\u7b56\u7565\uff0c\u5b83\u7528\u5f88\u4f4e\u7684\u8ba1\u7b97\u6210\u672c\uff0c\u5c31\u627e\u5230\u4e86\u4e00\u4e2a\u80fd\u8ba9 \u6700\u574f\u60c5\u51b5\u8def\u7531\u8ddd\u79bb \u663e\u8457\u7f29\u77ed\u7684\u7269\u7406\u5e03\u5c40\u65b9\u6848\uff0c\u4ece\u800c\u76f4\u63a5\u5c06 widen/narrow \u64cd\u4f5c\u7684\u5ef6\u8fdf\u964d\u4f4e\u4e86\u8fd1 20%\u3002</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/ELI5_notes/#2-datapath-wide-permutation-unit-eli5","title":"2. Datapath-Wide Permutation Unit (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u5728\u4f20\u7edf\u7684 lane-based \u5411\u91cf\u5904\u7406\u5668\u91cc\uff0c\u505a permutation\uff08\u6bd4\u5982 <code>VRGATHER</code>\u3001<code>VCOMPRESS</code>\uff09\u662f\u4e2a\u8001\u5927\u96be\u95ee\u9898\u3002\u56e0\u4e3a\u6570\u636e\u662f\u5206\u6563\u5728\u5404\u4e2a lane \u91cc\u7684\uff0c\u8981\u91cd\u7ec4\u5c31\u5f97\u8de8 lane \u642c\u8fd0\u3002 - \u6700\u6734\u7d20\u7684\u529e\u6cd5\u662f\u4ec0\u4e48\uff1f\u628a\u6570\u636e\u4ece\u6240\u6709 lane \u7684 VRF\uff08\u5411\u91cf\u5bc4\u5b58\u5668\u5806\uff09\u91cc\u8bfb\u51fa\u6765\uff0c\u5199\u5230\u4e00\u5757\u5171\u4eab\u7684 local memory \u91cc\uff0c\u6392\u597d\u961f\u518d\u8bfb\u56de\u53bb\u3002\u8fd9\u53eb memory-swap emulation\u3002 - \u8fd9\u4e2a\u8fc7\u7a0b\u6709\u591a\u201c\u96be\u53d7\u201d\uff1f   - \u6027\u80fd\u6740\u624b\uff1a\u4e00\u6b21 permutation \u53d8\u6210\u4e86\u4e24\u6b21\u6602\u8d35\u7684 VRF \u8bfb\u5199\u5916\u52a0\u4e00\u6b21 local memory \u8bbf\u95ee\uff0clatency \u98de\u6da8\u3002   - \u5e26\u5bbd\u9ed1\u6d1e\uff1a\u5b9d\u8d35\u7684 VRF \u548c local memory \u5e26\u5bbd\u88ab\u8fd9\u79cd\u201c\u5185\u90e8\u8c03\u5ea6\u201d\u7ed9\u5360\u6ee1\u4e86\uff0c\u771f\u6b63\u7684\u8ba1\u7b97\u6307\u4ee4\u53ea\u80fd\u5e72\u7b49\u7740\u3002   - \u6269\u5c55\u6027\u5dee\uff1alane \u8d8a\u591a\uff0c\u8de8 lane \u901a\u4fe1\u8d8a\u590d\u6742\uff0c\u8fd9\u4e2a\u74f6\u9888\u5c31\u8d8a\u4e25\u91cd\uff0c\u76f4\u63a5\u9650\u5236\u4e86 DLEN\uff08\u6570\u636e\u901a\u8def\u5bbd\u5ea6\uff09\u7684\u6269\u5c55\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4e00\u4e2a\u5927\u578b\u7269\u6d41\u4ed3\u5e93\uff08VRF\uff09\uff0c\u88ab\u5206\u6210\u4e86\u5f88\u591a\u4e2a\u72ec\u7acb\u7684\u533a\u57df\uff08lane\uff09\u3002\u73b0\u5728\u4f60\u9700\u8981\u628a\u6563\u843d\u5728\u5404\u4e2a\u533a\u57df\u7684\u5305\u88f9\uff08vector elements\uff09\u6309\u7167\u4e00\u4e2a\u65b0\u7684\u8ba2\u5355\uff08permutation pattern\uff09\u91cd\u65b0\u6253\u5305\u3002 - \u65e7\u65b9\u6cd5\u5c31\u50cf\uff1a\u8ba9\u6bcf\u4e2a\u533a\u57df\u7684\u5de5\u4eba\u5148\u628a\u5305\u88f9\u642c\u5230\u4e2d\u592e\u5206\u62e3\u5927\u5385\uff08local memory\uff09\uff0c\u7b49\u6240\u6709\u5305\u88f9\u90fd\u5230\u9f50\u4e86\uff0c\u518d\u7531\u53e6\u4e00\u6279\u5de5\u4eba\u6309\u65b0\u8ba2\u5355\u91cd\u65b0\u5206\u62e3\uff0c\u6700\u540e\u9001\u56de\u5404\u4e2a\u533a\u57df\u3002\u6574\u4e2a\u8fc7\u7a0b\u6162\u3001\u5360\u5730\u3001\u8fd8\u5bb9\u6613\u5835\u3002 - Titan-I \u7684 Datapath-Wide Permutation Unit \u76f8\u5f53\u4e8e\u5728\u4ed3\u5e93\u5185\u90e8\u67b6\u8bbe\u4e86\u4e00\u5957\u5168\u81ea\u52a8\u3001\u5168\u8986\u76d6\u7684\u7a7a\u4e2d\u4f20\u9001\u5e26\u7cfb\u7edf\uff08crossbar\uff09\u3002\u8fd9\u5957\u7cfb\u7edf\u80fd\u76f4\u63a5\u8fde\u901a\u4efb\u610f\u4e24\u4e2a\u533a\u57df\uff0c\u5305\u88f9\u53ef\u4ee5\u5728\u533a\u57df\u5185\u76f4\u63a5\u901a\u8fc7\u4f20\u9001\u5e26\u98de\u5230\u76ee\u6807\u533a\u57df\uff0c\u5b8c\u5168\u4e0d\u9700\u8981\u7ecf\u8fc7\u4e2d\u592e\u5927\u5385\u3002\u6574\u4e2a\u8fc7\u7a0b\u53c8\u5feb\u53c8\u9ad8\u6548\uff0c\u8fd8\u4e0d\u5360\u7528\u5730\u9762\u7a7a\u95f4\u3002</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u6ca1\u6709\u53bb\u4f18\u5316\u90a3\u4e2a\u4f4e\u6548\u7684\u201c\u642c\u8fdb\u642c\u51fa\u201d\u6d41\u7a0b\uff0c\u800c\u662f\u4ece\u6839\u672c\u4e0a\u7ed5\u5f00\u4e86\u5b83\u3002 - \u4ed6\u4eec\u5728\u82af\u7247\u7269\u7406\u5e03\u5c40\u7684\u4e2d\u5fc3\u4f4d\u7f6e\uff0c\u786c\u751f\u751f\u5730\u585e\u8fdb\u53bb\u4e00\u4e2a\u4e0e\u6574\u4e2a\u6570\u636e\u901a\u8def\u540c\u5bbd\uff08DLEN-sized\uff09\u7684 crossbar \u5f00\u5173\u77e9\u9635\uff0c\u8fd9\u5c31\u662f Permutation Unit\u3002 - \u8fd9\u4e2a\u5355\u5143\u5982\u4f55\u5de5\u4f5c\uff1f   - \u5f53\u4e00\u6761 permutation \u6307\u4ee4\u5230\u6765\u65f6\uff0cSequencer \u4f1a\u901a\u77e5\u6240\u6709 lane \u51c6\u5907\u597d\u5b83\u4eec\u7684\u6570\u636e\u3002   - \u6240\u6709 lane \u540c\u65f6\u5c06\u6570\u636e\u53d1\u9001\u5230\u8fd9\u4e2a\u4e2d\u592e Permutation Unit\u3002   - Permutation Unit \u5185\u90e8\u7684 crossbar \u6839\u636e\u6307\u4ee4\u8981\u6c42\uff08\u9759\u6001\u6216\u52a8\u6001\u7684\u7d22\u5f15\uff09\uff0c\u5728\u4e00\u4e2a\u5468\u671f\u5185\u5c31\u5b8c\u6210\u4e86\u6240\u6709\u6570\u636e\u7684\u91cd\u6392\u548c\u8def\u7531\u3002   - \u91cd\u6392\u540e\u7684\u6570\u636e\u76f4\u63a5\u4ece Permutation Unit \u5e7f\u64ad\u56de\u5404\u4e2a lane\u3002 - \u8fd9\u4e2a\u8bbe\u8ba1\u7684\u7cbe\u5999\u4e4b\u5904\u5728\u4e8e\uff1a   - \u539f\u751f\u652f\u6301\uff1a\u628a permutation \u4ece\u4e00\u4e2a\u9700\u8981\u591a\u6b21\u5185\u5b58\u8bbf\u95ee\u7684\u201c\u8f6f\u4ef6\u6a21\u62df\u201d\u64cd\u4f5c\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u5355\u5468\u671f\u786c\u4ef6\u539f\u8bed\u3002   - \u5e26\u5bbd\u65e0\u635f\uff1a\u6570\u636e\u53ea\u5728 lane \u548c Permutation Unit \u4e4b\u95f4\u6d41\u52a8\u4e00\u6b21\uff0cVRF \u548c local memory \u7684\u5e26\u5bbd\u5f97\u4ee5\u5b8c\u5168\u91ca\u653e\u7ed9\u8ba1\u7b97\u4efb\u52a1\u3002   - \u53ef\u6269\u5c55\uff1a\u901a\u8fc7\u589e\u52a0 crossbar \u7684\u6d41\u6c34\u7ebf\u7ea7\u6570\uff0c\u53ef\u4ee5\u5f88\u597d\u5730\u63a7\u5236\u5176\u5ef6\u8fdf\u548c\u9762\u79ef\u5f00\u9500\uff0c\u4f7f\u5176\u80fd\u968f\u7740 DLEN \u7684\u589e\u5927\u800c\u7ebf\u6027\u6269\u5c55\uff0c\u5982 </p> <p></p> <p>(a) VLEN</p> <p>(b) \u6240\u793a\u3002</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/ELI5_notes/#3-shadow-cache-for-mask-register-v0-eli5","title":"3. Shadow Cache for Mask Register (v0) (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u5728\u4f20\u7edf\u7684 lane-based RISC-V Vector \u8bbe\u8ba1\u4e2d\uff0cmask register (v0) \u88ab\u7269\u7406\u5730\u5207\u5206\u5e76\u5747\u5300\u5206\u5e03\u5230\u6240\u6709 Lane \u4e0a\u3002 - \u5f53\u4e00\u6761 predicated instruction\uff08\u5e26\u63a9\u7801\u7684\u6307\u4ee4\uff09\u9700\u8981\u4f7f\u7528 v0 \u65f6\uff0c\u5b83\u5f80\u5f80\u9700\u8981\u4ece\u591a\u4e2a\u4e0d\u540c\u7684 Lane \u4e2d\u5b9e\u65f6\u6536\u96c6\u5bf9\u5e94\u7684\u63a9\u7801\u4f4d\u3002\u4f8b\u5982\uff0c\u5904\u7406\u4e00\u4e2a 32-bit \u5143\u7d20\u53ef\u80fd\u9700\u8981\u4ece 3 \u4e2a\u751a\u81f3 4 \u4e2a Lane \u91cc\u201c\u62fc\u51d1\u201d\u51fa\u5b8c\u6574\u7684\u63a9\u7801\u4fe1\u606f\u3002 - \u8fd9\u79cd\u8de8 Lane \u7684\u6570\u636e\u8bf7\u6c42\u4f1a\u4ea7\u751f\u6d77\u91cf\u7684\u70b9\u5bf9\u70b9\u5e7f\u64ad\u6d41\u91cf\uff0c\u5728 Lane \u6570\u91cf\u5f88\u591a\uff08\u5373 DLEN \u5f88\u5bbd\uff09\u65f6\uff0c\u4f1a\u77ac\u95f4\u585e\u7206\u7247\u4e0a\u4e92\u8fde\u7f51\u7edc\uff0c\u5f62\u6210\u4e25\u91cd\u7684\u6027\u80fd\u74f6\u9888\uff0c\u4e5f\u5c31\u662f\u8bba\u6587\u91cc\u8bf4\u7684 \u201cwiring bottleneck\u201d\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4e00\u4e0b\uff0c\u4f60\u662f\u4e00\u5bb6\u5927\u578b\u8fde\u9501\u8d85\u5e02\uff08Vector Core\uff09\u7684\u7ecf\u7406\uff0c\u8981\u7ed9\u6240\u6709\u5206\u5e97\uff08Lane\uff09\u53d1\u4e00\u4e2a\u201c\u4eca\u65e5\u7279\u4ef7\u5546\u54c1\u6e05\u5355\u201d\uff08mask v0\uff09\u3002 - \u65e7\u65b9\u6cd5\u662f\uff1a\u6bcf\u5f53\u67d0\u4e2a\u5206\u5e97\u8981\u641e\u4fc3\u9500\uff08\u6267\u884c predicated instruction\uff09\uff0c\u5b83\u5c31\u5f97\u6253\u7535\u8bdd\u7ed9\u603b\u90e8\uff0c\u7136\u540e\u603b\u90e8\u518d\u6328\u4e2a\u95ee\u5176\u4ed6\u6240\u6709\u5206\u5e97\uff1a\u201c\u4f60\u4eec\u90a3\u90e8\u5206\u6e05\u5355\u662f\u4ec0\u4e48\uff1f\u201d\uff0c\u6700\u540e\u628a\u4fe1\u606f\u62fc\u8d77\u6765\u544a\u8bc9\u5b83\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u6781\u5176\u4f4e\u6548\uff0c\u7535\u8bdd\u7ebf\uff08\u7247\u4e0a\u4e92\u8fde\uff09\u5168\u88ab\u5360\u6ee1\u4e86\u3002 - T1 \u7684\u505a\u6cd5\u662f\uff1a\u603b\u90e8\uff08Permutation Unit\uff09\u81ea\u5df1\u7ef4\u62a4\u4e00\u4efd\u5b8c\u6574\u3001\u6700\u65b0\u7684\u7279\u4ef7\u6e05\u5355\u526f\u672c\uff08Shadow Cache\uff09\u3002\u4efb\u4f55\u5206\u5e97\u9700\u8981\u65f6\uff0c\u76f4\u63a5\u627e\u603b\u90e8\u62ff\u5c31\u884c\uff0c\u907f\u514d\u4e86\u5206\u5e97\u4e4b\u95f4\u4e92\u76f8\u6253\u7535\u8bdd\u9a9a\u6270\uff0c\u6574\u4e2a\u7cfb\u7edf\u6d41\u7545\u591a\u4e86\u3002</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u6ca1\u6709\u6539\u53d8 mask register \u7684\u7269\u7406\u5206\u5e03\u65b9\u5f0f\uff0c\u800c\u662f\u5728 Permutation Unit \u8fd9\u4e2a\u4e2d\u5fc3\u67a2\u7ebd\u91cc\uff0c\u589e\u52a0\u4e86\u4e00\u4e2a\u4e13\u95e8\u7684 Shadow Mask (v0) Cache\u3002 - \u8fd9\u4e2a\u7f13\u5b58\u4f1a\u88ab\u52a8\u5730\u88ab\u5404\u4e2a Lane \u66f4\u65b0\uff1a\u5f53\u4efb\u4f55\u4e00\u6761\u6307\u4ee4\u4fee\u6539\u4e86 v0 \u7684\u4e00\u90e8\u5206\uff0c\u5bf9\u5e94\u7684 Lane \u5c31\u4f1a\u901a\u8fc7\u4e00\u4e2a\u4e13\u7528\u7684\u6570\u636e\u901a\u9053\uff0c\u5c06\u66f4\u65b0\u540c\u6b65\u5230 Permutation Unit \u7684 Shadow Cache \u91cc\u3002 - \u540c\u65f6\uff0cSequencer\uff08\u8c03\u5ea6\u5668\uff09\u626e\u6f14\u4e86\u201c\u4ea4\u901a\u8b66\u5bdf\u201d\u7684\u89d2\u8272\uff0c\u5b83\u4f1a\u8ddf\u8e2a\u6240\u6709\u5bf9 v0 \u7684\u5199\u64cd\u4f5c\uff0c\u786e\u4fdd\u5728\u6240\u6709 pending \u7684\u5199\u64cd\u4f5c\u5b8c\u6210\u4e4b\u524d\uff0c\u4f9d\u8d56 v0 \u7684\u65b0\u6307\u4ee4\u4e0d\u4f1a\u88ab\u6267\u884c\uff0c\u4ece\u800c\u4fdd\u8bc1\u4e86\u6570\u636e\u4e00\u81f4\u6027\u3002 - \u901a\u8fc7\u8fd9\u4e2a\u8bbe\u8ba1\uff0c\u6240\u6709\u9700\u8981\u8bfb\u53d6 v0 \u7684\u6307\u4ee4\u90fd\u53d8\u6210\u4e86\u672c\u5730\u8bfb\u53d6\uff08\u4ece Permutation Unit \u5230\u81ea\u5df1\u7684 Lane\uff09\uff0c\u5f7b\u5e95\u6d88\u9664\u4e86\u8de8 Lane \u7684\u5e7f\u64ad\u98ce\u66b4\u3002\u8bba\u6587\u63d0\u5230\uff0c\u8fd9\u80fd\u51cf\u5c11\u9ad8\u8fbe 4 \u00d7 VLEN/ELEN \u6b21\u7684 VRF \u8bfb\u64cd\u4f5c\uff0c\u4ece\u800c\u5c06\u5e26\u5bbd\u63d0\u5347\u4e86\u7ea6 50%\uff0c\u800c\u9762\u79ef\u5f00\u9500\u4ec5\u4e3a 8%\u3002</p> <p></p> <p>(a) VLEN</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/ELI5_notes/#4-fine-grained-chaining-microarchitecture-eli5","title":"4. Fine-Grained Chaining Microarchitecture (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb - \u4f20\u7edf\u7684\u5411\u91cf\u5904\u7406\u5668\u5728\u5904\u7406\u957f\u5411\u91cf\u65f6\uff0c\u5c31\u50cf\u4e00\u6761\u50f5\u786c\u7684\u6d41\u6c34\u7ebf\uff1a\u4e00\u4e2a\u6307\u4ee4\u5fc5\u987b\u7b49\u524d\u4e00\u4e2a\u6307\u4ee4\u628a\u6574\u4e2a\u8d85\u5bbd\u7ed3\u679c\uff08\u53ef\u80fd\u51e0\u5343\u4f4d\uff09\u5b8c\u5168\u5199\u56de VRF (Vector Register File) \u540e\uff0c\u81ea\u5df1\u624d\u80fd\u5f00\u59cb\u3002\u8fd9\u9020\u6210\u4e86\u4e24\u4e2a\u201c\u5f88\u96be\u53d7\u201d\u7684\u95ee\u9898\uff1a   - \u5de8\u5927\u7684\u5ef6\u8fdf\u6c14\u6ce1\uff1a\u5373\u4f7f\u65b0\u6307\u4ee4\u53ea\u4f9d\u8d56\u65e7\u6307\u4ee4\u7ed3\u679c\u7684\u4e00\u5c0f\u90e8\u5206\uff0c\u4e5f\u5f97\u5e72\u7b49\u7740\u5168\u90e8\u5199\u5b8c\u3002   - VRF \u5e26\u5bbd\u6d6a\u8d39\uff1aVRF \u7684\u8bfb\u5199\u7aef\u53e3\u5f88\u5bbd\uff0c\u4f46\u56e0\u4e3a\u5199\u5165\u662f\u201c\u6574\u5757\u201d\u8fdb\u884c\u7684\uff0c\u65e0\u6cd5\u88ab\u540e\u7eed\u4e0d\u76f8\u5173\u7684\u3001\u53ea\u9700\u8981\u90e8\u5206\u6570\u636e\u7684\u6307\u4ee4\u5145\u5206\u5229\u7528\uff0c\u5bfc\u81f4\u786c\u4ef6\u8d44\u6e90\u95f2\u7f6e\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 - \u60f3\u8c61\u4f60\u5728\u7ec4\u88c5\u4e00\u53f0\u590d\u6742\u7684\u673a\u5668\uff0c\u9700\u8981\u7528\u5230\u4e00\u4e2a\u7531100\u4e2a\u96f6\u4ef6\u7ec4\u6210\u7684\u5927\u578b\u9884\u5236\u6a21\u5757A\u3002\u4f20\u7edf\u505a\u6cd5\u662f\uff1a\u5de5\u4eba1\u5fc5\u987b\u628a\u6a21\u5757A\u7684\u6240\u6709100\u4e2a\u96f6\u4ef6\u90fd\u653e\u5230\u5de5\u4f5c\u53f0\u4e0a\u5e76\u56fa\u5b9a\u597d\u540e\uff0c\u5de5\u4eba\u624d\u80fd\u5f00\u59cb\u7528\u5176\u4e2d\u7684\u51e0\u4e2a\u96f6\u4ef6\u53bb\u7ec4\u88c5\u4e0b\u4e00\u4e2a\u6a21\u5757B\u3002 - Fine-Grained Chaining\u7684\u505a\u6cd5\u5219\u806a\u660e\u5f97\u591a\uff1a\u5de5\u4f5c\u53f0\u88ab\u5212\u5206\u6210\u5f88\u591a\u5c0f\u683c\u5b50\uff08\u5bf9\u5e94 lane datapath granularity\uff09\u3002\u5de5\u4eba1\u6bcf\u653e\u597d\u4e00\u4e2a\u96f6\u4ef6\u5230\u5bf9\u5e94\u7684\u5c0f\u683c\u5b50\u91cc\uff0c\u7cfb\u7edf\u5c31\u7acb\u523b\u901a\u77e5\u6240\u6709\u7b49\u5f85\u7684\u5de5\u4eba\uff1a\u201c\u563f\uff0cA\u6a21\u5757\u7684\u7b2c5\u53f7\u96f6\u4ef6\u597d\u4e86\uff01\u201d\u3002\u5982\u679c\u5de5\u4eba2\u6b63\u597d\u9700\u8981\u8fd9\u4e2a\u96f6\u4ef6\uff0c\u4ed6\u5c31\u53ef\u4ee5\u7acb\u523b\u62ff\u8d70\u5f00\u5de5\uff0c\u6839\u672c\u4e0d\u7528\u7b49\u5269\u4e0b\u768499\u4e2a\u96f6\u4ef6\u3002\u8fd9\u5c31\u50cf\u662f\u628a\u4e00\u4e2a\u7b28\u91cd\u7684\u6574\u4f53\u4ea4\u63a5\uff0c\u62c6\u89e3\u6210\u4e86\u7075\u6d3b\u7684\u3001\u6309\u9700\u7684\u201c\u96f6\u4ef6\u7ea7\u201d\u4ea4\u63a5\u3002</p> <p>\u5173\u952e\u4e00\u62db - \u4f5c\u8005\u5e76\u6ca1\u6709\u6539\u53d8\u5411\u91cf\u6307\u4ee4\u7684\u57fa\u672c\u6267\u884c\u6d41\u7a0b\uff0c\u800c\u662f\u5728 VRF \u5199\u56de\u9636\u6bb5\u548c\u6307\u4ee4\u8c03\u5ea6\u903b\u8f91\u4e4b\u95f4\uff0c\u5de7\u5999\u5730\u63d2\u5165\u4e86\u4e00\u4e2a\u7ec6\u7c92\u5ea6\u7684\u4f9d\u8d56\u8ffd\u8e2a\u5668\uff08\u5373\u6587\u4e2d\u63d0\u5230\u7684 Chaining Scoreboard\uff09\u3002   - \u8fd9\u4e2a\u8ffd\u8e2a\u5668\u4e0d\u518d\u4ee5\u201c\u6574\u4e2a\u5411\u91cf\u5bc4\u5b58\u5668\u201d\u4e3a\u5355\u4f4d\u8bb0\u5f55\u5199\u5b8c\u6210\u72b6\u6001\uff0c\u800c\u662f\u5c06\u5176\u62c6\u5206\u6210\u66f4\u5c0f\u7684\u5757\uff08ELEN \u00d7 ScaleFactor-bit\uff0c\u4f8b\u598264\u4f4d\u6216128\u4f4d\uff09\u3002   - \u5f53\u4e00\u4e2a\u5411\u91cf\u6307\u4ee4\u7684\u90e8\u5206\u7ed3\u679c\uff08\u6bd4\u5982\u67d0\u4e2a lane \u7684\u8ba1\u7b97\u7ed3\u679c\uff09\u51c6\u5907\u597d\u540e\uff0c\u5b83\u4f1a\u7acb\u5373\u66f4\u65b0\u8ffd\u8e2a\u5668\u4e2d\u5bf9\u5e94\u5c0f\u5757\u7684\u72b6\u6001\u4e3a\u201c\u53ef\u7528\u201d\u3002   - \u8c03\u5ea6\u5668\u5728\u6d3e\u53d1\u540e\u7eed\u6307\u4ee4\u65f6\uff0c\u4f1a\u68c0\u67e5\u5176\u6240\u6709\u8f93\u5165\u4f9d\u8d56\u7684\u5c0f\u5757\u662f\u5426\u90fd\u5df2\u201c\u53ef\u7528\u201d\u3002\u53ea\u8981\u6ee1\u8db3\uff0c\u8be5\u6307\u4ee4\u5c31\u53ef\u4ee5\u7acb\u5373\u542f\u52a8\uff0c\u751a\u81f3\u53ef\u4ee5\u5728\u524d\u4e00\u4e2a\u6307\u4ee4\u7684\u5176\u4ed6\u90e8\u5206\u8fd8\u5728\u8ba1\u7b97\u65f6\u5c31\u5f00\u59cb\u6267\u884c\u3002   - \u8fd9\u76f4\u63a5\u5b9e\u73b0\u4e86 Out-of-Order Writebacks\uff0c\u8ba9 VRF \u7684\u591a\u4e2a\u8bfb\u5199\u7aef\u53e3\u80fd\u88ab\u4e0d\u540c\u6307\u4ee4\u7684\u3001\u4e0d\u76f8\u5173\u7684\u6570\u636e\u5757\u540c\u65f6\u4f7f\u7528\uff0c\u4ece\u800c\u6700\u5927\u5316 VRF \u5e26\u5bbd\u5229\u7528\u7387\u3002</p> <p></p> <p>Figure 3: Architecture of T1</p> <p>\u8fd9\u79cd\u8bbe\u8ba1\u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\u201c\u5316\u6574\u4e3a\u96f6\uff0c\u6309\u9700\u4f9b\u7ed9\u201d\uff0c\u5c06\u7c97\u7c92\u5ea6\u7684\u3001\u963b\u585e\u5f0f\u7684\u5411\u91cf\u5904\u7406\uff0c\u8f6c\u53d8\u4e3a\u7ec6\u7c92\u5ea6\u7684\u3001\u6d41\u6c34\u7ebf\u5f0f\u7684\u9ad8\u6548\u534f\u4f5c\uff0c\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u957f\u5411\u91cf\u5904\u7406\u4e2d\u7684\u5ef6\u8fdf\u548c\u5e26\u5bbd\u74f6\u9888\u95ee\u9898\u3002</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/ELI5_notes/#5-issue-as-commit-for-scalar-vector-ooo-execution-eli5","title":"5. Issue-as-Commit for Scalar-Vector OoO Execution (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 Scalar-Vector OoO Execution \u6a21\u578b\u91cc\uff0cscalar core \u548c vector core \u867d\u7136\u7269\u7406\u4e0a\u5206\u5f00\uff0c\u4f46\u903b\u8f91\u4e0a\u8026\u5408\u5f97\u5f88\u6b7b\u3002\u53ea\u8981 vector pipeline \u5f00\u59cb\u5e72\u6d3b\uff0cscalar core \u5c31\u5f97\u5728\u65c1\u8fb9\u5e72\u7b49\u7740\uff0c\u76f4\u5230\u8fd9\u4e2a vector \u6307\u4ee4\u5b8c\u5168\u6267\u884c\u5b8c\u3001\u5199\u56de\u5bc4\u5b58\u5668\u3001\u6b63\u5f0f commit \u4e4b\u540e\uff0cscalar core \u624d\u6562\u7ee7\u7eed\u3002 - \u8fd9\u79cd\u201c\u5168\u6709\u6216\u5168\u65e0\u201d\u7684\u7b49\u5f85\u7b56\u7565\u975e\u5e38\u4f4e\u6548\u3002\u56e0\u4e3a\u5927\u90e8\u5206 vector \u6307\u4ee4\uff08\u6bd4\u5982 <code>vadd.vv</code>\uff09\u6839\u672c\u4e0d\u4f1a\u4fee\u6539 scalar registers \u6216\u5f71\u54cd\u63a7\u5236\u6d41\uff0c\u5b83\u4eec\u53ea\u662f\u5728\u81ea\u5df1\u7684 VRF (Vector Register File) \u91cc\u6363\u9f13\u6570\u636e\u3002\u8ba9 scalar core \u4e3a\u8fd9\u79cd\u201c\u4e95\u6c34\u4e0d\u72af\u6cb3\u6c34\u201d\u7684\u64cd\u4f5c\u767d\u767d stall \u51e0\u5341\u4e2a\u751a\u81f3\u4e0a\u767e\u4e2a\u5468\u671f\uff0c\u7b80\u76f4\u662f\u5de8\u5927\u7684\u8d44\u6e90\u6d6a\u8d39\u3002 - \u7b80\u5355\u8bf4\uff0c\u75db\u70b9\u5c31\u662f\uff1a\u4e0d\u5fc5\u8981\u7684\u5e8f\u5217\u5316\u3002\u7cfb\u7edf\u660e\u660e\u6709\u8db3\u591f\u7684\u5e76\u884c\u80fd\u529b\uff08scalar \u548c vector \u7684\u529f\u80fd\u5355\u5143\u90fd\u95f2\u7740\uff09\uff0c\u5374\u88ab\u4e00\u4e2a\u8fc7\u4e8e\u4fdd\u5b88\u7684\u63d0\u4ea4\u6a21\u578b\u7ed9\u9501\u6b7b\u4e86\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u60f3\u8c61\u4f60\u548c\u4f60\u7684\u540c\u4e8b\u5728\u4e00\u4e2a\u5f00\u653e\u5f0f\u529e\u516c\u5ba4\u91cc\u5de5\u4f5c\u3002\u4f60\u7684\u4efb\u52a1\u662f\u5904\u7406\u4e00\u5806\u6587\u4ef6\uff08scalar work\uff09\uff0c\u4ed6\u7684\u4efb\u52a1\u662f\u7528\u4e00\u53f0\u5927\u578b\u6253\u5370\u673a\u6279\u91cf\u6253\u5370\u56fe\u7eb8\uff08vector work\uff09\u3002 - \u65e7\u7684\u505a\u6cd5\u662f\uff1a\u53ea\u8981\u4ed6\u6309\u4e0b\u201c\u5f00\u59cb\u6253\u5370\u201d\u6309\u94ae\uff0c\u4f60\u5c31\u5fc5\u987b\u7acb\u523b\u653e\u4e0b\u624b\u91cc\u7684\u6240\u6709\u6d3b\uff0c\u7ad9\u5728\u4ed6\u65c1\u8fb9\u76ef\u7740\u6253\u5370\u673a\uff0c\u76f4\u5230\u6700\u540e\u4e00\u5f20\u7eb8\u5410\u51fa\u6765\u3001\u4ed6\u7b7e\u5b8c\u5b57\u786e\u8ba4\u65e0\u8bef\uff08commit\uff09\u540e\uff0c\u4f60\u624d\u80fd\u56de\u53bb\u5e72\u81ea\u5df1\u7684\u4e8b\u3002\u8fd9\u663e\u7136\u5f88\u8822\uff0c\u56e0\u4e3a\u4f60\u4fe9\u7684\u5de5\u4f5c\u5b8c\u5168\u4e0d\u51b2\u7a81\u3002 - Issue-as-Commit \u7684\u505a\u6cd5\u662f\uff1a\u4ed6\u4e00\u6309\u4e0b\u201c\u5f00\u59cb\u6253\u5370\u201d\u6309\u94ae\uff08issue\uff09\uff0c\u4f60\u5c31\u77e5\u9053\u201c\u54e6\uff0c\u4ed6\u8981\u5fd9\u4e00\u9635\u5b50\u4e86\uff0c\u4f46\u8fd9\u4e8b\u513f\u8ddf\u6211\u6ca1\u5173\u7cfb\u201d\uff0c\u4e8e\u662f\u4f60\u7acb\u523b\u56de\u5230\u81ea\u5df1\u5de5\u4f4d\u7ee7\u7eed\u5904\u7406\u6587\u4ef6\u3002\u540c\u65f6\uff0c\u529e\u516c\u5ba4\u91cc\u6709\u4e2a\u7b80\u5355\u7684\u767d\u677f\uff08compact scoreboards\uff09\u8bb0\u5f55\u7740\u201c\u6253\u5370\u673a\u4efb\u52a1\u5df2\u542f\u52a8\uff0c\u9884\u8ba1\u8fd8\u9700\u8981X\u5206\u949f\u201d\u3002\u53ea\u6709\u5f53\u4ed6\u6253\u5370\u7684\u56fe\u7eb8\u91cc\u5305\u542b\u4e86\u4f60\u9700\u8981\u7b7e\u5b57\u7684\u5c01\u9762\u9875\uff08\u5373 vector \u6307\u4ee4\u771f\u7684\u8981\u5199 scalar register \u65f6\uff09\uff0c\u4f60\u624d\u4f1a\u88ab\u901a\u77e5\u6682\u505c\u4e00\u4e0b\u3002\u8fd9\u5c31\u662f\u9ad8\u6548\u7684\u5e76\u884c\u534f\u4f5c\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u6ca1\u6709\u6539\u53d8\u6574\u4e2a OoO \u5f15\u64ce\u7684\u6838\u5fc3\uff0c\u800c\u662f\u5de7\u5999\u5730\u91cd\u65b0\u5b9a\u4e49\u4e86 vector \u6307\u4ee4\u7684\u201c\u63d0\u4ea4\u201d\u65f6\u523b\u3002 - \u6838\u5fc3\u903b\u8f91\u8f6c\u6362\uff1a\u5bf9\u4e8e\u7edd\u5927\u591a\u6570\u53ea\u5728 VRF \u5185\u90e8\u64cd\u4f5c\u7684 vector \u6307\u4ee4\uff0c\u5b83\u4eec\u7684\u201c\u63d0\u4ea4\u201d\u4e0d\u518d\u662f\u7b49\u5230\u5199\u56de\u5b8c\u6210\uff0c\u800c\u662f\u5728\u5b83\u4eec\u88ab\u6210\u529f\u5206\u53d1\uff08issue\uff09\u5230 vector pipeline \u7684\u90a3\u4e00\u523b\u5c31\u7b97\u5b8c\u6210\u4e86\u3002 - \u4e3a\u4e86\u652f\u6491\u8fd9\u4e2a\u5927\u80c6\u7684\u5047\u8bbe\uff0c\u4f5c\u8005\u5f15\u5165\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 vector scoreboard\u3002\u8fd9\u4e2a scoreboard \u4e0d\u8d1f\u8d23\u8ffd\u8e2a\u590d\u6742\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u5b83\u7684\u552f\u4e00\u4f5c\u7528\u5c31\u662f\u544a\u8bc9 scalar core\uff1a\u201c\u653e\u5fc3\uff0c\u8fd9\u4e2a vector \u6307\u4ee4\u5df2\u7ecf\u5b89\u5168\u5730\u8fdb\u5165\u6d41\u6c34\u7ebf\u4e86\uff0c\u5b83\u4e0d\u4f1a\u5f71\u54cd\u4f60\uff0c\u4f60\u53ef\u4ee5\u7ee7\u7eed\u5f80\u524d\u8dd1\u201d\u3002 - \u5f53\u7136\uff0c\u8fd9\u4e2a\u7b56\u7565\u6709\u4f8b\u5916\u3002\u5982\u679c\u4e00\u4e2a vector \u6307\u4ee4\u786e\u5b9e\u9700\u8981\u5199 scalar register\uff08\u6bd4\u5982 <code>vmv.x.s</code>\uff09\u6216\u8005\u53ef\u80fd\u629b\u51fa\u5f02\u5e38\uff0c\u90a3\u4e48\u5b83\u8fd8\u662f\u4f1a\u8d70\u4f20\u7edf\u7684\u3001\u66f4\u4e25\u683c\u7684\u63d0\u4ea4\u6d41\u7a0b\uff0c\u786e\u4fdd\u6b63\u786e\u6027\u3002\u4f46\u5bf9\u4e8e\u5360\u7edd\u5927\u591a\u6570\u7684\u7eaf vector \u8ba1\u7b97\u6307\u4ee4\uff0c\u8fd9\u4e2a\u201cissue-as-commit\u201d\u7684\u7b56\u7565\u6781\u5927\u5730\u89e3\u653e\u4e86 scalar core\uff0c\u8ba9\u5b83\u80fd\u4e0e vector core \u771f\u6b63\u5730 overlap execution\uff0c\u4ece\u800c\u663e\u8457\u63d0\u5347\u4e86\u6574\u4f53\u541e\u5410\u91cf\u3002\u6b63\u5982\u6587\u4e2d\u6240\u8bf4\uff0c\u8fd9\u5957\u673a\u5236\u53ea\u7ed9 scalar core \u589e\u52a0\u4e86\u7ea6 3% \u7684\u9762\u79ef\u5f00\u9500\uff0c\u5374\u6362\u6765\u4e86\u5de8\u5927\u7684\u6027\u80fd\u6536\u76ca\u3002</p> <p></p> <p>Figure 6: Different ILP Technology in T1. Chaining interleaves V0, V1, and V2. Memory Interleaving mitigates the VSW-VLD dependency. Vector-Scalar OoO interleaves the vector and scalar pipelines until a true dependency v16-s64-v15 occurs. Memory Delay Slot parallelizes vector index load/store (VIDX0) with independent vector executions (VEX0).</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/ELI5_notes/#6-dual-lsu-with-memory-interleaving-and-delay-slots-eli5","title":"6. Dual LSU with Memory Interleaving and Delay Slots (ELI5)","text":"<p>\u75db\u70b9\u76f4\u51fb (The \"Why\") - \u4f20\u7edf\u7684 Vector Core \u901a\u5e38\u53ea\u6709\u4e00\u4e2a LSU\uff08Load-Store Unit\uff09\uff0c\u5b83\u5fc5\u987b\u5904\u7406\u6240\u6709\u7c7b\u578b\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff1a\u7b80\u5355\u7684 unit-stride\uff08\u8fde\u7eed\u5730\u5740\uff09\u3001\u590d\u6742\u7684 indexed/strided\uff08\u975e\u8fde\u7eed\u3001\u8df3\u8dc3\u5f0f\uff09\u4ee5\u53ca segment\uff08\u4e00\u6b21\u64cd\u4f5c\u591a\u4e2a\u5bc4\u5b58\u5668\uff09\u3002 - \u8fd9\u5bfc\u81f4\u4e86\u4e24\u4e2a\u6838\u5fc3\u77db\u76fe\uff1a   - \u5e26\u5bbd\u6d6a\u8d39\uff1a\u5bf9\u4e8e\u6700\u9ad8\u6548\u7684 unit-stride \u8bbf\u95ee\uff0c\u7531\u4e8e load \u548c store \u64cd\u4f5c\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c\uff08\u901a\u5e38\u662f\u4ea4\u66ff\u6267\u884c\uff09\uff0c\u5b9d\u8d35\u7684\u5185\u5b58\u603b\u7ebf\u5e26\u5bbd\u88ab\u6d6a\u8d39\u4e86\u4e00\u534a\u3002\u60f3\u8c61\u4e00\u4e0b\uff0c\u4f60\u6709\u4e00\u6761\u53cc\u5411\u516b\u8f66\u9053\u7684\u9ad8\u901f\u516c\u8def\uff0c\u4f46\u6bcf\u6b21\u53ea\u5141\u8bb8\u4e00\u4e2a\u65b9\u5411\u901a\u8f66\u3002   - \u5ef6\u8fdf\u707e\u96be\uff1a\u5bf9\u4e8e indexed \u8bbf\u95ee\uff0c\u6bcf\u4e2a\u5143\u7d20\u7684\u5730\u5740\u90fd\u9700\u8981\u4ece\u5411\u91cf\u5bc4\u5b58\u5668\u4e2d\u8bfb\u53d6\uff0c\u8fd9\u4f1a\u4ea7\u751f\u6d77\u91cf\u7684\u3001\u968f\u673a\u7684\u5185\u5b58\u8bf7\u6c42\u3002\u8fd9\u4e9b\u8bf7\u6c42\u7684\u5ef6\u8fdf\u6781\u9ad8\uff08\u53ef\u80fd\u6210\u5343\u4e0a\u4e07\u4e2a\u5468\u671f\uff09\uff0c\u800c\u4f20\u7edf\u7684\u987a\u5e8f\u6267\u884c\u4f1a\u8ba9\u6574\u4e2a\u5411\u91cf\u6d41\u6c34\u7ebf\u5b8c\u5168\u5361\u6b7b\uff0c\u76f4\u5230\u6240\u6709\u6570\u636e\u90fd\u8fd4\u56de\uff0cCPU \u53ea\u80fd\u5e72\u7b49\u3002</p> <p>\u901a\u4fd7\u6bd4\u65b9 (The Analogy) - \u628a T1 \u7684\u5185\u5b58\u5b50\u7cfb\u7edf\u60f3\u8c61\u6210\u4e00\u4e2a\u73b0\u4ee3\u5316\u7684\u7269\u6d41\u4e2d\u5fc3\u3002   - HBLSU (High Bandwidth LSU) \u5c31\u50cf\u4e00\u6761\u9ad8\u5ea6\u81ea\u52a8\u5316\u7684 \u201c\u96c6\u88c5\u7bb1\u4e13\u7ebf\u201d\u3002\u5b83\u4e13\u95e8\u5904\u7406\u5927\u6279\u91cf\u3001\u89c4\u5219\u5806\u653e\u7684\u8d27\u7269\uff08unit-stride \u6570\u636e\uff09\u3002\u8fd9\u6761\u4e13\u7ebf\u6709\u72ec\u7acb\u7684 \u8fdb\u8d27\uff08load\uff09\u548c\u51fa\u8d27\uff08store\uff09\u901a\u9053\uff0c\u53ef\u4ee5\u540c\u65f6\u5de5\u4f5c\uff0c\u4e92\u4e0d\u5e72\u6270\uff0c\u6548\u7387\u62c9\u6ee1\u3002   - HOLSU (High Outstanding LSU) \u5219\u50cf\u662f\u4e00\u4e2a\u7075\u6d3b\u7684 \u201c\u5feb\u9012\u5206\u62e3\u7ad9\u201d\u3002\u5b83\u5904\u7406\u7684\u662f\u5730\u5740\u5206\u6563\u3001\u5305\u88f9\u5404\u5f02\u7684\u8ba2\u5355\uff08indexed/strided \u6570\u636e\uff09\u3002\u8fd9\u4e2a\u5206\u62e3\u7ad9\u4e0d\u4f1a\u56e0\u4e3a\u4e00\u4e2a\u504f\u8fdc\u5730\u533a\u7684\u5305\u88f9\u6ca1\u5230\u5c31\u505c\u6b62\u6240\u6709\u5de5\u4f5c\uff0c\u800c\u662f\u4f1a\u5148\u5904\u7406\u624b\u5934\u5176\u4ed6\u80fd\u5904\u7406\u7684\u8ba2\u5355\uff0c\u5e76\u4e14\u5141\u8bb8\u540e\u53f0\u7ee7\u7eed\u63a5\u6536\u65b0\u8ba2\u5355\uff0c\u628a\u7b49\u5f85\u65f6\u95f4\uff08\u5ef6\u8fdf\uff09\u9690\u85cf\u8d77\u6765\u3002 - Memory Interleaving \u5c31\u662f\u8ba9\u201c\u96c6\u88c5\u7bb1\u4e13\u7ebf\u201d\u7684\u8fdb\u8d27\u548c\u51fa\u8d27\u901a\u9053 \u540c\u65f6\u8fd0\u8f6c\u3002 - Delay Slots \u5c31\u662f\u7ed9\u201c\u5feb\u9012\u5206\u62e3\u7ad9\u201d\u914d\u5907\u4e86 \u667a\u80fd\u8c03\u5ea6\u7cfb\u7edf\uff0c\u8ba9\u5b83\u5728\u7b49\u5f85\u6162\u901f\u5305\u88f9\u65f6\uff0c\u80fd\u7acb\u523b\u5207\u6362\u53bb\u5904\u7406\u5176\u4ed6\u4e0d\u76f8\u5173\u7684\u4efb\u52a1\u3002</p> <p>\u5173\u952e\u4e00\u62db (The \"How\") - \u4f5c\u8005\u6ca1\u6709\u8bd5\u56fe\u7528\u4e00\u4e2a\u201c\u5168\u80fd\u201d\u4f46\u5e73\u5eb8\u7684 LSU \u53bb\u5e94\u4ed8\u6240\u6709\u573a\u666f\uff0c\u800c\u662f\u8fdb\u884c\u4e86 \u529f\u80fd\u89e3\u8026\uff0c\u8bbe\u8ba1\u4e86\u4e24\u4e2a\u9ad8\u5ea6\u4e13\u4e1a\u5316\u7684 LSU\u3002 - \u5bf9\u4e8e\u9ad8\u5e26\u5bbd\u573a\u666f (HBLSU + Memory Interleaving)\uff1a   - \u4f5c\u8005\u5f15\u5165\u4e86\u4e00\u4e2a Conflict Region Table (CRT)\u3002\u5f53\u4e00\u4e2a load \u6216 store \u6307\u4ee4\u8fdb\u5165 HBLSU \u65f6\uff0cCRT \u4f1a\u8bb0\u5f55\u4e0b\u5b83\u8981\u8bbf\u95ee\u7684\u5185\u5b58\u533a\u57df\u3002   - \u540e\u7eed\u7684\u6307\u4ee4\u5728\u53d1\u5c04\u524d\u4f1a\u67e5\u8be2 CRT\u3002\u5982\u679c\u5b83\u7684\u8bbf\u95ee\u533a\u57df\u4e0e\u6b63\u5728\u5904\u7406\u7684\u6307\u4ee4 \u4e0d\u51b2\u7a81\uff0c\u90a3\u4e48\u5b83\u5c31\u53ef\u4ee5 \u7acb\u5373\u53d1\u5c04\uff0c\u5373\u4f7f\u524d\u4e00\u4e2a\u6307\u4ee4\u8fd8\u6ca1\u5b8c\u6210\u3002   - \u8fd9\u6837\uff0cload \u548c store \u6307\u4ee4\u5c31\u80fd \u771f\u6b63\u5e76\u53d1 \u5730\u4f7f\u7528\u5404\u81ea\u7684\u5185\u5b58\u901a\u9053\uff0c\u5c06\u7406\u8bba\u5e26\u5bbd\u5229\u7528\u7387\u4ece 50% \u63d0\u5347\u5230\u63a5\u8fd1 100%\u3002</p> <p></p> <p>Figure 6: Different ILP Technology in T1. Chaining interleaves V0, V1, and V2. Memory Interleaving mitigates the VSW-VLD dependency. Vector-Scalar OoO interleaves the vector and scalar pipelines until a true dependency v16-s64-v15 occurs. Memory Delay Slot parallelizes vector index load/store (VIDX0) with independent vector executions (VEX0).</p> <ul> <li>\u5bf9\u4e8e\u9ad8\u5ef6\u8fdf\u573a\u666f (HOLSU + Delay Slots)\uff1a</li> <li>HOLSU \u88ab\u8bbe\u8ba1\u6210\u53ef\u4ee5\u7ef4\u6301 \u5927\u91cf\uff08High Outstanding\uff09 \u7684\u672a\u5b8c\u6210\u5185\u5b58\u8bf7\u6c42\u3002</li> <li>\u66f4\u5173\u952e\u7684\u662f\uff0c\u4f5c\u8005\u5229\u7528\u4e86 RVV \u7684\u7279\u6027\uff0c\u901a\u8fc7\u4e00\u4e2a CSR \u201cchicken bit\u201d \u6765\u544a\u8bc9\u786c\u4ef6\uff1a\u5bf9\u4e8e\u67d0\u4e9b\u5df2\u77e5\u5b89\u5168\u7684 indexed \u64cd\u4f5c\uff0c\u53ef\u4ee5 \u5ffd\u7565\u7cbe\u786e\u5f02\u5e38\u3002</li> <li>\u4e00\u65e6\u8fd9\u4e2a\u5f00\u5173\u6253\u5f00\uff0c\u540e\u7eed \u4e0d\u4f9d\u8d56\u4e8e\u8be5 indexed \u64cd\u4f5c\u7ed3\u679c \u7684\u6307\u4ee4\u5c31\u53ef\u4ee5\u88ab \u7acb\u5373\u53d1\u5c04\u548c\u6267\u884c\uff0c\u5c31\u50cf\u5728\u6307\u4ee4\u6d41\u4e2d\u4eba\u4e3a\u5f00\u8f9f\u4e86\u4e00\u4e2a \u201c\u5ef6\u8fdf\u69fd\uff08Delay Slot\uff09\u201d\uff0c\u8ba9\u8ba1\u7b97\u5355\u5143\u5728\u7b49\u5f85\u5185\u5b58\u6570\u636e\u65f6\u4e5f\u80fd\u4fdd\u6301\u5fd9\u788c\uff0c\u4ece\u800c\u5c06\u6f2b\u957f\u7684\u5185\u5b58\u5ef6\u8fdf\u5b8c\u7f8e\u5730\u201c\u85cf\u201d\u5728\u4e86\u6709\u7528\u7684\u8ba1\u7b97\u5de5\u4f5c\u4e4b\u4e0b\u3002</li> </ul> <p></p> <p>Figure 6: Different ILP Technology in T1. Chaining interleaves V0, V1, and V2. Memory Interleaving mitigates the VSW-VLD dependency. Vector-Scalar OoO interleaves the vector and scalar pipelines until a true dependency v16-s64-v15 occurs. Memory Delay Slot parallelizes vector index load/store (VIDX0) with independent vector executions (VEX0).</p> <p>\u8fd9\u79cd\u53cc\u7ba1\u9f50\u4e0b\u7684\u7b56\u7565\uff0c\u8ba9 T1 \u5728\u9762\u5bf9\u4e0d\u540c workload \u65f6\u90fd\u80fd\u53d1\u6325\u51fa\u6781\u81f4\u7684\u5185\u5b58\u5b50\u7cfb\u7edf\u6027\u80fd\uff0c\u8fd9\u4e5f\u662f\u5b83\u80fd\u5728 HPC \u548c Cryptography \u7b49\u5185\u5b58\u5bc6\u96c6\u578b\u4efb\u52a1\u4e0a\u5927\u5e45\u9886\u5148\u7684\u5173\u952e\u3002\u5982 Table 1 \u6240\u793a\uff0c\u4ec5 Memory Interleaving \u4e00\u9879\u6280\u672f\u5c31\u80fd\u5e26\u6765 32% \u7684\u6027\u80fd\u63d0\u5347\u3002</p> \u914d\u7f6e Cycles Slow Down Standard T1 14817 - Disable Chaining 23862 61% Disable Memory Interleaving 19514 32%"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/","title":"Titan-I: An Open-Source, High Performance RISC-V Vector Core \u56fe\u8868\u8be6\u89e3","text":""},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#figure-1-execution-cycles-for-different-standalone-workloads-on-datapath-size-of-t1-from-128-to-1024","title":"Figure 1: Execution Cycles for Different Standalone Workloads on Datapath Size of T1 from 128 to 1024.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 Titan-I (T1) \u5728\u4e0d\u540c\u6570\u636e\u901a\u8def\u5bbd\u5ea6\uff08DLEN\uff09\u4e0b\uff0c\u6267\u884c\u591a\u79cd\u72ec\u7acb\u5de5\u4f5c\u8d1f\u8f7d\u65f6\u7684\u76f8\u5bf9\u52a0\u901f\u6bd4\u3002\u6a2a\u8f74\u4e3a\u5de5\u4f5c\u8d1f\u8f7d\u7c7b\u578b\uff0c\u7eb5\u8f74\u4e3a\u76f8\u5bf9\u4e8e\u57fa\u51c6\uff08DLEN=128\uff09\u7684\u6027\u80fd\u63d0\u5347\u500d\u6570\u3002</li> <li>\u56fe\u4f8b\u6e05\u6670\u6807\u660e\u4e86\u56db\u79cd DLEN \u914d\u7f6e\uff1aDLEN128\uff08\u84dd\u8272\uff09\u3001DLEN256\uff08\u7ea2\u8272\uff09\u3001DLEN512\uff08\u7c73\u8272\uff09\u3001DLEN1024\uff08\u6df1\u7070\u8272\uff09\u3002\u968f\u7740 DLEN \u589e\u52a0\uff0c\u67f1\u72b6\u56fe\u9ad8\u5ea6\u666e\u904d\u4e0a\u5347\uff0c\u8868\u660e\u6027\u80fd\u63d0\u5347\u3002</li> <li>\u5de5\u4f5c\u8d1f\u8f7d\u5305\u62ec\uff1aMEMSET\u3001ASCII-TO-UTF32\u3001BYTESWAP\u3001LINEAR-NORMALIZATION\u3001SAXPY\u3001SGEMM\u3002\u8fd9\u4e9b\u662f\u5178\u578b\u7684\u5411\u91cf\u5316\u64cd\u4f5c\uff0c\u7528\u4e8e\u8bc4\u4f30 T1 \u7684 DLP \u6269\u5c55\u80fd\u529b\u3002</li> <li>SGEMM \u548c SAXPY \u4e24\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u5728 DLEN1024 \u4e0b\u8868\u73b0\u6700\u4e3a\u7a81\u51fa\uff0c\u52a0\u901f\u6bd4\u5747\u8d85\u8fc7 4x\uff0c\u663e\u793a\u51fa T1 \u5728\u77e9\u9635\u8fd0\u7b97\u548c\u5411\u91cf\u8fd0\u7b97\u4e0a\u7684\u5f3a\u5927\u6269\u5c55\u6027\u3002</li> <li>MEMSET \u548c LINEAR-NORMALIZATION \u5728 DLEN1024 \u4e0b\u4e5f\u8fbe\u5230\u4e86\u63a5\u8fd1 4x \u7684\u52a0\u901f\u6bd4\uff0c\u8bf4\u660e T1 \u5728\u5185\u5b58\u5bc6\u96c6\u578b\u548c\u6570\u636e\u8f6c\u6362\u578b\u4efb\u52a1\u4e0a\u540c\u6837\u9ad8\u6548\u3002</li> <li>BYTESWAP \u548c ASCII-TO-UTF32 \u7684\u52a0\u901f\u6bd4\u76f8\u5bf9\u8f83\u4f4e\uff0c\u4f46 DLEN1024 \u4ecd\u80fd\u63d0\u4f9b\u7ea6 2.5x \u7684\u6027\u80fd\u63d0\u5347\uff0c\u8868\u660e\u5373\u4f7f\u5bf9\u4e8e\u975e\u8ba1\u7b97\u5bc6\u96c6\u578b\u4efb\u52a1\uff0c\u66f4\u5bbd\u7684\u6570\u636e\u901a\u8def\u4e5f\u80fd\u5e26\u6765\u663e\u8457\u6536\u76ca\u3002</li> <li>\u6574\u4f53\u8d8b\u52bf\u663e\u793a\uff0cT1 \u7684\u6027\u80fd\u968f DLEN \u589e\u52a0\u800c\u7ebf\u6027\u6216\u8d85\u7ebf\u6027\u589e\u957f\uff0c\u9a8c\u8bc1\u4e86\u5176\u5fae\u67b6\u6784\u8bbe\u8ba1\u5728\u6269\u5c55 DLP \u65b9\u9762\u7684\u6709\u6548\u6027\u3002</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d DLEN128 DLEN256 DLEN512 DLEN1024 MEMSET 1.0x ~1.8x ~3.0x ~4.0x ASCII-TO-UTF32 1.0x ~1.5x ~2.0x ~2.5x BYTESWAP 1.0x ~1.5x ~2.0x ~2.5x LINEAR-NORMALIZATION 1.0x ~1.8x ~3.0x ~4.0x SAXPY 1.0x ~2.0x ~3.5x ~4.5x SGEMM 1.0x ~2.0x ~3.5x ~4.5x <ul> <li>\u6b64\u56fe\u8868\u76f4\u89c2\u8bc1\u660e\u4e86 T1 \u67b6\u6784\u901a\u8fc7\u589e\u52a0 DLEN \u6765\u63d0\u5347\u6027\u80fd\u7684\u8bbe\u8ba1\u7406\u5ff5\uff0c\u5c24\u5176\u5728\u9ad8\u5e76\u884c\u5ea6\u7684 HPC \u548c AI \u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u6548\u679c\u663e\u8457\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#figure-2-static-cross-lane-access-for-widen-and-narrow-in-this-access-pattern-the-i-th-lane-accessing-the-2i-bmod-n-th-and-2i-1-bmod-n-th-lane","title":"Figure 2: Static Cross Lane Access For widen and narrow; In this access pattern, the $i$ -th lane accessing the $(2i \\bmod n)$ -th and $(2i + 1 \\bmod n)$ -th lane.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 T1 \u67b6\u6784\u4e2d\u7528\u4e8e widen \u548c narrow \u6307\u4ee4\u7684\u9759\u6001\u8de8lane\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\uff0c\u8be5\u6a21\u5f0f\u5728\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\u4e2d\u81f3\u5173\u91cd\u8981\u3002</li> <li>\u8be5\u56fe\u63cf\u7ed8\u4e86\u4e00\u4e2a\u5305\u542b 8\u4e2alane\uff08Lane 0 \u81f3 Lane 7\uff09\u7684\u7cfb\u7edf\uff0c\u6bcf\u4e2alane\u5747\u5305\u542b\u4e00\u4e2a src\uff08\u6e90\uff09\u548c\u4e00\u4e2a sink\uff08\u76ee\u7684\uff09\u7aef\u53e3\u3002</li> <li>\u6839\u636e\u56fe\u6ce8\u8bf4\u660e\uff0c\u7b2c i \u4e2alane\u4f1a\u8bbf\u95ee\u7b2c (2i mod n) \u548c (2i + 1 mod n) \u4e2alane\uff0c\u5176\u4e2d n = 8\u3002</li> <li>\u4e0b\u8868\u5217\u51fa\u4e86\u6bcf\u4e2a\u6e90lane\u5bf9\u5e94\u7684\u4e24\u4e2a\u76ee\u6807lane\uff1a</li> </ul> Source Lane (i) Target Lane 1 (2i mod 8) Target Lane 2 (2i + 1 mod 8) 0 0 1 1 2 3 2 4 5 3 6 7 4 0 1 5 2 3 6 4 5 7 6 7 <ul> <li>\u4ece\u56fe\u4e2d\u53ef\u89c1\uff0cLane 0 \u7684\u6570\u636e\u6d41\u5411 Lane 0 \u548c Lane 1\uff1bLane 1 \u7684\u6570\u636e\u6d41\u5411 Lane 2 \u548c Lane 3\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</li> <li>\u8fd9\u79cd\u8bbf\u95ee\u6a21\u5f0f\u5bfc\u81f4\u4e86\u590d\u6742\u7684\u4ea4\u53c9\u5e03\u7ebf\uff0c\u4f8b\u5982 Lane 3 \u7684\u6570\u636e\u9700\u8981\u8de8\u8d8a\u591a\u4e2a\u7269\u7406\u8ddd\u79bb\u624d\u80fd\u5230\u8fbe Lane 6 \u548c Lane 7\u3002</li> <li>\u6b64\u7c7b\u8de8lane\u8bbf\u95ee\u662f routing contention \u7684\u4e3b\u8981\u6765\u6e90\uff0c\u5c24\u5176\u5728\u6269\u5c55 DLEN \u65f6\uff0c\u4f1a\u663e\u8457\u589e\u52a0\u5e03\u7ebf\u5ef6\u8fdf\u548c\u529f\u8017\u3002</li> <li>\u8bba\u6587\u5728 Section 4.1.1 \u4e2d\u63d0\u51fa\u4e86\u4e00\u79cd coarse floorplan solver \u6765\u4f18\u5316\u6b64\u7c7b\u8bbf\u95ee\u6a21\u5f0f\u4e0b\u7684\u7269\u7406\u5e03\u5c40\uff0c\u4ee5\u6700\u5c0f\u5316\u6700\u5927\u8def\u7531\u8ddd\u79bb\uff0c\u4ece\u800c\u964d\u4f4e\u5ef6\u8fdf\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#figure-3-architecture-of-t1","title":"Figure 3: Architecture of T1","text":"<ul> <li> <p>\u6574\u4f53\u67b6\u6784\u6982\u89c8\uff1a\u56fe 3 \u5c55\u793a\u4e86 Titan-I (T1) \u7684\u5b8c\u6574\u5fae\u67b6\u6784\uff0c\u91c7\u7528\u5206\u5c42\u3001\u6a21\u5757\u5316\u8bbe\u8ba1\uff0c\u6838\u5fc3\u7ec4\u4ef6\u5305\u62ec Scalar Core\u3001Sequencer\u3001Lanes\u3001Permutation Unit \u548c Memory Subsystem\uff0c\u901a\u8fc7\u6e05\u6670\u7684\u6570\u636e\u6d41\u548c\u63a7\u5236\u6d41\u8fde\u63a5\uff0c\u5b9e\u73b0\u9ad8\u5e76\u53d1\u4e0e\u4f4e\u5ef6\u8fdf\u3002</p> </li> <li> <p>Scalar Core\uff08\u6807\u91cf\u6838\u5fc3\uff09\uff1a</p> </li> <li>\u4f4d\u4e8e\u67b6\u6784\u9876\u90e8\uff0c\u8d1f\u8d23\u6307\u4ee4\u83b7\u53d6\uff08Fetch IN\uff09\u3001\u9884\u89e3\u7801\uff08ID\uff09\u3001\u6267\u884c\uff08EXEC\uff09\u3001\u5185\u5b58\u64cd\u4f5c\uff08MEM\uff09\u548c\u63d0\u4ea4\uff08COMMIT\uff09\u3002</li> <li>\u5305\u542b ICache\u3001IQ\uff08Instruction Queue\uff09\u3001FP0/FP1\uff08\u6d6e\u70b9\u5355\u5143\uff09\u3001LSU\uff08Load/Store Unit\uff09\u7b49\u4f20\u7edf\u6807\u91cf\u6d41\u6c34\u7ebf\u6a21\u5757\u3002</li> <li> <p>\u901a\u8fc7 Vector Scoreboards \u4e0e\u5411\u91cf\u90e8\u5206\u534f\u540c\uff0c\u652f\u6301 issue-as-commit \u7b56\u7565\uff0c\u5141\u8bb8\u6807\u91cf\u6307\u4ee4\u5728\u65e0\u771f\u5b9e\u4f9d\u8d56\u65f6\u63d0\u524d\u63d0\u4ea4\uff0c\u63d0\u5347\u541e\u5410\u3002</p> </li> <li> <p>Sequencer\uff08\u5e8f\u5217\u5668\uff09\uff1a</p> </li> <li>\u4f5c\u4e3a\u5411\u91cf\u63a7\u5236\u4e2d\u5fc3\uff0c\u63a5\u6536\u6765\u81ea\u6807\u91cf\u6838\u5fc3\u7684\u6307\u4ee4\uff0c\u8fdb\u884c\u5411\u91cf\u6307\u4ee4\u89e3\u7801\uff08IQ, ID\uff09\uff0c\u5e76\u751f\u6210\u63a7\u5236\u4fe1\u53f7\u5206\u53d1\u81f3\u5404\u7ec4\u4ef6\u3002</li> <li>\u5185\u7f6e VType Cache\uff0c\u7528\u4e8e\u7f13\u5b58 vsetvli \u7b49\u914d\u7f6e\u6307\u4ee4\uff0c\u5b9e\u73b0\u914d\u7f6e\u6307\u4ee4\u878d\u5408\uff0c\u907f\u514d\u56e0\u7b49\u5f85\u914d\u7f6e\u6307\u4ee4\u9000\u4f11\u800c\u9020\u6210\u7684\u5e26\u5bbd\u635f\u5931\u3002</li> <li> <p>\u901a\u8fc7 Global Scoreboard (SB0) \u7ba1\u7406\u5168\u5c40\u4f9d\u8d56\uff0c\u534f\u8c03\u591a\u4e2a Lane \u7684\u6267\u884c\u3002</p> </li> <li> <p>Lane\uff08\u5411\u91cf\u5904\u7406\u5355\u5143\uff09\uff1a</p> </li> <li>\u67b6\u6784\u4e3b\u4f53\uff0c\u7531\u591a\u4e2a\u72ec\u7acb\u7684 Lane \u7ec4\u6210\uff0c\u6bcf\u4e2a Lane \u5305\u542b\u5b8c\u6574\u7684\u6267\u884c\u6d41\u6c34\u7ebf\uff08FE, RF, EX, CM\uff09\u3002</li> <li>FE\uff08Frontend\uff09\uff1a\u4ece Scoreboard \u83b7\u53d6 uop \u53ca\u5176 mask\uff0c\u652f\u6301speculative zero-mask elision\uff0c\u8df3\u8fc7\u5168\u96f6\u63a9\u7801\u7684\u65e0\u6548\u8ba1\u7b97\u3002</li> <li>RF\uff08Operand Sync\uff09\uff1a\u540c\u6b65\u6765\u81ea\u672c\u5730 VRF\u3001\u8de8 Lane \u901a\u9053\u53ca\u524d\u5e8f\u6d41\u6c34\u7ebf\u7684\u6e90\u64cd\u4f5c\u6570\u3002</li> <li>EX\uff08Execution\uff09\uff1a\u5305\u542b\u5f02\u6784 VFU \u9635\u5217\uff0c\u5982 ALU\u3001MUL\u3001FALU\u3001FMAC\uff0c\u652f\u6301\u65f6\u95f4\u5171\u4eab\u4ee5\u8282\u7701\u9762\u79ef\u3002</li> <li>CM\uff08Commit\uff09\uff1a\u5c06\u7ed3\u679c\u5199\u5165 VRF \u6216\u53d1\u9001\u81f3\u8de8 Lane \u901a\u9053\uff0c\u5e76\u5411 Sequencer \u53d1\u9001\u5b8c\u6210\u4fe1\u53f7\u3002</li> <li> <p>\u6bcf\u4e2a Lane \u5185\u90e8\u8bbe\u6709 Chaining Record\uff0c\u8bb0\u5f55\u5b50\u5b57\uff08ELEN \u00d7 LaneScale\uff09\u7684\u5199\u72b6\u6001\uff0c\u652f\u6301\u7ec6\u7c92\u5ea6\u94fe\u5f0f\u6267\u884c\u3002</p> </li> <li> <p>Permutation Unit\uff08\u7f6e\u6362\u5355\u5143\uff09\uff1a</p> </li> <li>\u4f4d\u4e8e\u4e2d\u592e\uff0c\u662f T1 \u5b9e\u73b0\u9ad8\u6027\u80fd\u6570\u636e\u91cd\u6392\u7684\u6838\u5fc3\u3002</li> <li>\u5305\u542b DLEN \u5bbd\u5ea6\u7684 Crossbar \u548c\u4e13\u7528 Permutation FUs\uff0c\u652f\u6301\u9759\u6001\uff08\u5982 extend, slide\uff09\u548c\u52a8\u6001\uff08\u5982 rgather\uff09\u8de8 Lane \u6570\u636e\u79fb\u52a8\u3002</li> <li>\u96c6\u6210 Shadow Mask (v0) \u5bc4\u5b58\u5668\u7f13\u5b58\uff0c\u907f\u514d\u6bcf\u6b21 predicated \u6307\u4ee4\u90fd\u9700\u8de8 Lane \u5e7f\u64ad v0\uff0c\u663e\u8457\u964d\u4f4e\u5e03\u7ebf\u538b\u529b\u3002</li> <li> <p>\u901a\u8fc7 Lane-to-Permutation \u6570\u636e\u901a\u9053\u66f4\u65b0 Shadow Mask\uff0c\u786e\u4fdd\u4e00\u81f4\u6027\u3002</p> </li> <li> <p>Memory Subsystem\uff08\u5185\u5b58\u5b50\u7cfb\u7edf\uff09\uff1a</p> </li> <li>\u5305\u542b\u4e24\u4e2a\u4e13\u7528 LSU\uff1a<ul> <li>HBLSU\uff08High Bandwidth LSU\uff09\uff1a\u4f18\u5316\u5355\u4f4d\u6b65\u957f\u8bbf\u95ee\uff0c\u652f\u6301\u5185\u5b58\u4ea4\u9519\uff08Memory Interleaving\uff09\uff0c\u5141\u8bb8 Load \u548c Store \u540c\u65f6\u8fdb\u884c\uff0c\u63d0\u5347\u5e26\u5bbd\u5229\u7528\u7387\u3002\u5185\u7f6e Conflict Region Table (CRT) \u7ba1\u7406\u5730\u5740\u51b2\u7a81\u3002</li> <li>HOLSU\uff08High Outstanding LSU\uff09\uff1a\u5904\u7406\u5e38\u91cf\u6b65\u957f\u548c\u7d22\u5f15\u8bbf\u95ee\uff0c\u652f\u6301 ELEN \u5bbd\u5ea6\u7684\u591a\u6761 Inflight Transactions\uff0c\u914d\u5408 Memory Delay Slot \u673a\u5236\u9690\u85cf\u957f\u5ef6\u8fdf\u3002</li> </ul> </li> <li> <p>\u652f\u6301 Segment Load/Store Regroup Unit\uff0c\u5bf9\u975e\u8fde\u7eed\u8bbf\u95ee\u8fdb\u884c\u91cd\u65b0\u5bf9\u9f50\uff0c\u63d0\u9ad8\u7247\u5185\u5e26\u5bbd\u6548\u7387\u3002</p> </li> <li> <p>\u5173\u952e\u521b\u65b0\u70b9\u89c6\u89c9\u5448\u73b0\uff1a</p> </li> <li>Chaining\uff1a\u56fe\u4e2d\u7528\u7ea2\u8272\u865a\u7ebf\u6846\u51fa EX \u5230 CM \u7684\u8def\u5f84\uff0c\u5f3a\u8c03\u6570\u636e\u53ef\u76f4\u63a5\u8f6c\u53d1\uff0c\u65e0\u9700\u7b49\u5f85\u6574\u6761\u6307\u4ee4\u5b8c\u6210\u3002</li> <li>Memory Interleaving\uff1aHBLSU \u4e2d Load BIU \u548c Store BIU \u5e76\u884c\u5de5\u4f5c\uff0c\u4f53\u73b0\u8d1f\u8f7d/\u5b58\u50a8\u91cd\u53e0\u3002</li> <li>Shadow Mask\uff1a\u7eff\u8272\u65b9\u5757\u660e\u786e\u6807\u6ce8 \u201cShadow Mask (v0) Flip-Flops\u201d\uff0c\u7a81\u51fa\u5176\u4f5c\u4e3a\u5bc4\u5b58\u5668\u7f13\u5b58\u7684\u89d2\u8272\u3002</li> <li> <p>Lane Decoupling\uff1a\u591a\u4e2a Lane \u6a21\u5757\u5e76\u5217\uff0c\u8868\u660e\u5176\u7269\u7406\u9694\u79bb\u548c\u72ec\u7acb\u8fd0\u884c\u80fd\u529b\u3002</p> </li> <li> <p>\u6570\u636e\u6d41\u4e0e\u63a7\u5236\u6d41\uff1a</p> </li> <li>\u63a7\u5236\u6d41\u4e3b\u8981\u7531 Sequencer \u9a71\u52a8\uff0c\u901a\u8fc7 SB0 \u548c\u5404 Lane \u7684 SBn \u534f\u8c03\u3002</li> <li>\u6570\u636e\u6d41\u5728 Lane \u5185\u90e8\u81ea\u4e0a\u800c\u4e0b\uff0c\u5728 Lane \u4e4b\u95f4\u901a\u8fc7 Permutation Unit \u548c CrossLane Read/Write Bus \u4f20\u8f93\u3002</li> <li> <p>\u5173\u952e\u8def\u5f84\u5982 Load -&gt; EX -&gt; Store \u88ab\u663e\u5f0f\u6807\u51fa\uff0c\u5c55\u793a\u94fe\u5f0f\u6267\u884c\u7684\u53ef\u884c\u6027\u3002</p> </li> <li> <p>\u6027\u80fd\u4f18\u5316\u6280\u672f\u603b\u7ed3\u8868\uff1a</p> </li> </ul> \u6280\u672f\u540d\u79f0 \u6240\u5c5e\u6a21\u5757 \u6838\u5fc3\u4f5c\u7528 \u6027\u80fd\u6536\u76ca Issue-as-commit Scalar Core \u89e3\u8026\u6807\u91cf\u4e0e\u5411\u91cf\u63d0\u4ea4 \u63d0\u5347\u6807\u91cf\u541e\u5410\uff0c\u51cf\u5c11 stalls Configuration Fusion Sequencer \u7f13\u5b58\u5e76\u878d\u5408 vsetvli \u6d88\u9664\u914d\u7f6e\u6307\u4ee4\u5e26\u5bbd\u5f00\u9500 Fine-grained Chaining Lane \u5143\u7d20\u7ea7\u6570\u636e\u8f6c\u53d1 \u63d0\u5347 ILP\uff0c\u51cf\u5c11\u5ef6\u8fdf Shadow Mask v0 Permutation Unit \u7f13\u5b58 mask \u5bc4\u5b58\u5668 \u51cf\u5c11\u8de8 Lane \u901a\u4fe1\uff0c\u63d0\u5347\u5e26\u5bbd Memory Interleaving HBLSU Load/Store \u5e76\u884c \u63d0\u5347\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387 Memory Delay Slot HOLSU \u63a9\u76d6\u7d22\u5f15\u8bbf\u95ee\u5ef6\u8fdf \u63d0\u5347\u957f\u5ef6\u8fdf\u64cd\u4f5c\u4e0b\u7684\u6548\u7387 <ul> <li>\u67b6\u6784\u4f18\u52bf\uff1a\u8be5\u56fe\u6e05\u6670\u5c55\u793a\u4e86 T1 \u5982\u4f55\u901a\u8fc7\u786c\u4ef6\u5c42\u9762\u7684\u7cbe\u7ec6\u5212\u5206\uff08Lane\uff09\u3001\u667a\u80fd\u7684\u6570\u636e\u8def\u7531\uff08Permutation Unit\uff09\u3001\u7075\u6d3b\u7684\u8c03\u5ea6\u673a\u5236\uff08Chaining, Interleaving\uff09\u4ee5\u53ca\u9ad8\u6548\u7684\u63a7\u5236\u89e3\u8026\uff08Scalar-Vector OoO\uff09\uff0c\u5728\u4fdd\u6301 RISC-V Vector \u89c4\u8303\u517c\u5bb9\u6027\u7684\u540c\u65f6\uff0c\u5b9e\u73b0\u4e86\u8fdc\u8d85\u4f20\u7edf\u5411\u91cf\u5904\u7406\u5668\u548c GP-GPU \u7684\u6027\u80fd\u4e0e\u80fd\u6548\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#a-vlen","title":"(a) VLEN","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86\u5728 TSMC N28 SVT \u5de5\u827a\u300165% \u5229\u7528\u7387\u6761\u4ef6\u4e0b\uff0cT1 \u67b6\u6784\u7684\u9762\u79ef\u968f VLEN \u53d8\u5316\u7684\u7ebf\u6027\u6269\u5c55\u8d8b\u52bf\u3002</li> <li>\u6a2a\u8f74\u4e3a VLEN \u503c\uff0c\u4ece 1,024 \u5230 16,384\uff1b\u5de6\u4fa7\u7eb5\u8f74\u4e3a\u603b\u9762\u79ef\uff08mm\u00b2\uff09\uff0c\u53f3\u4fa7\u7eb5\u8f74\u4e3a Lane \u548c Permutation \u5355\u5143\u7684\u72ec\u7acb\u9762\u79ef\u5360\u6bd4\u3002</li> <li>\u6570\u636e\u70b9\u4ee5\u4e0d\u540c\u989c\u8272\u6807\u8bb0\uff1a\u7ea2\u8272\u5706\u70b9\u4ee3\u8868 T1 \u603b\u9762\u79ef\uff0c\u84dd\u8272\u5706\u70b9\u4ee3\u8868 Lane \u9762\u79ef\uff0c\u68d5\u8272\u5706\u70b9\u4ee3\u8868 Permutation \u5355\u5143\u9762\u79ef\u3002</li> <li>\u968f\u7740 VLEN \u589e\u52a0\uff0cT1 \u603b\u9762\u79ef\u5448\u8fd1\u4f3c\u7ebf\u6027\u589e\u957f\uff0c\u4ece VLEN=1,024 \u65f6\u7ea6 0.7 mm\u00b2 \u589e\u81f3 VLEN=16,384 \u65f6\u7ea6 2.2 mm\u00b2\u3002</li> <li>Lane \u9762\u79ef\u540c\u6837\u7ebf\u6027\u589e\u957f\uff0c\u4f46\u589e\u901f\u4f4e\u4e8e\u603b\u9762\u79ef\uff0c\u8868\u660e\u5176\u5728\u6574\u4f53\u4e2d\u5360\u6bd4\u76f8\u5bf9\u7a33\u5b9a\u6216\u7565\u6709\u4e0b\u964d\u3002</li> <li>Permutation \u5355\u5143\u9762\u79ef\u589e\u957f\u6700\u7f13\u6162\uff0c\u51e0\u4e4e\u4fdd\u6301\u6052\u5b9a\uff0c\u8bf4\u660e\u8be5\u6a21\u5757\u8bbe\u8ba1\u5177\u5907\u826f\u597d\u7684\u53ef\u6269\u5c55\u6027\uff0c\u4e0d\u968f VLEN \u663e\u8457\u589e\u52a0\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5173\u952e\u6570\u636e\u70b9\uff1a</li> </ul> VLEN T1 \u603b\u9762\u79ef (mm\u00b2) Lane \u9762\u79ef (mm\u00b2) Permutation \u9762\u79ef (mm\u00b2) 1,024 ~0.7 ~0.4 ~0.1 2,048 ~0.9 ~0.5 ~0.1 4,096 ~1.1 ~0.6 ~0.1 8,192 ~1.5 ~0.8 ~0.1 16,384 ~2.2 ~1.1 ~0.1 <ul> <li>\u8be5\u56fe\u9a8c\u8bc1\u4e86\u8bba\u6587\u7b2c 4 \u8282\u6240\u8ff0\u7684\u201c\u7ebf\u6027\u9762\u79ef\u6269\u5c55\u201d\u7279\u6027\uff0c\u5c24\u5176\u51f8\u663e Permutation \u5355\u5143\u5728\u9ad8 VLEN \u4e0b\u4ecd\u80fd\u7ef4\u6301\u4f4e\u9762\u79ef\u5f00\u9500\u7684\u8bbe\u8ba1\u4f18\u52bf\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#b-dlen-figure-4-linearly-area-scaling-of-t1-design-parameters-evaluated-at-tsmc-n28-svt-technology-at-65-utilization-four-cases-are-examined-1-when-varying-vlen-dlen-is-held-at-128-y-asix-on-the-left-hand-represents-the-total-area-of-t1-whereas-the-right-hand-y-axis-isolates-the-area-of-lane-and-permutation-2-when-varying-dlen-the-ratio-vlendlen-remains-1-3-when-examining-lanescale-both-vlen-and-dlen-are-set-to-1024-y-asix-on-the-left-hand-represents-the-total-area-of-t1-whereas-the-right-hand-y-axis-isolates-the-area-of-lane-and-4-when-assessing-chainingsize-vlen-and-dlen-are-maintained-at-1024","title":"(b) DLEN Figure 4: Linearly Area Scaling of T1 design parameters, evaluated at TSMC N28 SVT technology at $65\\%$ utilization. Four cases are examined: (1) when varying VLEN, DLEN is held at 128, $y$ -asix on the left-hand represents the total area of T1, whereas the right-hand $y$ -axis isolates the area of Lane and Permutation; (2) when varying DLEN, the ratio VLEN/DLEN remains 1; (3) when examining LaneScale, both VLEN and DLEN are set to 1024, $y$ -asix on the left-hand represents the total area of T1, whereas the right-hand $y$ -axis isolates the area of Lane; and (4) when assessing ChainingSize, VLEN and DLEN are maintained at 1024.","text":"<ul> <li>\u8be5\u56fe\u8868\u4e3a Figure 4b\uff0c\u5c55\u793a T1 \u67b6\u6784\u5728\u4e0d\u540c DLEN\uff08Datapath Length\uff09\u914d\u7f6e\u4e0b\uff0c\u82af\u7247\u603b\u9762\u79ef\u7684\u7ebf\u6027\u6269\u5c55\u7279\u6027\u3002</li> <li>\u6a2a\u8f74\u8868\u793a DLEN \u503c\uff0c\u4ece 128 \u5230 1024 \u4f4d\uff0c\u6b65\u8fdb\u4e3a 128 \u4f4d\u3002</li> <li>\u7eb5\u8f74\u8868\u793a \u82af\u7247\u603b\u9762\u79ef\uff08\u5355\u4f4d\u672a\u6807\u6ce8\uff0c\u4f46\u6839\u636e\u4e0a\u4e0b\u6587\u5e94\u4e3a mm\u00b2 \u6216\u76f8\u5bf9\u9762\u79ef\u5355\u4f4d\uff09\uff0c\u8303\u56f4\u4ece 0 \u5230 6\u3002</li> <li>\u56fe\u4e2d\u4ec5\u6709\u4e00\u6761\u7ea2\u8272\u6298\u7ebf\uff0c\u6807\u8bb0\u4e3a T1\uff0c\u8fde\u63a5\u56db\u4e2a\u6570\u636e\u70b9\uff1a(128, ~0.5), (256, ~1.5), (512, ~3.0), (1024, ~6.0)\u3002</li> <li>\u6570\u636e\u8d8b\u52bf\u663e\u793a\uff0c\u968f\u7740 DLEN \u7684\u589e\u52a0\uff0cT1 \u7684\u603b\u9762\u79ef\u5448\u8fd1\u4f3c\u7ebf\u6027\u589e\u957f\uff0c\u8868\u660e\u5176\u5fae\u67b6\u6784\u8bbe\u8ba1\u5728\u6269\u5c55\u5bbd\u6570\u636e\u901a\u8def\u65f6\u5177\u6709\u826f\u597d\u7684\u9762\u79ef\u53ef\u6269\u5c55\u6027\u3002</li> <li>\u6839\u636e\u56fe\u6ce8\u8bf4\u660e\uff0c\u6b64\u6d4b\u8bd5\u662f\u5728 TSMC N28 SVT \u5de5\u827a\u8282\u70b9\u300165% \u5229\u7528\u7387 \u6761\u4ef6\u4e0b\u8fdb\u884c\u7684\uff0c\u5e76\u4e14 VLEN/DLEN \u7684\u6bd4\u503c\u4fdd\u6301\u4e3a 1\u3002</li> <li>\u6b64\u7ed3\u679c\u652f\u6301\u8bba\u6587\u6838\u5fc3\u8bba\u70b9\uff1aT1 \u901a\u8fc7\u521b\u65b0\u7684\u5fae\u67b6\u6784\uff08\u5982\u7c97\u7c92\u5ea6\u5e03\u56fe\u89c4\u5212\u5668\u3001\u8de8\u901a\u9053\u7f6e\u6362\u5355\u5143\u7b49\uff09\uff0c\u6709\u6548\u7f13\u89e3\u4e86\u4f20\u7edf\u5411\u91cf\u5904\u7406\u5668\u5728\u6269\u5c55 DLEN \u65f6\u9762\u4e34\u7684\u5e03\u7ebf\u62e5\u585e\u548c\u9762\u79ef\u7206\u70b8\u95ee\u9898\u3002</li> </ul> DLEN \u9762\u79ef (\u76f8\u5bf9\u503c) 128 ~0.5 256 ~1.5 512 ~3.0 1024 ~6.0 <ul> <li>\u8be5\u7ebf\u6027\u5173\u7cfb\u662f T1 \u5b9e\u73b0\u9ad8\u6027\u80fd\u4e0e\u9ad8\u80fd\u6548\u7684\u5173\u952e\u57fa\u7840\uff0c\u4f7f\u5176\u80fd\u591f\u5728\u4e0d\u663e\u8457\u589e\u52a0\u9762\u79ef\u5f00\u9500\u7684\u524d\u63d0\u4e0b\uff0c\u901a\u8fc7\u589e\u5927 DLEN \u6765\u63d0\u5347\u6570\u636e\u7ea7\u5e76\u884c\u5ea6\uff08DLP\uff09\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#c-lanescale","title":"(c) LaneScale","text":"<ul> <li>\u56fe\u7247\u6807\u9898\u4e3a (c) LaneScale\uff0c\u5c5e\u4e8e\u8bba\u6587\u56fe4\u7684\u4e00\u90e8\u5206\uff0c\u65e8\u5728\u5c55\u793a T1 \u67b6\u6784\u5728\u4e0d\u540c LaneScale \u53c2\u6570\u4e0b\u7684\u9762\u79ef\u53d8\u5316\u8d8b\u52bf\u3002</li> <li>\u8be5\u56fe\u8868\u6a2a\u8f74\u8868\u793a LaneScale \u503c\uff0c\u5206\u522b\u4e3a 1\u30012\u30014\uff1b\u7eb5\u8f74\u5de6\u4fa7\u4e3a T1 \u603b\u9762\u79ef\uff08\u5355\u4f4d\u672a\u6807\uff0c\u4f46\u6839\u636e\u4e0a\u4e0b\u6587\u5e94\u4e3a\u76f8\u5bf9\u503c\u6216 mm\u00b2\uff09\uff0c\u53f3\u4fa7\u4e3a Lane \u9762\u79ef\u5360\u6bd4\uff08\u65e0\u91cf\u7eb2\u6bd4\u4f8b\uff09\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u4e24\u6761\u6298\u7ebf\uff1a</li> <li>\u7ea2\u8272\u5706\u70b9\u7ebf\u4ee3\u8868 T1 \u603b\u9762\u79ef\u968f LaneScale \u53d8\u5316\uff1a\u4ece LaneScale=1 \u65f6\u7ea66\u5355\u4f4d\u4e0b\u964d\u81f3 LaneScale=2 \u65f6\u7ea64.5\u5355\u4f4d\uff0c\u518d\u964d\u81f3 LaneScale=4 \u65f6\u7ea64\u5355\u4f4d\uff0c\u5448\u73b0\u9012\u51cf\u8d8b\u52bf\u3002</li> <li>\u84dd\u8272\u5706\u70b9\u7ebf\u4ee3\u8868 Lane \u9762\u79ef\u968f LaneScale \u53d8\u5316\uff1a\u4ece LaneScale=1 \u65f6\u7ea63\u5355\u4f4d\u4e0a\u5347\u81f3 LaneScale=2 \u65f6\u7ea64.5\u5355\u4f4d\uff0c\u518d\u5347\u81f3 LaneScale=4 \u65f6\u7ea66\u5355\u4f4d\uff0c\u5448\u73b0\u9012\u589e\u8d8b\u52bf\u3002</li> <li>\u4e24\u6761\u66f2\u7ebf\u5728 LaneScale=2 \u5904\u76f8\u4ea4\uff0c\u8868\u660e\u6b64\u65f6 T1 \u603b\u9762\u79ef\u4e0e Lane \u9762\u79ef\u6570\u503c\u76f8\u7b49\u3002</li> <li>\u6839\u636e\u6b63\u6587\u7b2c4.2.2\u8282\u53ca\u56fe4\u8bf4\u660e\uff0c\u5f53 VLEN \u548c DLEN \u56fa\u5b9a\u4e3a1024\u65f6\uff0c\u589e\u5927 LaneScale \u4f1a\u51cf\u5c11\u603b\u82af\u7247\u9762\u79ef\uff0c\u56e0\u4e3a\u591a\u4e2a\u7269\u7406 Lane \u88ab\u805a\u5408\u4e3a\u4e00\u4e2a\u903b\u8f91 Lane\uff0c\u4ece\u800c\u5171\u4eab\u63a7\u5236\u903b\u8f91\u548c\u8d44\u6e90\uff0c\u964d\u4f4e\u9762\u79ef\u5f00\u9500\u3002</li> <li>\u4e0b\u8868\u603b\u7ed3\u5173\u952e\u6570\u636e\u70b9\uff1a</li> </ul> LaneScale T1 \u603b\u9762\u79ef (\u5de6\u8f74) Lane \u9762\u79ef (\u53f3\u8f74) 1 ~6 ~3 2 ~4.5 ~4.5 4 ~4 ~6 <ul> <li>\u6b64\u8bbe\u8ba1\u6743\u8861\u8868\u660e\uff0c\u901a\u8fc7\u8c03\u6574 LaneScale\uff0c\u53ef\u5728\u4fdd\u6301\u8ba1\u7b97\u5e26\u5bbd\u7684\u540c\u65f6\uff0c\u5b9e\u73b0\u9762\u79ef\u4f18\u5316\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u5bf9\u6210\u672c\u654f\u611f\u7684\u8fb9\u7f18AI\u573a\u666f\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#d-chainingsize","title":"(d) ChainingSize","text":"<ul> <li>\u56fe\u7247\u6807\u9898\u4e3a (d) ChainingSize\uff0c\u5c5e\u4e8e\u8bba\u6587\u56fe4\u7cfb\u5217\uff0c\u65e8\u5728\u5c55\u793a T1 \u67b6\u6784\u4e2d ChainingSize \u53c2\u6570\u5bf9\u82af\u7247\u9762\u79ef\u7684\u5f71\u54cd\u3002</li> <li>\u6a2a\u8f74\u4ee3\u8868 ChainingSize \u7684\u53d6\u503c\uff0c\u8303\u56f4\u4ece 2 \u5230 8\uff0c\u6b65\u957f\u4e3a 1\u3002\u8be5\u53c2\u6570\u5b9a\u4e49\u4e86\u5728 lane \u5185\u90e8\u8fdb\u884c chaining\uff08\u6307\u4ee4\u95f4\u6570\u636e\u8f6c\u53d1\uff09\u65f6\u7684\u7c92\u5ea6\uff0c\u5373\u6bcf\u4e2a\u5b50\u5b57\uff08sub-word\uff09\u7684\u4f4d\u5bbd\u4e3a ELEN \u00d7 ScaleFactor\u3002</li> <li>\u7eb5\u8f74\u8868\u793a T1 \u82af\u7247\u7684\u603b\u9762\u79ef\uff08\u5355\u4f4d\u672a\u660e\u786e\u6807\u6ce8\uff0c\u4f46\u6839\u636e\u4e0a\u4e0b\u6587\u63a8\u65ad\u4e3a\u76f8\u5bf9\u9762\u79ef\u6216\u5f52\u4e00\u5316\u9762\u79ef\uff09\uff0c\u6570\u503c\u8303\u56f4\u4ece 0 \u5230 0.25\u3002</li> <li>\u56fe\u4e2d\u7ea2\u8272\u5b9e\u7ebf\u8fde\u63a5\u4e86 7 \u4e2a\u6570\u636e\u70b9\uff0c\u6e05\u6670\u5730\u8868\u660e\u968f\u7740 ChainingSize \u7684\u589e\u52a0\uff0cT1 \u7684\u603b\u9762\u79ef\u5448\u7ebf\u6027\u589e\u957f\u8d8b\u52bf\u3002</li> <li>\u6839\u636e\u6b63\u6587\u7b2c4.2.2\u8282\u63cf\u8ff0\uff0cChainingSize \u7684\u589e\u5927\u610f\u5473\u7740\u6bcf\u4e2a lane \u9700\u8981\u66f4\u591a\u7684\u63a7\u5236\u903b\u8f91\u3001VFU \u548c\u4ea4\u53c9\u5f00\u5173\u8d44\u6e90\u6765\u7ba1\u7406\u66f4\u7ec6\u7c92\u5ea6\u7684\u6570\u636e\u4f9d\u8d56\u548c\u8f6c\u53d1\uff0c\u8fd9\u76f4\u63a5\u5bfc\u81f4\u4e86\u9762\u79ef\u7684\u589e\u52a0\u3002</li> <li>\u5177\u4f53\u800c\u8a00\uff0c\u6587\u4e2d\u63d0\u5230\u201c\u6bcf\u589e\u52a0\u4e00\u4e2a ChainingSize \u6b65\u8fdb\uff0cLane \u5927\u5c0f\u5927\u7ea6\u589e\u52a0 30%\u201d\uff0c\u8fd9\u4e0e\u56fe\u4e2d\u89c2\u5bdf\u5230\u7684\u7ebf\u6027\u589e\u957f\u8d8b\u52bf\u4e00\u81f4\u3002</li> <li>\u8be5\u56fe\u8868\u76f4\u89c2\u5730\u63ed\u793a\u4e86 T1 \u5fae\u67b6\u6784\u8bbe\u8ba1\u4e2d\u7684\u4e00\u4e2a\u5173\u952e\u6743\u8861\uff1a\u4e3a\u4e86\u83b7\u5f97\u66f4\u9ad8\u7684 ILP\uff08\u6307\u4ee4\u7ea7\u5e76\u884c\u5ea6\uff09\u548c\u66f4\u597d\u7684\u6027\u80fd\uff08\u5982\u88681\u6240\u793a\uff0c\u542f\u7528 chaining \u53ef\u5e26\u676561%\u7684\u6027\u80fd\u63d0\u5347\uff09\uff0c\u5fc5\u987b\u4ed8\u51fa\u76f8\u5e94\u7684\u9762\u79ef\u6210\u672c\u3002\u7528\u6237\u53ef\u6839\u636e\u76ee\u6807\u5e94\u7528\uff08\u5982\u5bc6\u7801\u5b66\u6216HPC\uff09\u7684\u9700\u6c42\uff0c\u5728\u6027\u80fd\u548c\u9762\u79ef\u4e4b\u95f4\u8fdb\u884c\u8c03\u4f18\u3002</li> </ul> ChainingSize T1 \u603b\u9762\u79ef (\u76f8\u5bf9\u503c) 2 ~0.08 3 ~0.10 4 ~0.12 5 ~0.14 6 ~0.16 7 ~0.18 8 ~0.20 <ul> <li>\u56fe\u8868\u53f3\u4e0a\u89d2\u7684\u7ea2\u8272\u5706\u70b9\u6807\u8bb0\u4e3a T1\uff0c\u6307\u660e\u8fd9\u662f\u9488\u5bf9 Titan-I \u67b6\u6784\u7684\u8bc4\u4f30\u7ed3\u679c\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#figure-6-different-ilp-technology-in-t1-chaining-interleaves-v0-v1-and-v2-memory-interleaving-mitigates-the-vsw-vld-dependency-vector-scalar-ooo-interleaves-the-vector-and-scalar-pipelines-until-a-true-dependency-v16-s64-v15-occurs-memory-delay-slot-parallelizes-vector-index-loadstore-vidx0-with-independent-vector-executions-vex0","title":"Figure 6: Different ILP Technology in T1. Chaining interleaves V0, V1, and V2. Memory Interleaving mitigates the VSW-VLD dependency. Vector-Scalar OoO interleaves the vector and scalar pipelines until a true dependency v16-s64-v15 occurs. Memory Delay Slot parallelizes vector index load/store (VIDX0) with independent vector executions (VEX0).","text":"<ul> <li>\u56fe6 \u5c55\u793a\u4e86 Titan-I (T1) \u67b6\u6784\u4e2d\u56db\u79cd\u5173\u952e\u7684 ILP\uff08\u6307\u4ee4\u7ea7\u5e76\u884c\uff09\u6280\u672f\uff0c\u65e8\u5728\u6700\u5927\u5316\u5411\u91cf\u4e0e\u6807\u91cf\u6d41\u6c34\u7ebf\u7684\u5e76\u53d1\u6267\u884c\u6548\u7387\u3002</li> <li>Memory Interleaving\uff1a\u901a\u8fc7\u89e3\u8026 Load/Store \u64cd\u4f5c\uff0c\u5141\u8bb8 VLD\uff08\u5411\u91cf\u52a0\u8f7d\uff09\u4e0e VSW\uff08\u5411\u91cf\u5b58\u50a8\uff09\u5728\u65f6\u95f4\u4e0a\u91cd\u53e0\u6267\u884c\u3002\u8be5\u673a\u5236\u6709\u6548\u7f13\u89e3\u4e86\u4f20\u7edf\u8bbe\u8ba1\u4e2d\u56e0\u5185\u5b58\u8bbf\u95ee\u987a\u5e8f\u5bfc\u81f4\u7684\u4f9d\u8d56\u963b\u585e\uff0c\u63d0\u5347\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u3002</li> <li>Vector-Scalar OoO\uff1a\u5b9e\u73b0\u6807\u91cf\u4e0e\u5411\u91cf\u6d41\u6c34\u7ebf\u7684\u72ec\u7acb\u4e71\u5e8f\u6267\u884c\u3002\u4f8b\u5982\uff0c\u6807\u91cf\u6307\u4ee4 s0-s1 \u53ef\u5728\u5411\u91cf\u6307\u4ee4 v0-v15 \u6267\u884c\u671f\u95f4\u63d0\u524d\u63d0\u4ea4\uff0c\u4ec5\u5f53\u51fa\u73b0\u771f\u5b9e\u6570\u636e\u4f9d\u8d56\uff08\u5982 v16 \u4f9d\u8d56 s64 \u7684\u7ed3\u679c\uff09\u65f6\u624d\u6682\u505c\u6807\u91cf\u6d41\uff0c\u4ece\u800c\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u505c\u987f\u3002</li> <li>Chaining\uff1a\u652f\u6301\u5411\u91cf\u6307\u4ee4\u95f4\u7684\u7ec6\u7c92\u5ea6\u6570\u636e\u524d\u9012\u3002V0\u3001V1\u3001V2 \u4e09\u4e2a\u5411\u91cf\u6307\u4ee4\u53ef\u5f62\u6210\u201c convoy \u201d\uff0cV1 \u5728 V0 \u90e8\u5206\u7ed3\u679c\u5c31\u7eea\u540e\u5373\u53ef\u5f00\u59cb\u6267\u884c\uff0c\u65e0\u9700\u7b49\u5f85 V0 \u5b8c\u5168\u5b8c\u6210\uff0c\u663e\u8457\u7f29\u77ed\u6574\u4f53\u5ef6\u8fdf\u3002</li> <li>Memory Delay Slot\uff1a\u9488\u5bf9\u9ad8\u5ef6\u8fdf\u7684\u7d22\u5f15\u5185\u5b58\u8bbf\u95ee\uff08VIDX\uff09\uff0c\u5141\u8bb8\u72ec\u7acb\u7684\u5411\u91cf\u8ba1\u7b97\u6307\u4ee4\uff08VEX0\uff09\u5728\u5176\u6267\u884c\u671f\u95f4\u5e76\u884c\u8fd0\u884c\u3002\u6b64\u673a\u5236\u5c06\u957f\u5ef6\u8fdf\u64cd\u4f5c\u201c\u9690\u85cf\u201d\u5728\u5176\u4ed6\u8ba1\u7b97\u80cc\u540e\uff0c\u63d0\u9ad8\u6838\u5fc3\u5229\u7528\u7387\u3002</li> </ul> \u6280\u672f\u540d\u79f0 \u6838\u5fc3\u4f5c\u7528 \u5173\u952e\u6307\u4ee4\u793a\u4f8b \u6027\u80fd\u6536\u76ca\u70b9 Memory Interleaving \u89e3\u8026 Load/Store\uff0c\u5141\u8bb8\u540c\u65f6\u8fdb\u884c VLD, VSW \u63d0\u5347\u5185\u5b58\u901a\u9053\u5229\u7528\u7387 Vector-Scalar OoO \u6807\u91cf\u4e0e\u5411\u91cf\u6d41\u6c34\u7ebf\u72ec\u7acb\u4e71\u5e8f\u6267\u884c s0-s1, v0-v15, v16 \u51cf\u5c11\u6807\u91cf\u56e0\u5411\u91cf\u963b\u585e\u7684\u7a7a\u95f2 Chaining \u5411\u91cf\u6307\u4ee4\u95f4\u5143\u7d20\u7ea7\u6570\u636e\u524d\u9012\uff0c\u91cd\u53e0\u6267\u884c V0 \u2192 V1 \u2192 V2 \u7f29\u77ed\u6307\u4ee4\u94fe\u603b\u5ef6\u8fdf Memory Delay Slot \u5e76\u884c\u6267\u884c\u7d22\u5f15\u5185\u5b58\u8bbf\u95ee\u4e0e\u72ec\u7acb\u8ba1\u7b97 VIDX0, VEX0 \u9690\u85cf\u7d22\u5f15\u8bbf\u95ee\u7684\u9ad8\u5ef6\u8fdf <ul> <li>\u56fe\u4e2d\u6240\u6709\u6280\u672f\u5747\u56f4\u7ed5 \u201c\u51cf\u5c11\u505c\u987f\u201d \u548c \u201c\u589e\u52a0\u5e76\u53d1\u201d \u8bbe\u8ba1\uff0c\u662f T1 \u5b9e\u73b0\u9ad8 ILP \u7684\u6838\u5fc3\u5fae\u67b6\u6784\u521b\u65b0\u3002</li> <li>\u7ea2\u8272\u865a\u7ebf\u6846\u8868\u793a\u6f5c\u5728\u7684\u4f9d\u8d56\u6216\u540c\u6b65\u70b9\uff0c\u9ed1\u8272\u7bad\u5934\u8868\u793a\u6307\u4ee4\u6267\u884c\u6d41\uff0c\u7070\u8272\u7bad\u5934\u8868\u793a\u6570\u636e\u524d\u9012\u8def\u5f84\u3002</li> <li>\u8fd9\u4e9b\u673a\u5236\u5171\u540c\u4f5c\u7528\uff0c\u4f7f T1 \u80fd\u5728\u4fdd\u6301\u5411\u91cf DLP \u4f18\u52bf\u7684\u540c\u65f6\uff0c\u5145\u5206\u6316\u6398 ILP\uff0c\u8fbe\u6210\u8d85\u8d8a\u4f20\u7edf GPU \u548c CPU \u7684\u6027\u80fd\u6548\u7387\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#edge-ai-chip-soc-top-gds","title":"Edge AI Chip SoC Top GDS","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u7684\u662f Edge AI Chip SoC Top GDS\uff0c\u5373\u8fb9\u7f18\u4eba\u5de5\u667a\u80fd\u82af\u7247\u7684\u7cfb\u7edf\u7ea7\u82af\u7247\uff08SoC\uff09\u9876\u5c42\u7248\u56fe\u8bbe\u8ba1\u3002</li> <li>\u6574\u4f53\u5e03\u5c40\u5448\u77e9\u5f62\uff0c\u5185\u90e8\u6a21\u5757\u5212\u5206\u6e05\u6670\uff0c\u4e3b\u8981\u5305\u542b T1 \u6838\u5fc3\u3001Application Core\u3001SRAM \u548c SONOS Flash \u56db\u5927\u529f\u80fd\u533a\u57df\u3002</li> <li>T1 \u4f4d\u4e8e\u7248\u56fe\u4e2d\u592e\u504f\u53f3\uff0c\u662f\u8be5\u82af\u7247\u7684\u6838\u5fc3\u5904\u7406\u5355\u5143\uff0c\u5176\u9762\u79ef\u5728\u6240\u6709\u6a21\u5757\u4e2d\u5360\u636e\u4e3b\u5bfc\u5730\u4f4d\uff0c\u8868\u660e\u5176\u4e3a\u8ba1\u7b97\u5bc6\u96c6\u578b\u6838\u5fc3\u3002</li> <li>Application Core \u4f4d\u4e8e\u5de6\u4e0b\u89d2\uff0c\u4f53\u79ef\u8f83\u5c0f\uff0c\u8d1f\u8d23\u63a7\u5236\u548c\u8c03\u5ea6\u4efb\u52a1\uff0c\u4e0e T1 \u534f\u540c\u5de5\u4f5c\u3002</li> <li>\u4e24\u4fa7\u5bf9\u79f0\u5206\u5e03\u4e24\u5757 SRAM \u533a\u57df\uff0c\u5206\u522b\u4f4d\u4e8e\u5de6\u4e0a\u548c\u53f3\u4e0a\uff0c\u7528\u4e8e\u9ad8\u901f\u7f13\u5b58\u6570\u636e\uff0c\u652f\u6301 T1 \u7684\u9ad8\u5e26\u5bbd\u8bbf\u95ee\u9700\u6c42\u3002</li> <li>\u5e95\u90e8\u5e76\u5217\u4e24\u5757 SONOS Flash \u533a\u57df\uff0c\u7528\u4e8e\u975e\u6613\u5931\u6027\u5b58\u50a8\u6a21\u578b\u6743\u91cd\u7b49\u6570\u636e\uff0c\u7b26\u5408\u8fb9\u7f18\u8bbe\u5907\u65ad\u7535\u540e\u4fdd\u7559\u72b6\u6001\u7684\u9700\u6c42\u3002</li> <li>\u7248\u56fe\u4e2d\u53ef\u89c1\u6e05\u6670\u7684\u91d1\u5c5e\u5e03\u7ebf\u5c42\u548c\u6807\u51c6\u5355\u5143\u6392\u5217\uff0c\u4f53\u73b0\u9ad8\u5ea6\u96c6\u6210\u7684\u7269\u7406\u8bbe\u8ba1\u3002</li> <li>\u5404\u6a21\u5757\u95f4\u901a\u8fc7\u603b\u7ebf\u6216\u4e92\u8fde\u7f51\u7edc\u8fde\u63a5\uff0c\u786e\u4fdd\u6570\u636e\u9ad8\u6548\u4f20\u8f93\u3002</li> </ul> \u6a21\u5757\u540d\u79f0 \u4f4d\u7f6e \u529f\u80fd\u63cf\u8ff0 T1 \u4e2d\u592e\u504f\u53f3 \u9ad8\u6027\u80fd RISC-V \u5411\u91cf\u5904\u7406\u5668\u6838\u5fc3 Application Core \u5de6\u4e0b\u89d2 \u63a7\u5236\u4e0e\u8c03\u5ea6\u4e3b\u6838 SRAM \u5de6\u4e0a\u3001\u53f3\u4e0a \u9ad8\u901f\u7f13\u5b58\uff0c\u652f\u6301\u5411\u91cf\u8fd0\u7b97\u6570\u636e\u541e\u5410 SONOS Flash \u5e95\u90e8\u5de6\u53f3\u4e24\u4fa7 \u975e\u6613\u5931\u5b58\u50a8\uff0c\u4fdd\u5b58AI\u6a21\u578b\u6743\u91cd <ul> <li>\u4ece\u7248\u56fe\u5bc6\u5ea6\u770b\uff0cT1 \u533a\u57df\u5e03\u7ebf\u5bc6\u96c6\uff0c\u53cd\u6620\u5176\u590d\u6742\u5fae\u67b6\u6784\u548c\u9ad8\u5e76\u884c\u5ea6\u8bbe\u8ba1\u3002</li> <li>SRAM \u4e0e T1 \u7d27\u90bb\u5e03\u5c40\uff0c\u4f18\u5316\u4e86\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\uff0c\u63d0\u5347\u6574\u4f53\u80fd\u6548\u3002</li> <li>SONOS Flash \u91c7\u7528\u53cc\u533a\u5757\u8bbe\u8ba1\uff0c\u53ef\u80fd\u7528\u4e8e\u5197\u4f59\u6216\u5206\u533a\u5b58\u50a8\uff0c\u589e\u5f3a\u53ef\u9760\u6027\u3002</li> <li>\u6b64 GDS \u7248\u56fe\u5df2\u901a\u8fc7 DRC/LVS \u9a8c\u8bc1\uff0c\u5177\u5907\u6d41\u7247\u6761\u4ef6\uff0c\u4ee3\u8868\u5b9e\u9645\u53ef\u5236\u9020\u7684\u82af\u7247\u8bbe\u8ba1\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#t1-top-edge-ai-chip","title":"T1 Top (Edge AI Chip)","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 T1 Top (Edge AI Chip) \u7684\u7269\u7406\u7248\u56fe\uff08GDS\uff09\uff0c\u662f Titan-I \u67b6\u6784\u5728\u8fb9\u7f18\u4eba\u5de5\u667a\u80fd\u82af\u7247\u4e2d\u7684\u5177\u4f53\u5b9e\u73b0\u3002</li> <li>\u6574\u4f53\u5e03\u5c40\u5448\u5782\u76f4\u5bf9\u79f0\u7ed3\u6784\uff0c\u6838\u5fc3\u529f\u80fd\u6a21\u5757\u6cbf\u4e2d\u5fc3\u8f74\u7ebf\u5206\u5e03\uff0c\u4f53\u73b0\u4e86 lane-based \u8bbe\u8ba1\u7684\u7269\u7406\u6620\u5c04\u3002</li> <li>\u9876\u90e8\u4e3a Scalar Core\uff0c\u8d1f\u8d23\u6307\u4ee4\u9884\u53d6\u3001\u89e3\u7801\u548c\u6807\u91cf\u8fd0\u7b97\uff0c\u662f\u6574\u4e2a T1 \u5f15\u64ce\u7684\u63a7\u5236\u4e2d\u67a2\u3002</li> <li>\u4e2d\u90e8\u4e3a\u6838\u5fc3\u8ba1\u7b97\u533a\u57df\uff0c\u5305\u542b Permutation Unit\uff0c\u5176\u4f4d\u7f6e\u5c45\u4e2d\u4e14\u9762\u79ef\u8f83\u5927\uff0c\u8868\u660e\u5176\u5728\u6570\u636e\u91cd\u6392\u548c\u8de8lane\u901a\u4fe1\u4e2d\u7684\u5173\u952e\u4f5c\u7528\u3002</li> <li>\u5468\u56f4\u73af\u7ed5\u7740 8\u4e2a Lane\uff08Lane 0 \u81f3 Lane 7\uff09\uff0c\u6bcf\u4e2a Lane \u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5411\u91cf\u5904\u7406\u5355\u5143\uff0c\u62e5\u6709\u81ea\u5df1\u7684\u5bc4\u5b58\u5668\u6587\u4ef6\u548c\u6267\u884c\u5355\u5143\uff0c\u5b9e\u73b0\u4e86\u5e76\u884c\u8ba1\u7b97\u3002</li> <li>\u5e95\u90e8\u4e3a LSU (Load/Store Unit)\uff0c\u8d1f\u8d23\u5185\u5b58\u8bbf\u95ee\uff0c\u4e0e\u4e0a\u5c42\u8ba1\u7b97\u5355\u5143\u901a\u8fc7\u603b\u7ebf\u8fde\u63a5\uff0c\u786e\u4fdd\u6570\u636e\u6d41\u7684\u9ad8\u6548\u4f20\u8f93\u3002</li> <li>\u5404\u6a21\u5757\u4e4b\u95f4\u901a\u8fc7\u5bc6\u96c6\u7684\u5e03\u7ebf\u8fde\u63a5\uff0c\u53cd\u6620\u4e86\u9ad8\u5e26\u5bbd\u6570\u636e\u4ea4\u6362\u7684\u9700\u6c42\uff0c\u5c24\u5176\u662f\u5728 Permutation Unit \u548c\u5404 Lane \u4e4b\u95f4\u3002</li> <li>\u7248\u56fe\u989c\u8272\u533a\u5206\u4e0d\u540c\u529f\u80fd\u6a21\u5757\uff0c\u4fbf\u4e8e\u8bc6\u522b\u548c\u5206\u6790\uff0c\u4f8b\u5982 Scalar Core \u4e3a\u6df1\u84dd\u8272\uff0cPermutation Unit \u4e3a\u7eff\u8272\uff0c\u5404 Lane \u4e3a\u4e0d\u540c\u989c\u8272\u5757\u3002</li> <li>\u8be5\u7248\u56fe\u8bbe\u8ba1\u7d27\u51d1\uff0c\u6a21\u5757\u5316\u7a0b\u5ea6\u9ad8\uff0c\u7b26\u5408 T1 \u67b6\u6784\u5728\u9762\u79ef\u548c\u529f\u8017\u4e0a\u7684\u4f18\u5316\u76ee\u6807\uff0c\u7279\u522b\u662f\u5728 28nm SONOS \u5de5\u827a\u4e0b\u7684\u5b9e\u73b0\u3002</li> <li>\u6839\u636e\u8bba\u6587\u63cf\u8ff0\uff0c\u6b64\u82af\u7247\u914d\u7f6e\u4e3a VLEN = 4096, DLEN = 512, ChainingSize = 4, LaneScale = 2\uff0c\u65e8\u5728\u5e73\u8861\u6027\u80fd\u4e0e\u9762\u79ef\uff0c\u9002\u7528\u4e8e\u8fb9\u7f18AI\u63a8\u7406\u4efb\u52a1\u3002</li> </ul> \u6a21\u5757 \u529f\u80fd \u5728\u7248\u56fe\u4e2d\u7684\u4f4d\u7f6e \u5907\u6ce8 Scalar Core \u63a7\u5236\u4e0e\u6807\u91cf\u8fd0\u7b97 \u9876\u90e8 \u8d1f\u8d23\u6574\u4f53\u8c03\u5ea6\u548c\u6807\u91cf\u6307\u4ee4\u6267\u884c Permutation Unit \u6570\u636e\u91cd\u6392\u4e0e\u8de8lane\u901a\u4fe1 \u4e2d\u90e8 \u6838\u5fc3\u6a21\u5757\uff0c\u652f\u6301\u9ad8\u6548\u6570\u636e\u79fb\u52a8 Lane 0-7 \u5e76\u884c\u5411\u91cf\u8ba1\u7b97 \u73af\u7ed5\u4e2d\u90e8 \u6bcf\u4e2a Lane \u72ec\u7acb\u5904\u7406\u5411\u91cf\u6307\u4ee4 LSU \u5185\u5b58\u8bbf\u95ee \u5e95\u90e8 \u652f\u6301\u9ad8\u5e26\u5bbd\u52a0\u8f7d\u548c\u5b58\u50a8\u64cd\u4f5c <ul> <li>\u6b64\u7248\u56fe\u76f4\u89c2\u5c55\u73b0\u4e86 T1 \u67b6\u6784\u5982\u4f55\u5c06\u903b\u8f91\u4e0a\u7684 lane-based \u8bbe\u8ba1\u8f6c\u5316\u4e3a\u7269\u7406\u4e0a\u7684\u6a21\u5757\u5316\u5e03\u5c40\uff0c\u4ee5\u5b9e\u73b0\u9ad8\u6027\u80fd\u548c\u9ad8\u80fd\u6548\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#t1-lane-edge-ai-chip","title":"T1 Lane (Edge AI Chip)","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 T1 Lane \u7684\u7269\u7406\u5e03\u5c40\uff0c\u5c5e\u4e8e Edge AI Chip \u7684\u4e00\u90e8\u5206\uff0c\u662f Titan-I \u67b6\u6784\u4e2d\u7684\u4e00\u4e2a\u6838\u5fc3\u5904\u7406\u5355\u5143\u3002</li> <li>\u8be5\u5e03\u5c40\u56fe\u901a\u8fc7\u4e0d\u540c\u989c\u8272\u533a\u57df\u6e05\u6670\u5212\u5206\u4e86 Lane \u5185\u90e8\u7684\u5404\u4e2a\u529f\u80fd\u6a21\u5757\uff0c\u4f53\u73b0\u4e86\u5176\u9ad8\u5ea6\u96c6\u6210\u548c\u6a21\u5757\u5316\u7684\u8bbe\u8ba1\u3002</li> <li>VRF (Vector Register File) \u5360\u636e\u4e86\u56fe\u4e2d\u53f3\u4e0b\u89d2\u7684\u5927\u7247\u6d45\u84dd\u8272\u533a\u57df\uff0c\u8868\u660e\u5176\u5728 Lane \u4e2d\u5360\u636e\u4e86\u663e\u8457\u7684\u7269\u7406\u9762\u79ef\uff0c\u8fd9\u662f\u4e3a\u4e86\u652f\u6301\u8d85\u5bbd\u5411\u91cf\u5bc4\u5b58\u5668\uff08\u5982 VLEN=4096\uff09\u800c\u8bbe\u8ba1\u7684\u3002</li> <li>VFU XBar (Vector Functional Unit Crossbar) \u4f4d\u4e8e\u56fe\u4e2d\u592e\uff0c\u662f\u4e00\u4e2a\u6df1\u7070\u8272\u7684\u77e9\u5f62\u7ed3\u6784\uff0c\u4f5c\u4e3a\u8fde\u63a5\u591a\u4e2a VFU \u548c\u6570\u636e\u8def\u5f84\u7684\u5173\u952e\u4e92\u8fde\u7f51\u7edc\uff0c\u8d1f\u8d23\u5728\u4e0d\u540c\u7684\u529f\u80fd\u5355\u5143\u4e4b\u95f4\u9ad8\u6548\u8def\u7531\u6570\u636e\u3002</li> <li>\u5728 VFU XBar \u5468\u56f4\u5206\u5e03\u7740\u591a\u4e2a\u529f\u80fd\u5355\u5143\uff1a<ul> <li>Mul (Multiplier)\uff1a\u7d2b\u8272\u533a\u57df\uff0c\u7528\u4e8e\u6267\u884c\u4e58\u6cd5\u8fd0\u7b97\u3002</li> <li>Float (Floating Point Unit)\uff1a\u7ea2\u8272\u533a\u57df\uff0c\u7528\u4e8e\u5904\u7406\u6d6e\u70b9\u6570\u8fd0\u7b97\u3002</li> <li>ALU (Arithmetic Logic Unit)\uff1a\u7eff\u8272\u533a\u57df\uff0c\u7528\u4e8e\u6267\u884c\u6574\u6570\u7b97\u672f\u548c\u903b\u8f91\u8fd0\u7b97\u3002</li> <li>Div (Divider)\uff1a\u9ec4\u8272\u533a\u57df\uff0c\u7528\u4e8e\u6267\u884c\u9664\u6cd5\u8fd0\u7b97\u3002</li> </ul> </li> <li>\u56fe\u4e2d\u5de6\u4fa7\u6709\u56db\u4e2a\u6807\u8bb0\u4e3a SB0, SB1, SB2, SB3 \u7684\u6df1\u84dd\u8272\u533a\u57df\uff0c\u8fd9\u4e9b\u662f Scoreboard \u6a21\u5757\u3002\u5b83\u4eec\u7528\u4e8e\u8ddf\u8e2a\u6307\u4ee4\u72b6\u6001\u3001\u7ba1\u7406\u6570\u636e\u4f9d\u8d56\u548c\u5b9e\u73b0\u4e71\u5e8f\u6267\u884c\uff08OoO\uff09\uff0c\u662f T1 \u5b9e\u73b0\u9ad8 ILP \u7684\u5173\u952e\u7ec4\u4ef6\u3002</li> <li>\u6574\u4f53\u5e03\u5c40\u7d27\u51d1\uff0c\u5404\u6a21\u5757\u7d27\u5bc6\u76f8\u90bb\uff0c\u65e8\u5728\u6700\u5c0f\u5316\u4fe1\u53f7\u4f20\u8f93\u5ef6\u8fdf\uff0c\u4f18\u5316\u6027\u80fd\u3002\u8fd9\u79cd\u8bbe\u8ba1\u4e0e\u8bba\u6587\u4e2d\u63d0\u5230\u7684\u201c\u7c97\u7c92\u5ea6\u5e03\u7ebf\u6c42\u89e3\u5668\u201d\u76f8\u547c\u5e94\uff0c\u4ee5\u51cf\u5c11\u8de8\u6a21\u5757\u901a\u4fe1\u7684\u5ef6\u8fdf\u3002</li> <li>\u6b64\u56fe\u76f4\u89c2\u5730\u9a8c\u8bc1\u4e86\u8bba\u6587\u7b2c 4.2.4 \u8282\u4e2d\u5bf9 Lane \u7ed3\u6784\u7684\u63cf\u8ff0\uff0c\u5373\u5b83\u7531\u524d\u7aef\uff08FE\uff09\u3001\u64cd\u4f5c\u6570\u540c\u6b65\uff08RF\uff09\u3001\u6267\u884c\u5355\u5143\uff08EX\uff09\u3001\u63d0\u4ea4\uff08CM\uff09\u4ee5\u53ca\u94f6\u884c\u5316\u7684 VRF \u7ec4\u6210\uff0c\u5e76\u901a\u8fc7\u5185\u90e8\u4ea4\u53c9\u5f00\u5173\u548c\u8bb0\u5206\u677f\u8fdb\u884c\u534f\u8c03\u3002</li> </ul> \u6a21\u5757\u540d\u79f0 \u989c\u8272 \u529f\u80fd\u63cf\u8ff0 VRF \u6d45\u84dd\u8272 \u5411\u91cf\u5bc4\u5b58\u5668\u6587\u4ef6\uff0c\u5b58\u50a8\u5927\u91cf\u5411\u91cf\u6570\u636e\u3002 VFU XBar \u6df1\u7070\u8272 \u8fde\u63a5\u5404\u4e2a VFU \u7684\u4ea4\u53c9\u5f00\u5173\uff0c\u8d1f\u8d23\u6570\u636e\u8def\u7531\u3002 Mul \u7d2b\u8272 \u6267\u884c\u4e58\u6cd5\u8fd0\u7b97\u7684\u529f\u80fd\u5355\u5143\u3002 Float \u7ea2\u8272 \u6267\u884c\u6d6e\u70b9\u8fd0\u7b97\u7684\u529f\u80fd\u5355\u5143\u3002 ALU \u7eff\u8272 \u6267\u884c\u6574\u6570\u7b97\u672f\u548c\u903b\u8f91\u8fd0\u7b97\u7684\u529f\u80fd\u5355\u5143\u3002 Div \u9ec4\u8272 \u6267\u884c\u9664\u6cd5\u8fd0\u7b97\u7684\u529f\u80fd\u5355\u5143\u3002 SB0-SB3 \u6df1\u84dd\u8272 \u8bb0\u5206\u677f\uff0c\u7528\u4e8e\u7ba1\u7406\u6307\u4ee4\u4f9d\u8d56\u548c\u4e71\u5e8f\u6267\u884c\u3002 <ul> <li>\u8be5\u7269\u7406\u5b9e\u73b0\u8bc1\u660e\u4e86 T1 \u67b6\u6784\u5728\u82af\u7247\u5c42\u9762\u7684\u53ef\u884c\u6027\uff0c\u5176\u6a21\u5757\u5316\u8bbe\u8ba1\u5141\u8bb8\u6839\u636e\u5177\u4f53\u5e94\u7528\u9700\u6c42\uff08\u5982\u52a0\u5bc6\u6216 AI \u63a8\u7406\uff09\u7075\u6d3b\u914d\u7f6e Lane \u7684\u6570\u91cf\u548c\u5185\u90e8\u529f\u80fd\u5355\u5143\u7684\u7ec4\u5408\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#t1-using-in-a-zkp-chip-figure-7-gds-of-two-chips-top-left-is-the-floorplan-of-the-core-top-right-is-the-implementation-of-t1-ip-block","title":"T1 using in a ZKP Chip Figure 7: GDS of two Chips, top left is the floorplan of the core, top right is the implementation of T1 IP block.","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 T1 \u6838\u5fc3\u5728 ZKP Chip \u4e2d\u7684\u7269\u7406\u5b9e\u73b0\uff0c\u5c5e\u4e8e\u56fe 7 \u4e2d\u7684\u201cT1 Top (Edge AI Chip)\u201d\u90e8\u5206\uff0c\u5177\u4f53\u4e3a\u4e00\u4e2a GDS\uff08Graphic Data System\uff09\u7248\u56fe\u3002</li> <li>\u6574\u4f53\u5e03\u5c40\u5448\u5341\u5b57\u5f62\u7ed3\u6784\uff0c\u4e2d\u5fc3\u533a\u57df\u4e3a Scalar Core\uff0c\u56db\u5468\u73af\u7ed5\u56db\u4e2a Lane\uff08Lane 0, Lane 1, Lane 2, Lane 3\uff09\uff0c\u4f53\u73b0\u5176 lane-based \u67b6\u6784\u8bbe\u8ba1\u3002</li> <li>Permutation Unit \u4f4d\u4e8e\u6838\u5fc3\u4e2d\u592e\u504f\u4e0b\u4f4d\u7f6e\uff0c\u8fde\u63a5\u6240\u6709 Lane\uff0c\u8d1f\u8d23\u8de8 Lane \u6570\u636e\u91cd\u6392\uff0c\u662f T1 \u5b9e\u73b0\u9ad8\u5e26\u5bbd shuffle \u7684\u5173\u952e\u6a21\u5757\u3002</li> <li>LSU\uff08Load/Store Unit\uff09\u4f4d\u4e8e\u5e95\u90e8\uff0c\u5904\u7406\u5185\u5b58\u8bbf\u95ee\uff0c\u4e0e Permutation Unit \u548c Lane \u901a\u8fc7\u5e03\u7ebf\u4e92\u8054\uff0c\u652f\u6301 memory interleaving \u7b49\u4f18\u5316\u3002</li> <li>\u5404\u6a21\u5757\u4ee5\u4e0d\u540c\u989c\u8272\u533a\u5206\uff1aScalar Core \u4e3a\u7d2b\u8272\uff0cLane 0 \u4e3a\u7c89\u8272\uff0cLane 1 \u4e3a\u9752\u8272\uff0cLane 2 \u4e3a\u7ea2\u8272\uff0cLane 3 \u4e3a\u84dd\u8272\uff0cPermutation Unit \u4e3a\u7eff\u8272\uff0cLSU \u4e3a\u6df1\u7eff\u8272\uff0c\u4fbf\u4e8e\u8bc6\u522b\u529f\u80fd\u5206\u533a\u3002</li> <li>\u7248\u56fe\u663e\u793a\u4e86\u5404\u6a21\u5757\u95f4\u7684\u7269\u7406\u8fde\u63a5\u548c\u5e03\u7ebf\u8def\u5f84\uff0c\u9a8c\u8bc1\u4e86\u8bba\u6587\u4e2d\u63d0\u5230\u7684 coarse-grained floorplanning solver \u7684\u6709\u6548\u6027\uff0c\u6700\u5c0f\u5316\u4e86\u8de8 Lane \u901a\u4fe1\u5ef6\u8fdf\u3002</li> <li>\u8be5\u5b9e\u73b0\u57fa\u4e8e TSMC TN28HPC \u5de5\u827a\uff0c\u914d\u7f6e\u4e3a 4-lane T1\uff08VLEN = 4096, DLEN = 128, ChainingSize = 2\uff09\uff0c\u4e13\u4e3a NTT \u52a0\u901f\u8bbe\u8ba1\uff0c\u7528\u4e8e \u96f6\u77e5\u8bc6\u8bc1\u660e \u5e94\u7528\u3002</li> <li>\u4ece\u7248\u56fe\u5bc6\u5ea6\u770b\uff0cLanes \u5360\u636e\u6700\u5927\u9762\u79ef\uff08\u7ea6 70.28%\uff09\uff0c\u5176\u6b21\u662f Pipeline\uff0843.47%\uff09\uff0cVRF\uff0821.26%\uff09\uff0cVFU\uff0822.68%\uff09\uff0c\u7b26\u5408\u5176\u4ee5\u6570\u636e\u5e76\u884c\u4e3a\u4e3b\u7684\u67b6\u6784\u7279\u70b9\u3002</li> </ul> \u6a21\u5757 \u9762\u79ef\u5360\u6bd4 \u529f\u80fd Lanes 70.28% \u6267\u884c\u5411\u91cf\u8fd0\u7b97\uff0c\u652f\u6301\u5e76\u884c\u5904\u7406 Pipeline 43.47% \u5904\u7406\u6307\u4ee4\u6d41\u6c34\u7ebf\uff0c\u7ba1\u7406\u6570\u636e\u6d41 VRF 21.26% \u5b58\u50a8\u5411\u91cf\u5bc4\u5b58\u5668\uff0c\u652f\u6301\u5927\u5bb9\u91cf\u6570\u636e VFU 22.68% \u6267\u884c\u7b97\u672f\u903b\u8f91\u8fd0\u7b97\uff0c\u5305\u62ec\u6574\u6570\u548c\u6d6e\u70b9 <ul> <li>\u6b64\u7248\u56fe\u8bc1\u5b9e\u4e86 T1 \u5728\u5b9e\u9645\u82af\u7247\u4e2d\u7684\u53ef\u5b9e\u73b0\u6027\uff0c\u5e76\u5c55\u793a\u4e86\u5176\u6a21\u5757\u5316\u3001\u53ef\u6269\u5c55\u7684\u8bbe\u8ba1\u7406\u5ff5\uff0c\u9002\u7528\u4e8e\u9ad8\u6027\u80fd\u5bc6\u7801\u5b66\u52a0\u901f\u573a\u666f\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#figure-8-cryptographic-benchmarks-of-t1-dlen1k-vlen16k-emulated-with-ddr4-3200-with-ga102-nvidia-gtx-3090-and-nvidia-gb202-gtx-5090","title":"Figure 8: Cryptographic Benchmarks of T1 (DLEN1K, VLEN16K, emulated with DDR4-3200) with GA102 (NVIDIA GTX 3090) and NVIDIA GB202 (GTX 5090)","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 T1\u3001GA102\uff08NVIDIA RTX 3090\uff09\u548c GB202\uff08NVIDIA RTX 5090\uff09\u5728\u4e24\u7c7b\u5bc6\u7801\u5b66\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u7684\u6267\u884c\u65f6\u95f4\u5bf9\u6bd4\uff0c\u5355\u4f4d\u4e3a\u5fae\u79d2\uff08\u03bcs\uff09\uff0c\u6570\u636e\u57fa\u4e8e DDR4-3200 \u5185\u5b58\u6a21\u62df\u3002</li> <li>\u5de6\u4fa7\u56fe\u8868\u805a\u7126\u4e8e NTT\uff08Number-Theoretic Transform\uff09\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5305\u542b\u56db\u79cd\u4e0d\u540c\u8f93\u5165\u89c4\u6a21\uff1aNTT512\u3001NTT1024\u3001NTT2048 \u548c NTT4096\u3002</li> <li>\u53f3\u4fa7\u56fe\u8868\u805a\u7126\u4e8e MMM\uff08Montgomery Modular Multiplication\uff09\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u540c\u6837\u5305\u542b\u56db\u79cd\u4e0d\u540c\u89c4\u6a21\uff1aMMM1024\u3001MMM2048\u3001MMM4096 \u548c MMM8192\u3002</li> <li>\u56fe\u4f8b\u6e05\u6670\u6807\u660e\u4e09\u79cd\u5904\u7406\u5668\uff1a\u84dd\u8272\u4ee3\u8868 T1\uff0c\u7ea2\u8272\u4ee3\u8868 GB202\uff0c\u68d5\u8272\u4ee3\u8868 GA102\u3002</li> <li>\u5728 NTT \u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cT1 \u5728\u6240\u6709\u89c4\u6a21\u4e0b\u5747\u8868\u73b0\u51fa\u663e\u8457\u4f18\u52bf\u3002\u4f8b\u5982\uff0c\u5728 NTT512 \u4e0a\uff0cT1 \u6267\u884c\u65f6\u95f4\u7ea6\u4e3a 5 \u03bcs\uff0c\u800c GA102 \u7ea6\u4e3a 10 \u03bcs\uff0cGB202 \u7ea6\u4e3a 7 \u03bcs\u3002\u968f\u7740\u89c4\u6a21\u589e\u5927\uff0cT1 \u7684\u6027\u80fd\u4f18\u52bf\u66f4\u52a0\u660e\u663e\uff0c\u5982\u5728 NTT4096 \u4e0a\uff0cT1 \u65f6\u95f4\u7ea6\u4e3a 15 \u03bcs\uff0c\u800c GA102 \u548c GB202 \u5206\u522b\u7ea6\u4e3a 25 \u03bcs \u548c 20 \u03bcs\u3002</li> <li>\u5728 MMM \u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0cT1 \u540c\u6837\u5168\u9762\u9886\u5148\u3002\u4f8b\u5982\uff0c\u5728 MMM1024 \u4e0a\uff0cT1 \u65f6\u95f4\u63a5\u8fd1 0 \u03bcs\uff0c\u800c GA102 \u548c GB202 \u5747\u7ea6\u4e3a 5 \u03bcs\u3002\u5728\u6700\u5927\u89c4\u6a21 MMM8192 \u4e0a\uff0cT1 \u65f6\u95f4\u7ea6\u4e3a 100 \u03bcs\uff0c\u800c GA102 \u548c GB202 \u5206\u522b\u9ad8\u8fbe\u7ea6 200 \u03bcs \u548c 150 \u03bcs\u3002</li> <li>\u7efc\u5408\u6765\u770b\uff0cT1 \u5728\u5bc6\u7801\u5b66\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5b9e\u73b0\u4e86\u5bf9 GA102 \u9ad8\u8fbe 2.41x \u7684\u901f\u5ea6\u63d0\u5347\uff0c\u5bf9 GB202 \u8fbe\u5230 1.85x \u7684\u901f\u5ea6\u63d0\u5347\uff0c\u8fd9\u4e0e\u8bba\u6587\u6458\u8981\u4e2d\u7684\u7ed3\u8bba\u4e00\u81f4\u3002</li> <li>\u6570\u636e\u8868\u660e\uff0cT1 \u7684\u9ad8\u6027\u80fd\u6e90\u4e8e\u5176\u9ad8\u6548\u7684 DLEN-sized permutation \u5904\u7406\u80fd\u529b\u548c\u4ee5\u5bc4\u5b58\u5668\u4e3a\u4e2d\u5fc3\u7684\u8ba1\u7b97\u6a21\u578b\uff0c\u907f\u514d\u4e86 GPU \u5bf9\u5185\u5b58\u5b50\u7cfb\u7edf\u7684\u91cd\u5ea6\u4f9d\u8d56\u3002</li> </ul> \u5de5\u4f5c\u8d1f\u8f7d T1 (\u03bcs) GA102 (\u03bcs) GB202 (\u03bcs) NTT512 ~5 ~10 ~7 NTT1024 ~7 ~15 ~10 NTT2048 ~10 ~20 ~15 NTT4096 ~15 ~25 ~20 MMM1024 ~0 ~5 ~5 MMM2048 ~5 ~10 ~8 MMM4096 ~20 ~40 ~30 MMM8192 ~100 ~200 ~150"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#a-t1-kp920-comparison","title":"(a) T1-KP920 Comparison","text":"<ul> <li>\u56fe\u7247\u5c55\u793a\u4e86 T1 \u4e0e HiSilicon KP920 \u5728\u56db\u4e2a HPC \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u7684\u6027\u80fd\u5bf9\u6bd4\uff0c\u6570\u636e\u4ee5\u5f52\u4e00\u5316\u5f62\u5f0f\u5448\u73b0\uff0c\u57fa\u51c6\u4e3a KP920\u3002</li> <li>\u6a2a\u8f74\u4e3a\u5de5\u4f5c\u8d1f\u8f7d\u7c7b\u578b\uff1aSGEMM\u3001QUANT\u3001SAXPY\u3001PACK\u3002</li> <li>\u7eb5\u8f74\u4e3a\u76f8\u5bf9\u6027\u80fd\u500d\u6570\uff0c\u6570\u503c\u8d8a\u9ad8\u8868\u793a\u6027\u80fd\u8d8a\u5f3a\u3002</li> <li>\u56fe\u4e2d\u5305\u542b\u56db\u7ec4\u67f1\u72b6\u56fe\uff0c\u5206\u522b\u4ee3\u8868\u4e0d\u540c\u914d\u7f6e\u7684 T1\uff1a</li> <li>D256V1K: DLEN=256, VLEN=1024</li> <li>D1KV4K: DLEN=1024, VLEN=4096</li> <li>D2561K-DRAM: DLEN=256, VLEN=1024, \u4f7f\u7528 DDR4-3200 \u5185\u5b58</li> <li>D1KV4K-DRAM: DLEN=1024, VLEN=4096, \u4f7f\u7528 DDR4-3200 \u5185\u5b58</li> <li>KP920 \u7684\u6027\u80fd\u5728\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5747\u88ab\u5f52\u4e00\u5316\u4e3a 1.0\uff0c\u4f5c\u4e3a\u6bd4\u8f83\u57fa\u51c6\u3002</li> <li>\u6027\u80fd\u5bf9\u6bd4\u7ed3\u679c\u5982\u4e0b\u8868\u6240\u793a\uff1a</li> </ul> Workload D256V1K D1KV4K D2561K-DRAM D1KV4K-DRAM KP920 (Baseline) SGEMM ~0.5x ~2.0x ~0.5x ~2.0x 1.0x QUANT ~1.5x ~2.5x ~1.0x ~2.0x 1.0x SAXPY ~0.5x ~2.0x ~0.5x ~2.0x 1.0x PACK ~1.0x ~4.5x ~1.0x ~4.5x 1.0x <ul> <li>\u5173\u952e\u53d1\u73b0\uff1a</li> <li>\u5728 PACK \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0cD1KV4K \u914d\u7f6e\u7684 T1 \u6027\u80fd\u8fbe\u5230 KP920 \u7684 4.5 \u500d\uff0c\u662f\u6240\u6709\u7ec4\u5408\u4e2d\u6027\u80fd\u63d0\u5347\u6700\u663e\u8457\u7684\u3002</li> <li>\u5728 QUANT \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0cD1KV4K \u914d\u7f6e\u7684 T1 \u6027\u80fd\u7ea6\u4e3a KP920 \u7684 2.5 \u500d\u3002</li> <li>D1KV4K \u914d\u7f6e\u5728\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5747\u4f18\u4e8e D256V1K\uff0c\u8868\u660e\u589e\u5927 DLEN \u548c VLEN \u53ef\u663e\u8457\u63d0\u5347\u6027\u80fd\u3002</li> <li>\u4f7f\u7528 DDR4-3200 \u5185\u5b58\u7684\u914d\u7f6e\uff08D2561K-DRAM \u548c D1KV4K-DRAM\uff09\u6027\u80fd\u7565\u4f4e\u4e8e\u4f7f\u7528\u672c\u5730\u5185\u5b58\u7684\u914d\u7f6e\uff0c\u4f46\u5728 PACK \u4e0a\u4ecd\u4fdd\u6301 4.5 \u500d \u7684\u4f18\u52bf\u3002</li> <li>SGEMM \u548c SAXPY \u5de5\u4f5c\u8d1f\u8f7d\u5bf9\u5185\u5b58\u5e26\u5bbd\u654f\u611f\uff0c\u56e0\u6b64\u5728 DRAM \u914d\u7f6e\u4e0b\u6027\u80fd\u6709\u6240\u4e0b\u964d\uff0c\u4f46\u4ecd\u4f18\u4e8e\u6216\u6301\u5e73\u4e8e KP920\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#b-t1-memory-scalability","title":"(b) T1 Memory Scalability","text":"<ul> <li>\u56fe\u7247\u6807\u9898\u4e3a (b) T1 Memory Scalability\uff0c\u5c5e\u4e8e\u8bba\u6587\u7b2c6.2.2\u8282\u201cEndurance for Memory Latency\u201d\u7684\u53ef\u89c6\u5316\u6570\u636e\uff0c\u65e8\u5728\u5c55\u793aT1\u5728\u4e0d\u540c\u5185\u5b58\u914d\u7f6e\u4e0b\u7684\u6027\u80fd\u8868\u73b0\u53ca\u5176\u5bf9\u5185\u5b58\u5ef6\u8fdf\u7684\u5bb9\u5fcd\u80fd\u529b\u3002</li> <li>\u56fe\u8868\u6a2a\u8f74\u5305\u542b\u4e24\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\uff1aQUANT \u548c QUANT-DRAM\u3002\u524d\u8005\u4ee3\u8868\u7406\u60f3\u5185\u5b58\u73af\u5883\uff08\u5982\u672c\u5730SRAM\uff09\uff0c\u540e\u8005\u4ee3\u8868\u4f7f\u7528DDR4-3200\u4e3b\u5b58\u7684\u573a\u666f\uff0c\u7528\u4e8e\u5bf9\u6bd4T1\u5728\u771f\u5b9e\u5185\u5b58\u7cfb\u7edf\u4e2d\u7684\u6027\u80fd\u8870\u51cf\u3002</li> <li>\u7eb5\u8f74\u4e3a\u5f52\u4e00\u5316\u6027\u80fd\u503c\uff0c\u57fa\u51c6\u4e3a HiSilicon KP920\uff0c\u5373\u6240\u6709\u67f1\u72b6\u56fe\u9ad8\u5ea6\u5747\u76f8\u5bf9\u4e8eKP920\u7684\u6027\u80fd\u8fdb\u884c\u6807\u51c6\u5316\uff0c\u6570\u503c\u5927\u4e8e1\u8868\u793aT1\u4f18\u4e8eKP920\u3002</li> <li>\u56fe\u4f8b\u4e2d\u5305\u542b\u4e94\u79cdT1\u914d\u7f6e\u548c\u4e00\u79cd\u57fa\u51c6\uff1a</li> <li>D128V512\uff1aDLEN=128, VLEN=512</li> <li>D256V1K\uff1aDLEN=256, VLEN=1024</li> <li>D512V2K\uff1aDLEN=512, VLEN=2048</li> <li>D1KV4K\uff1aDLEN=1024, VLEN=4096</li> <li>KP920\uff1aHiSilicon TaiShan V120 (KP920) ARM SVE\u5904\u7406\u5668\uff0c\u4f5c\u4e3a\u5bf9\u6bd4\u57fa\u51c6</li> </ul> \u914d\u7f6e QUANT \u6027\u80fd QUANT-DRAM \u6027\u80fd D128V512 ~0.4 ~0.3 D256V1K ~0.7 ~0.6 D512V2K ~1.1 ~1.0 D1KV4K ~1.5 ~1.54 KP920 1.0 1.0 <ul> <li>\u5728 QUANT \u5de5\u4f5c\u8d1f\u8f7d\u4e0b\uff0c\u968f\u7740DLEN\u548cVLEN\u589e\u5927\uff0cT1\u6027\u80fd\u6301\u7eed\u63d0\u5347\uff0cD1KV4K \u8fbe\u5230 1.5x KP920\u6027\u80fd\u3002</li> <li>\u5728 QUANT-DRAM \u573a\u666f\u4e0b\uff0cT1\u4ecd\u4fdd\u6301\u5f3a\u52b2\u8868\u73b0\uff0cD1KV4K \u5b9e\u73b0 1.54x KP920\u6027\u80fd\uff0c\u8868\u660e\u5176\u5373\u4f7f\u5728\u65e0\u672c\u5730\u7f13\u5b58\u3001\u4ec5\u4f9d\u8d56DDR4\u7684\u60c5\u51b5\u4e0b\uff0c\u4ecd\u80fd\u901a\u8fc7\u5927VLEN\u548c\u52a8\u6001VL\u8bbe\u7f6e\uff08strip-mining\uff09\u6709\u6548\u63a9\u76d6\u5185\u5b58\u5ef6\u8fdf\u3002</li> <li>\u6570\u636e\u663e\u793a\uff0cT1\u7684\u6027\u80fd\u589e\u76ca\u968fDLEN\u6269\u5927\u800c\u663e\u8457\uff0c\u4e14\u5728\u7eafDRAM\u73af\u5883\u4e0b\u672a\u51fa\u73b0\u660e\u663e\u6027\u80fd\u635f\u5931\uff0c\u9a8c\u8bc1\u4e86\u5176\u201crobust tolerance to memory latency\u201d\u7684\u8bbe\u8ba1\u76ee\u6807\u3002</li> <li>\u76f8\u6bd4\u4e4b\u4e0b\uff0cKP920\u4f9d\u8d56\u517632MiB LLC\u7f13\u5b58\u7ef4\u6301\u6027\u80fd\uff0c\u800cT1\u901a\u8fc7\u67b6\u6784\u8bbe\u8ba1\uff08\u5982\u5411\u91cf\u94fe\u5f0f\u6267\u884c\u3001\u52a8\u6001VL\u63a7\u5236\uff09\u5b9e\u73b0\u4e86\u66f4\u4f18\u7684\u5185\u5b58\u6548\u7387\uff0c\u6f5c\u5728\u8282\u7701\u82af\u7247\u9762\u79ef\u4e0e\u529f\u8017\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/figs_notes/#c-t1-x60-comparison-figure-9-hpc-benchmark-results-figure-9a-performance-of-t1-at-245-ghz-with-local-memory-and-ddr4-3200-normalized-to-kp920-figure-9b-performance-comparison-illustrating-t1s-tolerance-to-memory-latency-showing-results-with-dram-and-local-sram-normalized-to-kp920-it-uses-stripmining-by-dynamically-set-vl-for-continues-dram-access-in-sgemm-workload-figure-9c-performance-of-t1-at-16-ghz-using-ddr4-3200-normalized-to-k1-where-higher-is-better","title":"(c) T1-X60 Comparison Figure 9: HPC benchmark results: Figure 9a: Performance of T1 (at 2.45 GHz) with local memory and DDR4-3200, normalized to KP920; Figure 9b: Performance comparison illustrating T1's tolerance to memory latency, showing results with DRAM and local SRAM, normalized to KP920. It uses stripmining by dynamically set VL for continues DRAM access in SGEMM workload.; Figure 9c: Performance of T1 (at 1.6 GHz) using DDR4-3200, normalized to K1, where higher is better.","text":"<ul> <li>\u56fe\u7247 3fc4a8f87ca51c5cf7d7530a5222cf61f80d98860cfc68d0847c09d667c3cb52.jpg \u662f\u8bba\u6587 Figure 9c\uff0c\u6807\u9898\u4e3a \u201cT1-X60 Comparison\u201d\uff0c\u7528\u4e8e\u5c55\u793a Titan-I (T1) \u4e0e SpacemiT X60 (K1) \u5728 HPC \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u7684\u6027\u80fd\u5bf9\u6bd4\u3002</li> <li>\u8be5\u56fe\u662f\u67f1\u72b6\u56fe\uff0c\u7eb5\u8f74\u8868\u793a\u6027\u80fd\uff08\u5f52\u4e00\u5316\u5230 K1 \u7684\u503c\uff09\uff0c\u6a2a\u8f74\u5217\u51fa\u56db\u4e2a HPC \u57fa\u51c6\u6d4b\u8bd5\uff1aSGEMM\u3001QUANT\u3001SAXPY \u548c PACK\u3002</li> <li>\u56fe\u4f8b\u663e\u793a\u4e86\u4e94\u79cd\u4e0d\u540c\u7684\u914d\u7f6e\uff0c\u5176\u4e2d X60 \u4f5c\u4e3a\u57fa\u51c6\uff08\u5f52\u4e00\u5316\u503c\u4e3a 1.0\uff09\uff0c\u5176\u4f59\u56db\u79cd\u5747\u4e3a\u4e0d\u540c\u914d\u7f6e\u7684 T1\uff1a<ul> <li>D128V512: DLEN=128, VLEN=512</li> <li>D256V1K: DLEN=256, VLEN=1024</li> <li>D512V2K: DLEN=512, VLEN=2048</li> <li>D1KV4K: DLEN=1024, VLEN=4096</li> </ul> </li> <li>\u6240\u6709 T1 \u914d\u7f6e\u5747\u5728 1.6 GHz \u4e0b\u8fd0\u884c\uff0c\u5e76\u4f7f\u7528 DDR4-3200 \u5185\u5b58\uff0c\u800c X60 \u5219\u4f7f\u7528\u5176\u5185\u7f6e\u7684 512 KiB L2 \u7f13\u5b58\u3002\u6b64\u8bbe\u7f6e\u65e8\u5728\u516c\u5e73\u6bd4\u8f83\uff0c\u56e0\u4e3a X60 \u7684\u7f13\u5b58\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u8fd9\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u56e0\u6b64 T1 \u4e0d\u4f7f\u7528\u672c\u5730 SRAM\uff0c\u4ee5\u5141\u8bb8 X60 \u5145\u5206\u5229\u7528\u5176\u7f13\u5b58\u3002</li> <li>\u6027\u80fd\u6570\u636e\u603b\u7ed3\u5982\u4e0b\u8868\uff1a</li> </ul> Benchmark X60 (Baseline) D128V512 D256V1K D512V2K D1KV4K SGEMM 1.0 ~1.5x ~2.5x ~4.0x ~5.5x QUANT 1.0 ~1.8x ~3.0x ~5.0x ~6.5x SAXPY 1.0 ~1.2x ~2.0x ~3.5x ~5.0x PACK 1.0 ~1.0x ~2.0x ~4.0x ~6.0x <ul> <li>\u4ece\u56fe\u8868\u548c\u6570\u636e\u53ef\u4ee5\u770b\u51fa\uff0cT1 \u5728\u6240\u6709\u56db\u4e2a HPC \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5747\u663e\u8457\u4f18\u4e8e X60\u3002</li> <li>\u6027\u80fd\u4f18\u52bf\u968f\u7740 T1 \u7684 DLEN \u548c VLEN \u589e\u52a0\u800c\u6269\u5927\u3002\u4f8b\u5982\uff0c\u5728 PACK \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0cD1KV4K \u914d\u7f6e\u7684 T1 \u8fbe\u5230\u4e86 \u7ea6 6 \u500d\u4e8e X60 \u7684\u6027\u80fd\u3002</li> <li>\u8bba\u6587\u6b63\u6587\u6307\u51fa\uff0c\u5728\u76f8\u540c\u7684 256-bit \u6570\u636e\u8def\u5f84\u4e0b\uff0cT1 \u7684\u6027\u80fd\u6bd4 X60 \u9ad8\u51fa 2.02x \u81f3 6.36x\uff1b\u5f53 T1 \u7684\u6570\u636e\u8def\u5f84\u6269\u5c55\u5230 1024 \u4f4d\u65f6\uff0c\u8fd9\u4e00\u4f18\u52bf\u8fdb\u4e00\u6b65\u653e\u5927\u81f3 \u7ea6 8.05x\uff0c\u8fd9\u4e0e\u56fe\u8868\u4e2d D1KV4K \u914d\u7f6e\u5728\u591a\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u63a5\u8fd1\u6216\u8d85\u8fc7 6x \u7684\u8868\u73b0\u4e00\u81f4\u3002</li> <li>\u6b64\u7ed3\u679c\u51f8\u663e\u4e86 T1 \u5fae\u67b6\u6784\u8bbe\u8ba1\u7684\u6709\u6548\u6027\uff0c\u7279\u522b\u662f\u5728\u5904\u7406\u9700\u8981\u9ad8\u6570\u636e\u5e76\u884c\u5ea6\uff08DLP\uff09\u548c\u6307\u4ee4\u7ea7\u5e76\u884c\u5ea6\uff08ILP\uff09\u7684 HPC \u5e94\u7528\u65f6\uff0c\u5373\u4f7f\u5728\u5185\u5b58\u5e26\u5bbd\u53d7\u9650\u7684\u7eaf DDR \u6a21\u5f0f\u4e0b\uff0c\u4e5f\u80fd\u5b9e\u73b0\u8fdc\u8d85\u73b0\u6709 RVV \u5904\u7406\u5668\u7684\u6027\u80fd\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/","title":"Titan-I: An Open-Source, High Performance RISC-V Vector Core \u8bba\u6587\u89e3\u6790","text":""},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#0","title":"0. \u8bba\u6587\u57fa\u672c\u4fe1\u606f","text":"<p>\u4f5c\u8005 (Authors) - Jiuyang Liu - Qinjun Li - Yunqian Luo - Hongbin Zhang - Jiongjia Lu - Shupei Fan - Jianhao Ye - Yang Liu - Xiaoyi Liu - Yanqi Yang - Zewen Ye - Yuhang Zeng - Ao Shen - Rui Huang - Wei Cong - Xuecheng Zou - Mingyu Gao</p> <p>\u53d1\u8868\u671f\u520a/\u4f1a\u8bae (Journal/Conference) - 58th IEEE/ACM International Symposium on Microarchitecture (MICRO '25)</p> <p>\u53d1\u8868\u5e74\u4efd (Publication Year) - 2025</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#1","title":"1. \u6458\u8981","text":"<p>\u76ee\u7684 - \u89e3\u51b3\u4f20\u7edf\u5411\u91cf\u5904\u7406\u5668\u5728\u6269\u5c55 VLEN (Vector Length) \u548c DLEN (Datapath Width) \u65f6\u9762\u4e34\u7684\u5fae\u67b6\u6784\u74f6\u9888\uff0c\u5305\u62ec\u8def\u7531\u62e5\u585e\u3001\u63a9\u7801\u5bc4\u5b58\u5668\u5e7f\u64ad\u5f00\u9500\u4ee5\u53ca ILP (Instruction-Level Parallelism) \u8c03\u5ea6\u4e0d\u8db3\u7b49\u95ee\u9898\u3002 - \u8bbe\u8ba1\u5e76\u5b9e\u73b0\u4e00\u4e2a\u9ad8\u6027\u80fd\u3001\u53ef\u6269\u5c55\u7684 RISC-V Vector (RVV) \u6838\u5fc3\uff0c\u80fd\u591f\u540c\u65f6\u9ad8\u6548\u5730\u5229\u7528 ILP \u548c DLP (Data-Level Parallelism)\uff0c\u4ee5\u5728 HPC \u548c Cryptography \u7b49\u9886\u57df\u8d85\u8d8a GP-GPU \u548c\u73b0\u6709\u5411\u91cf\u6838\u5fc3\u3002</p> <p>\u65b9\u6cd5 - \u63d0\u51fa Titan-I (T1) \u67b6\u6784\uff0c\u4e00\u4e2a\u5f00\u6e90\u7684\u3001\u4e71\u5e8f\u6267\u884c (OoO) \u7684 lane-based RVV \u6838\u5fc3\u751f\u6210\u5668\u3002 - \u4e3a\u89e3\u51b3\u6269\u5c55\u6027\u6311\u6218\uff0c\u5f15\u5165\u4e09\u9879\u5173\u952e\u521b\u65b0\uff1a   - Coarse-grained floor-planning solver: \u4f18\u5316 lane \u5e03\u5c40\uff0c\u6700\u5c0f\u5316\u8de8 lane \u8bbf\u95ee\uff08\u5982 widen/narrow \u64cd\u4f5c\uff09\u7684\u6700\u5927\u8def\u7531\u5ef6\u8fdf\u3002        - Datapath-wide permutation unit: \u63d0\u4f9b\u4e13\u7528\u7684\u5168\u5e26\u5bbd\u6570\u636e\u91cd\u6392\u786c\u4ef6\uff0c\u907f\u514d\u901a\u8fc7\u672c\u5730\u5185\u5b58\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u3002   - Shadow-cache for mask registers: \u4e3a\u63a9\u7801\u5bc4\u5b58\u5668 v0 \u5f15\u5165\u5f71\u5b50\u7f13\u5b58\uff0c\u6d88\u9664\u8c13\u8bcd\u6267\u884c\u4e2d\u7684\u975e\u5c40\u90e8\u5e7f\u64ad\u74f6\u9888\u3002 - \u4e3a\u63d0\u5347 ILP\uff0c\u90e8\u7f72\u591a\u79cd\u5411\u91cf\u4e13\u7528\u7684 OoO \u6280\u672f\uff1a   - Fine-grained chaining: \u5728 lane datapath \u7c92\u5ea6\u4e0a\u8c03\u5ea6\u4f9d\u8d56\u7684\u5fae\u64cd\u4f5c (uops)\uff0c\u6700\u5927\u5316\u7b97\u672f\u548c\u5185\u5b58\u6307\u4ee4\u95f4\u7684\u91cd\u53e0\u3002   - Issue-as-commit: \u5141\u8bb8\u6807\u91cf\u548c\u5411\u91cf\u6d41\u6c34\u7ebf\u5728\u65e0\u771f\u5b9e\u4f9d\u8d56\u65f6\u72ec\u7acb\u63d0\u4ea4\uff0c\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u505c\u987f\u3002   - Memory interleaving: \u5141\u8bb8\u975e\u51b2\u7a81\u7684\u52a0\u8f7d\u548c\u5b58\u50a8\u6307\u4ee4\u5e76\u884c\u6267\u884c\uff0c\u63d0\u9ad8\u5185\u5b58\u5229\u7528\u7387\u3002</p> <p>\u7ed3\u679c - T1 \u5728\u591a\u4e2a\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u5c55\u73b0\u51fa\u5353\u8d8a\u6027\u80fd\uff0c\u663e\u8457\u4f18\u4e8e GP-GPU \u548c\u5176\u4ed6\u5411\u91cf\u6838\u5fc3\u3002 - Cryptographic Workloads:   - \u5728 Montgomery Modular Multiplication (MMM) \u548c Number-Theoretic Transform (NTT) \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\uff0cT1 (DLEN=1024, VLEN=16384) \u76f8\u6bd4 Nvidia GA102 (RTX 3090) \u548c GB202 (RTX 5090) \u5b9e\u73b0\u4e86\u6700\u9ad8 2.41\u500d \u7684\u52a0\u901f\u3002   - T1 \u7684\u9762\u79ef\u4ec5\u4e3a GA102 \u5355\u4e2a SM \u7684 40%\u3002</p> <p></p> <p>Figure 8: Cryptographic Benchmarks of T1 (DLEN1K, VLEN16K, emulated with DDR4-3200) with GA102 (NVIDIA GTX 3090) and NVIDIA GB202 (GTX 5090)</p> <ul> <li>HPC Workloads:</li> <li>\u4e0e HiSilicon TaiShan V120 (KP920) \u76f8\u6bd4\uff0cT1 \u5728\u76f8\u5f53\u6027\u80fd\u4e0b\u4ec5\u9700\u5176 19% \u7684\u9762\u79ef\uff1b\u5f53 DLEN \u6269\u5c55 4\u500d \u540e\uff0c\u6027\u80fd\u63d0\u5347\u8fbe 4.59\u500d\u3002</li> <li>\u5728\u7eaf DDR \u6a21\u5f0f\u4e0b\uff0cT1 \u5bf9 SpacemiT X60 (K1) \u7684\u6027\u80fd\u4f18\u52bf\u9ad8\u8fbe 8.05\u500d\uff0c\u5c55\u73b0\u4e86\u5f3a\u5927\u7684\u5185\u5b58\u5ef6\u8fdf\u5bb9\u5fcd\u80fd\u529b\u3002</li> </ul> <p></p> <p>(a) T1-KP920 Comparison</p> <p></p> <p>(b) T1 Memory Scalability</p> <p></p> <p>(c) T1-X60 Comparison Figure 9: HPC benchmark results: Figure 9a: Performance of T1 (at 2.45 GHz) with local memory and DDR4-3200, normalized to KP920; Figure 9b: Performance comparison illustrating T1's tolerance to memory latency, showing results with DRAM and local SRAM, normalized to KP920. It uses stripmining by dynamically set VL for continues DRAM access in SGEMM workload.; Figure 9c: Performance of T1 (at 1.6 GHz) using DDR4-3200, normalized to K1, where higher is better.</p> <ul> <li>\u5fae\u67b6\u6784\u7279\u6027\u9a8c\u8bc1\uff1a</li> <li>Fine-grained chaining \u6280\u672f\u5728 PACK \u6d4b\u8bd5\u4e2d\u5e26\u6765\u4e86 61% \u7684\u6027\u80fd\u63d0\u5347\u3002</li> <li>Memory interleaving \u6280\u672f\u63d0\u5347\u4e86 32% \u7684\u6027\u80fd\u3002</li> </ul> <p></p> <p>Figure 1: Execution Cycles for Different Standalone Workloads on Datapath Size of T1 from 128 to 1024.</p> \u5de5\u4f5c\u8d1f\u8f7d T1 \u914d\u7f6e (cycles) \u7981\u7528 Chaining (slowdown) \u7981\u7528 Memory Interleaving (slowdown) PACK 14817 61% 32% <p>\u7ed3\u8bba - Titan-I (T1) \u6210\u529f\u5730\u5f25\u5408\u4e86 ILP \u4e0e DLP \u4e4b\u95f4\u7684\u9e3f\u6c9f\uff0c\u901a\u8fc7\u4e00\u7cfb\u5217\u521b\u65b0\u7684\u5fae\u67b6\u6784\u8bbe\u8ba1\uff0c\u5b9e\u73b0\u4e86 VLEN \u548c DLEN \u7684\u9ad8\u6548\u6269\u5c55\u3002 - T1 \u5728 Cryptography \u548c HPC \u9886\u57df\u5c55\u73b0\u51fa\u8d85\u8d8a GP-GPU \u548c\u73b0\u6709\u5411\u91cf\u5904\u7406\u5668\u7684\u6027\u80fd\u548c\u80fd\u6548\u4f18\u52bf\uff0c\u8bc1\u660e\u4e86 RISC-V Vector \u67b6\u6784\u5728\u9ad8\u6027\u80fd\u8ba1\u7b97\u9886\u57df\u7684\u5de8\u5927\u6f5c\u529b\u3002 - \u4f5c\u4e3a\u4e00\u4e2a\u5f00\u6e90\u9879\u76ee\uff0cT1 \u4e3a\u786c\u4ef6-\u8f6f\u4ef6\u534f\u540c\u8bbe\u8ba1\u63d0\u4f9b\u4e86\u575a\u5b9e\u7684\u57fa\u7840\uff0c\u6709\u671b\u63a8\u52a8\u53ef\u6301\u7eed\u7684 HPC \u672a\u6765\u53d1\u5c55\u3002</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#2","title":"2. \u80cc\u666f\u77e5\u8bc6\u4e0e\u6838\u5fc3\u8d21\u732e","text":"<p>\u7814\u7a76\u80cc\u666f - Vector processing \u662f\u4e00\u79cd\u5386\u53f2\u60a0\u4e45\u7684\u5e76\u884c\u8ba1\u7b97\u8303\u5f0f\uff0c\u4ece CDC STAR-100 \u548c Cray-1 \u7b49\u65e9\u671f\u7cfb\u7edf\u53d1\u5c55\u800c\u6765\u3002 - \u73b0\u4ee3\u6307\u4ee4\u96c6\u67b6\u6784\uff08ISA\uff09\u5982 ARM SVE \u548c RISC-V Vector (RVV) \u901a\u8fc7\u5f15\u5165\u52a8\u6001 Machine Vector Length (MVL) \u548c mask registers\uff0c\u4e3a\u5f53\u4ee3\u5de5\u4f5c\u8d1f\u8f7d\u63d0\u4f9b\u4e86\u7075\u6d3b\u6027\u3002 - Vector \u5904\u7406\u5668\u5728 Superscalar CPU\u3001GP-GPU \u548c Domain-Specific Accelerators (DSA) \u4e4b\u95f4\u53d6\u5f97\u4e86\u5e73\u8861\uff1a\u5b83\u907f\u514d\u4e86 CPU \u7684\u63a8\u6d4b\u6267\u884c\u5f00\u9500\u548c GP-GPU \u7684\u590d\u6742\u7f16\u7a0b\u6a21\u578b\uff0c\u540c\u65f6\u6bd4 DSA \u66f4\u5177\u901a\u7528\u6027\u3002 - \u5c3d\u7ba1\u4f18\u52bf\u660e\u663e\uff0c\u4f46\u5c06 VLEN\uff08\u5411\u91cf\u5bc4\u5b58\u5668\u957f\u5ea6\uff09\u548c DLEN\uff08\u6570\u636e\u901a\u8def\u5bbd\u5ea6\uff09\u6269\u5c55\u5230\u8fdc\u8d85\u4f20\u7edf 128-512 \u4f4d\u7684\u89c4\u6a21\u65f6\uff0c\u73b0\u6709\u8bbe\u8ba1\u9762\u4e34\u4e25\u5cfb\u6311\u6218\uff1a     - \u8def\u7531\u62e5\u585e\uff1a\u5728\u57fa\u4e8e Lane \u7684\u8bbe\u8ba1\u4e2d\uff0cPermutation instructions\uff08\u5982 VRGATHER\uff09\u548c mask register (v0) \u7684\u8de8 Lane \u8bbf\u95ee\u4f1a\u4ea7\u751f\u5de8\u5927\u7684\u5e03\u7ebf\u74f6\u9888\u3002     - ILP \u8c03\u5ea6\u4e0d\u8db3\uff1a\u4f20\u7edf\u4e71\u5e8f\uff08OoO\uff09\u6280\u672f\uff08\u5982 Tomasulo \u7b97\u6cd5\uff09\u65e0\u6cd5\u6709\u6548\u5904\u7406\u5411\u91cf\u6307\u4ee4\u7684\u5143\u7d20\u7ea7\u4f9d\u8d56\u3002\u8bb8\u591a\u73b0\u6709\u5411\u91cf\u6838\uff08\u5982 ETH's Ara\uff09\u751a\u81f3\u5b8c\u5168\u653e\u5f03\u4e86 ILP\uff0c\u5bfc\u81f4\u786c\u4ef6\u8d44\u6e90\u5229\u7528\u7387\u4f4e\u4e0b\u3002     - \u5185\u5b58\u5229\u7528\u6548\u7387\u4f4e\uff1aRVV \u9700\u8981\u652f\u6301\u591a\u79cd\u8bbf\u5b58\u6a21\u5f0f\uff08unit-stride, indexed, segment\uff09\uff0c\u4f46\u73b0\u6709\u5b9e\u73b0\u901a\u5e38\u4e00\u6b21\u53ea\u80fd\u5904\u7406\u4e00\u6761\u5185\u5b58\u6307\u4ee4\uff0c\u65e0\u6cd5\u5145\u5206\u5229\u7528\u5e26\u5bbd\u3002</p> <p>\u7814\u7a76\u52a8\u673a - \u5f53\u524d\u9ad8\u6027\u80fd\u5411\u91cf\u5904\u7406\u5668\u7684\u8bbe\u8ba1\u5b58\u5728\u4e00\u4e2a\u6839\u672c\u6027\u7684\u77db\u76fe\uff1aData-Level Parallelism (DLP) \u7684\u6269\u5c55\uff08\u901a\u8fc7\u589e\u5927 DLEN/VLEN\uff09\u4e0e Instruction-Level Parallelism (ILP) \u7684\u6709\u6548\u8c03\u5ea6\u4e4b\u95f4\u5b58\u5728\u9e3f\u6c9f\u3002 - \u5546\u4e1a\u548c\u5b66\u672f\u754c\u7684\u73b0\u6709\u65b9\u6848\u5747\u672a\u80fd\u5b8c\u7f8e\u89e3\u51b3\u6b64\u95ee\u9898\uff1a     - ARM A725\u3001Xiangshan KunMingHu \u7b49\u53d7\u5236\u4e8e\u4f20\u7edf\u6807\u91cf\u6838\u5fc3\u7684\u91cd\u547d\u540d\u548c ROB \u5f00\u9500\uff0c\u96be\u4ee5\u6269\u5c55 VLEN/DLEN\u3002     - ETH's Ara \u91c7\u7528 Lane-based \u8bbe\u8ba1\u89e3\u51b3\u4e86\u90e8\u5206\u6269\u5c55\u6027\u95ee\u9898\uff0c\u4f46\u7f3a\u4e4f ILP \u652f\u6301\u3002     - Berkeley's Saturn \u652f\u6301\u7c97\u7c92\u5ea6 chaining\uff0c\u4f46\u65e0\u6cd5\u5b9e\u73b0\u7ec6\u7c92\u5ea6\u7684\u5143\u7d20\u7ea7 ILP\u3002 - \u56e0\u6b64\uff0c\u4e9f\u9700\u4e00\u79cd\u5168\u65b0\u7684\u5fae\u67b6\u6784\uff0c\u80fd\u591f\u540c\u65f6\u3001\u9ad8\u6548\u5730\u6269\u5c55 DLP \u548c ILP\uff0c\u4ee5\u91ca\u653e RVV ISA \u5728\u5bc6\u7801\u5b66\u548c HPC \u7b49\u9886\u57df\u7684\u5168\u90e8\u6f5c\u529b\u3002</p> <p>\u6838\u5fc3\u8d21\u732e - \u63d0\u51fa\u4e86 Titan-I (T1)\uff0c\u4e00\u4e2a\u5f00\u6e90\u3001\u9ad8\u6027\u80fd\u3001\u4e71\u5e8f\u6267\u884c\u7684 RISC-V Vector Core Generator\uff0c\u65e8\u5728\u5f25\u5408 DLP \u4e0e ILP \u4e4b\u95f4\u7684\u9e3f\u6c9f\u3002 - \u4e3a\u89e3\u51b3 DLP \u6269\u5c55\u4e2d\u7684\u7269\u7406\u8bbe\u8ba1\u6311\u6218\uff0c\u5f15\u5165\u4e86\u4e09\u9879\u5173\u952e\u521b\u65b0\uff1a     - Coarse-grained floor-planning solver\uff1a\u901a\u8fc7\u542f\u53d1\u5f0f\u7b97\u6cd5\u4f18\u5316 Lane \u5e03\u5c40\uff0c\u663e\u8457\u51cf\u5c11\u8de8 Lane \u8bbf\u95ee\uff08\u5982 widen/narrow \u64cd\u4f5c\uff09\u7684\u6700\u5927\u8def\u7531\u5ef6\u8fdf\u3002\uff08\u6ce8\uff1a\u6b64\u5904\u5e94\u4e3a Figure 5\uff0c\u4f46\u6839\u636e\u63d0\u4f9b\u6587\u4ef6\u540d\u5217\u8868\uff0c\u6700\u63a5\u8fd1\u7684\u662f <code>cf9544a7...</code>\uff0c\u4f46\u8be5\u56fe\u4e3a Figure 1\u3002\u4e25\u683c\u6309\u6307\u4ee4\uff0c\u5e94\u4f7f\u7528\u771f\u5b9e\u6587\u4ef6\u540d\uff0c\u6545\u6b64\u5904\u4e0d\u5f3a\u884c\u63d2\u5165\u9519\u8bef\u56fe\uff09     - Datapath-wide permutation unit\uff1a\u63d0\u4f9b\u4e13\u7528\u7684\u5168\u901a\u8def\u5bbd\u7f6e\u6362\u5355\u5143\uff0c\u539f\u751f\u652f\u6301\u9ad8\u541e\u5410\u7684 permutation \u6307\u4ee4\uff0c\u907f\u514d\u4e86\u50cf GP-GPU \u90a3\u6837\u901a\u8fc7\u672c\u5730\u5185\u5b58\u4ea4\u6362\u6765\u6a21\u62df\u7684\u6027\u80fd\u635f\u5931\u3002     - Shadow-cache for mask registers\uff1a\u4e3a mask register v0 \u5f15\u5165\u4e00\u4e2a\u4f4d\u4e8e\u7f6e\u6362\u5355\u5143\u4e2d\u7684\u5f71\u5b50\u7f13\u5b58\uff0c\u6d88\u9664\u4e86 predicated execution \u65f6\u7684\u975e\u672c\u5730\u5e7f\u64ad\uff0c\u89e3\u51b3\u4e86\u5386\u53f2\u6027\u7684\u5e03\u7ebf\u74f6\u9888\u3002 - \u4e3a\u89e3\u9501\u4e0e\u5bbd\u6570\u636e\u901a\u8def\u76f8\u5339\u914d\u7684 ILP\uff0c\u90e8\u7f72\u4e86\u4e00\u5957\u5411\u91cf\u4e13\u7528\u7684 OoO \u6280\u672f\uff1a     - Fine-grained chaining\uff1a\u5728 Lane datapath granularity \u4e0a\u8c03\u5ea6\u4f9d\u8d56\u7684 uops\uff0c\u6700\u5927\u5316\u7b97\u672f\u548c\u5185\u5b58\u6307\u4ee4\u95f4\u7684\u91cd\u53e0\u3002     - Issue-as-commit\uff1a\u901a\u8fc7\u7d27\u51d1\u7684 vector scoreboards \u5b9e\u73b0\u6807\u91cf\u548c\u5411\u91cf\u6d41\u6c34\u7ebf\u95f4\u7684\u4f4e\u5f00\u9500\u534f\u8c03\uff0c\u5141\u8bb8\u65e0\u4f9d\u8d56\u7684\u6807\u91cf\u6307\u4ee4\u5728\u5411\u91cf\u6307\u4ee4\u6267\u884c\u65f6\u7ee7\u7eed\u63d0\u4ea4\u3002     - Memory interleaving\uff1a\u5141\u8bb8\u591a\u4e2a\u4e0d\u51b2\u7a81\u7684 Load/Store \u6307\u4ee4\u5e76\u884c\u6267\u884c\uff0c\u540c\u65f6\u5229\u7528 delay-slot forwarding \u5728\u957f\u5ef6\u8fdf\u7684 indexed \u8bbf\u95ee\u671f\u95f4\u4fdd\u6301\u72ec\u7acb\u6307\u4ee4\u7684\u6d41\u52a8\u3002 - \u8bc4\u4f30\u7ed3\u679c\u8868\u660e T1 \u6027\u80fd\u5353\u8d8a\uff1a     - \u5728\u5bc6\u7801\u5b66 workload \u4e0a\uff0c\u4ee5 40% \u7684\u9762\u79ef\u5b9e\u73b0\u4e86\u5bf9 Nvidia GA102 (3090) \u6700\u9ad8 2.41x \u7684\u52a0\u901f\u3002     - \u5728 HPC workload \u4e0a\uff0c\u4ee5 19% \u7684\u9762\u79ef\u5b9e\u73b0\u4e86\u4e0e HiSilicon TaiShan V120 (KP920) \u76f8\u5f53\u7684\u6027\u80fd\uff0c\u5e76\u5728 4 \u500d\u6269\u5c55\u6570\u636e\u901a\u8def\u540e\u83b7\u5f97 4.59x \u7684\u52a0\u901f\u3002     - \u5728\u7eaf DDR \u6a21\u5f0f\u4e0b\uff0c\u5bf9 SpacemiT X60 (K1) \u5c55\u73b0\u51fa 8.05x \u7684\u6027\u80fd\u4f18\u52bf\uff0c\u8bc1\u660e\u4e86\u5176\u5bf9\u5185\u5b58\u5ef6\u8fdf\u7684\u5f3a\u5927\u5bb9\u5fcd\u5ea6\u3002</p> <p></p> <p>Figure 8: Cryptographic Benchmarks of T1 (DLEN1K, VLEN16K, emulated with DDR4-3200) with GA102 (NVIDIA GTX 3090) and NVIDIA GB202 (GTX 5090)</p> <p></p> <p>(a) T1-KP920 Comparison</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#3","title":"3. \u6838\u5fc3\u6280\u672f\u548c\u5b9e\u73b0\u7ec6\u8282","text":""},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#0_1","title":"0. \u6280\u672f\u67b6\u6784\u6982\u89c8","text":"<p>\u6574\u4f53\u67b6\u6784\u6982\u89c8 Titan-I (T1) \u662f\u4e00\u4e2a lane-based\u3001out-of-order (OoO) \u7684 RISC-V Vector (RVV) \u6838\u5fc3\u751f\u6210\u5668\uff0c\u65e8\u5728\u540c\u65f6\u6269\u5c55 Instruction-Level Parallelism (ILP) \u548c Data-Level Parallelism (DLP)\u3002\u5176\u67b6\u6784\u56f4\u7ed5\u4e00\u4e2a\u4e2d\u592e Permutation Unit \u7ec4\u7ec7\uff0c\u5e76\u5305\u542b\u72ec\u7acb\u7684 Scalar Core\u3001Sequencer\u3001\u591a\u4e2a\u5e76\u884c Lanes \u4ee5\u53ca\u4e00\u4e2a\u53cc LSU \u5185\u5b58\u5b50\u7cfb\u7edf\u3002</p> <p></p> <p>Figure 3: Architecture of T1</p> <p>\u6838\u5fc3\u7ec4\u4ef6\u4e0e\u529f\u80fd</p> <ul> <li>Scalar Core: \u4f4d\u4e8e\u67b6\u6784\u9876\u90e8\uff0c\u8d1f\u8d23\u6307\u4ee4\u83b7\u53d6\u3001\u6807\u91cf\u6267\u884c\u548c\u63d0\u4ea4\u3002\u5b83\u901a\u8fc7\u4e00\u79cd issue-as-commit \u673a\u5236\u4e0e\u5411\u91cf\u5355\u5143\u89e3\u8026\uff0c\u5141\u8bb8\u5728\u6ca1\u6709\u771f\u5b9e\u6570\u636e\u4f9d\u8d56\u7684\u60c5\u51b5\u4e0b\uff0c\u6807\u91cf\u548c\u5411\u91cf\u6d41\u6c34\u7ebf\u5e76\u884c\u6267\u884c\uff0c\u4ece\u800c\u63d0\u5347\u6574\u4f53\u541e\u5410\u91cf\u3002</li> <li>Sequencer: \u4f5c\u4e3a\u5411\u91cf\u63a7\u5236\u4e2d\u5fc3\uff0c\u8d1f\u8d23\u89e3\u7801\u5411\u91cf\u6307\u4ee4\u3001\u7ba1\u7406\u4f9d\u8d56\u5173\u7cfb\uff08\u901a\u8fc7 Vector Scoreboards\uff09\uff0c\u5e76\u652f\u6301 Vector Configuration Instruction Fusion\uff0c\u5c06 <code>vsetvl*</code> \u6307\u4ee4\u4e0e\u540e\u7eed\u5411\u91cf\u6307\u4ee4\u878d\u5408\uff0c\u6d88\u9664\u914d\u7f6e\u5f00\u9500\u3002</li> <li>Vector Lanes: \u67b6\u6784\u7684\u4e3b\u4f53\u8ba1\u7b97\u5355\u5143\uff0c\u6bcf\u4e2a Lane \u5305\u542b\u72ec\u7acb\u7684\u6d41\u6c34\u7ebf\u3001banked VRF (Vector Register File) \u548c\u5f02\u6784 VFU (Vector Functional Units)\u3002Lane \u5185\u90e8\u91c7\u7528\u591a\u9879\u521b\u65b0\u6280\u672f\uff1a</li> <li>Linked-List Scoreboards: \u9ad8\u6548\u8ffd\u8e2a\u6307\u4ee4\u72b6\u6001\u548c\u4f9d\u8d56\uff0c\u652f\u6301 OoO \u63d0\u4ea4\u3002</li> <li>Speculative Zero-Mask Elision: \u5728\u524d\u7aef\u8df3\u8fc7\u5168\u96f6\u63a9\u7801\u7684\u65e0\u6548\u8ba1\u7b97\uff0c\u6781\u5927\u63d0\u5347\u7a00\u758f\u5de5\u4f5c\u8d1f\u8f7d\u6548\u7387\u3002</li> <li>Fine-Grained Chaining: \u5728 ELEN \u00d7 LaneScale \u7c92\u5ea6\u4e0a\u7ba1\u7406\u6570\u636e\u4f9d\u8d56\uff0c\u5141\u8bb8\u7ed3\u679c\u5728\u5b8c\u5168\u63d0\u4ea4\u524d\u5c31\u88ab\u540e\u7eed\u6307\u4ee4\u4f7f\u7528\uff0c\u6700\u5927\u5316\u6d41\u6c34\u7ebf\u5229\u7528\u7387\u3002</li> <li>Permutation Unit: \u4f4d\u4e8e\u67b6\u6784\u4e2d\u592e\uff0c\u662f\u89e3\u51b3 routing contention \u7684\u5173\u952e\u3002\u5b83\u5305\u542b\u4e00\u4e2a DLEN-width crossbar \u548c\u4e13\u7528\u529f\u80fd\u5355\u5143\uff0c\u7528\u4e8e\u9ad8\u6548\u5904\u7406\u8de8 Lane \u7684\u6570\u636e\u91cd\u6392\uff08\u5982 <code>VRGATHER</code>, <code>VCOMPRESS</code>\uff09\u548c\u5f52\u7ea6\u64cd\u4f5c\u3002\u6b64\u5916\uff0c\u5b83\u8fd8\u96c6\u6210\u4e86\u4e00\u4e2a Shadow Mask (v0) register cache\uff0c\u907f\u514d\u4e86\u5728\u8c13\u8bcd\u6267\u884c\u65f6\u6602\u8d35\u7684\u8de8 Lane \u5e7f\u64ad\u3002</li> <li>Memory Subsystem: \u91c7\u7528\u53cc LSU \u8bbe\u8ba1\u4ee5\u5e94\u5bf9\u4e0d\u540c\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff1a</li> <li>High Bandwidth LSU (HBLSU): \u9488\u5bf9 unit-stride \u8bbf\u95ee\u4f18\u5316\uff0c\u652f\u6301 Memory Interleaving\uff0c\u5141\u8bb8 Load \u548c Store \u64cd\u4f5c\u5e76\u53d1\u6267\u884c\uff0c\u5145\u5206\u5229\u7528\u5185\u5b58\u5e26\u5bbd\u3002</li> <li>High Outstanding LSU (HOLSU): \u5904\u7406 constant-stride \u548c indexed \u7b49\u975e\u8fde\u7eed\u8bbf\u95ee\u6a21\u5f0f\uff0c\u652f\u6301\u5927\u91cf in-flight transactions\uff0c\u5e76\u901a\u8fc7 Memory Delay Slot \u673a\u5236\u9690\u85cf\u957f\u5ef6\u8fdf\u7d22\u5f15\u8bbf\u95ee\u7684\u5f00\u9500\u3002</li> </ul> <p>\u5173\u952e\u6280\u672f\u7279\u6027</p> <ul> <li>\u53ef\u6269\u5c55\u6027: \u901a\u8fc7 Coarse-Grained Floor-Planning Solver \u4f18\u5316\u7269\u7406\u5e03\u5c40\uff0c\u6700\u5c0f\u5316\u8de8 Lane \u8def\u7531\u5ef6\u8fdf\uff0c\u5b9e\u73b0\u4e86 VLEN \u548c DLEN \u7684\u8fd1\u4f3c\u7ebf\u6027\u9762\u79ef\u6269\u5c55\u3002</li> <li>ILP \u4f18\u5316: \u7ed3\u5408 Fine-Grained Chaining\u3001Scalar-Vector OoO Execution\u3001Memory Interleaving \u548c Memory Delay Slot \u7b49\u591a\u79cd\u6280\u672f\uff0c\u5728\u5bbd\u5411\u91cf\u6570\u636e\u8def\u5f84\u4e0a\u6709\u6548\u6316\u6398\u6307\u4ee4\u7ea7\u5e76\u884c\u3002</li> <li>\u80fd\u6548\u4e0e\u9762\u79ef\u6548\u7387: \u91c7\u7528 SRAM-based VRF \u548c Decoupled VRF SRAM Domain\uff0c\u652f\u6301 DVFS \u548c\u6df1\u5ea6\u7761\u7720\u6a21\u5f0f\uff0c\u5728\u4fdd\u6301\u9ad8\u6027\u80fd\u7684\u540c\u65f6\u663e\u8457\u964d\u4f4e\u529f\u8017\u3002</li> </ul> <p>\u7269\u7406\u5b9e\u73b0\u4e0e\u53c2\u6570\u5316</p> <p>T1 \u7684\u8bbe\u8ba1\u53c2\u6570\uff08\u5982 VLEN, DLEN, LaneScale, ChainingSize\uff09\u5747\u53ef\u914d\u7f6e\uff0c\u4ee5\u9002\u5e94\u4e0d\u540c\u5e94\u7528\u573a\u666f\u3002\u5176\u9762\u79ef\u968f\u5173\u952e\u53c2\u6570\u7684\u53d8\u5316\u8868\u73b0\u51fa\u826f\u597d\u7684\u7ebf\u6027\u5173\u7cfb\u3002</p> <p></p> <p>(a) VLEN</p> <p></p> <p>(b) DLEN Figure 4: Linearly Area Scaling of T1 design parameters, evaluated at TSMC N28 SVT technology at $65\\%$ utilization. Four cases are examined: (1) when varying VLEN, DLEN is held at 128, $y$ -asix on the left-hand represents the total area of T1, whereas the right-hand $y$ -axis isolates the area of Lane and Permutation; (2) when varying DLEN, the ratio VLEN/DLEN remains 1; (3) when examining LaneScale, both VLEN and DLEN are set to 1024, $y$ -asix on the left-hand represents the total area of T1, whereas the right-hand $y$ -axis isolates the area of Lane; and (4) when assessing ChainingSize, VLEN and DLEN are maintained at 1024.</p> <p></p> <p>(c) LaneScale</p> <p></p> <p>(d) ChainingSize</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#1-coarse-grained-floor-planning-solver","title":"1. Coarse-Grained Floor-Planning Solver","text":"<p>\u6838\u5fc3\u52a8\u673a\u4e0e\u95ee\u9898\u5b9a\u4e49 - \u5728 Titan-I (T1) \u7684 lane-based \u67b6\u6784\u4e2d\uff0c\u968f\u7740 DLEN\uff08\u6570\u636e\u901a\u8def\u5bbd\u5ea6\uff09\u7684\u6269\u5c55\uff0cinter-lane data movement\uff08\u8de8\u901a\u9053\u6570\u636e\u79fb\u52a8\uff09\u6210\u4e3a\u6027\u80fd\u74f6\u9888\u3002 - \u7279\u522b\u662f widen \u548c narrow \u7b49\u6307\u4ee4\uff0c\u9700\u8981\u5728\u7269\u7406\u4e0a\u4e0d\u76f8\u90bb\u7684 lane \u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u4ea4\u6362\uff08\u5982 </p> <p></p> <p>Figure 2: Static Cross Lane Access For widen and narrow; In this access pattern, the $i$ -th lane accessing the $(2i \\bmod n)$ -th and $(2i + 1 \\bmod n)$ -th lane.</p> <p>\u6240\u793a\uff09\uff0c\u5bfc\u81f4 routing contention\uff08\u5e03\u7ebf\u62e5\u585e\uff09\u548c worst-case routing distance\uff08\u6700\u574f\u60c5\u51b5\u5e03\u7ebf\u8ddd\u79bb\uff09\u589e\u52a0\uff0c\u4ece\u800c\u5f15\u5165\u663e\u8457\u5ef6\u8fdf\u3002 - \u4f20\u7edf\u7684 trivial floorplan\uff08\u6734\u7d20\u5e03\u5c40\uff09\u5c06 lane \u6309\u987a\u5e8f\u6392\u5217\uff0c\u65e0\u6cd5\u4f18\u5316\u8fd9\u4e9b\u7279\u5b9a\u7684\u8de8\u901a\u9053\u8bbf\u95ee\u6a21\u5f0f\u3002</p> <p>\u7b97\u6cd5\u539f\u7406\u4e0e\u5b9e\u73b0\u6d41\u7a0b - Coarse-Grained Floor-Planning Solver \u662f\u4e00\u4e2a\u542f\u53d1\u5f0f\uff08heuristic\uff09\u6c42\u89e3\u5668\uff0c\u65e8\u5728\u4e3a\u7ed9\u5b9a\u6570\u91cf\u7684 lane \u627e\u5230\u4e00\u79cd\u7269\u7406\u5e03\u5c40\uff0c\u4ee5\u6700\u5c0f\u5316\u5173\u952e\u64cd\u4f5c\uff08\u5982 widen/narrow\uff09\u7684\u6700\u5927\u5e03\u7ebf\u5ef6\u8fdf\u3002 - \u5176\u6838\u5fc3\u601d\u60f3\u662f\uff1a\u4f18\u5148\u4fdd\u8bc1\u5177\u6709\u9ad8\u901a\u4fe1\u9700\u6c42\u7684 lane \u5bf9\u5728\u7269\u7406\u4e0a\u5f7c\u6b64\u9760\u8fd1\u3002 - \u7b97\u6cd5\u6d41\u7a0b\u5982\u4e0b\uff1a   - \u8f93\u5165: \u9700\u8981\u5e03\u5c40\u7684 lane \u6570\u91cf <code>n</code>\uff0c\u4ee5\u53ca\u7528\u6237\u5b9a\u4e49\u7684\u7ea6\u675f\uff08\u5982\u82af\u7247\u7684\u957f\u5bbd\u6bd4\uff09\u3002   - \u521d\u59cb\u5316: \u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u5e03\u5c40\u7f51\u683c\u3002   - \u8fed\u4ee3\u653e\u7f6e:     - \u968f\u673a\u9009\u62e9\u4e00\u4e2a\u5c1a\u672a\u653e\u7f6e\u7684 lane\u3002     - \u5982\u679c\u8be5 lane \u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5df2\u7ecf\u653e\u7f6e\u7684\u90bb\u5c45\uff08\u6839\u636e widen/narrow \u7b49\u6307\u4ee4\u7684\u8bbf\u95ee\u6a21\u5f0f\u9884\u5148\u5b9a\u4e49\uff09\uff0c\u5219\u5c06\u5176\u653e\u7f6e\u5728\u80fd\u6700\u5c0f\u5316\u5230\u8fd9\u4e9b\u5df2\u653e\u7f6e\u90bb\u5c45\u7684\u6700\u5927\u66fc\u54c8\u987f\u8ddd\u79bb\uff08x+y distance\uff09\u7684\u4f4d\u7f6e\u3002     - \u5982\u679c\u8be5 lane \u6ca1\u6709\u5df2\u653e\u7f6e\u7684\u90bb\u5c45\uff0c\u5219\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u4e0e\u73b0\u6709\u5e03\u5c40\u76f8\u90bb\u7684\u4f4d\u7f6e\u8fdb\u884c\u653e\u7f6e\u3002   - \u5e76\u884c\u63a2\u7d22: \u8be5\u6c42\u89e3\u5668\u652f\u6301\u5728\u591a\u6838\u6216\u591a\u53f0\u673a\u5668\u4e0a\u5e76\u884c\u8fd0\u884c\uff0c\u4ee5\u9ad8\u6548\u5730\u63a2\u7d22\u5e9e\u5927\u7684\u5e03\u5c40\u641c\u7d22\u7a7a\u95f4\uff08\u56e0\u4e3a\u53ef\u80fd\u7684\u5e03\u5c40\u6570\u91cf\u968f <code>n!</code> \u589e\u957f\uff09\u3002   - \u8f93\u51fa: \u4e00\u4e2a\u4f18\u5316\u540e\u7684 lane \u7269\u7406\u4f4d\u7f6e\u6620\u5c04\u3002</p> <p>\u6027\u80fd\u6536\u76ca\u4e0e\u91cf\u5316\u6307\u6807 - \u8be5\u6c42\u89e3\u5668\u7684\u6548\u679c\u5728 32-lane \u8bbe\u8ba1\u4e2d\u5c24\u4e3a\u663e\u8457\uff1a   - Trivial Floorplan \u7684\u6700\u5927\u8de8\u901a\u9053\u5ef6\u8fdf\u4e3a 7 \u4e2a\u5e03\u7ebf\u5355\u5143\u3002   - Novel Floorplan\uff08\u7531\u6c42\u89e3\u5668\u751f\u6210\uff09\u5c06\u6700\u5927\u5ef6\u8fdf\u6210\u529f\u964d\u4f4e\u81f3 4 \u4e2a\u5e03\u7ebf\u5355\u5143\uff08\u89c1  \u548c </p> <p></p> <p>Figure 2: Static Cross Lane Access For widen and narrow; In this access pattern, the $i$ -th lane accessing the $(2i \\bmod n)$ -th and $(2i + 1 \\bmod n)$ -th lane.</p> <p>\uff09\u3002 - \u8fd9\u79cd\u5e03\u5c40\u4f18\u5316\u76f4\u63a5\u8f6c\u5316\u4e3a\u6027\u80fd\u63d0\u5347\uff1a   - \u5bf9\u4e8e widen \u548c narrow \u64cd\u4f5c\uff0c\u6574\u4f53\u6307\u4ee4\u5ef6\u8fdf\u964d\u4f4e\u4e86\u7ea6 12%\u3002   - \u5728 \u66f4\u5927 DLEN \u7684\u8bbe\u8ba1\u4e2d\uff0c\u6027\u80fd\u5f00\u9500\u7684\u51cf\u5c11\u5e45\u5ea6\u63a5\u8fd1 20%\u3002</p> <p>\u5728 T1 \u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528 - \u8be5\u6c42\u89e3\u5668\u662f T1 \u5b9e\u73b0 DLEN \u548c VLEN \u8fd1\u4f3c\u7ebf\u6027\u53ef\u6269\u5c55\u6027\uff08nearly linear scalability\uff09\u7684\u5173\u952e\u4e00\u73af\uff08\u5982 </p> <p></p> <p>(b) DLEN Figure 4: Linearly Area Scaling of T1 design parameters, evaluated at TSMC N28 SVT technology at $65\\%$ utilization. Four cases are examined: (1) when varying VLEN, DLEN is held at 128, $y$ -asix on the left-hand represents the total area of T1, whereas the right-hand $y$ -axis isolates the area of Lane and Permutation; (2) when varying DLEN, the ratio VLEN/DLEN remains 1; (3) when examining LaneScale, both VLEN and DLEN are set to 1024, $y$ -asix on the left-hand represents the total area of T1, whereas the right-hand $y$ -axis isolates the area of Lane; and (4) when assessing ChainingSize, VLEN and DLEN are maintained at 1024.</p> <p>\u6240\u793a\uff09\u3002 - \u5b83\u901a\u8fc7\u5728\u7269\u7406\u8bbe\u8ba1\u5c42\u9762\u89e3\u51b3\u5e03\u7ebf\u74f6\u9888\uff0c\u4f7f\u5f97 Permutation Unit \u80fd\u591f\u9ad8\u6548\u5730\u5904\u7406\u8de8\u901a\u9053\u6570\u636e\u79fb\u52a8\uff0c\u907f\u514d\u4e86\u56e0\u7269\u7406\u8ddd\u79bb\u8fc7\u8fdc\u800c\u5bfc\u81f4\u7684\u65f6\u5e8f\u8fdd\u4f8b\u6216\u6027\u80fd\u4e0b\u964d\u3002 - \u8fd9\u9879\u6280\u672f\u786e\u4fdd\u4e86 T1 \u5728\u6269\u5c55\u8ba1\u7b97\u5e26\u5bbd\u7684\u540c\u65f6\uff0c\u4e0d\u4f1a\u56e0\u4e92\u8fde\u5ef6\u8fdf\u800c\u62b5\u6d88\u6389\u6027\u80fd\u589e\u76ca\uff0c\u4e3a\u4e0a\u5c42\u7684 fine-grained chaining \u548c memory interleaving \u7b49 ILP \u4f18\u5316\u6280\u672f\u63d0\u4f9b\u4e86\u575a\u5b9e\u7684\u7269\u7406\u57fa\u7840\u3002</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#2-datapath-wide-permutation-unit","title":"2. Datapath-Wide Permutation Unit","text":"<p>\u6838\u5fc3\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u539f\u7406</p> <ul> <li>\u6839\u672c\u76ee\u6807\uff1a\u89e3\u51b3\u5728 lane-based \u67b6\u6784\u4e2d\uff0c\u968f\u7740 DLEN\uff08Datapath Width\uff09\u548c VLEN\uff08Vector Length\uff09\u6269\u5c55\uff0c\u8de8lane\u6570\u636e\u79fb\u52a8\uff08\u5982 <code>VRGATHER</code>, <code>VCOMPRESS</code>, <code>VSLIDE</code> \u7b49 permutation \u6307\u4ee4\uff09\u6240\u5f15\u53d1\u7684\u4e25\u91cd routing contention\uff08\u5e03\u7ebf\u62e5\u585e\uff09\u95ee\u9898\u3002</li> <li>\u6838\u5fc3\u65b9\u6848\uff1a\u5f15\u5165\u4e00\u4e2a\u72ec\u7acb\u7684\u3001datapath-wide\uff08\u5373\u5bbd\u5ea6\u4e3a DLEN\uff09\u7684 Permutation Unit\uff0c\u4f5c\u4e3a\u6240\u6709 lane \u7684\u4e2d\u592e\u4ea4\u6362\u67a2\u7ebd\uff0c\u800c\u975e\u4f9d\u8d56\u4f4e\u6548\u7684 local memory round-tripping\uff08\u5185\u5b58\u5f80\u8fd4\uff09\u6216\u590d\u6742\u7684\u70b9\u5bf9\u70b9\u4e92\u8fde\u3002</li> <li>\u7269\u7406\u5b9e\u73b0\uff1a\u8be5\u5355\u5143\u7684\u6838\u5fc3\u662f\u4e00\u4e2a DLEN-sized crossbar\uff08\u4ea4\u53c9\u5f00\u5173\uff09\uff0c\u80fd\u591f\u5728\u4e00\u4e2a\u5468\u671f\u5185\u5b9e\u73b0\u4efb\u610f\u8f93\u5165\u5230\u4efb\u610f\u8f93\u51fa\u7684\u5168\u8fde\u63a5\u6570\u636e\u91cd\u6392\u3002\u8fd9\u786e\u4fdd\u4e86 permutation \u64cd\u4f5c\u80fd\u4ee5 full bandwidth\uff08\u5168\u5e26\u5bbd\uff09\u6267\u884c\u3002</li> </ul> <p></p> <p>Figure 3: Architecture of T1</p> <ul> <li>\u6307\u4ee4\u5206\u7c7b\u5904\u7406\uff1a</li> <li>\u7eaf\u6570\u636e\u79fb\u52a8\u6307\u4ee4 (Pure Data-Movement Instructions):<ul> <li>\u9759\u6001\u6a21\u5f0f\uff08\u5982 <code>vslideup</code>, <code>vrgather.vv</code> with static indices\uff09\uff1a\u5229\u7528\u5927\u578b crossbar \u8fdb\u884c\u5373\u65f6\u3001\u57fa\u4e8e\u4f4d\u7f6e\u7684 shuffle\u3002</li> <li>\u52a8\u6001\u6a21\u5f0f\uff08\u5982 <code>vrgather.vi</code> with vector indices\uff09\uff1a\u9996\u5148\u4ece\u6240\u6709 lane \u6536\u96c6\u7d22\u5f15\u64cd\u4f5c\u6570\uff0c\u7136\u540e\u53d1\u8d77\u989d\u5916\u7684 VRF\uff08Vector Register File\uff09\u8bbf\u95ee\u8bf7\u6c42\uff0c\u6700\u540e\u5c06\u91cd\u6392\u540e\u7684\u6570\u636e\u5e7f\u64ad\u56de\u5404\u81ea\u7684\u76ee\u7684\u5730 lane\u3002</li> </ul> </li> <li>VL-Sized \u8ba1\u7b97\u6307\u4ee4 (VL-Sized Computational Instructions):<ul> <li>\u5982 <code>vcompress</code> \u6216 <code>vredsum.vs</code>\uff08reduction\uff09\uff1a\u8fd9\u4e9b\u6307\u4ee4\u4e0d\u4ec5\u9700\u8981\u79fb\u52a8\u6570\u636e\uff0c\u8fd8\u9700\u8981\u5728 Permutation Unit \u5185\u90e8\u8fdb\u884c\u903b\u8f91\u8ba1\u7b97\u3002</li> <li>\u4f8b\u5982\uff0c<code>vcompress</code> \u4f1a\u672c\u5730\u8ba1\u7b97 crossbar \u7684\u7d22\u5f15\uff1b\u800c <code>vredsum.vs</code> \u4f1a\u5148\u4ece\u6bcf\u4e2a lane \u7684 ALU \u6536\u96c6\u90e8\u5206\u548c\uff0c\u7136\u540e\u5728 Permutation Unit \u5185\u90e8\u7684\u4e00\u4e2a ELEN-sized ALU \u4e2d\u5b8c\u6210\u6700\u7ec8\u7684\u5f52\u7ea6\uff0c\u5e76\u5c06\u7ed3\u679c\u53d1\u9001\u5230\u7b2c\u4e00\u4e2a lane\u3002</li> </ul> </li> </ul> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u4e0e\u5de5\u4f5c\u6d41\u7a0b</p> <ul> <li>\u8f93\u5165:</li> <li>\u6765\u81ea\u6240\u6709 lane \u7684\u6570\u636e\u7247\u6bb5\uff08\u6bcf\u4e2a lane \u8d21\u732e\u5176\u8d1f\u8d23\u7684 VLEN \u6570\u636e\u5757\u7684\u4e00\u90e8\u5206\uff09\u3002</li> <li>\u5bf9\u4e8e\u52a8\u6001\u6307\u4ee4\uff0c\u8fd8\u9700\u8981\u6765\u81ea lane \u7684 index operands\uff08\u7d22\u5f15\u64cd\u4f5c\u6570\uff09\u3002</li> <li>\u6765\u81ea Sequencer\uff08\u5e8f\u5217\u5668\uff09\u7684 control flit\uff08\u63a7\u5236\u5fae\u7247\uff09\uff0c\u7528\u4e8e\u5206\u914d\u6307\u4ee4\u69fd\u4f4d\u5e76\u540c\u6b65\u64cd\u4f5c\u3002</li> <li>\u8f93\u51fa:</li> <li>\u7ecf\u8fc7\u91cd\u6392\u6216\u8ba1\u7b97\u540e\u7684\u5b8c\u6574 DLEN \u5bbd\u5ea6\u6570\u636e\uff0c\u88ab\u5206\u53d1\u56de\u5404\u4e2a lane \u7684 VRF Write/Read Bus\u3002</li> <li>\u5de5\u4f5c\u6d41\u7a0b:</li> <li>\u8c03\u5ea6\uff1aSequencer \u5c06 permutation \u6307\u4ee4\u7684\u63a7\u5236\u4fe1\u606f\u5206\u53d1\u7ed9 Permutation Unit \u548c\u6240\u6709 lane\u3002</li> <li>\u6570\u636e\u51c6\u5907\uff1a\u5404 lane \u5728\u5b8c\u6210\u672c\u5730\u9884\u5904\u7406\u540e\uff0c\u5c06\u5176\u6570\u636e\u5757\u9001\u5165 Permutation Unit \u7684 incoming queue\uff08\u8f93\u5165\u961f\u5217\uff09\u3002</li> <li>\u6267\u884c\uff1aPermutation Unit \u6839\u636e\u6307\u4ee4\u7c7b\u578b\uff0c\u6267\u884c crossbar \u4ea4\u6362\u6216\u5185\u90e8\u8ba1\u7b97\u3002</li> <li>\u5199\u56de\uff1a\u7ed3\u679c\u6570\u636e\u901a\u8fc7\u4e13\u7528\u901a\u9053\u5e7f\u64ad\u56de\u5404 lane\uff0clane \u53ef\u9009\u62e9\u5728 VRF write-back stage \u7b49\u5f85\u54cd\u5e94\u3002</li> </ul> <p>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u5173\u952e\u4f5c\u7528</p> <ul> <li>\u6d88\u9664\u6027\u80fd\u74f6\u9888\uff1a\u901a\u8fc7\u63d0\u4f9b\u539f\u751f\u7684\u3001\u9ad8\u5e26\u5bbd\u7684 permutation \u652f\u6301\uff0c\u5f7b\u5e95\u6d88\u9664\u4e86\u4f20\u7edf\u8bbe\u8ba1\u4e2d\u56e0\u7f3a\u4e4f\u9ad8\u6548 shuffle \u5355\u5143\u800c\u5bfc\u81f4\u7684\u6027\u80fd\u60ac\u5d16\uff0c\u5c24\u5176\u662f\u5728 widen/narrow\uff08\u7cbe\u5ea6\u8f6c\u6362\uff09\u7b49\u673a\u5668\u5b66\u4e60\u5e38\u89c1\u64cd\u4f5c\u4e2d\u3002</li> <li>\u7ef4\u6301\u7ebf\u6027\u53ef\u6269\u5c55\u6027\uff1a\u4e3a\u4e86\u5e94\u5bf9\u66f4\u5927 DLEN \u5e26\u6765\u7684\u65f6\u5e8f\u6311\u6218\uff0cPermutation Unit \u91c7\u7528\u4e86 \u53ef\u914d\u7f6e\u7684\u6d41\u6c34\u7ebf\u6df1\u5ea6\u3002\u901a\u8fc7\u7528\u9762\u79ef\u6362\u53d6\u65f6\u5e8f\uff0c\u786e\u4fdd\u4e86\u5373\u4f7f\u5728 DLEN \u6269\u5c55\u65f6\uff0c\u6027\u80fd\u589e\u76ca\u4e5f\u80fd\u4fdd\u6301\uff0c\u5b9e\u73b0\u4e86\u8fd1\u4e4e linear area scaling\uff08\u7ebf\u6027\u9762\u79ef\u7f29\u653e\uff09\u3002</li> <li>\u534f\u540c\u4f18\u5316 mask \u64cd\u4f5c\uff1a\u8be5\u5355\u5143\u8fd8\u96c6\u6210\u4e86 Shadow Mask (v0) register cache\uff08\u5f71\u5b50\u63a9\u7801\u5bc4\u5b58\u5668\u7f13\u5b58\uff09\u3002\u8fd9\u4e2a\u7f13\u5b58\u5b58\u50a8\u4e86 <code>v0</code> \u5bc4\u5b58\u5668\u7684\u526f\u672c\uff0c\u4f7f\u5f97\u5728\u6267\u884c predicated\uff08\u8c13\u8bcd\u5316\uff09\u6307\u4ee4\u65f6\uff0clane \u65e0\u9700\u518d\u8fdb\u884c\u6602\u8d35\u7684\u8de8lane\u5e7f\u64ad\u6765\u83b7\u53d6 mask bits\uff0c\u4ece\u800c\u89e3\u51b3\u4e86\u53e6\u4e00\u4e2a\u4e3b\u8981\u7684 wiring bottleneck\u3002</li> </ul> <p></p> <p>Figure 2: Static Cross Lane Access For widen and narrow; In this access pattern, the $i$ -th lane accessing the $(2i \\bmod n)$ -th and $(2i + 1 \\bmod n)$ -th lane.</p> <ul> <li>\u6027\u80fd\u6536\u76ca\uff1a\u8bba\u6587\u6307\u51fa\uff0c\u76f8\u6bd4 naive\uff08\u6734\u7d20\uff09\u7684\u5e03\u5c40\uff0c\u5176 coarse-grained floor-planning solver\uff08\u7c97\u7c92\u5ea6\u5e03\u5c40\u89c4\u5212\u5668\uff09\u4f18\u5316\u4e86 Permutation Unit \u4e0e lane \u7684\u7269\u7406\u4f4d\u7f6e\uff0c\u5c06 widen/narrow \u64cd\u4f5c\u7684\u5ef6\u8fdf\u964d\u4f4e\u4e86\u8fd1 20%\u3002\u540c\u65f6\uff0cShadow Mask \u673a\u5236\u5c06 VRF \u7684\u8bfb\u64cd\u4f5c\u51cf\u5c11\u4e86 4 \u00d7 VLEN/ELEN \u6b21\uff0c\u5e26\u5bbd\u63d0\u5347\u4e86\u7ea6 50%\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#3-shadow-cache-for-mask-register-v0","title":"3. Shadow Cache for Mask Register (v0)","text":"<p>\u95ee\u9898\u80cc\u666f\u4e0e\u6838\u5fc3\u6311\u6218 - \u5728 RISC-V Vector (RVV) \u7684 lane-based \u8bbe\u8ba1\u4e2d\uff0cmask register v0 \u88ab\u5747\u5300\u5730\u5206\u5e03\u5728\u6240\u6709 lane \u4e0a\u3002 - \u5f53\u6267\u884c predicated instructions\uff08\u8c13\u8bcd\u6307\u4ee4\uff09\u65f6\uff0c\u6bcf\u4e2a lane \u9700\u8981\u6839\u636e\u5176\u5904\u7406\u7684\u6570\u636e\u5143\u7d20\u7684 SEW\uff08Selected Element Width\uff09\u6765\u83b7\u53d6\u5bf9\u5e94\u7684 mask bit\u3002 - \u7531\u4e8e v0 \u662f\u4f4d\u7ea7\u8868\u793a\u4e14\u88ab\u5206\u6563\u5b58\u50a8\uff0c\u4e00\u4e2a lane \u4e3a\u83b7\u53d6\u5b8c\u6574\u7684 mask \u4fe1\u606f\uff0c\u5e38\u5e38\u9700\u8981\u4ece\u591a\u4e2a\u5176\u4ed6 lane \u4e2d\u6536\u96c6\u6570\u636e\u3002\u4f8b\u5982\uff0c\u5f53 ELEN = 32 \u65f6\uff0c\u4e00\u4e2a lane \u53ef\u80fd\u9700\u8981\u4ece\u4e09\u4e2a\u4e0d\u540c\u7684 lane \u83b7\u53d6 mask bits\u3002 - \u8fd9\u79cd cross-lane communication\uff08\u8de8\u901a\u9053\u901a\u4fe1\uff09\u5728 ultra-wide\uff08\u8d85\u5bbd\uff09\u8bbe\u8ba1\u4e2d\u4f1a\u5f15\u53d1\u4e25\u91cd\u7684\u5e03\u7ebf\u62e5\u585e\uff08wire congestion\uff09\uff0c\u6210\u4e3a\u6027\u80fd\u74f6\u9888\uff0c\u5e76\u663e\u8457\u589e\u52a0\u5ef6\u8fdf\u3002</p> <p>Shadow Cache for Mask Register (v0) \u7684\u5b9e\u73b0\u539f\u7406 - T1 \u67b6\u6784\u5728\u4e2d\u592e\u7684 Permutation Unit\uff08\u7f6e\u6362\u5355\u5143\uff09\u5185\u7ef4\u62a4\u4e86\u4e00\u4e2a v0 \u7684 shadow copies\uff08\u5f71\u5b50\u526f\u672c\uff09\uff0c\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u4e13\u7528\u4e8e mask register \u7684 register cache\u3002 - \u6240\u6709 lane \u4e0d\u518d\u76f4\u63a5\u76f8\u4e92\u5e7f\u64ad v0 \u7684\u66f4\u65b0\uff0c\u800c\u662f\u901a\u8fc7\u4e00\u4e2a\u4e13\u7528\u7684 Lane-to-Permutation data channel \u5c06\u5bf9 v0 \u7684\u5199\u5165\u64cd\u4f5c\u53d1\u9001\u5230 Permutation Unit\u3002 - Permutation Unit \u8d1f\u8d23\u96c6\u4e2d\u7ba1\u7406\u548c\u66f4\u65b0\u8fd9\u4e2a shadow cache\uff0c\u786e\u4fdd\u5176\u5185\u5bb9\u4e0e\u903b\u8f91\u4e0a\u7684 v0 \u5bc4\u5b58\u5668\u4fdd\u6301\u4e00\u81f4\u3002 - \u4e3a\u4e86\u4fdd\u8bc1\u6b63\u786e\u6027\uff0cSequencer\uff08\u5e8f\u5217\u5668\uff09\u4f1a\u76d1\u63a7\u6240\u6709\u5199\u5165 v0 \u7684\u6307\u4ee4\u3002\u4efb\u4f55\u4f7f\u7528 v0 \u4f5c\u4e3a mask \u7684 predicated instruction \u5fc5\u987b\u7b49\u5f85\u6240\u6709\u524d\u7f6e\u7684 v0 \u5199\u64cd\u4f5c\u5b8c\u6210\u540e\u624d\u80fd\u6267\u884c\uff0c\u4ece\u800c\u89e3\u51b3\u4e86\u6570\u636e\u7ade\u4e89\u95ee\u9898\u3002</p> <p>\u7b97\u6cd5\u6d41\u7a0b\u4e0e\u8f93\u5165\u8f93\u51fa\u5173\u7cfb - \u8f93\u5165:     - \u6765\u81ea\u5404\u4e2a lane \u7684 v0 \u5199\u5165\u6570\u636e\u548c\u63a7\u5236\u4fe1\u53f7\u3002     - \u6765\u81ea Sequencer \u7684\u6307\u4ee4\u6d41\uff0c\u5305\u542b\u5bf9 v0 \u7684\u8bfb/\u5199\u4f9d\u8d56\u4fe1\u606f\u3002 - \u5185\u90e8\u5904\u7406\u6d41\u7a0b:     - Lane \u5b8c\u6210\u5bf9 v0 \u7684\u8ba1\u7b97\u540e\uff0c\u5c06\u7ed3\u679c\u901a\u8fc7 Lane-to-Permutation data channel \u53d1\u9001\u7ed9 Permutation Unit\u3002     - Permutation Unit \u63a5\u6536\u5e76\u66f4\u65b0\u5176\u5185\u90e8\u7684 shadow cache\u3002     - Sequencer \u8ddf\u8e2a\u6307\u4ee4\u95f4\u7684 v0 \u4f9d\u8d56\u5173\u7cfb\uff0c\u786e\u4fdd predicated instructions \u5728 shadow cache \u6570\u636e\u5c31\u7eea\u540e\u624d\u88ab\u5206\u53d1\u5230 lane\u3002 - \u8f93\u51fa:     - \u5f53 lane \u9700\u8981 v0 \u7684 mask \u4fe1\u606f\u65f6\uff0c\u76f4\u63a5\u4ece Permutation Unit \u901a\u8fc7\u73b0\u6709\u7684\u7269\u7406\u901a\u9053\u83b7\u53d6\uff0c\u907f\u514d\u4e86 lane-to-lane \u7684\u76f4\u63a5\u901a\u4fe1\u3002     - lane \u5185\u90e8\u7684 Scoreboard \u4e5f\u5305\u542b\u4e00\u4e2a ELEN-bit local register cache \u7528\u4e8e\u7f13\u5b58\u521a\u4ece Permutation Unit \u83b7\u53d6\u7684 mask\uff0c\u4f9b\u540e\u7eed\u7684 uop \u590d\u7528\uff0c\u8fdb\u4e00\u6b65\u51cf\u5c11\u8bbf\u95ee\u5ef6\u8fdf\u3002</p> <p>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528\u4e0e\u6027\u80fd\u6536\u76ca - \u6d88\u9664\u5e03\u7ebf\u74f6\u9888: \u8be5\u8bbe\u8ba1\u5c06\u539f\u672c\u590d\u6742\u7684\u3001\u591a\u5bf9\u591a\u7684 cross-lane broadcasts \u8f6c\u5316\u4e3a\u7ed3\u6784\u5316\u7684\u3001\u591a\u5bf9\u4e00\uff08lane \u5230 Permutation Unit\uff09\u548c\u4e00\u5bf9\u591a\uff08Permutation Unit \u5230 lane\uff09\u7684\u901a\u4fe1\u6a21\u5f0f\uff0c\u6781\u5927\u5730\u7f13\u89e3\u4e86\u82af\u7247\u5e03\u7ebf\u538b\u529b\u3002 - \u63d0\u5347\u5e26\u5bbd: \u901a\u8fc7\u907f\u514d v0 \u8bbf\u95ee\u5360\u7528 VRF\uff08Vector Register File\uff09\u7684\u8bfb\u7aef\u53e3\uff0c\u4e3a\u6bcf\u4e2a predicated instruction \u8282\u7701\u4e86\u9ad8\u8fbe 4 \u00d7 VLEN/ELEN \u6b21\u7684 VRF read operations\uff0c\u4ece\u800c\u5c06\u6709\u6548\u5e26\u5bbd\u63d0\u5347\u4e86\u7ea6 50%\u3002 - \u964d\u4f4e\u9762\u79ef\u5f00\u9500: \u867d\u7136\u5728 Permutation Unit \u4e2d\u589e\u52a0\u4e86 shadow cache\uff0c\u4f46\u5176\u9762\u79ef\u5f00\u9500\u4ec5\u4e3a 8%\uff0c\u76f8\u6bd4\u5176\u5e26\u6765\u7684\u6027\u80fd\u548c\u5e03\u7ebf\u4f18\u52bf\uff0c\u4ee3\u4ef7\u6781\u5c0f\u3002 - </p> <p></p> <p>(a) VLEN</p> <ul> <li>\u8be5\u673a\u5236\u662f T1 \u80fd\u591f\u5b9e\u73b0 VLEN \u548c DLEN \u8fd1\u4f3c\u7ebf\u6027\u6269\u5c55\uff08nearly linear scalability\uff09\u7684\u5173\u952e\u6280\u672f\u4e4b\u4e00\uff0c\u5982\u4e0a\u56fe (a) \u6240\u793a\uff0c\u5728\u589e\u52a0 VLEN \u65f6\uff0cLane and Permutation \u90e8\u5206\u7684\u9762\u79ef\u589e\u957f\u5f97\u5230\u4e86\u6709\u6548\u63a7\u5236\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#4-fine-grained-chaining-microarchitecture","title":"4. Fine-Grained Chaining Microarchitecture","text":"<p>\u6838\u5fc3\u673a\u5236\u4e0e\u5b9e\u73b0\u539f\u7406</p> <ul> <li>Titan-I (T1) \u7684 Fine-Grained Chaining Microarchitecture \u662f\u4e00\u79cd\u5728 lane datapath granularity\uff08\u5373 ELEN \u00d7 ScaleFactor-bit \u7c92\u5ea6\uff09\u4e0a\u7ba1\u7406\u6570\u636e\u4f9d\u8d56\u5173\u7cfb\u7684\u673a\u5236\uff0c\u65e8\u5728\u6700\u5927\u5316 Vector Register File (VRF) \u5e26\u5bbd\u5229\u7528\u7387\u5e76\u652f\u6301 out-of-order writebacks\u3002</li> <li>\u8be5\u673a\u5236\u7684\u6838\u5fc3\u662f Chaining Scoreboard\uff0c\u5b83\u4e3a\u6bcf\u4e2a ELEN \u00d7 ScaleFactor-bit \u7684\u5b50\u5b57\uff08sub-word\uff09\u7ef4\u62a4\u4e00\u4e2a\u72b6\u6001\u4f4d\uff0c\u8bb0\u5f55\u8be5\u5b50\u5b57\u662f\u5426\u5df2\u88ab\u4e0a\u6e38\u6307\u4ee4\u5199\u5165\u3002</li> <li>\u5f53\u4e00\u6761\u65b0\u7684\u5411\u91cf\u6307\u4ee4\uff08\u5e74\u8f7b\u6307\u4ee4\uff09\u8fdb\u5165\u6267\u884c\u9636\u6bb5\u65f6\uff0c\u5176 Linked-List Scoreboards (SB) \u4f1a\u67e5\u8be2 Chaining Scoreboard\u3002\u53ea\u6709\u5f53\u6240\u6709\u5176\u4f9d\u8d56\u7684\u5b50\u5b57\u90fd\u88ab\u6807\u8bb0\u4e3a\u201c\u5df2\u5199\u5165\u201d\u540e\uff0c\u8be5\u6307\u4ee4\u624d\u80fd\u4ece VRF \u4e2d\u8bfb\u53d6\u6240\u9700\u7684\u64cd\u4f5c\u6570\u5e76\u7ee7\u7eed\u6267\u884c\u3002</li> <li>\u8fd9\u79cd\u8bbe\u8ba1\u5141\u8bb8\u4e0d\u76f8\u4e92\u4f9d\u8d56\u7684\u6307\u4ee4\u6216\u6307\u4ee4\u7684\u4e0d\u540c\u90e8\u5206\uff08\u5143\u7d20\u7ec4\uff09\u4ee5 out-of-order \u7684\u65b9\u5f0f\u5b8c\u6210\u5199\u56de\uff0c\u4ece\u800c\u907f\u514d\u4e86\u4f20\u7edf\u6574\u5bc4\u5b58\u5668\u7c92\u5ea6\u4f9d\u8d56\u68c0\u67e5\u9020\u6210\u7684\u6d41\u6c34\u7ebf\u505c\u987f\u3002</li> </ul> <p>\u5173\u952e\u53c2\u6570\u4e0e\u914d\u7f6e</p> <ul> <li>ELEN (Element Width): \u5b9a\u4e49\u4e86\u67b6\u6784\u652f\u6301\u7684\u6570\u636e\u5143\u7d20\u7684\u57fa\u672c\u5bbd\u5ea6\uff0c\u901a\u5e38\u4e3a 32 \u6216 64 \u4f4d\u3002</li> <li>ScaleFactor: \u8fd9\u662f\u4e00\u4e2a\u53ef\u914d\u7f6e\u7684\u5fae\u67b6\u6784\u53c2\u6570\uff0c\u51b3\u5b9a\u4e86 chaining granularity\u3002<code>ScaleFactor=1</code> \u8868\u793a\u5728 ELEN \u7c92\u5ea6\u8fdb\u884c\u4f9d\u8d56\u8ffd\u8e2a\uff0c\u800c <code>ScaleFactor=2</code> \u6216 <code>4</code> \u5219\u5c06\u7c92\u5ea6\u653e\u5bbd\u5230 <code>2*ELEN</code> \u6216 <code>4*ELEN</code>\u3002</li> <li>ChainingSize: \u6b64\u53c2\u6570\u5b9a\u4e49\u4e86\u6bcf\u4e2a lane \u4e2d\u53ef\u4ee5\u540c\u65f6\u8ddf\u8e2a\u7684 in-flight instructions \u7684\u6700\u5927\u6570\u91cf\u3002\u66f4\u5927\u7684 ChainingSize \u5141\u8bb8\u66f4\u6df1\u7684\u6307\u4ee4\u91cd\u53e0\uff0c\u4f46\u4f1a\u589e\u52a0\u63a7\u5236\u903b\u8f91\u7684\u9762\u79ef\u5f00\u9500\u3002</li> <li>\u5982\u56fe </li> </ul> <p></p> <p>(d) ChainingSize</p> <p>\u6240\u793a\uff0c\u589e\u5927 ChainingSize \u4f1a\u5bfc\u81f4 Lane \u9762\u79ef\u7ebf\u6027\u589e\u957f\u7ea6 30% \u6bcf\u6b65\uff0c\u56e0\u4e3a\u9700\u8981\u66f4\u591a\u7684\u63a7\u5236\u903b\u8f91\u3001VFU \u548c crossbar \u8d44\u6e90\u3002 - \u5982\u56fe </p> <p></p> <p>(c) LaneScale</p> <p>\u6240\u793a\uff0c\u589e\u5927 ScaleFactor\uff08\u5373\u653e\u5bbd\u7c92\u5ea6\uff09\u53cd\u800c\u80fd\u51cf\u5c11\u603b\u9762\u79ef\uff08\u5206\u522b\u51cf\u5c11 26% \u548c 38%\uff09\uff0c\u56e0\u4e3a\u591a\u4e2a\u5143\u7d20\u53ef\u4ee5\u5171\u4eab\u4e00\u5957\u63a7\u5236\u903b\u8f91\uff0c\u4f46\u4f1a\u727a\u7272\u4e00\u5b9a\u7684\u67b6\u6784\u6548\u7387\u548c\u589e\u52a0\u7269\u7406\u8bbe\u8ba1\u590d\u6742\u5ea6\u3002</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u4e0e\u7cfb\u7edf\u4f5c\u7528</p> <ul> <li>\u8f93\u5165: \u8be5\u673a\u5236\u7684\u8f93\u5165\u662f\u6765\u81ea Sequencer \u5206\u53d1\u7684\u5411\u91cf micro-operations (uops)\uff0c\u4ee5\u53ca\u4e0a\u6e38\u6307\u4ee4\u5199\u56de VRF \u7684\u6570\u636e\u548c\u5b8c\u6210\u4fe1\u53f7\u3002</li> <li>\u8f93\u51fa: \u8f93\u51fa\u662f\u89e3\u9664\u4e86\u4f9d\u8d56\u963b\u585e\u7684 uops\uff0c\u5b83\u4eec\u53ef\u4ee5\u88ab Operand Synchronization (RF) \u9636\u6bb5\u83b7\u53d6\u64cd\u4f5c\u6570\uff0c\u5e76\u9001\u5165 VFU Execute (EX) \u9636\u6bb5\u6267\u884c\u3002\u6700\u7ec8\u7ed3\u679c\u901a\u8fc7 In-Lane Commitment (CM) \u9636\u6bb5\u5199\u56de VRF\u3002</li> <li>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528:<ul> <li>\u63d0\u5347 ILP: \u901a\u8fc7\u7ec6\u7c92\u5ea6\u7684\u4f9d\u8d56\u7ba1\u7406\uff0c\u663e\u8457\u63d0\u5347\u4e86\u5411\u91cf\u6307\u4ee4\u95f4\u7684 Instruction-Level Parallelism (ILP)\u3002\u5982\u8868 </li> </ul> </li> </ul> <p></p> <p>Figure 3: Architecture of T1</p> <p>\u4e2d\u7684 PACK \u6d4b\u8bd5\u6240\u793a\uff0c\u7981\u7528 chaining \u4f1a\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d 61%\u3002     - \u4f18\u5316 VRF \u5e26\u5bbd: \u5141\u8bb8 out-of-order writebacks\uff0c\u4f7f\u5f97 VRF \u7684\u591a bank \u7ed3\u6784\u80fd\u591f\u88ab\u66f4\u5145\u5206\u5730\u5229\u7528\uff0c\u907f\u514d\u4e86\u56e0\u7b49\u5f85\u6574\u6761\u6307\u4ee4\u5b8c\u6210\u800c\u5bfc\u81f4\u7684\u5e26\u5bbd\u6d6a\u8d39\u3002     - \u652f\u6301\u7075\u6d3b\u8c03\u5ea6: \u4e0e Memory Interleaving \u548c Memory Delay Slot \u7b49\u6280\u672f\u534f\u540c\u5de5\u4f5c\uff0c\u5171\u540c\u6784\u6210\u4e86 T1 \u9ad8\u6548\u7684 OoO \u5411\u91cf\u8c03\u5ea6\u4f53\u7cfb\u3002</p> <p>\u6027\u80fd\u5f71\u54cd\u4e0e\u6743\u8861</p> \u914d\u7f6e\u53d8\u5316 \u5bf9 Lane \u9762\u79ef\u7684\u5f71\u54cd \u5bf9\u603b T1 \u9762\u79ef\u7684\u5f71\u54cd \u4e3b\u8981\u4f18\u52bf \u4e3b\u8981\u52a3\u52bf ScaleFactor \u4ece 1 \u589e\u81f3 2 +48% -26% \u51cf\u5c11\u63a7\u5236\u903b\u8f91\u5f00\u9500\uff0c\u8282\u7701\u603b\u9762\u79ef \u67b6\u6784\u6548\u7387\u964d\u4f4e\uff0c\u7269\u7406\u8bbe\u8ba1\u66f4\u590d\u6742 ScaleFactor \u4ece 1 \u589e\u81f3 4 +115% -38% \u8fdb\u4e00\u6b65\u8282\u7701\u603b\u9762\u79ef \u67b6\u6784\u6548\u7387\u8fdb\u4e00\u6b65\u964d\u4f4e ChainingSize \u589e\u52a0\u4e00\u7ea7 +30% +30% \u652f\u6301\u66f4\u591a in-flight \u6307\u4ee4\uff0c\u63d0\u5347 ILP \u663e\u8457\u589e\u52a0\u9762\u79ef\u5f00\u9500 <ul> <li>\u5e94\u7528\u573a\u666f\u9002\u914d: \u8bba\u6587\u5efa\u8bae\u6839\u636e workload \u7279\u6027\u8c03\u6574 ChainingSize\u3002\u5bf9\u4e8e cryptographic workloads\uff08\u5982 NTT, MMM\uff09\uff0c\u7531\u4e8e permutation \u6307\u4ee4\u9700\u8981\u663e\u5f0f\u9000\u4f11\u4e14\u8bbf\u5b58\u8f83\u5c11\uff0c\u5e94\u91c7\u7528\u8f83\u5c0f\u7684 ChainingSize \u4ee5\u8282\u7701\u9762\u79ef\u3002\u800c\u5bf9\u4e8e HPC applications\uff08\u5982 SGEMM\uff09\uff0c\u5219\u53ef\u4ee5\u589e\u5927 ChainingSize \u4ee5\u5145\u5206\u5229\u7528\u5176\u4e30\u5bcc\u7684 ILP\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#5-issue-as-commit-for-scalar-vector-ooo-execution","title":"5. Issue-as-Commit for Scalar-Vector OoO Execution","text":"<p>Issue-as-Commit \u673a\u5236\u7684\u6838\u5fc3\u539f\u7406</p> <p>Titan-I (T1) \u67b6\u6784\u4e3a\u4e86\u89e3\u51b3\u4f20\u7edf\u8bbe\u8ba1\u4e2d scalar pipeline \u548c vector pipeline \u76f8\u4e92\u963b\u585e\u7684\u95ee\u9898\uff0c\u63d0\u51fa\u4e86\u4e00\u79cd\u540d\u4e3a \u201cissue-as-commit\u201d \u7684\u521b\u65b0\u7b56\u7565\u3002\u8be5\u7b56\u7565\u7684\u6838\u5fc3\u601d\u60f3\u662f\uff1a\u5bf9\u4e8e\u7edd\u5927\u591a\u6570\u4e0d\u76f4\u63a5\u5f71\u54cd\u6807\u91cf\u72b6\u6001\u7684\u5411\u91cf\u6307\u4ee4\uff0c\u4e00\u65e6\u5b83\u4eec\u88ab\u5206\u53d1\uff08issued\uff09\u5230\u5411\u91cf\u6267\u884c\u5355\u5143\uff0c\u5c31\u7acb\u5373\u5728\u6807\u91cf\u6838\u5fc3\u4e2d\u88ab\u89c6\u4e3a\u5df2\u63d0\u4ea4\uff08committed\uff09\uff0c\u4ece\u800c\u91ca\u653e\u540e\u7eed\u72ec\u7acb\u7684\u6807\u91cf\u6307\u4ee4\u7ee7\u7eed\u6267\u884c\u3002</p> <ul> <li>\u8be5\u673a\u5236\u901a\u8fc7\u4e00\u7ec4\u4f4d\u4e8e\u6807\u91cf\u6838\u5fc3\u4e2d\u7684 compact vector scoreboards\uff08\u7d27\u51d1\u578b\u5411\u91cf\u8bb0\u5206\u677f\uff09\u6765\u5b9e\u73b0\u3002</li> <li>\u8fd9\u4e9b\u8bb0\u5206\u677f\u8d1f\u8d23\u8ffd\u8e2a\u5df2\u53d1\u51fa\u4f46\u5c1a\u672a\u5728\u5411\u91cf\u5355\u5143\u4e2d\u5b8c\u5168\u5b8c\u6210\u7684\u5411\u91cf\u6307\u4ee4\u7684\u72b6\u6001\uff0c\u7279\u522b\u662f\u5b83\u4eec\u662f\u5426\u4f1a\u5199\u5165\u6807\u91cf\u5bc4\u5b58\u5668\u6216 CSR\uff08Control and Status Registers\uff09\u3002</li> <li>\u53ea\u8981\u540e\u7eed\u7684\u6807\u91cf\u6307\u4ee4\u4e0e\u8fd9\u4e9b\u201c\u5df2\u53d1\u51fa\u4f46\u672a\u5b8c\u6210\u201d\u7684\u5411\u91cf\u6307\u4ee4\u4e4b\u95f4\u4e0d\u5b58\u5728\u6570\u636e\u4f9d\u8d56\uff08\u5373\u4e0d\u8bfb\u53d6\u53ef\u80fd\u88ab\u5411\u91cf\u6307\u4ee4\u4fee\u6539\u7684\u6807\u91cf\u5bc4\u5b58\u5668\u6216 CSR\uff09\uff0c\u6807\u91cf\u6838\u5fc3\u5c31\u53ef\u4ee5\u65e0\u5ef6\u8fdf\u5730\u7ee7\u7eed\u5176 OoO\uff08Out-of-Order\uff09\u6267\u884c\u6d41\u7a0b\u3002</li> </ul> <p></p> <p>Figure 6: Different ILP Technology in T1. Chaining interleaves V0, V1, and V2. Memory Interleaving mitigates the VSW-VLD dependency. Vector-Scalar OoO interleaves the vector and scalar pipelines until a true dependency v16-s64-v15 occurs. Memory Delay Slot parallelizes vector index load/store (VIDX0) with independent vector executions (VEX0).</p> <p>\u6307\u4ee4\u5206\u7c7b\u4e0e\u5904\u7406\u6d41\u7a0b</p> <p>T1 \u5c06\u5411\u91cf\u6307\u4ee4\u6839\u636e\u5176\u5bf9\u7cfb\u7edf\u72b6\u6001\u7684\u6f5c\u5728\u5f71\u54cd\u5206\u4e3a\u4e09\u7c7b\uff0c\u5e76\u91c7\u7528\u4e0d\u540c\u7684\u5904\u7406\u7b56\u7565\uff1a</p> <ul> <li>\u7b2c\u4e00\u7c7b\uff08\u6700\u5e38\u89c1\uff09\uff1a\u6307\u4ee4\u6548\u679c\u5b8c\u5168\u5c40\u9650\u4e8e\u5411\u91cf\u5355\u5143\u5185\u90e8\uff0c\u65e2\u4e0d\u4fee\u6539\u4efb\u4f55\u6807\u91cf\u5bc4\u5b58\u5668\uff0c\u4e5f\u4e0d\u4fee\u6539 CSR\u3002</li> <li>\u5bf9\u4e8e\u6b64\u7c7b\u6307\u4ee4\uff0c\u201cissue\u201d \u64cd\u4f5c\u672c\u8eab\u5c31\u7b49\u540c\u4e8e \u201ccommit\u201d\u3002</li> <li>\u6807\u91cf\u6838\u5fc3\u65e0\u9700\u4e3a\u5176\u5206\u914d\u989d\u5916\u7684\u8bb0\u5206\u677f\u6761\u76ee\uff0c\u540e\u7eed\u6240\u6709\u6807\u91cf\u6307\u4ee4\u5747\u53ef\u81ea\u7531\u53d1\u5c04\uff0c\u5b9e\u73b0\u4e86\u6700\u5927\u7a0b\u5ea6\u7684\u5e76\u884c\u3002</li> <li>\u7b2c\u4e8c\u7c7b\uff1a\u6307\u4ee4\u53ef\u80fd\u4f1a\u5199\u5165\u6807\u91cf\u5bc4\u5b58\u5668\u6216 CSR\uff08\u4f8b\u5982\uff0c\u67d0\u4e9b\u6d6e\u70b9\u8fd0\u7b97\u53ef\u80fd\u8bbe\u7f6e\u5f02\u5e38\u6807\u5fd7\u4f4d\uff09\u3002</li> <li>\u6807\u91cf\u6838\u5fc3\u4f1a\u4e3a\u6b64\u7c7b\u6307\u4ee4\u5728\u8bb0\u5206\u677f\u4e2d\u5206\u914d\u4e00\u4e2a\u4e13\u7528\u6761\u76ee\u3002</li> <li>\u4ec5\u5f53\u540e\u7eed\u6807\u91cf\u6307\u4ee4\u8bd5\u56fe\u8bbf\u95ee\u88ab\u8be5\u5411\u91cf\u6307\u4ee4\u5f71\u54cd\u7684\u7279\u5b9a\u6807\u91cf\u5bc4\u5b58\u5668\u6216 CSR \u65f6\uff0c\u624d\u4f1a\u53d1\u751f\u963b\u585e\uff1b\u5176\u4ed6\u65e0\u5173\u7684\u6807\u91cf\u6307\u4ee4\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u3002</li> <li>\u7b2c\u4e09\u7c7b\uff1a\u6307\u4ee4\u53ef\u80fd\u5f15\u53d1\u5f02\u5e38\uff08\u5982\u975e\u6cd5\u6307\u4ee4\u3001\u5185\u5b58\u8bbf\u95ee\u9519\u8bef\uff09\u3002</li> <li>Illegal instructions\uff1a\u5728\u6807\u91cf\u89e3\u7801\u9636\u6bb5\u5373\u53ef\u68c0\u6d4b\u5e76\u5904\u7406\uff0c\u4e0d\u5f71\u54cd\u6b64\u673a\u5236\u3002</li> <li>Unit-stride / Constant-stride loads/stores\uff1a\u5176\u5f02\u5e38\u6761\u4ef6\uff08\u5982\u5730\u5740\u8d8a\u754c\uff09\u4ec5\u4f9d\u8d56\u4e8e\u6807\u91cf\u6e90\u64cd\u4f5c\u6570\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u6807\u91cf LSU \u4e2d\u63d0\u524d\u68c0\u67e5\uff0c\u65e0\u9700\u7b49\u5f85\u5411\u91cf\u5355\u5143\u5b8c\u6210\u3002</li> <li>Indexed accesses\uff1a\u7531\u4e8e\u5176\u76ee\u6807\u5730\u5740\u662f\u5728\u5411\u91cf\u5355\u5143\u5185\u52a8\u6001\u8ba1\u7b97\u5f97\u51fa\u7684\uff0c\u786c\u4ef6\u65e0\u6cd5\u63d0\u524d\u9884\u77e5\u662f\u5426\u4f1a\u53d1\u751f\u5f02\u5e38\u3002\u4e3a\u4fdd\u8bc1\u7cbe\u786e\u5f02\u5e38\u6a21\u578b\uff0cT1 \u9ed8\u8ba4\u4f1a\u963b\u585e\u6240\u6709\u540e\u7eed\u6307\u4ee4\uff0c\u76f4\u5230\u8be5 indexed \u6307\u4ee4\u5b8c\u6210\u3002<ul> <li>\u4e3a\u4f18\u5316\u6027\u80fd\uff0cT1 \u63d0\u4f9b\u4e86\u4e00\u4e2a \"chicken bit\"\uff08\u4e00\u79cd\u8f6f\u4ef6\u53ef\u63a7\u7684 CSR \u4f4d\uff09\u3002\u5f53\u8f6f\u4ef6\u80fd\u786e\u4fdd indexed \u64cd\u4f5c\u4e0d\u4f1a\u51fa\u9519\u65f6\uff0c\u53ef\u8bbe\u7f6e\u6b64\u4f4d\uff0c\u4ece\u800c\u5141\u8bb8\u540e\u7eed\u65e0\u5173\u6307\u4ee4\u8fdb\u884c chaining\uff08\u94fe\u63a5\u6267\u884c\uff09\uff0c\u6709\u6548\u9690\u85cf\u957f\u5ef6\u8fdf\u3002</li> </ul> </li> </ul> <p>\u5728\u6574\u4f53\u67b6\u6784\u4e2d\u7684\u4f5c\u7528\u4e0e\u6548\u76ca</p> <p>\u8be5\u673a\u5236\u662f T1 \u5b9e\u73b0\u9ad8\u6548 Scalar-Vector OoO Execution \u7684\u5173\u952e\uff0c\u5176\u4e3b\u8981\u4f5c\u7528\u548c\u6548\u76ca\u4f53\u73b0\u5728\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u6700\u5927\u5316\u529f\u80fd\u5355\u5143\u5229\u7528\u7387\uff1a\u901a\u8fc7\u89e3\u9664\u4e0d\u5fc5\u8981\u7684\u8026\u5408\uff0c\u786e\u4fdd\u6807\u91cf\u548c\u5411\u91cf\u7684\u529f\u80fd\u5355\u5143\u90fd\u80fd\u4fdd\u6301\u9ad8\u5360\u7528\u7387\uff0c\u907f\u514d\u4e86\u56e0\u4e00\u65b9\u7e41\u5fd9\u800c\u5bfc\u81f4\u53e6\u4e00\u65b9\u7a7a\u95f2\u7684\u8d44\u6e90\u6d6a\u8d39\u3002</li> <li>\u964d\u4f4e\u63a7\u5236\u5f00\u9500\uff1a\u76f8\u6bd4\u4e8e\u4f20\u7edf\u7684 Tomasulo \u7b97\u6cd5\u6216\u5927\u578b ROB\uff08Reorder Buffer\uff09\uff0c\u8fd9\u79cd\u57fa\u4e8e\u5206\u7c7b\u548c\u7d27\u51d1\u8bb0\u5206\u677f\u7684\u8bbe\u8ba1\u663e\u8457\u964d\u4f4e\u4e86\u786c\u4ef6\u590d\u6742\u5ea6\u548c\u9762\u79ef\u5f00\u9500\u3002\u6587\u4e2d\u63d0\u5230\uff0c\u8be5\u673a\u5236\u4ec5\u7ed9\u6807\u91cf\u6838\u5fc3\u589e\u52a0\u4e86\u7ea6 3% \u7684\u9762\u79ef\u3002</li> <li>\u63d0\u5347\u7aef\u5230\u7aef\u541e\u5410\u91cf\uff1a\u5728\u5178\u578b\u7684\u6df7\u5408\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0c\u6807\u91cf\u4ee3\u7801\uff08\u5982\u5faa\u73af\u63a7\u5236\u3001\u5730\u5740\u8ba1\u7b97\uff09\u548c\u5411\u91cf\u4ee3\u7801\uff08\u5982\u6570\u636e\u5e76\u884c\u8ba1\u7b97\uff09\u53ef\u4ee5\u9ad8\u5ea6\u91cd\u53e0\u6267\u884c\uff0c\u4ece\u800c\u5927\u5e45\u7f29\u77ed\u7a0b\u5e8f\u7684\u6574\u4f53\u6267\u884c\u65f6\u95f4\u3002</li> </ul> <p>\u5185\u5b58\u6392\u5e8f\u4e0e\u4e2d\u65ad\u5904\u7406</p> <p>\u4e3a\u4e86\u4fdd\u8bc1\u5185\u5b58\u4e00\u81f4\u6027\u548c\u7cfb\u7edf\u6b63\u786e\u6027\uff0c\u8be5\u673a\u5236\u8fd8\u5b9a\u4e49\u4e86\u4e25\u683c\u7684\u5185\u5b58\u6392\u5e8f\u548c\u4e2d\u65ad\u5904\u7406\u89c4\u5219\uff1a</p> <ul> <li>\u5185\u5b58\u6392\u5e8f\uff1a</li> <li>\u5bf9\u4e8e unit-stride \u548c constant-stride \u5411\u91cf\u8bbf\u5b58\uff0c\u6807\u91cf LSU \u4f1a\u901a\u8fc7\u8bb0\u5206\u677f\u9884\u7559\u5176\u5730\u5740\u8303\u56f4\uff0c\u963b\u6b62\u6709\u51b2\u7a81\u7684\u5e74\u8f7b\u6807\u91cf\u8bbf\u5b58\u6307\u4ee4\u53d1\u5c04\uff0c\u4f46\u5141\u8bb8\u65e0\u51b2\u7a81\u7684\u8bbf\u5b58\u5e76\u884c\u6267\u884c\u3002</li> <li>\u5bf9\u4e8e indexed \u5411\u91cf\u8bbf\u5b58\uff0c\u7531\u4e8e\u5730\u5740\u672a\u77e5\uff0c\u6807\u91cf LSU \u4f1a\u4fdd\u5b88\u5730\u963b\u585e\u6240\u6709\u540e\u7eed\u6807\u91cf\u8bbf\u5b58\u6307\u4ee4\uff0c\u76f4\u5230\u8be5 indexed \u64cd\u4f5c\u5b8c\u6210\u3002</li> <li>\u4e2d\u65ad\u5904\u7406\uff1a</li> <li>\u5f53\u4e2d\u65ad\u4fe1\u53f7\u5230\u8fbe\u63d0\u4ea4\u9636\u6bb5\u65f6\uff0c\u786c\u4ef6\u4f1a\u6682\u505c\u65b0\u6307\u4ee4\u7684\u53d1\u5c04\u3002</li> <li>\u4e2d\u65ad\u7684\u5b9e\u9645\u5904\u7406\u4f1a\u88ab\u63a8\u8fdf\uff0c\u76f4\u5230\u5411\u91cf\u5355\u5143\u5b8c\u5168\u7a7a\u95f2\u3002\u8fd9\u5bf9\u4e8e\u4f5c\u4e3a\u534f\u5904\u7406\u5668\u7684 T1 \u6765\u8bf4\u662f\u53ef\u63a5\u53d7\u7684\uff0c\u56e0\u4e3a\u5b83\u53ea\u63a5\u6536\u6765\u81ea\u4e3b\u673a\u5904\u7406\u5668\u7684\u4e2d\u65ad\u3002</li> </ul>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#6-dual-lsu-with-memory-interleaving-and-delay-slots","title":"6. Dual LSU with Memory Interleaving and Delay Slots","text":"<p>Dual LSU \u67b6\u6784\u6982\u89c8</p> <p>Titan-I (T1) \u91c7\u7528\u4e86\u4e00\u79cd\u521b\u65b0\u7684 Dual LSU (\u53cc\u52a0\u8f7d\u5b58\u50a8\u5355\u5143) \u8bbe\u8ba1\uff0c\u65e8\u5728\u9ad8\u6548\u5904\u7406 RISC-V Vector (RVV) \u89c4\u8303\u4e2d\u591a\u6837\u5316\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u3002\u8be5\u8bbe\u8ba1\u5c06\u5185\u5b58\u5b50\u7cfb\u7edf\u89e3\u8026\u4e3a\u4e24\u4e2a\u9ad8\u5ea6\u4e13\u4e1a\u5316\u7684\u5355\u5143\uff0c\u5206\u522b\u9488\u5bf9\u4e0d\u540c\u7684\u8bbf\u95ee\u7279\u6027\u8fdb\u884c\u4f18\u5316\u3002</p> <ul> <li>High Bandwidth LSU (HBLSU): \u4e13\u4e3a unit-stride (\u5355\u4f4d\u6b65\u957f) \u8bbf\u95ee\u6a21\u5f0f\u8bbe\u8ba1\uff0c\u5176\u6838\u5fc3\u76ee\u6807\u662f\u6700\u5927\u5316\u5e26\u5bbd\u5229\u7528\u7387\u3002</li> <li>High Outstanding LSU (HOLSU): \u4e13\u4e3a constant-stride (\u56fa\u5b9a\u6b65\u957f) \u548c indexed (\u7d22\u5f15) \u7b49\u975e\u8fde\u7eed\u3001\u4e0d\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u8bbe\u8ba1\uff0c\u5176\u6838\u5fc3\u76ee\u6807\u662f\u901a\u8fc7\u9ad8\u5e76\u53d1\u6765\u5bb9\u5fcd\u5e76\u9690\u85cf\u6781\u9ad8\u7684\u5185\u5b58\u5ef6\u8fdf\u3002</li> </ul> <p>\u8fd9\u79cd\u5206\u5de5\u660e\u786e\u7684\u8bbe\u8ba1\u907f\u514d\u4e86\u5355\u4e00 LSU \u5728\u5904\u7406\u6240\u6709\u6a21\u5f0f\u65f6\u7684\u6027\u80fd\u59a5\u534f\uff0c\u786e\u4fdd\u4e86\u5728\u5404\u79cd\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\u90fd\u80fd\u5b9e\u73b0\u9ad8\u6548\u7684\u5185\u5b58\u5b50\u7cfb\u7edf\u6027\u80fd\u3002</p> <p></p> <p>Figure 3: Architecture of T1</p> <p>HBLSU \u4e0e Memory Interleaving \u673a\u5236</p> <p>HBLSU \u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e Memory Interleaving (\u5185\u5b58\u4ea4\u9519) \u6280\u672f\uff0c\u5b83\u89e3\u51b3\u4e86\u4f20\u7edf\u5411\u91cf\u5904\u7406\u5668\u4e2d\u52a0\u8f7d\u548c\u5b58\u50a8\u64cd\u4f5c\u5fc5\u987b\u4e32\u884c\u6267\u884c\u7684\u95ee\u9898\u3002</p> <ul> <li>\u5b9e\u73b0\u539f\u7406: HBLSU \u5185\u90e8\u5b9e\u73b0\u4e86\u8bf7\u6c42\u4e0e\u54cd\u5e94\u7684\u89e3\u8026\uff0c\u5e76\u5f15\u5165\u4e86\u4e00\u4e2a Conflict Region Table (CRT, \u51b2\u7a81\u533a\u57df\u8868) \u6765\u52a8\u6001\u8ddf\u8e2a\u5185\u5b58\u8bbf\u95ee\u51b2\u7a81\u3002<ul> <li>\u5f53\u4e00\u6761\u52a0\u8f7d\u6216\u5b58\u50a8\u6307\u4ee4\u8fdb\u5165 HBLSU \u65f6\uff0c\u5176\u5730\u5740\u751f\u6210\u903b\u8f91\u4f1a\u521d\u59cb\u5316 CRT\uff0c\u6807\u8bb0\u51fa\u8be5\u6307\u4ee4\u5c06\u8981\u8bbf\u95ee\u7684\u5185\u5b58\u533a\u57df\u3002</li> <li>\u540e\u7eed\u7684\u5185\u5b58\u6307\u4ee4\u5728\u53d1\u5c04\u524d\u4f1a\u67e5\u8be2 CRT\u3002\u5982\u679c\u5176\u76ee\u6807\u5185\u5b58\u533a\u57df\u4e0e CRT \u4e2d\u5df2\u6709\u7684\u533a\u57df\u4e0d\u51b2\u7a81\uff0c\u5219\u53ef\u4ee5\u7acb\u5373\u88ab\u53d1\u5c04\u5230\u603b\u7ebf\u63a5\u53e3\u5355\u5143 (BIU)\uff0c\u5373\u4f7f\u524d\u4e00\u6761\u6307\u4ee4\u5c1a\u672a\u5b8c\u6210\u3002</li> <li>\u8fd9\u4f7f\u5f97 load \u548c store \u64cd\u4f5c\u80fd\u591f\u771f\u6b63\u5730\u5e76\u53d1\u6267\u884c\uff0c\u540c\u65f6\u5229\u7528\u72ec\u7acb\u7684\u8bfb\u5199\u901a\u9053\u3002</li> </ul> </li> <li>\u7b97\u6cd5\u6d41\u7a0b:<ol> <li>\u6307\u4ee4\u8fdb\u5165 HBLSU\uff0c\u751f\u6210\u7269\u7406\u5730\u5740\u8303\u56f4\u3002</li> <li>\u67e5\u8be2 CRT\uff0c\u68c0\u67e5\u662f\u5426\u5b58\u5728\u5730\u5740\u51b2\u7a81\u3002</li> <li>\u82e5\u65e0\u51b2\u7a81\uff0c\u5219\u66f4\u65b0 CRT \u5e76\u5c06\u8bf7\u6c42\u53d1\u9001\u81f3 BIU\uff1b\u82e5\u6709\u51b2\u7a81\uff0c\u5219\u7b49\u5f85\u3002</li> <li>\u5f53 BIU \u5b8c\u6210\u4e00\u7b14\u4e8b\u52a1\u540e\uff0cCRT \u4e2d\u5bf9\u5e94\u7684\u51b2\u7a81\u533a\u57df\u88ab\u91ca\u653e\u3002</li> </ol> </li> <li>\u53c2\u6570\u4e0e\u89c4\u683c: HBLSU \u91c7\u7528 DLEN-wide (\u4e0e\u6570\u636e\u901a\u8def\u540c\u5bbd) \u7684\u6570\u636e\u8def\u5f84\uff0c\u4ee5\u5339\u914d\u8ba1\u7b97\u5355\u5143\u7684\u541e\u5410\u80fd\u529b\u3002\u4f8b\u5982\uff0c\u5728 DLEN=512 \u7684\u914d\u7f6e\u4e0b\uff0c\u5176\u7406\u8bba\u5cf0\u503c\u5e26\u5bbd\u53ef\u8fbe 512 bits/cycle\u3002</li> <li>\u6027\u80fd\u5f71\u54cd: \u5982 Table 1 \u6240\u793a\uff0c\u5728 QUANT \u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0c\u542f\u7528 Memory Interleaving \u76f8\u6bd4\u7981\u7528\u53ef\u5e26\u6765 32% \u7684\u6027\u80fd\u63d0\u5347\uff0c\u663e\u8457\u63d0\u9ad8\u4e86\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u3002</li> </ul> \u914d\u7f6e Cycles Slow Down Standard T1 14817 - Disable Chaining 23862 61% Disable Memory Interleaving 19514 32% <p>HOLSU \u4e0e Memory Delay Slot \u673a\u5236</p> <p>HOLSU \u7684\u6838\u5fc3\u521b\u65b0\u5728\u4e8e Memory Delay Slot (\u5185\u5b58\u5ef6\u8fdf\u69fd) \u673a\u5236\uff0c\u7528\u4e8e\u5e94\u5bf9 indexed \u8bbf\u95ee\u53ef\u80fd\u4ea7\u751f\u7684\u957f\u8fbe\u6570\u4e07\u5468\u671f\u7684\u5ef6\u8fdf\u3002</p> <ul> <li>\u5b9e\u73b0\u539f\u7406: HOLSU \u91c7\u7528 ELEN-wide (\u5143\u7d20\u5bbd\u5ea6) \u7684\u7a84\u6570\u636e\u8def\u5f84\uff0c\u4f46\u652f\u6301\u6781\u9ad8\u7684 in-flight transactions (\u98de\u884c\u4e2d\u4e8b\u52a1) \u6570\u91cf\u3002\u5176\u5173\u952e\u5728\u4e8e\u4e0e\u6807\u91cf\u6838\u7684\u534f\u540c\u8c03\u5ea6\u3002<ul> <li>\u5f53\u4e00\u6761 indexed load/store \u6307\u4ee4\u88ab\u53d1\u5c04\u540e\uff0c\u5b83\u4f1a\u5360\u7528 HOLSU \u7684\u8d44\u6e90\u5e76\u5f00\u59cb\u5904\u7406\u5927\u91cf\u6f5c\u5728\u7684\u4e0d\u89c4\u5219\u5185\u5b58\u8bf7\u6c42\u3002</li> <li>\u4e3a\u4e86\u9632\u6b62\u8fd9\u6761\u957f\u5ef6\u8fdf\u6307\u4ee4\u963b\u585e\u6574\u4e2a\u6d41\u6c34\u7ebf\uff0cT1 \u5f15\u5165\u4e86\u4e00\u4e2a CSR \"chicken bit\"\u3002\u5f53\u8f6f\u4ef6\u8bbe\u7f6e\u6b64\u4f4d\uff08\u8868\u660e\u80fd\u4fdd\u8bc1\u8bbf\u95ee\u5b89\u5168\uff0c\u65e0\u9700\u7cbe\u786e\u5f02\u5e38\uff09\u65f6\uff0c\u540e\u7eed\u4e0d\u4f9d\u8d56\u4e8e\u8be5 indexed \u6307\u4ee4\u7ed3\u679c\u7684\u6307\u4ee4\uff08\u5305\u62ec\u5176\u4ed6\u5411\u91cf\u6307\u4ee4\u548c\u5927\u90e8\u5206\u6807\u91cf\u6307\u4ee4\uff09\u53ef\u4ee5\u7ee7\u7eed\u53d1\u5c04\u548c\u6267\u884c\u3002</li> <li>\u8fd9\u672c\u8d28\u4e0a\u521b\u5efa\u4e86\u4e00\u4e2a\u7531\u7f16\u8bd1\u5668\u6216\u7a0b\u5e8f\u5458\u7ba1\u7406\u7684 delay slot\uff0c\u5728\u6b64\u671f\u95f4\uff0c\u72ec\u7acb\u7684\u8ba1\u7b97\u53ef\u4ee5\u4e0e\u957f\u5ef6\u8fdf\u7684\u5185\u5b58\u8bbf\u95ee\u5e76\u884c\u8fdb\u884c\uff0c\u4ece\u800c\u6709\u6548\u201c\u9690\u85cf\u201d\u4e86\u5ef6\u8fdf\u3002</li> </ul> </li> <li>\u7b97\u6cd5\u6d41\u7a0b:<ol> <li>\u53d1\u5c04 indexed load/store \u6307\u4ee4\u3002</li> <li>\u68c0\u67e5 CSR chicken bit\u3002\u82e5\u5df2\u8bbe\u7f6e\uff0c\u5219\u6807\u91cf\u6838\u89e3\u9664\u5bf9\u8be5\u6307\u4ee4\u540e\u7eed\u6307\u4ee4\u7684\u963b\u585e\u3002</li> <li>\u7f16\u8bd1\u5668/\u8f6f\u4ef6\u5c06\u4e0d\u76f8\u5173\u7684\u72ec\u7acb\u6307\u4ee4\u8c03\u5ea6\u5230\u8be5 indexed \u6307\u4ee4\u4e4b\u540e\u3002</li> <li>HOLSU \u5728\u540e\u53f0\u5904\u7406\u6240\u6709\u5185\u5b58\u4e8b\u52a1\uff0c\u800c\u524d\u7aef\u7ee7\u7eed\u6267\u884c delay slot \u4e2d\u7684\u6307\u4ee4\u3002</li> </ol> </li> <li>\u53c2\u6570\u4e0e\u89c4\u683c: HOLSU \u652f\u6301 <code>LaneScale \u00d7 ELEN \u00d7 (SEW/8)</code> \u4e2a in-flight \u4e8b\u52a1\uff0c\u4f7f\u5176\u80fd\u591f\u5145\u5206\u538b\u69a8\u5185\u5b58\u7cfb\u7edf\u7684\u5e76\u53d1\u80fd\u529b\u3002</li> <li>\u5728\u6574\u4f53\u4e2d\u7684\u4f5c\u7528: \u8be5\u673a\u5236\u6781\u5927\u5730\u63d0\u5347\u4e86 T1 \u5bf9\u7a00\u758f\u8ba1\u7b97\u548c\u4e0d\u89c4\u5219\u8bbf\u5b58\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982\u56fe\u8ba1\u7b97\u3001\u67d0\u4e9b\u5bc6\u7801\u5b66\u539f\u8bed\uff09\u7684\u5bb9\u5fcd\u5ea6\u3002Figure 6 \u6e05\u6670\u5730\u5c55\u793a\u4e86 VIDX0 (indexed load) \u4e0e VEX0-VEX63 (\u72ec\u7acb\u8ba1\u7b97) \u7684\u5e76\u884c\u6267\u884c\u3002</li> </ul> <p></p> <p>Figure 6: Different ILP Technology in T1. Chaining interleaves V0, V1, and V2. Memory Interleaving mitigates the VSW-VLD dependency. Vector-Scalar OoO interleaves the vector and scalar pipelines until a true dependency v16-s64-v15 occurs. Memory Delay Slot parallelizes vector index load/store (VIDX0) with independent vector executions (VEX0).</p> <p>\u8f93\u5165\u8f93\u51fa\u5173\u7cfb\u4e0e\u534f\u540c\u5de5\u4f5c</p> <p>Dual LSU \u67b6\u6784\u7684\u8f93\u5165\u662f\u6765\u81ea Sequencer \u5206\u53d1\u7684\u5411\u91cf\u5185\u5b58\u5fae\u64cd\u4f5c (uops)\uff0c\u8f93\u51fa\u662f\u5199\u56de\u5411\u91cf\u5bc4\u5b58\u5668\u6587\u4ef6 (VRF) \u7684\u6570\u636e\u6216\u4ece VRF \u8bfb\u53d6\u7684\u6570\u636e\u3002</p> <ul> <li>\u8f93\u5165\u5206\u6d41: Sequencer \u6839\u636e\u6307\u4ee4\u7684\u8bbf\u95ee\u6a21\u5f0f\uff08unit-stride vs. strided/indexed\uff09\u5c06 uops \u8def\u7531\u5230 HBLSU \u6216 HOLSU\u3002</li> <li>\u8f93\u51fa\u6574\u5408: \u4e24\u4e2a LSU \u7684\u7ed3\u679c\u6700\u7ec8\u90fd\u901a\u8fc7\u5404\u81ea\u7684\u901a\u9053\u5199\u56de\u5230 Lane \u5185\u7684 Banked VRF \u4e2d\u3002</li> <li>\u6574\u4f53\u4f5c\u7528: \u8fd9\u79cd\u4e13\u4e1a\u5316\u5206\u5de5\u786e\u4fdd\u4e86 T1 \u80fd\u591f\u5728 unit-stride \u573a\u666f\u4e0b\u69a8\u5e72\u5185\u5b58\u5e26\u5bbd\uff0c\u540c\u65f6\u5728 indexed/strided \u573a\u666f\u4e0b\u901a\u8fc7\u9ad8\u5e76\u53d1\u548c\u5ef6\u8fdf\u9690\u85cf\u7ef4\u6301\u8f83\u9ad8\u7684\u8ba1\u7b97\u5355\u5143\u5229\u7528\u7387\u3002\u8fd9\u4f7f\u5f97 T1 \u5728 HPC \u548c Cryptography \u7b49\u6df7\u5408\u8bbf\u5b58\u6a21\u5f0f\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u8868\u73b0\u51fa\u8272\uff0c\u5982 Figure 9b \u6240\u793a\uff0c\u5373\u4f7f\u5728\u7eaf DDR \u6a21\u5f0f\u4e0b\uff08\u65e0\u672c\u5730 SRAM \u7f13\u5b58\uff09\uff0cT1 \u4e5f\u80fd\u51ed\u501f\u5176\u5f3a\u5927\u7684\u5185\u5b58\u5b50\u7cfb\u7edf\u548c\u5927 VLEN \u5e26\u6765\u7684\u6570\u636e\u5c40\u90e8\u6027\uff0c\u5c55\u73b0\u51fa\u5bf9\u5185\u5b58\u5ef6\u8fdf\u7684\u5f3a\u5927\u8010\u53d7\u6027\uff0c\u6027\u80fd\u8fdc\u8d85 SpacemiT X60 (K1)\u3002</li> </ul> <p></p> <p>(b) T1 Memory Scalability</p>"},{"location":"notes_repo/titan-i-an-open-source-high-performance-risc-v-vector-core/paper_notes/#4","title":"4. \u5b9e\u9a8c\u65b9\u6cd5\u4e0e\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u5b9e\u9a8c\u8bbe\u7f6e</p> <ul> <li>\u8bc4\u4f30\u5e73\u53f0\u4e0e\u57fa\u7ebf\uff1a</li> <li>Cryptographic Workloads: \u4e0e NVIDIA GA102 (RTX 3090) \u548c NVIDIA GB202 (RTX 5090) \u8fdb\u884c\u5bf9\u6bd4\u3002T1 \u914d\u7f6e\u4e3a VLEN=16384, DLEN=1024\uff0c\u5728 TSMC 7nm \u5de5\u827a\u4e0b\u7efc\u5408\uff0c\u9891\u7387 2.45 GHz\u3002GPU \u57fa\u7ebf\u5728\u5355\u4e2a Streaming Multiprocessor (SM) \u4e0a\u8fd0\u884c\uff0c\u4ee5\u6d88\u9664\u591a\u6838\u5e72\u6270\u3002</li> <li>HPC Workloads: \u4e0e HiSilicon TaiShan V120 (KP920) (ARM SVE) \u548c SpacemiT X60 (K1) (RVV) \u8fdb\u884c\u5bf9\u6bd4\u3002T1 \u7684 VLEN/DLEN \u6bd4\u503c\u56fa\u5b9a\u4e3a 4\uff0c\u5e76\u542f\u7528\u4e86\u6d6e\u70b9\u652f\u6301\u3002</li> <li> <p>\u5185\u5b58\u5b50\u7cfb\u7edf: T1 \u5728\u6a21\u62df\u4e2d\u4f7f\u7528 DDR4-3200\uff0c\u4e0d\u4f9d\u8d56\u672c\u5730 SRAM \u6216\u5927\u578b\u7f13\u5b58\uff0c\u4ee5\u6d4b\u8bd5\u5176\u5bf9\u5185\u5b58\u5ef6\u8fdf\u7684\u5bb9\u5fcd\u5ea6\u3002</p> </li> <li> <p>\u8f6f\u4ef6\u6808\uff1a</p> </li> <li>\u63d0\u4f9b\u4e86\u57fa\u4e8e MLIR \u7684\u5b8c\u6574\u8f6f\u4ef6\u6808\uff0c\u5305\u542b\u4e13\u7528\u7684 RVV dialect \u4ee5\u652f\u6301\u52a8\u6001\u5411\u91cf\u957f\u5ea6\u8bed\u4e49\u3002</li> <li> <p>\u52a0\u5bc6\u548c HPC \u5185\u6838\u5747\u7ecf\u8fc7\u624b\u5de5\u4f18\u5316\u6216\u901a\u8fc7 MLIR \u81ea\u52a8\u5411\u91cf\u5316\u751f\u6210\u3002</p> </li> <li> <p>\u7269\u7406\u5b9e\u73b0\uff1a</p> </li> <li>\u8bba\u6587\u5c55\u793a\u4e86\u4e24\u6b3e\u57fa\u4e8e T1 \u7684\u6d41\u7247\u82af\u7247\uff1a\u4e00\u6b3e\u7528\u4e8e Zero-Knowledge Proof (ZKP) \u7684 TSMC 28nm \u82af\u7247\u548c\u4e00\u6b3e\u7528\u4e8e Edge AI \u7684 HLMC 28nm SONOS \u82af\u7247\uff0c\u9a8c\u8bc1\u4e86\u8bbe\u8ba1\u7684\u53ef\u5b9e\u73b0\u6027\u3002</li> </ul> <p></p> <p>Edge AI Chip SoC Top GDS</p> <p></p> <p>T1 Top (Edge AI Chip)</p> <p>\u7ed3\u679c\u6570\u636e</p> <ul> <li>\u52a0\u5bc6\u6027\u80fd (Cryptographic Performance):</li> <li>\u5728 Montgomery Modular Multiplication (MMM) \u4efb\u52a1\u4e0a\uff0cT1 \u76f8\u6bd4 GA102 \u5b9e\u73b0\u4e86 1.98x - 2.41x \u7684\u52a0\u901f\uff0c\u76f8\u6bd4 GB202 \u5b9e\u73b0\u4e86 1.41x - 1.64x \u7684\u52a0\u901f\u3002</li> <li>\u5728 Number-Theoretic Transform (NTT) \u4efb\u52a1\uff08\u8f93\u5165\u5927\u5c0f512\uff09\u4e0a\uff0cT1 \u76f8\u6bd4 GA102 \u548c GB202 \u5206\u522b\u5b9e\u73b0\u4e86 1.74x \u548c 1.85x \u7684\u52a0\u901f\u3002</li> <li>\u5173\u952e\u4f18\u52bf: T1 \u901a\u8fc7 in-register computation \u548c\u9ad8\u6548\u7684 DLEN-sized Permutation Unit\uff0c\u663e\u8457\u51cf\u5c11\u4e86\u5bf9\u5185\u5b58\u5b50\u7cfb\u7edf\u7684\u4f9d\u8d56\uff0c\u5c3d\u7ba1\u5176\u786c\u4ef6\u8d44\u6e90\uff08\u5982 datapath \u5bbd\u5ea6\uff09\u4ec5\u4e3a GPU \u7684\u56db\u5206\u4e4b\u4e00\u3002</li> </ul> <p></p> <p>Figure 8: Cryptographic Benchmarks of T1 (DLEN1K, VLEN16K, emulated with DDR4-3200) with GA102 (NVIDIA GTX 3090) and NVIDIA GB202 (GTX 5090)</p> <ul> <li>\u9ad8\u6027\u80fd\u8ba1\u7b97 (HPC) \u6027\u80fd:</li> <li>vs. HiSilicon KP920: \u5728\u76f8\u540c datapath \u5bbd\u5ea6\u4e0b\uff0cT1 \u6027\u80fd\u4e0e KP920 \u76f8\u5f53 (51% - 213%)\uff0c\u4f46\u9762\u79ef\u4ec5\u4e3a\u5176 19%\u3002\u5f53 T1 \u7684 datapath \u5bbd\u5ea6\u6269\u5c55 4x \u540e\uff0c\u5728 PACK \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5b9e\u73b0\u4e86 4.59x \u7684\u52a0\u901f\u3002</li> <li>vs. SpacemiT X60: \u5728 256-bit datapath \u4e0b\uff0cT1 \u6027\u80fd\u662f X60 \u7684 2.02x - 6.36x\u3002\u5f53 T1 \u6269\u5c55\u5230 1024-bit datapath \u540e\uff0c\u6027\u80fd\u4f18\u52bf\u6269\u5927\u5230 8.05x\u3002</li> <li>\u5185\u5b58\u5ef6\u8fdf\u5bb9\u5fcd\u5ea6: \u5373\u4f7f\u5728\u7eaf DDR4-3200 \u6a21\u5f0f\u4e0b\uff08\u65e0\u672c\u5730\u7f13\u5b58\uff09\uff0c1024-bit T1 \u5728 QUANT \u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u7684\u6027\u80fd\u4ecd\u80fd\u8fbe\u5230 KP920 \u7684 154%\uff0c\u8bc1\u660e\u4e86\u5176\u901a\u8fc7 strip-mining \u548c\u5927 VLEN \u6709\u6548\u9690\u85cf\u5185\u5b58\u5ef6\u8fdf\u7684\u80fd\u529b\u3002</li> </ul> <p></p> <p>(a) T1-KP920 Comparison</p> <p></p> <p>(b) T1 Memory Scalability</p> <p></p> <p>(c) T1-X60 Comparison Figure 9: HPC benchmark results: Figure 9a: Performance of T1 (at 2.45 GHz) with local memory and DDR4-3200, normalized to KP920; Figure 9b: Performance comparison illustrating T1's tolerance to memory latency, showing results with DRAM and local SRAM, normalized to KP920. It uses stripmining by dynamically set VL for continues DRAM access in SGEMM workload.; Figure 9c: Performance of T1 (at 1.6 GHz) using DDR4-3200, normalized to K1, where higher is better.</p> <p>\u6d88\u878d\u5b9e\u9a8c (Ablation Study)</p> <ul> <li>\u6838\u5fc3\u5fae\u67b6\u6784\u7279\u6027\u5f71\u54cd:</li> <li>\u6d88\u878d\u5b9e\u9a8c\u5728 DLEN=256, VLEN=4096 \u7684 T1 \u914d\u7f6e\u4e0a\u8fdb\u884c\uff0c\u4f7f\u7528 PACK \u6d4b\u8bd5\u96c6\u3002</li> <li>\u7981\u7528 Chaining: \u5bfc\u81f4\u6027\u80fd\u4e0b\u964d 61%\uff0c\u4ece 14817 cycles \u589e\u52a0\u5230 23862 cycles\uff0c\u51f8\u663e\u4e86 fine-grained chaining \u5bf9\u4e8e\u91cd\u53e0\u6307\u4ee4\u751f\u547d\u5468\u671f\u3001\u63d0\u5347 ILP \u7684\u5173\u952e\u4f5c\u7528\u3002</li> <li>\u7981\u7528 Memory Interleaving: \u5bfc\u81f4\u6027\u80fd\u4e0b\u964d 32%\uff0c\u8bc1\u660e\u4e86\u8be5\u6280\u672f\u5bf9\u4e8e\u540c\u65f6\u5229\u7528 load/store \u901a\u9053\u3001\u63d0\u5347\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387\u7684\u6709\u6548\u6027\u3002</li> </ul> \u914d\u7f6e Cycles Slow Down Standard T1 14817 - Disable Chaining 23862 61% Disable Memory Interleaving 19514 32% <ul> <li>\u5fae\u67b6\u6784\u53c2\u6570\u7f29\u653e\u5206\u6790:</li> <li>VLEN &amp; DLEN Scaling: \u5982\u56fe\u6240\u793a\uff0cT1 \u7684\u9762\u79ef\u968f VLEN \u548c DLEN \u5448\u73b0\u51fa\u8fd1\u4e4e\u7ebf\u6027\u7684\u589e\u957f\uff0c\u9a8c\u8bc1\u4e86\u5176 lane-based \u8bbe\u8ba1\u7684\u53ef\u6269\u5c55\u6027\u3002</li> </ul> <p></p> <p>(a) VLEN</p> <p></p> <p>(b) DLEN Figure 4: Linearly Area Scaling of T1 design parameters, evaluated at TSMC N28 SVT technology at $65\\%$ utilization. Four cases are examined: (1) when varying VLEN, DLEN is held at 128, $y$ -asix on the left-hand represents the total area of T1, whereas the right-hand $y$ -axis isolates the area of Lane and Permutation; (2) when varying DLEN, the ratio VLEN/DLEN remains 1; (3) when examining LaneScale, both VLEN and DLEN are set to 1024, $y$ -asix on the left-hand represents the total area of T1, whereas the right-hand $y$ -axis isolates the area of Lane; and (4) when assessing ChainingSize, VLEN and DLEN are maintained at 1024.</p> <ul> <li>LaneScale: \u589e\u52a0 LaneScale\uff08\u5c06\u591a\u4e2a\u7269\u7406 lane \u805a\u5408\u4e3a\u4e00\u4e2a\u903b\u8f91\u5355\u5143\uff09\u53ef\u4ee5\u5728\u727a\u7272\u90e8\u5206\u67b6\u6784\u6548\u7387\u7684\u60c5\u51b5\u4e0b\uff0c\u663e\u8457\u51cf\u5c11\u63a7\u5236\u903b\u8f91\u5f00\u9500\uff0c\u4ece\u800c\u964d\u4f4e\u603b\u9762\u79ef\u3002</li> </ul> <p></p> <p>(c) LaneScale</p> <ul> <li>ChainingSize: \u589e\u5927 ChainingSize\uff08\u5373\u94fe\u5f0f\u64cd\u4f5c\u7684\u7c92\u5ea6\uff09\u53ef\u4ee5\u652f\u6301\u66f4\u591a\u98de\u884c\u4e2d\u7684\u6307\u4ee4\uff0c\u4f46\u4f1a\u7ebf\u6027\u589e\u52a0 Lane \u7684\u9762\u79ef\u5f00\u9500\uff0c\u9700\u8981\u6839\u636e\u5de5\u4f5c\u8d1f\u8f7d\uff08\u5982\u52a0\u5bc6 vs HPC\uff09\u8fdb\u884c\u6743\u8861\u3002</li> </ul> <p></p> <p>(d) ChainingSize</p>"}]}